{"version":3,"file":"static/js/p5-graphics.14938dd3.chunk.js","mappings":"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qBAIH9Q,WAAY,CACX8Q,UAAW,CACV,CACC,qBAIHppG,GAAI,CACHopG,UAAW,CACV,CACC,SACA,wBAIH7xF,MAAO,CACN6xF,UAAW,CACV,CACC,SACA,WAED,CACC,SACA,SACA,SACA,WAED,CACC,UAED,CACC,YAED,CACC,cAIHv1F,IAAK,CACJu1F,UAAW,CACV,CACC,8BAIHt1F,MAAO,CACNs1F,UAAW,CACV,CACC,8BAIHr1F,KAAM,CACLq1F,UAAW,CACV,CACC,8BAIHh1F,MAAO,CACNg1F,UAAW,CACV,CACC,8BAIHz1F,IAAK,CACJy1F,UAAW,CACV,CACC,8BAIH9sF,WAAY,CACX8sF,UAAW,CACV,CACC,8BAIH7sF,WAAY,CACX6sF,UAAW,CACV,CACC,8BAIH5sF,UAAW,CACV4sF,UAAW,CACV,CACC,8BAIH3sF,UAAW,CACV2sF,UAAW,CACV,CACC,WACA,WACA,YAIHxsF,YAAa,CACZwsF,UAAW,CACV,CACC,8CACA,YAIHhhE,UAAW,CACVghE,UAAW,CACV,CACC,aAIH9gE,QAAS,CACR8gE,UAAW,CACV,KAIF92D,KAAM,CACL82D,UAAW,CACV,CACC,WACA,aAIH72D,WAAY,CACX62D,UAAW,CACV,CACC,YAED,CACC,SACA,WAED,CACC,SACA,WAED,CACC,SACA,SACA,SACA,WAED,CACC,YAED,CACC,WACA,aAIH/yE,MAAO,CACN+yE,UAAW,CACV,CACC,UACA,UACA,UACA,WAED,KAIF/yF,UAAW,CACV+yF,UAAW,CACV,CACC,6CACA,WAED,CACC,6CACA,SACA,SACA,SACA,aAIHlyE,KAAM,CACLkyE,UAAW,CACV,CACC,SACA,SACA,SACA,WAED,CACC,UAED,CACC,SACA,WAED,CACC,YAED,CACC,cAIH7gE,OAAQ,CACP6gE,UAAW,CACV,KAIF3gE,SAAU,CACT2gE,UAAW,CACV,KAIF5gE,OAAQ,CACP4gE,UAAW,CACV,CACC,SACA,SACA,SACA,WAED,CACC,UAED,CACC,SACA,WAED,CACC,YAED,CACC,cAIHp2D,MAAO,CACNo2D,UAAW,CACV,CACC,UACA,aAIHj2D,QAAS,CACRi2D,UAAW,CACV,KAIF7mE,UAAW,CACV6mE,UAAW,CACV,CACC,sIAIHp8F,MAAO,CACNo8F,UAAW,CACV,CACC,OAED,CACC,yBAIHp7F,OAAQ,CACPo7F,UAAW,CACV,CACC,yCACA,UACA,aAIH16F,UAAW,CACV06F,UAAW,CACV,CACC,UAED,KAIFt6F,mBAAoB,CACnBs6F,UAAW,CACV,KAIFr6F,SAAU,CACTq6F,UAAW,CACV,KAIFz5F,cAAe,CACdy5F,UAAW,CACV,CACC,cAIHp5F,WAAY,CACXo5F,UAAW,CACV,CACC,cAIHj4F,aAAc,CACbi4F,UAAW,CACV,CACC,WAED,KAIF93F,eAAgB,CACf83F,UAAW,CACV,KAIF53F,OAAQ,CACP43F,UAAW,CACV,KAIFz3F,WAAY,CACXy3F,UAAW,CACV,KAIFr3F,aAAc,CACbq3F,UAAW,CACV,KAIFh3F,cAAe,CACdg3F,UAAW,CACV,CACC,mBACA,SACA,aAIH32F,cAAe,CACd22F,UAAW,CACV,CACC,mBACA,SACA,aAIH7lG,MAAO,CACN6lG,UAAW,CACV,KAIF9lG,KAAM,CACL8lG,UAAW,CACV,KAIFhb,aAAc,CACbgb,UAAW,CACV,CACC,UACA,UACA,oBACA,sBAED,CACC,UACA,UACA,wBAIH/3F,aAAc,CACb+3F,UAAW,CACV,CACC,SACA,SACA,cAIHxa,SAAU,CACTwa,UAAW,CACV,KAIFz7C,eAAgB,CACfy7C,UAAW,CACV,CACC,SACA,SACA,aACA,sBAED,CACC,SACA,SACA,wBAIHtuB,kBAAmB,CAClBsuB,UAAW,CACV,CACC,aAIHvxB,WAAY,CACXuxB,UAAW,CACV,CACC,aAIH7mG,OAAQ,CACP6mG,UAAW,CACV,KAIF3mG,KAAM,CACL2mG,UAAW,CACV,KAIFxmG,UAAW,CACVwmG,UAAW,CACV,KAIFvmG,OAAQ,CACPumG,UAAW,CACV,CACC,cAIHlpG,YAAa,CACZkpG,UAAW,CACV,CACC,SAED,CACC,SACA,SACA,SACA,SACA,SACA,UAED,CACC,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,YAIHvoG,YAAa,CACZuoG,UAAW,CACV,KAIFtoG,OAAQ,CACPsoG,UAAW,CACV,CACC,SACA,yBAIHloG,QAAS,CACRkoG,UAAW,CACV,CACC,YAIHhoG,QAAS,CACRgoG,UAAW,CACV,CACC,YAIH/nG,QAAS,CACR+nG,UAAW,CACV,CACC,YAIH9nG,MAAO,CACN8nG,UAAW,CACV,CACC,4BACA,UACA,WAED,CACC,wBAIHtnG,OAAQ,CACPsnG,UAAW,CACV,CACC,YAIHnnG,OAAQ,CACPmnG,UAAW,CACV,CACC,YAIHlnG,UAAW,CACVknG,UAAW,CACV,CACC,SACA,SACA,WAED,CACC,eAIHhnG,KAAM,CACLgnG,UAAW,CACV,KAIF/mG,IAAK,CACJ+mG,UAAW,CACV,KAIFC,UAAW,CACVD,UAAW,CACV,CACC,SACA,wCAIHE,QAAS,CACRF,UAAW,CACV,CACC,YAIHG,aAAc,CACbH,UAAW,CACV,KAIFI,WAAY,CACXJ,UAAW,CACV,CACC,YAIHK,OAAQ,CACPL,UAAW,CACV,CACC,SACA,oCAIHM,UAAW,CACVN,UAAW,CACV,CACC,SACA,oCAIH9rF,cAAe,CACd8rF,UAAW,CACV,CACC,SACA,aAIHO,eAAgB,CACfP,UAAW,CACV,KAIFz7D,WAAY,CACXy7D,UAAW,CACV,KAIFQ,UAAW,CACVR,UAAW,CACV,CACC,aAIH/yC,QAAS,CACR+yC,UAAW,CACV,CACC,aAIHS,WAAY,CACXT,UAAW,CACV,CACC,aAIHU,UAAW,CACVV,UAAW,CACV,CACC,SACA,UAED,CACC,SACA,SACA,UACA,eAIHW,QAAS,CACRX,UAAW,CACV,CACC,SACA,SACA,aAIHY,aAAc,CACbZ,UAAW,CACV,CACC,SACA,SACA,UACA,aAIHa,aAAc,CACbb,UAAW,CACV,CACC,SACA,aAIHc,eAAgB,CACfd,UAAW,CACV,CACC,UACA,cAIHe,aAAc,CACbf,UAAW,CACV,CACC,YAED,CACC,YAIHgB,YAAa,CACZhB,UAAW,CACV,CACC,WAED,CACC,WAED,KAIFiB,kBAAmB,CAClBjB,UAAW,CACV,CACC,sBAIHkB,YAAa,CACZlB,UAAW,CACV,CACC,UACA,WAED,CACC,aAIHmB,gBAAiB,CAChBnB,UAAW,CACV,CACC,WACA,cAIHoB,iBAAkB,CACjBpB,UAAW,CACV,CACC,YAIHqB,kBAAmB,CAClBrB,UAAW,CACV,CACC,YAIHsB,YAAa,CACZtB,UAAW,CACV,KAIFuB,aAAc,CACbvB,UAAW,CACV,KAIFwB,aAAc,CACbxB,UAAW,CACV,KAIFyB,WAAY,CACXzB,UAAW,CACV,CACC,oBAIH0B,YAAa,CACZ1B,UAAW,CACV,CACC,oBAIH2B,SAAU,CACT3B,UAAW,CACV,CACC,oBAIH4B,UAAW,CACV5B,UAAW,CACV,CACC,mBAIHtiF,WAAY,CACXsiF,UAAW,CACV,CACC,iBAIH6B,aAAc,CACb7B,UAAW,CACV,CACC,iBAIHnjF,aAAc,CACbmjF,UAAW,CACV,CACC,iBAIHxiF,cAAe,CACdwiF,UAAW,CACV,CACC,iBAIHviF,aAAc,CACbuiF,UAAW,CACV,CACC,iBAIH1iF,cAAe,CACd0iF,UAAW,CACV,CACC,iBAIHziF,WAAY,CACXyiF,UAAW,CACV,CACC,iBAIH8B,mBAAoB,CACnB9B,UAAW,CACV,KAIF+B,gBAAiB,CAChB/B,UAAW,CACV,KAIF97C,YAAa,CACZ87C,UAAW,CACV,CACC,UACA,aAIH77C,WAAY,CACX67C,UAAW,CACV,CACC,8CACA,UACA,WAED,CACC,UACA,aAIHx7C,WAAY,CACXw7C,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,sBAIHz0C,UAAW,CACVy0C,UAAW,CACV,CACC,iBACA,sBACA,sBAIH3zC,QAAS,CACR2zC,UAAW,CACV,CACC,SACA,SACA,aAIHlpE,MAAO,CACNkpE,UAAW,CACV,CACC,8FACA,SACA,SACA,UACA,WAED,CACC,sEACA,SACA,SACA,SACA,SACA,SACA,SACA,UACA,UACA,iBACA,qBACA,wBAIHvgE,KAAM,CACLugE,UAAW,CACV,CACC,SACA,SACA,SACA,WAED,CACC,UAED,CACC,SACA,WAED,CACC,YAED,CACC,cAIH/wC,OAAQ,CACP+wC,UAAW,CACV,KAIF5mE,UAAW,CACV4mE,UAAW,CACV,CACC,2BAIHnmE,MAAO,CACNmmE,UAAW,CACV,CACC,WACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,2HAED,CACC,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,6HAIHhjG,KAAM,CACLgjG,UAAW,CACV,CACC,sBACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAED,CACC,UACA,UACA,UACA,UACA,UACA,UACA,UACA,aAIHt3F,OAAQ,CACPs3F,UAAW,CACV,CACC,gEACA,UACA,YAED,CACC,eAIHr5F,IAAK,CACJq5F,UAAW,CACV,CACC,SACA,SACA,SACA,UAED,GAEA,CACC,SACA,YAIHhpE,WAAY,CACXgpE,UAAW,CACV,KAIFnjG,IAAK,CACJmjG,UAAW,CACV,CACC,SACA,SACA,4BAIH9oE,aAAc,CACb8oE,UAAW,CACV,CACC,UACA,UACA,UACA,WAED,KAIF95C,SAAU,CACT85C,UAAW,CACV,CACC,iBACA,YACA,eAIH15C,YAAa,CACZ05C,UAAW,CACV,CACC,iBACA,YACA,eAIHz5C,UAAW,CACVy5C,UAAW,CACV,CACC,iBACA,UACA,UACA,YACA,eAIHz4C,QAAS,CACRy4C,UAAW,CACV,CACC,iBACA,YACA,eAIHt4C,UAAW,CACVs4C,UAAW,CACV,CACC,iBACA,YACA,eAIHr4C,SAAU,CACTq4C,UAAW,CACV,CACC,iBACA,YACA,eAIHp4C,QAAS,CACRo4C,UAAW,CACV,CACC,iBACA,UACA,YACA,aAED,CACC,iBACA,WACA,eAIHj4C,SAAU,CACTi4C,UAAW,CACV,CACC,iBACA,kBACA,UACA,YACA,aAED,CACC,iBACA,iBACA,YACA,aAED,CACC,iBACA,YACA,eAIHl4C,OAAQ,CACPk4C,UAAW,CACV,CACC,iBACA,UACA,UACA,UACA,YACA,aAED,CACC,iBACA,YACA,eAIHx3C,aAAc,CACbw3C,UAAW,CACV,CACC,SACA,aAIHp3C,MAAO,CACNo3C,UAAW,CACV,CACC,yBAIH94E,MAAO,CACN84E,UAAW,CACV,KAIFzoE,KAAM,CACLyoE,UAAW,CACV,CACC,iBACA,UACA,qBAIH92C,SAAU,CACT82C,UAAW,CACV,CACC,eACA,SACA,cAIH72C,YAAa,CACZ62C,UAAW,CACV,CACC,WACA,SACA,UACA,cAIH52C,UAAW,CACV42C,UAAW,CACV,CACC,WACA,SACA,aAIHl+F,IAAK,CACJk+F,UAAW,CACV,CACC,YAIH7rE,KAAM,CACL6rE,UAAW,CACV,CACC,YAIH1f,UAAW,CACV0f,UAAW,CACV,CACC,SACA,SACA,YAIH1gG,KAAM,CACL0gG,UAAW,CACV,CACC,SACA,SACA,SACA,UAED,CACC,SACA,SACA,SACA,SACA,SACA,UAED,CACC,eAIHpkB,IAAK,CACJokB,UAAW,CACV,CACC,YAIHx0F,MAAO,CACNw0F,UAAW,CACV,CACC,YAIHt/F,KAAM,CACLs/F,UAAW,CACV,CACC,SACA,SACA,YAIHz7F,IAAK,CACJy7F,UAAW,CACV,CACC,YAIHphG,IAAK,CACJohG,UAAW,CACV,CACC,SACA,YAIHxkG,IAAK,CACJwkG,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,SACA,cAIHtgG,IAAK,CACJsgG,UAAW,CACV,CACC,SACA,UAED,CACC,cAIH9hG,IAAK,CACJ8hG,UAAW,CACV,CACC,SACA,UAED,CACC,cAIHnqD,KAAM,CACLmqD,UAAW,CACV,CACC,SACA,SACA,YAIHlxE,IAAK,CACJkxE,UAAW,CACV,CACC,SACA,YAIH90F,MAAO,CACN80F,UAAW,CACV,CACC,SACA,aAIHgC,GAAI,CACHhC,UAAW,CACV,CACC,YAIHnhG,KAAM,CACLmhG,UAAW,CACV,CACC,YAIHiC,MAAO,CACNjC,UAAW,CACV,CACC,YAIH92F,aAAc,CACb82F,UAAW,CACV,CACC,iBAIHkC,MAAO,CACNlC,UAAW,CACV,CACC,SACA,UACA,aAIHmC,YAAa,CACZnC,UAAW,CACV,CACC,SACA,YAIHoC,UAAW,CACVpC,UAAW,CACV,CACC,YAIHqC,WAAY,CACXrC,UAAW,CACV,CACC,YAIHx9F,OAAQ,CACPw9F,UAAW,CACV,CACC,UACA,WAED,CACC,WAIHsC,eAAgB,CACftC,UAAW,CACV,CACC,UACA,aAIHx8C,KAAM,CACLw8C,UAAW,CACV,CACC,YAIHjpD,KAAM,CACLipD,UAAW,CACV,CACC,YAIHn5D,KAAM,CACLm5D,UAAW,CACV,CACC,YAIHjgG,MAAO,CACNigG,UAAW,CACV,CACC,SACA,YAIH7/F,IAAK,CACJ6/F,UAAW,CACV,CACC,YAIH5/F,IAAK,CACJ4/F,UAAW,CACV,CACC,YAIHpnG,IAAK,CACJonG,UAAW,CACV,CACC,YAIHt8C,QAAS,CACRs8C,UAAW,CACV,CACC,YAIHr8C,QAAS,CACRq8C,UAAW,CACV,CACC,YAIHp8C,UAAW,CACVo8C,UAAW,CACV,CACC,mBAED,KAIFj5D,IAAK,CACJi5D,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,SACA,SACA,kBACA,cAIH94D,QAAS,CACR84D,UAAW,CACV,CACC,SACA,SACA,SACA,WAED,CACC,SACA,SACA,SACA,SACA,cAIH14D,OAAQ,CACP04D,UAAW,CACV,CACC,SACA,SACA,YAIH5tE,KAAM,CACL4tE,UAAW,CACV,CACC,SACA,SACA,SACA,UAED,CACC,SACA,SACA,SACA,SACA,SACA,YAIH7tE,MAAO,CACN6tE,UAAW,CACV,CACC,SACA,SACA,WAED,CACC,eAIH1tE,KAAM,CACL0tE,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,WACA,YAED,CACC,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,WACA,cAIHx4D,KAAM,CACLw4D,UAAW,CACV,CACC,SACA,SACA,SACA,UACA,UACA,UACA,UACA,WAED,CACC,SACA,SACA,SACA,SACA,WACA,cAIHt4D,OAAQ,CACPs4D,UAAW,CACV,CACC,SACA,SACA,SACA,UACA,UACA,UACA,aAIH3tE,SAAU,CACT2tE,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,SACA,YAIHrgE,YAAa,CACZqgE,UAAW,CACV,CACC,kCAIHj4D,SAAU,CACTi4D,UAAW,CACV,KAIFtgE,SAAU,CACTsgE,UAAW,CACV,CACC,kCAIH93D,OAAQ,CACP83D,UAAW,CACV,KAIF73D,UAAW,CACV63D,UAAW,CACV,CACC,0BAIH33D,WAAY,CACX23D,UAAW,CACV,CACC,uBAIHptE,aAAc,CACbotE,UAAW,CACV,CACC,YAIH7hE,OAAQ,CACP6hE,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,SACA,SACA,SACA,UAED,CACC,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,YAIHz3D,YAAa,CACZy3D,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,YAIHv3D,cAAe,CACdu3D,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,YAIHrhE,OAAQ,CACPqhE,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,SACA,SACA,SACA,UAED,CACC,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,YAIHt3D,YAAa,CACZs3D,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,YAIHn3D,cAAe,CACdm3D,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,YAIHlwE,YAAa,CACZkwE,UAAW,CACV,CACC,UAED,KAIFxvE,aAAc,CACbwvE,UAAW,CACV,CACC,SACA,UAED,CACC,SACA,SACA,WAED,CACC,SACA,SACA,UACA,WAED,CACC,SACA,SACA,SACA,UACA,aAIH/vE,eAAgB,CACf+vE,UAAW,CACV,CACC,SACA,MAED,CACC,YAIH9vE,iBAAkB,CACjB8vE,UAAW,CACV,CACC,UAED,KAIF74E,OAAQ,CACP64E,UAAW,CACV,CACC,SACA,UAED,CACC,SACA,SACA,UACA,WAED,CACC,SACA,SACA,SACA,UACA,aAIHtvE,aAAc,CACbsvE,UAAW,CACV,KAIFpvE,WAAY,CACXovE,UAAW,CACV,CACC,iBAIH5uE,WAAY,CACX4uE,UAAW,CACV,CACC,+EAIHzvE,aAAc,CACbyvE,UAAW,CACV,CACC,SACA,SACA,UACA,WAED,CACC,SACA,SACA,SACA,UACA,aAIH3uE,SAAU,CACT2uE,UAAW,CACV,CACC,SACA,cAIHj3D,OAAQ,CACPi3D,UAAW,CACV,CACC,aAED,CACC,SACA,SACA,YAIHtwE,eAAgB,CACfswE,UAAW,CACV,CACC,SACA,qBAIHuC,SAAU,CACTvC,UAAW,CACV,CACC,SACA,UACA,UACA,YACA,aAED,CACC,SACA,YACA,eAIHxlG,KAAM,CACLwlG,UAAW,CACV,CACC,qCACA,SACA,SACA,UACA,aAIH//D,UAAW,CACV+/D,UAAW,CACV,CACC,oBACA,iCAIHwC,WAAY,CACXxC,UAAW,CACV,CACC,aAIHyC,YAAa,CACZzC,UAAW,CACV,CACC,aAIHlgE,YAAa,CACZkgE,UAAW,CACV,CACC,YAIHpgE,SAAU,CACTogE,UAAW,CACV,CACC,wBACA,aAIHhgE,SAAU,CACTggE,UAAW,CACV,CACC,UAED,KAIF0C,UAAW,CACV1C,UAAW,CACV,CACC,iCAED,KAIF2C,UAAW,CACV3C,UAAW,CACV,CACC,YAIH7/D,SAAU,CACT6/D,UAAW,CACV,CACC,aAED,KAIF4C,WAAY,CACX5C,UAAW,CACV,CACC,SACA,SACA,SACA,UACA,aAIH6C,cAAe,CACd7C,UAAW,CACV,CACC,UAED,KAIF8C,aAAc,CACb9C,UAAW,CACV,CACC,SACA,MAED,CACC,YAIH+C,eAAgB,CACf/C,UAAW,CACV,CACC,UAED,KAIFgD,WAAY,CACXhD,UAAW,CACV,CACC,SACA,SACA,SACA,UACA,aAIHiD,UAAW,CACVjD,UAAW,CACV,CACC,YAIHkD,WAAY,CACXlD,UAAW,CACV,KAIFmD,YAAa,CACZnD,UAAW,CACV,KAIFoD,WAAY,CACXpD,UAAW,CACV,CACC,UAED,KAIFpiB,MAAO,CACNoiB,UAAW,CACV,CACC,UAED,CACC,cAIHqD,IAAK,CACJrD,UAAW,CACV,CACC,yBAED,CACC,WAIHzpF,IAAK,CACJypF,UAAW,CACV,CACC,2BAIHsD,QAAS,CACRtD,UAAW,CACV,CACC,yBAED,CACC,WAIHuD,KAAM,CACLvD,UAAW,CACV,CACC,yBAED,CACC,WAIHwD,KAAM,CACLxD,UAAW,CACV,CACC,iBAED,CACC,WAIHyD,OAAQ,CACPzD,UAAW,CACV,CACC,UAED,CACC,cAIH0D,IAAK,CACJ1D,UAAW,CACV,CACC,SACA,WAED,CACC,WACA,aAIH2D,MAAO,CACN3D,UAAW,CACV,CACC,UAED,CACC,cAIH4D,IAAK,CACJ5D,UAAW,CACV,KAIF6D,KAAM,CACL7D,UAAW,CACV,KAIF8D,OAAQ,CACP9D,UAAW,CACV,KAIFr3C,OAAQ,CACPq3C,UAAW,CACV,KAIF+D,MAAO,CACN/D,UAAW,CACV,KAIFgE,OAAQ,CACPhE,UAAW,CACV,KAIFiE,KAAM,CACLjE,UAAW,CACV,KAIF3vD,GAAI,CACH2vD,UAAW,CACV,CACC,gBACA,kBACA,mBAED,CACC,WACA,kBACA,qBAIHkE,IAAK,CACJlE,UAAW,CACV,CACC,gBACA,mBAED,CACC,WACA,qBAIHmE,IAAK,CACJnE,UAAW,CACV,CACC,SACA,WACA,YAED,CACC,WACA,WACA,cAIHoE,IAAK,CACJpE,UAAW,CACV,CACC,SACA,WACA,YAED,CACC,QACA,WACA,cAIHqE,YAAa,CACZrE,UAAW,CACV,CACC,SACA,aAIHsE,QAAS,CACRtE,UAAW,CACV,CACC,QACA,cAIHjsB,WAAY,CACXisB,UAAW,CACV,CACC,YAIHt2B,cAAe,CACds2B,UAAW,CACV,CACC,cAIHhsB,aAAc,CACbgsB,UAAW,CACV,CACC,iBAIHxxB,MAAO,CACNwxB,UAAW,CACV,CACC,UACA,UACA,WACA,cAIH/rB,IAAK,CACJ+rB,UAAW,CACV,CACC,UACA,UACA,UACA,WACA,cAIH9rB,OAAQ,CACP8rB,UAAW,CACV,CACC,UACA,WACA,cAIH7rB,SAAU,CACT6rB,UAAW,CACV,CACC,UACA,UACA,WACA,WACA,WACA,cAIH1rB,KAAM,CACL0rB,UAAW,CACV,CACC,UACA,UACA,WACA,WACA,cAIHzrB,UAAW,CACVyrB,UAAW,CACV,CACC,UACA,UACA,UACA,WACA,cAIHrrB,MAAO,CACNqrB,UAAW,CACV,CACC,UACA,UACA,WACA,cAIHhsE,YAAa,CACZgsE,UAAW,CACV,CACC,YAIHuE,aAAc,CACbvE,UAAW,CACV,CACC,UACA,UACA,UACA,aAIHwE,UAAW,CACVxE,UAAW,CACV,GAEA,CACC,aAED,CACC,YACA,UACA,UACA,UACA,UACA,WAED,CACC,YACA,UACA,UACA,UACA,WAED,CACC,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,aAIHyE,YAAa,CACZzE,UAAW,CACV,KAIF1nB,aAAc,CACb0nB,UAAW,CACV,CACC,SACA,SACA,SACA,WAED,CACC,SACA,WAED,CACC,UAED,CACC,YAED,CACC,cAIHznB,cAAe,CACdynB,UAAW,CACV,CACC,SACA,SACA,UAED,CACC,UAED,CACC,UAED,CACC,YAED,CACC,cAIHxnB,iBAAkB,CACjBwnB,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,SACA,UAED,CACC,SACA,SACA,SACA,aAED,CACC,2BACA,SACA,SACA,UAED,CACC,2BACA,eAIHvnB,WAAY,CACXunB,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,SACA,UAED,CACC,SACA,SACA,SACA,aAED,CACC,2BACA,SACA,SACA,UAED,CACC,2BACA,eAIHtnB,WAAY,CACXsnB,UAAW,CACV,CACC,cAIHrnB,SAAU,CACTqnB,UAAW,CACV,CACC,cAIHpnB,OAAQ,CACPonB,UAAW,CACV,KAIFnnB,aAAc,CACbmnB,UAAW,CACV,CACC,SACA,SACA,YAIHlnB,UAAW,CACVknB,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,SACA,UACA,WAED,CACC,2BACA,YACA,YACA,UACA,WAED,CACC,SACA,SACA,SACA,YACA,YACA,UACA,WAED,CACC,2BACA,SACA,SACA,SACA,YACA,UACA,WAED,CACC,2BACA,YACA,SACA,SACA,SACA,UACA,WAED,CACC,SACA,SACA,SACA,SACA,SACA,SACA,YACA,UACA,WAED,CACC,SACA,SACA,SACA,YACA,SACA,SACA,SACA,UACA,WAED,CACC,2BACA,SACA,SACA,SACA,SACA,SACA,SACA,UACA,aAIH9mE,SAAU,CACT8mE,UAAW,CACV,KAIF0E,UAAW,CACV1E,UAAW,CACV,CACC,iBACA,UACA,UACA,yBACA,oBAED,CACC,iBACA,UACA,yBACA,oBAED,CACC,iBACA,aAIH19C,MAAO,CACN09C,UAAW,CACV,CACC,cACA,aAIH2E,YAAa,CACZ3E,UAAW,CACV,CACC,SACA,UACA,UACA,yBACA,oBAED,CACC,SACA,UACA,yBACA,oBAED,CACC,SACA,UACA,aAIH7mB,WAAY,CACX6mB,UAAW,CACV,CACC,iBACA,iBACA,YACA,eAIH9lC,aAAc,CACb8lC,UAAW,CACV,CACC,SACA,SACA,aAIHzmB,iBAAkB,CACjBymB,UAAW,CACV,CACC,SACA,YACA,eAIH9vB,mBAAoB,CACnB8vB,UAAW,CACV,CACC,YAIHr1D,OAAQ,CACPq1D,UAAW,CACV,CACC,eAIH9tB,aAAc,CACb8tB,UAAW,CACV,CACC,eAIHtmB,YAAa,CACZsmB,UAAW,CACV,CACC,eAIHzvB,mBAAoB,CACnByvB,UAAW,CACV,KAIFjvB,iBAAkB,CACjBivB,UAAW,CACV,KAIFvvB,iBAAkB,CACjBuvB,UAAW,CACV,KAIFtvB,gBAAiB,CAChBsvB,UAAW,CACV,KAIFrvB,iBAAkB,CACjBqvB,UAAW,CACV,KAIF/wB,YAAa,CACZ+wB,UAAW,CACV,KAIFviC,QAAS,CACRuiC,UAAW,CACV,CACC,0FAIH9gD,YAAa,CACZ8gD,UAAW,CACV,CACC,kBAIHrmB,YAAa,CACZqmB,UAAW,CACV,CACC,sBACA,0BAIHjmB,eAAgB,CACfimB,UAAW,CACV,KAIFhmB,gBAAiB,CAChBgmB,UAAW,CACV,CACC,SACA,SACA,UAED,CACC,UAED,CACC,8BAIH/lB,iBAAkB,CACjB+lB,UAAW,CACV,CACC,SACA,SACA,SACA,WAED,CACC,UAED,CACC,8BAIH9lB,iBAAkB,CACjB8lB,UAAW,CACV,CACC,SACA,WAED,CACC,SACA,SACA,SACA,WAED,CACC,8BAIH7lB,UAAW,CACV6lB,UAAW,CACV,CACC,YAIH3lB,UAAW,CACV2lB,UAAW,CACV,CACC,YAIHhvC,OAAQ,CACPgvC,UAAW,CACV,CACC,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,aAIHzjF,YAAa,CACZyjF,UAAW,CACV,CACC,UACA,UACA,UACA,aAIHnpC,gBAAiB,CAChBmpC,UAAW,CACV,CACC,WAED,KAIF1vD,MAAO,CACN0vD,UAAW,CACV,CACC,UACA,UACA,UACA,UACA,UACA,aAIH1vC,QAAS,CACR0vC,UAAW,CACV,CACC,UACA,UACA,UACA,UACA,UACA,aAIHjpC,aAAc,CACbipC,UAAW,CACV,KAIFhpC,UAAW,CACVgpC,UAAW,CACV,CACC,eAIHvrD,QAAS,CACRurD,UAAW,CACV,CACC,aAIHlrD,QAAS,CACRkrD,UAAW,CACV,CACC,UACA,aAIHh4D,cAAe,CACdg4D,UAAW,CACV,CACC,SACA,WAED,CACC,YAIHrnF,OAAQ,CACPqnF,UAAW,CACV,KAIFh7D,YAAa,CACZg7D,UAAW,CACV,CACC,kBACA,eAIH/6D,YAAa,CACZ+6D,UAAW,CACV,GAEA,CACC,mBACA,eAIHr6D,cAAe,CACdq6D,UAAW,CACV,CACC,sBACA,UACA,gBAOH,cAAe,CACf7pD,MAAO,CACN6pD,UAAW,CACV,KAIFjsD,qBAAsB,CACrBisD,UAAW,CACV,KAIFxrD,YAAa,CACZwrD,UAAW,CACV,KAIF/pD,MAAO,CACN+pD,UAAW,CACV,KAIF5pD,aAAc,CACb4pD,UAAW,CACV,KAIFhpD,eAAgB,CACfgpD,UAAW,CACV,CACC,eACA,aAIH9nD,mBAAoB,CACnB8nD,UAAW,CACV,KAIFzgG,UAAW,CACVygG,UAAW,CACV,KAIFtwE,eAAgB,CACfswE,UAAW,CACV,CACC,SACA,kBACA,cAKH,WAAY,CACZtjG,SAAU,CACTsjG,UAAW,CACV,CACC,aAIH9wF,OAAQ,CACP8wF,UAAW,CACV,CACC,YAIHxwF,SAAU,CACTwwF,UAAW,CACV,CACC,YAIHtwF,QAAS,CACRswF,UAAW,CACV,CACC,YAIHpwF,SAAU,CACTowF,UAAW,CACV,CACC,aAKH,cAAe,CACfvwE,MAAO,CACNuwE,UAAW,CACV,KAIFrnF,OAAQ,CACPqnF,UAAW,CACV,KAIFtuB,kBAAmB,CAClBsuB,UAAW,CACV,CACC,cAKH,aAAc,CACdrnF,OAAQ,CACPqnF,UAAW,CACV,KAIFxmF,OAAQ,CACPwmF,UAAW,CACV,CACC,4BAED,KAIFxqF,MAAO,CACNwqF,UAAW,CACV,GAEA,CACC,wBAIHnmF,KAAM,CACLmmF,UAAW,CACV,GAEA,CACC,UACA,cAIHp2F,GAAI,CACHo2F,UAAW,CACV,CACC,UAED,KAIF,MAAS,CACRA,UAAW,CACV,CACC,UAED,KAIF/lF,SAAU,CACT+lF,UAAW,CACV,CACC,YAIH7lF,YAAa,CACZ6lF,UAAW,CACV,CACC,YAIH9lF,SAAU,CACT8lF,UAAW,CACV,CACC,QAIH1lF,YAAa,CACZ0lF,UAAW,CACV,CACC,QAIHzlF,OAAQ,CACPylF,UAAW,CACV,CACC,aAIHhlF,SAAU,CACTglF,UAAW,CACV,GAEA,CACC,UACA,UACA,aAIHjlF,KAAM,CACLilF,UAAW,CACV,KAIF7kF,KAAM,CACL6kF,UAAW,CACV,KAIF5oF,KAAM,CACL4oF,UAAW,CACV,GAEA,CACC,eACA,kBAIH36F,MAAO,CACN26F,UAAW,CACV,CACC,UAED,CACC,SACA,qBAIHhqF,UAAW,CACVgqF,UAAW,CACV,GAEA,CACC,SACA,YAIHpjF,gBAAiB,CAChBojF,UAAW,CACV,CACC,YAIH5jG,MAAO,CACN4jG,UAAW,CACV,GAEA,CACC,mBAIHnjF,aAAc,CACbmjF,UAAW,CACV,CACC,sBAIH1iF,cAAe,CACd0iF,UAAW,CACV,CACC,sBAIHziF,WAAY,CACXyiF,UAAW,CACV,CACC,sBAIHxiF,cAAe,CACdwiF,UAAW,CACV,CACC,sBAIHviF,aAAc,CACbuiF,UAAW,CACV,CACC,sBAIHtiF,WAAY,CACXsiF,UAAW,CACV,CACC,sBAIHriF,UAAW,CACVqiF,UAAW,CACV,CACC,sBAIHpiF,SAAU,CACToiF,UAAW,CACV,CACC,sBAIHniF,SAAU,CACTmiF,UAAW,CACV,CACC,sBAIHliF,UAAW,CACVkiF,UAAW,CACV,CACC,sBAIHjiF,QAAS,CACRiiF,UAAW,CACV,CACC,sBAIHhiF,MAAO,CACNgiF,UAAW,CACV,CACC,sBAIH/hF,KAAM,CACL+hF,UAAW,CACV,CACC,WACA,eAIHthF,UAAW,CACVshF,UAAW,CACV,CACC,kBAKH,kBAAmB,CACnBljE,KAAM,CACLkjE,UAAW,CACV,KAIFpnF,KAAM,CACLonF,UAAW,CACV,KAIFjjE,MAAO,CACNijE,UAAW,CACV,KAIF3mG,KAAM,CACL2mG,UAAW,CACV,KAIF7mG,OAAQ,CACP6mG,UAAW,CACV,KAIF59D,SAAU,CACT49D,UAAW,CACV,CACC,cAIHz9D,OAAQ,CACPy9D,UAAW,CACV,GAEA,CACC,YAIHx9D,MAAO,CACNw9D,UAAW,CACV,GAEA,CACC,YAIHp9D,KAAM,CACLo9D,UAAW,CACV,GAEA,CACC,YAIHx+D,SAAU,CACTw+D,UAAW,CACV,KAIF3+D,QAAS,CACR2+D,UAAW,CACV,CACC,cAIH/8D,QAAS,CACR+8D,UAAW,CACV,CACC,sBAIHv8D,WAAY,CACXu8D,UAAW,CACV,KAIFt8D,aAAc,CACbs8D,UAAW,CACV,KAIFp8D,aAAc,CACbo8D,UAAW,CACV,KAIFn8D,OAAQ,CACPm8D,UAAW,CACV,CACC,SACA,WACA,aAIH97D,UAAW,CACV87D,UAAW,CACV,CACC,YAIH77D,UAAW,CACV67D,UAAW,CACV,MAKF,WAAY,CACZj4F,aAAc,CACbi4F,UAAW,CACV,CACC,aAIHhpE,WAAY,CACXgpE,UAAW,CACV,KAIF9oE,aAAc,CACb8oE,UAAW,CACV,CACC,UACA,UACA,UACA,aAIHr5F,IAAK,CACJq5F,UAAW,CACV,CACC,SACA,SACA,SACA,UAED,GAEA,CACC,SACA,YAIHnjG,IAAK,CACJmjG,UAAW,CACV,CACC,SACA,SACA,4BAIHnoE,OAAQ,CACPmoE,UAAW,CACV,CACC,SACA,YAIHhjG,KAAM,CACLgjG,UAAW,CACV,CACC,sBACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WAED,CACC,UACA,UACA,UACA,UACA,UACA,UACA,UACA,aAIH3mE,KAAM,CACL2mE,UAAW,CACV,CACC,cAIHt3F,OAAQ,CACPs3F,UAAW,CACV,CACC,2DACA,aAIHnmE,MAAO,CACNmmE,UAAW,CACV,CACC,WACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,2HAED,CACC,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,6HAIHzoE,KAAM,CACLyoE,UAAW,CACV,CACC,SACA,aAIHvwE,MAAO,CACNuwE,UAAW,CACV,KAIFpjE,gBAAiB,CAChBojE,UAAW,CACV,KAIFnjE,SAAU,CACTmjE,UAAW,CACV,CACC,YAIHppE,UAAW,CACVopE,UAAW,CACV,KAIFljE,KAAM,CACLkjE,UAAW,CACV,KAIFjjE,MAAO,CACNijE,UAAW,CACV,KAIFvpE,MAAO,CACNupE,UAAW,CACV,CACC,SACA,cAKH,WAAY,CACZ14C,OAAQ,CACP04C,UAAW,CACV,CACC,kBAIH4E,UAAW,CACV5E,UAAW,CACV,CACC,aAIH6E,OAAQ,CACP7E,UAAW,CACV,CACC,aAIH8E,QAAS,CACR9E,UAAW,CACV,KAIF+E,QAAS,CACR/E,UAAW,CACV,CACC,SACA,oBAIHgF,SAAU,CACThF,UAAW,CACV,CACC,SACA,oBAIHiF,SAAU,CACTjF,UAAW,CACV,CACC,gBACA,oBAIHkF,UAAW,CACVlF,UAAW,CACV,CACC,SACA,qBAIHmF,UAAW,CACVnF,UAAW,CACV,CACC,mBAIHoF,UAAW,CACVpF,UAAW,CACV,KAIFqF,UAAW,CACVrF,UAAW,CACV,CACC,aAIHsF,eAAgB,CACftF,UAAW,CACV,KAIFuF,YAAa,CACZvF,UAAW,CACV,KAIFwF,aAAc,CACbxF,UAAW,CACV,CACC,SACA,qBAIH5jF,KAAM,CACL4jF,UAAW,CACV,CACC,qBAIHyF,aAAc,CACbzF,UAAW,CACV,CACC,oBAIHnjG,IAAK,CACJmjG,UAAW,CACV,CACC,UACA,iBACA,mBAIH0F,OAAQ,CACP1F,UAAW,CACV,CACC,UACA,iBACA,YAIH2F,UAAW,CACV3F,UAAW,CACV,CACC,UACA,iBACA,YAIHr5F,IAAK,CACJq5F,UAAW,CACV,CACC,UACA,oBAIH9pF,OAAQ,CACP8pF,UAAW,CACV,CACC,UACA,oBAIH5pF,UAAW,CACV4pF,UAAW,CACV,CACC,UACA,oBAIH4F,UAAW,CACV5F,UAAW,CACV,CACC,aAIH6F,SAAU,CACT7F,UAAW,CACV,MAKF,cAAe,CACfnjG,IAAK,CACJmjG,UAAW,CACV,CACC,iBACA,mBAIH0F,OAAQ,CACP1F,UAAW,CACV,CACC,iBACA,mBAIH2F,UAAW,CACV3F,UAAW,CACV,CACC,iBACA,kCAIHr5F,IAAK,CACJq5F,UAAW,CACV,CACC,oBAIH9pF,OAAQ,CACP8pF,UAAW,CACV,CACC,oBAIH5pF,UAAW,CACV4pF,UAAW,CACV,CACC,qBAKH,SAAU,CACV7rF,UAAW,CACV6rF,UAAW,CACV,KAIF3rF,QAAS,CACR2rF,UAAW,CACV,KAIFzrF,QAAS,CACRyrF,UAAW,CACV,CACC,YAIHjrF,YAAa,CACZirF,UAAW,CACV,KAIF/qF,aAAc,CACb+qF,UAAW,CACV,KAIF7qF,YAAa,CACZ6qF,UAAW,CACV,CACC,aAIHzqF,SAAU,CACTyqF,UAAW,CACV,CACC,oBAIHvqF,SAAU,CACTuqF,UAAW,CACV,CACC,YAIHpqF,YAAa,CACZoqF,UAAW,CACV,CACC,oBAIHlqF,kBAAmB,CAClBkqF,UAAW,CACV,KAIFjqF,eAAgB,CACfiqF,UAAW,CACV,KAIF/pF,aAAc,CACb+pF,UAAW,CACV,CACC,YAIH9pF,OAAQ,CACP8pF,UAAW,CACV,CACC,SACA,aAIH5pF,UAAW,CACV4pF,UAAW,CACV,CACC,SACA,aAIHprF,aAAc,CACborF,UAAW,CACV,CACC,SACA,2BAIH1pF,WAAY,CACX0pF,UAAW,CACV,CACC,aAIHj1F,UAAW,CACVi1F,UAAW,CACV,MAKF,YAAa,CACbhkG,SAAU,CACTgkG,UAAW,CACV,CACC,YAIH7jG,SAAU,CACT6jG,UAAW,CACV,CACC,SACA,YAIHnjG,IAAK,CACJmjG,UAAW,CACV,CACC,UACA,UACA,WAED,CACC,wBAIHhjG,KAAM,CACLgjG,UAAW,CACV,GAEA,CACC,eAIH/iG,IAAK,CACJ+iG,UAAW,CACV,CACC,eACA,UACA,WAED,CACC,sBAED,CACC,YACA,YACA,gBAIH3iG,IAAK,CACJ2iG,UAAW,CACV,CACC,SACA,SACA,UAED,CACC,sBAED,CACC,YACA,eAIHniG,IAAK,CACJmiG,UAAW,CACV,CACC,SACA,UACA,WAED,CACC,sBAED,CACC,YACA,YACA,gBAIHhiG,KAAM,CACLgiG,UAAW,CACV,CACC,SACA,SACA,WAED,CACC,YAED,CACC,aAED,GAEA,CACC,YACA,SACA,cAED,CACC,YACA,YACA,cAED,CACC,YACA,WACA,gBAIHzhG,IAAK,CACJyhG,UAAW,CACV,CACC,UAED,CACC,SACA,SACA,WAED,CACC,YAED,CACC,aAED,GAEA,CACC,YACA,SACA,cAED,CACC,YACA,YACA,cAED,CACC,YACA,WACA,gBAIHphG,IAAK,CACJohG,UAAW,CACV,GAEA,CACC,eAIHlhG,MAAO,CACNkhG,UAAW,CACV,GAEA,CACC,eAIH9gG,IAAK,CACJ8gG,UAAW,CACV,CACC,SACA,UACA,WAED,CACC,aAED,GAEA,CACC,YACA,eAIH3gG,MAAO,CACN2gG,UAAW,CACV,CACC,aAED,GAEA,CACC,YACA,eAIHzgG,UAAW,CACVygG,UAAW,CACV,GAEA,CACC,YACA,gBAIHvgG,MAAO,CACNugG,UAAW,CACV,CACC,UAED,GAEA,CACC,YACA,SACA,gBAIHpgG,OAAQ,CACPogG,UAAW,CACV,CACC,UAED,GAEA,CACC,YACA,SACA,gBAIHngG,QAAS,CACRmgG,UAAW,CACV,GAEA,CACC,eAIHhgG,WAAY,CACXggG,UAAW,CACV,CACC,YAIHtoG,OAAQ,CACPsoG,UAAW,CACV,CACC,UAED,GAEA,CACC,YACA,SACA,gBAIH1/F,aAAc,CACb0/F,UAAW,CACV,CACC,aAED,GAEA,CACC,YACA,eAIHt/F,KAAM,CACLs/F,UAAW,CACV,CACC,SACA,SACA,SACA,UAED,CACC,YACA,UAED,GAEA,CACC,YACA,YACA,SACA,gBAIHp/F,MAAO,CACNo/F,UAAW,CACV,CACC,YACA,UAED,GAEA,CACC,YACA,YACA,SACA,gBAIH3+F,QAAS,CACR2+F,UAAW,CACV,CACC,aAED,GAEA,CACC,YACA,YACA,gBAIHx+F,MAAO,CACNw+F,UAAW,CACV,GAEA,CACC,eAIHv+F,OAAQ,CACPu+F,UAAW,CACV,CACC,UACA,UACA,WAED,CACC,mBAED,GAEA,CACC,kBACA,qBAIHh+F,UAAW,CACVg+F,UAAW,CACV,CACC,SACA,aAIH/9F,WAAY,CACX+9F,UAAW,CACV,CACC,SACA,SACA,aAIHz9F,SAAU,CACTy9F,UAAW,CACV,KAIFv9F,SAAU,CACTu9F,UAAW,CACV,KAIF1gG,KAAM,CACL0gG,UAAW,CACV,GAEA,CACC,YACA,gBAKH,UAAW,CACX8F,YAAa,CACZ9F,UAAW,CACV,CACC,SACA,SACA,SACA,UACA,UACA,aAIH+F,aAAc,CACb/F,UAAW,CACV,CACC,SACA,SACA,SACA,aAIHgG,eAAgB,CACfhG,UAAW,CACV,CACC,SACA,SACA,SACA,aAIHiG,YAAa,CACZjG,UAAW,CACV,CACC,SACA,SACA,SACA,SACA,SACA,cAKH,YAAa,CACbzjF,YAAa,CACZyjF,UAAW,CACV,CACC,UACA,UACA,UACA,aAIH1vD,MAAO,CACN0vD,UAAW,CACV,CACC,UACA,UACA,UACA,UACA,UACA,aAIH1vC,QAAS,CACR0vC,UAAW,CACV,CACC,UACA,UACA,UACA,UACA,UACA,aAIHvuC,IAAK,CACJuuC,UAAW,CACV,CACC,YAIHtuC,KAAM,CACLsuC,UAAW,CACV,CACC,YAIHruC,OAAQ,CACPquC,UAAW,CACV,CACC,SACA,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Vke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,YACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,UACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,oBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,oBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,oBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,aACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,UACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,QACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,QACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,SACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,UACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,YACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,UACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,OACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,MACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,UACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,UACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,cACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,wCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,QACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,QACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,UACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,UACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,QACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,QACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,YACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,iDACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,QACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,SACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,cACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,gBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,uCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,YACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,QACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,SACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,oBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,uBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,mBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,iCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,yCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,4BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,iBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,8BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,mBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,0CACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,qBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,eACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,SACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,yBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,0BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,mBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,gCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,yBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,cACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,iBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,mBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,wBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,uCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,wBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,mBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,wBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,uCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,mCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,aACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,mBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,SACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,oBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,2BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,0BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,kBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,qCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,8BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,4BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,SACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,oBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,cACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,+BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,kCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,oBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,qCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,0BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,yBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,eACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,cACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,OACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,MACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,QACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,wBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,mBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,eACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,4BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,aACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,SACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,yBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,qBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,OACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,qBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,0BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,mBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,eACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,mBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,yBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,kBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,8BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,iBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,mBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,+BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,gCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,8BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,iBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,uBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,0BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,sBACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,8BACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,gCACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,WACVke,SAAU,CAAC,OAAQ,SAErB,CACEle,SAAU,qBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,qBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,iBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,wBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,kBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,gBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,uBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,aACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,aACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,WACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,cACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,QACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,qBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,WACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,WACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,mBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,oBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,mBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,YACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,YACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,aACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,uBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,mBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,aACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,oBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,oBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,aACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,yBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,wBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,kBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,aACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,gBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,kBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,uBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,oBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,cACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,aACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,aACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,eACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,WACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,0BACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,YACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,OACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,OACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,uBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,QACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,OACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,QACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,cACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,cACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,cACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,mBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,mDACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,cACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,wBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,YACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,gBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,gBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,UACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,OACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,kBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,mBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,YACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,oCACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,2BACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,eACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,uBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,sCACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,wBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,mBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,MACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,YACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,eACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,cACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,OACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,sCACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,oBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,sBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,oBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,kBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,kBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,kBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,uBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,QACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,WACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,4BACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,4BACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,4BACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,kBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,iCACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,oBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,iBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,wBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,wBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,oCACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,qBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,mBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,wBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,sBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,yBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,OACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,SACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,cACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,sBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,gBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,QACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,sBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,wBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,yCACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,gBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,eACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,gBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,mCACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,kCACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,wCACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,oBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,sBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,4BACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,qBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,4BACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,wBACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,uCACVke,SAAU,CAAC,QAAS,UAEtB,CACEle,SAAU,gBAC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","sources":["../node_modules/p5/dist/constants-8IpwyBct.js","../node_modules/p5/dist/core/transform.js","../node_modules/p5/dist/core/structure.js","../node_modules/p5/dist/math/p5.Vector.js","../node_modules/p5/dist/core/environment.js","../node_modules/p5/dist/color/color_spaces/hsb.js","../node_modules/p5/dist/creating_reading-BdolPjuO.js","../node_modules/p5/dist/io/p5.XML.js","../node_modules/p5/dist/dom/p5.File.js","../node_modules/p5/dist/dom/p5.Element.js","../node_modules/p5/dist/image/filters.js","../node_modules/p5/dist/shape/custom_shapes.js","../node_modules/p5/dist/core/States.js","../node_modules/p5/dist/io/utilities.js","../node_modules/p5/dist/p5.Renderer-DoDzbpcT.js","../node_modules/p5/dist/dom/p5.MediaElement.js","../node_modules/p5/dist/core/helpers.js","../node_modules/p5/dist/shape/2d_primitives.js","../node_modules/p5/dist/shape/attributes.js","../node_modules/p5/dist/shape/curves.js","../node_modules/p5/dist/shape/vertex.js","../node_modules/p5/dist/color/setting.js","../node_modules/p5/dist/io/csv.js","../node_modules/p5/dist/image/pixels.js","../node_modules/p5/dist/math/Matrices/MatrixInterface.js","../node_modules/p5/dist/math/Matrices/Matrix.js","../node_modules/p5/dist/math/p5.Matrix.js","../node_modules/p5/dist/webgl/p5.DataArray.js","../node_modules/p5/dist/webgl/p5.Geometry.js","../node_modules/p5/dist/webgl/GeometryBuilder.js","../node_modules/p5/dist/webgl/p5.Quat.js","../node_modules/p5/dist/webgl/p5.RenderBuffer.js","../node_modules/p5/dist/webgl/ShapeBuilder.js","../node_modules/p5/dist/webgl/GeometryBufferCache.js","../node_modules/p5/dist/image/const.js","../node_modules/p5/dist/math/trigonometry.js","../node_modules/p5/dist/rendering-BELwvfI6.js","../node_modules/p5/dist/image/filterRenderer2D.js","../node_modules/p5/dist/main-B3Z63C6j.js","../node_modules/p5/dist/accessibility/describe.js","../node_modules/p5/dist/accessibility/gridOutput.js","../node_modules/p5/dist/accessibility/textOutput.js","../node_modules/p5/dist/accessibility/outputs.js","../node_modules/p5/dist/color/color_conversion.js","../node_modules/p5/dist/accessibility/color_namer.js","../node_modules/p5/dist/core/internationalization.js","../node_modules/p5/dist/core/friendly_errors/browser_errors.js","../node_modules/p5/dist/core/friendly_errors/fes_core.js","../node_modules/p5/dist/core/friendly_errors/stacktrace.js","../node_modules/p5/dist/core/friendly_errors/param_validator.js","../node_modules/p5/dist/core/friendly_errors/sketch_verifier.js","../node_modules/p5/dist/core/friendly_errors/file_errors.js","../node_modules/p5/dist/data/local_storage.js","../node_modules/p5/dist/dom/dom.js","../node_modules/p5/dist/events/acceleration.js","../node_modules/p5/dist/events/keyboard.js","../node_modules/p5/dist/events/pointer.js","../node_modules/p5/dist/io/p5.Table.js","../node_modules/p5/dist/io/p5.TableRow.js","../node_modules/p5/dist/math/calculation.js","../node_modules/p5/dist/math/noise.js","../node_modules/p5/dist/math/random.js","../node_modules/p5/dist/math/math.js","../node_modules/p5/dist/utilities/conversion.js","../node_modules/p5/dist/utilities/utility_functions.js","../node_modules/p5/dist/utilities/time_date.js","../node_modules/p5/dist/webgl/interaction.js","../node_modules/p5/dist/webgl/loading.js","../node_modules/p5/dist/type/textCore.js","../node_modules/p5/dist/type/unicodeRanges.js","../node_modules/p5/dist/type/lib/Typr.js","../node_modules/p5/dist/type/p5.Font.js","../node_modules/p5/dist/webgl/ShaderGenerator.js","../node_modules/p5/dist/core/init.js","../node_modules/p5/dist/shape/index.js","../node_modules/p5/dist/app.js","../node_modules/p5/dist/accessibility/index.js","../node_modules/p5/dist/color/index.js","../node_modules/p5/dist/core/friendly_errors/index.js","../node_modules/p5/dist/data/index.js","../node_modules/p5/dist/dom/index.js","../node_modules/p5/dist/events/index.js","../node_modules/p5/dist/image/index.js","../node_modules/p5/dist/io/index.js","../node_modules/p5/dist/math/index.js","../node_modules/p5/dist/utilities/index.js","../node_modules/p5/dist/webgl/index.js","../node_modules/p5/dist/webgl/text.js","../node_modules/p5/dist/type/index.js"],"sourcesContent":["/**\n * @module Constants\n * @submodule Constants\n * @for p5\n */\n\nconst _PI = Math.PI;\n\n/**\n * Version of this p5.js.\n * @property {String} VERSION\n * @final\n */\nconst VERSION = '2.0.5';\n\n// GRAPHICS RENDERER\n/**\n * The default, two-dimensional renderer in p5.js.\n *\n * Use this when calling <a href=\"#/p5/createCanvas\"> (for example,\n * `createCanvas(400, 400, P2D)`) to specify a 2D context.\n *\n * @typedef {'p2d'} P2D\n * @property {P2D} P2D\n * @final\n */\nconst P2D = 'p2d';\n\n/**\n * A high-dynamic-range (HDR) variant of the default, two-dimensional renderer.\n *\n * When available, this mode can allow for extended color ranges and more\n * dynamic color representation. Use it similarly to `P2D`:\n * `createCanvas(400, 400, P2DHDR)`.\n *\n * @typedef {'p2d-hdr'} P2DHDR\n * @property {P2DHDR} P2DHDR\n * @final\n */\n\nconst P2DHDR = 'p2d-hdr';\n\n/**\n * One of the two render modes in p5.js, used for computationally intensive tasks like 3D rendering and shaders.\n *\n * `WEBGL` differs from the default <a href=\"/reference/p5/P2D\">`P2D`</a> renderer in the following ways:\n *\n * - **Coordinate System** - When drawing in `WEBGL` mode, the origin point (0,0,0) is located at the center of the screen, not the top-left corner. See <a href=\"https://p5js.org/tutorials/coordinates-and-transformations/\">the tutorial page about coordinates and transformations</a>.\n * - **3D Shapes** - `WEBGL` mode can be used to draw 3-dimensional shapes like <a href=\"#/p5/box\">box()</a>, <a href=\"#/p5/sphere\">sphere()</a>, <a href=\"#/p5/cone\">cone()</a>, and <a href=\"https://p5js.org/reference/#3D%20Primitives\">more</a>. See <a href=\"https://p5js.org/tutorials/custom-geometry/\">the tutorial page about custom geometry</a> to make more complex objects.\n * - **Shape Detail** - When drawing in `WEBGL` mode, you can specify how smooth curves should be drawn by using a `detail` parameter. See <a href=\"https://github.com/processing/p5.js/wiki/Getting-started-with-WebGL-in-p5#3d-primitives-shapes\">the wiki section about shapes</a> for a more information and an example.\n * - **Textures** - A texture is like a skin that wraps onto a shape. See <a href=\"https://github.com/processing/p5.js/wiki/Getting-started-with-WebGL-in-p5#textures\">the wiki section about textures</a> for examples of mapping images onto surfaces with textures.\n * - **Materials and Lighting** - `WEBGL` offers different types of lights like <a href=\"#/p5/ambientLight\">ambientLight()</a> to place around a scene. Materials like <a href=\"#/p5/specularMaterial\">specularMaterial()</a> reflect the lighting to convey shape and depth. See <a href=\"https://p5js.org/tutorials/lights-camera-materials/\">the tutorial page for styling and appearance</a> to experiment with different combinations.\n * - **Camera** - The viewport of a `WEBGL` sketch can be adjusted by changing camera attributes. See <a href=\"https://p5js.org/tutorials/lights-camera-materials#camera-and-view\">the tutorial page section about cameras</a> for an explanation of camera controls.\n * - **Text** - `WEBGL` requires opentype/truetype font files to be preloaded using <a href=\"#/p5/loadFont\">loadFont()</a>. See <a href=\"https://github.com/processing/p5.js/wiki/Getting-started-with-WebGL-in-p5#text\">the wiki section about text</a> for details, along with a workaround.\n * - **Shaders** - Shaders are hardware accelerated programs that can be used for a variety of effects and graphics. See the <a href=\"https://p5js.org/tutorials/intro-to-shaders/\">introduction to shaders</a> to get started with shaders in p5.js.\n * - **Graphics Acceleration** - `WEBGL` mode uses the graphics card instead of the CPU, so it may help boost the performance of your sketch (example: drawing more shapes on the screen at once).\n *\n * To learn more about WEBGL mode, check out <a href=\"https://p5js.org/tutorials/#webgl\">all the interactive WEBGL tutorials</a> in the \"Tutorials\" section of this website, or read the wiki article <a href=\"https://github.com/processing/p5.js/wiki/Getting-started-with-WebGL-in-p5\">\"Getting started with WebGL in p5\"</a>.\n *\n * @typedef {unique symbol} WEBGL\n * @property {WEBGL} WEBGL\n * @final\n */\nconst WEBGL = 'webgl';\n/**\n * One of the two possible values of a WebGL canvas (either WEBGL or WEBGL2),\n * which can be used to determine what capabilities the rendering environment\n * has.\n * @typedef {unique symbol} WEBGL2\n * @property {WEBGL2} WEBGL2\n * @final\n */\nconst WEBGL2 = 'webgl2';\n\n// ENVIRONMENT\n/**\n * @typedef {'default'} ARROW\n * @property {ARROW} ARROW\n * @final\n */\nconst ARROW = 'default';\n\n/**\n * @property {String} SIMPLE\n * @final\n */\nconst SIMPLE = 'simple';\n/**\n * @property {String} FULL\n * @final\n */\nconst FULL = 'full';\n\n/**\n * @typedef {'crosshair'} CROSS\n * @property {CROSS} CROSS\n * @final\n */\nconst CROSS = 'crosshair';\n/**\n * @typedef {'pointer'} HAND\n * @property {HAND} HAND\n * @final\n */\nconst HAND = 'pointer';\n/**\n * @typedef {'move'} MOVE\n * @property {MOVE} MOVE\n * @final\n */\nconst MOVE = 'move';\n/**\n * @typedef {'text'} TEXT\n * @property {TEXT} TEXT\n * @final\n */\nconst TEXT = 'text';\n/**\n * @typedef {'wait'} WAIT\n * @property {WAIT} WAIT\n * @final\n */\nconst WAIT = 'wait';\n\n// TRIGONOMETRY\n\n/**\n * A `Number` constant that's approximately 1.5708.\n *\n * `HALF_PI` is half the value of the mathematical constant . It's useful for\n * many tasks that involve rotation and oscillation. For example, calling\n * `rotate(HALF_PI)` rotates the coordinate system `HALF_PI` radians, which is\n * a quarter turn (90).\n *\n * Note: `TWO_PI` radians equals 360, `PI` radians equals 180, `HALF_PI`\n * radians equals 90, and `QUARTER_PI` radians equals 45.\n *\n * @property {Number} HALF_PI\n * @final\n *\n * @example\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Draw an arc from 0 to HALF_PI.\n *   arc(50, 50, 80, 80, 0, HALF_PI);\n *\n *   describe('The bottom-right quarter of a circle drawn in white on a gray background.');\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Translate the origin to the center.\n *   translate(50, 50);\n *\n *   // Draw a line.\n *   line(0, 0, 40, 0);\n *\n *   // Rotate a quarter turn.\n *   rotate(HALF_PI);\n *\n *   // Draw the same line, rotated.\n *   line(0, 0, 40, 0);\n *\n *   describe('Two black lines on a gray background. One line extends from the center to the right. The other line extends from the center to the bottom.');\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   describe(\n *     'A red circle and a blue circle oscillate from left to right on a gray background. The red circle appears to chase the blue circle.'\n *   );\n * }\n *\n * function draw() {\n *   background(200);\n *\n *   // Translate the origin to the center.\n *   translate(50, 50);\n *\n *   // Calculate the x-coordinates.\n *   let x1 = 40 * sin(frameCount * 0.05);\n *   let x2 = 40 * sin(frameCount * 0.05 + HALF_PI);\n *\n *   // Style the oscillators.\n *   noStroke();\n *\n *   // Draw the red oscillator.\n *   fill(255, 0, 0);\n *   circle(x1, 0, 20);\n *\n *   // Draw the blue oscillator.\n *   fill(0, 0, 255);\n *   circle(x2, 0, 20);\n * }\n * </code>\n * </div>\n */\nconst HALF_PI = _PI / 2;\n\n/**\n * A `Number` constant that's approximately 3.1416.\n *\n * `PI` is the mathematical constant . It's useful for many tasks that\n * involve rotation and oscillation. For example, calling `rotate(PI)` rotates\n * the coordinate system `PI` radians, which is a half turn (180).\n *\n * Note: `TWO_PI` radians equals 360, `PI` radians equals 180, `HALF_PI`\n * radians equals 90, and `QUARTER_PI` radians equals 45.\n *\n * @property {Number} PI\n * @final\n *\n * @example\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Draw an arc from 0 to PI.\n *   arc(50, 50, 80, 80, 0, PI);\n *\n *   describe('The bottom half of a circle drawn in white on a gray background.');\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Translate the origin to the center.\n *   translate(50, 50);\n *\n *   // Draw a line.\n *   line(0, 0, 40, 0);\n *\n *   // Rotate a half turn.\n *   rotate(PI);\n *\n *   // Draw the same line, rotated.\n *   line(0, 0, 40, 0);\n *\n *   describe('A horizontal black line on a gray background.');\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   describe(\n *     'A red circle and a blue circle oscillate from left to right on a gray background. The circles drift apart, then meet in the middle, over and over again.'\n *   );\n * }\n *\n * function draw() {\n *   background(200);\n *\n *   // Translate the origin to the center.\n *   translate(50, 50);\n *\n *   // Calculate the x-coordinates.\n *   let x1 = 40 * sin(frameCount * 0.05);\n *   let x2 = 40 * sin(frameCount * 0.05 + PI);\n *\n *   // Style the oscillators.\n *   noStroke();\n *\n *   // Draw the red oscillator.\n *   fill(255, 0, 0);\n *   circle(x1, 0, 20);\n *\n *   // Draw the blue oscillator.\n *   fill(0, 0, 255);\n *   circle(x2, 0, 20);\n * }\n * </code>\n * </div>\n */\nconst PI = _PI;\n\n/**\n * A `Number` constant that's approximately 0.7854.\n *\n * `QUARTER_PI` is one-fourth the value of the mathematical constant . It's\n * useful for many tasks that involve rotation and oscillation. For example,\n * calling `rotate(QUARTER_PI)` rotates the coordinate system `QUARTER_PI`\n * radians, which is an eighth of a turn (45).\n *\n * Note: `TWO_PI` radians equals 360, `PI` radians equals 180, `HALF_PI`\n * radians equals 90, and `QUARTER_PI` radians equals 45.\n *\n * @property {Number} QUARTER_PI\n * @final\n *\n * @example\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Draw an arc from 0 to QUARTER_PI.\n *   arc(50, 50, 80, 80, 0, QUARTER_PI);\n *\n *   describe('A one-eighth slice of a circle drawn in white on a gray background.');\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Translate the origin to the center.\n *   translate(50, 50);\n *\n *   // Draw a line.\n *   line(0, 0, 40, 0);\n *\n *   // Rotate an eighth turn.\n *   rotate(QUARTER_PI);\n *\n *   // Draw the same line, rotated.\n *   line(0, 0, 40, 0);\n *\n *   describe('Two black lines that form a \"V\" opening towards the bottom-right corner of a gray square.');\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   describe(\n *     'A red circle and a blue circle oscillate from left to right on a gray background. The red circle appears to chase the blue circle.'\n *   );\n * }\n *\n * function draw() {\n *   background(200);\n *\n *   // Translate the origin to the center.\n *   translate(50, 50);\n *\n *   // Calculate the x-coordinates.\n *   let x1 = 40 * sin(frameCount * 0.05);\n *   let x2 = 40 * sin(frameCount * 0.05 + QUARTER_PI);\n *\n *   // Style the oscillators.\n *   noStroke();\n *\n *   // Draw the red oscillator.\n *   fill(255, 0, 0);\n *   circle(x1, 0, 20);\n *\n *   // Draw the blue oscillator.\n *   fill(0, 0, 255);\n *   circle(x2, 0, 20);\n * }\n * </code>\n * </div>\n */\nconst QUARTER_PI = _PI / 4;\n\n/**\n * A `Number` constant that's approximately 6.2382.\n *\n * `TAU` is twice the value of the mathematical constant . It's useful for\n * many tasks that involve rotation and oscillation. For example, calling\n * `rotate(TAU)` rotates the coordinate system `TAU` radians, which is one\n * full turn (360). `TAU` and `TWO_PI` are equal.\n *\n * Note: `TAU` radians equals 360, `PI` radians equals 180, `HALF_PI`\n * radians equals 90, and `QUARTER_PI` radians equals 45.\n *\n * @property {Number} TAU\n * @final\n *\n * @example\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Draw an arc from 0 to TAU.\n *   arc(50, 50, 80, 80, 0, TAU);\n *\n *   describe('A white circle drawn on a gray background.');\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Translate the origin to the center.\n *   translate(50, 50);\n *\n *   // Draw a line.\n *   line(0, 0, 40, 0);\n *\n *   // Rotate a full turn.\n *   rotate(TAU);\n *\n *   // Style the second line.\n *   strokeWeight(5);\n *\n *   // Draw the same line, shorter and rotated.\n *   line(0, 0, 20, 0);\n *\n *   describe(\n *     'Two horizontal black lines on a gray background. A thick line extends from the center toward the right. A thin line extends from the end of the thick line.'\n *   );\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   describe(\n *     'A red circle with a blue center oscillates from left to right on a gray background.'\n *   );\n * }\n *\n * function draw() {\n *   background(200);\n *\n *   // Translate the origin to the center.\n *   translate(50, 50);\n *\n *   // Calculate the x-coordinates.\n *   let x1 = 40 * sin(frameCount * 0.05);\n *   let x2 = 40 * sin(frameCount * 0.05 + TAU);\n *\n *   // Style the oscillators.\n *   noStroke();\n *\n *   // Draw the red oscillator.\n *   fill(255, 0, 0);\n *   circle(x1, 0, 20);\n *\n *   // Draw the blue oscillator, smaller.\n *   fill(0, 0, 255);\n *   circle(x2, 0, 10);\n * }\n * </code>\n * </div>\n */\nconst TAU = _PI * 2;\n\n/**\n * A `Number` constant that's approximately 6.2382.\n *\n * `TWO_PI` is twice the value of the mathematical constant . It's useful for\n * many tasks that involve rotation and oscillation. For example, calling\n * `rotate(TWO_PI)` rotates the coordinate system `TWO_PI` radians, which is\n * one full turn (360). `TWO_PI` and `TAU` are equal.\n *\n * Note: `TWO_PI` radians equals 360, `PI` radians equals 180, `HALF_PI`\n * radians equals 90, and `QUARTER_PI` radians equals 45.\n *\n * @property {Number} TWO_PI\n * @final\n *\n * @example\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Draw an arc from 0 to TWO_PI.\n *   arc(50, 50, 80, 80, 0, TWO_PI);\n *\n *   describe('A white circle drawn on a gray background.');\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Translate the origin to the center.\n *   translate(50, 50);\n *\n *   // Draw a line.\n *   line(0, 0, 40, 0);\n *\n *   // Rotate a full turn.\n *   rotate(TWO_PI);\n *\n *   // Style the second line.\n *   strokeWeight(5);\n *\n *   // Draw the same line, shorter and rotated.\n *   line(0, 0, 20, 0);\n *\n *   describe(\n *     'Two horizontal black lines on a gray background. A thick line extends from the center toward the right. A thin line extends from the end of the thick line.'\n *   );\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   describe(\n *     'A red circle with a blue center oscillates from left to right on a gray background.'\n *   );\n * }\n *\n * function draw() {\n *   background(200);\n *\n *   // Translate the origin to the center.\n *   translate(50, 50);\n *\n *   // Calculate the x-coordinates.\n *   let x1 = 40 * sin(frameCount * 0.05);\n *   let x2 = 40 * sin(frameCount * 0.05 + TWO_PI);\n *\n *   // Style the oscillators.\n *   noStroke();\n *\n *   // Draw the red oscillator.\n *   fill(255, 0, 0);\n *   circle(x1, 0, 20);\n *\n *   // Draw the blue oscillator, smaller.\n *   fill(0, 0, 255);\n *   circle(x2, 0, 10);\n * }\n * </code>\n * </div>\n */\nconst TWO_PI = _PI * 2;\n\n/**\n * A `String` constant that's used to set the\n * <a href=\"#/p5/angleMode\">angleMode()</a>.\n *\n * By default, functions such as <a href=\"#/p5/rotate\">rotate()</a> and\n * <a href=\"#/p5/sin\">sin()</a> expect angles measured in units of radians.\n * Calling `angleMode(DEGREES)` ensures that angles are measured in units of\n * degrees.\n *\n * Note: `TWO_PI` radians equals 360.\n *\n * @typedef {unique symbol} DEGREES\n * @property {DEGREES} DEGREES\n * @final\n *\n * @example\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Draw a red arc from 0 to HALF_PI radians.\n *   fill(255, 0, 0);\n *   arc(50, 50, 80, 80, 0, HALF_PI);\n *\n *   // Use degrees.\n *   angleMode(DEGREES);\n *\n *   // Draw a blue arc from 90 to 180.\n *   fill(0, 0, 255);\n *   arc(50, 50, 80, 80, 90, 180);\n *\n *   describe('The bottom half of a circle drawn on a gray background. The bottom-right quarter is red. The bottom-left quarter is blue.');\n * }\n * </code>\n * </div>\n */\n// export const DEGREES = Symbol('degrees');\n\n/**\n * A `String` constant that's used to set the\n * <a href=\"#/p5/angleMode\">angleMode()</a>.\n *\n * By default, functions such as <a href=\"#/p5/rotate\">rotate()</a> and\n * <a href=\"#/p5/sin\">sin()</a> expect angles measured in units of radians.\n * Calling `angleMode(RADIANS)` ensures that angles are measured in units of\n * radians. Doing so can be useful if the\n * <a href=\"#/p5/angleMode\">angleMode()</a> has been set to\n * <a href=\"#/p5/DEGREES\">DEGREES</a>.\n *\n * Note: `TWO_PI` radians equals 360.\n *\n * @typedef {unique symbol} RADIANS\n * @property {RADIANS} RADIANS\n * @final\n *\n * @example\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Use degrees.\n *   angleMode(DEGREES);\n *\n *   // Draw a red arc from 0 to 90.\n *   fill(255, 0, 0);\n *   arc(50, 50, 80, 80, 0, 90);\n *\n *   // Use radians.\n *   angleMode(RADIANS);\n *\n *   // Draw a blue arc from HALF_PI to PI.\n *   fill(0, 0, 255);\n *   arc(50, 50, 80, 80, HALF_PI, PI);\n *\n *   describe('The bottom half of a circle drawn on a gray background. The bottom-right quarter is red. The bottom-left quarter is blue.');\n * }\n * </code>\n * </div>\n */\n// export const RADIANS = Symbol('radians');\nconst DEG_TO_RAD = _PI / 180.0;\nconst RAD_TO_DEG = 180.0 / _PI;\n\n// SHAPE\n/**\n * @typedef {'corner'} CORNER\n * @property {CORNER} CORNER\n * @final\n */\nconst CORNER = 'corner';\n/**\n * @typedef {'corners'} CORNERS\n * @property {CORNERS} CORNERS\n * @final\n */\nconst CORNERS = 'corners';\n/**\n * @typedef {'radius'} RADIUS\n * @property {RADIUS} RADIUS\n * @final\n */\nconst RADIUS = 'radius';\n/**\n * @typedef {'right'} RIGHT\n * @property {RIGHT} RIGHT\n * @final\n */\nconst RIGHT = 'right';\n/**\n * @typedef {'left'} LEFT\n * @property {LEFT} LEFT\n * @final\n */\nconst LEFT = 'left';\n/**\n * @typedef {'center'} CENTER\n * @property {CENTER} CENTER\n * @final\n */\nconst CENTER = 'center';\n/**\n * @typedef {'top'} TOP\n * @property {TOP} TOP\n * @final\n */\nconst TOP = 'top';\n/**\n * @typedef {'bottom'} BOTTOM\n * @property {BOTTOM} BOTTOM\n * @final\n */\nconst BOTTOM = 'bottom';\n/**\n * @typedef {'alphabetic'} BASELINE\n * @property {BASELINE} BASELINE\n * @final\n */\nconst BASELINE = 'alphabetic';\n/**\n * @typedef {0x0000} POINTS\n * @property {POINTS} POINTS\n * @final\n */\nconst POINTS = 0x0000;\n/**\n * @typedef {0x0001} LINES\n * @property {LINES} LINES\n * @final\n */\nconst LINES = 0x0001;\n/**\n * @property {0x0003} LINE_STRIP\n * @property {LINE_STRIP} LINE_STRIP\n * @final\n */\nconst LINE_STRIP = 0x0003;\n/**\n * @typedef {0x0002} LINE_LOOP\n * @property {LINE_LOOP} LINE_LOOP\n * @final\n */\nconst LINE_LOOP = 0x0002;\n/**\n * @typedef {0x0004} TRIANGLES\n * @property {TRIANGLES} TRIANGLES\n * @final\n */\nconst TRIANGLES = 0x0004;\n/**\n * @typedef {0x0006} TRIANGLE_FAN\n * @property {TRIANGLE_FAN} TRIANGLE_FAN\n * @final\n */\nconst TRIANGLE_FAN = 0x0006;\n/**\n * @typedef {0x0005} TRIANGLE_STRIP\n * @property {TRIANGLE_STRIP} TRIANGLE_STRIP\n * @final\n */\nconst TRIANGLE_STRIP = 0x0005;\n/**\n * @typedef {'quads'} QUADS\n * @property {QUADS} QUADS\n * @final\n */\nconst QUADS = 'quads';\n/**\n * @typedef {'quad_strip'} QUAD_STRIP\n * @property {QUAD_STRIP} QUAD_STRIP\n * @final\n */\nconst QUAD_STRIP = 'quad_strip';\n/**\n * @typedef {'tess'} TESS\n * @property {TESS} TESS\n * @final\n */\nconst TESS = 'tess';\n/**\n * @typedef {0x0007} EMPTY_PATH\n * @property {EMPTY_PATH} EMPTY_PATH\n * @final\n */\nconst EMPTY_PATH = 0x0007;\n/**\n * @typedef {0x0008} PATH\n * @property {PATH} PATH\n * @final\n */\nconst PATH = 0x0008;\n/**\n * @typedef {'close'} CLOSE\n * @property {CLOSE} CLOSE\n * @final\n */\nconst CLOSE = 'close';\n/**\n * @typedef {'open'} OPEN\n * @property {OPEN} OPEN\n * @final\n */\nconst OPEN = 'open';\n/**\n * @typedef {'chord'} CHORD\n * @property {CHORD} CHORD\n * @final\n */\nconst CHORD = 'chord';\n/**\n * @typedef {'pie'} PIE\n * @property {PIE} PIE\n * @final\n */\nconst PIE = 'pie';\n/**\n * @typedef {'square'} PROJECT\n * @property {PROJECT} PROJECT\n * @final\n */\nconst PROJECT = 'square'; // PEND: careful this is counterintuitive\n/**\n * @typedef {'butt'} SQUARE\n * @property {SQUERE} SQUARE\n * @final\n */\nconst SQUARE = 'butt';\n/**\n * @typedef {'round'} ROUND\n * @property {ROUND} ROUND\n * @final\n */\nconst ROUND = 'round';\n/**\n * @typedef {'bevel'} BEVEL\n * @property {BEVEL} BEVEL\n * @final\n */\nconst BEVEL = 'bevel';\n/**\n * @typedef {'miter'} MITER\n * @property {MITER} MITER\n * @final\n */\nconst MITER = 'miter';\n\n// DOM EXTENSION\n/**\n * AUTO allows us to automatically set the width or height of an element (but not both),\n * based on the current height and width of the element. Only one parameter can\n * be passed to the <a href=\"/reference/p5.Element/size\">size</a> function as AUTO, at a time.\n *\n * @typedef {'auto'} AUTO\n * @property {AUTO} AUTO\n * @final\n */\nconst AUTO = 'auto';\n// INPUT\n/**\n * @typedef {'Alt'} ALT\n * @property {ALT} ALT\n * @final\n */\nconst ALT = 'Alt';\n\n/**\n * @typedef {'Backspace'} BACKSPACE\n * @property {BACKSPACE} BACKSPACE\n * @final\n */\nconst BACKSPACE = 'Backspace';\n\n/**\n * @typedef {'Control' | 'Control'} CONTROL\n * @property {CONTROL} CONTROL\n * @final\n */\nconst CONTROL = 'Control';\n\n/**\n * @typedef {'Delete'} DELETE\n * @property {DELETE} DELETE\n * @final\n */\nconst DELETE = 'Delete';\n\n/**\n * @typedef {'ArrowDown'} DOWN_ARROW\n * @property {DOWN_ARROW} DOWN_ARROW\n * @final\n */\nconst DOWN_ARROW = 'ArrowDown';\n\n/**\n * @typedef {'Enter'} ENTER\n * @property {ENTER} ENTER\n * @final\n */\nconst ENTER = 'Enter';\n\n/**\n * @typedef {'Escape'} ESCAPE\n * @property {ESCAPE} ESCAPE\n * @final\n */\nconst ESCAPE = 'Escape';\n\n/**\n * @typedef {'ArrowLeft'} LEFT_ARROW\n * @property {LEFT_ARROW} LEFT_ARROW\n * @final\n */\nconst LEFT_ARROW = 'ArrowLeft';\n\n/**\n * @typedef {'Alt'} OPTION\n * @property {OPTION} OPTION\n * @final\n */\nconst OPTION = 'Alt';\n\n/**\n * @typedef {'Enter'} RETURN\n * @property {RETURN} RETURN\n * @final\n */\nconst RETURN = 'Enter';\n\n/**\n * @typedef {'ArrowRight'} RIGHT_ARROW\n * @property {RIGHT_ARROW} RIGHT_ARROW\n * @final\n */\nconst RIGHT_ARROW = 'ArrowRight';\n\n/**\n * @typedef {'Shift'} SHIFT\n * @property {SHIFT} SHIFT\n * @final\n */\nconst SHIFT = 'Shift';\n\n/**\n * @typedef {'Tab'} TAB\n * @property {TAB} TAB\n * @final\n */\nconst TAB = 'Tab';\n\n/**\n * @typedef {'ArrowUp'} UP_ARROW\n * @property {UP_ARROW} UP_ARROW\n * @final\n */\nconst UP_ARROW = 'ArrowUp';\n\n// RENDERING\n/**\n * @typedef {'source-over'} BLEND\n * @property {BLEND} BLEND\n * @final\n */\nconst BLEND = 'source-over';\n/**\n * @typedef {'destination-out'} REMOVE\n * @property {REMOVE} REMOVE\n * @final\n */\nconst REMOVE = 'destination-out';\n/**\n * @typedef {'lighter'} ADD\n * @property {ADD} ADD\n * @final\n */\nconst ADD = 'lighter';\n/**\n * @typedef {'darken'} DARKEST\n * @property {DARKEST} DARKEST\n * @final\n */\nconst DARKEST = 'darken';\n/**\n * @typedef {'lighten'} LIGHTEST\n * @property {LIGHTEST} LIGHTEST\n * @final\n */\nconst LIGHTEST = 'lighten';\n/**\n * @typedef {'difference'} DIFFERENCE\n * @property {DIFFERENCE} DIFFERENCE\n * @final\n */\nconst DIFFERENCE = 'difference';\n/**\n * @typedef {'subtract'} SUBTRACT\n * @property {SUBTRACT} SUBTRACT\n * @final\n */\nconst SUBTRACT = 'subtract';\n/**\n * @typedef {'exclusion'} EXCLUSION\n * @property {EXCLUSION} EXCLUSION\n * @final\n */\nconst EXCLUSION = 'exclusion';\n/**\n * @typedef {'multiply'} MULTIPLY\n * @property {MULTIPLY} MULTIPLY\n * @final\n */\nconst MULTIPLY = 'multiply';\n/**\n * @typedef {'screen'} SCREEN\n * @property {SCREEN} SCREEN\n * @final\n */\nconst SCREEN = 'screen';\n/**\n * @typedef {'copy'} REPLACE\n * @property {REPLACE} REPLACE\n * @final\n */\nconst REPLACE = 'copy';\n/**\n * @typedef {'overlay'} OVERLAY\n * @property {OVERLAY} OVERLAY\n * @final\n */\nconst OVERLAY = 'overlay';\n/**\n * @typedef {'hard-light'} HARD_LIGHT\n * @property {HARD_LIGHT} HARD_LIGHT\n * @final\n */\nconst HARD_LIGHT = 'hard-light';\n/**\n * @typedef {'soft-light'} SOFT_LIGHT\n * @property {SOFT_LIGHT} SOFT_LIGHT\n * @final\n */\nconst SOFT_LIGHT = 'soft-light';\n/**\n * @typedef {'color-dodge'} DODGE\n * @property {DODGE} DODGE\n * @final\n */\nconst DODGE = 'color-dodge';\n/**\n * @typedef {'color-burn'} BURN\n * @property {BURN} BURN\n * @final\n */\nconst BURN = 'color-burn';\n\n// FILTERS\n/**\n * @typedef {'threshold'} THRESHOLD\n * @property {THRESHOLD} THRESHOLD\n * @final\n */\nconst THRESHOLD = 'threshold';\n/**\n * @typedef {'gray'} GRAY\n * @property {GRAY} GRAY\n * @final\n */\nconst GRAY = 'gray';\n/**\n * @typedef {'opaque'} OPAQUE\n * @property {OPAQUE} OPAQUE\n * @final\n */\nconst OPAQUE = 'opaque';\n/**\n * @typedef {'invert'} INVERT\n * @property {INVERT} INVERT\n * @final\n */\nconst INVERT = 'invert';\n/**\n * @typedef {'posterize'} POSTERIZE\n * @property {POSTERIZE} POSTERIZE\n * @final\n */\nconst POSTERIZE = 'posterize';\n/**\n * @typedef {'dilate'} DILATE\n * @property {DILATE} DILATE\n * @final\n */\nconst DILATE = 'dilate';\n/**\n * @typedef {'erode'} ERODE\n * @property {ERODE} ERODE\n * @final\n */\nconst ERODE = 'erode';\n/**\n * @typedef {'blur'} BLUR\n * @property {BLUR} BLUR\n * @final\n */\nconst BLUR = 'blur';\n\n// TYPOGRAPHY\n/**\n * @typedef {'normal'} NORMAL\n * @property {NORMAL} NORMAL\n * @final\n */\nconst NORMAL = 'normal';\n/**\n * @typedef {'italic'} ITALIC\n * @property {ITALIC} ITALIC\n * @final\n */\nconst ITALIC = 'italic';\n/**\n * @typedef {'bold'} BOLD\n * @property {BOLD} BOLD\n * @final\n */\nconst BOLD = 'bold';\n/**\n * @typedef {'bold italic'} BOLDITALIC\n * @property {BOLDITALIC} BOLDITALIC\n * @final\n */\nconst BOLDITALIC = 'bold italic';\n/**\n * @typedef {'CHAR'} CHAR\n * @property {CHAR} CHAR\n * @final\n */\nconst CHAR = 'CHAR';\n/**\n * @typedef {'WORD'} WORD\n * @property {WORD} WORD\n * @final\n */\nconst WORD = 'WORD';\n\n// TYPOGRAPHY-INTERNAL\nconst _DEFAULT_TEXT_FILL = '#000000';\nconst _DEFAULT_LEADMULT = 1.25;\nconst _CTX_MIDDLE = 'middle';\n\n// VERTICES\n/**\n * @typedef {'linear'} LINEAR\n * @property {LINEAR} LINEAR\n * @final\n */\nconst LINEAR = 'linear';\n/**\n * @typedef {'quadratic'} QUADRATIC\n * @property {QUADRATIC} QUADRATIC\n * @final\n */\nconst QUADRATIC = 'quadratic';\n/**\n * @typedef {'bezier'} BEZIER\n * @property {BEZIER} BEZIER\n * @final\n */\nconst BEZIER = 'bezier';\n/**\n * @typedef {'curve'} CURVE\n * @property {CURVE} CURVE\n * @final\n */\nconst CURVE = 'curve';\n\n// WEBGL DRAWMODES\n/**\n * @typedef {'stroke'} STROKE\n * @property {STROKE} STROKE\n * @final\n */\nconst STROKE = 'stroke';\n/**\n * @typedef {'fill'} FILL\n * @property {FILL} FILL\n * @final\n */\nconst FILL = 'fill';\n/**\n * @typedef {'texture'} TEXTURE\n * @property {TEXTURE} TEXTURE\n * @final\n */\nconst TEXTURE = 'texture';\n/**\n * @typedef {'immediate'} IMMEDIATE\n * @property {IMMEDIATE} IMMEDIATE\n * @final\n */\nconst IMMEDIATE = 'immediate';\n\n// WEBGL TEXTURE MODE\n// NORMAL already exists for typography\n/**\n * @typedef {'image'} IMAGE\n * @property {IMAGE} IMAGE\n * @final\n */\nconst IMAGE = 'image';\n\n// WEBGL TEXTURE WRAP AND FILTERING\n// LINEAR already exists above\n/**\n * @typedef {'nearest'} NEAREST\n * @property {NEAREST} NEAREST\n * @final\n */\nconst NEAREST = 'nearest';\n/**\n * @typedef {'repeat'} REPEAT\n * @property {REPEAT} REPEAT\n * @final\n */\nconst REPEAT = 'repeat';\n/**\n * @typedef {'clamp'} CLAMP\n * @property {CLAMP} CLAMP\n * @final\n */\nconst CLAMP = 'clamp';\n/**\n * @typedef {'mirror'} MIRROR\n * @property {MIRROR} MIRROR\n * @final\n */\nconst MIRROR = 'mirror';\n\n// WEBGL GEOMETRY SHADING\n/**\n * @typedef {'flat'} FLAT\n * @property {FLAT} FLAT\n * @final\n */\nconst FLAT = 'flat';\n/**\n * @typedef {'smooth'} SMOOTH\n * @property {SMOOTH} SMOOTH\n * @final\n */\nconst SMOOTH = 'smooth';\n\n// DEVICE-ORIENTATION\n/**\n * @typedef {'landscape'} LANDSCAPE\n * @property {LANDSCAPE} LANDSCAPE\n * @final\n */\nconst LANDSCAPE = 'landscape';\n/**\n * @typedef {'portrait'} PORTRAIT\n * @property {PORTRAIT} PORTRAIT\n * @final\n */\nconst PORTRAIT = 'portrait';\n\n// DEFAULTS\nconst _DEFAULT_STROKE = '#000000';\nconst _DEFAULT_FILL = '#FFFFFF';\n\n/**\n * @typedef {'grid'} GRID\n * @property {GRID} GRID\n * @final\n */\nconst GRID = 'grid';\n\n/**\n * @typedef {'axes'} AXES\n * @property {AXES} AXES\n * @final\n */\nconst AXES = 'axes';\n\n/**\n * @typedef {'label'} LABEL\n * @property {LABEL} LABEL\n * @final\n */\nconst LABEL = 'label';\n/**\n * @typedef {'fallback'} FALLBACK\n * @property {FALLBACK} FALLBACK\n * @final\n */\nconst FALLBACK = 'fallback';\n\n/**\n * @typedef {'contain'} CONTAIN\n * @property {CONTAIN} CONTAIN\n * @final\n */\nconst CONTAIN = 'contain';\n\n/**\n * @typedef {'cover'} COVER\n * @property {COVER} COVER\n * @final\n */\nconst COVER = 'cover';\n\n/**\n * @typedef {'unsigned-byte'} UNSIGNED_BYTE\n * @property {UNSIGNED_BYTE} UNSIGNED_BYTE\n * @final\n */\nconst UNSIGNED_BYTE = 'unsigned-byte';\n\n/**\n * @typedef {'unsigned-int'} UNSIGNED_INT\n * @property {UNSIGNED_INT} UNSIGNED_INT\n * @final\n */\nconst UNSIGNED_INT = 'unsigned-int';\n\n/**\n * @typedef {'float'} FLOAT\n * @property {FLOAT} FLOAT\n * @final\n */\nconst FLOAT = 'float';\n\n/**\n * @typedef {'half-float'} HALF_FLOAT\n * @property {HALF_FLOAT} HALF_FLOAT\n * @final\n */\nconst HALF_FLOAT = 'half-float';\n\n/**\n * The `splineProperty('ends')` mode where splines curve through\n * their first and last points.\n * @typedef {unique symbol} INCLUDE\n * @property {INCLUDE} INCLUDE\n * @final\n */\nconst INCLUDE = Symbol('include');\n\n/**\n * The `splineProperty('ends')` mode where the first and last points in a spline\n * affect the direction of the curve, but are not rendered.\n * @typedef {unique symbol} EXCLUDE\n * @property {EXCLUDE} EXCLUDE\n * @final\n */\nconst EXCLUDE = Symbol('exclude');\n\n/**\n * The `splineProperty('ends')` mode where the spline loops back to its first point.\n * Only used internally.\n * @typedef {unique symbol} JOIN\n * @property {JOIN} JOIN\n * @final\n * @private\n */\nconst JOIN = Symbol('join');\n\nvar constants = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tADD: ADD,\n\tALT: ALT,\n\tARROW: ARROW,\n\tAUTO: AUTO,\n\tAXES: AXES,\n\tBACKSPACE: BACKSPACE,\n\tBASELINE: BASELINE,\n\tBEVEL: BEVEL,\n\tBEZIER: BEZIER,\n\tBLEND: BLEND,\n\tBLUR: BLUR,\n\tBOLD: BOLD,\n\tBOLDITALIC: BOLDITALIC,\n\tBOTTOM: BOTTOM,\n\tBURN: BURN,\n\tCENTER: CENTER,\n\tCHAR: CHAR,\n\tCHORD: CHORD,\n\tCLAMP: CLAMP,\n\tCLOSE: CLOSE,\n\tCONTAIN: CONTAIN,\n\tCONTROL: CONTROL,\n\tCORNER: CORNER,\n\tCORNERS: CORNERS,\n\tCOVER: COVER,\n\tCROSS: CROSS,\n\tCURVE: CURVE,\n\tDARKEST: DARKEST,\n\tDEG_TO_RAD: DEG_TO_RAD,\n\tDELETE: DELETE,\n\tDIFFERENCE: DIFFERENCE,\n\tDILATE: DILATE,\n\tDODGE: DODGE,\n\tDOWN_ARROW: DOWN_ARROW,\n\tEMPTY_PATH: EMPTY_PATH,\n\tENTER: ENTER,\n\tERODE: ERODE,\n\tESCAPE: ESCAPE,\n\tEXCLUDE: EXCLUDE,\n\tEXCLUSION: EXCLUSION,\n\tFALLBACK: FALLBACK,\n\tFILL: FILL,\n\tFLAT: FLAT,\n\tFLOAT: FLOAT,\n\tFULL: FULL,\n\tGRAY: GRAY,\n\tGRID: GRID,\n\tHALF_FLOAT: HALF_FLOAT,\n\tHALF_PI: HALF_PI,\n\tHAND: HAND,\n\tHARD_LIGHT: HARD_LIGHT,\n\tIMAGE: IMAGE,\n\tIMMEDIATE: IMMEDIATE,\n\tINCLUDE: INCLUDE,\n\tINVERT: INVERT,\n\tITALIC: ITALIC,\n\tJOIN: JOIN,\n\tLABEL: LABEL,\n\tLANDSCAPE: LANDSCAPE,\n\tLEFT: LEFT,\n\tLEFT_ARROW: LEFT_ARROW,\n\tLIGHTEST: LIGHTEST,\n\tLINEAR: LINEAR,\n\tLINES: LINES,\n\tLINE_LOOP: LINE_LOOP,\n\tLINE_STRIP: LINE_STRIP,\n\tMIRROR: MIRROR,\n\tMITER: MITER,\n\tMOVE: MOVE,\n\tMULTIPLY: MULTIPLY,\n\tNEAREST: NEAREST,\n\tNORMAL: NORMAL,\n\tOPAQUE: OPAQUE,\n\tOPEN: OPEN,\n\tOPTION: OPTION,\n\tOVERLAY: OVERLAY,\n\tP2D: P2D,\n\tP2DHDR: P2DHDR,\n\tPATH: PATH,\n\tPI: PI,\n\tPIE: PIE,\n\tPOINTS: POINTS,\n\tPORTRAIT: PORTRAIT,\n\tPOSTERIZE: POSTERIZE,\n\tPROJECT: PROJECT,\n\tQUADRATIC: QUADRATIC,\n\tQUADS: QUADS,\n\tQUAD_STRIP: QUAD_STRIP,\n\tQUARTER_PI: QUARTER_PI,\n\tRADIUS: RADIUS,\n\tRAD_TO_DEG: RAD_TO_DEG,\n\tREMOVE: REMOVE,\n\tREPEAT: REPEAT,\n\tREPLACE: REPLACE,\n\tRETURN: RETURN,\n\tRIGHT: RIGHT,\n\tRIGHT_ARROW: RIGHT_ARROW,\n\tROUND: ROUND,\n\tSCREEN: SCREEN,\n\tSHIFT: SHIFT,\n\tSIMPLE: SIMPLE,\n\tSMOOTH: SMOOTH,\n\tSOFT_LIGHT: SOFT_LIGHT,\n\tSQUARE: SQUARE,\n\tSTROKE: STROKE,\n\tSUBTRACT: SUBTRACT,\n\tTAB: TAB,\n\tTAU: TAU,\n\tTESS: TESS,\n\tTEXT: TEXT,\n\tTEXTURE: TEXTURE,\n\tTHRESHOLD: THRESHOLD,\n\tTOP: TOP,\n\tTRIANGLES: TRIANGLES,\n\tTRIANGLE_FAN: TRIANGLE_FAN,\n\tTRIANGLE_STRIP: TRIANGLE_STRIP,\n\tTWO_PI: TWO_PI,\n\tUNSIGNED_BYTE: UNSIGNED_BYTE,\n\tUNSIGNED_INT: UNSIGNED_INT,\n\tUP_ARROW: UP_ARROW,\n\tVERSION: VERSION,\n\tWAIT: WAIT,\n\tWEBGL: WEBGL,\n\tWEBGL2: WEBGL2,\n\tWORD: WORD,\n\t_CTX_MIDDLE: _CTX_MIDDLE,\n\t_DEFAULT_FILL: _DEFAULT_FILL,\n\t_DEFAULT_LEADMULT: _DEFAULT_LEADMULT,\n\t_DEFAULT_STROKE: _DEFAULT_STROKE,\n\t_DEFAULT_TEXT_FILL: _DEFAULT_TEXT_FILL\n});\n\nexport { BLUR as $, AXES as A, BEVEL as B, CENTER as C, DEG_TO_RAD as D, EMPTY_PATH as E, FLAT as F, GRID as G, HAND as H, INCLUDE as I, JOIN as J, OPAQUE as K, LINES as L, MOVE as M, NORMAL as N, OPEN as O, P2D as P, QUADS as Q, RIGHT as R, SQUARE as S, TEXTURE as T, POSTERIZE as U, DILATE as V, WAIT as W, GRAY as X, ERODE as Y, THRESHOLD as Z, INVERT as _, RADIUS as a, BOLDITALIC as a$, WEBGL as a0, IMAGE as a1, _DEFAULT_FILL as a2, _DEFAULT_STROKE as a3, REMOVE as a4, SUBTRACT as a5, DARKEST as a6, LIGHTEST as a7, DIFFERENCE as a8, MULTIPLY as a9, MIRROR as aA, FLOAT as aB, LINEAR as aC, HALF_FLOAT as aD, P2DHDR as aE, QUARTER_PI as aF, TAU as aG, TOP as aH, LINE_STRIP as aI, LINE_LOOP as aJ, TESS as aK, ALT as aL, BACKSPACE as aM, CONTROL as aN, DELETE as aO, DOWN_ARROW as aP, ENTER as aQ, ESCAPE as aR, LEFT_ARROW as aS, OPTION as aT, RETURN as aU, RIGHT_ARROW as aV, SHIFT as aW, TAB as aX, UP_ARROW as aY, ITALIC as aZ, BOLD as a_, EXCLUSION as aa, SCREEN as ab, REPLACE as ac, OVERLAY as ad, HARD_LIGHT as ae, SOFT_LIGHT as af, DODGE as ag, BURN as ah, ADD as ai, PIE as aj, CHORD as ak, VERSION as al, WORD as am, BASELINE as an, LEFT as ao, COVER as ap, CONTAIN as aq, BOTTOM as ar, FILL as as, CLAMP as at, UNSIGNED_INT as au, UNSIGNED_BYTE as av, SIMPLE as aw, FULL as ax, NEAREST as ay, REPEAT as az, ARROW as b, CHAR as b0, _DEFAULT_TEXT_FILL as b1, _DEFAULT_LEADMULT as b2, _CTX_MIDDLE as b3, QUADRATIC as b4, BEZIER as b5, CURVE as b6, STROKE as b7, IMMEDIATE as b8, LANDSCAPE as b9, PORTRAIT as ba, LABEL as bb, FALLBACK as bc, CROSS as c, TEXT as d, CORNER as e, TWO_PI as f, HALF_PI as g, PI as h, CORNERS as i, ROUND as j, PROJECT as k, MITER as l, PATH as m, CLOSE as n, POINTS as o, TRIANGLES as p, TRIANGLE_FAN as q, TRIANGLE_STRIP as r, QUAD_STRIP as s, EXCLUDE as t, BLEND as u, constants as v, AUTO as w, RAD_TO_DEG as x, SMOOTH as y, WEBGL2 as z };\n","/**\n * @module Transform\n * @submodule Transform\n * @for p5\n * @requires core\n * @requires constants\n */\n\nfunction transform(p5, fn){\n  /**\n   * Applies a transformation matrix to the coordinate system.\n   *\n   * Transformations such as\n   * <a href=\"#/p5/translate\">translate()</a>,\n   * <a href=\"#/p5/rotate\">rotate()</a>, and\n   * <a href=\"#/p5/scale\">scale()</a>\n   * use matrix-vector multiplication behind the scenes. A table of numbers,\n   * called a matrix, encodes each transformation. The values in the matrix\n   * then multiply each point on the canvas, which is represented by a vector.\n   *\n   * `applyMatrix()` allows for many transformations to be applied at once. See\n   * <a href=\"https://en.wikipedia.org/wiki/Transformation_matrix\" target=\"_blank\">Wikipedia</a>\n   * and <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Matrix_math_for_the_web\" target=\"_blank\">MDN</a>\n   * for more details about transformations.\n   *\n   * There are two ways to call `applyMatrix()` in two and three dimensions.\n   *\n   * In 2D mode, the parameters `a`, `b`, `c`, `d`, `e`, and `f`, correspond to\n   * elements in the following transformation matrix:\n   *\n   * > <img style=\"max-width: 150px\" src=\"assets/transformation-matrix.png\"\n   * alt=\"The transformation matrix used when applyMatrix is called in 2D mode.\"/>\n   *\n   * The numbers can be passed individually, as in\n   * `applyMatrix(2, 0, 0, 0, 2, 0)`. They can also be passed in an array, as in\n   * `applyMatrix([2, 0, 0, 0, 2, 0])`.\n   *\n   * In 3D mode, the parameters `a`, `b`, `c`, `d`, `e`, `f`, `g`, `h`, `i`,\n   * `j`, `k`, `l`, `m`, `n`, `o`, and `p` correspond to elements in the\n   * following transformation matrix:\n   *\n   * <img style=\"max-width: 300px\" src=\"assets/transformation-matrix-4-4.png\"\n   * alt=\"The transformation matrix used when applyMatrix is called in 3D mode.\"/>\n   *\n   * The numbers can be passed individually, as in\n   * `applyMatrix(2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 1)`. They can\n   * also be passed in an array, as in\n   * `applyMatrix([2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 1])`.\n   *\n   * By default, transformations accumulate. The\n   * <a href=\"#/p5/push\">push()</a> and <a href=\"#/p5/pop\">pop()</a> functions\n   * can be used to isolate transformations within distinct drawing groups.\n   *\n   * Note: Transformations are reset at the beginning of the draw loop. Calling\n   * `applyMatrix()` inside the <a href=\"#/p5/draw\">draw()</a> function won't\n   * cause shapes to transform continuously.\n   *\n   * @method applyMatrix\n   * @param  {Array} arr an array containing the elements of the transformation matrix. Its length should be either 6 (2D) or 16 (3D).\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white circle on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin to the center.\n   *   applyMatrix(1, 0, 0, 1, 50, 50);\n   *\n   *   // Draw the circle at coordinates (0, 0).\n   *   circle(0, 0, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white circle on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin to the center.\n   *   let m = [1, 0, 0, 1, 50, 50];\n   *   applyMatrix(m);\n   *\n   *   // Draw the circle at coordinates (0, 0).\n   *   circle(0, 0, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\"A white rectangle on a gray background. The rectangle's long axis runs from top-left to bottom-right.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate the coordinate system 1/8 turn.\n   *   let angle = QUARTER_PI;\n   *   let ca = cos(angle);\n   *   let sa = sin(angle);\n   *   applyMatrix(ca, sa, -sa, ca, 0, 0);\n   *\n   *   // Draw a rectangle at coordinates (50, 0).\n   *   rect(50, 0, 40, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'Two white squares on a gray background. The larger square appears at the top-center. The smaller square appears at the top-left.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a square at (30, 20).\n   *   square(30, 20, 40);\n   *\n   *   // Scale the coordinate system by a factor of 0.5.\n   *   applyMatrix(0.5, 0, 0, 0.5, 0, 0);\n   *\n   *   // Draw a square at (30, 20).\n   *   // It appears at (15, 10) after scaling.\n   *   square(30, 20, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white quadrilateral on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the shear factor.\n   *   let angle = QUARTER_PI;\n   *   let shearFactor = 1 / tan(HALF_PI - angle);\n   *\n   *   // Shear the coordinate system along the x-axis.\n   *   applyMatrix(1, 0, shearFactor, 1, 0, 0);\n   *\n   *   // Draw the square.\n   *   square(0, 0, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube rotates slowly against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system a little more each frame.\n   *   let angle = frameCount * 0.01;\n   *   let ca = cos(angle);\n   *   let sa = sin(angle);\n   *   applyMatrix(ca, 0, sa, 0, 0, 1, 0, 0, -sa, 0, ca, 0, 0, 0, 0, 1);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method applyMatrix\n   * @param  {Number} a an element of the transformation matrix.\n   * @param  {Number} b an element of the transformation matrix.\n   * @param  {Number} c an element of the transformation matrix.\n   * @param  {Number} d an element of the transformation matrix.\n   * @param  {Number} e an element of the transformation matrix.\n   * @param  {Number} f an element of the transformation matrix.\n   * @chainable\n   */\n  /**\n   * @method applyMatrix\n   * @param  {Number} a\n   * @param  {Number} b\n   * @param  {Number} c\n   * @param  {Number} d\n   * @param  {Number} e\n   * @param  {Number} f\n   * @param  {Number} g an element of the transformation matrix.\n   * @param  {Number} h an element of the transformation matrix.\n   * @param  {Number} i an element of the transformation matrix.\n   * @param  {Number} j an element of the transformation matrix.\n   * @param  {Number} k an element of the transformation matrix.\n   * @param  {Number} l an element of the transformation matrix.\n   * @param  {Number} m an element of the transformation matrix.\n   * @param  {Number} n an element of the transformation matrix.\n   * @param  {Number} o an element of the transformation matrix.\n   * @param  {Number} p an element of the transformation matrix.\n   * @chainable\n   */\n  fn.applyMatrix = function(...args) {\n    let isTypedArray = args[0] instanceof Object.getPrototypeOf(Uint8Array);\n    if (Array.isArray(args[0]) || isTypedArray) {\n      this._renderer.applyMatrix(...args[0]);\n    } else {\n      this._renderer.applyMatrix(...args);\n    }\n    return this;\n  };\n\n  /**\n   * Clears all transformations applied to the coordinate system.\n   *\n   * @method resetMatrix\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'Two circles drawn on a gray background. A blue circle is at the top-left and a red circle is at the bottom-right.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin to the center.\n   *   translate(50, 50);\n   *\n   *   // Draw a blue circle at the coordinates (25, 25).\n   *   fill('blue');\n   *   circle(25, 25, 20);\n   *\n   *   // Clear all transformations.\n   *   // The origin is now at the top-left corner.\n   *   resetMatrix();\n   *\n   *   // Draw a red circle at the coordinates (25, 25).\n   *   fill('red');\n   *   circle(25, 25, 20);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.resetMatrix = function() {\n    this._renderer.resetMatrix();\n    return this;\n  };\n\n  /**\n   * Rotates the coordinate system.\n   *\n   * By default, the positive x-axis points to the right and the positive y-axis\n   * points downward. The `rotate()` function changes this orientation by\n   * rotating the coordinate system about the origin. Everything drawn after\n   * `rotate()` is called will appear to be rotated.\n   *\n   * The first parameter, `angle`, is the amount to rotate. For example, calling\n   * `rotate(1)` rotates the coordinate system clockwise 1 radian which is\n   * nearly 57. `rotate()` interprets angle values using the current\n   * <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * The second parameter, `axis`, is optional. It's used to orient 3D rotations\n   * in WebGL mode. If a <a href=\"#/p5.Vector\">p5.Vector</a> is passed, as in\n   * `rotate(QUARTER_PI, myVector)`, then the coordinate system will rotate\n   * `QUARTER_PI` radians about `myVector`. If an array of vector components is\n   * passed, as in `rotate(QUARTER_PI, [1, 0, 0])`, then the coordinate system\n   * will rotate `QUARTER_PI` radians about a vector with the components\n   * `[1, 0, 0]`.\n   *\n   * By default, transformations accumulate. For example, calling `rotate(1)`\n   * twice has the same effect as calling `rotate(2)` once. The\n   * <a href=\"#/p5/push\">push()</a> and <a href=\"#/p5/pop\">pop()</a> functions\n   * can be used to isolate transformations within distinct drawing groups.\n   *\n   * Note: Transformations are reset at the beginning of the draw loop. Calling\n   * `rotate(1)` inside the <a href=\"#/p5/draw\">draw()</a> function won't cause\n   * shapes to spin.\n   *\n   * @method rotate\n   * @param  {Number} angle angle of rotation in the current <a href=\"#/p5/angleMode\">angleMode()</a>.\n   * @param  {p5.Vector|Number[]} [axis] axis to rotate about in 3D.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     \"A white rectangle on a gray background. The rectangle's long axis runs from top-left to bottom-right.\"\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate the coordinate system 1/8 turn.\n   *   rotate(QUARTER_PI);\n   *\n   *   // Draw a rectangle at coordinates (50, 0).\n   *   rect(50, 0, 40, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     \"A white rectangle on a gray background. The rectangle's long axis runs from top-left to bottom-right.\"\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate the coordinate system 1/16 turn.\n   *   rotate(QUARTER_PI / 2);\n   *\n   *   // Rotate the coordinate system another 1/16 turn.\n   *   rotate(QUARTER_PI / 2);\n   *\n   *   // Draw a rectangle at coordinates (50, 0).\n   *   rect(50, 0, 40, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   describe(\n   *     \"A white rectangle on a gray background. The rectangle's long axis runs from top-left to bottom-right.\"\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate the coordinate system 1/8 turn.\n   *   rotate(45);\n   *\n   *   // Draw a rectangle at coordinates (50, 0).\n   *   rect(50, 0, 40, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A white rectangle on a gray background. The rectangle rotates slowly about the top-left corner. It disappears and reappears periodically.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate the coordinate system a little more each frame.\n   *   let angle = frameCount * 0.01;\n   *   rotate(angle);\n   *\n   *   // Draw a rectangle at coordinates (50, 0).\n   *   rect(50, 0, 40, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\"A cube on a gray background. The cube's front face points to the top-right.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate the coordinate system 1/8 turn about\n   *   // the axis [1, 1, 0].\n   *   let axis = createVector(1, 1, 0);\n   *   rotate(QUARTER_PI, axis);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\"A cube on a gray background. The cube's front face points to the top-right.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate the coordinate system 1/8 turn about\n   *   // the axis [1, 1, 0].\n   *   let axis = [1, 1, 0];\n   *   rotate(QUARTER_PI, axis);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.rotate = function(angle, axis) {\n    // p5._validateParameters('rotate', arguments);\n    this._renderer.rotate(this._toRadians(angle), axis);\n    return this;\n  };\n\n  /**\n   * Rotates the coordinate system about the x-axis in WebGL mode.\n   *\n   * The parameter, `angle`, is the amount to rotate. For example, calling\n   * `rotateX(1)` rotates the coordinate system about the x-axis by 1 radian.\n   * `rotateX()` interprets angle values using the current\n   * <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * By default, transformations accumulate. For example, calling `rotateX(1)`\n   * twice has the same effect as calling `rotateX(2)` once. The\n   * <a href=\"#/p5/push\">push()</a> and <a href=\"#/p5/pop\">pop()</a> functions\n   * can be used to isolate transformations within distinct drawing groups.\n   *\n   * Note: Transformations are reset at the beginning of the draw loop. Calling\n   * `rotateX(1)` inside the <a href=\"#/p5/draw\">draw()</a> function won't cause\n   * shapes to spin.\n   *\n   * @method  rotateX\n   * @param  {Number} angle angle of rotation in the current <a href=\"#/p5/angleMode\">angleMode()</a>.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system 1/8 turn.\n   *   rotateX(QUARTER_PI);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system 1/16 turn.\n   *   rotateX(QUARTER_PI / 2);\n   *\n   *   // Rotate the coordinate system 1/16 turn.\n   *   rotateX(QUARTER_PI / 2);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system 1/8 turn.\n   *   rotateX(45);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube rotates slowly against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system a little more each frame.\n   *   let angle = frameCount * 0.01;\n   *   rotateX(angle);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.rotateX = function(angle) {\n    this._assert3d('rotateX');\n    // p5._validateParameters('rotateX', arguments);\n    this._renderer.rotateX(this._toRadians(angle));\n    return this;\n  };\n\n  /**\n   * Rotates the coordinate system about the y-axis in WebGL mode.\n   *\n   * The parameter, `angle`, is the amount to rotate. For example, calling\n   * `rotateY(1)` rotates the coordinate system about the y-axis by 1 radian.\n   * `rotateY()` interprets angle values using the current\n   * <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * By default, transformations accumulate. For example, calling `rotateY(1)`\n   * twice has the same effect as calling `rotateY(2)` once. The\n   * <a href=\"#/p5/push\">push()</a> and <a href=\"#/p5/pop\">pop()</a> functions\n   * can be used to isolate transformations within distinct drawing groups.\n   *\n   * Note: Transformations are reset at the beginning of the draw loop. Calling\n   * `rotateY(1)` inside the <a href=\"#/p5/draw\">draw()</a> function won't cause\n   * shapes to spin.\n   *\n   * @method rotateY\n   * @param  {Number} angle angle of rotation in the current <a href=\"#/p5/angleMode\">angleMode()</a>.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system 1/8 turn.\n   *   rotateY(QUARTER_PI);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system 1/16 turn.\n   *   rotateY(QUARTER_PI / 2);\n   *\n   *   // Rotate the coordinate system 1/16 turn.\n   *   rotateY(QUARTER_PI / 2);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system 1/8 turn.\n   *   rotateY(45);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube rotates slowly against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system a little more each frame.\n   *   let angle = frameCount * 0.01;\n   *   rotateY(angle);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.rotateY = function(angle) {\n    this._assert3d('rotateY');\n    // p5._validateParameters('rotateY', arguments);\n    this._renderer.rotateY(this._toRadians(angle));\n    return this;\n  };\n\n  /**\n   * Rotates the coordinate system about the z-axis in WebGL mode.\n   *\n   * The parameter, `angle`, is the amount to rotate. For example, calling\n   * `rotateZ(1)` rotates the coordinate system about the z-axis by 1 radian.\n   * `rotateZ()` interprets angle values using the current\n   * <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * By default, transformations accumulate. For example, calling `rotateZ(1)`\n   * twice has the same effect as calling `rotateZ(2)` once. The\n   * <a href=\"#/p5/push\">push()</a> and <a href=\"#/p5/pop\">pop()</a> functions\n   * can be used to isolate transformations within distinct drawing groups.\n   *\n   * Note: Transformations are reset at the beginning of the draw loop. Calling\n   * `rotateZ(1)` inside the <a href=\"#/p5/draw\">draw()</a> function won't cause\n   * shapes to spin.\n   *\n   * @method rotateZ\n   * @param  {Number} angle angle of rotation in the current <a href=\"#/p5/angleMode\">angleMode()</a>.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system 1/8 turn.\n   *   rotateZ(QUARTER_PI);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system 1/16 turn.\n   *   rotateZ(QUARTER_PI / 2);\n   *\n   *   // Rotate the coordinate system 1/16 turn.\n   *   rotateZ(QUARTER_PI / 2);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system 1/8 turn.\n   *   rotateZ(45);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube rotates slowly against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rotate the coordinate system a little more each frame.\n   *   let angle = frameCount * 0.01;\n   *   rotateZ(angle);\n   *\n   *   // Draw a box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.rotateZ = function(angle) {\n    this._assert3d('rotateZ');\n    // p5._validateParameters('rotateZ', arguments);\n    this._renderer.rotateZ(this._toRadians(angle));\n    return this;\n  };\n\n  /**\n   * Scales the coordinate system.\n   *\n   * By default, shapes are drawn at their original scale. A rectangle that's 50\n   * pixels wide appears to take up half the width of a 100 pixel-wide canvas.\n   * The `scale()` function can shrink or stretch the coordinate system so that\n   * shapes appear at different sizes. There are two ways to call `scale()` with\n   * parameters that set the scale factor(s).\n   *\n   * The first way to call `scale()` uses numbers to set the amount of scaling.\n   * The first parameter, `s`, sets the amount to scale each axis. For example,\n   * calling `scale(2)` stretches the x-, y-, and z-axes by a factor of 2. The\n   * next two parameters, `y` and `z`, are optional. They set the amount to\n   * scale the y- and z-axes. For example, calling `scale(2, 0.5, 1)` stretches\n   * the x-axis by a factor of 2, shrinks the y-axis by a factor of 0.5, and\n   * leaves the z-axis unchanged.\n   *\n   * The second way to call `scale()` uses a <a href=\"#/p5.Vector\">p5.Vector</a>\n   * object to set the scale factors. For example, calling `scale(myVector)`\n   * uses the x-, y-, and z-components of `myVector` to set the amount of\n   * scaling along the x-, y-, and z-axes. Doing so is the same as calling\n   * `scale(myVector.x, myVector.y, myVector.z)`.\n   *\n   * By default, transformations accumulate. For example, calling `scale(1)`\n   * twice has the same effect as calling `scale(2)` once. The\n   * <a href=\"#/p5/push\">push()</a> and <a href=\"#/p5/pop\">pop()</a> functions\n   * can be used to isolate transformations within distinct drawing groups.\n   *\n   * Note: Transformations are reset at the beginning of the draw loop. Calling\n   * `scale(2)` inside the <a href=\"#/p5/draw\">draw()</a> function won't cause\n   * shapes to grow continuously.\n   *\n   * @method scale\n   * @param  {Number|p5.Vector|Number[]} s amount to scale along the positive x-axis.\n   * @param  {Number} [y] amount to scale along the positive y-axis. Defaults to `s`.\n   * @param  {Number} [z] amount to scale along the positive z-axis. Defaults to `y`.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'Two white squares on a gray background. The larger square appears at the top-center. The smaller square appears at the top-left.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a square at (30, 20).\n   *   square(30, 20, 40);\n   *\n   *   // Scale the coordinate system by a factor of 0.5.\n   *   scale(0.5);\n   *\n   *   // Draw a square at (30, 20).\n   *   // It appears at (15, 10) after scaling.\n   *   square(30, 20, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A rectangle and a square drawn in white on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a square at (30, 20).\n   *   square(30, 20, 40);\n   *\n   *   // Scale the coordinate system by factors of\n   *   // 0.5 along the x-axis and\n   *   // 1.3 along the y-axis.\n   *   scale(0.5, 1.3);\n   *\n   *   // Draw a square at (30, 20).\n   *   // It appears as a rectangle at (15, 26) after scaling.\n   *   square(30, 20, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A rectangle and a square drawn in white on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a square at (30, 20).\n   *   square(30, 20, 40);\n   *\n   *   // Create a p5.Vector object.\n   *   let v = createVector(0.5, 1.3);\n   *\n   *   // Scale the coordinate system by factors of\n   *   // 0.5 along the x-axis and\n   *   // 1.3 along the y-axis.\n   *   scale(v);\n   *\n   *   // Draw a square at (30, 20).\n   *   // It appears as a rectangle at (15, 26) after scaling.\n   *   square(30, 20, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'A red box and a blue box drawn on a gray background. The red box appears embedded in the blue box.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the spheres.\n   *   noStroke();\n   *\n   *   // Draw the red sphere.\n   *   fill('red');\n   *   box();\n   *\n   *   // Scale the coordinate system by factors of\n   *   // 0.5 along the x-axis and\n   *   // 1.3 along the y-axis and\n   *   // 2 along the z-axis.\n   *   scale(0.5, 1.3, 2);\n   *\n   *   // Draw the blue sphere.\n   *   fill('blue');\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method scale\n   * @param  {p5.Vector|Number[]} scales vector whose components should be used to scale.\n   * @chainable\n   */\n  fn.scale = function(x, y, z) {\n    // p5._validateParameters('scale', arguments);\n    // Only check for Vector argument type if Vector is available\n    if (x instanceof p5.Vector) {\n      const v = x;\n      x = v.x;\n      y = v.y;\n      z = v.z;\n    } else if (Array.isArray(x)) {\n      const rg = x;\n      x = rg[0];\n      y = rg[1];\n      z = rg[2] || 1;\n    }\n    if (isNaN(y)) {\n      y = z = x;\n    } else if (isNaN(z)) {\n      z = 1;\n    }\n\n    this._renderer.scale(x, y, z);\n\n    return this;\n  };\n\n  /**\n   * Shears the x-axis so that shapes appear skewed.\n   *\n   * By default, the x- and y-axes are perpendicular. The `shearX()` function\n   * transforms the coordinate system so that x-coordinates are translated while\n   * y-coordinates are fixed.\n   *\n   * The first parameter, `angle`, is the amount to shear. For example, calling\n   * `shearX(1)` transforms all x-coordinates using the formula\n   * `x = x + y * tan(angle)`. `shearX()` interprets angle values using the\n   * current <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * By default, transformations accumulate. For example, calling\n   * `shearX(1)` twice has the same effect as calling `shearX(2)` once. The\n   * <a href=\"#/p5/push\">push()</a> and\n   * <a href=\"#/p5/pop\">pop()</a> functions can be used to isolate\n   * transformations within distinct drawing groups.\n   *\n   * Note: Transformations are reset at the beginning of the draw loop. Calling\n   * `shearX(1)` inside the <a href=\"#/p5/draw\">draw()</a> function won't\n   * cause shapes to shear continuously.\n   *\n   * @method shearX\n   * @param  {Number} angle angle to shear by in the current <a href=\"#/p5/angleMode\">angleMode()</a>.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white quadrilateral on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Shear the coordinate system along the x-axis.\n   *   shearX(QUARTER_PI);\n   *\n   *   // Draw the square.\n   *   square(0, 0, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   describe('A white quadrilateral on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Shear the coordinate system along the x-axis.\n   *   shearX(45);\n   *\n   *   // Draw the square.\n   *   square(0, 0, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.shearX = function(angle) {\n    // p5._validateParameters('shearX', arguments);\n    const rad = this._toRadians(angle);\n    this._renderer.applyMatrix(1, 0, Math.tan(rad), 1, 0, 0);\n    return this;\n  };\n\n  /**\n   * Shears the y-axis so that shapes appear skewed.\n   *\n   * By default, the x- and y-axes are perpendicular. The `shearY()` function\n   * transforms the coordinate system so that y-coordinates are translated while\n   * x-coordinates are fixed.\n   *\n   * The first parameter, `angle`, is the amount to shear. For example, calling\n   * `shearY(1)` transforms all y-coordinates using the formula\n   * `y = y + x * tan(angle)`. `shearY()` interprets angle values using the\n   * current <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * By default, transformations accumulate. For example, calling\n   * `shearY(1)` twice has the same effect as calling `shearY(2)` once. The\n   * <a href=\"#/p5/push\">push()</a> and\n   * <a href=\"#/p5/pop\">pop()</a> functions can be used to isolate\n   * transformations within distinct drawing groups.\n   *\n   * Note: Transformations are reset at the beginning of the draw loop. Calling\n   * `shearY(1)` inside the <a href=\"#/p5/draw\">draw()</a> function won't\n   * cause shapes to shear continuously.\n   *\n   * @method shearY\n   * @param  {Number} angle angle to shear by in the current <a href=\"#/p5/angleMode\">angleMode()</a>.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white quadrilateral on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Shear the coordinate system along the x-axis.\n   *   shearY(QUARTER_PI);\n   *\n   *   // Draw the square.\n   *   square(0, 0, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   describe('A white quadrilateral on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Shear the coordinate system along the x-axis.\n   *   shearY(45);\n   *\n   *   // Draw the square.\n   *   square(0, 0, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.shearY = function(angle) {\n    // p5._validateParameters('shearY', arguments);\n    const rad = this._toRadians(angle);\n    this._renderer.applyMatrix(1, Math.tan(rad), 0, 1, 0, 0);\n    return this;\n  };\n\n  /**\n   * Translates the coordinate system.\n   *\n   * By default, the origin `(0, 0)` is at the sketch's top-left corner in 2D\n   * mode and center in WebGL mode. The `translate()` function shifts the origin\n   * to a different position. Everything drawn after `translate()` is called\n   * will appear to be shifted. There are two ways to call `translate()` with\n   * parameters that set the origin's position.\n   *\n   * The first way to call `translate()` uses numbers to set the amount of\n   * translation. The first two parameters, `x` and `y`, set the amount to\n   * translate along the positive x- and y-axes. For example, calling\n   * `translate(20, 30)` translates the origin 20 pixels along the x-axis and 30\n   * pixels along the y-axis. The third parameter, `z`, is optional. It sets the\n   * amount to translate along the positive z-axis. For example, calling\n   * `translate(20, 30, 40)` translates the origin 20 pixels along the x-axis,\n   * 30 pixels along the y-axis, and 40 pixels along the z-axis.\n   *\n   * The second way to call `translate()` uses a\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object to set the amount of\n   * translation. For example, calling `translate(myVector)` uses the x-, y-,\n   * and z-components of `myVector` to set the amount to translate along the x-,\n   * y-, and z-axes. Doing so is the same as calling\n   * `translate(myVector.x, myVector.y, myVector.z)`.\n   *\n   * By default, transformations accumulate. For example, calling\n   * `translate(10, 0)` twice has the same effect as calling\n   * `translate(20, 0)` once. The <a href=\"#/p5/push\">push()</a> and\n   * <a href=\"#/p5/pop\">pop()</a> functions can be used to isolate\n   * transformations within distinct drawing groups.\n   *\n   * Note: Transformations are reset at the beginning of the draw loop. Calling\n   * `translate(10, 0)` inside the <a href=\"#/p5/draw\">draw()</a> function won't\n   * cause shapes to move continuously.\n   *\n   * @method translate\n   * @param  {Number} x amount to translate along the positive x-axis.\n   * @param  {Number} y amount to translate along the positive y-axis.\n   * @param  {Number} [z] amount to translate along the positive z-axis.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white circle on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin to the center.\n   *   translate(50, 50);\n   *\n   *   // Draw a circle at coordinates (0, 0).\n   *   circle(0, 0, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'Two circles drawn on a gray background. The blue circle on the right overlaps the red circle at the center.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin to the center.\n   *   translate(50, 50);\n   *\n   *   // Draw the red circle.\n   *   fill('red');\n   *   circle(0, 0, 40);\n   *\n   *   // Translate the origin to the right.\n   *   translate(25, 0);\n   *\n   *   // Draw the blue circle.\n   *   fill('blue');\n   *   circle(0, 0, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white circle moves slowly from left to right on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the x-coordinate.\n   *   let x = frameCount * 0.2;\n   *\n   *   // Translate the origin.\n   *   translate(x, 50);\n   *\n   *   // Draw a circle at coordinates (0, 0).\n   *   circle(0, 0, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white circle on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create a p5.Vector object.\n   *   let v = createVector(50, 50);\n   *\n   *   // Translate the origin by the vector.\n   *   translate(v);\n   *\n   *   // Draw a circle at coordinates (0, 0).\n   *   circle(0, 0, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'Two spheres sitting side-by-side on gray background. The sphere at the center is red. The sphere on the right is blue.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the spheres.\n   *   noStroke();\n   *\n   *   // Draw the red sphere.\n   *   fill('red');\n   *   sphere(10);\n   *\n   *   // Translate the origin to the right.\n   *   translate(30, 0, 0);\n   *\n   *   // Draw the blue sphere.\n   *   fill('blue');\n   *   sphere(10);\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method translate\n   * @param  {p5.Vector} vector vector by which to translate.\n   * @chainable\n   */\n  fn.translate = function(x, y, z) {\n    // p5._validateParameters('translate', arguments);\n    if (this._renderer.isP3D) {\n      this._renderer.translate(x, y, z);\n    } else {\n      this._renderer.translate(x, y);\n    }\n    return this;\n  };\n\n  /**\n   * Begins a drawing group that contains its own styles and transformations.\n   *\n   * By default, styles such as <a href=\"#/p5/fill\">fill()</a> and\n   * transformations such as <a href=\"#/p5/rotate\">rotate()</a> are applied to\n   * all drawing that follows. The `push()` and <a href=\"#/p5/pop\">pop()</a>\n   * functions can limit the effect of styles and transformations to a specific\n   * group of shapes, images, and text. For example, a group of shapes could be\n   * translated to follow the mouse without affecting the rest of the sketch:\n   *\n   * ```js\n   * // Begin the drawing group.\n   * push();\n   *\n   * // Translate the origin to the mouse's position.\n   * translate(mouseX, mouseY);\n   *\n   * // Style the face.\n   * noStroke();\n   * fill('green');\n   *\n   * // Draw the face.\n   * circle(0, 0, 60);\n   *\n   * // Style the eyes.\n   * fill('white');\n   *\n   * // Draw the left eye.\n   * ellipse(-20, -20, 30, 20);\n   *\n   * // Draw the right eye.\n   * ellipse(20, -20, 30, 20);\n   *\n   * // End the drawing group.\n   * pop();\n   *\n   * // Draw a bug.\n   * let x = random(0, 100);\n   * let y = random(0, 100);\n   * text('', x, y);\n   * ```\n   *\n   * In the code snippet above, the bug's position isn't affected by\n   * `translate(mouseX, mouseY)` because that transformation is contained\n   * between `push()` and <a href=\"#/p5/pop\">pop()</a>. The bug moves around\n   * the entire canvas as expected.\n   *\n   * Note: `push()` and <a href=\"#/p5/pop\">pop()</a> are always called as a\n   * pair. Both functions are required to begin and end a drawing group.\n   *\n   * `push()` and <a href=\"#/p5/pop\">pop()</a> can also be nested to create\n   * subgroups. For example, the code snippet above could be changed to give\n   * more detail to the frogs eyes:\n   *\n   * ```js\n   * // Begin the drawing group.\n   * push();\n   *\n   * // Translate the origin to the mouse's position.\n   * translate(mouseX, mouseY);\n   *\n   * // Style the face.\n   * noStroke();\n   * fill('green');\n   *\n   * // Draw a face.\n   * circle(0, 0, 60);\n   *\n   * // Style the eyes.\n   * fill('white');\n   *\n   * // Draw the left eye.\n   * push();\n   * translate(-20, -20);\n   * ellipse(0, 0, 30, 20);\n   * fill('black');\n   * circle(0, 0, 8);\n   * pop();\n   *\n   * // Draw the right eye.\n   * push();\n   * translate(20, -20);\n   * ellipse(0, 0, 30, 20);\n   * fill('black');\n   * circle(0, 0, 8);\n   * pop();\n   *\n   * // End the drawing group.\n   * pop();\n   *\n   * // Draw a bug.\n   * let x = random(0, 100);\n   * let y = random(0, 100);\n   * text('', x, y);\n   * ```\n   *\n   * In this version, the code to draw each eye is contained between its own\n   * `push()` and <a href=\"#/p5/pop\">pop()</a> functions. Doing so makes it\n   * easier to add details in the correct part of a drawing.\n   *\n   * `push()` and <a href=\"#/p5/pop\">pop()</a> contain the effects of the\n   * following functions:\n   *\n   * - <a href=\"#/p5/fill\">fill()</a>\n   * - <a href=\"#/p5/noFill\">noFill()</a>\n   * - <a href=\"#/p5/noStroke\">noStroke()</a>\n   * - <a href=\"#/p5/stroke\">stroke()</a>\n   * - <a href=\"#/p5/tint\">tint()</a>\n   * - <a href=\"#/p5/noTint\">noTint()</a>\n   * - <a href=\"#/p5/strokeWeight\">strokeWeight()</a>\n   * - <a href=\"#/p5/strokeCap\">strokeCap()</a>\n   * - <a href=\"#/p5/strokeJoin\">strokeJoin()</a>\n   * - <a href=\"#/p5/imageMode\">imageMode()</a>\n   * - <a href=\"#/p5/rectMode\">rectMode()</a>\n   * - <a href=\"#/p5/ellipseMode\">ellipseMode()</a>\n   * - <a href=\"#/p5/colorMode\">colorMode()</a>\n   * - <a href=\"#/p5/textAlign\">textAlign()</a>\n   * - <a href=\"#/p5/textFont\">textFont()</a>\n   * - <a href=\"#/p5/textSize\">textSize()</a>\n   * - <a href=\"#/p5/textLeading\">textLeading()</a>\n   * - <a href=\"#/p5/applyMatrix\">applyMatrix()</a>\n   * - <a href=\"#/p5/resetMatrix\">resetMatrix()</a>\n   * - <a href=\"#/p5/rotate\">rotate()</a>\n   * - <a href=\"#/p5/scale\">scale()</a>\n   * - <a href=\"#/p5/shearX\">shearX()</a>\n   * - <a href=\"#/p5/shearY\">shearY()</a>\n   * - <a href=\"#/p5/translate\">translate()</a>\n   *\n   * In WebGL mode, `push()` and <a href=\"#/p5/pop\">pop()</a> contain the\n   * effects of a few additional styles:\n   *\n   * - <a href=\"#/p5/setCamera\">setCamera()</a>\n   * - <a href=\"#/p5/ambientLight\">ambientLight()</a>\n   * - <a href=\"#/p5/directionalLight\">directionalLight()</a>\n   * - <a href=\"#/p5/pointLight\">pointLight()</a> <a href=\"#/p5/texture\">texture()</a>\n   * - <a href=\"#/p5/specularMaterial\">specularMaterial()</a>\n   * - <a href=\"#/p5/shininess\">shininess()</a>\n   * - <a href=\"#/p5/normalMaterial\">normalMaterial()</a>\n   * - <a href=\"#/p5/shader\">shader()</a>\n   *\n   * @method push\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Draw the left circle.\n   *   circle(25, 50, 20);\n   *\n   *   // Begin the drawing group.\n   *   push();\n   *\n   *   // Translate the origin to the center.\n   *   translate(50, 50);\n   *\n   *   // Style the circle.\n   *   strokeWeight(5);\n   *   stroke('royalblue');\n   *   fill('orange');\n   *\n   *   // Draw the circle.\n   *   circle(0, 0, 20);\n   *\n   *   // End the drawing group.\n   *   pop();\n   *\n   *   // Draw the right circle.\n   *   circle(75, 50, 20);\n   *\n   *   describe(\n   *     'Three circles drawn in a row on a gray background. The left and right circles are white with thin, black borders. The middle circle is orange with a thick, blue border.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(24);\n   *\n   *   describe('A mosquito buzzes in front of a green frog. The frog follows the mouse as the user moves.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Begin the drawing group.\n   *   push();\n   *\n   *   // Translate the origin to the mouse's position.\n   *   translate(mouseX, mouseY);\n   *\n   *   // Style the face.\n   *   noStroke();\n   *   fill('green');\n   *\n   *   // Draw a face.\n   *   circle(0, 0, 60);\n   *\n   *   // Style the eyes.\n   *   fill('white');\n   *\n   *   // Draw the left eye.\n   *   push();\n   *   translate(-20, -20);\n   *   ellipse(0, 0, 30, 20);\n   *   fill('black');\n   *   circle(0, 0, 8);\n   *   pop();\n   *\n   *   // Draw the right eye.\n   *   push();\n   *   translate(20, -20);\n   *   ellipse(0, 0, 30, 20);\n   *   fill('black');\n   *   circle(0, 0, 8);\n   *   pop();\n   *\n   *   // End the drawing group.\n   *   pop();\n   *\n   *   // Draw a bug.\n   *   let x = random(0, 100);\n   *   let y = random(0, 100);\n   *   text('', x, y);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'Two spheres drawn on a gray background. The sphere on the left is red and lit from the front. The sphere on the right is a blue wireframe.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the red sphere.\n   *   push();\n   *   translate(-25, 0, 0);\n   *   noStroke();\n   *   directionalLight(255, 0, 0, 0, 0, -1);\n   *   sphere(20);\n   *   pop();\n   *\n   *   // Draw the blue sphere.\n   *   push();\n   *   translate(25, 0, 0);\n   *   strokeWeight(0.3);\n   *   stroke(0, 0, 255);\n   *   noFill();\n   *   sphere(20);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.push = function() {\n    this._renderer.push();\n  };\n\n  /**\n   * Ends a drawing group that contains its own styles and transformations.\n   *\n   * By default, styles such as <a href=\"#/p5/fill\">fill()</a> and\n   * transformations such as <a href=\"#/p5/rotate\">rotate()</a> are applied to\n   * all drawing that follows. The <a href=\"#/p5/push\">push()</a> and `pop()`\n   * functions can limit the effect of styles and transformations to a specific\n   * group of shapes, images, and text. For example, a group of shapes could be\n   * translated to follow the mouse without affecting the rest of the sketch:\n   *\n   * ```js\n   * // Begin the drawing group.\n   * push();\n   *\n   * // Translate the origin to the mouse's position.\n   * translate(mouseX, mouseY);\n   *\n   * // Style the face.\n   * noStroke();\n   * fill('green');\n   *\n   * // Draw the face.\n   * circle(0, 0, 60);\n   *\n   * // Style the eyes.\n   * fill('white');\n   *\n   * // Draw the left eye.\n   * ellipse(-20, -20, 30, 20);\n   *\n   * // Draw the right eye.\n   * ellipse(20, -20, 30, 20);\n   *\n   * // End the drawing group.\n   * pop();\n   *\n   * // Draw a bug.\n   * let x = random(0, 100);\n   * let y = random(0, 100);\n   * text('', x, y);\n   * ```\n   *\n   * In the code snippet above, the bug's position isn't affected by\n   * `translate(mouseX, mouseY)` because that transformation is contained\n   * between <a href=\"#/p5/push\">push()</a> and `pop()`. The bug moves around\n   * the entire canvas as expected.\n   *\n   * Note: <a href=\"#/p5/push\">push()</a> and `pop()` are always called as a\n   * pair. Both functions are required to begin and end a drawing group.\n   *\n   * <a href=\"#/p5/push\">push()</a> and `pop()` can also be nested to create\n   * subgroups. For example, the code snippet above could be changed to give\n   * more detail to the frogs eyes:\n   *\n   * ```js\n   * // Begin the drawing group.\n   * push();\n   *\n   * // Translate the origin to the mouse's position.\n   * translate(mouseX, mouseY);\n   *\n   * // Style the face.\n   * noStroke();\n   * fill('green');\n   *\n   * // Draw a face.\n   * circle(0, 0, 60);\n   *\n   * // Style the eyes.\n   * fill('white');\n   *\n   * // Draw the left eye.\n   * push();\n   * translate(-20, -20);\n   * ellipse(0, 0, 30, 20);\n   * fill('black');\n   * circle(0, 0, 8);\n   * pop();\n   *\n   * // Draw the right eye.\n   * push();\n   * translate(20, -20);\n   * ellipse(0, 0, 30, 20);\n   * fill('black');\n   * circle(0, 0, 8);\n   * pop();\n   *\n   * // End the drawing group.\n   * pop();\n   *\n   * // Draw a bug.\n   * let x = random(0, 100);\n   * let y = random(0, 100);\n   * text('', x, y);\n   * ```\n   *\n   * In this version, the code to draw each eye is contained between its own\n   * <a href=\"#/p5/push\">push()</a> and `pop()` functions. Doing so makes it\n   * easier to add details in the correct part of a drawing.\n   *\n   * <a href=\"#/p5/push\">push()</a> and `pop()` contain the effects of the\n   * following functions:\n   *\n   * - <a href=\"#/p5/fill\">fill()</a>\n   * - <a href=\"#/p5/noFill\">noFill()</a>\n   * - <a href=\"#/p5/noStroke\">noStroke()</a>\n   * - <a href=\"#/p5/stroke\">stroke()</a>\n   * - <a href=\"#/p5/tint\">tint()</a>\n   * - <a href=\"#/p5/noTint\">noTint()</a>\n   * - <a href=\"#/p5/strokeWeight\">strokeWeight()</a>\n   * - <a href=\"#/p5/strokeCap\">strokeCap()</a>\n   * - <a href=\"#/p5/strokeJoin\">strokeJoin()</a>\n   * - <a href=\"#/p5/imageMode\">imageMode()</a>\n   * - <a href=\"#/p5/rectMode\">rectMode()</a>\n   * - <a href=\"#/p5/ellipseMode\">ellipseMode()</a>\n   * - <a href=\"#/p5/colorMode\">colorMode()</a>\n   * - <a href=\"#/p5/textAlign\">textAlign()</a>\n   * - <a href=\"#/p5/textFont\">textFont()</a>\n   * - <a href=\"#/p5/textSize\">textSize()</a>\n   * - <a href=\"#/p5/textLeading\">textLeading()</a>\n   * - <a href=\"#/p5/applyMatrix\">applyMatrix()</a>\n   * - <a href=\"#/p5/resetMatrix\">resetMatrix()</a>\n   * - <a href=\"#/p5/rotate\">rotate()</a>\n   * - <a href=\"#/p5/scale\">scale()</a>\n   * - <a href=\"#/p5/shearX\">shearX()</a>\n   * - <a href=\"#/p5/shearY\">shearY()</a>\n   * - <a href=\"#/p5/translate\">translate()</a>\n   *\n   * In WebGL mode, <a href=\"#/p5/push\">push()</a> and `pop()` contain the\n   * effects of a few additional styles:\n   *\n   * - <a href=\"#/p5/setCamera\">setCamera()</a>\n   * - <a href=\"#/p5/ambientLight\">ambientLight()</a>\n   * - <a href=\"#/p5/directionalLight\">directionalLight()</a>\n   * - <a href=\"#/p5/pointLight\">pointLight()</a> <a href=\"#/p5/texture\">texture()</a>\n   * - <a href=\"#/p5/specularMaterial\">specularMaterial()</a>\n   * - <a href=\"#/p5/shininess\">shininess()</a>\n   * - <a href=\"#/p5/normalMaterial\">normalMaterial()</a>\n   * - <a href=\"#/p5/shader\">shader()</a>\n   *\n   * @method pop\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Draw the left circle.\n   *   circle(25, 50, 20);\n   *\n   *   // Begin the drawing group.\n   *   push();\n   *\n   *   // Translate the origin to the center.\n   *   translate(50, 50);\n   *\n   *   // Style the circle.\n   *   strokeWeight(5);\n   *   stroke('royalblue');\n   *   fill('orange');\n   *\n   *   // Draw the circle.\n   *   circle(0, 0, 20);\n   *\n   *   // End the drawing group.\n   *   pop();\n   *\n   *   // Draw the right circle.\n   *   circle(75, 50, 20);\n   *\n   *   describe(\n   *     'Three circles drawn in a row on a gray background. The left and right circles are white with thin, black borders. The middle circle is orange with a thick, blue border.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(24);\n   *\n   *   describe('A mosquito buzzes in front of a green frog. The frog follows the mouse as the user moves.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Begin the drawing group.\n   *   push();\n   *\n   *   // Translate the origin to the mouse's position.\n   *   translate(mouseX, mouseY);\n   *\n   *   // Style the face.\n   *   noStroke();\n   *   fill('green');\n   *\n   *   // Draw a face.\n   *   circle(0, 0, 60);\n   *\n   *   // Style the eyes.\n   *   fill('white');\n   *\n   *   // Draw the left eye.\n   *   push();\n   *   translate(-20, -20);\n   *   ellipse(0, 0, 30, 20);\n   *   fill('black');\n   *   circle(0, 0, 8);\n   *   pop();\n   *\n   *   // Draw the right eye.\n   *   push();\n   *   translate(20, -20);\n   *   ellipse(0, 0, 30, 20);\n   *   fill('black');\n   *   circle(0, 0, 8);\n   *   pop();\n   *\n   *   // End the drawing group.\n   *   pop();\n   *\n   *   // Draw a bug.\n   *   let x = random(0, 100);\n   *   let y = random(0, 100);\n   *   text('', x, y);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'Two spheres drawn on a gray background. The sphere on the left is red and lit from the front. The sphere on the right is a blue wireframe.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the red sphere.\n   *   push();\n   *   translate(-25, 0, 0);\n   *   noStroke();\n   *   directionalLight(255, 0, 0, 0, 0, -1);\n   *   sphere(20);\n   *   pop();\n   *\n   *   // Draw the blue sphere.\n   *   push();\n   *   translate(25, 0, 0);\n   *   strokeWeight(0.3);\n   *   stroke(0, 0, 255);\n   *   noFill();\n   *   sphere(20);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.pop = function() {\n    this._renderer.pop();\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  transform(p5, p5.prototype);\n}\n\nexport { transform as default };\n","/**\n * @module Structure\n * @submodule Structure\n * @for p5\n * @requires core\n */\n\nfunction structure(p5, fn){\n  /**\n   * Stops the code in <a href=\"#/p5/draw\">draw()</a> from running repeatedly.\n   *\n   * By default, <a href=\"#/p5/draw\">draw()</a> tries to run 60 times per\n   * second. Calling `noLoop()` stops <a href=\"#/p5/draw\">draw()</a> from\n   * repeating. The draw loop can be restarted by calling\n   * <a href=\"#/p5/loop\">loop()</a>. <a href=\"#/p5/draw\">draw()</a> can be run\n   * once by calling <a href=\"#/p5/redraw\">redraw()</a>.\n   *\n   * The <a href=\"#/p5/isLooping\">isLooping()</a> function can be used to check\n   * whether a sketch is looping, as in `isLooping() === true`.\n   *\n   * @method noLoop\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Turn off the draw loop.\n   *   noLoop();\n   *\n   *   describe('A white half-circle on the left edge of a gray square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the circle's x-coordinate.\n   *   let x = frameCount;\n   *\n   *   // Draw the circle.\n   *   // Normally, the circle would move from left to right.\n   *   circle(x, 50, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Double-click to stop the draw loop.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(5);\n   *\n   *   describe('A white circle moves randomly on a gray background. It stops moving when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the circle's coordinates.\n   *   let x = random(0, 100);\n   *   let y = random(0, 100);\n   *\n   *   // Draw the circle.\n   *   // Normally, the circle would move from left to right.\n   *   circle(x, y, 20);\n   * }\n   *\n   * // Stop the draw loop when the user double-clicks.\n   * function doubleClicked() {\n   *   noLoop();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let startButton;\n   * let stopButton;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create the button elements and place them\n   *   // beneath the canvas.\n   *   startButton = createButton('');\n   *   startButton.position(0, 100);\n   *   startButton.size(50, 20);\n   *   stopButton = createButton('');\n   *   stopButton.position(50, 100);\n   *   stopButton.size(50, 20);\n   *\n   *   // Set functions to call when the buttons are pressed.\n   *   startButton.mousePressed(loop);\n   *   stopButton.mousePressed(noLoop);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(5);\n   *\n   *   describe(\n   *     'A white circle moves randomly on a gray background. Play and stop buttons are shown beneath the canvas. The circle stops or starts moving when the user presses a button.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the circle's coordinates.\n   *   let x = random(0, 100);\n   *   let y = random(0, 100);\n   *\n   *   // Draw the circle.\n   *   // Normally, the circle would move from left to right.\n   *   circle(x, y, 20);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noLoop = function() {\n    this._loop = false;\n  };\n\n  /**\n   * Resumes the draw loop after <a href=\"#/p5/noLoop\">noLoop()</a> has been\n   * called.\n   *\n   * By default, <a href=\"#/p5/draw\">draw()</a> tries to run 60 times per\n   * second. Calling <a href=\"#/p5/noLoop\">noLoop()</a> stops\n   * <a href=\"#/p5/draw\">draw()</a> from repeating. The draw loop can be\n   * restarted by calling `loop()`.\n   *\n   * The <a href=\"#/p5/isLooping\">isLooping()</a> function can be used to check\n   * whether a sketch is looping, as in `isLooping() === true`.\n   *\n   * @method loop\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Turn off the draw loop.\n   *   noLoop();\n   *\n   *   describe(\n   *     'A white half-circle on the left edge of a gray square. The circle starts moving to the right when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the circle's x-coordinate.\n   *   let x = frameCount;\n   *\n   *   // Draw the circle.\n   *   circle(x, 50, 20);\n   * }\n   *\n   * // Resume the draw loop when the user double-clicks.\n   * function doubleClicked() {\n   *   loop();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let startButton;\n   * let stopButton;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create the button elements and place them\n   *   // beneath the canvas.\n   *   startButton = createButton('');\n   *   startButton.position(0, 100);\n   *   startButton.size(50, 20);\n   *   stopButton = createButton('');\n   *   stopButton.position(50, 100);\n   *   stopButton.size(50, 20);\n   *\n   *   // Set functions to call when the buttons are pressed.\n   *   startButton.mousePressed(loop);\n   *   stopButton.mousePressed(noLoop);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(5);\n   *\n   *   describe(\n   *     'A white circle moves randomly on a gray background. Play and stop buttons are shown beneath the canvas. The circle stops or starts moving when the user presses a button.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the circle's coordinates.\n   *   let x = random(0, 100);\n   *   let y = random(0, 100);\n   *\n   *   // Draw the circle.\n   *   // Normally, the circle would move from left to right.\n   *   circle(x, y, 20);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.loop = function() {\n    if (!this._loop) {\n      this._loop = true;\n      if (this._setupDone) {\n        this._draw();\n      }\n    }\n  };\n\n  /**\n   * Returns `true` if the draw loop is running and `false` if not.\n   *\n   * By default, <a href=\"#/p5/draw\">draw()</a> tries to run 60 times per\n   * second. Calling <a href=\"#/p5/noLoop\">noLoop()</a> stops\n   * <a href=\"#/p5/draw\">draw()</a> from repeating. The draw loop can be\n   * restarted by calling <a href=\"#/p5/loop\">loop()</a>.\n   *\n   * The `isLooping()` function can be used to check whether a sketch is\n   * looping, as in `isLooping() === true`.\n   *\n   * @method isLooping\n   * @returns {boolean}\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white circle drawn against a gray background. When the user double-clicks, the circle stops or resumes following the mouse.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the circle at the mouse's position.\n   *   circle(mouseX, mouseY, 20);\n   * }\n   *\n   * // Toggle the draw loop when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isLooping() === true) {\n   *     noLoop();\n   *   } else {\n   *     loop();\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.isLooping = function() {\n    return this._loop;\n  };\n\n  /**\n   * Runs the code in <a href=\"#/p5/draw\">draw()</a> once.\n   *\n   * By default, <a href=\"#/p5/draw\">draw()</a> tries to run 60 times per\n   * second. Calling <a href=\"#/p5/noLoop\">noLoop()</a> stops\n   * <a href=\"#/p5/draw\">draw()</a> from repeating. Calling `redraw()` will\n   * execute the code in the <a href=\"#/p5/draw\">draw()</a> function a set\n   * number of times.\n   *\n   * The parameter, `n`, is optional. If a number is passed, as in `redraw(5)`,\n   * then the draw loop will run the given number of times. By default, `n` is\n   * 1.\n   *\n   * @method redraw\n   * @param  {Integer} [n] number of times to run <a href=\"#/p5/draw\">draw()</a>. Defaults to 1.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click the canvas to move the circle.\n   *\n   * let x = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Turn off the draw loop.\n   *   noLoop();\n   *\n   *   describe(\n   *     'A white half-circle on the left edge of a gray square. The circle moves a little to the right when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the circle.\n   *   circle(x, 50, 20);\n   *\n   *   // Increment x.\n   *   x += 5;\n   * }\n   *\n   * // Run the draw loop when the user double-clicks.\n   * function doubleClicked() {\n   *   redraw();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Double-click the canvas to move the circle.\n   *\n   * let x = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Turn off the draw loop.\n   *   noLoop();\n   *\n   *   describe(\n   *     'A white half-circle on the left edge of a gray square. The circle hops to the right when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the circle.\n   *   circle(x, 50, 20);\n   *\n   *   // Increment x.\n   *   x += 5;\n   * }\n   *\n   * // Run the draw loop three times when the user double-clicks.\n   * function doubleClicked() {\n   *   redraw(3);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.redraw = async function(n) {\n    if (this._inUserDraw || !this._setupDone) {\n      return;\n    }\n\n    let numberOfRedraws = parseInt(n);\n    if (isNaN(numberOfRedraws) || numberOfRedraws < 1) {\n      numberOfRedraws = 1;\n    }\n\n    const context = this._isGlobal ? window : this;\n    if (typeof context.draw === 'function') {\n      if (typeof context.setup === 'undefined') {\n        context.scale(context._pixelDensity, context._pixelDensity);\n      }\n      for (let idxRedraw = 0; idxRedraw < numberOfRedraws; idxRedraw++) {\n        context.resetMatrix();\n        if (this._accessibleOutputs.grid || this._accessibleOutputs.text) {\n          this._updateAccsOutput();\n        }\n        if (this._renderer.isP3D) {\n          this._renderer._update();\n        }\n        this.frameCount = context.frameCount + 1;\n        await this._runLifecycleHook('predraw');\n        this._inUserDraw = true;\n        try {\n          await context.draw();\n        } finally {\n          this._inUserDraw = false;\n        }\n        await this._runLifecycleHook('postdraw');\n      }\n    }\n  };\n\n  /**\n   * Creates a new sketch in \"instance\" mode.\n   *\n   * All p5.js sketches are instances of the `p5` class. Put another way, all\n   * p5.js sketches are objects with methods including `pInst.setup()`,\n   * `pInst.draw()`, `pInst.circle()`, and `pInst.fill()`. By default, sketches\n   * run in \"global mode\" to hide some of this complexity.\n   *\n   * In global mode, a default instance of the `p5` class is created\n   * automatically. The default `p5` instance searches the web page's source\n   * code for declarations of system functions such as `setup()`, `draw()`,\n   * and `mousePressed()`, then attaches those functions to itself as methods.\n   * Calling a function such as `circle()` in global mode actually calls the\n   * default `p5` object's `pInst.circle()` method.\n   *\n   * It's often helpful to isolate the code within sketches from the rest of the\n   * code on a web page. Two common use cases are web pages that use other\n   * JavaScript libraries and web pages with multiple sketches. \"Instance mode\"\n   * makes it easy to support both of these scenarios.\n   *\n   * Instance mode sketches support the same API as global mode sketches. They\n   * use a function to bundle, or encapsulate, an entire sketch. The function\n   * containing the sketch is then passed to the `p5()` constructor.\n   *\n   * The first parameter, `sketch`, is a function that contains the sketch. For\n   * example, the statement `new p5(mySketch)` would create a new instance mode\n   * sketch from a function named `mySketch`. The function should have one\n   * parameter, `p`, that's a `p5` object.\n   *\n   * The second parameter, `node`, is optional. If a string is passed, as in\n   * `new p5(mySketch, 'sketch-one')` the new instance mode sketch will become a\n   * child of the HTML element with the id `sketch-one`. If an HTML element is\n   * passed, as in `new p5(mySketch, myElement)`, then the new instance mode\n   * sketch will become a child of the `Element` object called `myElement`.\n   *\n   * @method p5\n   * @param {Object} sketch function containing the sketch.\n   * @param {String|HTMLElement} node ID or reference to the HTML element that will contain the sketch.\n   *\n   * @example\n   * <div class='norender notest'>\n   * <code>\n   * // Declare the function containing the sketch.\n   * function sketch(p) {\n   *\n   *   // Declare the setup() method.\n   *   p.setup = function () {\n   *     p.createCanvas(100, 100);\n   *\n   *     p.describe('A white circle drawn on a gray background.');\n   *   };\n   *\n   *   // Declare the draw() method.\n   *   p.draw = function () {\n   *     p.background(200);\n   *\n   *     // Draw the circle.\n   *     p.circle(50, 50, 20);\n   *   };\n   * }\n   *\n   * // Initialize the sketch.\n   * new p5(sketch);\n   * </code>\n   * </div>\n   *\n   * <div class='norender notest'>\n   * <code>\n   * // Declare the function containing the sketch.\n   * function sketch(p) {\n   *   // Create the sketch's variables within its scope.\n   *   let x = 50;\n   *   let y = 50;\n   *\n   *   // Declare the setup() method.\n   *   p.setup = function () {\n   *     p.createCanvas(100, 100);\n   *\n   *     p.describe('A white circle moves randomly on a gray background.');\n   *   };\n   *\n   *   // Declare the draw() method.\n   *   p.draw = function () {\n   *     p.background(200);\n   *\n   *     // Update x and y.\n   *     x += p.random(-1, 1);\n   *     y += p.random(-1, 1);\n   *\n   *     // Draw the circle.\n   *     p.circle(x, y, 20);\n   *   };\n   * }\n   *\n   * // Initialize the sketch.\n   * new p5(sketch);\n   * </code>\n   * </div>\n   *\n   * <div class='norender notest'>\n   * <code>\n   * // Declare the function containing the sketch.\n   * function sketch(p) {\n   *\n   *   // Declare the setup() method.\n   *   p.setup = function () {\n   *     p.createCanvas(100, 100);\n   *\n   *     p.describe('A white circle drawn on a gray background.');\n   *   };\n   *\n   *   // Declare the draw() method.\n   *   p.draw = function () {\n   *     p.background(200);\n   *\n   *     // Draw the circle.\n   *     p.circle(50, 50, 20);\n   *   };\n   * }\n   *\n   * // Select the web page's body element.\n   * let body = document.querySelector('body');\n   *\n   * // Initialize the sketch and attach it to the web page's body.\n   * new p5(sketch, body);\n   * </code>\n   * </div>\n   *\n   * <div class='norender notest'>\n   * <code>\n   * // Declare the function containing the sketch.\n   * function sketch(p) {\n   *\n   *   // Declare the setup() method.\n   *   p.setup = function () {\n   *     p.createCanvas(100, 100);\n   *\n   *     p.describe(\n   *       'A white circle drawn on a gray background. The circle follows the mouse as the user moves.'\n   *     );\n   *   };\n   *\n   *   // Declare the draw() method.\n   *   p.draw = function () {\n   *     p.background(200);\n   *\n   *     // Draw the circle.\n   *     p.circle(p.mouseX, p.mouseY, 20);\n   *   };\n   * }\n   *\n   * // Initialize the sketch.\n   * new p5(sketch);\n   * </code>\n   * </div>\n   *\n   * <div class='norender notest'>\n   * <code>\n   * // Declare the function containing the sketch.\n   * function sketch(p) {\n   *\n   *   // Declare the setup() method.\n   *   p.setup = function () {\n   *     p.createCanvas(100, 100);\n   *\n   *     p.describe(\n   *       'A white circle drawn on a gray background. The circle follows the mouse as the user moves. The circle becomes black when the user double-clicks.'\n   *     );\n   *   };\n   *\n   *   // Declare the draw() method.\n   *   p.draw = function () {\n   *     p.background(200);\n   *\n   *     // Draw the circle.\n   *     p.circle(p.mouseX, p.mouseY, 20);\n   *   };\n   *\n   *   // Declare the doubleClicked() method.\n   *   p.doubleClicked = function () {\n   *     // Change the fill color when the user double-clicks.\n   *     p.fill(0);\n   *   };\n   * }\n   *\n   * // Initialize the sketch.\n   * new p5(sketch);\n   * </code>\n   * </div>\n   */\n}\n\nif(typeof p5 !== 'undefined'){\n  structure(p5, p5.prototype);\n}\n\nexport { structure as default };\n","import { f as TWO_PI } from '../constants-8IpwyBct.js';\n\n/**\n * @module Math\n * @requires constants\n */\n\n\n/// HELPERS FOR REMAINDER METHOD\nconst calculateRemainder2D = function (xComponent, yComponent) {\n  if (xComponent !== 0) {\n    this.x = this.x % xComponent;\n  }\n  if (yComponent !== 0) {\n    this.y = this.y % yComponent;\n  }\n  return this;\n};\n\nconst calculateRemainder3D = function (xComponent, yComponent, zComponent) {\n  if (xComponent !== 0) {\n    this.x = this.x % xComponent;\n  }\n  if (yComponent !== 0) {\n    this.y = this.y % yComponent;\n  }\n  if (zComponent !== 0) {\n    this.z = this.z % zComponent;\n  }\n  return this;\n};\n\nclass Vector {\n  // This is how it comes in with createVector()\n  // This check if the first argument is a function\n  constructor(...args) {\n    let values = args.map((arg) => arg || 0);\n    if (typeof args[0] === \"function\") {\n      this.isPInst = true;\n      this._fromRadians = args[0];\n      this._toRadians = args[1];\n      values = args.slice(2).map((arg) => arg || 0);\n    }\n    let dimensions = values.length; // TODO: make default 3 if no arguments\n    if (dimensions === 0) {\n      this.dimensions = 2;\n      this._values = [0, 0, 0];\n    } else {\n      this.dimensions = dimensions;\n      this._values = values;\n    }\n  }\n\n  /**\n   * Gets the values of the N-dimensional vector.\n   *\n   * This method returns an array of numbers that represent the vector.\n   * Each number in the array corresponds to a different component of the vector,\n   * like its position in different directions (e.g., x, y, z).\n   *\n   * @returns {Array<number>} The array of values representing the vector.\n   */\n  get values() {\n    return this._values;\n  }\n\n  /**\n   * Sets the values of the vector.\n   *\n   * This method allows you to update the entire vector with a new set of values.\n   * You need to provide an array of numbers, where each number represents a component\n   * of the vector (e.g., x, y, z). The length of the array should match the number of\n   * dimensions of the vector. If the array is shorter, the missing components will be\n   * set to 0. If the array is longer, the extra values will be ignored.\n   *\n   * @param {Array<number>} newValues - An array of numbers representing the new values for the vector.\n   *\n   */\n  set values(newValues) {\n    let dimensions = newValues.length;\n    if (dimensions === 0) {\n      this.dimensions = 2;\n      this._values = [0, 0, 0];\n    } else {\n      this.dimensions = dimensions;\n      this._values = newValues.slice();\n    }\n  }\n\n  /**\n   * Gets the x component of the vector.\n   *\n   * This method returns the value of the x component of the vector.\n   * Think of the x component as the horizontal position or the first number in the vector.\n   * If the x component is not defined, it will return 0.\n   *\n   * @returns {Number} The x component of the vector. Returns 0 if the value is not defined.\n   */\n  get x() {\n    return this._values[0] || 0;\n  }\n\n  /**\n   * Retrieves the value at the specified index from the vector.\n   *\n   * This method allows you to get the value of a specific component of the vector\n   * by providing its index. Think of the vector as a list of numbers, where each\n   * number represents a different direction (like x, y, or z). The index is just\n   * the position of the number in that list.\n   *\n   * For example, if you have a vector with values 10, 20, 30 the index 0 would\n   * give you the first value 10, index 1 would give you the second value 20,\n   * and so on.\n   *\n   * @param {Number} index - The position of the value you want to get from the vector.\n   * @returns {Number} The value at the specified position in the vector.\n   * @throws Will throw an error if the index is out of bounds, meaning if you try to\n   *          get a value from a position that doesn't exist in the vector.\n   */\n  getValue(index) {\n    if (index < this._values.length) {\n      return this._values[index];\n    } else {\n      p5._friendlyError(\n        \"The index parameter is trying to set a value outside the bounds of the vector\",\n        \"p5.Vector.setValue\"\n      );\n    }\n  }\n\n  /**\n   * Sets the value at the specified index of the vector.\n   *\n   * This method allows you to change a specific component of the vector by providing its index and the new value you want to set.\n   * Think of the vector as a list of numbers, where each number represents a different direction (like x, y, or z).\n   * The index is just the position of the number in that list.\n   *\n   * For example, if you have a vector with values [0, 20, 30], and you want to change the second value (20) to 50,\n   * you would use this method with index 1 (since indexes start at 0) and value 50.\n   *\n   * @param {Number} index - The position in the vector where you want to set the new value.\n   * @param {Number} value - The new value you want to set at the specified position.\n   * @throws Will throw an error if the index is outside the bounds of the vector, meaning if you try to set a value at a position that doesn't exist in the vector.\n   */\n  setValue(index, value) {\n    if (index < this._values.length) {\n      this._values[index] = value;\n    } else {\n      p5._friendlyError(\n        \"The index parameter is trying to set a value outside the bounds of the vector\",\n        \"p5.Vector.setValue\"\n      );\n    }\n  }\n\n  /**\n   * Gets the y component of the vector.\n   *\n   * This method returns the value of the y component of the vector.\n   * Think of the y component as the vertical position or the second number in the vector.\n   * If the y component is not defined, it will return 0.\n   *\n   * @returns {Number} The y component of the vector. Returns 0 if the value is not defined.\n   */\n  get y() {\n    return this._values[1] || 0;\n  }\n\n  /**\n   * Gets the z component of the vector.\n   *\n   * This method returns the value of the z component of the vector.\n   * Think of the z component as the depth or the third number in the vector.\n   * If the z component is not defined, it will return 0.\n   *\n   * @returns {Number} The z component of the vector. Returns 0 if the value is not defined.\n   */\n  get z() {\n    return this._values[2] || 0;\n  }\n\n  /**\n   * Gets the w component of the vector.\n   *\n   * This method returns the value of the w component of the vector.\n   * Think of the w component as the fourth number in the vector.\n   * If the w component is not defined, it will return 0.\n   *\n   * @returns {Number} The w component of the vector. Returns 0 if the value is not defined.\n   */\n  get w() {\n    return this._values[3] || 0;\n  }\n\n  /**\n   * Sets the x component of the vector.\n   *\n   * This method allows you to change the x value of the vector.\n   * The x value is the first number in the vector, representing the horizontal position.\n   * By calling this method, you can update the x value to a new number.\n   *\n   * @param {Number} xVal - The new value for the x component.\n   */\n  set x(xVal) {\n    if (this._values.length > 1) {\n      this._values[0] = xVal;\n    }\n  }\n\n  /**\n   * Sets the y component of the vector.\n   *\n   * This method allows you to change the y value of the vector.\n   * The y value is the second number in the vector, representing the vertical position.\n   * By calling this method, you can update the y value to a new number.\n   *\n   * @param {Number} yVal - The new value for the y component.\n   */\n  set y(yVal) {\n    if (this._values.length > 1) {\n      this._values[1] = yVal;\n    }\n  }\n\n  /**\n   * Sets the z component of the vector.\n   *\n   * This method allows you to change the z value of the vector.\n   * The z value is the third number in the vector, representing the depth or the third dimension.\n   * By calling this method, you can update the z value to a new number.\n   *\n   * @param {Number} zVal - The new value for the z component.\n   */\n  set z(zVal) {\n    if (this._values.length > 2) {\n      this._values[2] = zVal;\n    }\n  }\n\n  /**\n   * Sets the w component of the vector.\n   *\n   * This method allows you to change the w value of the vector.\n   * The w value is the fourth number in the vector, representing the fourth dimension.\n   * By calling this method, you can update the w value to a new number.\n   *\n   * @param {Number} wVal - The new value for the w component.\n   */\n  set w(wVal) {\n    if (this._values.length > 3) {\n      this._values[3] = wVal;\n    }\n  }\n\n  /**\n   * Returns a string representation of a vector.\n   *\n   * Calling `toString()` is useful for printing vectors to the console while\n   * debugging.\n   *\n   * @return {String} string representation of the vector.\n   *\n   * @example\n   * <div class = \"norender\">\n   * <code>\n   * function setup() {\n   *   let v = createVector(20, 30);\n   *\n   *   // Prints 'p5.Vector Object : [20, 30, 0]'.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   */\n  toString() {\n    return `[${this.values.join(\", \")}]`;\n  }\n\n  /**\n   * Sets the vector's `x`, `y`, and `z` components.\n   *\n   * `set()` can use separate numbers, as in `v.set(1, 2, 3)`, a\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object, as in `v.set(v2)`, or an\n   * array of numbers, as in `v.set([1, 2, 3])`.\n   *\n   * If a value isn't provided for a component, it will be set to 0. For\n   * example, `v.set(4, 5)` sets `v.x` to 4, `v.y` to 5, and `v.z` to 0.\n   * Calling `set()` with no arguments, as in `v.set()`, sets all the vector's\n   * components to 0.\n   *\n   * @param {Number} [x] x component of the vector.\n   * @param {Number} [y] y component of the vector.\n   * @param {Number} [z] z component of the vector.\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Top left.\n   *   let pos = createVector(25, 25);\n   *   point(pos);\n   *\n   *   // Top right.\n   *   // set() with numbers.\n   *   pos.set(75, 25);\n   *   point(pos);\n   *\n   *   // Bottom right.\n   *   // set() with a p5.Vector.\n   *   let p2 = createVector(75, 75);\n   *   pos.set(p2);\n   *   point(pos);\n   *\n   *   // Bottom left.\n   *   // set() with an array.\n   *   let arr = [25, 75];\n   *   pos.set(arr);\n   *   point(pos);\n   *\n   *   describe('Four black dots arranged in a square on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param {p5.Vector|Number[]} value vector to set.\n   * @chainable\n   */\n  set(...args) {\n    if (args[0] instanceof Vector) {\n      this.values = args[0].values.slice();\n    } else if (Array.isArray(args[0])) {\n      this.values = args[0].map((arg) => arg || 0);\n    } else {\n      this.values = args.map((arg) => arg || 0);\n    }\n    this.dimensions = this.values.length;\n    return this;\n  }\n\n  /**\n   * Returns a copy of the <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   *\n   * @return {p5.Vector} copy of the <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100 ,100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Vector object.\n   *   let pos = createVector(50, 50);\n   *\n   *   // Make a copy.\n   *   let pc = pos.copy();\n   *\n   *   // Draw the point.\n   *   strokeWeight(5);\n   *   point(pc);\n   *\n   *   describe('A black point drawn in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n  copy() {\n    if (this.isPInst) {\n      return new Vector(this._fromRadians, this._toRadians, ...this.values);\n    } else {\n      return new Vector(...this.values);\n    }\n  }\n\n  /**\n   * Adds to a vector's components.\n   *\n   * `add()` can use separate numbers, as in `v.add(1, 2, 3)`,\n   * another <a href=\"#/p5.Vector\">p5.Vector</a> object, as in `v.add(v2)`, or\n   * an array of numbers, as in `v.add([1, 2, 3])`.\n   *\n   * If a value isn't provided for a component, it won't change. For\n   * example, `v.add(4, 5)` adds 4 to `v.x`, 5 to `v.y`, and 0 to `v.z`.\n   * Calling `add()` with no arguments, as in `v.add()`, has no effect.\n   *\n   * This method supports N-dimensional vectors.\n   *\n   * The static version of `add()`, as in `p5.Vector.add(v2, v1)`, returns a new\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change the\n   * originals.\n   *\n   * @param  {Number|Array} x   x component of the vector to be added or an array of components.\n   * @param  {Number} [y] y component of the vector to be added.\n   * @param  {Number} [z] z component of the vector to be added.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Top left.\n   *   let pos = createVector(25, 25);\n   *   point(pos);\n   *\n   *   // Top right.\n   *   // Add numbers.\n   *   pos.add(50, 0);\n   *   point(pos);\n   *\n   *   // Bottom right.\n   *   // Add a p5.Vector.\n   *   let p2 = createVector(0, 50);\n   *   pos.add(p2);\n   *   point(pos);\n   *\n   *   // Bottom left.\n   *   // Add an array.\n   *   let arr = [-50, 0];\n   *   pos.add(arr);\n   *   point(pos);\n   *\n   *   describe('Four black dots arranged in a square on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top left.\n   *   let p1 = createVector(25, 25);\n   *\n   *   // Center.\n   *   let p2 = createVector(50, 50);\n   *\n   *   // Bottom right.\n   *   // Add p1 and p2.\n   *   let p3 = p5.Vector.add(p1, p2);\n   *\n   *   // Draw the points.\n   *   strokeWeight(5);\n   *   point(p1);\n   *   point(p2);\n   *   point(p3);\n   *\n   *   describe('Three black dots in a diagonal line from top left to bottom right.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Three arrows drawn on a gray square. A red arrow extends from the top left corner to the center. A blue arrow extends from the tip of the red arrow. A purple arrow extends from the origin to the tip of the blue arrow.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   let origin = createVector(0, 0);\n   *\n   *   // Draw the red arrow.\n   *   let v1 = createVector(50, 50);\n   *   drawArrow(origin, v1, 'red');\n   *\n   *   // Draw the blue arrow.\n   *   let v2 = createVector(-30, 20);\n   *   drawArrow(v1, v2, 'blue');\n   *\n   *   // Purple arrow.\n   *   let v3 = p5.Vector.add(v1, v2);\n   *   drawArrow(origin, v3, 'purple');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {p5.Vector|Number[]} value The vector to add\n   * @chainable\n   */\n  add(...args) {\n    if (args[0] instanceof Vector) {\n      args = args[0].values;\n    } else if (Array.isArray(args[0])) {\n      args = args[0];\n    }\n    args.forEach((value, index) => {\n      this.values[index] = (this.values[index] || 0) + (value || 0);\n    });\n    return this;\n  }\n\n  /**\n   * Performs modulo (remainder) division with a vector's `x`, `y`, and `z`\n   * components.\n   *\n   * `rem()` can use separate numbers, as in `v.rem(1, 2, 3)`,\n   * another <a href=\"#/p5.Vector\">p5.Vector</a> object, as in `v.rem(v2)`, or\n   * an array of numbers, as in `v.rem([1, 2, 3])`.\n   *\n   * If only one value is provided, as in `v.rem(2)`, then all the components\n   * will be set to their values modulo 2. If two values are provided, as in\n   * `v.rem(2, 3)`, then `v.z` won't change. Calling `rem()` with no\n   * arguments, as in `v.rem()`, has no effect.\n   *\n   * The static version of `rem()`, as in `p5.Vector.rem(v2, v1)`, returns a\n   * new <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change the\n   * originals.\n   *\n   * @param {Number} x x component of divisor vector.\n   * @param {Number} y y component of divisor vector.\n   * @param {Number} z z component of divisor vector.\n   * @chainable\n   *\n   * @example\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(3, 4, 5);\n   *\n   *   // Divide numbers.\n   *   v.rem(2);\n   *\n   *   // Prints 'p5.Vector Object : [1, 0, 1]'.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(3, 4, 5);\n   *\n   *   // Divide numbers.\n   *   v.rem(2, 3);\n   *\n   *   // Prints 'p5.Vector Object : [1, 1, 5]'.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(3, 4, 5);\n   *\n   *   // Divide numbers.\n   *   v.rem(2, 3, 4);\n   *\n   *   // Prints 'p5.Vector Object : [1, 1, 1]'.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v1 = createVector(3, 4, 5);\n   *   let v2 = createVector(2, 3, 4);\n   *\n   *   // Divide a p5.Vector.\n   *   v1.rem(v2);\n   *\n   *   // Prints 'p5.Vector Object : [1, 1, 1]'.\n   *   print(v1.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(3, 4, 5);\n   *\n   *   // Divide an array.\n   *   let arr = [2, 3, 4];\n   *   v.rem(arr);\n   *\n   *   // Prints 'p5.Vector Object : [1, 1, 1]'.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v1 = createVector(3, 4, 5);\n   *   let v2 = createVector(2, 3, 4);\n   *\n   *   // Divide without modifying the original vectors.\n   *   let v3 = p5.Vector.rem(v1, v2);\n   *\n   *   // Prints 'p5.Vector Object : [1, 1, 1]'.\n   *   print(v3.toString());\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param {p5.Vector | Number[]}  value  divisor vector.\n   * @chainable\n   */\n  rem(x, y, z) {\n    if (x instanceof Vector) {\n      if ([x.x, x.y, x.z].every(Number.isFinite)) {\n        const xComponent = parseFloat(x.x);\n        const yComponent = parseFloat(x.y);\n        const zComponent = parseFloat(x.z);\n        return calculateRemainder3D.call(\n          this,\n          xComponent,\n          yComponent,\n          zComponent\n        );\n      }\n    } else if (Array.isArray(x)) {\n      if (x.every((element) => Number.isFinite(element))) {\n        if (x.length === 2) {\n          return calculateRemainder2D.call(this, x[0], x[1]);\n        }\n        if (x.length === 3) {\n          return calculateRemainder3D.call(this, x[0], x[1], x[2]);\n        }\n      }\n    } else if (arguments.length === 1) {\n      if (Number.isFinite(arguments[0]) && arguments[0] !== 0) {\n        this.x = this.x % arguments[0];\n        this.y = this.y % arguments[0];\n        this.z = this.z % arguments[0];\n        return this;\n      }\n    } else if (arguments.length === 2) {\n      const vectorComponents = [...arguments];\n      if (vectorComponents.every((element) => Number.isFinite(element))) {\n        if (vectorComponents.length === 2) {\n          return calculateRemainder2D.call(\n            this,\n            vectorComponents[0],\n            vectorComponents[1]\n          );\n        }\n      }\n    } else if (arguments.length === 3) {\n      const vectorComponents = [...arguments];\n      if (vectorComponents.every((element) => Number.isFinite(element))) {\n        if (vectorComponents.length === 3) {\n          return calculateRemainder3D.call(\n            this,\n            vectorComponents[0],\n            vectorComponents[1],\n            vectorComponents[2]\n          );\n        }\n      }\n    }\n  }\n\n  /**\n   * Subtracts from a vector's `x`, `y`, and `z` components.\n   *\n   * `sub()` can use separate numbers, as in `v.sub(1, 2, 3)`, another\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object, as in `v.sub(v2)`, or an array\n   * of numbers, as in `v.sub([1, 2, 3])`.\n   *\n   * If a value isn't provided for a component, it won't change. For\n   * example, `v.sub(4, 5)` subtracts 4 from `v.x`, 5 from `v.y`, and 0 from `v.z`.\n   * Calling `sub()` with no arguments, as in `v.sub()`, has no effect.\n   *\n   * The static version of `sub()`, as in `p5.Vector.sub(v2, v1)`, returns a new\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change the\n   * originals.\n   *\n   * @param  {Number} x   x component of the vector to subtract.\n   * @param  {Number} [y] y component of the vector to subtract.\n   * @param  {Number} [z] z component of the vector to subtract.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Bottom right.\n   *   let pos = createVector(75, 75);\n   *   point(pos);\n   *\n   *   // Top right.\n   *   // Subtract numbers.\n   *   pos.sub(0, 50);\n   *   point(pos);\n   *\n   *   // Top left.\n   *   // Subtract a p5.Vector.\n   *   let p2 = createVector(50, 0);\n   *   pos.sub(p2);\n   *   point(pos);\n   *\n   *   // Bottom left.\n   *   // Subtract an array.\n   *   let arr = [0, -50];\n   *   pos.sub(arr);\n   *   point(pos);\n   *\n   *   describe('Four black dots arranged in a square on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create p5.Vector objects.\n   *   let p1 = createVector(75, 75);\n   *   let p2 = createVector(50, 50);\n   *\n   *   // Subtract with modifying the original vectors.\n   *   let p3 = p5.Vector.sub(p1, p2);\n   *\n   *   // Draw the points.\n   *   strokeWeight(5);\n   *   point(p1);\n   *   point(p2);\n   *   point(p3);\n   *\n   *   describe('Three black dots in a diagonal line from top left to bottom right.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Three arrows drawn on a gray square. A red and a blue arrow extend from the top left. A purple arrow extends from the tip of the red arrow to the tip of the blue arrow.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   let origin = createVector(0, 0);\n   *\n   *   // Draw the red arrow.\n   *   let v1 = createVector(50, 50);\n   *   drawArrow(origin, v1, 'red');\n   *\n   *   // Draw the blue arrow.\n   *   let v2 = createVector(20, 70);\n   *   drawArrow(origin, v2, 'blue');\n   *\n   *   // Purple arrow.\n   *   let v3 = p5.Vector.sub(v2, v1);\n   *   drawArrow(v1, v3, 'purple');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {p5.Vector|Number[]} value the vector to subtract\n   * @chainable\n   */\n  sub(...args) {\n    if (args[0] instanceof Vector) {\n      args[0].values.forEach((value, index) => {\n        this.values[index] -= value || 0;\n      });\n    } else if (Array.isArray(args[0])) {\n      args[0].forEach((value, index) => {\n        this.values[index] -= value || 0;\n      });\n    } else {\n      args.forEach((value, index) => {\n        this.values[index] -= value || 0;\n      });\n    }\n    return this;\n  }\n\n  /**\n   * Multiplies a vector's `x`, `y`, and `z` components.\n   *\n   * `mult()` can use separate numbers, as in `v.mult(1, 2, 3)`, another\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object, as in `v.mult(v2)`, or an array\n   * of numbers, as in `v.mult([1, 2, 3])`.\n   *\n   * If only one value is provided, as in `v.mult(2)`, then all the components\n   * will be multiplied by 2. If a value isn't provided for a component, it\n   * won't change. For example, `v.mult(4, 5)` multiplies `v.x` by, `v.y` by 5,\n   * and `v.z` by 1. Calling `mult()` with no arguments, as in `v.mult()`, has\n   * no effect.\n   *\n   * The static version of `mult()`, as in `p5.Vector.mult(v, 2)`, returns a new\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change the\n   * originals.\n   *\n   * @method mult\n   * @param  {Number} n The number to multiply with the vector\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Top-left.\n   *   let p = createVector(25, 25);\n   *   point(p);\n   *\n   *   // Center.\n   *   // Multiply all components by 2.\n   *   p.mult(2);\n   *   point(p);\n   *\n   *   describe('Two black dots drawn on a gray square. One dot is in the top left corner and the other is in the center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   strokeWeight(5);\n   *\n   *   // Top-left.\n   *   let p = createVector(25, 25);\n   *   point(p);\n   *\n   *   // Bottom-right.\n   *   // Multiply p.x * 2 and p.y * 3\n   *   p.mult(2, 3);\n   *   point(p);\n   *\n   *   describe('Two black dots drawn on a gray square. One dot is in the top left corner and the other is in the bottom center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Top-left.\n   *   let p = createVector(25, 25);\n   *   point(p);\n   *\n   *   // Bottom-right.\n   *   // Multiply p.x * 2 and p.y * 3\n   *   let arr = [2, 3];\n   *   p.mult(arr);\n   *   point(p);\n   *\n   *   describe('Two black dots drawn on a gray square. One dot is in the top left corner and the other is in the bottom center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Top-left.\n   *   let p = createVector(25, 25);\n   *   point(p);\n   *\n   *   // Bottom-right.\n   *   // Multiply p.x * p2.x and p.y * p2.y\n   *   let p2 = createVector(2, 3);\n   *   p.mult(p2);\n   *   point(p);\n   *\n   *   describe('Two black dots drawn on a gray square. One dot is in the top left corner and the other is in the bottom center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Top-left.\n   *   let p = createVector(25, 25);\n   *   point(p);\n   *\n   *   // Bottom-right.\n   *   // Create a new p5.Vector with\n   *   // p3.x = p.x * p2.x\n   *   // p3.y = p.y * p2.y\n   *   let p2 = createVector(2, 3);\n   *   let p3 = p5.Vector.mult(p, p2);\n   *   point(p3);\n   *\n   *   describe('Two black dots drawn on a gray square. One dot is in the top left corner and the other is in the bottom center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Two arrows extending from the top left corner. The blue arrow is twice the length of the red arrow.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   let origin = createVector(0, 0);\n   *\n   *   // Draw the red arrow.\n   *   let v1 = createVector(25, 25);\n   *   drawArrow(origin, v1, 'red');\n   *\n   *   // Draw the blue arrow.\n   *   let v2 = p5.Vector.mult(v1, 2);\n   *   drawArrow(origin, v2, 'blue');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {Number} x number to multiply with the x component of the vector.\n   * @param  {Number} y number to multiply with the y component of the vector.\n   * @param  {Number} [z] number to multiply with the z component of the vector.\n   * @chainable\n   */\n  /**\n   * @param  {Number[]} arr array to multiply with the components of the vector.\n   * @chainable\n   */\n  /**\n   * @param  {p5.Vector} v vector to multiply with the components of the original vector.\n   * @chainable\n   */\n  mult(...args) {\n    if (args.length === 1 && args[0] instanceof Vector) {\n      const v = args[0];\n      const maxLen = Math.min(this.values.length, v.values.length);\n      for (let i = 0; i < maxLen; i++) {\n        if (Number.isFinite(v.values[i]) && typeof v.values[i] === \"number\") {\n          this._values[i] *= v.values[i];\n        } else {\n          console.warn(\n            \"p5.Vector.prototype.mult:\",\n            \"v contains components that are either undefined or not finite numbers\"\n          );\n          return this;\n        }\n      }\n    } else if (args.length === 1 && Array.isArray(args[0])) {\n      const arr = args[0];\n      const maxLen = Math.min(this.values.length, arr.length);\n      for (let i = 0; i < maxLen; i++) {\n        if (Number.isFinite(arr[i]) && typeof arr[i] === \"number\") {\n          this._values[i] *= arr[i];\n        } else {\n          console.warn(\n            \"p5.Vector.prototype.mult:\",\n            \"arr contains elements that are either undefined or not finite numbers\"\n          );\n          return this;\n        }\n      }\n    } else if (\n      args.length === 1 &&\n      typeof args[0] === \"number\" &&\n      Number.isFinite(args[0])\n    ) {\n      for (let i = 0; i < this._values.length; i++) {\n        this._values[i] *= args[0];\n      }\n    }\n    return this;\n  }\n\n  /**\n   * Divides a vector's `x`, `y`, and `z` components.\n   *\n   * `div()` can use separate numbers, as in `v.div(1, 2, 3)`, another\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object, as in `v.div(v2)`, or an array\n   * of numbers, as in `v.div([1, 2, 3])`.\n   *\n   * If only one value is provided, as in `v.div(2)`, then all the components\n   * will be divided by 2. If a value isn't provided for a component, it\n   * won't change. For example, `v.div(4, 5)` divides `v.x` by, `v.y` by 5,\n   * and `v.z` by 1. Calling `div()` with no arguments, as in `v.div()`, has\n   * no effect.\n   *\n   * The static version of `div()`, as in `p5.Vector.div(v, 2)`, returns a new\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change the\n   * originals.\n   *\n   * @param  {Number}    n The number to divide the vector by\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Center.\n   *   let p = createVector(50, 50);\n   *   point(p);\n   *\n   *   // Top-left.\n   *   // Divide p.x / 2 and p.y / 2\n   *   p.div(2);\n   *   point(p);\n   *\n   *   describe('Two black dots drawn on a gray square. One dot is in the top left corner and the other is in the center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Bottom-right.\n   *   let p = createVector(50, 75);\n   *   point(p);\n   *\n   *   // Top-left.\n   *   // Divide p.x / 2 and p.y / 3\n   *   p.div(2, 3);\n   *   point(p);\n   *\n   *   describe('Two black dots drawn on a gray square. One dot is in the top left corner and the other is in the bottom center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Bottom-right.\n   *   let p = createVector(50, 75);\n   *   point(p);\n   *\n   *   // Top-left.\n   *   // Divide p.x / 2 and p.y / 3\n   *   let arr = [2, 3];\n   *   p.div(arr);\n   *   point(p);\n   *\n   *   describe('Two black dots drawn on a gray square. One dot is in the top left corner and the other is in the bottom center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Bottom-right.\n   *   let p = createVector(50, 75);\n   *   point(p);\n   *\n   *   // Top-left.\n   *   // Divide p.x / 2 and p.y / 3\n   *   let p2 = createVector(2, 3);\n   *   p.div(p2);\n   *   point(p);\n   *\n   *   describe('Two black dots drawn on a gray square. One dot is in the top left corner and the other is in the bottom center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Bottom-right.\n   *   let p = createVector(50, 75);\n   *   point(p);\n   *\n   *   // Top-left.\n   *   // Create a new p5.Vector with\n   *   // p3.x = p.x / p2.x\n   *   // p3.y = p.y / p2.y\n   *   let p2 = createVector(2, 3);\n   *   let p3 = p5.Vector.div(p, p2);\n   *   point(p3);\n   *\n   *   describe('Two black dots drawn on a gray square. One dot is in the top left corner and the other is in the bottom center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function draw() {\n   *   background(200);\n   *\n   *   let origin = createVector(0, 0);\n   *\n   *   // Draw the red arrow.\n   *   let v1 = createVector(50, 50);\n   *   drawArrow(origin, v1, 'red');\n   *\n   *   // Draw the blue arrow.\n   *   let v2 = p5.Vector.div(v1, 2);\n   *   drawArrow(origin, v2, 'blue');\n   *\n   *   describe('Two arrows extending from the top left corner. The blue arrow is half the length of the red arrow.');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {Number} x number to divide with the x component of the vector.\n   * @param  {Number} y number to divide with the y component of the vector.\n   * @param  {Number} [z] number to divide with the z component of the vector.\n   * @chainable\n   */\n  /**\n   * @param  {Number[]} arr array to divide the components of the vector by.\n   * @chainable\n   */\n  /**\n   * @param  {p5.Vector} v vector to divide the components of the original vector by.\n   * @chainable\n   */\n  div(...args) {\n    if (args.length === 0) return this;\n    if (args.length === 1 && args[0] instanceof Vector) {\n      const v = args[0];\n      if (\n        v._values.every(\n          (val) => Number.isFinite(val) && typeof val === \"number\"\n        )\n      ) {\n        if (v._values.some((val) => val === 0)) {\n          console.warn(\"p5.Vector.prototype.div:\", \"divide by 0\");\n          return this;\n        }\n        this._values = this._values.map((val, i) => val / v._values[i]);\n      } else {\n        console.warn(\n          \"p5.Vector.prototype.div:\",\n          \"vector contains components that are either undefined or not finite numbers\"\n        );\n      }\n      return this;\n    }\n\n    if (args.length === 1 && Array.isArray(args[0])) {\n      const arr = args[0];\n      if (arr.every((val) => Number.isFinite(val) && typeof val === \"number\")) {\n        if (arr.some((val) => val === 0)) {\n          console.warn(\"p5.Vector.prototype.div:\", \"divide by 0\");\n          return this;\n        }\n        this._values = this._values.map((val, i) => val / arr[i]);\n      } else {\n        console.warn(\n          \"p5.Vector.prototype.div:\",\n          \"array contains components that are either undefined or not finite numbers\"\n        );\n      }\n      return this;\n    }\n\n    if (args.every((val) => Number.isFinite(val) && typeof val === \"number\")) {\n      if (args.some((val) => val === 0)) {\n        console.warn(\"p5.Vector.prototype.div:\", \"divide by 0\");\n        return this;\n      }\n      this._values = this._values.map((val, i) => val / args[0]);\n    } else {\n      console.warn(\n        \"p5.Vector.prototype.div:\",\n        \"arguments contain components that are either undefined or not finite numbers\"\n      );\n    }\n\n    return this;\n  }\n\n  /**\n   * Calculates the magnitude (length) of the vector.\n   *\n   * Use <a href=\"#/p5/mag\">mag()</a> to calculate the magnitude of a 2D vector\n   * using components as in `mag(x, y)`.\n   *\n   * @return {Number} magnitude of the vector.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Vector object.\n   *   let p = createVector(30, 40);\n   *\n   *   // Draw a line from the origin.\n   *   line(0, 0, p.x, p.y);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the vector's magnitude.\n   *   let m = p.mag();\n   *   text(m, p.x, p.y);\n   *\n   *   describe('A diagonal black line extends from the top left corner of a gray square. The number 50 is written at the end of the line.');\n   * }\n   * </code>\n   * </div>\n   */\n  mag() {\n    return Math.sqrt(this.magSq());\n  }\n\n  /**\n   * Calculates the magnitude (length) of the vector squared.\n   *\n   * @return {Number} squared magnitude of the vector.\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Vector object.\n   *   let p = createVector(30, 40);\n   *\n   *   // Draw a line from the origin.\n   *   line(0, 0, p.x, p.y);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the vector's magnitude squared.\n   *   let m = p.magSq();\n   *   text(m, p.x, p.y);\n   *\n   *   describe('A diagonal black line extends from the top left corner of a gray square. The number 2500 is written at the end of the line.');\n   * }\n   * </code>\n   * </div>\n   */\n  magSq() {\n    return this._values.reduce(\n      (sum, component) => sum + component * component,\n      0\n    );\n  }\n\n  /**\n   * Calculates the dot product of two vectors.\n   *\n   * The dot product is a number that describes the overlap between two vectors.\n   * Visually, the dot product can be thought of as the \"shadow\" one vector\n   * casts on another. The dot product's magnitude is largest when two vectors\n   * point in the same or opposite directions. Its magnitude is 0 when two\n   * vectors form a right angle.\n   *\n   * The version of `dot()` with one parameter interprets it as another\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   *\n   * The version of `dot()` with multiple parameters interprets them as the\n   * `x`, `y`, and `z` components of another vector.\n   *\n   * The static version of `dot()`, as in `p5.Vector.dot(v1, v2)`, is the same\n   * as calling `v1.dot(v2)`.\n   *\n   * @param  {Number} x   x component of the vector.\n   * @param  {Number} [y] y component of the vector.\n   * @param  {Number} [z] z component of the vector.\n   * @return {Number}     dot product.\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v1 = createVector(3, 4);\n   *   let v2 = createVector(3, 0);\n   *\n   *   // Calculate the dot product.\n   *   let dp = v1.dot(v2);\n   *\n   *   // Prints \"9\" to the console.\n   *   print(dp);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v1 = createVector(1, 0);\n   *   let v2 = createVector(0, 1);\n   *\n   *   // Calculate the dot product.\n   *   let dp = p5.Vector.dot(v1, v2);\n   *\n   *   // Prints \"0\" to the console.\n   *   print(dp);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Two arrows drawn on a gray square. A black arrow points to the right and a red arrow follows the mouse. The text \"v1  v2 = something\" changes as the mouse moves.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Center.\n   *   let v0 = createVector(50, 50);\n   *\n   *   // Draw the black arrow.\n   *   let v1 = createVector(30, 0);\n   *   drawArrow(v0, v1, 'black');\n   *\n   *   // Draw the red arrow.\n   *   let v2 = createVector(mouseX - 50, mouseY - 50);\n   *   drawArrow(v0, v2, 'red');\n   *\n   *   // Display the dot product.\n   *   let dp = v2.dot(v1);\n   *   text(`v2  v1 = ${dp}`, 10, 20);\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {p5.Vector} v <a href=\"#/p5.Vector\">p5.Vector</a> to be dotted.\n   * @return {Number}\n   */\n  dot(...args) {\n    if (args[0] instanceof Vector) {\n      return this.dot(...args[0]._values);\n    }\n    return this._values.reduce((sum, component, index) => {\n      return sum + component * (args[index] || 0);\n    }, 0);\n  }\n\n  /**\n   * Calculates the cross product of two vectors.\n   *\n   * The cross product is a vector that points straight out of the plane created\n   * by two vectors. The cross product's magnitude is the area of the parallelogram\n   * formed by the original two vectors.\n   *\n   * The static version of `cross()`, as in `p5.Vector.cross(v1, v2)`, is the same\n   * as calling `v1.cross(v2)`.\n   *\n   * @param  {p5.Vector} v <a href=\"#/p5.Vector\">p5.Vector</a> to be crossed.\n   * @return {p5.Vector}   cross product as a <a href=\"#/p5.Vector\">p5.Vector</a>.\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v1 = createVector(1, 0);\n   *   let v2 = createVector(3, 4);\n   *\n   *   // Calculate the cross product.\n   *   let cp = v1.cross(v2);\n   *\n   *   // Prints \"p5.Vector Object : [0, 0, 4]\" to the console.\n   *   print(cp.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v1 = createVector(1, 0);\n   *   let v2 = createVector(3, 4);\n   *\n   *   // Calculate the cross product.\n   *   let cp = p5.Vector.cross(v1, v2);\n   *\n   *   // Prints \"p5.Vector Object : [0, 0, 4]\" to the console.\n   *   print(cp.toString());\n   * }\n   * </code>\n   * </div>\n   */\n  cross(v) {\n    const x = this.y * v.z - this.z * v.y;\n    const y = this.z * v.x - this.x * v.z;\n    const z = this.x * v.y - this.y * v.x;\n    if (this.isPInst) {\n      return new Vector(this._fromRadians, this._toRadians, x, y, z);\n    } else {\n      return new Vector(x, y, z);\n    }\n  }\n\n  /**\n   * Calculates the distance between two points represented by vectors.\n   *\n   * A point's coordinates can be represented by the components of a vector\n   * that extends from the origin to the point.\n   *\n   * The static version of `dist()`, as in `p5.Vector.dist(v1, v2)`, is the same\n   * as calling `v1.dist(v2)`.\n   *\n   * Use <a href=\"#/p5/dist\">dist()</a> to calculate the distance between points\n   * using coordinates as in `dist(x1, y1, x2, y2)`.\n   *\n   * @method dist\n   * @submodule p5.Vector\n   * @param  {p5.Vector} v x, y, and z coordinates of a <a href=\"#/p5.Vector\">p5.Vector</a>.\n   * @return {Number}      distance.\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create p5.Vector objects.\n   *   let v1 = createVector(1, 0);\n   *   let v2 = createVector(0, 1);\n   *\n   *   // Calculate the distance between them.\n   *   let d = v1.dist(v2);\n   *\n   *   // Prints \"1.414...\" to the console.\n   *   print(d);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create p5.Vector objects.\n   *   let v1 = createVector(1, 0);\n   *   let v2 = createVector(0, 1);\n   *\n   *   // Calculate the distance between them.\n   *   let d = p5.Vector.dist(v1, v2);\n   *\n   *   // Prints \"1.414...\" to the console.\n   *   print(d);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Three arrows drawn on a gray square. A red and a blue arrow extend from the top left. A purple arrow extends from the tip of the red arrow to the tip of the blue arrow. The number 36 is written in black near the purple arrow.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   let origin = createVector(0, 0);\n   *\n   *   // Draw the red arrow.\n   *   let v1 = createVector(50, 50);\n   *   drawArrow(origin, v1, 'red');\n   *\n   *   // Draw the blue arrow.\n   *   let v2 = createVector(20, 70);\n   *   drawArrow(origin, v2, 'blue');\n   *\n   *   // Purple arrow.\n   *   let v3 = p5.Vector.sub(v2, v1);\n   *   drawArrow(v1, v3, 'purple');\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *\n   *   // Display the magnitude. The same as floor(v3.mag());\n   *   let m = floor(p5.Vector.dist(v1, v2));\n   *   text(m, 50, 75);\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  dist(v) {\n    return v.copy().sub(this).mag();\n  }\n\n  /**\n   * Scales the components of a <a href=\"#/p5.Vector\">p5.Vector</a> object so\n   * that its magnitude is 1.\n   *\n   * The static version of `normalize()`,  as in `p5.Vector.normalize(v)`,\n   * returns a new <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change\n   * the original.\n   *\n   * @return {p5.Vector} normalized <a href=\"#/p5.Vector\">p5.Vector</a>.\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Vector.\n   *   let v = createVector(10, 20, 2);\n   *\n   *   // Normalize.\n   *   v.normalize();\n   *\n   *   // Prints \"p5.Vector Object : [0.445..., 0.890..., 0.089...]\" to the console.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Vector.\n   *   let v0 = createVector(10, 20, 2);\n   *\n   *   // Create a normalized copy.\n   *   let v1 = p5.Vector.normalize(v0);\n   *\n   *   // Prints \"p5.Vector Object : [10, 20, 2]\" to the console.\n   *   print(v0.toString());\n   *   // Prints \"p5.Vector Object : [0.445..., 0.890..., 0.089...]\" to the console.\n   *   print(v1.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\"A red and blue arrow extend from the center of a circle. Both arrows follow the mouse, but the blue arrow's length is fixed to the circle's radius.\");\n   * }\n   *\n   * function draw() {\n   *   background(240);\n   *\n   *   // Vector to the center.\n   *   let v0 = createVector(50, 50);\n   *\n   *   // Vector from the center to the mouse.\n   *   let v1 = createVector(mouseX - 50, mouseY - 50);\n   *\n   *   // Circle's radius.\n   *   let r = 25;\n   *\n   *   // Draw the red arrow.\n   *   drawArrow(v0, v1, 'red');\n   *\n   *   // Draw the blue arrow.\n   *   v1.normalize();\n   *   drawArrow(v0, v1.mult(r), 'blue');\n   *\n   *   // Draw the circle.\n   *   noFill();\n   *   circle(50, 50, r * 2);\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  normalize() {\n    const len = this.mag();\n    // here we multiply by the reciprocal instead of calling 'div()'\n    // since div duplicates this zero check.\n    if (len !== 0) this.mult(1 / len);\n    return this;\n  }\n\n  /**\n   * Limits a vector's magnitude to a maximum value.\n   *\n   * The static version of `limit()`, as in `p5.Vector.limit(v, 5)`, returns a\n   * new <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change the\n   * original.\n   *\n   * @param  {Number}    max maximum magnitude for the vector.\n   * @chainable\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(10, 20, 2);\n   *\n   *   // Limit its magnitude.\n   *   v.limit(5);\n   *\n   *   // Prints \"p5.Vector Object : [2.227..., 4.454..., 0.445...]\" to the console.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v0 = createVector(10, 20, 2);\n   *\n   *   // Create a copy an limit its magintude.\n   *   let v1 = p5.Vector.limit(v0, 5);\n   *\n   *   // Prints \"p5.Vector Object : [2.227..., 4.454..., 0.445...]\" to the console.\n   *   print(v1.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\"A red and blue arrow extend from the center of a circle. Both arrows follow the mouse, but the blue arrow never crosses the circle's edge.\");\n   * }\n   * function draw() {\n   *   background(240);\n   *\n   *   // Vector to the center.\n   *   let v0 = createVector(50, 50);\n   *\n   *   // Vector from the center to the mouse.\n   *   let v1 = createVector(mouseX - 50, mouseY - 50);\n   *\n   *   // Circle's radius.\n   *   let r = 25;\n   *\n   *   // Draw the red arrow.\n   *   drawArrow(v0, v1, 'red');\n   *\n   *   // Draw the blue arrow.\n   *   drawArrow(v0, v1.limit(r), 'blue');\n   *\n   *   // Draw the circle.\n   *   noFill();\n   *   circle(50, 50, r * 2);\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  limit(max) {\n    const mSq = this.magSq();\n    if (mSq > max * max) {\n      this.div(Math.sqrt(mSq)) //normalize it\n        .mult(max);\n    }\n    return this;\n  }\n\n  /**\n   * Sets a vector's magnitude to a given value.\n   *\n   * The static version of `setMag()`, as in `p5.Vector.setMag(v, 10)`, returns\n   * a new <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change the\n   * original.\n   *\n   * @param  {Number}    len new length for this vector.\n   * @chainable\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(3, 4, 0);\n   *\n   *   // Prints \"5\" to the console.\n   *   print(v.mag());\n   *\n   *   // Set its magnitude to 10.\n   *   v.setMag(10);\n   *\n   *   // Prints \"p5.Vector Object : [6, 8, 0]\" to the console.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v0 = createVector(3, 4, 0);\n   *\n   *   // Create a copy with a magnitude of 10.\n   *   let v1 = p5.Vector.setMag(v0, 10);\n   *\n   *   // Prints \"5\" to the console.\n   *   print(v0.mag());\n   *\n   *   // Prints \"p5.Vector Object : [6, 8, 0]\" to the console.\n   *   print(v1.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Two arrows extend from the top left corner of a square toward its center. The red arrow reaches the center and the blue arrow only extends part of the way.');\n   * }\n   *\n   * function draw() {\n   *   background(240);\n   *\n   *   let origin = createVector(0, 0);\n   *   let v = createVector(50, 50);\n   *\n   *   // Draw the red arrow.\n   *   drawArrow(origin, v, 'red');\n   *\n   *   // Set v's magnitude to 30.\n   *   v.setMag(30);\n   *\n   *   // Draw the blue arrow.\n   *   drawArrow(origin, v, 'blue');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  setMag(n) {\n    return this.normalize().mult(n);\n  }\n\n  /**\n   * Calculates the angle a 2D vector makes with the positive x-axis.\n   *\n   * By convention, the positive x-axis has an angle of 0. Angles increase in\n   * the clockwise direction.\n   *\n   * If the vector was created with\n   * <a href=\"#/p5/createVector\">createVector()</a>, `heading()` returns angles\n   * in the units of the current <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * The static version of `heading()`, as in `p5.Vector.heading(v)`, works the\n   * same way.\n   *\n   * @return {Number} angle of rotation.\n   *\n   * @example\n   * <div class = \"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(1, 1);\n   *\n   *   // Prints \"0.785...\" to the console.\n   *   print(v.heading());\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   // Prints \"45\" to the console.\n   *   print(v.heading());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class = \"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(1, 1);\n   *\n   *   // Prints \"0.785...\" to the console.\n   *   print(p5.Vector.heading(v));\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   // Prints \"45\" to the console.\n   *   print(p5.Vector.heading(v));\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A black arrow extends from the top left of a square to its center. The text \"Radians: 0.79\" and \"Degrees: 45\" is written near the tip of the arrow.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   let origin = createVector(0, 0);\n   *   let v = createVector(50, 50);\n   *\n   *   // Draw the black arrow.\n   *   drawArrow(origin, v, 'black');\n   *\n   *   // Use radians.\n   *   angleMode(RADIANS);\n   *\n   *   // Display the heading in radians.\n   *   let h = round(v.heading(), 2);\n   *   text(`Radians: ${h}`, 20, 70);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   // Display the heading in degrees.\n   *   h = v.heading();\n   *   text(`Degrees: ${h}`, 20, 85);\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  heading() {\n    const h = Math.atan2(this.y, this.x);\n    if (this.isPInst) return this._fromRadians(h);\n    return h;\n  }\n\n  /**\n   * Rotates a 2D vector to a specific angle without changing its magnitude.\n   *\n   * By convention, the positive x-axis has an angle of 0. Angles increase in\n   * the clockwise direction.\n   *\n   * If the vector was created with\n   * <a href=\"#/p5/createVector\">createVector()</a>, `setHeading()` uses\n   * the units of the current <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * @param  {Number}    angle angle of rotation.\n   * @chainable\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(0, 1);\n   *\n   *   // Prints \"1.570...\" to the console.\n   *   print(v.heading());\n   *\n   *   // Point to the left.\n   *   v.setHeading(PI);\n   *\n   *   // Prints \"3.141...\" to the console.\n   *   print(v.heading());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   // Create a p5.Vector object.\n   *   let v = createVector(0, 1);\n   *\n   *   // Prints \"90\" to the console.\n   *   print(v.heading());\n   *\n   *   // Point to the left.\n   *   v.setHeading(180);\n   *\n   *   // Prints \"180\" to the console.\n   *   print(v.heading());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Two arrows extend from the center of a gray square. The red arrow points to the right and the blue arrow points down.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(50, 50);\n   *   let v1 = createVector(30, 0);\n   *\n   *   // Draw the red arrow.\n   *   drawArrow(v0, v1, 'red');\n   *\n   *   // Point down.\n   *   v1.setHeading(HALF_PI);\n   *\n   *   // Draw the blue arrow.\n   *   drawArrow(v0, v1, 'blue');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  setHeading(a) {\n    if (this.isPInst) a = this._toRadians(a);\n    let m = this.mag();\n    this.x = m * Math.cos(a);\n    this.y = m * Math.sin(a);\n    return this;\n  }\n\n  /**\n   * Rotates a 2D vector by an angle without changing its magnitude.\n   *\n   * By convention, the positive x-axis has an angle of 0. Angles increase in\n   * the clockwise direction.\n   *\n   * If the vector was created with\n   * <a href=\"#/p5/createVector\">createVector()</a>, `rotate()` uses\n   * the units of the current <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * The static version of `rotate()`, as in `p5.Vector.rotate(v, PI)`,\n   * returns a new <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change\n   * the original.\n   *\n   * @param  {Number}    angle angle of rotation.\n   * @chainable\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(1, 0);\n   *\n   *   // Prints \"p5.Vector Object : [1, 0, 0]\" to the console.\n   *   print(v.toString());\n   *\n   *   // Rotate a quarter turn.\n   *   v.rotate(HALF_PI);\n   *\n   *   // Prints \"p5.Vector Object : [0, 1, 0]\" to the console.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   // Create a p5.Vector object.\n   *   let v = createVector(1, 0);\n   *\n   *   // Prints \"p5.Vector Object : [1, 0, 0]\" to the console.\n   *   print(v.toString());\n   *\n   *   // Rotate a quarter turn.\n   *   v.rotate(90);\n   *\n   *   // Prints \"p5.Vector Object : [0, 1, 0]\" to the console.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v0 = createVector(1, 0);\n   *\n   *   // Create a rotated copy.\n   *   let v1 = p5.Vector.rotate(v0, HALF_PI);\n   *\n   *   // Prints \"p5.Vector Object : [1, 0, 0]\" to the console.\n   *   print(v0.toString());\n   *   // Prints \"p5.Vector Object : [0, 1, 0]\" to the console.\n   *   print(v1.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   // Create a p5.Vector object.\n   *   let v0 = createVector(1, 0);\n   *\n   *   // Create a rotated copy.\n   *   let v1 = p5.Vector.rotate(v0, 90);\n   *\n   *   // Prints \"p5.Vector Object : [1, 0, 0]\" to the console.\n   *   print(v0.toString());\n   *\n   *   // Prints \"p5.Vector Object : [0, 1, 0]\" to the console.\n   *   print(v1.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let v0;\n   * let v1;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create p5.Vector objects.\n   *   v0 = createVector(50, 50);\n   *   v1 = createVector(30, 0);\n   *\n   *   describe('A black arrow extends from the center of a gray square. The arrow rotates clockwise.');\n   * }\n   *\n   * function draw() {\n   *   background(240);\n   *\n   *   // Rotate v1.\n   *   v1.rotate(0.01);\n   *\n   *   // Draw the black arrow.\n   *   drawArrow(v0, v1, 'black');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  rotate(a) {\n    let newHeading = this.heading() + a;\n    if (this.isPInst) newHeading = this._toRadians(newHeading);\n    const mag = this.mag();\n    this.x = Math.cos(newHeading) * mag;\n    this.y = Math.sin(newHeading) * mag;\n    return this;\n  }\n\n  /**\n   * Calculates the angle between two vectors.\n   *\n   * The angles returned are signed, which means that\n   * `v1.angleBetween(v2) === -v2.angleBetween(v1)`.\n   *\n   * If the vector was created with\n   * <a href=\"#/p5/createVector\">createVector()</a>, `angleBetween()` returns\n   * angles in the units of the current\n   * <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * @param  {p5.Vector}    value x, y, and z components of a <a href=\"#/p5.Vector\">p5.Vector</a>.\n   * @return {Number}       angle between the vectors.\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(1, 0);\n   *   let v1 = createVector(0, 1);\n   *\n   *   // Prints \"1.570...\" to the console.\n   *   print(v0.angleBetween(v1));\n   *\n   *   // Prints \"-1.570...\" to the console.\n   *   print(v1.angleBetween(v0));\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(1, 0);\n   *   let v1 = createVector(0, 1);\n   *\n   *   // Prints \"90\" to the console.\n   *   print(v0.angleBetween(v1));\n   *\n   *   // Prints \"-90\" to the console.\n   *   print(v1.angleBetween(v0));\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(1, 0);\n   *   let v1 = createVector(0, 1);\n   *\n   *   // Prints \"1.570...\" to the console.\n   *   print(p5.Vector.angleBetween(v0, v1));\n   *\n   *   // Prints \"-1.570...\" to the console.\n   *   print(p5.Vector.angleBetween(v1, v0));\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(1, 0);\n   *   let v1 = createVector(0, 1);\n   *\n   *   // Prints \"90\" to the console.\n   *   print(p5.Vector.angleBetween(v0, v1));\n   *\n   *   // Prints \"-90\" to the console.\n   *   print(p5.Vector.angleBetween(v1, v0));\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Two arrows extend from the center of a gray square. A red arrow points to the right and a blue arrow points down. The text \"Radians: 1.57\" and \"Degrees: 90\" is written above the arrows.');\n   * }\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(50, 50);\n   *   let v1 = createVector(30, 0);\n   *   let v2 = createVector(0, 30);\n   *\n   *   // Draw the red arrow.\n   *   drawArrow(v0, v1, 'red');\n   *\n   *   // Draw the blue arrow.\n   *   drawArrow(v0, v2, 'blue');\n   *\n   *   // Use radians.\n   *   angleMode(RADIANS);\n   *\n   *   // Display the angle in radians.\n   *   let angle = round(v1.angleBetween(v2), 2);\n   *   text(`Radians: ${angle}`, 20, 20);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   // Display the angle in degrees.\n   *   angle = round(v1.angleBetween(v2), 2);\n   *   text(`Degrees: ${angle}`, 20, 35);\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  angleBetween(v) {\n    const magSqMult = this.magSq() * v.magSq();\n    // Returns NaN if either vector is the zero vector.\n    if (magSqMult === 0) {\n      return NaN;\n    }\n    const u = this.cross(v);\n    // The dot product computes the cos value, and the cross product computes\n    // the sin value. Find the angle based on them. In addition, in the case of\n    // 2D vectors, a sign is added according to the direction of the vector.\n    let angle = Math.atan2(u.mag(), this.dot(v)) * Math.sign(u.z || 1);\n    if (this.isPInst) {\n      angle = this._fromRadians(angle);\n    }\n    return angle;\n  }\n\n  /**\n   * Calculates new `x`, `y`, and `z` components that are proportionally the\n   * same distance between two vectors.\n   *\n   * The `amt` parameter is the amount to interpolate between the old vector and\n   * the new vector. 0.0 keeps all components equal to the old vector's, 0.5 is\n   * halfway between, and 1.0 sets all components equal to the new vector's.\n   *\n   * The static version of `lerp()`, as in `p5.Vector.lerp(v0, v1, 0.5)`,\n   * returns a new <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change\n   * the original.\n   *\n   * @param  {Number}    x   x component.\n   * @param  {Number}    y   y component.\n   * @param  {Number}    z   z component.\n   * @param  {Number}    amt amount of interpolation between 0.0 (old vector)\n   *                         and 1.0 (new vector). 0.5 is halfway between.\n   * @chainable\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v0 = createVector(1, 1, 1);\n   *   let v1 = createVector(3, 3, 3);\n   *\n   *   // Interpolate.\n   *   v0.lerp(v1, 0.5);\n   *\n   *   // Prints \"p5.Vector Object : [2, 2, 2]\" to the console.\n   *   print(v0.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(1, 1, 1);\n   *\n   *   // Interpolate.\n   *   v.lerp(3, 3, 3, 0.5);\n   *\n   *   // Prints \"p5.Vector Object : [2, 2, 2]\" to the console.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(1, 1, 1);\n   *   let v1 = createVector(3, 3, 3);\n   *\n   *   // Interpolate.\n   *   let v2 = p5.Vector.lerp(v0, v1, 0.5);\n   *\n   *   // Prints \"p5.Vector Object : [2, 2, 2]\" to the console.\n   *   print(v2.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Three arrows extend from the center of a gray square. A red arrow points to the right, a blue arrow points down, and a purple arrow points to the bottom right.');\n   * }\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(50, 50);\n   *   let v1 = createVector(30, 0);\n   *   let v2 = createVector(0, 30);\n   *\n   *   // Interpolate.\n   *   let v3 = p5.Vector.lerp(v1, v2, 0.5);\n   *\n   *   // Draw the red arrow.\n   *   drawArrow(v0, v1, 'red');\n   *\n   *   // Draw the blue arrow.\n   *   drawArrow(v0, v2, 'blue');\n   *\n   *   // Draw the purple arrow.\n   *   drawArrow(v0, v3, 'purple');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {p5.Vector} v  <a href=\"#/p5.Vector\">p5.Vector</a> to lerp toward.\n   * @param  {Number}    amt\n   * @chainable\n   */\n  lerp(x, y, z, amt) {\n    if (x instanceof Vector) {\n      return this.lerp(x.x, x.y, x.z, y);\n    }\n    this.x += (x - this.x) * amt || 0;\n    this.y += (y - this.y) * amt || 0;\n    this.z += (z - this.z) * amt || 0;\n    return this;\n  }\n\n  /**\n   * Calculates a new heading and magnitude that are between two vectors.\n   *\n   * The `amt` parameter is the amount to interpolate between the old vector and\n   * the new vector. 0.0 keeps the heading and magnitude equal to the old\n   * vector's, 0.5 sets them halfway between, and 1.0 sets the heading and\n   * magnitude equal to the new vector's.\n   *\n   * `slerp()` differs from <a href=\"#/p5.Vector/lerp\">lerp()</a> because\n   * it interpolates magnitude. Calling `v0.slerp(v1, 0.5)` sets `v0`'s\n   * magnitude to a value halfway between its original magnitude and `v1`'s.\n   * Calling `v0.lerp(v1, 0.5)` makes no such guarantee.\n   *\n   * The static version of `slerp()`, as in `p5.Vector.slerp(v0, v1, 0.5)`,\n   * returns a new <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change\n   * the original.\n   *\n   * @param {p5.Vector} v <a href=\"#/p5.Vector\">p5.Vector</a> to slerp toward.\n   * @param {Number} amt  amount of interpolation between 0.0 (old vector)\n   *                      and 1.0 (new vector). 0.5 is halfway between.\n   * @return {p5.Vector}\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v0 = createVector(3, 0);\n   *\n   *   // Prints \"3\" to the console.\n   *   print(v0.mag());\n   *\n   *   // Prints \"0\" to the console.\n   *   print(v0.heading());\n   *\n   *   // Create a p5.Vector object.\n   *   let v1 = createVector(0, 1);\n   *\n   *   // Prints \"1\" to the console.\n   *   print(v1.mag());\n   *\n   *   // Prints \"1.570...\" to the console.\n   *   print(v1.heading());\n   *\n   *   // Interpolate halfway between v0 and v1.\n   *   v0.slerp(v1, 0.5);\n   *\n   *   // Prints \"2\" to the console.\n   *   print(v0.mag());\n   *\n   *   // Prints \"0.785...\" to the console.\n   *   print(v0.heading());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v0 = createVector(3, 0);\n   *\n   *   // Prints \"3\" to the console.\n   *   print(v0.mag());\n   *\n   *   // Prints \"0\" to the console.\n   *   print(v0.heading());\n   *\n   *   // Create a p5.Vector object.\n   *   let v1 = createVector(0, 1);\n   *\n   *   // Prints \"1\" to the console.\n   *   print(v1.mag());\n   *\n   *   // Prints \"1.570...\" to the console.\n   *   print(v1.heading());\n   *\n   *   // Create a p5.Vector that's halfway between v0 and v1.\n   *   let v3 = p5.Vector.slerp(v0, v1, 0.5);\n   *\n   *   // Prints \"2\" to the console.\n   *   print(v3.mag());\n   *\n   *   // Prints \"0.785...\" to the console.\n   *   print(v3.heading());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Three arrows extend from the center of a gray square. A red arrow points to the right, a blue arrow points to the left, and a purple arrow points down.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(50, 50);\n   *   let v1 = createVector(20, 0);\n   *   let v2 = createVector(-40, 0);\n   *\n   *   // Create a p5.Vector that's halfway between v1 and v2.\n   *   let v3 = p5.Vector.slerp(v1, v2, 0.5);\n   *\n   *   // Draw the red arrow.\n   *   drawArrow(v0, v1, 'red');\n   *\n   *   // Draw the blue arrow.\n   *   drawArrow(v0, v2, 'blue');\n   *\n   *   // Draw the purple arrow.\n   *   drawArrow(v0, v3, 'purple');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  slerp(v, amt) {\n    // edge cases.\n    if (amt === 0) {\n      return this;\n    }\n    if (amt === 1) {\n      return this.set(v);\n    }\n\n    // calculate magnitudes\n    const selfMag = this.mag();\n    const vMag = v.mag();\n    const magmag = selfMag * vMag;\n    // if either is a zero vector, linearly interpolate by these vectors\n    if (magmag === 0) {\n      this.mult(1 - amt).add(v.x * amt, v.y * amt, v.z * amt);\n      return this;\n    }\n    // the cross product of 'this' and 'v' is the axis of rotation\n    const axis = this.cross(v);\n    const axisMag = axis.mag();\n    // Calculates the angle between 'this' and 'v'\n    const theta = Math.atan2(axisMag, this.dot(v));\n\n    // However, if the norm of axis is 0, normalization cannot be performed,\n    // so we will divide the cases\n    if (axisMag > 0) {\n      axis.x /= axisMag;\n      axis.y /= axisMag;\n      axis.z /= axisMag;\n    } else if (theta < Math.PI * 0.5) {\n      // if the norm is 0 and the angle is less than PI/2,\n      // the angle is very close to 0, so do linear interpolation.\n      this.mult(1 - amt).add(v.x * amt, v.y * amt, v.z * amt);\n      return this;\n    } else {\n      // If the norm is 0 and the angle is more than PI/2, the angle is\n      // very close to PI.\n      // In this case v can be regarded as '-this', so take any vector\n      // that is orthogonal to 'this' and use that as the axis.\n      if (this.z === 0 && v.z === 0) {\n        // if both this and v are 2D vectors, use (0,0,1)\n        // this makes the result also a 2D vector.\n        axis.set(0, 0, 1);\n      } else if (this.x !== 0) {\n        // if the x components is not 0, use (y, -x, 0)\n        axis.set(this.y, -this.x, 0).normalize();\n      } else {\n        // if the x components is 0, use (1,0,0)\n        axis.set(1, 0, 0);\n      }\n    }\n\n    // Since 'axis' is a unit vector, ey is a vector of the same length as 'this'.\n    const ey = axis.cross(this);\n    // interpolate the length with 'this' and 'v'.\n    const lerpedMagFactor = 1 - amt + (amt * vMag) / selfMag;\n    // imagine a situation where 'axis', 'this', and 'ey' are pointing\n    // along the z, x, and y axes, respectively.\n    // rotates 'this' around 'axis' by amt * theta towards 'ey'.\n    const cosMultiplier = lerpedMagFactor * Math.cos(amt * theta);\n    const sinMultiplier = lerpedMagFactor * Math.sin(amt * theta);\n    // then, calculate 'result'.\n    this.x = this.x * cosMultiplier + ey.x * sinMultiplier;\n    this.y = this.y * cosMultiplier + ey.y * sinMultiplier;\n    this.z = this.z * cosMultiplier + ey.z * sinMultiplier;\n\n    return this;\n  }\n\n  /**\n   * Reflects a vector about a line in 2D or a plane in 3D.\n   *\n   * The orientation of the line or plane is described by a normal vector that\n   * points away from the shape.\n   *\n   * The static version of `reflect()`, as in `p5.Vector.reflect(v, n)`,\n   * returns a new <a href=\"#/p5.Vector\">p5.Vector</a> object and doesn't change\n   * the original.\n   *\n   * @param  {p5.Vector} surfaceNormal  <a href=\"#/p5.Vector\">p5.Vector</a>\n   *                                    to reflect about.\n   * @chainable\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a normal vector.\n   *   let n = createVector(0, 1);\n   *   // Create a vector to reflect.\n   *   let v = createVector(4, 6);\n   *\n   *   // Reflect v about n.\n   *   v.reflect(n);\n   *\n   *   // Prints \"p5.Vector Object : [4, -6, 0]\" to the console.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a normal vector.\n   *   let n = createVector(0, 1);\n   *\n   *   // Create a vector to reflect.\n   *   let v0 = createVector(4, 6);\n   *\n   *   // Create a reflected vector.\n   *   let v1 = p5.Vector.reflect(v0, n);\n   *\n   *   // Prints \"p5.Vector Object : [4, -6, 0]\" to the console.\n   *   print(v1.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Three arrows extend from the center of a gray square with a vertical line down its middle. A black arrow points to the right, a blue arrow points to the bottom left, and a red arrow points to the bottom right.');\n   * }\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a vertical line.\n   *   line(50, 0, 50, 100);\n   *\n   *   // Create a normal vector.\n   *   let n = createVector(1, 0);\n   *\n   *   // Center.\n   *   let v0 = createVector(50, 50);\n   *\n   *   // Create a vector to reflect.\n   *   let v1 = createVector(30, 40);\n   *\n   *   // Create a reflected vector.\n   *   let v2 = p5.Vector.reflect(v1, n);\n   *\n   *   // Scale the normal vector for drawing.\n   *   n.setMag(30);\n   *\n   *   // Draw the black arrow.\n   *   drawArrow(v0, n, 'black');\n   *\n   *   // Draw the red arrow.\n   *   drawArrow(v0, v1, 'red');\n   *\n   *   // Draw the blue arrow.\n   *   drawArrow(v0, v2, 'blue');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  reflect(surfaceNormal) {\n    const surfaceNormalCopy = Vector.normalize(surfaceNormal);\n    return this.sub(surfaceNormalCopy.mult(2 * this.dot(surfaceNormalCopy)));\n  }\n\n  /**\n   * Returns the vector's components as an array of numbers.\n   *\n   * @return {Number[]} array with the vector's components.\n   * @example\n   * <div class = \"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = createVector(20, 30);\n   *\n   *   // Prints \"[20, 30, 0]\" to the console.\n   *   print(v.array());\n   * }\n   * </code>\n   * </div>\n   */\n  array() {\n    return [this.x || 0, this.y || 0, this.z || 0];\n  }\n\n  /**\n   * Checks whether all the vector's components are equal to another vector's.\n   *\n   * `equals()` returns `true` if the vector's components are all the same as another\n   * vector's and `false` if not.\n   *\n   * The version of `equals()` with one parameter interprets it as another\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   *\n   * The version of `equals()` with multiple parameters interprets them as the\n   * components of another vector. Any missing parameters are assigned the value\n   * 0.\n   *\n   * The static version of `equals()`, as in `p5.Vector.equals(v0, v1)`,\n   * interprets both parameters as <a href=\"#/p5.Vector\">p5.Vector</a> objects.\n   *\n   * @param {Number} [x] x component of the vector.\n   * @param {Number} [y] y component of the vector.\n   * @param {Number} [z] z component of the vector.\n   * @return {Boolean} whether the vectors are equal.\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(10, 20, 30);\n   *   let v1 = createVector(10, 20, 30);\n   *   let v2 = createVector(0, 0, 0);\n   *\n   *   // Prints \"true\" to the console.\n   *   print(v0.equals(v1));\n   *\n   *   // Prints \"false\" to the console.\n   *   print(v0.equals(v2));\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class = \"norender\">\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(5, 10, 20);\n   *   let v1 = createVector(5, 10, 20);\n   *   let v2 = createVector(13, 10, 19);\n   *\n   *   // Prints \"true\" to the console.\n   *   print(v0.equals(v1.x, v1.y, v1.z));\n   *\n   *   // Prints \"false\" to the console.\n   *   print(v0.equals(v2.x, v2.y, v2.z));\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create p5.Vector objects.\n   *   let v0 = createVector(10, 20, 30);\n   *   let v1 = createVector(10, 20, 30);\n   *   let v2 = createVector(0, 0, 0);\n   *\n   *   // Prints \"true\" to the console.\n   *   print(p5.Vector.equals(v0, v1));\n   *\n   *   // Prints \"false\" to the console.\n   *   print(p5.Vector.equals(v0, v2));\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param {p5.Vector|Array} value vector to compare.\n   * @return {Boolean}\n   */\n  equals(...args) {\n    let values;\n    if (args[0] instanceof Vector) {\n      values = args[0]._values;\n    } else if (Array.isArray(args[0])) {\n      values = args[0];\n    } else {\n      values = args;\n    }\n\n    for (let i = 0; i < this._values.length; i++) {\n      if (this._values[i] !== (values[i] || 0)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Replaces the components of a <a href=\"#/p5.Vector\">p5.Vector</a> that are very close to zero with zero.\n   *\n   * In computers, handling numbers with decimals can give slightly imprecise answers due to the way those numbers are represented.\n   * This can make it hard to check if a number is zero, as it may be close but not exactly zero.\n   * This method rounds very close numbers to zero to make those checks easier\n   *\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/EPSILON\n   *\n   * @method clampToZero\n   * @return {p5.Vector} with components very close to zero replaced with zero.\n   * @chainable\n   */\n  clampToZero() {\n    for (let i = 0; i < this._values.length; i++) {\n      this._values[i] = this._clampToZero(this._values[i]);\n    }\n    return this;\n  }\n\n  /**\n   * Helper function for clampToZero\n   * @private\n   */\n  _clampToZero(val) {\n    return Math.abs((val || 0) - 0) <= Number.EPSILON ? 0 : val;\n  }\n\n  // Static Methods\n\n  /**\n   * Creates a new 2D vector from an angle.\n   *\n   * @static\n   * @param {Number}     angle desired angle, in radians. Unaffected by <a href=\"#/p5/angleMode\">angleMode()</a>.\n   * @param {Number}     [length] length of the new vector (defaults to 1).\n   * @return {p5.Vector}       new <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = p5.Vector.fromAngle(0);\n   *\n   *   // Prints \"p5.Vector Object : [1, 0, 0]\" to the console.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = p5.Vector.fromAngle(0, 30);\n   *\n   *   // Prints \"p5.Vector Object : [30, 0, 0]\" to the console.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A black arrow extends from the center of a gray square. It points to the right.');\n   * }\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create a p5.Vector to the center.\n   *   let v0 = createVector(50, 50);\n   *\n   *   // Create a p5.Vector with an angle 0 and magnitude 30.\n   *   let v1 = p5.Vector.fromAngle(0, 30);\n   *\n   *   // Draw the black arrow.\n   *   drawArrow(v0, v1, 'black');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  static fromAngle(angle, length) {\n    if (typeof length === \"undefined\") {\n      length = 1;\n    }\n    return new Vector(length * Math.cos(angle), length * Math.sin(angle), 0);\n  }\n\n  /**\n   * Creates a new 3D vector from a pair of ISO spherical angles.\n   *\n   * @static\n   * @param {Number}     theta    polar angle in radians (zero is up).\n   * @param {Number}     phi      azimuthal angle in radians\n   *                               (zero is out of the screen).\n   * @param {Number}     [length] length of the new vector (defaults to 1).\n   * @return {p5.Vector}          new <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = p5.Vector.fromAngles(0, 0);\n   *\n   *   // Prints \"p5.Vector Object : [0, -1, 0]\" to the console.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A light shines on a pink sphere as it orbits.');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Calculate the ISO angles.\n   *   let theta = frameCount *  0.05;\n   *   let phi = 0;\n   *\n   *   // Create a p5.Vector object.\n   *   let v = p5.Vector.fromAngles(theta, phi, 100);\n   *\n   *   // Create a point light using the p5.Vector.\n   *   let c = color('deeppink');\n   *   pointLight(c, v);\n   *\n   *   // Style the sphere.\n   *   fill(255);\n   *   noStroke();\n   *\n   *   // Draw the sphere.\n   *   sphere(35);\n   * }\n   * </code>\n   * </div>\n   */\n  static fromAngles(theta, phi, length) {\n    if (typeof length === \"undefined\") {\n      length = 1;\n    }\n    const cosPhi = Math.cos(phi);\n    const sinPhi = Math.sin(phi);\n    const cosTheta = Math.cos(theta);\n    const sinTheta = Math.sin(theta);\n\n    return new Vector(\n      length * sinTheta * sinPhi,\n      -length * cosTheta,\n      length * sinTheta * cosPhi\n    );\n  }\n\n  /**\n   * Creates a new 2D unit vector with a random heading.\n   *\n   * @static\n   * @return {p5.Vector} new <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = p5.Vector.random2D();\n   *\n   *   // Prints \"p5.Vector Object : [x, y, 0]\" to the console\n   *   // where x and y are small random numbers.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(1);\n   *\n   *   describe('A black arrow in extends from the center of a gray square. It changes direction once per second.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create a p5.Vector to the center.\n   *   let v0 = createVector(50, 50);\n   *\n   *   // Create a random p5.Vector.\n   *   let v1 = p5.Vector.random2D();\n   *\n   *   // Scale v1 for drawing.\n   *   v1.mult(30);\n   *\n   *   // Draw the black arrow.\n   *   drawArrow(v0, v1, 'black');\n   * }\n   *\n   * // Draws an arrow between two vectors.\n   * function drawArrow(base, vec, myColor) {\n   *   push();\n   *   stroke(myColor);\n   *   strokeWeight(3);\n   *   fill(myColor);\n   *   translate(base.x, base.y);\n   *   line(0, 0, vec.x, vec.y);\n   *   rotate(vec.heading());\n   *   let arrowSize = 7;\n   *   translate(vec.mag() - arrowSize, 0);\n   *   triangle(0, arrowSize / 2, 0, -arrowSize / 2, arrowSize, 0);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  static random2D() {\n    return this.fromAngle(Math.random() * TWO_PI);\n  }\n\n  /**\n   * Creates a new 3D unit vector with a random heading.\n   *\n   * @static\n   * @return {p5.Vector} new <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Create a p5.Vector object.\n   *   let v = p5.Vector.random3D();\n   *\n   *   // Prints \"p5.Vector Object : [x, y, z]\" to the console\n   *   // where x, y, and z are small random numbers.\n   *   print(v.toString());\n   * }\n   * </code>\n   * </div>\n   */\n  static random3D() {\n    const angle = Math.random() * TWO_PI;\n    const vz = Math.random() * 2 - 1;\n    const vzBase = Math.sqrt(1 - vz * vz);\n    const vx = vzBase * Math.cos(angle);\n    const vy = vzBase * Math.sin(angle);\n    return new Vector(vx, vy, vz);\n  }\n\n  // Returns a copy of a vector.\n  /**\n   * @static\n   * @param  {p5.Vector} v the <a href=\"#/p5.Vector\">p5.Vector</a> to create a copy of\n   * @return {p5.Vector} the copy of the <a href=\"#/p5.Vector\">p5.Vector</a> object\n   */\n  static copy(v) {\n    return v.copy(v);\n  }\n\n  // Adds two vectors together and returns a new one.\n  /**\n   * @static\n   * @param  {p5.Vector} v1 A <a href=\"#/p5.Vector\">p5.Vector</a> to add\n   * @param  {p5.Vector} v2 A <a href=\"#/p5.Vector\">p5.Vector</a> to add\n   * @param  {p5.Vector} [target] vector to receive the result.\n   * @return {p5.Vector} resulting <a href=\"#/p5.Vector\">p5.Vector</a>.\n   */\n  static add(v1, v2, target) {\n    if (!target) {\n      target = v1.copy();\n      if (arguments.length === 3) {\n        p5._friendlyError(\n          \"The target parameter is undefined, it should be of type p5.Vector\",\n          \"p5.Vector.add\"\n        );\n      }\n    } else {\n      target.set(v1);\n    }\n    target.add(v2);\n    return target;\n  }\n\n  // Returns a vector remainder when it is divided by another vector\n  /**\n   * @static\n   * @param  {p5.Vector} v1 The dividend <a href=\"#/p5.Vector\">p5.Vector</a>\n   * @param  {p5.Vector} v2 The divisor <a href=\"#/p5.Vector\">p5.Vector</a>\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v1\n   * @param  {p5.Vector} v2\n   * @return {p5.Vector} The resulting <a href=\"#/p5.Vector\">p5.Vector</a>\n   */\n  static rem(v1, v2) {\n    if (v1 instanceof Vector && v2 instanceof Vector) {\n      let target = v1.copy();\n      target.rem(v2);\n      return target;\n    }\n  }\n\n  /*\n   * Subtracts one <a href=\"#/p5.Vector\">p5.Vector</a> from another and returns a new one.  The second\n   * vector (`v2`) is subtracted from the first (`v1`), resulting in `v1-v2`.\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v1 A <a href=\"#/p5.Vector\">p5.Vector</a> to subtract from\n   * @param  {p5.Vector} v2 A <a href=\"#/p5.Vector\">p5.Vector</a> to subtract\n   * @param  {p5.Vector} [target] vector to receive the result.\n   * @return {p5.Vector} The resulting <a href=\"#/p5.Vector\">p5.Vector</a>\n   */\n  static sub(v1, v2, target) {\n    if (!target) {\n      target = v1.copy();\n      if (arguments.length === 3) {\n        p5._friendlyError(\n          \"The target parameter is undefined, it should be of type p5.Vector\",\n          \"p5.Vector.sub\"\n        );\n      }\n    } else {\n      target.set(v1);\n    }\n    target.sub(v2);\n    return target;\n  }\n\n  /**\n   * Multiplies a vector by a scalar and returns a new vector.\n   */\n  /**\n   * @static\n   * @param  {Number} x\n   * @param  {Number} y\n   * @param  {Number} [z]\n   * @return {p5.Vector} resulting new <a href=\"#/p5.Vector\">p5.Vector</a>.\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v\n   * @param  {Number}  n\n   * @param  {p5.Vector} [target] vector to receive the result.\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v0\n   * @param  {p5.Vector} v1\n   * @param  {p5.Vector} [target]\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v0\n   * @param  {Number[]} arr\n   * @param  {p5.Vector} [target]\n   */\n  static mult(v, n, target) {\n    if (!target) {\n      target = v.copy();\n      if (arguments.length === 3) {\n        p5._friendlyError(\n          \"The target parameter is undefined, it should be of type p5.Vector\",\n          \"p5.Vector.mult\"\n        );\n      }\n    } else {\n      target.set(v);\n    }\n    target.mult(n);\n    return target;\n  }\n\n  /**\n   * Rotates the vector (only 2D vectors) by the given angle; magnitude remains the same. Returns a new vector.\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v\n   * @param  {Number} angle\n   * @param  {p5.Vector} [target] The vector to receive the result\n   */\n  static rotate(v, a, target) {\n    if (arguments.length === 2) {\n      target = v.copy();\n    } else {\n      if (!(target instanceof Vector)) {\n        p5._friendlyError(\n          \"The target parameter should be of type p5.Vector\",\n          \"p5.Vector.rotate\"\n        );\n      }\n      target.set(v);\n    }\n    target.rotate(a);\n    return target;\n  }\n\n  /**\n   * Divides a vector by a scalar and returns a new vector.\n   */\n  /**\n   * @static\n   * @param  {Number} x\n   * @param  {Number} y\n   * @param  {Number} [z]\n   * @return {p5.Vector} The resulting new <a href=\"#/p5.Vector\">p5.Vector</a>\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v\n   * @param  {Number}  n\n   * @param  {p5.Vector} [target] The vector to receive the result\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v0\n   * @param  {p5.Vector} v1\n   * @param  {p5.Vector} [target]\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v0\n   * @param  {Number[]} arr\n   * @param  {p5.Vector} [target]\n   */\n  static div(v, n, target) {\n    if (!target) {\n      target = v.copy();\n\n      if (arguments.length === 3) {\n        p5._friendlyError(\n          \"The target parameter is undefined, it should be of type p5.Vector\",\n          \"p5.Vector.div\"\n        );\n      }\n    } else {\n      target.set(v);\n    }\n    target.div(n);\n    return target;\n  }\n\n  /**\n   * Calculates the dot product of two vectors.\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v1 first <a href=\"#/p5.Vector\">p5.Vector</a>.\n   * @param  {p5.Vector} v2 second <a href=\"#/p5.Vector\">p5.Vector</a>.\n   * @return {Number}     dot product.\n   */\n  static dot(v1, v2) {\n    return v1.dot(v2);\n  }\n\n  /**\n   * Calculates the cross product of two vectors.\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v1 first <a href=\"#/p5.Vector\">p5.Vector</a>.\n   * @param  {p5.Vector} v2 second <a href=\"#/p5.Vector\">p5.Vector</a>.\n   * @return {Number}     cross product.\n   */\n  static cross(v1, v2) {\n    return v1.cross(v2);\n  }\n\n  /**\n   * Calculates the Euclidean distance between two points (considering a\n   * point as a vector object).\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v1 The first <a href=\"#/p5.Vector\">p5.Vector</a>\n   * @param  {p5.Vector} v2 The second <a href=\"#/p5.Vector\">p5.Vector</a>\n   * @return {Number}     The distance\n   */\n  static dist(v1, v2) {\n    return v1.dist(v2);\n  }\n\n  /**\n   * Linear interpolate a vector to another vector and return the result as a\n   * new vector.\n   */\n  /**\n   * @static\n   * @param {p5.Vector} v1\n   * @param {p5.Vector} v2\n   * @param {Number} amt\n   * @param {p5.Vector} [target] The vector to receive the result\n   * @return {p5.Vector}      The lerped value\n   */\n  static lerp(v1, v2, amt, target) {\n    if (!target) {\n      target = v1.copy();\n      if (arguments.length === 4) {\n        p5._friendlyError(\n          \"The target parameter is undefined, it should be of type p5.Vector\",\n          \"p5.Vector.lerp\"\n        );\n      }\n    } else {\n      target.set(v1);\n    }\n    target.lerp(v2, amt);\n    return target;\n  }\n\n  /**\n   * Performs spherical linear interpolation with the other vector\n   * and returns the resulting vector.\n   * This works in both 3D and 2D. As for 2D, the result of slerping\n   * between 2D vectors is always a 2D vector.\n   */\n  /**\n   * @static\n   * @param {p5.Vector} v1 old vector.\n   * @param {p5.Vector} v2 new vector.\n   * @param {Number} amt\n   * @param {p5.Vector} [target] vector to receive the result.\n   * @return {p5.Vector} slerped vector between v1 and v2\n   */\n  static slerp(v1, v2, amt, target) {\n    if (!target) {\n      target = v1.copy();\n      if (arguments.length === 4) {\n        p5._friendlyError(\n          \"The target parameter is undefined, it should be of type p5.Vector\",\n          \"p5.Vector.slerp\"\n        );\n      }\n    } else {\n      target.set(v1);\n    }\n    target.slerp(v2, amt);\n    return target;\n  }\n\n  /**\n   * Calculates the magnitude (length) of the vector and returns the result as\n   * a float (this is simply the equation `sqrt(x*x + y*y + z*z)`.)\n   */\n  /**\n   * @static\n   * @param {p5.Vector} vecT The vector to return the magnitude of\n   * @return {Number}        The magnitude of vecT\n   */\n  static mag(vecT) {\n    return vecT.mag();\n  }\n\n  /**\n   * Calculates the squared magnitude of the vector and returns the result\n   * as a float (this is simply the equation <em>(x\\*x + y\\*y + z\\*z)</em>.)\n   * Faster if the real length is not required in the\n   * case of comparing vectors, etc.\n   */\n  /**\n   * @static\n   * @param {p5.Vector} vecT the vector to return the squared magnitude of\n   * @return {Number}        the squared magnitude of vecT\n   */\n  static magSq(vecT) {\n    return vecT.magSq();\n  }\n\n  /**\n   * Normalize the vector to length 1 (make it a unit vector).\n   */\n  /**\n   * @static\n   * @param {p5.Vector} v  The vector to normalize\n   * @param {p5.Vector} [target] The vector to receive the result\n   * @return {p5.Vector}   The vector v, normalized to a length of 1\n   */\n  static normalize(v, target) {\n    if (arguments.length < 2) {\n      target = v.copy();\n    } else {\n      if (!(target instanceof Vector)) {\n        p5._friendlyError(\n          \"The target parameter should be of type p5.Vector\",\n          \"p5.Vector.normalize\"\n        );\n      }\n      target.set(v);\n    }\n    return target.normalize();\n  }\n\n  /**\n   * Limit the magnitude of the vector to the value used for the <b>max</b>\n   * parameter.\n   */\n  /**\n   * @static\n   * @param {p5.Vector} v  the vector to limit\n   * @param {Number}    max\n   * @param {p5.Vector} [target] the vector to receive the result (Optional)\n   * @return {p5.Vector} v with a magnitude limited to max\n   */\n  static limit(v, max, target) {\n    if (arguments.length < 3) {\n      target = v.copy();\n    } else {\n      if (!(target instanceof Vector)) {\n        p5._friendlyError(\n          \"The target parameter should be of type p5.Vector\",\n          \"p5.Vector.limit\"\n        );\n      }\n      target.set(v);\n    }\n    return target.limit(max);\n  }\n\n  /**\n   * Set the magnitude of the vector to the value used for the <b>len</b>\n   * parameter.\n   */\n  /**\n   * @static\n   * @param {p5.Vector} v  the vector to set the magnitude of\n   * @param {Number}    len\n   * @param {p5.Vector} [target] the vector to receive the result (Optional)\n   * @return {p5.Vector} v with a magnitude set to len\n   */\n  static setMag(v, len, target) {\n    if (arguments.length < 3) {\n      target = v.copy();\n    } else {\n      if (!(target instanceof Vector)) {\n        p5._friendlyError(\n          \"The target parameter should be of type p5.Vector\",\n          \"p5.Vector.setMag\"\n        );\n      }\n      target.set(v);\n    }\n    return target.setMag(len);\n  }\n\n  /**\n   * Calculate the angle of rotation for this vector (only 2D vectors).\n   * p5.Vectors created using <a href=\"#/p5/createVector\">createVector()</a>\n   * will take the current <a href=\"#/p5/angleMode\">angleMode</a> into\n   * consideration, and give the angle in radians or degrees accordingly.\n   */\n  /**\n   * @static\n   * @param {p5.Vector} v the vector to find the angle of\n   * @return {Number} the angle of rotation\n   */\n  static heading(v) {\n    return v.heading();\n  }\n\n  /**\n   * Calculates and returns the angle between two vectors. This function will take\n   * the <a href=\"#/p5/angleMode\">angleMode</a> on v1 into consideration, and\n   * give the angle in radians or degrees accordingly.\n   */\n  /**\n   * @static\n   * @param  {p5.Vector}    v1 the first vector.\n   * @param  {p5.Vector}    v2 the second vector.\n   * @return {Number}       angle between the two vectors.\n   */\n  static angleBetween(v1, v2) {\n    return v1.angleBetween(v2);\n  }\n\n  /**\n   * Reflect a vector about a normal to a line in 2D, or about a normal to a\n   * plane in 3D.\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} incidentVector vector to be reflected.\n   * @param  {p5.Vector} surfaceNormal\n   * @param  {p5.Vector} [target] vector to receive the result.\n   * @return {p5.Vector} the reflected vector\n   */\n  static reflect(incidentVector, surfaceNormal, target) {\n    if (arguments.length < 3) {\n      target = incidentVector.copy();\n    } else {\n      if (!(target instanceof Vector)) {\n        p5._friendlyError(\n          \"The target parameter should be of type p5.Vector\",\n          \"p5.Vector.reflect\"\n        );\n      }\n      target.set(incidentVector);\n    }\n    return target.reflect(surfaceNormal);\n  }\n\n  /**\n   * Return a representation of this vector as a float array. This is only\n   * for temporary use. If used in any other fashion, the contents should be\n   * copied by using the <b>p5.Vector.<a href=\"#/p5.Vector/copy\">copy()</a></b>\n   * method to copy into your own vector.\n   */\n  /**\n   * @static\n   * @param  {p5.Vector} v the vector to convert to an array\n   * @return {Number[]} an Array with the 3 values\n   */\n  static array(v) {\n    return v.array();\n  }\n\n  /**\n   * Equality check against a <a href=\"#/p5.Vector\">p5.Vector</a>\n   */\n  /**\n   * @static\n   * @param {p5.Vector|Array} v1 the first vector to compare\n   * @param {p5.Vector|Array} v2 the second vector to compare\n   * @return {Boolean}\n   */\n  static equals(v1, v2) {\n    let v;\n    if (v1 instanceof Vector) {\n      v = v1;\n    } else if (v1 instanceof Array) {\n      v = new Vector().set(v1);\n    } else {\n      p5._friendlyError(\n        \"The v1 parameter should be of type Array or p5.Vector\",\n        \"p5.Vector.equals\"\n      );\n    }\n    return v.equals(v2);\n  }\n}\n\nfunction vector(p5, fn) {\n  /**\n   * A class to describe a two or three-dimensional vector.\n   *\n   * A vector can be thought of in different ways. In one view, a vector is like\n   * an arrow pointing in space. Vectors have both magnitude (length) and\n   * direction.\n   *\n   * `p5.Vector` objects are often used to program motion because they simplify\n   * the math. For example, a moving ball has a position and a velocity.\n   * Position describes where the ball is in space. The ball's position vector\n   * extends from the origin to the ball's center. Velocity describes the ball's\n   * speed and the direction it's moving. If the ball is moving straight up, its\n   * velocity vector points straight up. Adding the ball's velocity vector to\n   * its position vector moves it, as in `pos.add(vel)`. Vector math relies on\n   * methods inside the `p5.Vector` class.\n   *\n   * Note: <a href=\"#/p5/createVector\">createVector()</a> is the recommended way\n   * to make an instance of this class.\n   *\n   * @class p5.Vector\n   * @param {Number} [x] x component of the vector.\n   * @param {Number} [y] y component of the vector.\n   * @param {Number} [z] z component of the vector.\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create p5.Vector objects.\n   *   let p1 = createVector(25, 25);\n   *   let p2 = createVector(75, 75);\n   *\n   *   // Style the points.\n   *   strokeWeight(5);\n   *\n   *   // Draw the first point using a p5.Vector.\n   *   point(p1);\n   *\n   *   // Draw the second point using a p5.Vector's components.\n   *   point(p2.x, p2.y);\n   *\n   *   describe('Two black dots on a gray square, one at the top left and the other at the bottom right.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let pos;\n   * let vel;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create p5.Vector objects.\n   *   pos = createVector(50, 100);\n   *   vel = createVector(0, -1);\n   *\n   *   describe('A black dot moves from bottom to top on a gray square. The dot reappears at the bottom when it reaches the top.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Add velocity to position.\n   *   pos.add(vel);\n   *\n   *   // If the dot reaches the top of the canvas,\n   *   // restart from the bottom.\n   *   if (pos.y < 0) {\n   *     pos.y = 100;\n   *   }\n   *\n   *   // Draw the dot.\n   *   strokeWeight(5);\n   *   point(pos);\n   * }\n   * </code>\n   * </div>\n   */\n  p5.Vector = Vector;\n\n  /**\n   * The x component of the vector\n   * @type {Number}\n   * @for p5.Vector\n   * @property x\n   * @name x\n   */\n\n  /**\n   * The y component of the vector\n   * @type {Number}\n   * @for p5.Vector\n   * @property y\n   * @name y\n   */\n\n  /**\n   * The z component of the vector\n   * @type {Number}\n   * @for p5.Vector\n   * @property z\n   * @name z\n   */\n}\n\nif (typeof p5 !== \"undefined\") {\n  vector(p5, p5.prototype);\n}\n\nexport { Vector, vector as default };\n","import { b as ARROW, c as CROSS, H as HAND, M as MOVE, d as TEXT, W as WAIT, P as P2D } from '../constants-8IpwyBct.js';\nimport '../math/p5.Vector.js';\n\n/**\n * @module Environment\n * @submodule Environment\n * @for p5\n * @requires core\n * @requires constants\n */\n\n\nfunction environment(p5, fn){\n  const standardCursors = [ARROW, CROSS, HAND, MOVE, TEXT, WAIT];\n\n  fn._frameRate = 0;\n  fn._lastFrameTime = window.performance.now();\n  fn._targetFrameRate = 60;\n\n  const _windowPrint = window.print;\n  let windowPrintDisabled = false;\n\n  /**\n   * Displays text in the web browser's console.\n   *\n   * `print()` is helpful for printing values while debugging. Each call to\n   * `print()` creates a new line of text.\n   *\n   * Note: Call `print('\\n')` to print a blank line. Calling `print()` without\n   * an argument opens the browser's dialog for printing documents.\n   *\n   * @method print\n   * @param {Any} contents content to print to the console.\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Prints \"hello, world\" to the console.\n   *   print('hello, world');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   let name = 'ada';\n   *   // Prints \"hello, ada\" to the console.\n   *   print(`hello, ${name}`);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.print = function(...args) {\n    if (!args.length) {\n      if (!windowPrintDisabled) {\n        _windowPrint();\n        if (\n          window.confirm(\n            'You just tried to print the webpage. Do you want to prevent this from running again?'\n          )\n        ) {\n          windowPrintDisabled = true;\n        }\n      }\n    } else {\n      console.log(...args);\n    }\n  };\n\n  /**\n   * A `Number` variable that tracks the number of frames drawn since the sketch\n   * started.\n   *\n   * `frameCount`'s value is 0 inside <a href=\"#/p5/setup\">setup()</a>. It\n   * increments by 1 each time the code in <a href=\"#/p5/draw\">draw()</a>\n   * finishes executing.\n   *\n   * @property {Integer} frameCount\n   * @readOnly\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Display the value of\n   *   // frameCount.\n   *   textSize(30);\n   *   textAlign(CENTER, CENTER);\n   *   text(frameCount, 50, 50);\n   *\n   *   describe('The number 0 written in black in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Set the frameRate to 30.\n   *   frameRate(30);\n   *\n   *   textSize(30);\n   *   textAlign(CENTER, CENTER);\n   *\n   *   describe('A number written in black in the middle of a gray square. Its value increases rapidly.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Display the value of\n   *   // frameCount.\n   *   text(frameCount, 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.frameCount = 0;\n\n  /**\n   * A `Number` variable that tracks the number of milliseconds it took to draw\n   * the last frame.\n   *\n   * `deltaTime` contains the amount of time it took\n   * <a href=\"#/p5/draw\">draw()</a> to execute during the previous frame. It's\n   * useful for simulating physics.\n   *\n   * @property {Integer} deltaTime\n   * @readOnly\n   * @example\n   * <div>\n   * <code>\n   * let x = 0;\n   * let speed = 0.05;\n   *\n   * function setup()  {\n   *   createCanvas(100, 100);\n   *\n   *   // Set the frameRate to 30.\n   *   frameRate(30);\n   *\n   *   describe('A white circle moves from left to right on a gray background. It reappears on the left side when it reaches the right side.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Use deltaTime to calculate\n   *   // a change in position.\n   *   let deltaX = speed * deltaTime;\n   *\n   *   // Update the x variable.\n   *   x += deltaX;\n   *\n   *   // Reset x to 0 if it's\n   *   // greater than 100.\n   *   if (x > 100)  {\n   *     x = 0;\n   *   }\n   *\n   *   // Use x to set the circle's\n   *   // position.\n   *   circle(x, 50, 20);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.deltaTime = 0;\n\n  /**\n   * A `Boolean` variable that's `true` if the browser is focused and `false` if\n   * not.\n   *\n   * Note: The browser window can only receive input if it's focused.\n   *\n   * @property {Boolean} focused\n   * @readOnly\n   * @example\n   * <div>\n   * <code>\n   * // Open this example in two separate browser\n   * // windows placed side-by-side to demonstrate.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A square changes color from green to red when the browser window is out of focus.');\n   * }\n   *\n   * function draw() {\n   *   // Change the background color\n   *   // when the browser window\n   *   // goes in/out of focus.\n   *   if (focused === true) {\n   *     background(0, 255, 0);\n   *   } else {\n   *     background(255, 0, 0);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.focused = document.hasFocus();\n\n  /**\n   * Changes the cursor's appearance.\n   *\n   * The first parameter, `type`, sets the type of cursor to display. The\n   * built-in options are `ARROW`, `CROSS`, `HAND`, `MOVE`, `TEXT`, and `WAIT`.\n   * `cursor()` also recognizes standard CSS cursor properties passed as\n   * strings: `'help'`, `'wait'`, `'crosshair'`, `'not-allowed'`, `'zoom-in'`,\n   * and `'grab'`. If the path to an image is passed, as in\n   * `cursor('assets/target.png')`, then the image will be used as the cursor.\n   * Images must be in .cur, .gif, .jpg, .jpeg, or .png format and should be <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/cursor#icon_size_limits\">at most 32 by 32 pixels large.</a>\n   *\n   * The parameters `x` and `y` are optional. If an image is used for the\n   * cursor, `x` and `y` set the location pointed to within the image. They are\n   * both 0 by default, so the cursor points to the image's top-left corner. `x`\n   * and `y` must be less than the image's width and height, respectively.\n   *\n   * @method cursor\n   * @param {(ARROW|CROSS|HAND|MOVE|TEXT|WAIT|String)} type Built-in: either ARROW, CROSS, HAND, MOVE, TEXT, or WAIT.\n   *                               Native CSS properties: 'grab', 'progress', and so on.\n   *                               Path to cursor image.\n   * @param {Number}          [x]  horizontal active spot of the cursor.\n   * @param {Number}          [y]  vertical active spot of the cursor.\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A gray square. The cursor appears as crosshairs.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Set the cursor to crosshairs: +\n   *   cursor(CROSS);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A gray square divided into quadrants. The cursor image changes when the mouse moves to each quadrant.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Divide the canvas into quadrants.\n   *   line(50, 0, 50, 100);\n   *   line(0, 50, 100, 50);\n   *\n   *   // Change cursor based on mouse position.\n   *   if (mouseX < 50 && mouseY < 50) {\n   *     cursor(CROSS);\n   *   } else if (mouseX > 50 && mouseY < 50) {\n   *     cursor('progress');\n   *   } else if (mouseX > 50 && mouseY > 50) {\n   *     cursor('https://avatars0.githubusercontent.com/u/1617169?s=16');\n   *   } else {\n   *     cursor('grab');\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('An image of three purple curves follows the mouse. The image shifts when the mouse is pressed.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Change the cursor's active spot\n   *   // when the mouse is pressed.\n   *   if (mouseIsPressed === true) {\n   *     cursor('https://avatars0.githubusercontent.com/u/1617169?s=16', 8, 8);\n   *   } else {\n   *     cursor('https://avatars0.githubusercontent.com/u/1617169?s=16');\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.cursor = function(type, x, y) {\n    let cursor = 'auto';\n    const canvas = this._curElement.elt;\n    if (standardCursors.includes(type)) {\n      // Standard css cursor\n      cursor = type;\n    } else if (typeof type === 'string') {\n      let coords = '';\n      if (x && y && (typeof x === 'number' && typeof y === 'number')) {\n        // Note that x and y values must be unit-less positive integers < 32\n        // https://developer.mozilla.org/en-US/docs/Web/CSS/cursor\n        coords = `${x} ${y}`;\n      }\n      if (\n        type.substring(0, 7) === 'http://' ||\n        type.substring(0, 8) === 'https://'\n      ) {\n        // Image (absolute url)\n        cursor = `url(${type}) ${coords}, auto`;\n      } else if (/\\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(type)) {\n        // Image file (relative path) - Separated for performance reasons\n        cursor = `url(${type}) ${coords}, auto`;\n      } else {\n        // Any valid string for the css cursor property\n        cursor = type;\n      }\n    }\n    canvas.style.cursor = cursor;\n  };\n\n  /**\n   * Sets the number of frames to draw per second.\n   *\n   * Calling `frameRate()` with one numeric argument, as in `frameRate(30)`,\n   * attempts to draw 30 frames per second (FPS). The target frame rate may not\n   * be achieved depending on the sketch's processing needs. Most computers\n   * default to a frame rate of 60 FPS. Frame rates of 24 FPS and above are\n   * fast enough for smooth animations.\n   *\n   * Calling `frameRate()` without an argument returns the current frame rate.\n   * The value returned is an approximation.\n   *\n   * @method frameRate\n   * @param  {Number} fps number of frames to draw per second.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white circle on a gray background. The circle moves from left to right in a loop. It slows down when the mouse is pressed.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Set the x variable based\n   *   // on the current frameCount.\n   *   let x = frameCount % 100;\n   *\n   *   // If the mouse is pressed,\n   *   // decrease the frame rate.\n   *   if (mouseIsPressed === true) {\n   *     frameRate(10);\n   *   } else {\n   *     frameRate(60);\n   *   }\n   *\n   *   // Use x to set the circle's\n   *   // position.\n   *   circle(x, 50, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A number written in black on a gray background. The number decreases when the mouse is pressed.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // If the mouse is pressed, do lots\n   *   // of math to slow down drawing.\n   *   if (mouseIsPressed === true) {\n   *     for (let i = 0; i < 1000000; i += 1) {\n   *       random();\n   *     }\n   *   }\n   *\n   *   // Get the current frame rate\n   *   // and display it.\n   *   let fps = frameRate();\n   *   text(fps, 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method frameRate\n   * @return {Number}       current frame rate.\n   */\n  fn.frameRate = function(fps) {\n    // p5._validateParameters('frameRate', arguments);\n    if (typeof fps !== 'number' || fps < 0) {\n      return this._frameRate;\n    } else {\n      this._targetFrameRate = fps;\n      if (fps === 0) {\n        this._frameRate = fps;\n      }\n      return this;\n    }\n  };\n\n  /**\n   * Returns the current framerate.\n   *\n   * @private\n   * @return {Number} current frameRate\n   */\n  fn.getFrameRate = function() {\n    return this.frameRate();\n  };\n\n  /**\n   * Specifies the number of frames to be displayed every second. For example,\n   * the function call frameRate(30) will attempt to refresh 30 times a second.\n   * If the processor is not fast enough to maintain the specified rate, the\n   * frame rate will not be achieved. Setting the frame rate within <a href=\"#/p5/setup\">setup()</a> is\n   * recommended. The default rate is 60 frames per second.\n   *\n   * Calling `frameRate()` with no arguments returns the current frame rate.\n   *\n   * @private\n   * @param {Number} [fps] number of frames to be displayed every second\n   */\n  fn.setFrameRate = function(fps) {\n    return this.frameRate(fps);\n  };\n\n  /**\n   * Returns the target frame rate.\n   *\n   * The value is either the system frame rate or the last value passed to\n   * <a href=\"#/p5/frameRate\">frameRate()</a>.\n   *\n   * @method getTargetFrameRate\n   * @return {Number} _targetFrameRate\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('The number 20 written in black on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Set the frame rate to 20.\n   *   frameRate(20);\n   *\n   *   // Get the target frame rate and\n   *   // display it.\n   *   let fps = getTargetFrameRate();\n   *   text(fps, 43, 54);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.getTargetFrameRate = function() {\n    return this._targetFrameRate;\n  };\n\n  /**\n   * Hides the cursor from view.\n   *\n   * @method noCursor\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Hide the cursor.\n   *   noCursor();\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   circle(mouseX, mouseY, 10);\n   *\n   *   describe('A white circle on a gray background. The circle follows the mouse as it moves. The cursor is hidden.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noCursor = function() {\n    this._curElement.elt.style.cursor = 'none';\n  };\n\n  /**\n   * A `String` variable with the WebGL version in use.\n   *\n   * `webglVersion`'s value equals one of the following string constants:\n   *\n   * - `WEBGL2` whose value is `'webgl2'`,\n   * - `WEBGL` whose value is `'webgl'`, or\n   * - `P2D` whose value is `'p2d'`. This is the default for 2D sketches.\n   * - `P2DHDR` whose value is `'p2d-hdr'` (used for HDR 2D sketches, if available).\n   *\n   * See <a href=\"#/p5/setAttributes\">setAttributes()</a> for ways to set the\n   * WebGL version.\n   *\n   * @property {(WEBGL|WEBGL2)} webglVersion\n   * @readOnly\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   background(200);\n   *\n   *   // Display the current WebGL version.\n   *   text(webglVersion, 42, 54);\n   *\n   *   describe('The text \"p2d\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font to use.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *\n   *   // Create a canvas using WEBGL mode.\n   *   createCanvas(100, 50, WEBGL);\n   *   background(200);\n   *\n   *   // Display the current WebGL version.\n   *   fill(0);\n   *   textFont(font);\n   *   text(webglVersion, -15, 5);\n   *\n   *   describe('The text \"webgl2\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font to use.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *\n   *   // Create a canvas using WEBGL mode.\n   *   createCanvas(100, 50, WEBGL);\n   *\n   *   // Set WebGL to version 1.\n   *   setAttributes({ version: 1 });\n   *\n   *   background(200);\n   *\n   *   // Display the current WebGL version.\n   *   fill(0);\n   *   textFont(font);\n   *   text(webglVersion, -14, 5);\n   *\n   *   describe('The text \"webgl\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.webglVersion = P2D;\n\n  /**\n   * A `Number` variable that stores the width of the screen display.\n   *\n   * `displayWidth` is useful for running full-screen programs. Its value\n   * depends on the current <a href=\"#/p5/pixelDensity\">pixelDensity()</a>.\n   *\n   * Note: The actual screen width can be computed as\n   * `displayWidth * pixelDensity()`.\n   *\n   * @property {Number} displayWidth\n   * @readOnly\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Set the canvas' width and height\n   *   // using the display's dimensions.\n   *   createCanvas(displayWidth, displayHeight);\n   *\n   *   background(200);\n   *\n   *   describe('A gray canvas that is the same size as the display.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @alt\n   * This example does not render anything.\n   */\n  fn.displayWidth = screen.width;\n\n  /**\n   * A `Number` variable that stores the height of the screen display.\n   *\n   * `displayHeight` is useful for running full-screen programs. Its value\n   * depends on the current <a href=\"#/p5/pixelDensity\">pixelDensity()</a>.\n   *\n   * Note: The actual screen height can be computed as\n   * `displayHeight * pixelDensity()`.\n   *\n   * @property {Number} displayHeight\n   * @readOnly\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Set the canvas' width and height\n   *   // using the display's dimensions.\n   *   createCanvas(displayWidth, displayHeight);\n   *\n   *   background(200);\n   *\n   *   describe('A gray canvas that is the same size as the display.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @alt\n   * This example does not render anything.\n   */\n  fn.displayHeight = screen.height;\n\n  /**\n   * A `Number` variable that stores the width of the browser's viewport.\n   *\n   * The <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Layout_viewport\" target=\"_blank\">layout viewport</a>\n   * is the area within the browser that's available for drawing.\n   *\n   * @property {Number} windowWidth\n   * @readOnly\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Set the canvas' width and height\n   *   // using the browser's dimensions.\n   *   createCanvas(windowWidth, windowHeight);\n   *\n   *   background(200);\n   *\n   *   describe('A gray canvas that takes up the entire browser window.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @alt\n   * This example does not render anything.\n   */\n  fn.windowWidth = 0;\n\n  /**\n   * A `Number` variable that stores the height of the browser's viewport.\n   *\n   * The <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Layout_viewport\" target=\"_blank\">layout viewport</a>\n   * is the area within the browser that's available for drawing.\n   *\n   * @property {Number} windowHeight\n   * @readOnly\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   // Set the canvas' width and height\n   *   // using the browser's dimensions.\n   *   createCanvas(windowWidth, windowHeight);\n   *\n   *   background(200);\n   *\n   *   describe('A gray canvas that takes up the entire browser window.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @alt\n   * This example does not render anything.\n   */\n  fn.windowHeight = 0;\n\n  /**\n   * A function that's called when the browser window is resized.\n   *\n   * Code placed in the body of `windowResized()` will run when the\n   * browser window's size changes. It's a good place to call\n   * <a href=\"#/p5/resizeCanvas\">resizeCanvas()</a> or make other\n   * adjustments to accommodate the new window size.\n   *\n   * The `event` parameter is optional. If added to the function declaration, it\n   * can be used for debugging or other purposes.\n   *\n   * @method windowResized\n   * @param {UIEvent} [event] optional resize Event.\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   createCanvas(windowWidth, windowHeight);\n   *\n   *   describe('A gray canvas with a white circle at its center. The canvas takes up the entire browser window. It changes size to match the browser window.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a circle at the center.\n   *   circle(width / 2, height / 2, 50);\n   * }\n   *\n   * // Resize the canvas when the\n   * // browser's size changes.\n   * function windowResized() {\n   *   resizeCanvas(windowWidth, windowHeight);\n   * }\n   * </code>\n   * </div>\n   * @alt\n   * This example does not render anything.\n   *\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   createCanvas(windowWidth, windowHeight);\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   describe('A gray canvas that takes up the entire browser window. It changes size to match the browser window.');\n   * }\n   *\n   * function windowResized(event) {\n   *   // Resize the canvas when the\n   *   // browser's size changes.\n   *   resizeCanvas(windowWidth, windowHeight);\n   *\n   *   // Print the resize event to the console for debugging.\n   *   print(event);\n   * }\n   * </code>\n   * </div>\n   * @alt\n   * This example does not render anything.\n   */\n  fn._onresize = function(e) {\n    this.windowWidth = getWindowWidth();\n    this.windowHeight = getWindowHeight();\n    const context = this._isGlobal ? window : this;\n    let executeDefault;\n    if (typeof context.windowResized === 'function') {\n      executeDefault = context.windowResized(e);\n      if (executeDefault !== undefined && !executeDefault) {\n        e.preventDefault();\n      }\n    }\n  };\n\n  function getWindowWidth() {\n    return (\n      window.innerWidth ||\n      (document.documentElement && document.documentElement.clientWidth) ||\n      (document.body && document.body.clientWidth) ||\n      0\n    );\n  }\n\n  function getWindowHeight() {\n    return (\n      window.innerHeight ||\n      (document.documentElement && document.documentElement.clientHeight) ||\n      (document.body && document.body.clientHeight) ||\n      0\n    );\n  }\n\n  /**\n   * Called upon each p5 instantiation instead of module import due to the\n   * possibility of the window being resized when no sketch is active.\n   */\n  fn._updateWindowSize = function() {\n    this.windowWidth = getWindowWidth();\n    this.windowHeight = getWindowHeight();\n  };\n\n  /**\n   * A `Number` variable that stores the width of the canvas in pixels.\n   *\n   * `width`'s default value is 100. Calling\n   * <a href=\"#/p5/createCanvas\">createCanvas()</a> or\n   * <a href=\"#/p5/resizeCanvas\">resizeCanvas()</a> changes the value of\n   * `width`. Calling <a href=\"#/p5/noCanvas\">noCanvas()</a> sets its value to\n   * 0.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   background(200);\n   *\n   *   // Display the canvas' width.\n   *   text(width, 42, 54);\n   *\n   *   describe('The number 100 written in black on a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(50, 100);\n   *\n   *   background(200);\n   *\n   *   // Display the canvas' width.\n   *   text(width, 21, 54);\n   *\n   *   describe('The number 50 written in black on a gray rectangle.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Display the canvas' width.\n   *   text(width, 42, 54);\n   *\n   *   describe('The number 100 written in black on a gray square. When the mouse is pressed, the square becomes a rectangle and the number becomes 50.');\n   * }\n   *\n   * // If the mouse is pressed, reisze\n   * // the canvas and display its new\n   * // width.\n   * function mousePressed() {\n   *   if (mouseX > 0 && mouseX < width && mouseY > 0 && mouseY < height) {\n   *     resizeCanvas(50, 100);\n   *     background(200);\n   *     text(width, 21, 54);\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * @property {Number} width\n   * @readOnly\n   */\n  Object.defineProperty(fn, 'width', {\n    get(){\n      return this._renderer.width;\n    }\n  });\n\n  /**\n   * A `Number` variable that stores the height of the canvas in pixels.\n   *\n   * `height`'s default value is 100. Calling\n   * <a href=\"#/p5/createCanvas\">createCanvas()</a> or\n   * <a href=\"#/p5/resizeCanvas\">resizeCanvas()</a> changes the value of\n   * `height`. Calling <a href=\"#/p5/noCanvas\">noCanvas()</a> sets its value to\n   * 0.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   background(200);\n   *\n   *   // Display the canvas' height.\n   *   text(height, 42, 54);\n   *\n   *   describe('The number 100 written in black on a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 50);\n   *\n   *   background(200);\n   *\n   *   // Display the canvas' height.\n   *   text(height, 42, 27);\n   *\n   *   describe('The number 50 written in black on a gray rectangle.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Display the canvas' height.\n   *   text(height, 42, 54);\n   *\n   *   describe('The number 100 written in black on a gray square. When the mouse is pressed, the square becomes a rectangle and the number becomes 50.');\n   * }\n   *\n   * // If the mouse is pressed, reisze\n   * // the canvas and display its new\n   * // height.\n   * function mousePressed() {\n   *   if (mouseX > 0 && mouseX < width && mouseY > 0 && mouseY < height) {\n   *     resizeCanvas(100, 50);\n   *     background(200);\n   *     text(height, 42, 27);\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * @property {Number} height\n   * @readOnly\n   */\n  Object.defineProperty(fn, 'height', {\n    get(){\n      return this._renderer.height;\n    }\n  });\n\n  /**\n   * Toggles full-screen mode or returns the current mode.\n   *\n   * Calling `fullscreen(true)` makes the sketch full-screen. Calling\n   * `fullscreen(false)` makes the sketch its original size.\n   *\n   * Calling `fullscreen()` without an argument returns `true` if the sketch\n   * is in full-screen mode and `false` if not.\n   *\n   * Note: Due to browser restrictions, `fullscreen()` can only be called with\n   * user input such as a mouse press.\n   *\n   * @method fullscreen\n   * @param  {Boolean} [val] whether the sketch should be in fullscreen mode.\n   * @return {Boolean} current fullscreen state.\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   background(200);\n   *\n   *   describe('A gray canvas that switches between default and full-screen display when clicked.');\n   * }\n   *\n   * // If the mouse is pressed,\n   * // toggle full-screen mode.\n   * function mousePressed() {\n   *   if (mouseX > 0 && mouseX < width && mouseY > 0 && mouseY < height) {\n   *     let fs = fullscreen();\n   *     fullscreen(!fs);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.fullscreen = function(val) {\n    // p5._validateParameters('fullscreen', arguments);\n    // no arguments, return fullscreen or not\n    if (typeof val === 'undefined') {\n      return (\n        document.fullscreenElement ||\n        document.webkitFullscreenElement ||\n        document.mozFullScreenElement ||\n        document.msFullscreenElement\n      );\n    } else {\n      // otherwise set to fullscreen or not\n      if (val) {\n        launchFullscreen(document.documentElement);\n      } else {\n        exitFullscreen();\n      }\n    }\n  };\n\n  /**\n   * Sets the pixel density or returns the current density.\n   *\n   * Computer displays are grids of little lights called <em>pixels</em>. A\n   * display's <em>pixel density</em> describes how many pixels it packs into an\n   * area. Displays with smaller pixels have a higher pixel density and create\n   * sharper images.\n   *\n   * `pixelDensity()` sets the pixel scaling for high pixel density displays.\n   * By default, the pixel density is set to match the display's density.\n   * Calling `pixelDensity(1)` turn this off.\n   *\n   * Calling `pixelDensity()` without an argument returns the current pixel\n   * density.\n   *\n   * @method pixelDensity\n   * @param  {Number} [val] desired pixel density.\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Set the pixel density to 1.\n   *   pixelDensity(1);\n   *\n   *   // Create a canvas and draw\n   *   // a circle.\n   *   createCanvas(100, 100);\n   *   background(200);\n   *   circle(50, 50, 70);\n   *\n   *   describe('A fuzzy white circle on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Set the pixel density to 3.\n   *   pixelDensity(3);\n   *\n   *   // Create a canvas, paint the\n   *   // background, and draw a\n   *   // circle.\n   *   createCanvas(100, 100);\n   *   background(200);\n   *   circle(50, 50, 70);\n   *\n   *   describe('A sharp white circle on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method pixelDensity\n   * @returns {Number} current pixel density of the sketch.\n   */\n  fn.pixelDensity = function(val) {\n    // p5._validateParameters('pixelDensity', arguments);\n    let returnValue;\n    if (typeof val === 'number') {\n      if (val !== this._renderer._pixelDensity) {\n        this._renderer._pixelDensity = val;\n      }\n      returnValue = this;\n      this.resizeCanvas(this.width, this.height, true); // as a side effect, it will clear the canvas\n    } else {\n      returnValue = this._renderer._pixelDensity;\n    }\n    return returnValue;\n  };\n\n  /**\n   * Returns the display's current pixel density.\n   *\n   * @method displayDensity\n   * @returns {Number} current pixel density of the display.\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Set the pixel density to 1.\n   *   pixelDensity(1);\n   *\n   *   // Create a canvas and draw\n   *   // a circle.\n   *   createCanvas(100, 100);\n   *   background(200);\n   *   circle(50, 50, 70);\n   *\n   *   describe('A fuzzy white circle drawn on a gray background. The circle becomes sharper when the mouse is pressed.');\n   * }\n   *\n   * function mousePressed() {\n   *   // Get the current display density.\n   *   let d = displayDensity();\n   *\n   *   // Use the display density to set\n   *   // the sketch's pixel density.\n   *   pixelDensity(d);\n   *\n   *   // Paint the background and\n   *   // draw a circle.\n   *   background(200);\n   *   circle(50, 50, 70);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.displayDensity = () => window.devicePixelRatio;\n\n  function launchFullscreen(element) {\n    const enabled =\n      document.fullscreenEnabled ||\n      document.webkitFullscreenEnabled ||\n      document.mozFullScreenEnabled ||\n      document.msFullscreenEnabled;\n    if (!enabled) {\n      throw new Error('Fullscreen not enabled in this browser.');\n    }\n    if (element.requestFullscreen) {\n      element.requestFullscreen();\n    } else if (element.mozRequestFullScreen) {\n      element.mozRequestFullScreen();\n    } else if (element.webkitRequestFullscreen) {\n      element.webkitRequestFullscreen();\n    } else if (element.msRequestFullscreen) {\n      element.msRequestFullscreen();\n    }\n  }\n\n  function exitFullscreen() {\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document.mozCancelFullScreen) {\n      document.mozCancelFullScreen();\n    } else if (document.webkitExitFullscreen) {\n      document.webkitExitFullscreen();\n    } else if (document.msExitFullscreen) {\n      document.msExitFullscreen();\n    }\n  }\n\n  /**\n   * Returns the sketch's current\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Learn/Common_questions/Web_mechanics/What_is_a_URL\" target=\"_blank\">URL</a>\n   * as a `String`.\n   *\n   * @method getURL\n   * @return {String} url\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   background(200);\n   *\n   *   // Get the sketch's URL\n   *   // and display it.\n   *   let url = getURL();\n   *   textWrap(CHAR);\n   *   text(url, 0, 40, 100);\n   *\n   *   describe('The URL \"https://p5js.org/reference/p5/getURL\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.getURL = () => location.href;\n\n  /**\n   * Returns the current\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Learn/Common_questions/Web_mechanics/What_is_a_URL#path_to_resource\" target=\"_blank\">URL</a>\n   * path as an `Array` of `String`s.\n   *\n   * For example, consider a sketch hosted at the URL\n   * `https://example.com/sketchbook`. Calling `getURLPath()` returns\n   * `['sketchbook']`. For a sketch hosted at the URL\n   * `https://example.com/sketchbook/monday`, `getURLPath()` returns\n   * `['sketchbook', 'monday']`.\n   *\n   * @method getURLPath\n   * @return {String[]} path components.\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   background(200);\n   *\n   *   // Get the sketch's URL path\n   *   // and display the first\n   *   // part.\n   *   let path = getURLPath();\n   *   text(path[0], 25, 54);\n   *\n   *   describe('The word \"reference\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.getURLPath = () =>\n    location.pathname.split('/').filter(v => v !== '');\n\n  /**\n   * Returns the current\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Learn/Common_questions/Web_mechanics/What_is_a_URL#parameters\" target=\"_blank\">URL parameters</a>\n   * in an `Object`.\n   *\n   * For example, calling `getURLParams()` in a sketch hosted at the URL\n   * `https://p5js.org?year=2014&month=May&day=15` returns\n   * `{ year: 2014, month: 'May', day: 15 }`.\n   *\n   * @method getURLParams\n   * @return {Object} URL params\n   * @example\n   * <div class='norender notest'>\n   * <code>\n   * // Imagine this sketch is hosted at the following URL:\n   * // https://p5js.org?year=2014&month=May&day=15\n   *\n   * function setup() {\n   *   background(200);\n   *\n   *   // Get the sketch's URL\n   *   // parameters and display\n   *   // them.\n   *   let params = getURLParams();\n   *   text(params.day, 10, 20);\n   *   text(params.month, 10, 40);\n   *   text(params.year, 10, 60);\n   *\n   *   describe('The text \"15\", \"May\", and \"2014\" written in black on separate lines.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @alt\n   * This example does not render anything.\n   */\n  fn.getURLParams = function() {\n    const re = /[?&]([^&=]+)(?:[&=])([^&=]+)/gim;\n    let m;\n    const v = {};\n    while ((m = re.exec(location.search)) != null) {\n      if (m.index === re.lastIndex) {\n        re.lastIndex++;\n      }\n      v[m[1]] = m[2];\n    }\n    return v;\n  };\n\n  /**\n   * Converts 3D world coordinates to 2D screen coordinates.\n   *\n   * This function takes a 3D vector and converts its coordinates\n   * from the world space to screen space. This can be useful for placing\n   * 2D elements in a 3D scene or for determining the screen position\n   * of 3D objects.\n   *\n   * @method worldToScreen\n   * @param {Number|p5.Vector} x The x coordinate in world space. (Or a vector for all three coordinates.)\n   * @param {Number} y The y coordinate in world space.\n   * @param {Number} [z] The z coordinate in world space.\n   * @return {p5.Vector} A vector containing the 2D screen coordinates.\n   * @example\n   * <div>\n   * <code>\n   *\n   * function setup() {\n   *   createCanvas(150, 150);\n   *   let vertices = [\n   *     createVector(-20, -20),\n   *     createVector(20, -20),\n   *     createVector(20, 20),\n   *     createVector(-20, 20)\n   *   ];\n   *\n   *   push();\n   *   translate(75, 55);\n   *   rotate(PI / 4);\n   *\n   *   // Convert world coordinates to screen coordinates\n   *   let screenPos = vertices.map(v => worldToScreen(v));\n   *   pop();\n   *\n   *   background(200);\n   *\n   *   stroke(0);\n   *   fill(100, 150, 255, 100);\n   *   beginShape();\n   *   screenPos.forEach(pos => vertex(pos.x, pos.y));\n   *   endShape(CLOSE);\n   *\n   *   screenPos.forEach((pos, i) => {\n   *     fill(0);\n   *     textSize(10);\n   *     if (i === 0) {\n   *       text(i + 1, pos.x + 3, pos.y - 7);\n   *     } else if (i === 1) {\n   *       text(i + 1, pos.x + 7, pos.y + 2);\n   *     } else if (i === 2) {\n   *       text(i + 1, pos.x - 2, pos.y + 12);\n   *     } else if (i === 3) {\n   *       text(i + 1, pos.x - 12, pos.y - 2);\n   *     }\n   *   });\n   *\n   *   fill(0);\n   *   noStroke();\n   *   textSize(10);\n   *   let legendY = height - 35;\n   *   screenPos.forEach((pos, i) => {\n   *     text(`Vertex ${i + 1}: (${pos.x.toFixed(1)}, ${pos.y.toFixed(1)})`, 5, legendY + i * 10);\n   *   });\n   *\n   *   describe('A rotating square is transformed and drawn using screen coordinates.');\n   *\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * let vertices;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *   vertices = [\n   *     createVector(-25, -25, -25),\n   *     createVector(25, -25, -25),\n   *     createVector(25, 25, -25),\n   *     createVector(-25, 25, -25),\n   *     createVector(-25, -25, 25),\n   *     createVector(25, -25, 25),\n   *     createVector(25, 25, 25),\n   *     createVector(-25, 25, 25)\n   *   ];\n   *\n   *   describe('A rotating cube with points mapped to 2D screen space and displayed as ellipses.');\n   *\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Animate rotation\n   *   let rotationX = millis() / 1000;\n   *   let rotationY = millis() / 1200;\n   *\n   *   push();\n   *\n   *   rotateX(rotationX);\n   *   rotateY(rotationY);\n   *\n   *   // Convert world coordinates to screen coordinates\n   *   let screenPos = vertices.map(v => worldToScreen(v));\n   *\n   *   pop();\n   *\n   *   screenPos.forEach((pos, i) => {\n   *\n   *     let screenX = pos.x - width / 2;\n   *     let screenY = pos.y - height / 2;\n   *     fill(0);\n   *     noStroke();\n   *     ellipse(screenX, screenY, 3, 3);\n   *   });\n   * }\n   * </code>\n   * </div>\n   *\n   */\n  fn.worldToScreen = function(worldPosition) {\n    if (typeof worldPosition === \"number\") {\n      // We got passed numbers, convert to vector\n      worldPosition = this.createVector(...arguments);\n    }\n\n    const matrix = this._renderer.getWorldToScreenMatrix();\n    const screenPosition = matrix.multiplyAndNormalizePoint(worldPosition);\n    return screenPosition;\n  };\n  /**\n   * Converts 2D screen coordinates to 3D world coordinates.\n   *\n   * This function takes a vector and converts its coordinates from coordinates\n   * on the screen to coordinates in the currently drawn object. This can be\n   * useful for determining the mouse position relative to a 2D or 3D object.\n   *\n   * If given, the Z component of the input coordinates is treated as \"depth\",\n   * or distance from the camera.\n   *\n   * @method screenToWorld\n   * @param {Number|p5.Vector} x The x coordinate in screen space. (Or a vector for all three coordinates.)\n   * @param {Number} y The y coordinate in screen space.\n   * @param {Number} [z] The z coordinate in screen space.\n   * @return {p5.Vector} A vector containing the 3D world space coordinates.\n   * @example\n   * <div>\n   * <code>\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   describe('A rotating square with a line passing through the mouse drawn across it.');\n   * }\n   *\n   * function draw() {\n   *   background(220);\n   *\n   *   // Move to center and rotate\n   *   translate(width/2, height/2);\n   *   rotate(millis() / 1000);\n   *   rect(-30, -30, 60);\n   *\n   *   // Compute the location of the mouse in the coordinates of the square\n   *   let localMouse = screenToWorld(createVector(mouseX, mouseY));\n   *\n   *   // Draw a line parallel to the local Y axis, passing through the mouse\n   *   line(localMouse.x, -30, localMouse.x, 30);\n   * }\n   *\n   * </code>\n   * </div>\n   *\n   */\n  fn.screenToWorld = function(screenPosition) {\n    if (typeof screenPosition === \"number\") {\n      // We got passed numbers, convert to vector\n      screenPosition = this.createVector(...arguments);\n    }\n\n    const matrix = this._renderer.getWorldToScreenMatrix();\n\n    if (screenPosition.dimensions == 2) {\n      // Calculate a sensible Z value for the current camera projection that\n      // will result in 0 once converted to world coordinates\n      let z = matrix.mat4[14] / matrix.mat4[15];\n      screenPosition = this.createVector(screenPosition.x, screenPosition.y, z);\n    }\n\n    const matrixInverse = matrix.invert(matrix);\n\n    const worldPosition = matrixInverse.multiplyAndNormalizePoint(screenPosition);\n    return worldPosition;\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  environment(p5, p5.prototype);\n}\n\nexport { environment as default };\n","import { ColorSpace, sRGB } from 'colorjs.io/fn';\n\nvar HSBSpace = new ColorSpace({\n  id: 'hsb',\n  name: 'HSB',\n  coords: {\n    h: {\n      refRange: [0, 360],\n      type: 'angle',\n      name: 'Hue'\n    },\n    s: {\n      range: [0, 100],\n      name: 'Saturation'\n    },\n    b: {\n      range: [0, 100],\n      name: 'Brightness'\n    }\n  },\n\n  base: sRGB,\n\n  fromBase: rgb => {\n    const val = Math.max(...rgb);\n    const chroma = val - Math.min(...rgb);\n\n    let [red, green, blue] = rgb;\n\n    let hue, sat;\n    if (chroma === 0) {\n      // Return early if grayscale.\n      hue = 0;\n      sat = 0;\n    } else {\n      sat = chroma / val;\n      if (red === val) {\n        // Magenta to yellow.\n        hue = (green - blue) / chroma;\n      } else if (green === val) {\n        // Yellow to cyan.\n        hue = 2 + (blue - red) / chroma;\n      } else if (blue === val) {\n        // Cyan to magenta.\n        hue = 4 + (red - green) / chroma;\n      }\n      if (hue < 0) {\n        // Confine hue to the interval [0, 1).\n        hue += 6;\n      } else if (hue >= 6) {\n        hue -= 6;\n      }\n    }\n\n    return [hue / 6 * 360, sat * 100, val * 100];\n  },\n  toBase,\n\n  formats: {\n    default: {\n      type: 'custom',\n      serialize: (coords, alpha) => {\n        const rgb = toBase(coords);\n        let ret = `rgb(${\n          Math.round(rgb[0] * 100 * 100) / 100\n        }% ${\n          Math.round(rgb[1] * 100 * 100) / 100\n        }% ${\n          Math.round(rgb[2] * 100 * 100) / 100\n        }%`;\n\n        if (alpha < 1) {\n          ret += ` / ${alpha}`;\n        }\n\n        ret += ')';\n\n        return ret;\n      }\n    },\n    'hsb': {\n      coords: ['<number> | <angle>', '<percentage>', '<percentage>']\n    },\n    'hsba': {\n      coords: ['<number> | <angle>', '<percentage>', '<percentage>'],\n      commans: true,\n      lastAlpha: true\n    }\n  }\n});\n\nfunction toBase(hsb){\n  const hue = hsb[0] / 360 * 6; // We will split hue into 6 sectors.\n  const sat = hsb[1] / 100;\n  const val = hsb[2] / 100;\n\n  let RGB = [];\n\n  if (sat === 0) {\n    RGB = [val, val, val]; // Return early if grayscale.\n  } else {\n    const sector = Math.floor(hue);\n    const tint1 = val * (1 - sat);\n    const tint2 = val * (1 - sat * (hue - sector));\n    const tint3 = val * (1 - sat * (1 + sector - hue));\n    let red, green, blue;\n    if (sector === 1) {\n      // Yellow to green.\n      red = tint2;\n      green = val;\n      blue = tint1;\n    } else if (sector === 2) {\n      // Green to cyan.\n      red = tint1;\n      green = val;\n      blue = tint3;\n    } else if (sector === 3) {\n      // Cyan to blue.\n      red = tint1;\n      green = tint2;\n      blue = val;\n    } else if (sector === 4) {\n      // Blue to magenta.\n      red = tint3;\n      green = tint1;\n      blue = val;\n    } else if (sector === 5) {\n      // Magenta to red.\n      red = val;\n      green = tint1;\n      blue = tint2;\n    } else {\n      // Red to yellow (sector could be 0 or 6).\n      red = val;\n      green = tint3;\n      blue = tint1;\n    }\n    RGB = [red, green, blue];\n  }\n\n  return RGB;\n}\n\nexport { HSBSpace as default };\n","import { sRGB, P3, HSL as HSL$1, HWB as HWB$1, Lab, LCH as LCH$1, OKLab, OKLCH as OKLCH$1, ColorSpace, to, parse, range, serialize } from 'colorjs.io/fn';\nimport HSBSpace from './color/color_spaces/hsb.js';\n\n/**\n * @module Color\n * @submodule Creating & Reading\n * @for p5\n * @requires core\n * @requires color_conversion\n */\n\n\nconst map = (n, start1, stop1, start2, stop2, clamp) => {\n  let result = ((n - start1) / (stop1 - start1) * (stop2 - start2) + start2);\n  if (clamp) {\n    result = Math.max(result, Math.min(start2, stop2));\n    result = Math.min(result, Math.max(start2, stop2));\n  }\n  return result;\n};\n\nconst serializationMap = {};\n\nclass Color {\n  // Reference to underlying color object depending on implementation\n  // Not meant to be used publicly unless the implementation is known for sure\n  _color;\n  // Color mode of the Color object, uses p5 color modes\n  mode;\n\n  static colorMap = {};\n  static #colorjsMaxes = {};\n  static #grayscaleMap = {};\n\n  // Used to add additional color modes to p5.js\n  // Uses underlying library's definition\n  static addColorMode(mode, definition){\n    ColorSpace.register(definition);\n    Color.colorMap[mode] = definition.id;\n\n    // Get colorjs maxes\n    Color.#colorjsMaxes[mode] = Object.values(definition.coords).reduce((acc, v) => {\n        acc.push(v.refRange || v.range);\n        return acc;\n      }, []);\n    Color.#colorjsMaxes[mode].push([0, 1]);\n\n    // Get grayscale mapping\n    Color.#grayscaleMap[mode] = definition.fromGray;\n  }\n\n  constructor(vals, colorMode, colorMaxes, { clamp = false } = {}) {\n    // This changes with the color object\n    this.mode = colorMode || RGB;\n\n    if(vals instanceof Color){\n      // Received Color object to be used for color mode conversion\n      const mode = colorMode ?\n        Color.colorMap[colorMode] :\n        Color.colorMap[vals.mode];\n      this._color = to(vals._color, mode);\n      this.mode = mode;\n\n    }else if (typeof vals === 'object' && !Array.isArray(vals) && vals !== null){\n      // Received color.js object to be used internally\n      const mode = colorMode ?\n        Color.colorMap[colorMode] :\n        vals.spaceId;\n      this._color = to(vals, mode);\n      this.mode = colorMode || Object.entries(Color.colorMap).find(([key, val]) => {\n          return val === this._color.spaceId;\n        });\n\n    } else if(typeof vals[0] === 'string') {\n      // Received string\n      try{\n        this._color = parse(vals[0]);\n        const [mode] = Object.entries(Color.colorMap).find(([key, val]) => {\n          return val === this._color.spaceId;\n        });\n        this.mode = mode;\n        this._color = to(this._color, this._color.spaceId);\n      }catch(err){\n        // TODO: Invalid color string\n        throw new Error('Invalid color string');\n      }\n\n    }else {\n      // Received individual channel values\n      let mappedVals;\n\n      if(colorMaxes){\n        // NOTE: need to consider different number of arguments (eg. CMYK)\n        if(vals.length === 4){\n          mappedVals = Color.mapColorRange(vals, this.mode, colorMaxes, clamp);\n        }else if(vals.length === 3){\n          mappedVals = Color.mapColorRange([vals[0], vals[1], vals[2]], this.mode, colorMaxes, clamp);\n          mappedVals.push(1);\n        }else if(vals.length === 2){\n          // Grayscale with alpha\n          if(Color.#grayscaleMap[this.mode]){\n            mappedVals = Color.#grayscaleMap[this.mode](vals[0], colorMaxes, clamp);\n          }else {\n            mappedVals = Color.mapColorRange([vals[0], vals[0], vals[0]], this.mode, colorMaxes, clamp);\n          }\n          const alphaMaxes = Array.isArray(colorMaxes[colorMaxes.length-1]) ?\n            colorMaxes[colorMaxes.length-1] :\n            [0, colorMaxes[colorMaxes.length-1]];\n          mappedVals.push(\n            map(\n              vals[1],\n              alphaMaxes[0],\n              alphaMaxes[1],\n              0,\n              1,\n              clamp\n            )\n          );\n        }else if(vals.length === 1){\n          // Grayscale only\n          if(Color.#grayscaleMap[this.mode]){\n            mappedVals = Color.#grayscaleMap[this.mode](vals[0], colorMaxes, clamp);\n          }else {\n            mappedVals = Color.mapColorRange([vals[0], vals[0], vals[0]], this.mode, colorMaxes, clamp);\n          }\n          mappedVals.push(1);\n        }else {\n          throw new Error('Invalid color');\n        }\n      }else {\n        mappedVals = vals;\n      }\n\n      const space = Color.colorMap[this.mode] || console.error('Invalid color mode');\n      const coords = mappedVals.slice(0, 3);\n\n      const color = {\n        space,\n        coords,\n        alpha: mappedVals[3]\n      };\n      this._color = to(color, space);\n    }\n  }\n\n  // Convert from p5 color range to color.js color range\n  static mapColorRange(origin, mode, maxes, clamp){\n    const p5Maxes = maxes.map((max) => {\n      if(!Array.isArray(max)){\n        return [0, max];\n      }else {\n        return max;\n      }\n    });\n    const colorjsMaxes = Color.#colorjsMaxes[mode];\n\n    return origin.map((channel, i) => {\n      const newval = map(channel, p5Maxes[i][0], p5Maxes[i][1], colorjsMaxes[i][0], colorjsMaxes[i][1], clamp);\n      return newval;\n    });\n  }\n\n  // Convert from color.js color range to p5 color range\n  static unmapColorRange(origin, mode, maxes){\n    const p5Maxes = maxes.map((max) => {\n      if(!Array.isArray(max)){\n        return [0, max];\n      }else {\n        return max;\n      }\n    });\n    const colorjsMaxes = Color.#colorjsMaxes[mode];\n\n    return origin.map((channel, i) => {\n      const newval = map(channel, colorjsMaxes[i][0], colorjsMaxes[i][1], p5Maxes[i][0], p5Maxes[i][1]);\n      return newval;\n    });\n  }\n\n  // Will do conversion in-Gamut as out of Gamut conversion is only really useful for futher conversions\n  #toColorMode(mode){\n    return new Color(this._color, mode);\n  }\n\n  // Get raw coordinates of underlying library, can differ between libraries\n  get _array() {\n    return this._getRGBA();\n  }\n\n  array(){\n    return this._array;\n  }\n\n  lerp(color, amt, mode){\n    // Find the closest common ancestor color space\n    let spaceIndex = -1;\n    while(\n      (\n        spaceIndex+1 < this._color.space.path.length ||\n        spaceIndex+1 < color._color.space.path.length\n      ) &&\n      this._color.space.path[spaceIndex+1] === color._color.space.path[spaceIndex+1]\n    ){\n      spaceIndex += 1;\n    }\n\n    if (spaceIndex === -1) {\n      // This probably will not occur in practice\n      throw new Error('Cannot lerp colors. No common color space found');\n    }\n\n    const obj = range(this._color, color._color, {\n      space: this._color.space.path[spaceIndex].id\n    })(amt);\n\n    return new Color(obj, mode || this.mode);\n  }\n\n  /**\n   * Returns the color formatted as a `String`.\n   *\n   * Calling `myColor.toString()` can be useful for debugging, as in\n   * `print(myColor.toString())`. It's also helpful for using p5.js with other\n   * libraries.\n   *\n   * The parameter, `format`, is optional. If a format string is passed, as in\n   * `myColor.toString('#rrggbb')`, it will determine how the color string is\n   * formatted. By default, color strings are formatted as `'rgba(r, g, b, a)'`.\n   *\n   * @param {String} [format] how the color string will be formatted.\n   * Leaving this empty formats the string as rgba(r, g, b, a).\n   * '#rgb' '#rgba' '#rrggbb' and '#rrggbbaa' format as hexadecimal color codes.\n   * 'rgb' 'hsb' and 'hsl' return the color formatted in the specified color mode.\n   * 'rgba' 'hsba' and 'hsla' are the same as above but with alpha channels.\n   * 'rgb%' 'hsb%' 'hsl%' 'rgba%' 'hsba%' and 'hsla%' format as percentages.\n   * @return {String} the formatted string.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object.\n   *   let myColor = color('darkorchid');\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the text.\n   *   text(myColor.toString('#rrggbb'), 50, 50);\n   *\n   *   describe('The text \"#9932cc\" written in purple on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  toString(format) {\n    const key = `${this._color.space.id}-${this._color.coords.join(\",\")}-${this._color.alpha}-${format}`;\n    let colorString = serializationMap[key];\n\n    if(!colorString){\n      colorString = serialize(this._color, {\n        format\n      });\n      serializationMap[key] = colorString;\n    }\n    return colorString;\n  }\n\n  /**\n   * Sets the red component of a color.\n   *\n   * The range depends on the <a href=\"#/p5/colorMode\">colorMode()</a>. In the\n   * default RGB mode it's between 0 and 255.\n   *\n   * @param {Number} red the new red value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(255, 128, 128);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 20, 35, 60);\n   *\n   *   // Change the red value.\n   *   c.setRed(64);\n   *\n   *   // Draw the right rectangle.\n   *   fill(c);\n   *   rect(50, 20, 35, 60);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is teal.');\n   * }\n   * </code>\n   * </div>\n   */\n  setRed(new_red, max=[0, 1]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    const colorjsMax = Color.#colorjsMaxes[RGB][0];\n    const newval = map(new_red, max[0], max[1], colorjsMax[0], colorjsMax[1]);\n\n    if(this.mode === RGB || this.mode === RGBHDR){\n      this._color.coords[0] = newval;\n    }else {\n      // Will do an imprecise conversion to 'srgb', not recommended\n      const space = this._color.space.id;\n      const representation = to(this._color, 'srgb');\n      representation.coords[0] = newval;\n      this._color = to(representation, space);\n    }\n  }\n\n  /**\n   * Sets the green component of a color.\n   *\n   * The range depends on the <a href=\"#/p5/colorMode\">colorMode()</a>. In the\n   * default RGB mode it's between 0 and 255.\n   *\n   * @param {Number} green the new green value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(255, 128, 128);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 20, 35, 60);\n   *\n   *   // Change the green value.\n   *   c.setGreen(255);\n   *\n   *   // Draw the right rectangle.\n   *   fill(c);\n   *   rect(50, 20, 35, 60);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is yellow.');\n   * }\n   * </code>\n   * </div>\n   */\n  setGreen(new_green, max=[0, 1]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    const colorjsMax = Color.#colorjsMaxes[RGB][1];\n    const newval = map(new_green, max[0], max[1], colorjsMax[0], colorjsMax[1]);\n\n    if(this.mode === RGB || this.mode === RGBHDR){\n      this._color.coords[1] = newval;\n    }else {\n      // Will do an imprecise conversion to 'srgb', not recommended\n      const space = this._color.space.id;\n      const representation = to(this._color, 'srgb');\n      representation.coords[1] = newval;\n      this._color = to(representation, space);\n    }\n  }\n\n  /**\n   * Sets the blue component of a color.\n   *\n   * The range depends on the <a href=\"#/p5/colorMode\">colorMode()</a>. In the\n   * default RGB mode it's between 0 and 255.\n   *\n   * @param {Number} blue the new blue value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(255, 128, 128);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 20, 35, 60);\n   *\n   *   // Change the blue value.\n   *   c.setBlue(255);\n   *\n   *   // Draw the right rectangle.\n   *   fill(c);\n   *   rect(50, 20, 35, 60);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is pale fuchsia.');\n   * }\n   * </code>\n   * </div>\n   **/\n  setBlue(new_blue, max=[0, 1]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    const colorjsMax = Color.#colorjsMaxes[RGB][2];\n    const newval = map(new_blue, max[0], max[1], colorjsMax[0], colorjsMax[1]);\n\n    if(this.mode === RGB || this.mode === RGBHDR){\n      this._color.coords[2] = newval;\n    }else {\n      // Will do an imprecise conversion to 'srgb', not recommended\n      const space = this._color.space.id;\n      const representation = to(this._color, 'srgb');\n      representation.coords[2] = newval;\n      this._color = to(representation, space);\n    }\n  }\n\n  /**\n   * Sets the alpha (transparency) value of a color.\n   *\n   * The range depends on the\n   * <a href=\"#/p5/colorMode\">colorMode()</a>. In the default RGB mode it's\n   * between 0 and 255.\n   *\n   * @param {Number} alpha the new alpha value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(255, 128, 128);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 20, 35, 60);\n   *\n   *   // Change the alpha value.\n   *   c.setAlpha(128);\n   *\n   *   // Draw the right rectangle.\n   *   fill(c);\n   *   rect(50, 20, 35, 60);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is faded pink.');\n   * }\n   * </code>\n   * </div>\n   */\n  setAlpha(new_alpha, max=[0, 1]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    const colorjsMax = Color.#colorjsMaxes[this.mode][3];\n    const newval = map(new_alpha, max[0], max[1], colorjsMax[0], colorjsMax[1]);\n\n    this._color.alpha = newval;\n  }\n\n  _getRGBA(maxes=[1, 1, 1, 1]) {\n    // Get colorjs maxes\n    const colorjsMaxes = Color.#colorjsMaxes[RGB];\n\n    // Normalize everything to 0,1 or the provided range (map)\n    let coords = structuredClone(to(this._color, 'srgb').coords);\n    coords.push(this._color.alpha);\n\n    const rangeMaxes = maxes.map((v) => {\n      if(!Array.isArray(v)){\n        return [0, v];\n      }else {\n        return v\n      }\n    });\n\n    coords = coords.map((coord, i) => {\n      return map(coord, colorjsMaxes[i][0], colorjsMaxes[i][1], rangeMaxes[i][0], rangeMaxes[i][1]);\n    });\n\n    return coords;\n  }\n\n  _getMode() {\n    return this.mode;\n  }\n\n  _getRed(max=[0, 1]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    if(this.mode === RGB || this.mode === RGBHDR){\n      const colorjsMax = Color.#colorjsMaxes[this.mode][0];\n      return map(this._color.coords[0], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }else {\n      // Will do an imprecise conversion to 'srgb', not recommended\n      const colorjsMax = Color.#colorjsMaxes[RGB][0];\n      return map(to(this._color, 'srgb').coords[0], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }\n  }\n\n  /**\n   * This function extracts the green value from a color object and\n   * returns it in the range 0255 by default. When `colorMode()` is given to an\n   * RBG value, the green value within the givin range is returned\n   */\n  _getGreen(max=[0, 1]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    if(this.mode === RGB || this.mode === RGBHDR){\n      const colorjsMax = Color.#colorjsMaxes[this.mode][1];\n      return map(this._color.coords[1], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }else {\n      // Will do an imprecise conversion to 'srgb', not recommended\n      const colorjsMax = Color.#colorjsMaxes[RGB][1];\n      return map(to(this._color, 'srgb').coords[1], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }\n  }\n\n  _getBlue(max=[0, 1]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    if(this.mode === RGB || this.mode === RGBHDR){\n      const colorjsMax = Color.#colorjsMaxes[this.mode][2];\n      return map(this._color.coords[2], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }else {\n      // Will do an imprecise conversion to 'srgb', not recommended\n      const colorjsMax = Color.#colorjsMaxes[RGB][2];\n      return map(to(this._color, 'srgb').coords[2], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }\n  }\n\n  _getAlpha(max=[0, 1]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    const colorjsMax = Color.#colorjsMaxes[this.mode][3];\n    return map(this._color.alpha, colorjsMax[0], colorjsMax[1], max[0], max[1]);\n  }\n\n  /**\n   * Hue is the same in HSB and HSL, but the maximum value may be different.\n   * This function will return the HSB-normalized saturation when supplied with\n   * an HSB color object, but will default to the HSL-normalized saturation\n   * otherwise.\n   */\n  _getHue(max=[0, 360]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    if(this.mode === HSB || this.mode === HSL){\n      const colorjsMax = Color.#colorjsMaxes[this.mode][0];\n      return map(this._color.coords[0], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }else {\n      // Will do an imprecise conversion to 'HSL', not recommended\n      const colorjsMax = Color.#colorjsMaxes[HSL][0];\n      return map(to(this._color, 'hsl').coords[0], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }\n  }\n\n  /**\n   * Saturation is scaled differently in HSB and HSL. This function will return\n   * the HSB saturation when supplied with an HSB color object, but will default\n   * to the HSL saturation otherwise.\n   */\n  _getSaturation(max=[0, 100]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    if(this.mode === HSB || this.mode === HSL){\n      const colorjsMax = Color.#colorjsMaxes[this.mode][1];\n      return map(this._color.coords[1], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }else {\n      // Will do an imprecise conversion to 'HSL', not recommended\n      const colorjsMax = Color.#colorjsMaxes[HSL][1];\n      return map(to(this._color, 'hsl').coords[1], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }\n  }\n  /**\n   * Brightness obtains the HSB brightness value from either a p5.Color object,\n   * an array of color components, or a CSS color string.Depending on value,\n   * when `colorMode()` is set to HSB, this function will return the\n   * brightness value in the range. By default, this function will return\n   * the HSB brightness within the range 0 - 100.\n   */\n\n  _getBrightness(max=[0, 100]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    if(this.mode === HSB){\n      const colorjsMax = Color.#colorjsMaxes[this.mode][2];\n      return map(this._color.coords[2], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }else {\n      // Will do an imprecise conversion to 'HSB', not recommended\n      const colorjsMax = Color.#colorjsMaxes[HSB][2];\n      return map(to(this._color, 'hsb').coords[2], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }\n  }\n\n  _getLightness(max=[0, 100]) {\n    if(!Array.isArray(max)){\n      max = [0, max];\n    }\n\n    if(this.mode === HSL){\n      const colorjsMax = Color.#colorjsMaxes[this.mode][2];\n      return map(this._color.coords[2], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }else {\n      // Will do an imprecise conversion to 'HSL', not recommended\n      const colorjsMax = Color.#colorjsMaxes[HSL][2];\n      return map(to(this._color, 'hsl').coords[2], colorjsMax[0], colorjsMax[1], max[0], max[1]);\n    }\n  }\n}\n\nfunction color(p5, fn, lifecycles){\n  /**\n   * A class to describe a color.\n   *\n   * Each `p5.Color` object stores the color mode\n   * and level maxes that were active during its construction. These values are\n   * used to interpret the arguments passed to the object's constructor. They\n   * also determine output formatting such as when\n   * <a href=\"#/p5/saturation\">saturation()</a> is called.\n   *\n   * Color is stored internally as an array of ideal RGBA values in floating\n   * point form, normalized from 0 to 1. These values are used to calculate the\n   * closest screen colors, which are RGBA levels from 0 to 255. Screen colors\n   * are sent to the renderer.\n   *\n   * When different color representations are calculated, the results are cached\n   * for performance. These values are normalized, floating-point numbers.\n   *\n   * Note: <a href=\"#/p5/color\">color()</a> is the recommended way to create an\n   * instance of this class.\n   *\n   * @class p5.Color\n   * @param {p5} [pInst]                      pointer to p5 instance.\n   *\n   * @param {Number[]|String} vals            an array containing the color values\n   *                                          for red, green, blue and alpha channel\n   *                                          or CSS color.\n   */\n  p5.Color = Color;\n\n  sRGB.fromGray = P3.fromGray = function(val, maxes, clamp){\n    // Use blue max\n    const p5Maxes = maxes.map((max) => {\n      if(!Array.isArray(max)){\n        return [0, max];\n      }else {\n        return max;\n      }\n    });\n\n    const v = map(val, p5Maxes[2][0], p5Maxes[2][1], 0, 1, clamp);\n    return [v, v, v];\n  };\n\n  HSBSpace.fromGray = HSL$1.fromGray = function(val, maxes, clamp){\n    // Use brightness max\n    const p5Maxes = maxes.map((max) => {\n      if(!Array.isArray(max)){\n        return [0, max];\n      }else {\n        return max;\n      }\n    });\n\n    const v = map(val, p5Maxes[2][0], p5Maxes[2][1], 0, 100, clamp);\n    return [0, 0, v];\n  };\n\n  HWB$1.fromGray = function(val, maxes, clamp){\n    // Use Whiteness and Blackness to create number line\n    const p5Maxes = maxes.map((max) => {\n      if(!Array.isArray(max)){\n        return [0, max];\n      }else {\n        return max;\n      }\n    });\n\n    const wbMax =\n      (Math.abs(p5Maxes[1][0] - p5Maxes[1][1])) / 2 +\n      (Math.abs(p5Maxes[2][0] - p5Maxes[2][1])) / 2;\n\n    const nVal = map(val, 0, wbMax, 0, 100);\n    let white, black;\n    if(nVal < 50){\n      black = nVal;\n      white = 100 - nVal;\n    }else if(nVal >= 50){\n      white = nVal;\n      black = 100 - nVal;\n    }\n    return [0, white, black];\n  };\n\n  Lab.fromGray =\n  LCH$1.fromGray =\n  OKLab.fromGray =\n  OKLCH$1.fromGray =\n  function(val, maxes, clamp){\n    // Use lightness max\n    const p5Maxes = maxes.map((max) => {\n      if(!Array.isArray(max)){\n        return [0, max];\n      }else {\n        return max;\n      }\n    });\n\n    const v = map(val, p5Maxes[0][0], p5Maxes[0][1], 0, 100, clamp);\n    return [v, 0, 0];\n  };\n\n  // Register color modes and initialize Color maxes to what p5 has set for itself\n  p5.Color.addColorMode(RGB, sRGB);\n  p5.Color.addColorMode(RGBHDR, P3);\n  p5.Color.addColorMode(HSB, HSBSpace);\n  p5.Color.addColorMode(HSL, HSL$1);\n  p5.Color.addColorMode(HWB, HWB$1);\n  p5.Color.addColorMode(LAB, Lab);\n  p5.Color.addColorMode(LCH, LCH$1);\n  p5.Color.addColorMode(OKLAB, OKLab);\n  p5.Color.addColorMode(OKLCH, OKLCH$1);\n\n  lifecycles.presetup = function(){\n    const pInst = this;\n\n    // Decorate set methods\n    const setMethods = ['Red', 'Green', 'Blue', 'Alpha'];\n    for(let i in setMethods){\n      const method = setMethods[i];\n      const setCopy = p5.Color.prototype['set' + method];\n      p5.Color.prototype['set' + method] = function(newval, max){\n        max = max || pInst?._renderer?.states?.colorMaxes?.[RGB][i];\n        return setCopy.call(this, newval, max);\n      };\n    }\n\n    // Decorate get methods\n    function decorateGet(channel, modes){\n      const getCopy = p5.Color.prototype['_get' + channel];\n      p5.Color.prototype['_get' + channel] = function(max){\n        if(Object.keys(modes).includes(this.mode)){\n          max = max || pInst?._renderer?.states?.colorMaxes?.[this.mode][modes[this.mode]];\n        }else {\n          const defaultMode = Object.keys(modes)[0];\n          max = max || pInst?._renderer?.states?.colorMaxes?.[defaultMode][modes[defaultMode]];\n        }\n\n        return getCopy.call(this, max);\n      };\n    }\n\n    decorateGet('Red', {\n      [RGB]: 0,\n      [RGBHDR]: 0\n    });\n    decorateGet('Green', {\n      [RGB]: 1,\n      [RGBHDR]: 1\n    });\n    decorateGet('Blue', {\n      [RGB]: 2,\n      [RGBHDR]: 2\n    });\n    decorateGet('Alpha', {\n      [RGB]: 3,\n      [RGBHDR]: 3,\n      [HSB]: 3,\n      [HSL]: 3,\n      [HWB]: 3,\n      [LAB]: 3,\n      [LCH]: 3,\n      [OKLAB]: 3,\n      [OKLCH]: 3\n    });\n\n    decorateGet('Hue', {\n      [HSL]: 0,\n      [HSB]: 0,\n      [HWB]: 0,\n      [LCH]: 2,\n      [OKLCH]: 2\n    });\n    decorateGet('Saturation', {\n      [HSL]: 1,\n      [HSB]: 1\n    });\n    decorateGet('Brightness', {\n      [HSB]: 2\n    });\n    decorateGet('Lightness', {\n      [HSL]: 2\n    });\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  color(p5, p5.prototype);\n}\n\n/**\n * @module Color\n * @submodule Creating & Reading\n * @for p5\n * @requires core\n * @requires constants\n */\n\n\n/**\n * @typedef {'rgb'} RGB\n * @property {RGB} RGB\n * @final\n */\nconst RGB = 'rgb';\n/**\n * @typedef {'rgbhdr'} RGBHDR\n * @property {RGBHDR} RGBHDR\n * @final\n */\nconst RGBHDR = 'rgbhdr';\n/**\n * HSB (hue, saturation, brightness) is a type of color model.\n * You can learn more about it at\n * <a href=\"https://learnui.design/blog/the-hsb-color-system-practicioners-primer.html\">HSB</a>.\n *\n * @typedef {'hsb'} HSB\n * @property {HSB} HSB\n * @final\n */\nconst HSB = 'hsb';\n/**\n * @typedef {'hsl'} HSL\n * @property {HSL} HSL\n * @final\n */\nconst HSL = 'hsl';\n/**\n * @typedef {'hwb'} HWB\n * @property {HWB} HWB\n * @final\n */\nconst HWB = 'hwb';\n/**\n * @typedef {'lab'} LAB\n * @property {LAB} LAB\n * @final\n */\nconst LAB = 'lab';\n/**\n * @typedef {'lch'} LCH\n * @property {LCH} LCH\n * @final\n */\nconst LCH = 'lch';\n/**\n * @typedef {'oklab'} OKLAB\n * @property {OKLAB} OKLAB\n * @final\n */\nconst OKLAB = 'oklab';\n/**\n * @typedef {'oklch'} OKLCH\n * @property {OKLCH} OKLCH\n * @final\n */\nconst OKLCH = 'oklch';\n/**\n * @typedef {'rgba'} RGBA\n * @property {RGBA} RGBA\n * @final\n */\nconst RGBA = 'rgba';\n\nfunction creatingReading(p5, fn){\n  fn.RGB = RGB;\n  fn.RGBHDR = RGBHDR;\n  fn.HSB = HSB;\n  fn.HSL = HSL;\n  fn.HWB = HWB;\n\n  fn.LAB = LAB;\n  fn.LCH = LCH;\n\n  fn.OKLAB = OKLAB;\n  fn.OKLCH = OKLCH;\n\n  fn.RGBA = RGBA;\n\n  // Add color states to renderer state machine\n  p5.Renderer.states.colorMode = RGB;\n  p5.Renderer.states.colorMaxes = {\n    [RGB]: [255, 255, 255, 255],\n    [RGBHDR]: [255, 255, 255, 255],\n    [HSB]: [360, 100, 100, 1],\n    [HSL]: [360, 100, 100, 1],\n    [HWB]: [360, 100, 100, 1],\n\n    [LAB]: [100, [-125, 125], [-125, 125], 1],\n    [LCH]: [100, 150, 360, 1],\n\n    [OKLAB]: [100, [-125, 125], [-125, 125], 1],\n    [OKLCH]: [100, 150, 360, 1],\n    clone: function(){\n      const cloned = { ...this };\n      for (const key in cloned) {\n        if (cloned[key] instanceof Array) {\n          cloned[key] = [...cloned[key]];\n        }\n      }\n      return cloned;\n    }\n  };\n\n  /**\n   * Creates a <a href=\"#/p5/p5.Color\">p5.Color</a> object.\n   *\n   * By default, the parameters are interpreted as RGB values. Calling\n   * `color(255, 204, 0)` will return a bright yellow color. The way these\n   * parameters are interpreted may be changed with the\n   * <a href=\"#/p5/colorMode\">colorMode()</a> function.\n   *\n   * The version of `color()` with one parameter interprets the value one of two\n   * ways. If the parameter is a number, it's interpreted as a grayscale value.\n   * If the parameter is a string, it's interpreted as a CSS color string.\n   *\n   * The version of `color()` with two parameters interprets the first one as a\n   * grayscale value. The second parameter sets the alpha (transparency) value.\n   *\n   * The version of `color()` with three parameters interprets them as RGB, HSB,\n   * or HSL colors, depending on the current `colorMode()`.\n   *\n   * The version of `color()` with four parameters interprets them as RGBA, HSBA,\n   * or HSLA colors, depending on the current `colorMode()`. The last parameter\n   * sets the alpha (transparency) value.\n   *\n   * @method color\n   * @param  {Number} gray number specifying value between white and black.\n   * @param  {Number} [alpha] alpha value relative to current color range\n   *                                 (default is 0-255).\n   * @return {p5.Color} resulting color.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object using RGB values.\n   *   let c = color(255, 204, 0);\n   *\n   *   // Draw the square.\n   *   fill(c);\n   *   noStroke();\n   *   square(30, 20, 55);\n   *\n   *   describe('A yellow square on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object using RGB values.\n   *   let c1 = color(255, 204, 0);\n   *\n   *   // Draw the left circle.\n   *   fill(c1);\n   *   noStroke();\n   *   circle(25, 25, 80);\n   *\n   *   // Create a p5.Color object using a grayscale value.\n   *   let c2 = color(65);\n   *\n   *   // Draw the right circle.\n   *   fill(c2);\n   *   circle(75, 75, 80);\n   *\n   *   describe(\n   *     'Two circles on a gray canvas. The circle in the top-left corner is yellow and the one at the bottom-right is gray.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object using a named color.\n   *   let c = color('magenta');\n   *\n   *   // Draw the square.\n   *   fill(c);\n   *   noStroke();\n   *   square(20, 20, 60);\n   *\n   *   describe('A magenta square on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object using a hex color code.\n   *   let c1 = color('#0f0');\n   *\n   *   // Draw the left rectangle.\n   *   fill(c1);\n   *   noStroke();\n   *   rect(0, 10, 45, 80);\n   *\n   *   // Create a p5.Color object using a hex color code.\n   *   let c2 = color('#00ff00');\n   *\n   *   // Draw the right rectangle.\n   *   fill(c2);\n   *   rect(55, 10, 45, 80);\n   *\n   *   describe('Two bright green rectangles on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object using a RGB color string.\n   *   let c1 = color('rgb(0, 0, 255)');\n   *\n   *   // Draw the top-left square.\n   *   fill(c1);\n   *   square(10, 10, 35);\n   *\n   *   // Create a p5.Color object using a RGB color string.\n   *   let c2 = color('rgb(0%, 0%, 100%)');\n   *\n   *   // Draw the top-right square.\n   *   fill(c2);\n   *   square(55, 10, 35);\n   *\n   *   // Create a p5.Color object using a RGBA color string.\n   *   let c3 = color('rgba(0, 0, 255, 1)');\n   *\n   *   // Draw the bottom-left square.\n   *   fill(c3);\n   *   square(10, 55, 35);\n   *\n   *   // Create a p5.Color object using a RGBA color string.\n   *   let c4 = color('rgba(0%, 0%, 100%, 1)');\n   *\n   *   // Draw the bottom-right square.\n   *   fill(c4);\n   *   square(55, 55, 35);\n   *\n   *   describe('Four blue squares in the corners of a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object using a HSL color string.\n   *   let c1 = color('hsl(160, 100%, 50%)');\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c1);\n   *   rect(0, 10, 45, 80);\n   *\n   *   // Create a p5.Color object using a HSLA color string.\n   *   let c2 = color('hsla(160, 100%, 50%, 0.5)');\n   *\n   *   // Draw the right rectangle.\n   *   fill(c2);\n   *   rect(55, 10, 45, 80);\n   *\n   *   describe('Two sea green rectangles. A darker rectangle on the left and a brighter one on the right.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object using a HSB color string.\n   *   let c1 = color('hsb(160, 100%, 50%)');\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c1);\n   *   rect(0, 10, 45, 80);\n   *\n   *   // Create a p5.Color object using a HSBA color string.\n   *   let c2 = color('hsba(160, 100%, 50%, 0.5)');\n   *\n   *   // Draw the right rectangle.\n   *   fill(c2);\n   *   rect(55, 10, 45, 80);\n   *\n   *   describe('Two green rectangles. A darker rectangle on the left and a brighter one on the right.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object using RGB values.\n   *   let c1 = color(50, 55, 100);\n   *\n   *   // Draw the left rectangle.\n   *   fill(c1);\n   *   rect(0, 10, 45, 80);\n   *\n   *   // Switch the color mode to HSB.\n   *   colorMode(HSB, 100);\n   *\n   *   // Create a p5.Color object using HSB values.\n   *   let c2 = color(50, 55, 100);\n   *\n   *   // Draw the right rectangle.\n   *   fill(c2);\n   *   rect(55, 10, 45, 80);\n   *\n   *   describe('Two blue rectangles. A darker rectangle on the left and a brighter one on the right.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method color\n   * @param  {Number}        v1      red or hue value relative to\n   *                                 the current color range.\n   * @param  {Number}        v2      green or saturation value\n   *                                 relative to the current color range.\n   * @param  {Number}        v3      blue or brightness value\n   *                                 relative to the current color range.\n   * @param  {Number}        [alpha]\n   * @return {p5.Color}\n   */\n\n  /**\n   * @method color\n   * @param  {String}        value   a color string.\n   * @return {p5.Color}\n   */\n\n  /**\n   * @method color\n   * @param  {Number[]}      values  an array containing the red, green, blue,\n   *                                 and alpha components of the color.\n   * @return {p5.Color}\n   */\n\n  /**\n   * @method color\n   * @param  {p5.Color}     color\n   * @return {p5.Color}\n   */\n  fn.color = function(...args) {\n    // p5._validateParameters('color', args);\n    if (args[0] instanceof Color) {\n      // TODO: perhaps change color mode to match instance mode?\n      return args[0]; // Do nothing if argument is already a color object.\n    }\n\n    const arg = Array.isArray(args[0]) ? args[0] : args;\n    return new Color(\n      arg,\n      this._renderer.states.colorMode,\n      this._renderer.states.colorMaxes[this._renderer.states.colorMode],\n      { clamp: true }\n    );\n  };\n\n  /**\n   * Gets the red value of a color.\n   *\n   * `red()` extracts the red value from a\n   * <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, an array of color components, or\n   * a CSS color string.\n   *\n   * By default, `red()` returns a color's red value in the range 0\n   * to 255. If the <a href=\"/reference/p5/colorMode/\">colorMode()</a> is set to RGB, it\n   * returns the red value in the given range.\n   *\n   * @method red\n   * @param {p5.Color|Number[]|String} color <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, array of\n   *                                         color components, or CSS color string.\n   * @return {Number} the red value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(175, 100, 220);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'redValue' to 175.\n   *   let redValue = red(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(redValue, 0, 0);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is red.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a color array.\n   *   let c = [175, 100, 220];\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'redValue' to 175.\n   *   let redValue = red(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(redValue, 0, 0);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is red.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a CSS color string.\n   *   let c = 'rgb(175, 100, 220)';\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'redValue' to 175.\n   *   let redValue = red(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(redValue, 0, 0);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is red.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use RGB color with values in the range 0-100.\n   *   colorMode(RGB, 100);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(69, 39, 86);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'redValue' to 69.\n   *   let redValue = red(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(redValue, 0, 0);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is red.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.red = function(c) {\n    // p5._validateParameters('red', arguments);\n    // Get current red max\n    return this.color(c)._getRed();\n  };\n\n  /**\n   * Gets the green value of a color.\n   *\n   * `green()` extracts the green value from a\n   * <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, an array of color components, or\n   * a CSS color string.\n   *\n   * By default, `green()` returns a color's green value in the range 0\n   * to 255. If the <a href=\"/reference/p5/colorMode/\">colorMode()</a> is set to RGB, it\n   * returns the green value in the given range.\n   *\n   * @method green\n   * @param {p5.Color|Number[]|String} color <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, array of\n   *                                         color components, or CSS color string.\n   * @return {Number} the green value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(175, 100, 220);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'greenValue' to 100.\n   *   let greenValue = green(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(0, greenValue, 0);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is dark green.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a color array.\n   *   let c = [175, 100, 220];\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'greenValue' to 100.\n   *   let greenValue = green(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(0, greenValue, 0);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is dark green.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a CSS color string.\n   *   let c = 'rgb(175, 100, 220)';\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'greenValue' to 100.\n   *   let greenValue = green(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(0, greenValue, 0);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is dark green.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use RGB color with values in the range 0-100.\n   *   colorMode(RGB, 100);\n   *\n   *   // Create a p5.Color object using RGB values.\n   *   let c = color(69, 39, 86);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'greenValue' to 39.\n   *   let greenValue = green(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(0, greenValue, 0);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is dark green.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.green = function(c) {\n    // p5._validateParameters('green', arguments);\n    // Get current green max\n    return this.color(c)._getGreen();\n  };\n\n  /**\n   * Gets the blue value of a color.\n   *\n   * `blue()` extracts the blue value from a\n   * <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, an array of color components, or\n   * a CSS color string.\n   *\n   * By default, `blue()` returns a color's blue value in the range 0\n   * to 255. If the <a href=\"/reference/p5/colorMode/\">colorMode()</a> is set to RGB, it\n   * returns the blue value in the given range.\n   *\n   * @method blue\n   * @param {p5.Color|Number[]|String} color <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, array of\n   *                                         color components, or CSS color string.\n   * @return {Number} the blue value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object using RGB values.\n   *   let c = color(175, 100, 220);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'blueValue' to 220.\n   *   let blueValue = blue(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(0, 0, blueValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is royal blue.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a color array.\n   *   let c = [175, 100, 220];\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'blueValue' to 220.\n   *   let blueValue = blue(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(0, 0, blueValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is royal blue.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a CSS color string.\n   *   let c = 'rgb(175, 100, 220)';\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'blueValue' to 220.\n   *   let blueValue = blue(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(0, 0, blueValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is royal blue.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use RGB color with values in the range 0-100.\n   *   colorMode(RGB, 100);\n   *\n   *   // Create a p5.Color object using RGB values.\n   *   let c = color(69, 39, 86);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'blueValue' to 86.\n   *   let blueValue = blue(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(0, 0, blueValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light purple and the right one is royal blue.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.blue = function(c) {\n    // p5._validateParameters('blue', arguments);\n    // Get current blue max\n    return this.color(c)._getBlue();\n  };\n\n  /**\n   * Gets the alpha (transparency) value of a color.\n   *\n   * `alpha()` extracts the alpha value from a\n   * <a href=\"#/p5.Color\">p5.Color</a> object, an array of color components, or\n   * a CSS color string.\n   *\n   * @method alpha\n   * @param {p5.Color|Number[]|String} color <a href=\"#/p5.Color\">p5.Color</a> object, array of\n   *                                         color components, or CSS color string.\n   * @return {Number} the alpha value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(0, 126, 255, 102);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'alphaValue' to 102.\n   *   let alphaValue = alpha(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(alphaValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light blue and the right one is charcoal gray.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a color array.\n   *   let c = [0, 126, 255, 102];\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'alphaValue' to 102.\n   *   let alphaValue = alpha(c);\n   *\n   *   // Draw the left rectangle.\n   *   fill(alphaValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light blue and the right one is charcoal gray.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a CSS color string.\n   *   let c = 'rgba(0, 126, 255, 0.4)';\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'alphaValue' to 102.\n   *   let alphaValue = alpha(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(alphaValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is light blue and the right one is charcoal gray.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.alpha = function(c) {\n    // p5._validateParameters('alpha', arguments);\n    // Get current alpha max\n    return this.color(c)._getAlpha();\n  };\n\n  /**\n   * Gets the hue value of a color.\n   *\n   * `hue()` extracts the hue value from a\n   * <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, an array of color components, or\n   * a CSS color string.\n   *\n   * Hue describes a color's position on the color wheel. By default, `hue()`\n   * returns a color's HSL hue in the range 0 to 360. If the\n   * <a href=\"/reference/p5/colorMode/\">colorMode()</a> is set to HSB or HSL, it returns the hue\n   * value in the given mode.\n   *\n   * @method hue\n   * @param {p5.Color|Number[]|String} color <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, array of\n   *                                         color components, or CSS color string.\n   * @return {Number} the hue value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use HSL color.\n   *   colorMode(HSL);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(0, 50, 100);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 20, 35, 60);\n   *\n   *   // Set 'hueValue' to 0.\n   *   let hueValue = hue(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(hueValue);\n   *   rect(50, 20, 35, 60);\n   *\n   *   describe(\n   *     'Two rectangles. The rectangle on the left is salmon pink and the one on the right is black.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use HSL color.\n   *   colorMode(HSL);\n   *\n   *   // Create a color array.\n   *   let c = [0, 50, 100];\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 20, 35, 60);\n   *\n   *   // Set 'hueValue' to 0.\n   *   let hueValue = hue(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(hueValue);\n   *   rect(50, 20, 35, 60);\n   *\n   *   describe(\n   *     'Two rectangles. The rectangle on the left is salmon pink and the one on the right is black.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use HSL color.\n   *   colorMode(HSL);\n   *\n   *   // Create a CSS color string.\n   *   let c = 'rgb(255, 128, 128)';\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 20, 35, 60);\n   *\n   *   // Set 'hueValue' to 0.\n   *   let hueValue = hue(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(hueValue);\n   *   rect(50, 20, 35, 60);\n   *\n   *   describe(\n   *     'Two rectangles. The rectangle on the left is salmon pink and the one on the right is black.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  fn.hue = function(c) {\n    // p5._validateParameters('hue', arguments);\n    return this.color(c)._getHue();\n  };\n\n  /**\n   * Gets the saturation value of a color.\n   *\n   * `saturation()` extracts the saturation value from a\n   * <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, an array of color components, or\n   * a CSS color string.\n   *\n   * Saturation is scaled differently in HSB and HSL. By default, `saturation()`\n   * returns a color's HSL saturation in the range 0 to 100. If the\n   * <a href=\"/reference/p5/colorMode/\">colorMode()</a> is set to HSB or HSL, it returns the\n   * saturation value in the given mode.\n   *\n   * @method saturation\n   * @param {p5.Color|Number[]|String} color <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, array of\n   *                                         color components, or CSS color string.\n   * @return {Number} the saturation value\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Use HSB color.\n   *   colorMode(HSB);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(0, 50, 100);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'satValue' to 50.\n   *   let satValue = saturation(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(satValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is dark gray.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Use HSB color.\n   *   colorMode(HSB);\n   *\n   *   // Create a color array.\n   *   let c = [0, 50, 100];\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'satValue' to 100.\n   *   let satValue = saturation(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(satValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is gray.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Use HSB color.\n   *   colorMode(HSB);\n   *\n   *   // Create a CSS color string.\n   *   let c = 'rgb(255, 128, 128)';\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'satValue' to 100.\n   *   let satValue = saturation(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(satValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is gray.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Use HSL color.\n   *   colorMode(HSL);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(0, 100, 75);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'satValue' to 100.\n   *   let satValue = saturation(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(satValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is white.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Use HSL color with values in the range 0-255.\n   *   colorMode(HSL, 255);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(0, 255, 191.5);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'satValue' to 255.\n   *   let satValue = saturation(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(satValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is white.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.saturation = function(c) {\n    // p5._validateParameters('saturation', arguments);\n    return this.color(c)._getSaturation();\n  };\n\n  /**\n   * Gets the brightness value of a color.\n   *\n   * `brightness()` extracts the HSB brightness value from a\n   * <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, an array of color components, or\n   * a CSS color string.\n   *\n   * By default, `brightness()` returns a color's HSB brightness in the range 0\n   * to 100. If the <a href=\"/reference/p5/colorMode/\">colorMode()</a> is set to HSB, it\n   * returns the brightness value in the given range.\n   *\n   * @method brightness\n   * @param {p5.Color|Number[]|String} color <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, array of\n   *                                         color components, or CSS color string.\n   * @return {Number} the brightness value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use HSB color.\n   *   colorMode(HSB);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(0, 50, 100);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'brightValue' to 100.\n   *   let brightValue = brightness(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(brightValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is white.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use HSB color.\n   *   colorMode(HSB);\n   *\n   *   // Create a color array.\n   *   let c = [0, 50, 100];\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'brightValue' to 100.\n   *   let brightValue = brightness(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(brightValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is white.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use HSB color.\n   *   colorMode(HSB);\n   *\n   *   // Create a CSS color string.\n   *   let c = 'rgb(255, 128, 128)';\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'brightValue' to 100.\n   *   let brightValue = brightness(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(brightValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is white.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use HSB color with values in the range 0-255.\n   *   colorMode(HSB, 255);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color(0, 127, 255);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'brightValue' to 255.\n   *   let brightValue = brightness(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(brightValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is white.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.brightness = function(c) {\n    // p5._validateParameters('brightness', arguments);\n    return this.color(c)._getBrightness();\n  };\n\n  /**\n   * Gets the lightness value of a color.\n   *\n   * `lightness()` extracts the HSL lightness value from a\n   * <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, an array of color components, or\n   * a CSS color string.\n   *\n   * By default, `lightness()` returns a color's HSL lightness in the range 0\n   * to 100. If the <a href=\"/reference/p5/colorMode/\">colorMode()</a> is set to HSL, it\n   * returns the lightness value in the given range.\n   *\n   * @method lightness\n   * @param {p5.Color|Number[]|String} color <a href=\"/reference/p5/p5.Color/\">p5.Color</a> object, array of\n   *                                         color components, or CSS color string.\n   * @return {Number} the lightness value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Use HSL color.\n   *   colorMode(HSL);\n   *\n   *   // Create a p5.Color object using HSL values.\n   *   let c = color(0, 100, 75);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'lightValue' to 75.\n   *   let lightValue = lightness(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(lightValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is gray.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Use HSL color.\n   *   colorMode(HSL);\n   *\n   *   // Create a color array.\n   *   let c = [0, 100, 75];\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'lightValue' to 75.\n   *   let lightValue = lightness(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(lightValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is gray.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Use HSL color.\n   *   colorMode(HSL);\n   *\n   *   // Create a CSS color string.\n   *   let c = 'rgb(255, 128, 128)';\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'lightValue' to 75.\n   *   let lightValue = lightness(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(lightValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is gray.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Use HSL color with values in the range 0-255.\n   *   colorMode(HSL, 255);\n   *\n   *   // Create a p5.Color object using HSL values.\n   *   let c = color(0, 255, 191.5);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(c);\n   *   rect(15, 15, 35, 70);\n   *\n   *   // Set 'lightValue' to 191.5.\n   *   let lightValue = lightness(c);\n   *\n   *   // Draw the right rectangle.\n   *   fill(lightValue);\n   *   rect(50, 15, 35, 70);\n   *\n   *   describe('Two rectangles. The left one is salmon pink and the right one is gray.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.lightness = function(c) {\n    // p5._validateParameters('lightness', arguments);\n    return this.color(c)._getLightness();\n  };\n\n  /**\n   * Blends two colors to find a third color between them.\n   *\n   * The `amt` parameter specifies the amount to interpolate between the two\n   * values. 0 is equal to the first color, 0.1 is very near the first color,\n   * 0.5 is halfway between the two colors, and so on. Negative numbers are set\n   * to 0. Numbers greater than 1 are set to 1. This differs from the behavior of\n   * <a href=\"#/lerp\">lerp</a>. It's necessary because numbers outside of the\n   * interval [0, 1] will produce strange and unexpected colors.\n   *\n   * The way that colors are interpolated depends on the current\n   * <a href=\"#/colorMode\">colorMode()</a>.\n   *\n   * @method lerpColor\n   * @param  {p5.Color} c1  interpolate from this color.\n   * @param  {p5.Color} c2  interpolate to this color.\n   * @param  {Number}   amt number between 0 and 1.\n   * @return {p5.Color}     interpolated color.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create p5.Color objects to interpolate between.\n   *   let from = color(218, 165, 32);\n   *   let to = color(72, 61, 139);\n   *\n   *   // Create intermediate colors.\n   *   let interA = lerpColor(from, to, 0.33);\n   *   let interB = lerpColor(from, to, 0.66);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(from);\n   *   rect(10, 20, 20, 60);\n   *\n   *   // Draw the left-center rectangle.\n   *   fill(interA);\n   *   rect(30, 20, 20, 60);\n   *\n   *   // Draw the right-center rectangle.\n   *   fill(interB);\n   *   rect(50, 20, 20, 60);\n   *\n   *   // Draw the right rectangle.\n   *   fill(to);\n   *   rect(70, 20, 20, 60);\n   *\n   *   describe(\n   *     'Four rectangles. From left to right, the rectangles are tan, brown, brownish purple, and purple.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  fn.lerpColor = function(c1, c2, amt) {\n    // p5._validateParameters('lerpColor', arguments);\n    return c1.lerp(c2, amt, this._renderer.states.colorMode);\n  };\n\n  /**\n   * Blends multiple colors to find a color between them.\n   *\n   * The `amt` parameter specifies the amount to interpolate between the color\n   * stops which are colors at each `amt` value \"location\" with `amt` values\n   * that are between 2 color stops interpolating between them based on its relative\n   * distance to both.\n   *\n   * The way that colors are interpolated depends on the current\n   * <a href=\"/reference/p5/colorMode/\">colorMode()</a>.\n   *\n   * @method paletteLerp\n   * @param {Array<[(p5.Color|String|Number|Number[]), Number]>} colors_stops color stops to interpolate from\n   * @param {Number} amt number to use to interpolate relative to color stops\n   * @return {p5.Color} interpolated color.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(400, 400);\n   * }\n   *\n   * function draw() {\n   *   // The background goes from white to red to green to blue fill\n   *   background(paletteLerp([\n   *     ['white', 0],\n   *     ['red', 0.05],\n   *     ['green', 0.25],\n   *     ['blue', 1]\n   *   ], millis() / 10000 % 1));\n   * }\n   * </code>\n   * </div>\n   */\n  fn.paletteLerp = function(color_stops, amt) {\n    const first_color_stop = color_stops[0];\n    if (amt < first_color_stop[1])\n      return this.color(first_color_stop[0]);\n\n    for (let i = 1; i < color_stops.length; i++) {\n      const color_stop = color_stops[i];\n      if (amt < color_stop[1]) {\n        const prev_color_stop = color_stops[i - 1];\n        return this.lerpColor(\n          this.color(prev_color_stop[0]),\n          this.color(color_stop[0]),\n          (amt - prev_color_stop[1]) / (color_stop[1] - prev_color_stop[1])\n        );\n      }\n    }\n\n    return this.color(color_stops[color_stops.length - 1][0]);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  creatingReading(p5, p5.prototype);\n}\n\nexport { Color as C, HSB as H, LAB as L, OKLAB as O, RGB as R, color as a, RGBHDR as b, creatingReading as c, HSL as d, HWB as e, LCH as f, OKLCH as g, RGBA as h };\n","/**\n * @module IO\n * @submodule Input\n * @requires core\n */\n\nclass XML {\n  constructor(DOM){\n    if (!DOM) {\n      const xmlDoc = document.implementation.createDocument(null, 'doc');\n      this.DOM = xmlDoc.createElement('root');\n    } else {\n      this.DOM = DOM;\n    }\n  }\n\n  /**\n   * Returns the element's parent element as a new <a href=\"#/p5.XML\">p5.XML</a>\n   * object.\n   *\n   * @return {p5.XML} parent element.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get an array with all mammal elements.\n   *   let mammals = myXML.getChildren('mammal');\n   *\n   *   // Get the first mammal element.\n   *   let firstMammal = mammals[0];\n   *\n   *   // Get the parent element.\n   *   let parent = firstMammal.getParent();\n   *\n   *   // Get the parent element's name.\n   *   let name = parent.getName();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the parent element's name.\n   *   text(name, 50, 50);\n   *\n   *   describe('The word \"animals\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  getParent() {\n    return new XML(this.DOM.parentElement);\n  }\n\n  /**\n   * Returns the element's name as a `String`.\n   *\n   * An XML element's name is given by its tag. For example, the element\n   * `&lt;language&gt;JavaScript&lt;/language&gt;` has the name `language`.\n   *\n   * @return {String} name of the element.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get an array with all mammal elements.\n   *   let mammals = myXML.getChildren('mammal');\n   *\n   *   // Get the first mammal element.\n   *   let firstMammal = mammals[0];\n   *\n   *   // Get the mammal element's name.\n   *   let name = firstMammal.getName();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the element's name.\n   *   text(name, 50, 50);\n   *\n   *   describe('The word \"mammal\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  getName() {\n    return this.DOM.tagName;\n  }\n\n  /**\n   * Sets the element's tag name.\n   *\n   * An XML element's name is given by its tag. For example, the element\n   * `&lt;language&gt;JavaScript&lt;/language&gt;` has the name `language`.\n   *\n   * The parameter, `name`, is the element's new name as a string. For example,\n   * calling `myXML.setName('planet')` will make the element's new tag name\n   * `&lt;planet&gt;&lt;/planet&gt;`.\n   *\n   * @param {String} name new tag name of the element.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the element's original name.\n   *   let oldName = myXML.getName();\n   *\n   *   // Set the element's name.\n   *   myXML.setName('monsters');\n   *\n   *   // Get the element's new name.\n   *   let newName = myXML.getName();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the element's names.\n   *   text(oldName, 50, 33);\n   *   text(newName, 50, 67);\n   *\n   *   describe(\n   *     'The words \"animals\" and \"monsters\" written on separate lines. The text is black on a gray background.'\n   *   );\n   * }\n   * </code></div>\n   */\n  setName(name) {\n    const content = this.DOM.innerHTML;\n    const attributes = this.DOM.attributes;\n    const xmlDoc = document.implementation.createDocument(null, 'default');\n    const newDOM = xmlDoc.createElement(name);\n    newDOM.innerHTML = content;\n    for (let i = 0; i < attributes.length; i++) {\n      newDOM.setAttribute(attributes[i].nodeName, attributes[i].nodeValue);\n    }\n    this.DOM = newDOM;\n  }\n\n  /**\n   * Returns `true` if the element has child elements and `false` if not.\n   *\n   * @return {boolean} whether the element has children.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Check whether the element has child elements.\n   *   let isParent = myXML.hasChildren();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Style the text.\n   *   if (isParent === true) {\n   *     text('Parent', 50, 50);\n   *   } else {\n   *     text('Not Parent', 50, 50);\n   *   }\n   *\n   *   describe('The word \"Parent\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  hasChildren() {\n    return this.DOM.children.length > 0;\n  }\n\n  /**\n   * Returns an array with the names of the element's child elements as\n   * `String`s.\n   *\n   * @return {String[]} names of the child elements.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the names of the element's children as an array.\n   *   let children = myXML.listChildren();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Iterate over the array.\n   *   for (let i = 0; i < children.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 25;\n   *\n   *     // Display the child element's name.\n   *     text(children[i], 10, y);\n   *   }\n   *\n   *   describe(\n   *     'The words \"mammal\", \"mammal\", \"mammal\", and \"reptile\" written on separate lines. The text is black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  listChildren() {\n    const arr = [];\n    for (let i = 0; i < this.DOM.childNodes.length; i++) {\n      arr.push(this.DOM.childNodes[i].nodeName);\n    }\n    return arr;\n  }\n\n  /**\n   * Returns an array with the element's child elements as new\n   * <a href=\"#/p5.XML\">p5.XML</a> objects.\n   *\n   * The parameter, `name`, is optional. If a string is passed, as in\n   * `myXML.getChildren('cat')`, then the method will only return child elements\n   * with the tag `&lt;cat&gt;`.\n   *\n   * @param {String} [name] name of the elements to return.\n   * @return {p5.XML[]} child elements.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get an array of the child elements.\n   *   let children = myXML.getChildren();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Iterate over the array.\n   *   for (let i = 0; i < children.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 20;\n   *\n   *     // Get the child element's content.\n   *     let content = children[i].getContent();\n   *\n   *     // Display the child element's content.\n   *     text(content, 10, y);\n   *   }\n   *\n   *   describe(\n   *     'The words \"Goat\", \"Leopard\", \"Zebra\", and \"Turtle\" written on separate lines. The text is black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get an array of the child elements\n   *   // that are mammals.\n   *   let children = myXML.getChildren('mammal');\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Iterate over the array.\n   *   for (let i = 0; i < children.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 20;\n   *\n   *     // Get the child element's content.\n   *     let content = children[i].getContent();\n   *\n   *     // Display the child element's content.\n   *     text(content, 10, y);\n   *   }\n   *\n   *   describe(\n   *     'The words \"Goat\", \"Leopard\", and \"Zebra\" written on separate lines. The text is black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  getChildren(param) {\n    if (param) {\n      return elementsToP5XML(this.DOM.getElementsByTagName(param));\n    } else {\n      return elementsToP5XML(this.DOM.children);\n    }\n  }\n\n  /**\n   * Returns the first matching child element as a new\n   * <a href=\"#/p5.XML\">p5.XML</a> object.\n   *\n   * The parameter, `name`, is optional. If a string is passed, as in\n   * `myXML.getChild('cat')`, then the first child element with the tag\n   * `&lt;cat&gt;` will be returned. If a number is passed, as in\n   * `myXML.getChild(1)`, then the child element at that index will be returned.\n   *\n   * @param {String|Integer} name element name or index.\n   * @return {p5.XML} child element.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the first child element that is a mammal.\n   *   let goat = myXML.getChild('mammal');\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Get the child element's content.\n   *   let content = goat.getContent();\n   *\n   *   // Display the child element's content.\n   *   text(content, 50, 50);\n   *\n   *   describe('The word \"Goat\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the child element at index 1.\n   *   let leopard = myXML.getChild(1);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Get the child element's content.\n   *   let content = leopard.getContent();\n   *\n   *   // Display the child element's content.\n   *   text(content, 50, 50);\n   *\n   *   describe('The word \"Leopard\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  getChild(param) {\n    if (typeof param === 'string') {\n      for (const child of this.DOM.children) {\n        if (child.tagName === param) return new XML(child);\n      }\n    } else {\n      return new XML(this.DOM.children[param]);\n    }\n  }\n\n  /**\n   * Adds a new child element and returns a reference to it.\n   *\n   * The parameter, `child`, is the <a href=\"#/p5.XML\">p5.XML</a> object to add\n   * as a child element. For example, calling `myXML.addChild(otherXML)` inserts\n   * `otherXML` as a child element of `myXML`.\n   *\n   * @param {p5.XML} child child element to add.\n   * @return {p5.XML} added child element.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a new p5.XML object.\n   *   let newAnimal = new p5.XML();\n   *\n   *   // Set its properties.\n   *   newAnimal.setName('hydrozoa');\n   *   newAnimal.setAttribute('id', 4);\n   *   newAnimal.setAttribute('species', 'Physalia physalis');\n   *   newAnimal.setContent('Bluebottle');\n   *\n   *   // Add the child element.\n   *   myXML.addChild(newAnimal);\n   *\n   *   // Get the first child element that is a hydrozoa.\n   *   let blueBottle = myXML.getChild('hydrozoa');\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Get the child element's content.\n   *   let content = blueBottle.getContent();\n   *\n   *   // Display the child element's content.\n   *   text(content, 50, 50);\n   *\n   *   describe('The word \"Bluebottle\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  addChild(node) {\n    if (node instanceof XML) {\n      this.DOM.appendChild(node.DOM);\n    }\n  }\n\n  /**\n   * Removes the first matching child element.\n   *\n   * The parameter, `name`, is the child element to remove. If a string is\n   * passed, as in `myXML.removeChild('cat')`, then the first child element\n   * with the tag `&lt;cat&gt;` will be removed. If a number is passed, as in\n   * `myXML.removeChild(1)`, then the child element at that index will be\n   * removed.\n   *\n   * @param {String|Integer} name name or index of the child element to remove.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Remove the first mammal element.\n   *   myXML.removeChild('mammal');\n   *\n   *   // Get an array of child elements.\n   *   let children = myXML.getChildren();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Iterate over the array.\n   *   for (let i = 0; i < children.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 25;\n   *\n   *     // Get the child element's content.\n   *     let content = children[i].getContent();\n   *\n   *     // Display the child element's content.\n   *     text(content, 10, y);\n   *   }\n   *\n   *   describe(\n   *     'The words \"Leopard\", \"Zebra\", and \"Turtle\" written on separate lines. The text is black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Remove the element at index 2.\n   *   myXML.removeChild(2);\n   *\n   *   // Get an array of child elements.\n   *   let children = myXML.getChildren();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Iterate over the array.\n   *   for (let i = 0; i < children.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 25;\n   *\n   *     // Get the child element's content.\n   *     let content = children[i].getContent();\n   *\n   *     // Display the child element's content.\n   *     text(content, 10, y);\n   *   }\n   *\n   *   describe(\n   *     'The words \"Goat\", \"Leopard\", and \"Turtle\" written on separate lines. The text is black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  removeChild(param) {\n    let ind = -1;\n    if (typeof param === 'string') {\n      for (let i = 0; i < this.DOM.children.length; i++) {\n        if (this.DOM.children[i].tagName === param) {\n          ind = i;\n          break;\n        }\n      }\n    } else {\n      ind = param;\n    }\n    if (ind !== -1) {\n      this.DOM.removeChild(this.DOM.children[ind]);\n    }\n  }\n\n  /**\n   * Returns the number of attributes the element has.\n   *\n   * @return {Integer} number of attributes.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the first child element.\n   *   let first = myXML.getChild(0);\n   *\n   *   // Get the number of attributes.\n   *   let numAttributes = first.getAttributeCount();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the number of attributes.\n   *   text(numAttributes, 50, 50);\n   *\n   *   describe('The number \"2\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  getAttributeCount() {\n    return this.DOM.attributes.length;\n  }\n\n  /**\n   * Returns an `Array` with the names of the element's attributes.\n   *\n   * Note: Use\n   * <a href=\"#/p5.XML/getString\">myXML.getString()</a> or\n   * <a href=\"#/p5.XML/getNum\">myXML.getNum()</a> to return an attribute's value.\n   *\n   * @return {String[]} attribute names.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the first child element.\n   *   let first = myXML.getChild(0);\n   *\n   *   // Get the number of attributes.\n   *   let attributes = first.listAttributes();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the element's attributes.\n   *   text(attributes, 50, 50);\n   *\n   *   describe('The text \"id,species\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  listAttributes() {\n    const arr = [];\n\n    for (const attribute of this.DOM.attributes) {\n      arr.push(attribute.nodeName);\n    }\n\n    return arr;\n  }\n\n  /**\n   * Returns `true` if the element has a given attribute and `false` if not.\n   *\n   * The parameter, `name`, is a string with the name of the attribute being\n   * checked.\n   *\n   * Note: Use\n   * <a href=\"#/p5.XML/getString\">myXML.getString()</a> or\n   * <a href=\"#/p5.XML/getNum\">myXML.getNum()</a> to return an attribute's value.\n   *\n   * @param {String} name name of the attribute to be checked.\n   * @return {boolean} whether the element has the attribute.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the first mammal child element.\n   *   let mammal = myXML.getChild('mammal');\n   *\n   *   // Check whether the element has an\n   *   // species attribute.\n   *   let hasSpecies = mammal.hasAttribute('species');\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display whether the element has a species attribute.\n   *   if (hasSpecies === true) {\n   *     text('Species', 50, 50);\n   *   } else {\n   *     text('No species', 50, 50);\n   *   }\n   *\n   *   describe('The text \"Species\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  hasAttribute(name) {\n    const obj = {};\n\n    for (const attribute of this.DOM.attributes) {\n      obj[attribute.nodeName] = attribute.nodeValue;\n    }\n\n    return obj[name] ? true : false;\n  }\n\n  /**\n   * Return an attribute's value as a `Number`.\n   *\n   * The first parameter, `name`, is a string with the name of the attribute\n   * being checked. For example, calling `myXML.getNum('id')` returns the\n   * element's `id` attribute as a number.\n   *\n   * The second parameter, `defaultValue`, is optional. If a number is passed,\n   * as in `myXML.getNum('id', -1)`, it will be returned if the attribute\n   * doesn't exist or can't be converted to a number.\n   *\n   * Note: Use\n   * <a href=\"#/p5.XML/getString\">myXML.getString()</a> or\n   * <a href=\"#/p5.XML/getNum\">myXML.getNum()</a> to return an attribute's value.\n   *\n   * @param {String} name name of the attribute to be checked.\n   * @param {Number} [defaultValue] value to return if the attribute doesn't exist.\n   * @return {Number} attribute value as a number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the first reptile child element.\n   *   let reptile = myXML.getChild('reptile');\n   *\n   *   // Get the reptile's content.\n   *   let content = reptile.getContent();\n   *\n   *   // Get the reptile's ID.\n   *   let id = reptile.getNum('id');\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the ID attribute.\n   *   text(`${content} is ${id + 1}th`, 5, 50, 90);\n   *\n   *   describe(`The text \"${content} is ${id + 1}th\" written in black on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the first reptile child element.\n   *   let reptile = myXML.getChild('reptile');\n   *\n   *   // Get the reptile's content.\n   *   let content = reptile.getContent();\n   *\n   *   // Get the reptile's size.\n   *   let weight = reptile.getNum('weight', 135);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the ID attribute.\n   *   text(`${content} is ${weight}kg`, 5, 50, 90);\n   *\n   *   describe(\n   *     `The text \"${content} is ${weight}kg\" written in black on a gray background.`\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  getNum(name, defaultValue) {\n    const obj = {};\n\n    for (const attribute of this.DOM.attributes) {\n      obj[attribute.nodeName] = attribute.nodeValue;\n    }\n\n    return Number(obj[name]) || defaultValue || 0;\n  }\n\n  /**\n   * Return an attribute's value as a string.\n   *\n   * The first parameter, `name`, is a string with the name of the attribute\n   * being checked. For example, calling `myXML.getString('color')` returns the\n   * element's `id` attribute as a string.\n   *\n   * The second parameter, `defaultValue`, is optional. If a string is passed,\n   * as in `myXML.getString('color', 'deeppink')`, it will be returned if the\n   * attribute doesn't exist.\n   *\n   * Note: Use\n   * <a href=\"#/p5.XML/getString\">myXML.getString()</a> or\n   * <a href=\"#/p5.XML/getNum\">myXML.getNum()</a> to return an attribute's value.\n   *\n   * @param {String} name name of the attribute to be checked.\n   * @param {Number} [defaultValue] value to return if the attribute doesn't exist.\n   * @return {String} attribute value as a string.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the first reptile child element.\n   *   let reptile = myXML.getChild('reptile');\n   *\n   *   // Get the reptile's content.\n   *   let content = reptile.getContent();\n   *\n   *   // Get the reptile's species.\n   *   let species = reptile.getString('species');\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the species attribute.\n   *   text(`${content}: ${species}`, 5, 50, 90);\n   *\n   *   describe(`The text \"${content}: ${species}\" written in black on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the first reptile child element.\n   *   let reptile = myXML.getChild('reptile');\n   *\n   *   // Get the reptile's content.\n   *   let content = reptile.getContent();\n   *\n   *   // Get the reptile's color.\n   *   let attribute = reptile.getString('color', 'green');\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *   fill(attribute);\n   *\n   *   // Display the element's content.\n   *   text(content, 50, 50);\n   *\n   *   describe(`The text \"${content}\" written in green on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   */\n  getString(name, defaultValue) {\n    const obj = {};\n\n    for (const attribute of this.DOM.attributes) {\n      obj[attribute.nodeName] = attribute.nodeValue;\n    }\n\n    return obj[name] ? String(obj[name]) : defaultValue || null;\n  }\n\n  /**\n   * Sets an attribute to a given value.\n   *\n   * The first parameter, `name`, is a string with the name of the attribute\n   * being set.\n   *\n   * The second parameter, `value`, is the attribute's new value. For example,\n   * calling `myXML.setAttribute('id', 123)` sets the `id` attribute to the\n   * value 123.\n   *\n   * @param {String} name name of the attribute to be set.\n   * @param {Number|String|Boolean} value attribute's new value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the first reptile child element.\n   *   let reptile = myXML.getChild('reptile');\n   *\n   *   // Set the reptile's color.\n   *   reptile.setAttribute('color', 'green');\n   *\n   *   // Get the reptile's content.\n   *   let content = reptile.getContent();\n   *\n   *   // Get the reptile's color.\n   *   let attribute = reptile.getString('color');\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the element's content.\n   *   text(`${content} is ${attribute}`, 5, 50, 90);\n   *\n   *   describe(\n   *     `The text \"${content} is ${attribute}\" written in green on a gray background.`\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  setAttribute(name, value) {\n    this.DOM.setAttribute(name, value);\n  }\n\n  /**\n   * Returns the element's content as a `String`.\n   *\n   * The parameter, `defaultValue`, is optional. If a string is passed, as in\n   * `myXML.getContent('???')`, it will be returned if the element has no\n   * content.\n   *\n   * @param {String} [defaultValue] value to return if the element has no\n   *                                content.\n   * @return {String} element's content as a string.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the first reptile child element.\n   *   let reptile = myXML.getChild('reptile');\n   *\n   *   // Get the reptile's content.\n   *   let content = reptile.getContent();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the element's content.\n   *   text(content, 5, 50, 90);\n   *\n   *   describe(`The text \"${content}\" written in green on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.XML object.\n   *   let blankSpace = new p5.XML();\n   *\n   *   // Get the element's content and use a default value.\n   *   let content = blankSpace.getContent('Your name');\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the element's content.\n   *   text(content, 5, 50, 90);\n   *\n   *   describe(`The text \"${content}\" written in green on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   */\n  getContent(defaultValue) {\n    let str;\n    str = this.DOM.textContent;\n    str = str.replace(/\\s\\s+/g, ',');\n    return str || defaultValue || null;\n  }\n\n  /**\n   * Sets the element's content.\n   *\n   * An element's content is the text between its tags. For example, the element\n   * `&lt;language&gt;JavaScript&lt;/language&gt;` has the content `JavaScript`.\n   *\n   * The parameter, `content`, is a string with the element's new content.\n   *\n   * @method setContent\n   * @param {String} content new content for the element.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the first reptile child element.\n   *   let reptile = myXML.getChild('reptile');\n   *\n   *   // Get the reptile's original content.\n   *   let oldContent = reptile.getContent();\n   *\n   *   // Set the reptile's content.\n   *   reptile.setContent('Loggerhead');\n   *\n   *   // Get the reptile's new content.\n   *   let newContent = reptile.getContent();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Display the element's old and new content.\n   *   text(`${oldContent}: ${newContent}`, 5, 50, 90);\n   *\n   *   describe(\n   *     `The text \"${oldContent}: ${newContent}\" written in green on a gray background.`\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  setContent(content) {\n    if (!this.DOM.children.length) {\n      this.DOM.textContent = content;\n    }\n  }\n\n  /**\n   * Returns the element as a `String`.\n   *\n   * `myXML.serialize()` is useful for sending the element over the network or\n   * saving it to a file.\n   *\n   * @return {String} element as a string.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display instructions.\n   *   text('Double-click to save', 5, 50, 90);\n   *\n   *   describe('The text \"Double-click to save\" written in black on a gray background.');\n   * }\n   *\n   * // Save the file when the user double-clicks.\n   * function doubleClicked() {\n   *   // Create a p5.PrintWriter object.\n   *   // Use the file format .xml.\n   *   let myWriter = createWriter('animals', 'xml');\n   *\n   *   // Serialize the XML data to a string.\n   *   let data = myXML.serialize();\n   *\n   *   // Write the data to the print stream.\n   *   myWriter.write(data);\n   *\n   *   // Save the file and close the print stream.\n   *   myWriter.close();\n   * }\n   * </code>\n   * </div>\n   */\n  serialize() {\n    const xmlSerializer = new XMLSerializer();\n    return xmlSerializer.serializeToString(this.DOM);\n  }\n}\n\nfunction elementsToP5XML(elements) {\n  const arr = [];\n  for (let i = 0; i < elements.length; i++) {\n    arr.push(new XML(elements[i]));\n  }\n  return arr;\n}\n\nfunction xml(p5, fn){\n  /**\n   * A class to describe an XML object.\n   *\n   * Each `p5.XML` object provides an easy way to interact with XML data.\n   * Extensible Markup Language\n   * (<a href=\"https://developer.mozilla.org/en-US/docs/Web/XML/XML_introduction\" target=\"_blank\">XML</a>)\n   * is a standard format for sending data between applications. Like HTML, the\n   * XML format is based on tags and attributes, as in\n   * `&lt;time units=\"s\"&gt;1234&lt;/time&gt;`.\n   *\n   * Note: Use <a href=\"#/p5/loadXML\">loadXML()</a> to load external XML files.\n   *\n   * @class p5.XML\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * async function setup() {\n   *   // Load the XML and create a p5.XML object.\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get an array with all mammal tags.\n   *   let mammals = myXML.getChildren('mammal');\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Iterate over the mammals array.\n   *   for (let i = 0; i < mammals.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 25;\n   *\n   *     // Get the mammal's common name.\n   *     let name = mammals[i].getContent();\n   *\n   *     // Display the mammal's name.\n   *     text(name, 20, y);\n   *   }\n   *\n   *   describe(\n   *     'The words \"Goat\", \"Leopard\", and \"Zebra\" written on three separate lines. The text is black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  p5.XML = XML;\n}\n\nif(typeof p5 !== 'undefined'){\n  xml(p5, p5.prototype);\n}\n\nexport { XML, xml as default };\n","import { XML } from '../io/p5.XML.js';\n\n/**\n * @module DOM\n * @submodule DOM\n * @for p5.Element\n */\n\n\nclass File {\n  constructor(file, pInst) {\n    this.file = file;\n\n    this._pInst = pInst;\n\n    // Splitting out the file type into two components\n    // This makes determining if image or text etc simpler\n    const typeList = file.type.split('/');\n    this.type = typeList[0];\n    this.subtype = typeList[1];\n    this.name = file.name;\n    this.size = file.size;\n    this.data = undefined;\n  }\n\n\n  static _createLoader(theFile, callback) {\n    const reader = new FileReader();\n    reader.onload = function (e) {\n      const p5file = new File(theFile);\n      if (p5file.file.type === 'application/json') {\n        // Parse JSON and store the result in data\n        p5file.data = JSON.parse(e.target.result);\n      } else if (p5file.file.type === 'text/xml') {\n        // Parse XML, wrap it in p5.XML and store the result in data\n        const parser = new DOMParser();\n        const xml = parser.parseFromString(e.target.result, 'text/xml');\n        p5file.data = new XML(xml.documentElement);\n      } else {\n        p5file.data = e.target.result;\n      }\n      callback(p5file);\n    };\n    return reader;\n  }\n\n  static _load(f, callback) {\n    // Text or data?\n    // This should likely be improved\n    if (/^text\\//.test(f.type) || f.type === 'application/json') {\n      File._createLoader(f, callback).readAsText(f);\n    } else if (!/^(video|audio)\\//.test(f.type)) {\n      File._createLoader(f, callback).readAsDataURL(f);\n    } else {\n      const file = new File(f);\n      file.data = URL.createObjectURL(f);\n      callback(file);\n    }\n  }\n}\n\nfunction file(p5, fn){\n  /**\n   * A class to describe a file.\n   *\n   * `p5.File` objects are used by\n   * <a href=\"#/p5.Element/drop\">myElement.drop()</a> and\n   * created by\n   * <a href=\"#/p5/createFileInput\">createFileInput</a>.\n   *\n   * @class p5.File\n   * @param {File} file wrapped file.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Use the file input to load a\n   * // file and display its info.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a file input and place it beneath the canvas.\n   *   // Call displayInfo() when the file loads.\n   *   let input = createFileInput(displayInfo);\n   *   input.position(0, 100);\n   *\n   *   describe('A gray square with a file input beneath it. If the user loads a file, its info is written in black.');\n   * }\n   *\n   * // Display the p5.File's info once it loads.\n   * function displayInfo(file) {\n   *   background(200);\n   *\n   *   // Display the p5.File's name.\n   *   text(file.name, 10, 10, 80, 40);\n   *\n   *   // Display the p5.File's type and subtype.\n   *   text(`${file.type}/${file.subtype}`, 10, 70);\n   *\n   *   // Display the p5.File's size in bytes.\n   *   text(file.size, 10, 90);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Use the file input to select an image to\n   * // load and display.\n   * let img;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a file input and place it beneath the canvas.\n   *   // Call handleImage() when the file image loads.\n   *   let input = createFileInput(handleImage);\n   *   input.position(0, 100);\n   *\n   *   describe('A gray square with a file input beneath it. If the user selects an image file to load, it is displayed on the square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the image if it's ready.\n   *   if (img) {\n   *     image(img, 0, 0, width, height);\n   *   }\n   * }\n   *\n   * // Use the p5.File's data once it loads.\n   * function handleImage(file) {\n   *   // Check the p5.File's type.\n   *   if (file.type === 'image') {\n   *     // Create an image using using the p5.File's data.\n   *     img = createImg(file.data, '');\n   *\n   *     // Hide the image element so it doesn't appear twice.\n   *     img.hide();\n   *   } else {\n   *     img = null;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  p5.File = File;\n\n  /**\n   * Underlying\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/File\" target=\"_blank\">File</a>\n   * object. All `File` properties and methods are accessible.\n   *\n   * @for p5.File\n   * @property file\n   * @example\n   * <div>\n   * <code>\n   * // Use the file input to load a\n   * // file and display its info.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a file input and place it beneath the canvas.\n   *   // Call displayInfo() when the file loads.\n   *   let input = createFileInput(displayInfo);\n   *   input.position(0, 100);\n   *\n   *   describe('A gray square with a file input beneath it. If the user loads a file, its info is written in black.');\n   * }\n   *\n   * // Use the p5.File once it loads.\n   * function displayInfo(file) {\n   *   background(200);\n   *\n   *   // Display the p5.File's name.\n   *   text(file.name, 10, 10, 80, 40);\n   *\n   *   // Display the p5.File's type and subtype.\n   *   text(`${file.type}/${file.subtype}`, 10, 70);\n   *\n   *   // Display the p5.File's size in bytes.\n   *   text(file.size, 10, 90);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The file\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types\" target=\"_blank\">MIME type</a>\n   * as a string.\n   *\n   * For example, `'image'` and `'text'` are both MIME types.\n   *\n   * @for p5.File\n   * @property type\n   * @example\n   * <div>\n   * <code>\n   * // Use the file input to load a file and display its info.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a file input and place it beneath the canvas.\n   *   // Call displayType() when the file loads.\n   *   let input = createFileInput(displayType);\n   *   input.position(0, 100);\n   *\n   *   describe('A gray square with a file input beneath it. If the user loads a file, its type is written in black.');\n   * }\n   *\n   * // Display the p5.File's type once it loads.\n   * function displayType(file) {\n   *   background(200);\n   *\n   *   // Display the p5.File's type.\n   *   text(`This is file's type is: ${file.type}`, 10, 10, 80, 80);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The file subtype as a string.\n   *\n   * For example, a file with an `'image'`\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types\" target=\"_blank\">MIME type</a>\n   * may have a subtype such as ``png`` or ``jpeg``.\n   *\n   * @property subtype\n   * @for p5.File\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Use the file input to load a\n   * // file and display its info.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a file input and place it beneath the canvas.\n   *   // Call displaySubtype() when the file loads.\n   *   let input = createFileInput(displaySubtype);\n   *   input.position(0, 100);\n   *\n   *   describe('A gray square with a file input beneath it. If the user loads a file, its subtype is written in black.');\n   * }\n   *\n   * // Display the p5.File's type once it loads.\n   * function displaySubtype(file) {\n   *   background(200);\n   *\n   *   // Display the p5.File's subtype.\n   *   text(`This is file's subtype is: ${file.subtype}`, 10, 10, 80, 80);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The file name as a string.\n   *\n   * @property name\n   * @for p5.File\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Use the file input to load a\n   * // file and display its info.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a file input and place it beneath the canvas.\n   *   // Call displayName() when the file loads.\n   *   let input = createFileInput(displayName);\n   *   input.position(0, 100);\n   *\n   *   describe('A gray square with a file input beneath it. If the user loads a file, its name is written in black.');\n   * }\n   *\n   * // Display the p5.File's name once it loads.\n   * function displayName(file) {\n   *   background(200);\n   *\n   *   // Display the p5.File's name.\n   *   text(`This is file's name is: ${file.name}`, 10, 10, 80, 80);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The number of bytes in the file.\n   *\n   * @property size\n   * @for p5.File\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Use the file input to load a file and display its info.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a file input and place it beneath the canvas.\n   *   // Call displaySize() when the file loads.\n   *   let input = createFileInput(displaySize);\n   *   input.position(0, 100);\n   *\n   *   describe('A gray square with a file input beneath it. If the user loads a file, its size in bytes is written in black.');\n   * }\n   *\n   * // Display the p5.File's size in bytes once it loads.\n   * function displaySize(file) {\n   *   background(200);\n   *\n   *   // Display the p5.File's size.\n   *   text(`This is file has ${file.size} bytes.`, 10, 10, 80, 80);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * A string containing the file's data.\n   *\n   * Data can be either image data, text contents, or a parsed object in the\n   * case of JSON and <a href=\"#/p5.XML\">p5.XML</a> objects.\n   *\n   * @property data\n   * @for p5.File\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Use the file input to load a file and display its info.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a file input and place it beneath the canvas.\n   *   // Call displayData() when the file loads.\n   *   let input = createFileInput(displayData);\n   *   input.position(0, 100);\n   *\n   *   describe('A gray square with a file input beneath it. If the user loads a file, its data is written in black.');\n   * }\n   *\n   * // Display the p5.File's data once it loads.\n   * function displayData(file) {\n   *   background(200);\n   *\n   *   // Display the p5.File's data, which looks like a random string of characters.\n   *   text(file.data, 10, 10, 80, 80);\n   * }\n   * </code>\n   * </div>\n   */\n}\n\nif(typeof p5 !== 'undefined'){\n  file(p5, p5.prototype);\n}\n\nexport { File, file as default };\n","import { File } from './p5.File.js';\nimport { C as Color } from '../creating_reading-BdolPjuO.js';\nimport { w as AUTO } from '../constants-8IpwyBct.js';\nimport '../io/p5.XML.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\n\n/**\n * @module DOM\n * @submodule DOM\n */\n\n\nclass Element {\n  width;\n  height;\n  elt;\n\n  constructor(elt, pInst) {\n    this.elt = elt;\n    this._pInst = this._pixelsState = pInst;\n    this._events = {};\n    this.width = this.elt.offsetWidth;\n    this.height = this.elt.offsetHeight;\n  }\n\n  /**\n   * Removes the element, stops all audio/video streams, and removes all\n   * callback functions.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let p;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a paragraph element.\n   *   p = createP('p5*js');\n   *   p.position(10, 10);\n   *\n   *   describe('The text \"p5*js\" written at the center of a gray square. ');\n   * }\n   *\n   * // Remove the paragraph when the user double-clicks.\n   * function doubleClicked() {\n   *   p.remove();\n   * }\n   * </code>\n   * </div>\n   */\n  remove() {\n    // stop all audios/videos and detach all devices like microphone/camera etc\n    // used as input/output for audios/videos.\n    // if (this instanceof p5.MediaElement) {\n    if(this.stop){\n      this.stop();\n      const sources = this.elt.srcObject;\n      if (sources !== null) {\n        const tracks = sources.getTracks();\n        tracks.forEach(track => {\n          track.stop();\n        });\n      }\n    }\n\n    // `this._pInst` is usually the p5 sketch object that owns the global\n    // `_elements` array.  But when an element lives inside an off-screen\n    // `p5.Graphics` layer, `this._pInst` is that wrapper Graphics object\n    // instead.  The wrapper keeps a backpointer (`_pInst`) to the real\n    // sketch but has no `_elements` array of its own. \n   \n   let sketch = this._pInst;\n  \n    // If `sketch` doesnt own an `_elements` array it means\n    // were still at the graphics-layer wrapper.  \n    // Jump one level up to the real p5 sketch stored in sketch._pInst.\n\n    if (sketch && !sketch._elements && sketch._pInst) {\n          sketch = sketch._pInst;          // climb one level up\n    }\n    \n    if (sketch && sketch._elements) {  // only if the array exists\n      const i = sketch._elements.indexOf(this);\n      if (i !== -1) sketch._elements.splice(i, 1);\n    }\n     \n\n    // deregister events\n    for (let ev in this._events) {\n      this.elt.removeEventListener(ev, this._events[ev]);\n    }\n    if (this.elt && this.elt.parentNode) {\n      this.elt.parentNode.removeChild(this.elt);\n    }\n  }\n\n  /**\n   * Attaches the element to a parent element.\n   *\n   * For example, a `&lt;div&gt;&lt;/div&gt;` element may be used as a box to\n   * hold two pieces of text, a header and a paragraph. The\n   * `&lt;div&gt;&lt;/div&gt;` is the parent element of both the header and\n   * paragraph.\n   *\n   * The parameter `parent` can have one of three types. `parent` can be a\n   * string with the parent element's ID, as in\n   * `myElement.parent('container')`. It can also be another\n   * <a href=\"#/p5.Element\">p5.Element</a> object, as in\n   * `myElement.parent(myDiv)`. Finally, `parent` can be an `HTMLElement`\n   * object, as in `myElement.parent(anotherElement)`.\n   *\n   * Calling `myElement.parent()` without an argument returns the element's\n   * parent.\n   *\n   * @param  {String|p5.Element|Object} parent ID, <a href=\"#/p5.Element\">p5.Element</a>,\n   *                                           or HTMLElement of desired parent element.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup()  {\n   *   background(200);\n   *\n   *   // Create a div element.\n   *   let div = createDiv();\n   *\n   *   // Place the div in the top-left corner.\n   *   div.position(10, 20);\n   *\n   *   // Set its width and height.\n   *   div.size(80, 60);\n   *\n   *   // Set its background color to white\n   *   div.style('background-color', 'white');\n   *\n   *   // Align any text to the center.\n   *   div.style('text-align', 'center');\n   *\n   *   // Set its ID to \"container\".\n   *   div.id('container');\n   *\n   *   // Create a paragraph element.\n   *   let p = createP('p5*js');\n   *\n   *   // Make the div its parent\n   *   // using its ID \"container\".\n   *   p.parent('container');\n   *\n   *   describe('The text \"p5*js\" written in black at the center of a white rectangle. The rectangle is inside a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup()  {\n   *   background(200);\n   *\n   *   // Create rectangular div element.\n   *   let div = createDiv();\n   *\n   *   // Place the div in the top-left corner.\n   *   div.position(10, 20);\n   *\n   *   // Set its width and height.\n   *   div.size(80, 60);\n   *\n   *   // Set its background color and align\n   *   // any text to the center.\n   *   div.style('background-color', 'white');\n   *   div.style('text-align', 'center');\n   *\n   *   // Create a paragraph element.\n   *   let p = createP('p5*js');\n   *\n   *   // Make the div its parent.\n   *   p.parent(div);\n   *\n   *   describe('The text \"p5*js\" written in black at the center of a white rectangle. The rectangle is inside a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup()  {\n   *   background(200);\n   *\n   *   // Create rectangular div element.\n   *   let div = createDiv();\n   *\n   *   // Place the div in the top-left corner.\n   *   div.position(10, 20);\n   *\n   *   // Set its width and height.\n   *   div.size(80, 60);\n   *\n   *   // Set its background color and align\n   *   // any text to the center.\n   *   div.style('background-color', 'white');\n   *   div.style('text-align', 'center');\n   *\n   *   // Create a paragraph element.\n   *   let p = createP('p5*js');\n   *\n   *   // Make the div its parent\n   *   // using the underlying\n   *   // HTMLElement.\n   *   p.parent(div.elt);\n   *\n   *   describe('The text \"p5*js\" written in black at the center of a white rectangle. The rectangle is inside a gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @return {p5.Element}\n   */\n  parent(p) {\n    if (typeof p === 'undefined') {\n      return this.elt.parentNode;\n    }\n\n    if (typeof p === 'string') {\n      if (p[0] === '#') {\n        p = p.substring(1);\n      }\n      p = document.getElementById(p);\n    } else if (p instanceof Element) {\n      p = p.elt;\n    }\n    p.appendChild(this.elt);\n    return this;\n  }\n\n  /**\n   * Attaches the element as a child of another element.\n   *\n   * `myElement.child()` accepts either a string ID, DOM node, or\n   * <a href=\"#/p5.Element\">p5.Element</a>. For example,\n   * `myElement.child(otherElement)`. If no argument is provided, an array of\n   * children DOM nodes is returned.\n   *\n   * @returns {Node[]} an array of child nodes.\n   *\n   * @example\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create the div elements.\n   *   let div0 = createDiv('Parent');\n   *   let div1 = createDiv('Child');\n   *\n   *   // Make div1 the child of div0\n   *   // using the p5.Element.\n   *   div0.child(div1);\n   *\n   *   describe('A gray square with the words \"Parent\" and \"Child\" written beneath it.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create the div elements.\n   *   let div0 = createDiv('Parent');\n   *   let div1 = createDiv('Child');\n   *\n   *   // Give div1 an ID.\n   *   div1.id('apples');\n   *\n   *   // Make div1 the child of div0\n   *   // using its ID.\n   *   div0.child('apples');\n   *\n   *   describe('A gray square with the words \"Parent\" and \"Child\" written beneath it.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender notest'>\n   * <code>\n   * // This example assumes there is a div already on the page\n   * // with id \"myChildDiv\".\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create the div elements.\n   *   let div0 = createDiv('Parent');\n   *\n   *   // Select the child element by its ID.\n   *   let elt = document.getElementById('myChildDiv');\n   *\n   *   // Make div1 the child of div0\n   *   // using its HTMLElement object.\n   *   div0.child(elt);\n   *\n   *   describe('A gray square with the words \"Parent\" and \"Child\" written beneath it.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {String|p5.Element} [child] the ID, DOM node, or <a href=\"#/p5.Element\">p5.Element</a>\n   *                         to add to the current element\n   * @chainable\n   */\n  child(childNode) {\n    if (typeof childNode === 'undefined') {\n      return this.elt.childNodes;\n    }\n    if (typeof childNode === 'string') {\n      if (childNode[0] === '#') {\n        childNode = childNode.substring(1);\n      }\n      childNode = document.getElementById(childNode);\n    } else if (childNode instanceof Element) {\n      childNode = childNode.elt;\n    }\n\n    if (childNode instanceof HTMLElement) {\n      this.elt.appendChild(childNode);\n    }\n    return this;\n  }\n\n  /**\n   * Sets the inner HTML of the element, replacing any existing HTML.\n   *\n   * The second parameter, `append`, is optional. If `true` is passed, as in\n   * `myElement.html('hi', true)`, the HTML is appended instead of replacing\n   * existing HTML.\n   *\n   * If no arguments are passed, as in `myElement.html()`, the element's inner\n   * HTML is returned.\n   *\n   * @for p5.Element\n   * @returns {String} the inner HTML of the element\n   *\n   * @example\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create the div element and set its size.\n   *   let div = createDiv('');\n   *   div.size(100, 100);\n   *\n   *   // Set the inner HTML to \"hi\".\n   *   div.html('hi');\n   *\n   *   describe('A gray square with the word \"hi\" written beneath it.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create the div element and set its size.\n   *   let div = createDiv('Hello ');\n   *   div.size(100, 100);\n   *\n   *   // Append \"World\" to the div's HTML.\n   *   div.html('World', true);\n   *\n   *   describe('A gray square with the text \"Hello World\" written beneath it.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create the div element.\n   *   let div = createDiv('Hello');\n   *\n   *   // Prints \"Hello\" to the console.\n   *   print(div.html());\n   *\n   *   describe('A gray square with the word \"Hello!\" written beneath it.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {String} [html] the HTML to be placed inside the element\n   * @param  {Boolean} [append] whether to append HTML to existing\n   * @chainable\n   */\n  html(...args) {\n    if (args.length === 0) {\n      return this.elt.innerHTML;\n    } else if (args[1]) {\n      this.elt.insertAdjacentHTML('beforeend', args[0]);\n      return this;\n    } else {\n      this.elt.innerHTML = args[0];\n      return this;\n    }\n  }\n\n  /**\n   * Sets the element's ID using a given string.\n   *\n   * Calling `myElement.id()` without an argument returns its ID as a string.\n   *\n   * @param  {String} id ID of the element.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the canvas' ID\n   *   // to \"mycanvas\".\n   *   cnv.id('mycanvas');\n   *\n   *   // Get the canvas' ID.\n   *   let id = cnv.id();\n   *   text(id, 24, 54);\n   *\n   *   describe('The text \"mycanvas\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @return {String} ID of the element.\n   */\n  id(id) {\n    if (typeof id === 'undefined') {\n      return this.elt.id;\n    }\n\n    this.elt.id = id;\n    this.width = this.elt.offsetWidth;\n    this.height = this.elt.offsetHeight;\n    return this;\n  }\n\n  /**\n   * Adds a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/class\" target=\"_blank\">class attribute</a>\n   * to the element using a given string.\n   *\n   * Calling `myElement.class()` without an argument returns a string with its current classes.\n   *\n   * @param  {String} class class to add.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Add the class \"small\" to the\n   *   // canvas element.\n   *   cnv.class('small');\n   *\n   *   // Get the canvas element's class\n   *   // and display it.\n   *   let c = cnv.class();\n   *   text(c, 35, 54);\n   *\n   *   describe('The word \"small\" written in black on a gray canvas.');\n   *\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @return {String} element's classes, if any.\n   */\n  class(c) {\n    if (typeof c === 'undefined') {\n      return this.elt.className;\n    }\n\n    this.elt.className = c;\n    return this;\n  }\n\n  /**\n   *\n   * Adds a class to the element.\n   *\n   * @for p5.Element\n   * @param  {String} class name of class to add.\n   * @chainable\n   *\n   * @example\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a div element.\n   *   let div = createDiv('div');\n   *\n   *   // Add a class to the div.\n   *   div.addClass('myClass');\n   *\n   *   describe('A gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n  addClass(c) {\n    if (this.elt.className) {\n      if (!this.hasClass(c)) {\n        this.elt.className = this.elt.className + ' ' + c;\n      }\n    } else {\n      this.elt.className = c;\n    }\n    return this;\n  }\n\n  /**\n   * Removes a class from the element.\n   *\n   * @param  {String} class name of class to remove.\n   * @chainable\n   *\n   * @example\n   * <div class='norender'>\n   * <code>\n   * // In this example, a class is set when the div is created\n   * // and removed when mouse is pressed. This could link up\n   * // with a CSS style rule to toggle style properties.\n   *\n   * let div;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a div element.\n   *   div = createDiv('div');\n   *\n   *   // Add a class to the div.\n   *   div.addClass('myClass');\n   *\n   *   describe('A gray square.');\n   * }\n   *\n   * // Remove 'myClass' from the div when the user presses the mouse.\n   * function mousePressed() {\n   *   div.removeClass('myClass');\n   * }\n   * </code>\n   * </div>\n   */\n  removeClass(c) {\n    // Note: Removing a class that does not exist does NOT throw an error in classList.remove method\n    this.elt.classList.remove(c);\n    return this;\n  }\n\n  /**\n   * Checks if a class is already applied to element.\n   *\n   * @returns {boolean} a boolean value if element has specified class.\n   * @param c {String} name of class to check.\n   *\n   * @example\n   * <div class='norender'>\n   * <code>\n   * let div;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a div element.\n   *   div = createDiv('div');\n   *\n   *   // Add the class 'show' to the div.\n   *   div.addClass('show');\n   *\n   *   describe('A gray square.');\n   * }\n   *\n   * // Toggle the class 'show' when the mouse is pressed.\n   * function mousePressed() {\n   *   if (div.hasClass('show')) {\n   *     div.addClass('show');\n   *   } else {\n   *     div.removeClass('show');\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  hasClass(c) {\n    return this.elt.classList.contains(c);\n  }\n\n  /**\n   * Toggles whether a class is applied to the element.\n   *\n   * @param c {String} class name to toggle.\n   * @chainable\n   *\n   * @example\n   * <div class='norender'>\n   * <code>\n   * let div;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a div element.\n   *   div = createDiv('div');\n   *\n   *   // Add the 'show' class to the div.\n   *   div.addClass('show');\n   *\n   *   describe('A gray square.');\n   * }\n   *\n   * // Toggle the 'show' class when the mouse is pressed.\n   * function mousePressed() {\n   *   div.toggleClass('show');\n   * }\n   * </code>\n   * </div>\n   */\n  toggleClass(c) {\n    // classList also has a toggle() method, but we cannot use that yet as support is unclear.\n    // See https://github.com/processing/p5.js/issues/3631\n    // this.elt.classList.toggle(c);\n    if (this.elt.classList.contains(c)) {\n      this.elt.classList.remove(c);\n    } else {\n      this.elt.classList.add(c);\n    }\n    return this;\n  }\n\n  /**\n   * Centers the element either vertically, horizontally, or both.\n   *\n   * `center()` will center the element relative to its parent or according to\n   * the page's body if the element has no parent.\n   *\n   * If no argument is passed, as in `myElement.center()` the element is aligned\n   * both vertically and horizontally.\n   *\n   * @param  {String} [align] passing 'vertical', 'horizontal' aligns element accordingly\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create the div element and style it.\n   *   let div = createDiv('');\n   *   div.size(10, 10);\n   *   div.style('background-color', 'orange');\n   *\n   *   // Center the div relative to the page's body.\n   *   div.center();\n   *\n   *   describe('A gray square and an orange rectangle. The rectangle is at the center of the page.');\n   * }\n   * </code>\n   * </div>\n   */\n  center(align) {\n    const style = this.elt.style.display;\n    const hidden = this.elt.style.display === 'none';\n    const parentHidden = this.parent().style.display === 'none';\n    const pos = { x: this.elt.offsetLeft, y: this.elt.offsetTop };\n\n    if (hidden) this.show();\n    if (parentHidden) this.parent().show();\n    this.elt.style.display = 'block';\n\n    this.position(0, 0);\n    const wOffset = Math.abs(this.parent().offsetWidth - this.elt.offsetWidth);\n    const hOffset = Math.abs(this.parent().offsetHeight - this.elt.offsetHeight);\n\n    if (align === 'both' || align === undefined) {\n      this.position(\n        wOffset / 2 + this.parent().offsetLeft,\n        hOffset / 2 + this.parent().offsetTop\n      );\n    } else if (align === 'horizontal') {\n      this.position(wOffset / 2 + this.parent().offsetLeft, pos.y);\n    } else if (align === 'vertical') {\n      this.position(pos.x, hOffset / 2 + this.parent().offsetTop);\n    }\n\n    this.style('display', style);\n    if (hidden) this.hide();\n    if (parentHidden) this.parent().hide();\n\n    return this;\n  }\n\n  /**\n   * Sets the element's position.\n   *\n   * The first two parameters, `x` and `y`, set the element's position relative\n   * to the top-left corner of the web page.\n   *\n   * The third parameter, `positionType`, is optional. It sets the element's\n   * <a target=\"_blank\"\n   * href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/position\">positioning scheme</a>.\n   * `positionType` is a string that can be either `'static'`, `'fixed'`,\n   * `'relative'`, `'sticky'`, `'initial'`, or `'inherit'`.\n   *\n   * If no arguments passed, as in `myElement.position()`, the method returns\n   * the element's position in an object, as in `{ x: 0, y: 0 }`.\n   *\n   * @returns {Object} object of form `{ x: 0, y: 0 }` containing the element's position.\n   *\n   * @example\n   * <div>\n   * <code class='norender'>\n   * function setup() {\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Positions the canvas 50px to the right and 100px\n   *   // below the top-left corner of the window.\n   *   cnv.position(50, 100);\n   *\n   *   describe('A gray square that is 50 pixels to the right and 100 pixels down from the top-left corner of the web page.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code class='norender'>\n   * function setup() {\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Positions the canvas at the top-left corner\n   *   // of the window with a 'fixed' position type.\n   *   cnv.position(0, 0, 'fixed');\n   *\n   *   describe('A gray square in the top-left corner of the web page.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {Number} [x] x-position relative to top-left of window (optional)\n   * @param  {Number} [y] y-position relative to top-left of window (optional)\n   * @param  {String} [positionType] it can be static, fixed, relative, sticky, initial or inherit (optional)\n   * @chainable\n   */\n  position(...args) {\n    if (args.length === 0) {\n      return { x: this.elt.offsetLeft, y: this.elt.offsetTop };\n    } else {\n      let positionType = 'absolute';\n      if (\n        args[2] === 'static' ||\n        args[2] === 'fixed' ||\n        args[2] === 'relative' ||\n        args[2] === 'sticky' ||\n        args[2] === 'initial' ||\n        args[2] === 'inherit'\n      ) {\n        positionType = args[2];\n      }\n      this.elt.style.position = positionType;\n      this.elt.style.left = args[0] + 'px';\n      this.elt.style.top = args[1] + 'px';\n      this.x = args[0];\n      this.y = args[1];\n      return this;\n    }\n  }\n\n  /**\n   * Shows the current element.\n   *\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let p;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a paragraph element and hide it.\n   *   p = createP('p5*js');\n   *   p.position(10, 10);\n   *   p.hide();\n   *\n   *   describe('A gray square. The text \"p5*js\" appears when the user double-clicks the square.');\n   * }\n   *\n   * // Show the paragraph when the user double-clicks.\n   * function doubleClicked() {\n   *   p.show();\n   * }\n   * </code>\n   * </div>\n   */\n  show() {\n    this.elt.style.display = 'block';\n    return this;\n  }\n\n  /**\n   * Hides the current element.\n   *\n   * @chainable\n   *\n   * @example\n   * let p;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a paragraph element.\n   *   p = createP('p5*js');\n   *   p.position(10, 10);\n   *\n   *   describe('The text \"p5*js\" at the center of a gray square. The text disappears when the user double-clicks the square.');\n   * }\n   *\n   * // Hide the paragraph when the user double-clicks.\n   * function doubleClicked() {\n   *   p.hide();\n   * }\n   * </code>\n   * </div>\n   */\n  hide() {\n    this.elt.style.display = 'none';\n    return this;\n  }\n\n  /**\n   * Sets the element's width and height.\n   *\n   * Calling `myElement.size()` without an argument returns the element's size\n   * as an object with the properties `width` and `height`. For example,\n   *  `{ width: 20, height: 10 }`.\n   *\n   * The first parameter, `width`, is optional. It's a number used to set the\n   * element's width. Calling `myElement.size(10)`\n   *\n   * The second parameter, 'height`, is also optional. It's a\n   * number used to set the element's height. For example, calling\n   * `myElement.size(20, 10)` sets the element's width to 20 pixels and height\n   * to 10 pixels.\n   *\n   * The constant `AUTO` can be used to adjust one dimension at a time while\n   * maintaining the aspect ratio, which is `width / height`. For example,\n   * consider an element that's 200 pixels wide and 100 pixels tall. Calling\n   * `myElement.size(20, AUTO)` sets the width to 20 pixels and height to 10\n   * pixels.\n   *\n   * Note: In the case of elements that need to load data, such as images, wait\n   * to call `myElement.size()` until after the data loads.\n   *\n   * @return {Object} width and height of the element in an object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a pink div element and place it at the top-left corner.\n   *   let div = createDiv();\n   *   div.position(10, 10);\n   *   div.style('background-color', 'deeppink');\n   *\n   *   // Set the div's width to 80 pixels and height to 20 pixels.\n   *   div.size(80, 20);\n   *\n   *   describe('A gray square with a pink rectangle near its top.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a pink div element and place it at the top-left corner.\n   *   let div = createDiv();\n   *   div.position(10, 10);\n   *   div.style('background-color', 'deeppink');\n   *\n   *   // Set the div's width to 80 pixels and height to 40 pixels.\n   *   div.size(80, 40);\n   *\n   *   // Get the div's size as an object.\n   *   let s = div.size();\n   *\n   *   // Display the div's dimensions.\n   *   div.html(`${s.width} x ${s.height}`);\n   *\n   *   describe('A gray square with a pink rectangle near its top. The text \"80 x 40\" is written within the rectangle.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img1;\n   * let img2;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Load an image of an astronaut on the moon\n   *   // and place it at the top-left of the canvas.\n   *   img1 = createImg(\n   *     'assets/moonwalk.jpg',\n   *     'An astronaut walking on the moon',\n   *     ''\n   *   );\n   *   img1.position(0, 0);\n   *\n   *   // Load an image of an astronaut on the moon\n   *   // and place it at the top-left of the canvas.\n   *   // Resize the image once it's loaded.\n   *   img2 = createImg(\n   *     'assets/moonwalk.jpg',\n   *     'An astronaut walking on the moon',\n   *     '',\n   *     resizeImage\n   *   );\n   *   img2.position(0, 0);\n   *\n   *   describe('A gray square two copies of a space image at the top-left. The copy in front is smaller.');\n   * }\n   *\n   * // Resize img2 and keep its aspect ratio.\n   * function resizeImage() {\n   *   img2.size(50, AUTO);\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {(Number|AUTO)} [w]   width of the element, either AUTO, or a number.\n   * @param  {(Number|AUTO)} [h] height of the element, either AUTO, or a number.\n   * @chainable\n   */\n  size(w, h) {\n    if (arguments.length === 0) {\n      return { width: this.elt.offsetWidth, height: this.elt.offsetHeight };\n    } else {\n      let aW = w;\n      let aH = h;\n      const AUTO$1 = AUTO;\n      if (aW !== AUTO$1 || aH !== AUTO$1) {\n        if (aW === AUTO$1) {\n          aW = h * this.width / this.height;\n        } else if (aH === AUTO$1) {\n          aH = w * this.height / this.width;\n        }\n        // set diff for cnv vs normal div\n        if (this.elt instanceof HTMLCanvasElement) {\n          const j = {};\n          const k = this.elt.getContext('2d');\n          let prop;\n          for (prop in k) {\n            j[prop] = k[prop];\n          }\n          this.elt.setAttribute('width', aW * this._pInst._pixelDensity);\n          this.elt.setAttribute('height', aH * this._pInst._pixelDensity);\n          this.elt.style.width = aW + 'px';\n          this.elt.style.height = aH + 'px';\n          this._pInst.scale(this._pInst._pixelDensity, this._pInst._pixelDensity);\n          for (prop in j) {\n            this.elt.getContext('2d')[prop] = j[prop];\n          }\n        } else {\n          this.elt.style.width = aW + 'px';\n          this.elt.style.height = aH + 'px';\n          this.elt.width = aW;\n          this.elt.height = aH;\n        }\n        this.width = aW;\n        this.height = aH;\n        if (this._pInst && this._pInst._curElement) {\n          // main canvas associated with p5 instance\n          if (this._pInst._curElement.elt === this.elt) {\n            this._pInst.width = aW;\n            this._pInst.height = aH;\n          }\n        }\n      }\n      return this;\n    }\n  }\n\n  /**\n   * Applies a style to the element by adding a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Syntax\" target=\"_blank\">CSS declaration</a>.\n   *\n   * The first parameter, `property`, is a string. If the name of a style\n   * property is passed, as in `myElement.style('color')`, the method returns\n   * the current value as a string or `null` if it hasn't been set. If a\n   * `property:style` string is passed, as in\n   * `myElement.style('color:deeppink')`, the method sets the style `property`\n   * to `value`.\n   *\n   * The second parameter, `value`, is optional. It sets the property's value.\n   * `value` can be a string, as in\n   * `myElement.style('color', 'deeppink')`, or a\n   * <a href=\"#/p5.Color\">p5.Color</a> object, as in\n   * `myElement.style('color', myColor)`.\n   *\n   * @param  {String} property style property to set.\n   * @returns {String} value of the property.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a paragraph element and set its font color to \"deeppink\".\n   *   let p = createP('p5*js');\n   *   p.position(25, 20);\n   *   p.style('color', 'deeppink');\n   *\n   *   describe('The text p5*js written in pink on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color('deeppink');\n   *\n   *   // Create a paragraph element and set its font color using a p5.Color object.\n   *   let p = createP('p5*js');\n   *   p.position(25, 20);\n   *   p.style('color', c);\n   *\n   *   describe('The text p5*js written in pink on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a paragraph element and set its font color to \"deeppink\"\n   *   // using property:value syntax.\n   *   let p = createP('p5*js');\n   *   p.position(25, 20);\n   *   p.style('color:deeppink');\n   *\n   *   describe('The text p5*js written in pink on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an empty paragraph element and set its font color to \"deeppink\".\n   *   let p = createP();\n   *   p.position(5, 5);\n   *   p.style('color', 'deeppink');\n   *\n   *   // Get the element's color as an  RGB color string.\n   *   let c = p.style('color');\n   *\n   *   // Set the element's inner HTML using the RGB color string.\n   *   p.html(c);\n   *\n   *   describe('The text \"rgb(255, 20, 147)\" written in pink on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {String} property\n   * @param  {String|p5.Color} value value to assign to the property.\n   * @return {String} value of the property.\n   * @chainable\n   */\n  style(prop, val) {\n    const self = this;\n\n    if (val instanceof Color) {\n      val = val.toString();\n    }\n\n    if (typeof val === 'undefined') {\n      if (prop.indexOf(':') === -1) {\n        // no value set, so assume requesting a value\n        let styles = window.getComputedStyle(self.elt);\n        let style = styles.getPropertyValue(prop);\n        return style;\n      } else {\n        // value set using `:` in a single line string\n        const attrs = prop.split(';');\n        for (let i = 0; i < attrs.length; i++) {\n          const parts = attrs[i].split(':');\n          if (parts[0] && parts[1]) {\n            this.elt.style[parts[0].trim()] = parts[1].trim();\n          }\n        }\n      }\n    } else {\n      // input provided as key,val pair\n      this.elt.style[prop] = val;\n      if (\n        prop === 'width' ||\n        prop === 'height' ||\n        prop === 'left' ||\n        prop === 'top'\n      ) {\n        let styles = window.getComputedStyle(self.elt);\n        let styleVal = styles.getPropertyValue(prop);\n        let numVal = styleVal.replace(/[^\\d.]/g, '');\n        this[prop] = Math.round(parseFloat(numVal, 10));\n      }\n    }\n    return this;\n  }\n\n  /* Helper method called by p5.Element.style() */\n  _translate(...args) {\n    this.elt.style.position = 'absolute';\n    // save out initial non-translate transform styling\n    let transform = '';\n    if (this.elt.style.transform) {\n      transform = this.elt.style.transform.replace(/translate3d\\(.*\\)/g, '');\n      transform = transform.replace(/translate[X-Z]?\\(.*\\)/g, '');\n    }\n    if (args.length === 2) {\n      this.elt.style.transform =\n        'translate(' + args[0] + 'px, ' + args[1] + 'px)';\n    } else if (args.length > 2) {\n      this.elt.style.transform =\n        'translate3d(' +\n        args[0] +\n        'px,' +\n        args[1] +\n        'px,' +\n        args[2] +\n        'px)';\n      if (args.length === 3) {\n        this.elt.parentElement.style.perspective = '1000px';\n      } else {\n        this.elt.parentElement.style.perspective = args[3] + 'px';\n      }\n    }\n    // add any extra transform styling back on end\n    this.elt.style.transform += transform;\n    return this;\n  }\n\n  /* Helper method called by p5.Element.style() */\n  _rotate(...args) {\n    // save out initial non-rotate transform styling\n    let transform = '';\n    if (this.elt.style.transform) {\n      transform = this.elt.style.transform.replace(/rotate3d\\(.*\\)/g, '');\n      transform = transform.replace(/rotate[X-Z]?\\(.*\\)/g, '');\n    }\n\n    if (args.length === 1) {\n      this.elt.style.transform = 'rotate(' + args[0] + 'deg)';\n    } else if (args.length === 2) {\n      this.elt.style.transform =\n        'rotate(' + args[0] + 'deg, ' + args[1] + 'deg)';\n    } else if (args.length === 3) {\n      this.elt.style.transform = 'rotateX(' + args[0] + 'deg)';\n      this.elt.style.transform += 'rotateY(' + args[1] + 'deg)';\n      this.elt.style.transform += 'rotateZ(' + args[2] + 'deg)';\n    }\n    // add remaining transform back on\n    this.elt.style.transform += transform;\n    return this;\n  }\n\n  /**\n   * Adds an\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Learn/HTML/Introduction_to_HTML/Getting_started#attributes\" target=\"_blank\">attribute</a>\n   * to the element.\n   *\n   * This method is useful for advanced tasks. Most commonly-used attributes,\n   * such as `id`, can be set with their dedicated methods. For example,\n   * `nextButton.id('next')` sets an element's `id` attribute. Calling\n   * `nextButton.attribute('id', 'next')` has the same effect.\n   *\n   * The first parameter, `attr`, is the attribute's name as a string. Calling\n   * `myElement.attribute('align')` returns the attribute's current value as a\n   * string or `null` if it hasn't been set.\n   *\n   * The second parameter, `value`, is optional. It's a string used to set the\n   * attribute's value. For example, calling\n   * `myElement.attribute('align', 'center')` sets the element's horizontal\n   * alignment to `center`.\n   *\n   * @return {String} value of the attribute.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a container div element and place it at the top-left corner.\n   *   let container = createDiv();\n   *   container.position(0, 0);\n   *\n   *   // Create a paragraph element and place it within the container.\n   *   // Set its horizontal alignment to \"left\".\n   *   let p1 = createP('hi');\n   *   p1.parent(container);\n   *   p1.attribute('align', 'left');\n   *\n   *   // Create a paragraph element and place it within the container.\n   *   // Set its horizontal alignment to \"center\".\n   *   let p2 = createP('hi');\n   *   p2.parent(container);\n   *   p2.attribute('align', 'center');\n   *\n   *   // Create a paragraph element and place it within the container.\n   *   // Set its horizontal alignment to \"right\".\n   *   let p3 = createP('hi');\n   *   p3.parent(container);\n   *   p3.attribute('align', 'right');\n   *\n   *   describe('A gray square with the text \"hi\" written on three separate lines, each placed further to the right.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {String} attr       attribute to set.\n   * @param  {String} value      value to assign to the attribute.\n   * @chainable\n   */\n  attribute(attr, value) {\n    //handling for checkboxes and radios to ensure options get\n    //attributes not divs\n    if (\n      this.elt.firstChild != null &&\n      (this.elt.firstChild.type === 'checkbox' ||\n        this.elt.firstChild.type === 'radio')\n    ) {\n      if (typeof value === 'undefined') {\n        return this.elt.firstChild.getAttribute(attr);\n      } else {\n        for (let i = 0; i < this.elt.childNodes.length; i++) {\n          this.elt.childNodes[i].setAttribute(attr, value);\n        }\n      }\n    } else if (typeof value === 'undefined') {\n      return this.elt.getAttribute(attr);\n    } else {\n      this.elt.setAttribute(attr, value);\n      return this;\n    }\n  }\n\n  /**\n   * Removes an attribute from the element.\n   *\n   * The parameter `attr` is the attribute's name as a string. For example,\n   * calling `myElement.removeAttribute('align')` removes its `align`\n   * attribute if it's been set.\n   *\n   * @param  {String} attr       attribute to remove.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let p;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a paragraph element and place it in the center of the canvas.\n   *   // Set its \"align\" attribute to \"center\".\n   *   p = createP('hi');\n   *   p.position(0, 20);\n   *   p.attribute('align', 'center');\n   *\n   *   describe('The text \"hi\" written in black at the center of a gray square. The text moves to the left edge when double-clicked.');\n   * }\n   *\n   * // Remove the 'align' attribute when the user double-clicks the paragraph.\n   * function doubleClicked() {\n   *   p.removeAttribute('align');\n   * }\n   * </code>\n   * </div>\n   */\n  removeAttribute(attr) {\n    if (\n      this.elt.firstChild != null &&\n      (this.elt.firstChild.type === 'checkbox' ||\n        this.elt.firstChild.type === 'radio')\n    ) {\n      for (let i = 0; i < this.elt.childNodes.length; i++) {\n        this.elt.childNodes[i].removeAttribute(attr);\n      }\n    }\n    this.elt.removeAttribute(attr);\n    return this;\n  }\n\n  /**\n   * Returns or sets the element's value.\n   *\n   * Calling `myElement.value()` returns the element's current value.\n   *\n   * The parameter, `value`, is an optional number or string. If provided,\n   * as in `myElement.value(123)`, it's used to set the element's value.\n   *\n   * @return {String|Number} value of the element.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let input;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a text input and place it beneath the canvas.\n   *   // Set its default value to \"hello\".\n   *   input = createInput('hello');\n   *   input.position(0, 100);\n   *\n   *   describe('The text from an input box is displayed on a gray square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Use the input's value to display a message.\n   *   let msg = input.value();\n   *   text(msg, 0, 55);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let input;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a text input and place it beneath the canvas.\n   *   // Set its default value to \"hello\".\n   *   input = createInput('hello');\n   *   input.position(0, 100);\n   *\n   *   describe('The text from an input box is displayed on a gray square. The text resets to \"hello\" when the user double-clicks the square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Use the input's value to display a message.\n   *   let msg = input.value();\n   *   text(msg, 0, 55);\n   * }\n   *\n   * // Reset the input's value.\n   * function doubleClicked() {\n   *   input.value('hello');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {String|Number}     value\n   * @chainable\n   */\n  value(...args) {\n    if (args.length > 0) {\n      this.elt.value = args[0];\n      return this;\n    } else {\n      if (this.elt.type === 'range') {\n        return parseFloat(this.elt.value);\n      } else return this.elt.value;\n    }\n  }\n\n  /**\n   * Calls a function when the mouse is pressed over the element.\n   *\n   * Calling `myElement.mousePressed(false)` disables the function.\n   *\n   * Note: Some mobile browsers may also trigger this event when the element\n   * receives a quick tap.\n   *\n   * @param  {Function|Boolean} fxn function to call when the mouse is\n   *                                pressed over the element.\n   *                                `false` disables the function.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call randomColor() when the canvas\n   *   // is pressed.\n   *   cnv.mousePressed(randomColor);\n   *\n   *   describe('A gray square changes color when the mouse is pressed.');\n   * }\n   *\n   * // Paint the background either\n   * // red, yellow, blue, or green.\n   * function randomColor() {\n   *   let c = random(['red', 'yellow', 'blue', 'green']);\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   */\n  mousePressed(fxn) {\n    // Prepend the mouse property setters to the event-listener.\n    // This is required so that mouseButton is set correctly prior to calling the callback (fxn).\n    // For details, see https://github.com/processing/p5.js/issues/3087.\n    const eventPrependedFxn = function (event) {\n      this._pInst.mouseIsPressed = true;\n      this._pInst._activePointers.set(event.pointerId, event);\n      this._pInst._setMouseButton(event);\n      this._pInst._updatePointerCoords(event);\n      // Pass along the return-value of the callback:\n      return fxn.call(this, event);\n    };\n    // Pass along the event-prepended form of the callback.\n    Element._adjustListener('pointerdown', eventPrependedFxn, this);\n    return this;\n  }\n\n  /**\n   * Calls a function when the mouse is pressed twice over the element.\n   *\n   * Calling `myElement.doubleClicked(false)` disables the function.\n   *\n   * @param  {Function|Boolean} fxn function to call when the mouse is\n   *                                double clicked over the element.\n   *                                `false` disables the function.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call randomColor() when the\n   *   // canvas is double-clicked.\n   *   cnv.doubleClicked(randomColor);\n   *\n   *   describe('A gray square changes color when the user double-clicks the canvas.');\n   * }\n   *\n   * // Paint the background either\n   * // red, yellow, blue, or green.\n   * function randomColor() {\n   *   let c = random(['red', 'yellow', 'blue', 'green']);\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   */\n  doubleClicked(fxn) {\n    Element._adjustListener('dblclick', fxn, this);\n    return this;\n  }\n\n  /**\n   * Calls a function when the mouse wheel scrolls over the element.\n   *\n   * The callback function, `fxn`, is passed an `event` object. `event` has\n   * two numeric properties, `deltaY` and `deltaX`. `event.deltaY` is\n   * negative if the mouse wheel rotates away from the user. It's positive if\n   * the mouse wheel rotates toward the user. `event.deltaX` is positive if\n   * the mouse wheel moves to the right. It's negative if the mouse wheel moves\n   * to the left.\n   *\n   * Calling `myElement.mouseWheel(false)` disables the function.\n   *\n   * @param  {Function|Boolean} fxn function to call when the mouse wheel is\n   *                                scrolled over the element.\n   *                                `false` disables the function.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call randomColor() when the\n   *   // mouse wheel moves.\n   *   cnv.mouseWheel(randomColor);\n   *\n   *   describe('A gray square changes color when the user scrolls the mouse wheel over the canvas.');\n   * }\n   *\n   * // Paint the background either\n   * // red, yellow, blue, or green.\n   * function randomColor() {\n   *   let c = random(['red', 'yellow', 'blue', 'green']);\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call changeBackground() when the\n   *   // mouse wheel moves.\n   *   cnv.mouseWheel(changeBackground);\n   *\n   *   describe('A gray square. When the mouse wheel scrolls over the square, it changes color and displays shapes.');\n   * }\n   *\n   * function changeBackground(event) {\n   *   // Change the background color\n   *   // based on deltaY.\n   *   if (event.deltaY > 0) {\n   *     background('deeppink');\n   *   } else if (event.deltaY < 0) {\n   *     background('cornflowerblue');\n   *   } else {\n   *     background(200);\n   *   }\n   *\n   *   // Draw a shape based on deltaX.\n   *   if (event.deltaX > 0) {\n   *     circle(50, 50, 20);\n   *   } else if (event.deltaX < 0) {\n   *     square(40, 40, 20);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  mouseWheel(fxn) {\n    Element._adjustListener('wheel', fxn, this);\n    return this;\n  }\n\n  /**\n   * Calls a function when the mouse is released over the element.\n   *\n   * Calling `myElement.mouseReleased(false)` disables the function.\n   *\n   * Note: Some mobile browsers may also trigger this event when the element\n   * receives a quick tap.\n   *\n   * @param  {Function|Boolean} fxn function to call when the mouse is\n   *                                pressed over the element.\n   *                                `false` disables the function.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call randomColor() when a\n   *   // mouse press ends.\n   *   cnv.mouseReleased(randomColor);\n   *\n   *   describe('A gray square changes color when the user releases a mouse press.');\n   * }\n   *\n   * // Paint the background either\n   * // red, yellow, blue, or green.\n   * function randomColor() {\n   *   let c = random(['red', 'yellow', 'blue', 'green']);\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   */\n  mouseReleased(fxn) {\n    Element._adjustListener('pointerup', fxn, this);\n    return this;\n  }\n\n  /**\n   * Calls a function when the mouse is pressed and released over the element.\n   *\n   * Calling `myElement.mouseReleased(false)` disables the function.\n   *\n   * Note: Some mobile browsers may also trigger this event when the element\n   * receives a quick tap.\n   *\n   * @param  {Function|Boolean} fxn function to call when the mouse is\n   *                                pressed and released over the element.\n   *                                `false` disables the function.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call randomColor() when a\n   *   // mouse press ends.\n   *   cnv.mouseClicked(randomColor);\n   *\n   *   describe('A gray square changes color when the user releases a mouse press.');\n   * }\n   *\n   * // Paint the background either\n   * // red, yellow, blue, or green.\n   * function randomColor() {\n   *   let c = random(['red', 'yellow', 'blue', 'green']);\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   */\n  mouseClicked(fxn) {\n    Element._adjustListener('click', fxn, this);\n    return this;\n  }\n\n  /**\n   * Calls a function when the mouse moves over the element.\n   *\n   * Calling `myElement.mouseMoved(false)` disables the function.\n   *\n   * @param  {Function|Boolean} fxn function to call when the mouse\n   *                                moves over the element.\n   *                                `false` disables the function.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call randomColor() when the\n   *   // mouse moves.\n   *   cnv.mouseMoved(randomColor);\n   *\n   *   describe('A gray square changes color when the mouse moves over the canvas.');\n   * }\n   *\n   * // Paint the background either\n   * // red, yellow, blue, or green.\n   * function randomColor() {\n   *   let c = random(['red', 'yellow', 'blue', 'green']);\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   */\n  mouseMoved(fxn) {\n    Element._adjustListener('pointermove', fxn, this);\n    return this;\n  }\n\n  /**\n   * Calls a function when the mouse moves onto the element.\n   *\n   * Calling `myElement.mouseOver(false)` disables the function.\n   *\n   * @param  {Function|Boolean} fxn function to call when the mouse\n   *                                moves onto the element.\n   *                                `false` disables the function.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call randomColor() when the\n   *   // mouse moves onto the canvas.\n   *   cnv.mouseOver(randomColor);\n   *\n   *   describe('A gray square changes color when the mouse moves onto the canvas.');\n   * }\n   *\n   * // Paint the background either\n   * // red, yellow, blue, or green.\n   * function randomColor() {\n   *   let c = random(['red', 'yellow', 'blue', 'green']);\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   */\n  mouseOver(fxn) {\n    Element._adjustListener('pointerover', fxn, this);\n    return this;\n  }\n\n  /**\n   * Calls a function when the mouse moves off the element.\n   *\n   * Calling `myElement.mouseOut(false)` disables the function.\n   *\n   * @param  {Function|Boolean} fxn function to call when the mouse\n   *                                moves off the element.\n   *                                `false` disables the function.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call randomColor() when the\n   *   // mouse moves off the canvas.\n   *   cnv.mouseOut(randomColor);\n   *\n   *   describe('A gray square changes color when the mouse moves off the canvas.');\n   * }\n   *\n   * // Paint the background either\n   * // red, yellow, blue, or green.\n   * function randomColor() {\n   *   let c = random(['red', 'yellow', 'blue', 'green']);\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   */\n  mouseOut(fxn) {\n    Element._adjustListener('pointerout', fxn, this);\n    return this;\n  }\n\n    /**\n   * Calls a function when a file is dragged over the element.\n   *\n   * Calling `myElement.dragOver(false)` disables the function.\n   *\n   * @param  {Function|Boolean} fxn function to call when the file is\n   *                                dragged over the element.\n   *                                `false` disables the function.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Drag a file over the canvas to test.\n   *\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call helloFile() when a\n   *   // file is dragged over\n   *   // the canvas.\n   *   cnv.dragOver(helloFile);\n   *\n   *   describe('A gray square. The text \"hello, file\" appears when a file is dragged over the square.');\n   * }\n   *\n   * function helloFile() {\n   *   text('hello, file', 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  dragOver(fxn) {\n    Element._adjustListener('dragover', fxn, this);\n    return this;\n  }\n\n  /**\n   * Calls a function when a file is dragged off the element.\n   *\n   * Calling `myElement.dragLeave(false)` disables the function.\n   *\n   * @param  {Function|Boolean} fxn function to call when the file is\n   *                                dragged off the element.\n   *                                `false` disables the function.\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * // Drag a file over, then off\n   * // the canvas to test.\n   *\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call byeFile() when a\n   *   // file is dragged over,\n   *   // then off the canvas.\n   *   cnv.dragLeave(byeFile);\n   *\n   *   describe('A gray square. The text \"bye, file\" appears when a file is dragged over, then off the square.');\n   * }\n   *\n   * function byeFile() {\n   *   text('bye, file', 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  dragLeave(fxn) {\n    Element._adjustListener('dragleave', fxn, this);\n    return this;\n  }\n\n  /**\n   * Calls a function when the element changes.\n   *\n   * Calling `myElement.changed(false)` disables the function.\n   *\n   * @param  {Function|Boolean} fxn function to call when the element changes.\n   *                                `false` disables the function.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let dropdown;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a dropdown menu and add a few color options.\n   *   dropdown = createSelect();\n   *   dropdown.position(0, 0);\n   *   dropdown.option('red');\n   *   dropdown.option('green');\n   *   dropdown.option('blue');\n   *\n   *   // Call paintBackground() when the color option changes.\n   *   dropdown.changed(paintBackground);\n   *\n   *   describe('A gray square with a dropdown menu at the top. The square changes color when an option is selected.');\n   * }\n   *\n   * // Paint the background with the selected color.\n   * function paintBackground() {\n   *   let c = dropdown.value();\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let checkbox;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a checkbox and place it beneath the canvas.\n   *   checkbox = createCheckbox(' circle');\n   *   checkbox.position(0, 100);\n   *\n   *   // Call repaint() when the checkbox changes.\n   *   checkbox.changed(repaint);\n   *\n   *   describe('A gray square with a checkbox underneath it that says \"circle\". A white circle appears when the box is checked and disappears otherwise.');\n   * }\n   *\n   * // Paint the background gray and determine whether to draw a circle.\n   * function repaint() {\n   *   background(200);\n   *   if (checkbox.checked() === true) {\n   *     circle(50, 50, 30);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  changed(fxn) {\n    Element._adjustListener('change', fxn, this);\n    return this;\n  }\n\n  /**\n   * Calls a function when the element receives input.\n   *\n   * `myElement.input()` is often used to with text inputs and sliders. Calling\n   * `myElement.input(false)` disables the function.\n   *\n   * @param  {Function|Boolean} fxn function to call when input is detected within\n   *                                the element.\n   *                                `false` disables the function.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let slider;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a slider and place it beneath the canvas.\n   *   slider = createSlider(0, 255, 200);\n   *   slider.position(0, 100);\n   *\n   *   // Call repaint() when the slider changes.\n   *   slider.input(repaint);\n   *\n   *   describe('A gray square with a range slider underneath it. The background changes shades of gray when the slider is moved.');\n   * }\n   *\n   * // Paint the background using slider's value.\n   * function repaint() {\n   *   let g = slider.value();\n   *   background(g);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let input;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an input and place it beneath the canvas.\n   *   input = createInput('');\n   *   input.position(0, 100);\n   *\n   *   // Call repaint() when input is detected.\n   *   input.input(repaint);\n   *\n   *   describe('A gray square with a text input bar beneath it. Any text written in the input appears in the middle of the square.');\n   * }\n   *\n   * // Paint the background gray and display the input's value.\n   * function repaint() {\n   *   background(200);\n   *   let msg = input.value();\n   *   text(msg, 5, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  input(fxn) {\n    Element._adjustListener('input', fxn, this);\n    return this;\n  }\n\n  /**\n   * Calls a function when the user drops a file on the element.\n   *\n   * The first parameter, `callback`, is a function to call once the file loads.\n   * The callback function should have one parameter, `file`, that's a\n   * <a href=\"#/p5.File\">p5.File</a> object. If the user drops multiple files on\n   * the element, `callback`, is called once for each file.\n   *\n   * The second parameter, `fxn`, is a function to call when the browser detects\n   * one or more dropped files. The callback function should have one\n   * parameter, `event`, that's a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/DragEvent\">DragEvent</a>.\n   *\n   * @param  {Function} callback  called when a file loads. Called once for each file dropped.\n   * @param  {Function} [fxn]     called once when any files are dropped.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Drop an image on the canvas to view\n   * // this example.\n   * let img;\n   *\n   * function setup() {\n   *   let c = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call handleFile() when a file that's dropped on the canvas has loaded.\n   *   c.drop(handleFile);\n   *\n   *   describe('A gray square. When the user drops an image on the square, it is displayed.');\n   * }\n   *\n   * // Remove the existing image and display the new one.\n   * function handleFile(file) {\n   *   // Remove the current image, if any.\n   *   if (img) {\n   *     img.remove();\n   *   }\n   *\n   *   // Create an <img> element with the\n   *   // dropped file.\n   *   img = createImg(file.data, '');\n   *   img.hide();\n   *\n   *   // Draw the image.\n   *   image(img, 0, 0, width, height);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Drop an image on the canvas to view\n   * // this example.\n   * let img;\n   * let msg;\n   *\n   * function setup() {\n   *   let c = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Call functions when the user drops a file on the canvas\n   *   // and when the file loads.\n   *   c.drop(handleFile, handleDrop);\n   *\n   *   describe('A gray square. When the user drops an image on the square, it is displayed. The id attribute of canvas element is also displayed.');\n   * }\n   *\n   * // Display the image when it loads.\n   * function handleFile(file) {\n   *   // Remove the current image, if any.\n   *   if (img) {\n   *     img.remove();\n   *   }\n   *\n   *   // Create an img element with the dropped file.\n   *   img = createImg(file.data, '');\n   *   img.hide();\n   *\n   *   // Draw the image.\n   *   image(img, 0, 0, width, height);\n   * }\n   *\n   * // Display the file's name when it loads.\n   * function handleDrop(event) {\n   *   // Remove current paragraph, if any.\n   *   if (msg) {\n   *     msg.remove();\n   *   }\n   *\n   *   // Use event to get the drop target's id.\n   *   let id = event.target.id;\n   *\n   *   // Write the canvas' id beneath it.\n   *   msg = createP(id);\n   *   msg.position(0, 100);\n   *\n   *   // Set the font color randomly for each drop.\n   *   let c = random(['red', 'green', 'blue']);\n   *   msg.style('color', c);\n   *   msg.style('font-size', '12px');\n   * }\n   * </code>\n   * </div>\n   */\n  drop(callback, fxn) {\n    // Is the file stuff supported?\n    if (window.File && window.FileReader && window.FileList && window.Blob) {\n      if (!this._dragDisabled) {\n        this._dragDisabled = true;\n\n        const preventDefault = function (evt) {\n          evt.preventDefault();\n        };\n\n        // If you want to be able to drop you've got to turn off\n        // a lot of default behavior.\n        // avoid `attachListener` here, since it overrides other handlers.\n        this.elt.addEventListener('dragover', preventDefault);\n\n        // If this is a drag area we need to turn off the default behavior\n        this.elt.addEventListener('dragleave', preventDefault);\n      }\n\n      // Deal with the files\n      Element._attachListener(\n        'drop',\n        function (evt) {\n          evt.preventDefault();\n          // Call the second argument as a callback that receives the raw drop event\n          if (typeof fxn === 'function') {\n            fxn.call(this, evt);\n          }\n          // A FileList\n          const files = evt.dataTransfer.files;\n\n          // Load each one and trigger the callback\n          for (const f of files) {\n            File._load(f, callback);\n          }\n        },\n        this\n      );\n    } else {\n      console.log('The File APIs are not fully supported in this browser.');\n    }\n\n    return this;\n  }\n\n  /**\n   * Makes the element draggable.\n   *\n   * The parameter, `elmnt`, is optional. If another\n   * <a href=\"#/p5.Element\">p5.Element</a> object is passed, as in\n   * `myElement.draggable(otherElement)`, the other element will become draggable.\n   *\n   * @param  {p5.Element} [elmnt]  another <a href=\"#/p5.Element\">p5.Element</a>.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let stickyNote;\n   * let textInput;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a div element and style it.\n   *   stickyNote = createDiv('Note');\n   *   stickyNote.position(5, 5);\n   *   stickyNote.size(80, 20);\n   *   stickyNote.style('font-size', '16px');\n   *   stickyNote.style('font-family', 'Comic Sans MS');\n   *   stickyNote.style('background', 'orchid');\n   *   stickyNote.style('padding', '5px');\n   *\n   *   // Make the note draggable.\n   *   stickyNote.draggable();\n   *\n   *   // Create a panel div and style it.\n   *   let panel = createDiv('');\n   *   panel.position(5, 40);\n   *   panel.size(80, 50);\n   *   panel.style('background', 'orchid');\n   *   panel.style('font-size', '16px');\n   *   panel.style('padding', '5px');\n   *   panel.style('text-align', 'center');\n   *\n   *   // Make the panel draggable.\n   *   panel.draggable();\n   *\n   *   // Create a text input and style it.\n   *   textInput = createInput('Note');\n   *   textInput.size(70);\n   *\n   *   // Add the input to the panel.\n   *   textInput.parent(panel);\n   *\n   *   // Call handleInput() when text is input.\n   *   textInput.input(handleInput);\n   *\n   *   describe(\n   *     'A gray square with two purple rectangles that move when dragged. The top rectangle displays the text that is typed into the bottom rectangle.'\n   *   );\n   * }\n   *\n   * // Update stickyNote's HTML when text is input.\n   * function handleInput() {\n   *   stickyNote.html(textInput.value());\n   * }\n   * </code>\n   * </div>\n   */\n  draggable(elmMove) {\n    let isTouch = 'ontouchstart' in window;\n\n    let x = 0,\n      y = 0,\n      px = 0,\n      py = 0,\n      elmDrag,\n      dragMouseDownEvt = isTouch ? 'touchstart' : 'mousedown',\n      closeDragElementEvt = isTouch ? 'touchend' : 'mouseup',\n      elementDragEvt = isTouch ? 'touchmove' : 'mousemove';\n\n    if (elmMove === undefined) {\n      elmMove = this.elt;\n      elmDrag = elmMove;\n    } else if (elmMove !== this.elt && elmMove.elt !== this.elt) {\n      elmMove = elmMove.elt;\n      elmDrag = this.elt;\n    }\n\n    elmDrag.addEventListener(dragMouseDownEvt, dragMouseDown, false);\n    elmDrag.style.cursor = 'move';\n\n    function dragMouseDown(e) {\n      e = e || window.event;\n\n      if (isTouch) {\n        const touches = e.changedTouches;\n        px = parseInt(touches[0].clientX);\n        py = parseInt(touches[0].clientY);\n      } else {\n        px = parseInt(e.clientX);\n        py = parseInt(e.clientY);\n      }\n\n      document.addEventListener(closeDragElementEvt, closeDragElement, false);\n      document.addEventListener(elementDragEvt, elementDrag, false);\n      return false;\n    }\n\n    function elementDrag(e) {\n      e = e || window.event;\n\n      if (isTouch) {\n        const touches = e.changedTouches;\n        x = px - parseInt(touches[0].clientX);\n        y = py - parseInt(touches[0].clientY);\n        px = parseInt(touches[0].clientX);\n        py = parseInt(touches[0].clientY);\n      } else {\n        x = px - parseInt(e.clientX);\n        y = py - parseInt(e.clientY);\n        px = parseInt(e.clientX);\n        py = parseInt(e.clientY);\n      }\n\n      elmMove.style.left = elmMove.offsetLeft - x + 'px';\n      elmMove.style.top = elmMove.offsetTop - y + 'px';\n    }\n\n    function closeDragElement() {\n      document.removeEventListener(closeDragElementEvt, closeDragElement, false);\n      document.removeEventListener(elementDragEvt, elementDrag, false);\n    }\n\n    return this;\n  }\n\n  /**\n   *\n   * @private\n   * @static\n   * @param {String} ev\n   * @param {Boolean|Function} fxn\n   * @param {Element} ctx\n   * @chainable\n   * @alt\n   * General handler for event attaching and detaching\n   */\n  static _adjustListener(ev, fxn, ctx) {\n    if (fxn === false) {\n      Element._detachListener(ev, ctx);\n    } else {\n      Element._attachListener(ev, fxn, ctx);\n    }\n    return this;\n  }\n\n  /**\n   *\n   * @private\n   * @static\n   * @param {String} ev\n   * @param {Function} fxn\n   * @param {Element} ctx\n   */\n  static _attachListener(ev, fxn, ctx) {\n    // detach the old listener if there was one\n    if (ctx._events[ev]) {\n      Element._detachListener(ev, ctx);\n    }\n    const f = fxn.bind(ctx);\n    ctx.elt.addEventListener(ev, f, false);\n    ctx._events[ev] = f;\n  }\n\n  /**\n   *\n   * @private\n   * @static\n   * @param {String} ev\n   * @param {Element} ctx\n   */\n  static _detachListener(ev, ctx) {\n    const f = ctx._events[ev];\n    ctx.elt.removeEventListener(ev, f, false);\n    ctx._events[ev] = null;\n  }\n}\nfunction element(p5, fn){\n  /**\n   * A class to describe an\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Learn/HTML/Introduction_to_HTML/Getting_started\" target=\"_blank\">HTML element</a>.\n   *\n   * Sketches can use many elements. Common elements include the drawing canvas,\n   * buttons, sliders, webcam feeds, and so on.\n   *\n   * All elements share the methods of the `p5.Element` class. They're created\n   * with functions such as <a href=\"#/p5/createCanvas\">createCanvas()</a> and\n   * <a href=\"#/p5/createButton\">createButton()</a>.\n   *\n   * @class p5.Element\n   * @param {HTMLElement} elt wrapped DOM element.\n   * @param {p5} [pInst] pointer to p5 instance.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a button element and\n   *   // place it beneath the canvas.\n   *   let btn = createButton('change');\n   *   btn.position(0, 100);\n   *\n   *   // Call randomColor() when\n   *   // the button is pressed.\n   *   btn.mousePressed(randomColor);\n   *\n   *   describe('A gray square with a button that says \"change\" beneath it. The square changes color when the user presses the button.');\n   * }\n   *\n   * // Paint the background either\n   * // red, yellow, blue, or green.\n   * function randomColor() {\n   *   let c = random(['red', 'yellow', 'blue', 'green']);\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   */\n  p5.Element = Element;\n\n  /**\n   * A `Number` property that stores the element's width.\n   *\n   * @type {Number}\n   * @property width\n   * @for p5.Element\n   */\n\n  /**\n   * A `Number` property that stores the element's height.\n   *\n   * @type {Number}\n   * @property height\n   * @for p5.Element\n   */\n\n  /**\n   * The element's underlying `HTMLElement` object.\n   *\n   * The\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement\" target=\"_blank\">HTMLElement</a>\n   * object's properties and methods can be used directly.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a canvas element and\n   *   // assign it to cnv.\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the border style for the\n   *   // canvas.\n   *   cnv.elt.style.border = '5px dashed deeppink';\n   *\n   *   describe('A gray square with a pink border drawn with dashed lines.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @property elt\n   * @for p5.Element\n   * @name elt\n   * @readOnly\n   */\n}\n\nif(typeof p5 !== 'undefined'){\n  element(p5, p5.prototype);\n}\n\nexport { Element, element as default };\n","/*\n * This module defines the filters for use with image buffers.\n *\n * This module is basically a collection of functions stored in an object\n * as opposed to modules. The functions are destructive, modifying\n * the passed in canvas rather than creating a copy.\n *\n * Generally speaking users of this module will use the Filters.apply method\n * on a canvas to create an effect.\n *\n * A number of functions are borrowed/adapted from\n * http://www.html5rocks.com/en/tutorials/canvas/imagefilters/\n * or the java processing implementation.\n *\n * @private\n */\n\nconst Filters = {\n\n  /*\n   * Helper functions\n   */\n\n  /**\n   * Returns the pixel buffer for a canvas.\n   *\n   * @private\n   *\n   * @param  {Canvas|ImageData} canvas the canvas to get pixels from\n   * @return {Uint8ClampedArray}       a one-dimensional array containing\n   *                                   the data in the RGBA order, with integer\n   *                                   values between 0 and 255.\n   */\n  _toPixels(canvas) {\n    // Return pixel data if 'canvas' is an ImageData object.\n    if (canvas instanceof ImageData) {\n      return canvas.data;\n    } else {\n      // Check 2D context support.\n      if (canvas.getContext('2d')) {\n        // Retrieve pixel data.\n        return canvas\n          .getContext('2d')\n          .getImageData(0, 0, canvas.width, canvas.height).data;\n      } else if (canvas.getContext('webgl')) { //Check WebGL context support\n        const gl = canvas.getContext('webgl');\n        // Calculate the size of pixel data\n        // (4 bytes per pixel - one byte for each RGBA channel).\n        const len = gl.drawingBufferWidth * gl.drawingBufferHeight * 4;\n        const data = new Uint8Array(len);\n        // Use gl.readPixels to fetch pixel data from the WebGL\n        // canvas, storing it in the data array as UNSIGNED_BYTE integers.\n        gl.readPixels(\n          0,\n          0,\n          canvas.width,\n          canvas.height,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          data\n        );\n        return data;\n      }\n    }\n  },\n\n  /**\n   * Returns a 32-bit number containing ARGB data at the ith pixel in the\n   * 1D array containing pixels data.\n   *\n   * @private\n   *\n   * @param  {Uint8ClampedArray} data array returned by _toPixels()\n   * @param  {Integer}           i    index of a 1D Image Array\n   * @return {Integer}                32-bit integer value representing\n   *                                  ARGB value.\n   */\n  _getARGB(data, i) {\n    // Determine the starting position in the 'data' array for the 'i'-th pixel.\n    const offset = i * 4;\n    return (\n      // Combining the extracted components using bitwise OR operations to form the final ARGB value.\n      ((data[offset + 3] << 24) & 0xff000000) | //Extract alpha component\n      ((data[offset] << 16) & 0x00ff0000) | //Extract Red component\n      ((data[offset + 1] << 8) & 0x0000ff00) | //Extract green component\n      (data[offset + 2] & 0x000000ff) //Extract blue component\n    );\n  },\n\n  /**\n   * Modifies pixels RGBA values to values contained in the data object.\n   *\n   * @private\n   *\n   * @param {Uint8ClampedArray} pixels array returned by _toPixels()\n   * @param {Int32Array}        data   source 1D array where each value\n   *                                   represents ARGB values\n   */\n  _setPixels(pixels, data) {\n    let offset = 0;\n    for (let i = 0, al = pixels.length; i < al; i++) {\n      offset = i * 4;\n      pixels[offset + 0] = (data[i] & 0x00ff0000) >>> 16;\n      pixels[offset + 1] = (data[i] & 0x0000ff00) >>> 8;\n      pixels[offset + 2] = data[i] & 0x000000ff;\n      pixels[offset + 3] = (data[i] & 0xff000000) >>> 24;\n    }\n  },\n\n\n  /**\n   * Returns the ImageData object for a canvas.\n   * https://developer.mozilla.org/en-US/docs/Web/API/ImageData\n   *\n   * @private\n   *\n   * @param  {Canvas|ImageData} canvas canvas to get image data from\n   * @return {ImageData}               Holder of pixel data (and width and\n   *                                   height) for a canvas\n   */\n  _toImageData(canvas) {\n    if (canvas instanceof ImageData) {\n      return canvas;\n    } else {\n      return canvas\n        .getContext('2d')\n        .getImageData(0, 0, canvas.width, canvas.height);\n    }\n  },\n\n\n  /**\n   * Returns a blank ImageData object.\n   *\n   * @private\n   *\n   * @param  {Integer} width\n   * @param  {Integer} height\n   * @return {ImageData}\n   */\n  _createImageData(width, height) {\n    Filters._tmpCanvas = document.createElement('canvas');\n    Filters._tmpCtx = Filters._tmpCanvas.getContext('2d');\n    return this._tmpCtx.createImageData(width, height);\n  },\n\n  /**\n   * Applys a filter function to a canvas.\n   *\n   * The difference between this and the actual filter functions defined below\n   * is that the filter functions generally modify the pixel buffer but do\n   * not actually put that data back to the canvas (where it would actually\n   * update what is visible). By contrast this method does make the changes\n   * actually visible in the canvas.\n   *\n   * The apply method is the method that callers of this module would generally\n   * use. It has been separated from the actual filters to support an advanced\n   * use case of creating a filter chain that executes without actually updating\n   * the canvas in between everystep.\n   *\n   * @private\n   * @param  {HTMLCanvasElement} canvas The input canvas to apply the filter on.\n   * @param  {function(ImageData,Object)} func The filter function to apply to the canvas's pixel data.\n   * @param  {Object} filterParam An optional parameter to pass to the filter function.\n   */\n  apply(canvas, func, filterParam) {\n    const pixelsState = canvas.getContext('2d');\n    const imageData = pixelsState.getImageData(\n      0, 0, canvas.width, canvas.height);\n\n    //Filters can either return a new ImageData object, or just modify\n    //the one they received.\n    const newImageData = func(imageData, filterParam);\n    //If new ImageData is returned, replace the canvas's pixel data with it.\n    if (newImageData instanceof ImageData) {\n      pixelsState.putImageData(\n        newImageData,\n        0,\n        0,\n        0,\n        0,\n        canvas.width,\n        canvas.height\n      );\n    } else {  //Restore the original pixel.\n      pixelsState.putImageData(\n        imageData,\n        0,\n        0,\n        0,\n        0,\n        canvas.width,\n        canvas.height\n      );\n    }\n  },\n\n  /*\n   * Filters\n   */\n\n  /**\n   * Converts the image to black and white pixels depending if they are above or\n   * below the threshold defined by the level parameter. The parameter must be\n   * between 0.0 (black) and 1.0 (white). If no level is specified, 0.5 is used.\n   *\n   * Borrowed from http://www.html5rocks.com/en/tutorials/canvas/imagefilters/\n   *\n   * @private\n   * @param  {Canvas} canvas Canvas to apply thershold filter on.\n   * @param  {Float} level Threshold level (0-1).\n   */\n  threshold(canvas, level = 0.5) {\n    const pixels = Filters._toPixels(canvas);\n\n    // Calculate threshold value on a (0-255) scale.\n    const thresh = Math.floor(level * 255);\n\n    for (let i = 0; i < pixels.length; i += 4) {\n      const r = pixels[i];\n      const g = pixels[i + 1];\n      const b = pixels[i + 2];\n      // CIE luminance for RGB\n      const gray = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n      let val;\n      if (gray >= thresh) {\n        val = 255;\n      } else {\n        val = 0;\n      }\n      pixels[i] = pixels[i + 1] = pixels[i + 2] = val; //set pixel to val.\n    }\n  },\n\n  /**\n   * Converts any colors in the image to grayscale equivalents.\n   * No parameter is used.\n   *\n   * Borrowed from http://www.html5rocks.com/en/tutorials/canvas/imagefilters/\n   *\n   * @private\n   * @param {Canvas} canvas Canvas to apply gray filter on.\n   */\n  gray(canvas) {\n    const pixels = Filters._toPixels(canvas);\n\n    for (let i = 0; i < pixels.length; i += 4) {\n      const r = pixels[i];\n      const g = pixels[i + 1];\n      const b = pixels[i + 2];\n\n      // CIE luminance for RGB\n      const gray = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n      pixels[i] = pixels[i + 1] = pixels[i + 2] = gray; // set pixel to gray.\n    }\n  },\n\n  /**\n   * Sets the alpha channel to entirely opaque. No parameter is used.\n   *\n   * @private\n   * @param {Canvas} canvas\n   */\n  opaque(canvas) {\n    const pixels = Filters._toPixels(canvas);\n\n    for (let i = 0; i < pixels.length; i += 4) {\n      pixels[i + 3] = 255;\n    }\n\n    return pixels;\n  },\n\n  /**\n   * Sets each pixel to its inverse value. No parameter is used.\n   * @private\n   * @param  {Canvas} canvas\n   */\n  invert(canvas) {\n    const pixels = Filters._toPixels(canvas);\n\n    for (let i = 0; i < pixels.length; i += 4) {\n      pixels[i] = 255 - pixels[i];\n      pixels[i + 1] = 255 - pixels[i + 1];\n      pixels[i + 2] = 255 - pixels[i + 2];\n    }\n  },\n\n  /**\n   * Limits each channel of the image to the number of colors specified as\n   * the parameter. The parameter can be set to values between 2 and 255, but\n   * results are most noticeable in the lower ranges.\n   *\n   * Adapted from java based processing implementation\n   *\n   * @private\n   * @param  {Canvas} canvas\n   * @param  {Integer} level\n   */\n  posterize(canvas, level = 4) {\n    const pixels = Filters._toPixels(canvas);\n    if (level < 2 || level > 255) {\n      throw new Error(\n        'Level must be greater than 2 and less than 255 for posterize'\n      );\n    }\n\n    const levels1 = level - 1;\n    for (let i = 0; i < pixels.length; i += 4) {\n      const rlevel = pixels[i];\n      const glevel = pixels[i + 1];\n      const blevel = pixels[i + 2];\n\n      // New pixel value by posterizing each color.\n      pixels[i] = ((rlevel * level) >> 8) * 255 / levels1;\n      pixels[i + 1] = ((glevel * level) >> 8) * 255 / levels1;\n      pixels[i + 2] = ((blevel * level) >> 8) * 255 / levels1;\n    }\n  },\n\n  /**\n   * Increases the bright areas in an image.\n   * @private\n   * @param  {Canvas} canvas\n   */\n  dilate(canvas) {\n    const pixels = Filters._toPixels(canvas);\n    let currIdx = 0;\n    const maxIdx = pixels.length ? pixels.length / 4 : 0;\n    const out = new Int32Array(maxIdx);\n    let currRowIdx, maxRowIdx, colOrig, colOut, currLum;\n\n    let idxRight, idxLeft, idxUp, idxDown;\n    let colRight, colLeft, colUp, colDown;\n    let lumRight, lumLeft, lumUp, lumDown;\n    // Iterates through rows of pixels.\n    while (currIdx < maxIdx) {\n      currRowIdx = currIdx;\n      maxRowIdx = currIdx + canvas.width;\n      // Iterates through pixels within the current row.\n      while (currIdx < maxRowIdx) {\n        // Get original color of current pixel.\n        colOrig = colOut = Filters._getARGB(pixels, currIdx);\n        idxLeft = currIdx - 1;\n        idxRight = currIdx + 1;\n        idxUp = currIdx - canvas.width;\n        idxDown = currIdx + canvas.width;\n\n        // Adjust the indices to avoid going out of bounds.\n        if (idxLeft < currRowIdx) {\n          idxLeft = currIdx;\n        }\n        if (idxRight >= maxRowIdx) {\n          idxRight = currIdx;\n        }\n        if (idxUp < 0) {\n          idxUp = 0;\n        }\n        if (idxDown >= maxIdx) {\n          idxDown = currIdx;\n        }\n        colUp = Filters._getARGB(pixels, idxUp);\n        colLeft = Filters._getARGB(pixels, idxLeft);\n        colDown = Filters._getARGB(pixels, idxDown);\n        colRight = Filters._getARGB(pixels, idxRight);\n\n        // Compute luminance\n        currLum =\n          77 * ((colOrig >> 16) & 0xff) +\n          151 * ((colOrig >> 8) & 0xff) +\n          28 * (colOrig & 0xff);\n        lumLeft =\n          77 * ((colLeft >> 16) & 0xff) +\n          151 * ((colLeft >> 8) & 0xff) +\n          28 * (colLeft & 0xff);\n        lumRight =\n          77 * ((colRight >> 16) & 0xff) +\n          151 * ((colRight >> 8) & 0xff) +\n          28 * (colRight & 0xff);\n        lumUp =\n          77 * ((colUp >> 16) & 0xff) +\n          151 * ((colUp >> 8) & 0xff) +\n          28 * (colUp & 0xff);\n        lumDown =\n          77 * ((colDown >> 16) & 0xff) +\n          151 * ((colDown >> 8) & 0xff) +\n          28 * (colDown & 0xff);\n\n        // Update the output color based on the highest luminance value\n        if (lumLeft > currLum) {\n          colOut = colLeft;\n          currLum = lumLeft;\n        }\n        if (lumRight > currLum) {\n          colOut = colRight;\n          currLum = lumRight;\n        }\n        if (lumUp > currLum) {\n          colOut = colUp;\n          currLum = lumUp;\n        }\n        if (lumDown > currLum) {\n          colOut = colDown;\n          currLum = lumDown;\n        }\n        // Store the updated color.\n        out[currIdx++] = colOut;\n      }\n    }\n    Filters._setPixels(pixels, out);\n  },\n\n  /**\n   * Reduces the bright areas in an image.\n   * Similar to `dilate()`, but updates the output color based on the lowest luminance value.\n   * @private\n   * @param  {Canvas} canvas\n   */\n  erode(canvas) {\n    const pixels = Filters._toPixels(canvas);\n    let currIdx = 0;\n    const maxIdx = pixels.length ? pixels.length / 4 : 0;\n    const out = new Int32Array(maxIdx);\n    let currRowIdx, maxRowIdx, colOrig, colOut, currLum;\n    let idxRight, idxLeft, idxUp, idxDown;\n    let colRight, colLeft, colUp, colDown;\n    let lumRight, lumLeft, lumUp, lumDown;\n\n    while (currIdx < maxIdx) {\n      currRowIdx = currIdx;\n      maxRowIdx = currIdx + canvas.width;\n      while (currIdx < maxRowIdx) {\n        colOrig = colOut = Filters._getARGB(pixels, currIdx);\n        idxLeft = currIdx - 1;\n        idxRight = currIdx + 1;\n        idxUp = currIdx - canvas.width;\n        idxDown = currIdx + canvas.width;\n\n        if (idxLeft < currRowIdx) {\n          idxLeft = currIdx;\n        }\n        if (idxRight >= maxRowIdx) {\n          idxRight = currIdx;\n        }\n        if (idxUp < 0) {\n          idxUp = 0;\n        }\n        if (idxDown >= maxIdx) {\n          idxDown = currIdx;\n        }\n        colUp = Filters._getARGB(pixels, idxUp);\n        colLeft = Filters._getARGB(pixels, idxLeft);\n        colDown = Filters._getARGB(pixels, idxDown);\n        colRight = Filters._getARGB(pixels, idxRight);\n\n        //compute luminance\n        currLum =\n          77 * ((colOrig >> 16) & 0xff) +\n          151 * ((colOrig >> 8) & 0xff) +\n          28 * (colOrig & 0xff);\n        lumLeft =\n          77 * ((colLeft >> 16) & 0xff) +\n          151 * ((colLeft >> 8) & 0xff) +\n          28 * (colLeft & 0xff);\n        lumRight =\n          77 * ((colRight >> 16) & 0xff) +\n          151 * ((colRight >> 8) & 0xff) +\n          28 * (colRight & 0xff);\n        lumUp =\n          77 * ((colUp >> 16) & 0xff) +\n          151 * ((colUp >> 8) & 0xff) +\n          28 * (colUp & 0xff);\n        lumDown =\n          77 * ((colDown >> 16) & 0xff) +\n          151 * ((colDown >> 8) & 0xff) +\n          28 * (colDown & 0xff);\n\n        if (lumLeft < currLum) {\n          colOut = colLeft;\n          currLum = lumLeft;\n        }\n        if (lumRight < currLum) {\n          colOut = colRight;\n          currLum = lumRight;\n        }\n        if (lumUp < currLum) {\n          colOut = colUp;\n          currLum = lumUp;\n        }\n        if (lumDown < currLum) {\n          colOut = colDown;\n          currLum = lumDown;\n        }\n        // Store the updated color.\n        out[currIdx++] = colOut;\n      }\n    }\n    Filters._setPixels(pixels, out);\n  },\n\n  blur(canvas, radius) {\n    blurARGB(canvas, radius);\n  }\n};\n\n// BLUR\n\n// Internal kernel stuff for the gaussian blur filter.\nlet blurRadius;\nlet blurKernelSize;\nlet blurKernel;\nlet blurMult;\n\n/*\n * Port of https://github.com/processing/processing/blob/\n * main/core/src/processing/core/PImage.java#L1250\n *\n * Optimized code for building the blur kernel.\n * further optimized blur code (approx. 15% for radius=20)\n * bigger speed gains for larger radii (~30%)\n * added support for various image types (ALPHA, RGB, ARGB)\n * [toxi 050728]\n */\nfunction buildBlurKernel(r) {\n  let radius = (r * 3.5) | 0;\n  radius = radius < 1 ? 1 : radius < 248 ? radius : 248;\n\n  if (blurRadius !== radius) {\n    blurRadius = radius;\n    // Calculating the size of the blur kernel\n    blurKernelSize = (1 + blurRadius) << 1;\n    blurKernel = new Int32Array(blurKernelSize);\n    blurMult = new Array(blurKernelSize);\n    for (let l = 0; l < blurKernelSize; l++) {\n      blurMult[l] = new Int32Array(256);\n    }\n\n    let bk, bki;\n    let bm, bmi;\n    // Generating blur kernel values.\n    for (let i = 1, radiusi = radius - 1; i < radius; i++) {\n      blurKernel[radius + i] = blurKernel[radiusi] = bki = radiusi * radiusi;\n      bm = blurMult[radius + i];\n      bmi = blurMult[radiusi--];\n      for (let j = 0; j < 256; j++) {\n        bm[j] = bmi[j] = bki * j;\n      }\n    }\n    bk = blurKernel[radius] = radius * radius;\n    bm = blurMult[radius];\n\n    for (let k = 0; k < 256; k++) {\n      bm[k] = bk * k;\n    }\n  }\n}\n\n// Port of https://github.com/processing/processing/blob/\n// main/core/src/processing/core/PImage.java#L1433\nfunction blurARGB(canvas, radius) {\n  // Get pixel data.\n  const pixels = Filters._toPixels(canvas);\n  const width = canvas.width;\n  const height = canvas.height;\n  const numPackedPixels = width * height;\n  const argb = new Int32Array(numPackedPixels);\n  for (let j = 0; j < numPackedPixels; j++) {\n    argb[j] = Filters._getARGB(pixels, j);\n  }\n  let sum, cr, cg, cb, ca;\n  let read, ri, ym, ymi, bk0;\n  const a2 = new Int32Array(numPackedPixels);\n  const r2 = new Int32Array(numPackedPixels);\n  const g2 = new Int32Array(numPackedPixels);\n  const b2 = new Int32Array(numPackedPixels);\n  let yi = 0;\n  buildBlurKernel(radius);\n  let x, y, i;\n  let bm;\n  // Horizontal pass.\n  for (y = 0; y < height; y++) {\n    for (x = 0; x < width; x++) {\n      cb = cg = cr = ca = sum = 0;\n      read = x - blurRadius;\n      // Handle edge cases.\n      if (read < 0) {\n        bk0 = -read;\n        read = 0;\n      } else {\n        if (read >= width) {\n          break;\n        }\n        bk0 = 0;\n      }\n      for (i = bk0; i < blurKernelSize; i++) {\n        if (read >= width) {\n          break;\n        }\n        const c = argb[read + yi];\n        bm = blurMult[i];\n        ca += bm[(c & -16777216) >>> 24];\n        cr += bm[(c & 16711680) >> 16];\n        cg += bm[(c & 65280) >> 8];\n        cb += bm[c & 255];\n        sum += blurKernel[i];\n        read++;\n      }\n      ri = yi + x;\n      a2[ri] = ca / sum;\n      r2[ri] = cr / sum;\n      g2[ri] = cg / sum;\n      b2[ri] = cb / sum;\n    }\n    yi += width;\n  }\n  yi = 0;\n  ym = -blurRadius;\n  ymi = ym * width;\n  //  Vertical pass.\n  for (y = 0; y < height; y++) {\n    for (x = 0; x < width; x++) {\n      cb = cg = cr = ca = sum = 0;\n      // Handle edge cases.\n      if (ym < 0) {\n        bk0 = ri = -ym;\n        read = x;\n      } else {\n        if (ym >= height) {\n          break;\n        }\n        bk0 = 0;\n        ri = ym;\n        read = x + ymi;\n      }\n      for (i = bk0; i < blurKernelSize; i++) {\n        if (ri >= height) {\n          break;\n        }\n        bm = blurMult[i];\n        ca += bm[a2[read]];\n        cr += bm[r2[read]];\n        cg += bm[g2[read]];\n        cb += bm[b2[read]];\n        sum += blurKernel[i];\n        ri++;\n        read += width;\n      }\n      // Set final ARGB value\n      argb[x + yi] =\n        ((ca / sum) << 24) |\n        ((cr / sum) << 16) |\n        ((cg / sum) << 8) |\n        (cb / sum);\n    }\n    yi += width;\n    ymi += width;\n    ym++;\n  }\n  Filters._setPixels(pixels, argb);\n}\n\nexport { Filters as default };\n","import { C as Color } from '../creating_reading-BdolPjuO.js';\nimport { Vector } from '../math/p5.Vector.js';\nimport { I as INCLUDE, m as PATH, E as EMPTY_PATH, O as OPEN, n as CLOSE, o as POINTS, L as LINES, p as TRIANGLES, Q as QUADS, q as TRIANGLE_FAN, r as TRIANGLE_STRIP, s as QUAD_STRIP, t as EXCLUDE, J as JOIN } from '../constants-8IpwyBct.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\n\n/**\n * @module Shape\n * @submodule Custom Shapes\n * @for p5\n * @requires core\n * @requires constants\n */\n\n\n// ---- UTILITY FUNCTIONS ----\nfunction polylineLength(vertices) {\n  let length = 0;\n  for (let i = 1; i < vertices.length; i++) {\n    length += vertices[i-1].position.dist(vertices[i].position);\n  }\n  return length;\n}\n\n// ---- GENERAL BUILDING BLOCKS ----\n\nclass Vertex {\n  constructor(properties) {\n    for (const [key, value] of Object.entries(properties)) {\n      this[key] = value;\n    }\n  }\n  /*\n  get array() {\n    // convert to 1D array\n    // call `toArray()` if value is an object with a toArray() method\n    // handle primitive values separately\n    // maybe handle object literals too, with Object.values()?\n    // probably dont need anything else for now?\n  }\n  */\n  // TODO: make sure name of array conversion method is\n  // consistent with any modifications to the names of corresponding\n  // properties of p5.Vector and p5.Color\n}\n\nclass ShapePrimitive {\n  vertices;\n  _shape = null;\n  _primitivesIndex = null;\n  _contoursIndex = null;\n  isClosing = false;\n\n  constructor(...vertices) {\n    if (this.constructor === ShapePrimitive) {\n      throw new Error('ShapePrimitive is an abstract class: it cannot be instantiated.');\n    }\n    if (vertices.length > 0) {\n      this.vertices = vertices;\n    }\n    else {\n      throw new Error('At least one vertex must be passed to the constructor.');\n    }\n  }\n\n  get vertexCount() {\n    return this.vertices.length;\n  }\n\n  get vertexCapacity() {\n    throw new Error('Getter vertexCapacity must be implemented.');\n  }\n\n  get _firstInterpolatedVertex() {\n    return this.startVertex();\n  }\n\n  get canOverrideAnchor() {\n    return false;\n  }\n\n  accept(visitor) {\n    throw new Error('Method accept() must be implemented.');\n  }\n\n  addToShape(shape) {\n    /*\n    TODO:\n    Refactor?\n    Test this method once more primitives are implemented.\n    Test segments separately (Segment adds an extra step to this method).\n    */\n    let lastContour = shape.at(-1);\n\n    if (lastContour.primitives.length === 0) {\n      lastContour.primitives.push(this);\n    } else {\n      // last primitive in shape\n      let lastPrimitive = shape.at(-1, -1);\n      let hasSameType = lastPrimitive instanceof this.constructor;\n      let spareCapacity = lastPrimitive.vertexCapacity -\n                          lastPrimitive.vertexCount;\n\n      // this primitive\n      let pushableVertices;\n      let remainingVertices;\n\n      if (hasSameType && spareCapacity > 0) {\n\n        pushableVertices = this.vertices.splice(0, spareCapacity);\n        remainingVertices = this.vertices;\n        lastPrimitive.vertices.push(...pushableVertices);\n\n        if (remainingVertices.length > 0) {\n          lastContour.primitives.push(this);\n        }\n      }\n      else {\n        lastContour.primitives.push(this);\n      }\n    }\n\n    // if primitive itself was added\n    // (i.e. its individual vertices weren't all added to an existing primitive)\n    // give it a reference to the shape and store its location within the shape\n    let addedToShape = this.vertices.length > 0;\n    if (addedToShape) {\n      let lastContour = shape.at(-1);\n      this._primitivesIndex = lastContour.primitives.length - 1;\n      this._contoursIndex = shape.contours.length - 1;\n      this._shape = shape;\n    }\n\n    return shape.at(-1, -1);\n  }\n\n  get _nextPrimitive() {\n    return this._belongsToShape ?\n      this._shape.at(this._contoursIndex, this._primitivesIndex + 1) :\n      null;\n  }\n\n  get _belongsToShape() {\n    return this._shape !== null;\n  }\n\n  handlesClose() {\n    return false;\n  }\n\n  close(vertex) {\n    throw new Error('Unimplemented!');\n  }\n}\n\nclass Contour {\n  #kind;\n  primitives;\n\n  constructor(kind = PATH) {\n    this.#kind = kind;\n    this.primitives = [];\n  }\n\n  get kind() {\n    const isEmpty = this.primitives.length === 0;\n    const isPath = this.#kind === PATH;\n    return isEmpty && isPath ? EMPTY_PATH : this.#kind;\n  }\n\n  accept(visitor) {\n    for (const primitive of this.primitives) {\n      primitive.accept(visitor);\n    }\n  }\n}\n\n// ---- PATH PRIMITIVES ----\n\nclass Anchor extends ShapePrimitive {\n  #vertexCapacity = 1;\n\n  get vertexCapacity() {\n    return this.#vertexCapacity;\n  }\n\n  accept(visitor) {\n    visitor.visitAnchor(this);\n  }\n\n  getEndVertex() {\n    return this.vertices[0];\n  }\n}\n\n// abstract class\nclass Segment extends ShapePrimitive {\n  constructor(...vertices) {\n    super(...vertices);\n    if (this.constructor === Segment) {\n      throw new Error('Segment is an abstract class: it cannot be instantiated.');\n    }\n  }\n\n  // segments in a shape always have a predecessor\n  // (either an anchor or another segment)\n  get _previousPrimitive() {\n    return this._belongsToShape ?\n      this._shape.at(this._contoursIndex, this._primitivesIndex - 1) :\n      null;\n  }\n\n  getStartVertex() {\n    return this._previousPrimitive.getEndVertex();\n  }\n\n  getEndVertex() {\n    return this.vertices.at(-1);\n  }\n}\n\nclass LineSegment extends Segment {\n  #vertexCapacity = 1;\n\n  get vertexCapacity() {\n    return this.#vertexCapacity;\n  }\n\n  accept(visitor) {\n    visitor.visitLineSegment(this);\n  }\n}\n\nclass BezierSegment extends Segment {\n  #order;\n  #vertexCapacity;\n\n  constructor(order, ...vertices) {\n    super(...vertices);\n\n    // Order m may sometimes be passed as an array [m], since arrays\n    // may be used elsewhere to store order of\n    // Bezier curves and surfaces in a common format\n\n    let numericalOrder = Array.isArray(order) ? order[0] : order;\n    this.#order = numericalOrder;\n    this.#vertexCapacity = numericalOrder;\n  }\n\n  get order() {\n    return this.#order;\n  }\n\n  get vertexCapacity() {\n    return this.#vertexCapacity;\n  }\n\n  #_hullLength;\n  hullLength() {\n    if (this.#_hullLength === undefined) {\n      this.#_hullLength = polylineLength([\n        this.getStartVertex(),\n        ...this.vertices\n      ]);\n    }\n    return this.#_hullLength;\n  }\n\n  accept(visitor) {\n    visitor.visitBezierSegment(this);\n  }\n}\n\n/*\nTo-do: Consider type and end modes -- see #6766\nmay want to use separate classes, but maybe not\n\nFor now, the implementation overrides\nsuper.getEndVertex() in order to preserve current p5\nendpoint behavior, but we're considering defaulting\nto interpolated endpoints (a breaking change)\n*/\nclass SplineSegment extends Segment {\n  #vertexCapacity = Infinity;\n  _splineProperties = {\n    ends: INCLUDE,\n    tightness: 0\n  };\n\n  get vertexCapacity() {\n    return this.#vertexCapacity;\n  }\n\n  accept(visitor) {\n    visitor.visitSplineSegment(this);\n  }\n\n  get _comesAfterSegment() {\n    return this._previousPrimitive instanceof Segment;\n  }\n\n  get canOverrideAnchor() {\n    return this._splineProperties.ends === EXCLUDE;\n  }\n\n  // assuming for now that the first interpolated vertex is always\n  // the second vertex passed to splineVertex()\n  // if this spline segment doesn't follow another segment,\n  // the first vertex is in an anchor\n  get _firstInterpolatedVertex() {\n    if (this._splineProperties.ends === EXCLUDE) {\n      return this._comesAfterSegment ?\n        this.vertices[1] :\n        this.vertices[0];\n    } else {\n      return this.getStartVertex()\n    }\n  }\n\n  get _chainedToSegment() {\n    if (this._belongsToShape && this._comesAfterSegment) {\n      let interpolatedStartPosition = this._firstInterpolatedVertex.position;\n      let predecessorEndPosition = this.getStartVertex().position;\n      return predecessorEndPosition.equals(interpolatedStartPosition);\n    }\n    else {\n      return false;\n    }\n  }\n\n  // extend addToShape() with a warning in case second vertex\n  // doesn't line up with end of last segment\n  addToShape(shape) {\n    const added = super.addToShape(shape);\n    this._splineProperties.ends = shape._splineProperties.ends;\n    this._splineProperties.tightness = shape._splineProperties.tightness;\n\n    if (this._splineProperties.ends !== EXCLUDE) return added;\n\n    let verticesPushed = !this._belongsToShape;\n    let lastPrimitive = shape.at(-1, -1);\n\n    let message = (array1, array2) =>\n      `Spline does not start where previous path segment ends:\n      second spline vertex at (${array1})\n      expected to be at (${array2}).`;\n\n    if (verticesPushed &&\n      // Only check once the first interpolated vertex has been added\n      lastPrimitive.vertices.length === 2 &&\n      lastPrimitive._comesAfterSegment &&\n      !lastPrimitive._chainedToSegment\n    ) {\n      let interpolatedStart = lastPrimitive._firstInterpolatedVertex.position;\n      let predecessorEnd = lastPrimitive.getStartVertex().position;\n\n      console.warn(\n        message(interpolatedStart.array(), predecessorEnd.array())\n      );\n    }\n\n    // Note: Could add a warning in an else-if case for when this spline segment\n    // is added directly to the shape instead of pushing its vertices to\n    // an existing spline segment. However, if we assume addToShape() is called by\n    // splineVertex(), it'd add a new spline segment with only one vertex in that case,\n    // and the check wouldn't be needed yet.\n\n    // TODO: Consider case where positions match but other vertex properties don't.\n    return added;\n  }\n\n  // override method on base class\n  getEndVertex() {\n    if (this._splineProperties.ends === INCLUDE) {\n      return super.getEndVertex();\n    } else if (this._splineProperties.ends === EXCLUDE) {\n      return this.vertices.at(-2);\n    } else {\n      return this.getStartVertex();\n    }\n  }\n\n  getControlPoints() {\n    let points = [];\n\n    if (this._comesAfterSegment) {\n      points.push(this.getStartVertex());\n    }\n    points.push(this.getStartVertex());\n\n    for (const vertex of this.vertices) {\n      points.push(vertex);\n    }\n\n    const prevVertex = this.getStartVertex();\n    if (this._splineProperties.ends === INCLUDE) {\n      points.unshift(prevVertex);\n      points.push(this.vertices.at(-1));\n    } else if (this._splineProperties.ends === JOIN) {\n      points.unshift(this.vertices.at(-1));\n      points.push(prevVertex, this.vertices.at(0));\n    }\n\n    return points;\n  }\n\n  handlesClose() {\n    if (!this._belongsToShape) return false;\n\n    // Only handle closing if the spline is the only thing in its contour after\n    // the anchor\n    const contour = this._shape.at(this._contoursIndex);\n    return contour.primitives.length === 2 && this._primitivesIndex === 1;\n  }\n\n  close() {\n    this._splineProperties.ends = JOIN;\n  }\n}\n\n// ---- ISOLATED PRIMITIVES ----\n\nclass Point extends ShapePrimitive {\n  #vertexCapacity = 1;\n\n  get vertexCapacity() {\n    return this.#vertexCapacity;\n  }\n\n  accept(visitor) {\n    visitor.visitPoint(this);\n  }\n}\n\nclass Line extends ShapePrimitive {\n  #vertexCapacity = 2;\n\n  get vertexCapacity() {\n    return this.#vertexCapacity;\n  }\n\n  accept(visitor) {\n    visitor.visitLine(this);\n  }\n}\n\nclass Triangle extends ShapePrimitive {\n  #vertexCapacity = 3;\n\n  get vertexCapacity() {\n    return this.#vertexCapacity;\n  }\n\n  accept(visitor) {\n    visitor.visitTriangle(this);\n  }\n}\n\nclass Quad extends ShapePrimitive {\n  #vertexCapacity = 4;\n\n  get vertexCapacity() {\n    return this.#vertexCapacity;\n  }\n\n  accept(visitor) {\n    visitor.visitQuad(this);\n  }\n}\n\n// ---- TESSELLATION PRIMITIVES ----\n\nclass TriangleFan extends ShapePrimitive {\n  #vertexCapacity = Infinity;\n\n  get vertexCapacity() {\n    return this.#vertexCapacity;\n  }\n\n  accept(visitor) {\n    visitor.visitTriangleFan(this);\n  }\n}\n\nclass TriangleStrip extends ShapePrimitive {\n  #vertexCapacity = Infinity;\n\n  get vertexCapacity() {\n    return this.#vertexCapacity;\n  }\n\n  accept(visitor) {\n    visitor.visitTriangleStrip(this);\n  }\n}\n\nclass QuadStrip extends ShapePrimitive {\n  #vertexCapacity = Infinity;\n\n  get vertexCapacity() {\n    return this.#vertexCapacity;\n  }\n\n  accept(visitor) {\n    visitor.visitQuadStrip(this);\n  }\n}\n\n// ---- PRIMITIVE SHAPE CREATORS ----\n\nclass PrimitiveShapeCreators {\n  // TODO: make creators private?\n  // That'd probably be better, but for now, it may be convenient to use\n  // native Map properties like size, e.g. for testing, and it's simpler to\n  // not have to wrap all the properties that might be useful\n  creators;\n\n  constructor() {\n    let creators = new Map();\n\n    /* TODO: REFACTOR BASED ON THE CODE BELOW,\n       ONCE CONSTANTS ARE IMPLEMENTED AS SYMBOLS\n\n    // Store Symbols as strings for use in Map keys\n    const EMPTY_PATH = constants.EMPTY_PATH.description;\n    const PATH = constants.PATH.description;\n    //etc.\n\n    creators.set(`vertex-${EMPTY_PATH}`, (...vertices) => new Anchor(...vertices));\n    // etc.\n\n    get(vertexKind, shapeKind) {\n      const key = `${vertexKind}-${shapeKind.description}`;\n      return this.creators.get(key);\n    }\n    // etc.\n    */\n\n    // vertex\n    creators.set(`vertex-${EMPTY_PATH}`, (...vertices) => new Anchor(...vertices));\n    creators.set(`vertex-${PATH}`, (...vertices) => new LineSegment(...vertices));\n    creators.set(`vertex-${POINTS}`, (...vertices) => new Point(...vertices));\n    creators.set(`vertex-${LINES}`, (...vertices) => new Line(...vertices));\n    creators.set(`vertex-${TRIANGLES}`, (...vertices) => new Triangle(...vertices));\n    creators.set(`vertex-${QUADS}`, (...vertices) => new Quad(...vertices));\n    creators.set(`vertex-${TRIANGLE_FAN}`, (...vertices) => new TriangleFan(...vertices));\n    creators.set(`vertex-${TRIANGLE_STRIP}`, (...vertices) => new TriangleStrip(...vertices));\n    creators.set(`vertex-${QUAD_STRIP}`, (...vertices) => new QuadStrip(...vertices));\n\n    // bezierVertex (constructors all take order and vertices so they can be called in a uniform way)\n    creators.set(`bezierVertex-${EMPTY_PATH}`, (order, ...vertices) => new Anchor(...vertices));\n    creators.set(`bezierVertex-${PATH}`, (order, ...vertices) => new BezierSegment(order, ...vertices));\n\n    // splineVertex\n    creators.set(`splineVertex-${EMPTY_PATH}`, (...vertices) => new Anchor(...vertices));\n    creators.set(`splineVertex-${PATH}`, (...vertices) => new SplineSegment(...vertices));\n\n    this.creators = creators;\n  }\n\n  get(vertexKind, shapeKind) {\n    const key = `${vertexKind}-${shapeKind}`;\n    return this.creators.get(key);\n  }\n\n  set(vertexKind, shapeKind, creator) {\n    const key = `${vertexKind}-${shapeKind}`;\n    this.creators.set(key, creator);\n  }\n\n  clear() {\n    this.creators.clear();\n  }\n}\n\n// ---- SHAPE ----\n\n/* Note: It's assumed that Shape instances are always built through\n * their beginShape()/endShape() methods. For example, this ensures\n * that a segment is never the first primitive in a contour (paths\n * always start with an anchor), which simplifies code elsewhere.\n */\nclass Shape {\n  #vertexProperties;\n  #initialVertexProperties;\n  #primitiveShapeCreators;\n  #bezierOrder = 3;\n  kind = null;\n  contours = [];\n  _splineProperties = {\n    tightness: 0,\n    ends: INCLUDE\n  };\n  userVertexProperties = null;\n\n  constructor(\n    vertexProperties,\n    primitiveShapeCreators = new PrimitiveShapeCreators()\n  ) {\n    this.#initialVertexProperties = vertexProperties;\n    this.#vertexProperties = vertexProperties;\n    this.#primitiveShapeCreators = primitiveShapeCreators;\n\n    for (const key in this.#vertexProperties) {\n      if (key !== 'position' && key !== 'textureCoordinates') {\n        this[key] = function(value) {\n          this.#vertexProperties[key] = value;\n        };\n      }\n    }\n  }\n\n  serializeToArray(val) {\n    if (val === null || val === undefined) {\n      return [];\n    } if (val instanceof Number) {\n      return [val];\n    } else if (val instanceof Array) {\n      return val;\n    } else if (val.array instanceof Function) {\n      return val.array();\n    } else {\n      throw new Error(`Can't convert ${val} to array!`);\n    }\n  }\n\n  vertexToArray(vertex) {\n    const array = [];\n    for (const key in this.#vertexProperties) {\n      if (this.userVertexProperties && key in this.userVertexProperties)\n        continue;\n      const val = vertex[key];\n      array.push(...this.serializeToArray(val));\n    }\n    for (const key in this.userVertexProperties) {\n      if (key in vertex) {\n        array.push(...this.serializeToArray(vertex[key]));\n      } else {\n        array.push(...new Array(this.userVertexProperties[key]).fill(0));\n      }\n    }\n    return array;\n  }\n\n  hydrateValue(queue, original) {\n    if (original === null) {\n      return null;\n    } else if (original instanceof Number) {\n      return queue.shift();\n    } else if (original instanceof Array) {\n      const array = [];\n      for (let i = 0; i < original.length; i++) {\n        array.push(queue.shift());\n      }\n      return array;\n    } else if (original instanceof Vector) {\n      return new Vector(queue.shift(), queue.shift(), queue.shift());\n    } else if (original instanceof Color) {\n      // NOTE: Not sure what intention here is, `Color` constructor signature\n      // has changed so needed to be reviewed\n      const array = [\n        queue.shift(),\n        queue.shift(),\n        queue.shift(),\n        queue.shift()\n      ];\n      return new Color(array);\n    }\n  }\n\n  arrayToVertex(array) {\n    const vertex = {};\n    const queue = [...array];\n\n    for (const key in this.#vertexProperties) {\n      if (this.userVertexProperties && key in this.userVertexProperties)\n        continue;\n      const original = this.#vertexProperties[key];\n      vertex[key] = this.hydrateValue(queue, original);\n    }\n    for (const key in this.userVertexProperties) {\n      const original = this.#vertexProperties[key];\n      vertex[key] = this.hydrateValue(queue, original);\n    }\n    return vertex;\n  }\n\n  arrayScale(array, scale) {\n    return array.map(v => v * scale);\n  }\n\n  arraySum(first, ...rest) {\n    return first.map((v, i) => {\n      let result = v;\n      for (let j = 0; j < rest.length; j++) {\n        result += rest[j][i];\n      }\n      return result;\n    });\n  }\n\n  arrayMinus(a, b) {\n    return a.map((v, i) => v - b[i]);\n  }\n\n  evaluateCubicBezier([a, b, c, d], t) {\n    return this.arraySum(\n      this.arrayScale(a, Math.pow(1 - t, 3)),\n      this.arrayScale(b, 3 * Math.pow(1 - t, 2) * t),\n      this.arrayScale(c, 3 * (1 - t) * Math.pow(t, 2)),\n      this.arrayScale(d, Math.pow(t, 3))\n    );\n  }\n\n  evaluateQuadraticBezier([a, b, c], t) {\n    return this.arraySum(\n      this.arrayScale(a, Math.pow(1 - t, 2)),\n      this.arrayScale(b, 2 * (1 - t) * t),\n      this.arrayScale(c, t * t)\n    );\n  }\n\n  /*\n  catmullRomToBezier(vertices, tightness)\n\n  Abbreviated description:\n  Converts a Catmull-Rom spline to a sequence of Bezier curveTo points.\n\n  Parameters:\n  vertices -> Array [v0, v1, v2, v3, ...] of at least four vertices\n  tightness -> Number affecting shape of curve\n\n  Returns:\n  array of Bezier curveTo control points, each represented as [c1, c2, c3][]\n\n  TODO:\n  1. It seems p5 contains code for converting from Catmull-Rom to Bezier in at least two places:\n\n  catmullRomToBezier() is based on code in the legacy endShape() function:\n  https://github.com/processing/p5.js/blob/1b66f097761d3c2057c0cec4349247d6125f93ca/src/core/p5.Renderer2D.js#L859C1-L886C1\n\n  A different conversion can be found elsewhere in p5:\n  https://github.com/processing/p5.js/blob/17304ce9e9ef3f967bd828102a51b62a2d39d4f4/src/typography/p5.Font.js#L1179\n\n  A more careful review and comparison of both implementations would be helpful. They're different. I put\n  catmullRomToBezier() together quickly without checking the math/algorithm, when I made the proof of concept\n  for the refactor.\n\n  2. It may be possible to replace the code in p5.Font.js with the code here, to reduce duplication.\n  */\n  catmullRomToBezier(vertices, tightness) {\n    let s = 1 - tightness;\n    let bezArrays = [];\n\n    for (let i = 0; i + 3 < vertices.length; i++) {\n      const [a, b, c, d] = vertices.slice(i, i + 4);\n      const bezB = this.arraySum(\n        b,\n        this.arrayScale(this.arrayMinus(c, a), s / 6)\n      );\n      const bezC = this.arraySum(\n        c,\n        this.arrayScale(this.arrayMinus(b, d), s / 6)\n      );\n      const bezD = c;\n\n      bezArrays.push([bezB, bezC, bezD]);\n    }\n    return bezArrays;\n  }\n\n  // TODO for at() method:\n\n  // RENAME?\n  // -at() indicates it works like Array.prototype.at(), e.g. with negative indices\n  // -get() may work better if we want to add a corresponding set() method\n  // -a set() method could maybe check for problematic usage (e.g. inserting a Triangle into a PATH)\n  // -renaming or removing would necessitate changes at call sites (it's already in use)\n\n  // REFACTOR?\n\n  // TEST\n  at(contoursIndex, primitivesIndex, verticesIndex) {\n    let contour;\n    let primitive;\n\n    contour = this.contours.at(contoursIndex);\n\n    switch(arguments.length) {\n      case 1:\n        return contour;\n      case 2:\n        return contour.primitives.at(primitivesIndex);\n      case 3:\n        primitive = contour.primitives.at(primitivesIndex);\n        return primitive.vertices.at(verticesIndex);\n    }\n  }\n\n  // maybe call this clear() for consistency with PrimitiveShapeCreators.clear()?\n  // note: p5.Geometry has a reset() method, but also clearColors()\n  // looks like reset() isn't in the public reference, so maybe we can switch\n  // everything to clear()? Not sure if reset/clear is used in other classes,\n  // but it'd be good if geometries and shapes are consistent\n  reset() {\n    this.#vertexProperties = { ...this.#initialVertexProperties };\n    this.kind = null;\n    this.contours = [];\n    this.userVertexProperties = null;\n  }\n\n  vertexProperty(name, data) {\n    this.userVertexProperties = this.userVertexProperties || {};\n    const key = this.vertexPropertyKey(name);\n\n    const dataArray = Array.isArray(data) ? data : [data];\n\n    if (!this.userVertexProperties[key]) {\n      this.userVertexProperties[key] = dataArray.length;\n    }\n    this.#vertexProperties[key] = dataArray;\n}\n  vertexPropertyName(key) {\n    return key.replace(/Src$/, '');\n  }\n  vertexPropertyKey(name) {\n    return name + 'Src';\n  }\n\n  bezierOrder(...order) {\n    this.#bezierOrder = order;\n  }\n\n  splineProperty(key, value) {\n    this._splineProperties[key] = value;\n  }\n\n  splineProperties(values) {\n    if (values) {\n      for (const key in values) {\n        this.splineProperty(key, values[key]);\n      }\n    } else {\n      return this._splineProperties;\n    }\n  }\n\n  /*\n  To-do: Maybe refactor #createVertex() since this has side effects that aren't advertised\n  in the method name?\n  */\n  #createVertex(position, textureCoordinates) {\n    this.#vertexProperties.position = position;\n\n    if (textureCoordinates !== undefined) {\n      this.#vertexProperties.textureCoordinates = textureCoordinates;\n    }\n\n    return new Vertex(this.#vertexProperties);\n  }\n\n  #createPrimitiveShape(vertexKind, shapeKind, ...vertices) {\n    let primitiveShapeCreator = this.#primitiveShapeCreators.get(\n      vertexKind, shapeKind\n    );\n\n    return  vertexKind === 'bezierVertex' ?\n      primitiveShapeCreator(this.#bezierOrder, ...vertices) :\n      primitiveShapeCreator(...vertices);\n  }\n\n  /*\n    #generalVertex() is reused by the special vertex functions,\n    including vertex(), bezierVertex(), splineVertex(), and arcVertex():\n\n    It creates a vertex, builds a primitive including that\n    vertex, and has the primitive add itself to the shape.\n  */\n  #generalVertex(kind, position, textureCoordinates) {\n    let vertexKind = kind;\n    let lastContourKind = this.at(-1).kind;\n    let vertex = this.#createVertex(position, textureCoordinates);\n\n    let primitiveShape = this.#createPrimitiveShape(\n      vertexKind,\n      lastContourKind,\n      vertex\n    );\n\n    return primitiveShape.addToShape(this);\n  }\n\n  vertex(position, textureCoordinates, { isClosing = false } = {}) {\n    const added = this.#generalVertex('vertex', position, textureCoordinates);\n    added.isClosing = isClosing;\n  }\n\n  bezierVertex(position, textureCoordinates) {\n    this.#generalVertex('bezierVertex', position, textureCoordinates);\n  }\n\n  splineVertex(position, textureCoordinates) {\n    this.#generalVertex('splineVertex', position, textureCoordinates);\n  }\n\n  arcVertex(position, textureCoordinates) {\n    this.#generalVertex('arcVertex', position, textureCoordinates);\n  }\n\n  beginContour(shapeKind = PATH) {\n    if (this.at(-1)?.kind === EMPTY_PATH) {\n      this.contours.pop();\n    }\n    this.contours.push(new Contour(shapeKind));\n  }\n\n  endContour(closeMode = OPEN, _index = this.contours.length - 1) {\n    const contour = this.at(_index);\n    if (closeMode === CLOSE) {\n      // shape characteristics\n      const isPath = contour.kind === PATH;\n\n      // anchor characteristics\n      const anchorVertex = this.at(_index, 0, 0);\n      const anchorHasPosition = Object.hasOwn(anchorVertex, 'position');\n      const lastSegment = this.at(_index, -1);\n\n      // close path\n      if (isPath && anchorHasPosition) {\n        if (lastSegment.handlesClose()) {\n          lastSegment.close(anchorVertex);\n        } else {\n          // Temporarily remove contours after the current one so that we add to the original\n          // contour again\n          const rest = this.contours.splice(\n            _index + 1,\n            this.contours.length - _index - 1\n          );\n          const prevVertexProperties = this.#vertexProperties;\n          this.#vertexProperties = { ...prevVertexProperties };\n          for (const key in anchorVertex) {\n            if (['position', 'textureCoordinates'].includes(key)) continue;\n            this.#vertexProperties[key] = anchorVertex[key];\n          }\n          this.vertex(\n            anchorVertex.position,\n            anchorVertex.textureCoordinates,\n            { isClosing: true }\n          );\n          this.#vertexProperties = prevVertexProperties;\n          this.contours.push(...rest);\n        }\n      }\n    }\n  }\n\n  beginShape(shapeKind = PATH) {\n    this.kind = shapeKind;\n    // Implicitly start a contour\n    this.beginContour(shapeKind);\n  }\n  /* TO-DO:\n     Refactor?\n     - Might not need anchorHasPosition.\n     - Might combine conditions at top, and rely on shortcircuiting.\n     Does nothing if shape is not a path or has multiple contours. Might discuss this.\n  */\n  endShape(closeMode = OPEN) {\n    if (closeMode === CLOSE) {\n      // Close the first contour, the one implicitly used for shape data\n      // added without an explicit contour\n      this.endContour(closeMode, 0);\n    }\n  }\n\n  accept(visitor) {\n    for (const contour of this.contours) {\n      contour.accept(visitor);\n    }\n  }\n}\n\n// ---- PRIMITIVE VISITORS ----\n\n// abstract class\nclass PrimitiveVisitor {\n  constructor() {\n    if (this.constructor === PrimitiveVisitor) {\n      throw new Error('PrimitiveVisitor is an abstract class: it cannot be instantiated.');\n    }\n  }\n  // path primitives\n  visitAnchor(anchor) {\n    throw new Error('Method visitAnchor() has not been implemented.');\n  }\n  visitLineSegment(lineSegment) {\n    throw new Error('Method visitLineSegment() has not been implemented.');\n  }\n  visitBezierSegment(bezierSegment) {\n    throw new Error('Method visitBezierSegment() has not been implemented.');\n  }\n  visitSplineSegment(curveSegment) {\n    throw new Error('Method visitSplineSegment() has not been implemented.');\n  }\n  visitArcSegment(arcSegment) {\n    throw new Error('Method visitArcSegment() has not been implemented.');\n  }\n\n  // isolated primitives\n  visitPoint(point) {\n    throw new Error('Method visitPoint() has not been implemented.');\n  }\n  visitLine(line) {\n    throw new Error('Method visitLine() has not been implemented.');\n  }\n  visitTriangle(triangle) {\n    throw new Error('Method visitTriangle() has not been implemented.');\n  }\n  visitQuad(quad) {\n    throw new Error('Method visitQuad() has not been implemented.');\n  }\n\n  // tessellation primitives\n  visitTriangleFan(triangleFan) {\n    throw new Error('Method visitTriangleFan() has not been implemented.');\n  }\n  visitTriangleStrip(triangleStrip) {\n    throw new Error('Method visitTriangleStrip() has not been implemented.');\n  }\n  visitQuadStrip(quadStrip) {\n    throw new Error('Method visitQuadStrip() has not been implemented.');\n  }\n}\n\n// requires testing\nclass PrimitiveToPath2DConverter extends PrimitiveVisitor {\n  path = new Path2D();\n  strokeWeight;\n\n  constructor({ strokeWeight }) {\n    super();\n    this.strokeWeight = strokeWeight;\n  }\n\n  // path primitives\n  visitAnchor(anchor) {\n    let vertex = anchor.getEndVertex();\n    this.path.moveTo(vertex.position.x, vertex.position.y);\n  }\n  visitLineSegment(lineSegment) {\n    if (lineSegment.isClosing) {\n      // The same as lineTo, but it adds a stroke join between this\n      // and the starting vertex rather than having two caps\n      this.path.closePath();\n    } else {\n      let vertex = lineSegment.getEndVertex();\n      this.path.lineTo(vertex.position.x, vertex.position.y);\n    }\n  }\n  visitBezierSegment(bezierSegment) {\n    let [v1, v2, v3] = bezierSegment.vertices;\n\n    switch (bezierSegment.order) {\n      case 2:\n        this.path.quadraticCurveTo(\n          v1.position.x,\n          v1.position.y,\n          v2.position.x,\n          v2.position.y\n        );\n        break;\n      case 3:\n        this.path.bezierCurveTo(\n          v1.position.x,\n          v1.position.y,\n          v2.position.x,\n          v2.position.y,\n          v3.position.x,\n          v3.position.y\n        );\n        break;\n    }\n  }\n  visitSplineSegment(splineSegment) {\n    const shape = splineSegment._shape;\n\n    if (\n      splineSegment._splineProperties.ends === EXCLUDE &&\n      !splineSegment._comesAfterSegment\n    ) {\n      let startVertex = splineSegment._firstInterpolatedVertex;\n      this.path.moveTo(startVertex.position.x, startVertex.position.y);\n    }\n\n    const arrayVertices = splineSegment.getControlPoints().map(\n      v => shape.vertexToArray(v)\n    );\n    let bezierArrays = shape.catmullRomToBezier(\n      arrayVertices,\n      splineSegment._splineProperties.tightness\n    ).map(arr => arr.map(vertArr => shape.arrayToVertex(vertArr)));\n    for (const array of bezierArrays) {\n      const points = array.flatMap(vert => [vert.position.x, vert.position.y]);\n      this.path.bezierCurveTo(...points);\n    }\n  }\n  visitPoint(point) {\n    const { x, y } = point.vertices[0].position;\n    this.path.moveTo(x, y);\n    // Hack: to draw just strokes and not fills, draw a very very tiny line\n    this.path.lineTo(x + 0.00001, y);\n  }\n  visitLine(line) {\n    const { x: x0, y: y0 } = line.vertices[0].position;\n    const { x: x1, y: y1 } = line.vertices[1].position;\n    this.path.moveTo(x0, y0);\n    this.path.lineTo(x1, y1);\n  }\n  visitTriangle(triangle) {\n    const [v0, v1, v2] = triangle.vertices;\n    this.path.moveTo(v0.position.x, v0.position.y);\n    this.path.lineTo(v1.position.x, v1.position.y);\n    this.path.lineTo(v2.position.x, v2.position.y);\n    this.path.closePath();\n  }\n  visitQuad(quad) {\n    const [v0, v1, v2, v3] = quad.vertices;\n    this.path.moveTo(v0.position.x, v0.position.y);\n    this.path.lineTo(v1.position.x, v1.position.y);\n    this.path.lineTo(v2.position.x, v2.position.y);\n    this.path.lineTo(v3.position.x, v3.position.y);\n    this.path.closePath();\n  }\n  visitTriangleFan(triangleFan) {\n    const [v0, ...rest] = triangleFan.vertices;\n    for (let i = 0; i < rest.length - 1; i++) {\n      const v1 = rest[i];\n      const v2 = rest[i + 1];\n      this.path.moveTo(v0.position.x, v0.position.y);\n      this.path.lineTo(v1.position.x, v1.position.y);\n      this.path.lineTo(v2.position.x, v2.position.y);\n      this.path.closePath();\n    }\n  }\n  visitTriangleStrip(triangleStrip) {\n    for (let i = 0; i < triangleStrip.vertices.length - 2; i++) {\n      const v0 = triangleStrip.vertices[i];\n      const v1 = triangleStrip.vertices[i + 1];\n      const v2 = triangleStrip.vertices[i + 2];\n      this.path.moveTo(v0.position.x, v0.position.y);\n      this.path.lineTo(v1.position.x, v1.position.y);\n      this.path.lineTo(v2.position.x, v2.position.y);\n      this.path.closePath();\n    }\n  }\n  visitQuadStrip(quadStrip) {\n    for (let i = 0; i < quadStrip.vertices.length - 3; i += 2) {\n      const v0 = quadStrip.vertices[i];\n      const v1 = quadStrip.vertices[i + 1];\n      const v2 = quadStrip.vertices[i + 2];\n      const v3 = quadStrip.vertices[i + 3];\n      this.path.moveTo(v0.position.x, v0.position.y);\n      this.path.lineTo(v1.position.x, v1.position.y);\n      // These are intentionally out of order to go around the quad\n      this.path.lineTo(v3.position.x, v3.position.y);\n      this.path.lineTo(v2.position.x, v2.position.y);\n      this.path.closePath();\n    }\n  }\n}\n\nclass PrimitiveToVerticesConverter extends PrimitiveVisitor {\n  contours = [];\n  curveDetail;\n\n  constructor({ curveDetail = 1 } = {}) {\n    super();\n    this.curveDetail = curveDetail;\n  }\n\n  lastContour() {\n    return this.contours[this.contours.length - 1];\n  }\n\n  visitAnchor(anchor) {\n    this.contours.push([]);\n    // Weird edge case: if the next segment is a spline, we might\n    // need to jump to a different vertex.\n    const next = anchor._nextPrimitive;\n    if (next?.canOverrideAnchor) {\n      this.lastContour().push(next._firstInterpolatedVertex);\n    } else {\n      this.lastContour().push(anchor.getEndVertex());\n    }\n  }\n  visitLineSegment(lineSegment) {\n    this.lastContour().push(lineSegment.getEndVertex());\n  }\n  visitBezierSegment(bezierSegment) {\n    const contour = this.lastContour();\n    const numPoints = Math.max(\n      1,\n      Math.ceil(bezierSegment.hullLength() * this.curveDetail)\n    );\n    const vertexArrays = [\n      bezierSegment.getStartVertex(),\n      ...bezierSegment.vertices\n    ].map(v => bezierSegment._shape.vertexToArray(v));\n    for (let i = 0; i < numPoints; i++) {\n      const t = (i + 1) / numPoints;\n      contour.push(\n        bezierSegment._shape.arrayToVertex(\n          bezierSegment.order === 3\n            ? bezierSegment._shape.evaluateCubicBezier(vertexArrays, t)\n            : bezierSegment._shape.evaluateQuadraticBezier(vertexArrays, t)\n        )\n      );\n    }\n  }\n  visitSplineSegment(splineSegment) {\n    const shape = splineSegment._shape;\n    const contour = this.lastContour();\n\n    const arrayVertices = splineSegment.getControlPoints().map(\n      v => shape.vertexToArray(v)\n    );\n    let bezierArrays = shape.catmullRomToBezier(\n      arrayVertices,\n      splineSegment._splineProperties.tightness\n    );\n    let startVertex = shape.vertexToArray(splineSegment._firstInterpolatedVertex);\n    for (const array of bezierArrays) {\n      const bezierControls = [startVertex, ...array];\n      const numPoints = Math.max(\n        1,\n        Math.ceil(\n          polylineLength(bezierControls.map(v => shape.arrayToVertex(v))) *\n          this.curveDetail\n        )\n      );\n      for (let i = 0; i < numPoints; i++) {\n        const t = (i + 1) / numPoints;\n        contour.push(\n          shape.arrayToVertex(shape.evaluateCubicBezier(bezierControls, t))\n        );\n      }\n      startVertex = array[2];\n    }\n  }\n  visitPoint(point) {\n    this.contours.push(point.vertices.slice());\n  }\n  visitLine(line) {\n    this.contours.push(line.vertices.slice());\n  }\n  visitTriangle(triangle) {\n    this.contours.push(triangle.vertices.slice());\n  }\n  visitQuad(quad) {\n    this.contours.push(quad.vertices.slice());\n  }\n  visitTriangleFan(triangleFan) {\n    // WebGL itself interprets the vertices as a fan, no reformatting needed\n    this.contours.push(triangleFan.vertices.slice());\n  }\n  visitTriangleStrip(triangleStrip) {\n    // WebGL itself interprets the vertices as a strip, no reformatting needed\n    this.contours.push(triangleStrip.vertices.slice());\n  }\n  visitQuadStrip(quadStrip) {\n    // WebGL itself interprets the vertices as a strip, no reformatting needed\n    this.contours.push(quadStrip.vertices.slice());\n  }\n}\n\nclass PointAtLengthGetter extends PrimitiveVisitor {\n  constructor() {\n    super();\n  }\n}\n\nfunction customShapes(p5, fn) {\n  // ---- GENERAL CLASSES ----\n\n  /**\n     * @private\n     * A class to describe a custom shape made with `beginShape()`/`endShape()`.\n     *\n     * Every `Shape` has a `kind`. The kind takes any value that\n     * can be passed to <a href=\"#/p5/beginShape\">beginShape()</a>:\n     *\n     * - `PATH`\n     * - `POINTS`\n     * - `LINES`\n     * - `TRIANGLES`\n     * - `QUADS`\n     * - `TRIANGLE_FAN`\n     * - `TRIANGLE_STRIP`\n     * - `QUAD_STRIP`\n     *\n     * A `Shape` of any kind consists of `contours`, which can be thought of as\n     * subshapes (shapes inside another shape). Each `contour` is built from\n     * basic shapes called primitives, and each primitive consists of one or more vertices.\n     *\n     * For example, a square can be made from a single path contour with four line-segment\n     * primitives. Each line segment contains a vertex that indicates its endpoint. A square\n     * with a circular hole in it contains the circle in a separate contour.\n     *\n     * By default, each vertex only has a position, but a shape's vertices may have other\n     * properties such as texture coordinates, a normal vector, a fill color, and a stroke color.\n     * The properties every vertex should have may be customized by passing `vertexProperties` to\n     * `createShape()`.\n     *\n     * Once a shape is created and given a name like `myShape`, it can be built up with\n     * methods such as `myShape.beginShape()`, `myShape.vertex()`, and `myShape.endShape()`.\n     *\n     * Vertex functions such as `vertex()` or `bezierVertex()` are used to set the `position`\n     * property of vertices, as well as the `textureCoordinates` property if applicable. Those\n     * properties only apply to a single vertex.\n     *\n     * If `vertexProperties` includes other properties, they are each set by a method of the\n     * same name. For example, if vertices in `myShape` have a `fill`, then that is set with\n     * `myShape.fill()`. In the same way that a <a href=\"#/p5/fill\">fill()</a> may be applied\n     * to one or more shapes, `myShape.fill()` may be applied to one or more vertices.\n     *\n     * @class p5.Shape\n     * @param {Object} [vertexProperties={position: createVector(0, 0)}] vertex properties and their initial values.\n     */\n\n  p5.Shape = Shape;\n\n  /**\n     * @private\n     * A class to describe a contour made with `beginContour()`/`endContour()`.\n     *\n     * Contours may be thought of as shapes inside of other shapes.\n     * For example, a contour may be used to create a hole in a shape that is created\n     * with <a href=\"#/p5/beginShape\">beginShape()</a>/<a href=\"#/p5/endShape\">endShape()</a>.\n     * Multiple contours may be included inside a single shape.\n     *\n     * Contours can have any `kind` that a shape can have:\n     *\n     * - `PATH`\n     * - `POINTS`\n     * - `LINES`\n     * - `TRIANGLES`\n     * - `QUADS`\n     * - `TRIANGLE_FAN`\n     * - `TRIANGLE_STRIP`\n     * - `QUAD_STRIP`\n     *\n     * By default, a contour has the same kind as the shape that contains it, but this\n     * may be changed by passing a different `kind` to <a href=\"#/p5/beginContour\">beginContour()</a>.\n     *\n     * A `Contour` of any kind consists of `primitives`, which are the most basic\n     * shapes that can be drawn. For example, if a contour is a hexagon, then\n     * it's made from six line-segment primitives.\n     *\n     * @class p5.Contour\n     */\n\n  p5.Contour = Contour;\n\n  /**\n     * @private\n     * A base class to describe a shape primitive (a basic shape drawn with\n     * `beginShape()`/`endShape()`).\n     *\n     * Shape primitives are the most basic shapes that can be drawn with\n     * <a href=\"#/p5/beginShape\">beginShape()</a>/<a href=\"#/p5/endShape\">endShape()</a>:\n     *\n     * - segment primitives: line segments, bezier segments, spline segments, and arc segments\n     * - isolated primitives: points, lines, triangles, and quads\n     * - tessellation primitives: triangle fans, triangle strips, and quad strips\n     *\n     * More complex shapes may be created by combining many primitives, possibly of different kinds,\n     * into a single shape.\n     *\n     * In a similar way, every shape primitive is built from one or more vertices.\n     * For example, a point consists of a single vertex, while a triangle consists of three vertices.\n     * Each type of shape primitive has a `vertexCapacity`, which may be `Infinity` (for example, a\n     * spline may consist of any number of vertices). A primitive's `vertexCount` is the number of\n     * vertices it currently contains.\n     *\n     * Each primitive can add itself to a shape with an `addToShape()` method.\n     *\n     * It can also accept visitor objects with an `accept()` method. When a primitive accepts a visitor,\n     * it gives the visitor access to its vertex data. For example, one visitor to a segment might turn\n     * the data into 2D drawing instructions. Another might find a point at a given distance\n     * along the segment.\n     *\n     * @class p5.ShapePrimitive\n     * @abstract\n     */\n\n  p5.ShapePrimitive = ShapePrimitive;\n\n  /**\n     * @private\n     * A class to describe a vertex (a point on a shape), in 2D or 3D.\n     *\n     * Vertices are the basic building blocks of all `p5.Shape` objects, including\n     * shapes made with <a href=\"#/p5/vertex\">vertex()</a>, <a href=\"#/p5/arcVertex\">arcVertex()</a>,\n     * <a href=\"#/p5/bezierVertex\">bezierVertex()</a>, and <a href=\"#/p5/splineVertex\">splineVertex()</a>.\n     *\n     * Like a point on an object in the real world, a vertex may have different properties.\n     * These may include coordinate properties such as `position`, `textureCoordinates`, and `normal`,\n     * color properties such as `fill` and `stroke`, and more.\n     *\n     * A vertex called `myVertex` with position coordinates `(2, 3, 5)` and a green stroke may be created\n     * like this:\n     *\n     * ```js\n     * let myVertex = new p5.Vertex({\n     *   position: createVector(2, 3, 5),\n     *   stroke: color('green')\n     * });\n     * ```\n     *\n     * Any property names may be used. The `p5.Shape` class assumes that if a vertex has a\n     * position or texture coordinates, they are stored in `position` and `textureCoordinates`\n     * properties.\n     *\n     * Property values may be any\n     * <a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Primitive\">JavaScript primitive</a>, any\n     * <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer\">object literal</a>,\n     * or any object with an `array` property.\n     *\n     * For example, if a position is stored as a `p5.Vector` object and a stroke is stored as a `p5.Color` object,\n     * then the `array` properties of those objects will be used by the vertex's own `array` property, which provides\n     * all the vertex data in a single array.\n     *\n     * @class p5.Vertex\n     * @param {Object} [properties={position: createVector(0, 0)}] vertex properties.\n     */\n\n  p5.Vertex = Vertex;\n\n  // ---- PATH PRIMITIVES ----\n\n  /**\n     * @private\n     * A class responsible for...\n     *\n     * @class p5.Anchor\n     * @extends p5.ShapePrimitive\n     * @param {p5.Vertex} vertex the vertex to include in the anchor.\n     */\n\n  p5.Anchor = Anchor;\n\n  /**\n     * @private\n     * A class responsible for...\n     *\n     * Note: When a segment is added to a shape, it's attached to an anchor or another segment.\n     * Adding it to another shape may result in unexpected behavior.\n     *\n     * @class p5.Segment\n     * @extends p5.ShapePrimitive\n     * @param {...p5.Vertex} vertices the vertices to include in the segment.\n     */\n\n  p5.Segment = Segment;\n\n  /**\n     * @private\n     * A class responsible for...\n     *\n     * @class p5.LineSegment\n     * @param {p5.Vertex} vertex the vertex to include in the anchor.\n     */\n\n  p5.LineSegment = LineSegment;\n\n  /**\n     * @private\n     * A class responsible for...\n     */\n\n  p5.BezierSegment = BezierSegment;\n\n  /**\n     * @private\n     * A class responsible for...\n     */\n\n  p5.SplineSegment = SplineSegment;\n\n  // ---- ISOLATED PRIMITIVES ----\n\n  /**\n     * @private\n     * A class responsible for...\n     */\n\n  p5.Point = Point;\n\n  /**\n     * @private\n     * A class responsible for...\n     *\n     * @class p5.Line\n     * @param {...p5.Vertex} vertices the vertices to include in the line.\n     */\n\n  p5.Line = Line;\n\n  /**\n     * @private\n     * A class responsible for...\n     */\n\n  p5.Triangle = Triangle;\n\n  /**\n     * @private\n     * A class responsible for...\n     */\n\n  p5.Quad = Quad;\n\n  // ---- TESSELLATION PRIMITIVES ----\n\n  /**\n     * @private\n     * A class responsible for...\n     */\n\n  p5.TriangleFan = TriangleFan;\n\n  /**\n     * @private\n     * A class responsible for...\n     */\n\n  p5.TriangleStrip = TriangleStrip;\n\n  /**\n     * @private\n     * A class responsible for...\n     */\n\n  p5.QuadStrip = QuadStrip;\n\n  // ---- PRIMITIVE VISITORS ----\n\n  /**\n     * @private\n     * A class responsible for...\n     */\n\n  p5.PrimitiveVisitor = PrimitiveVisitor;\n\n  /**\n     * @private\n     * A class responsible for...\n     *\n     * Notes:\n     * 1. Assumes vertex positions are stored as p5.Vector instances.\n     * 2. Currently only supports position properties of vectors.\n     */\n\n  p5.PrimitiveToPath2DConverter = PrimitiveToPath2DConverter;\n\n  /**\n     * @private\n     * A class responsible for...\n     */\n\n  p5.PrimitiveToVerticesConverter = PrimitiveToVerticesConverter;\n\n  /**\n     * @private\n     * A class responsible for...\n     */\n\n  p5.PointAtLengthGetter = PointAtLengthGetter;\n\n  // ---- FUNCTIONS ----\n\n\n  /**\n   * Influences the shape of the Bzier curve segment in a custom shape.\n   * By default, this is 3; the other possible parameter is 2. This\n   * results in quadratic Bzier curves.\n   *\n   * `bezierVertex()` adds a curved segment to custom shapes. The Bzier curves\n   * it creates are defined like those made by the\n   * <a href=\"#/p5/bezier\">bezier()</a> function. `bezierVertex()` must be\n   * called between the\n   * <a href=\"#/p5/beginShape\">beginShape()</a> and\n   * <a href=\"#/p5/endShape\">endShape()</a> functions. There must be at least\n   * one call to <a href=\"#/p5/vertex\">bezierVertex()</a>, before\n   * a number of `bezierVertex()` calls that is a multiple of the parameter\n   * set by <a href=\"#/p5/bezierOrder\">bezierOrder(...)</a> (default 3).\n   * \n   * Each curve of order 3 requires three calls to `bezierVertex`, so\n   * 2 curves would need 7 calls to `bezierVertex()`:\n   * (1 one initial anchor point, two sets of 3 curves describing the curves)\n   * With `bezierOrder(2)`, two curves would need 5 calls: 1 + 2 + 2. \n   *\n   * Bzier curves can also be drawn in 3D using WebGL mode.\n   *\n   * Note: `bezierVertex()` wont work when an argument is passed to\n   * <a href=\"#/p5/beginShape\">beginShape()</a>.\n   *\n   * @method bezierOrder\n   * @param {Number} order The new order to set. Can be either 2 or 3, by default 3\n   * \n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the shape.\n   *   noFill();\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   * \n   *   // set the order to 2 for a quadratic Bzier curve\n   *   bezierOrder(2);\n   *\n   *   // Add the first anchor point.\n   *   bezierVertex(30, 20);\n   *\n   *   // Add the Bzier vertex.\n   *   bezierVertex(80, 20);\n   *   bezierVertex(50, 50);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('A black curve drawn on a gray square. The curve starts at the top-left corner and ends at the center.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method bezierOrder\n   * @returns {Number} The current Bzier order.\n   */\n  fn.bezierOrder = function(order) {\n    return this._renderer.bezierOrder(order);\n  };\n\n\n \n/**\n   * Connects points with a smooth curve (a spline).\n   *\n   * `splineVertex()` adds a curved segment to custom shapes. \n   * The curve it creates follows the same rules as the ones \n   * made with the <a href=\"#/p5/spline\">spline()</a> function.\n   * `splineVertex()` must be called between the \n   * <a href=\"#/p5/beginShape\">beginShape()</a> and\n   * <a href=\"#/p5/endShape\">endShape()</a> functions.\n   *\n   * Spline curves can form shapes and curves that slope gently. Theyre like\n   * cables that are attached to a set of points. `splineVertex()` draws a smooth \n   * curve through the points you give it.\n   * <a href=\"#/p5/beginShape\">beginShape()</a> and\n   * <a href=\"#/p5/endShape\">endShape()</a> in order to draw a curve:\n   *\n   * \n   * If you provide three points, the spline will pass through them. \n   * It works the same way with any number of points.\n   * \n   * \n   * \n   * ```js\n   * beginShape();\n   *\n   * // Add the first point.\n   * splineVertex(25, 80);\n   *\n   * // Add the second point.\n   * splineVertex(20, 30);\n   *\n   * // Add the last point.\n   * splineVertex(85, 60);\n   *\n   * endShape();\n   * ```\n   * \n   * <img src=\"assets/openCurveSpline.png\"></img>\n   * \n   * \n   * Passing in `CLOSE` to `endShape()` closes the spline smoothly.\n   * ```js\n   * beginShape();\n   * \n   * // Add the first point.\n   * splineVertex(25, 80);\n   * \n   * // Add the second point.\n   * splineVertex(20, 30);\n   * \n   * // Add the second point.\n   * splineVertex(85, 60);\n   * \n   * endShape(CLOSE);\n   * ```\n   * \n   * <img src=\"assets/closeCurveSpline.png\"></img>\n   * \n   * \n   * By default (`ends: INCLUDE`), the curve passes through\n   * all the points you add with `splineVertex()`, similar to \n   * the <a href=\"#/p5/spline\">spline()</a> function. To draw only\n   * the middle span p1->p2 (skipping p0->p1 and p2->p3), set \n   * `splineProperty('ends', EXCLUDE)`. You dont need to duplicate\n   * vertices to draw those spans.\n   * \n   * Spline curves can also be drawn in 3D using WebGL mode. The 3D version of\n   * `splineVertex()` has three arguments because each point has x-, y-, and\n   * z-coordinates. By default, the vertexs z-coordinate is set to 0.\n   *\n   * Note: `splineVertex()` wont work when an argument is passed to\n   * <a href=\"#/p5/beginShape\">beginShape()</a>.\n   *\n   * @method splineVertex\n   * @param {Number} x x-coordinate of the vertex\n   * @param {Number} y y-coordinate of the vertex\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   * \n   *   background(220);\n   *   noFill();\n   *   strokeWeight(1);\n   * \n   *   beginShape();\n   *   splineVertex(25, 80);\n   *   splineVertex(20, 30);\n   *   splineVertex(85, 60);\n   *   endShape();\n   * \n   *   strokeWeight(5);\n   *   stroke(0);\n   * \n   *   point(25, 80);\n   *   point(20, 30);\n   *   point(85, 60);\n   * \n   *   describe(\n   *     'On a gray background, a black spline passes through three marked points.'\n   *   );\n   * }\n   * \n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(220);\n   *\n   *   beginShape();\n   *   splineVertex(25, 80);\n   *   splineVertex(20, 30);\n   *   splineVertex(85, 60);\n   *   endShape(CLOSE);\n   *\n   *   describe(\n   *     'On a gray background, a closed black spline with a white interior forms a triangular shape with smooth corners.'\n   *   );\n   * }\n   * \n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let ringInnerRadius, ringWidth;\n   * let radius, dRadius;\n   * let theta, dTheta;\n   * let time, dTime;\n   * let vertexCount, unit, offset;\n   *\n   * function setup() {\n   *   createCanvas(400, 400);\n   *\n   *   vertexCount = 15;\n   *   unit = createVector(1, 0);\n   *   dTheta = TAU / vertexCount;\n   *   dTime = 0.004;\n   *\n   *   ringInnerRadius = 25;\n   *   ringWidth = 5 * ringInnerRadius;\n   *\n   *   offset = width;\n   *\n   *   describe(\n   *     'A white blob with a black outline changes its shape over time.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(220);\n   *   strokeWeight(2);\n   *   translate(width / 2, height / 2);\n   *\n   *   time = dTime * frameCount;\n   *\n   *   beginShape();\n   *   for (let i = 0; i < vertexCount; i++) {\n   *     unit.rotate(dTheta);\n   *     dRadius = noise(offset + unit.x, offset + unit.y, time) * ringWidth;\n   *     radius = ringInnerRadius + dRadius;\n   *     splineVertex(radius * unit.x, radius * unit.y);\n   *   }\n   *   endShape(CLOSE);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method splineVertex\n   * @param {Number} x\n   * @param {Number} y\n   * @param {Number} [z] z-coordinate of the vertex.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A ghost shape drawn in white on a blue background. When the user drags the mouse, the scene rotates to reveal the outline of a second ghost.');\n   * }\n   *\n   * function draw() {\n   *   background('midnightblue');\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the first ghost.\n   *   noStroke();\n   *   fill('ghostwhite');\n   *\n   *   beginShape();\n   *   splineVertex(-28, 41, 0);\n   *   splineVertex(-28, 41, 0);\n   *   splineVertex(-29, -33, 0);\n   *   splineVertex(18, -31, 0);\n   *   splineVertex(34, 41, 0);\n   *   splineVertex(34, 41, 0);\n   *   endShape();\n   *\n   *   // Draw the second ghost.\n   *   noFill();\n   *   stroke('ghostwhite');\n   *\n   *   beginShape();\n   *   splineVertex(-28, 41, -20);\n   *   splineVertex(-28, 41, -20);\n   *   splineVertex(-29, -33, -20);\n   *   splineVertex(18, -31, -20);\n   *   splineVertex(34, 41, -20);\n   *   splineVertex(34, 41, -20);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method splineVertex\n   * @param {Number} x\n   * @param {Number} y\n   * @param {Number} [u=0]\n   * @param {Number} [v=0]\n   */\n  /**\n   * @method splineVertex\n   * @param {Number} x\n   * @param {Number} y\n   * @param {Number} z\n   * @param {Number} [u=0]\n   * @param {Number} [v=0]\n   */\n  fn.splineVertex = function(...args) {\n    let x = 0, y = 0, z = 0, u = 0, v = 0;\n    if (args.length === 2) {\n      [x, y] = args;\n    } else if (args.length === 4) {\n      [x, y, u, v] = args;\n    } else if (args.length === 3) {\n      [x, y, z] = args;\n    } else if (args.length === 5) {\n      [x, y, z, u, v] = args;\n    }\n    this._renderer.splineVertex(x, y, z, u, v);\n  };\n\n  /**\n   * Gets or sets a given spline property.\n   * \n   * Use `splineProperty()` to adjust the behavior of splines \n   * created with `splineVertex()` or `spline()`. You can control\n   * two key aspects of a spline: its end behavior (`ends`) and\n   * its curvature (`tightness`).\n   * \n   * By default, the ends property is set to `INCLUDE`, which means\n   * the spline passes through every point, including the endpoints.\n   * You can also set it to `EXCLUDE` i.e. `splineProperty('ends', EXCLUDE)`, \n   * which makes the spline pass through all points except the endpoints.\n   * \n   * `INCLUDE` case will have the spline passing through\n   * all points, like this:\n   * \n   * ```js\n   * splineProperty('ends', INCLUDE); // no need to set this, as it is the default\n   * spline(25, 46, 93, 44, 93, 81, 35, 85);\n   * \n   * point(25, 46);\n   * point(93, 44);\n   * point(93, 81);\n   * point(35, 85);\n   * ```\n   * \n   * <img src=\"assets/includeSpline.png\"></img>\n   * \n   * \n   * EXCLUDE case will have the spline passing through\n   * the middle points, like this: \n   * \n   * \n   * ```js\n   * splineProperty('ends', INCLUDE);\n   * spline(25, 46, 93, 44, 93, 81, 35, 85);\n   * \n   * point(25, 46);\n   * point(93, 44);\n   * point(93, 81);\n   * point(35, 85);\n   * ```\n   * \n   * <img src=\"assets/excludeSpline.png\"></img>\n   * \n   * By default, the tightness property is set to `0`, \n   * producing a smooth curve that passes evenly through \n   * the vertices. Negative values make the curve looser,\n   * while positive values make it tighter. Common values \n   * range between -1 and 1, though values outside this \n   * range can also be used for different effects.\n   * \n   * For example, To set tightness, use `splineProperty('tightness', t)`, \n   * (default: t = 0).\n   * \n   * Here's the example showing negetive value of tightness,\n   * which creates a rounder bulge:\n   * \n   * ```js\n   * splineProperty('tightness', -5)\n   * stroke(0);\n   * strokeWeight(2);\n   * spline(25, 46, 93, 44, 93, 81, 35, 85);\n   * ```\n   * \n   * Here's the example showing positive value of tightness,\n   * which makes the curve tighter and more angular:\n   * \n   * ```js\n   * splineProperty('tightness', 5)\n   * stroke(0);\n   * strokeWeight(2);\n   * spline(25, 46, 93, 44, 93, 81, 35, 85);\n   * ```\n   * \n   * In all cases, the splines in p5.js are <a href = \"https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Cardinal_spline\">cardinal splines</a>.\n   * When tightness is 0, these splines are often known as \n   * <a href=\"https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Catmull%E2%80%93Rom_spline\">Catmull-Rom splines</a>\n   * \n   * @method splineProperty\n   * @param {String} property\n   * @param value Value to set the given property to.\n   * \n   * @example\n   * <div>\n   * <code>\n   * // Move the mouse left and right to see the curve change.\n   *\n   * let t;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   * }\n   *\n   * function draw() {\n   *   background(240);\n   *\n   *   t = map(mouseX, 0, width, -5, 5, true);\n   *   splineProperty('tightness', t);\n   *\n   *   noFill();\n   *   stroke(0);\n   *   strokeWeight(2);\n   *\n   *   beginShape();\n   *   splineVertex(10, 26);\n   *   splineVertex(83, 24);\n   *\n   *   splineVertex(83, 61);\n   *   splineVertex(25, 65);\n   *   endShape();\n   *\n   *   push();\n   *   strokeWeight(5);\n   *   point(10, 26);\n   *   point(83, 24);\n   *   point(83, 61);\n   *   point(25, 65);\n   *   pop();\n   *\n   *   fill(0);\n   *   noStroke();\n   *   textSize(10);\n   *   text(`tightness: ${round(t, 1)}`, 15, 90);\n   *   describe('A black spline forms a sideways U shape through four points. The spline passes through the points more loosely as the mouse moves left of center (negative tightness), and more tightly as it moves right of center (positive tightness). The tightness is displayed at the bottom.');\n   * }\n   * </code>\n   * </div>\n   * \n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   * createCanvas(360, 140);\n   * background(240);\n   * noFill();\n   * \n   * // Right panel: ends = INCLUDE (all spans).\n   * push();\n   * translate(10, 10);\n   * stroke(220);\n   * rect(0, 0, 160, 120);\n   * fill(30);\n   * textSize(11);\n   * text('ends: INCLUDE (all spans)', 8, 16);\n   * noFill();\n   * \n   * splineProperty('ends', INCLUDE);\n   * stroke(0);\n   * strokeWeight(2);\n   * spline(25, 46, 93, 44, 93, 81, 35, 85);\n   * \n   * // vertices\n   * strokeWeight(5);\n   * stroke(0);\n   * point(25, 46);\n   * point(93, 44);\n   * point(93, 81);\n   * point(35, 85);\n   * pop();\n   * \n   * // Right panel: ends = EXCLUDE (middle only).\n   * push();\n   * translate(190, 10);\n   * stroke(220);\n   * rect(0, 0, 160, 120);\n   * noStroke();\n   * fill(30);\n   * text('ends: EXCLUDE ', 18, 16);\n   * noFill();\n   * \n   * splineProperty('ends', EXCLUDE);\n   * stroke(0);\n   * strokeWeight(2);\n   * spline(25, 46, 93, 44, 93, 81, 35, 85);\n   * \n   * // vertices\n   * strokeWeight(5);\n   * stroke(0);\n   * point(25, 46);\n   * point(93, 44);\n   * point(93, 81);\n   * point(35, 85);\n   *  pop();\n   * \n   * describe('Left panel shows spline with ends INCLUDE (three spans). Right panel shows EXCLUDE (only the middle span). Four black points mark the vertices.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method splineProperty\n   * @param {String} property\n   * @returns The current value for the given property.\n   */\n  fn.splineProperty = function(property, value) {\n    return this._renderer.splineProperty(property, value);\n  };\n\n  /**\n   * Get or set multiple spline properties at once.\n   * \n   * Similar to <a href=\"#/p5/splineProperty\">splineProperty()</a>:\n   * `splineProperty('tightness', t)` is the same as\n   * `splineProperties({'tightness': t})`\n   * \n   * @method splineProperties\n   * @param {Object} properties An object containing key-value pairs to set.\n   */\n  /**\n   * @method splineProperties\n   * @returns {Object} The current spline properties.\n   */\n  fn.splineProperties = function(values) {\n    return this._renderer.splineProperties(values);\n  };\n\n  /**\n   * Adds a vertex to a custom shape.\n   *\n   * `vertex()` sets the coordinates of vertices drawn between the\n   * <a href=\"#/p5/beginShape\">beginShape()</a> and\n   * <a href=\"#/p5/endShape\">endShape()</a> functions.\n   *\n   * The first two parameters, `x` and `y`, set the x- and y-coordinates of the\n   * vertex.\n   *\n   * The third parameter, `z`, is optional. It sets the z-coordinate of the\n   * vertex in WebGL mode. By default, `z` is 0.\n   *\n   * The fourth and fifth parameters, `u` and `v`, are also optional. They set\n   * the u- and v-coordinates for the vertexs texture when used with\n   * <a href=\"#/p5/endShape\">endShape()</a>. By default, `u` and `v` are both 0.\n   *\n   * @method vertex\n   * @param  {Number} x x-coordinate of the vertex.\n   * @param  {Number} y y-coordinate of the vertex.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the shape.\n   *   strokeWeight(3);\n   *\n   *   // Start drawing the shape.\n   *   // Only draw the vertices.\n   *   beginShape(POINTS);\n   *\n   *   // Add the vertices.\n   *   vertex(30, 20);\n   *   vertex(85, 20);\n   *   vertex(85, 75);\n   *   vertex(30, 75);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('Four black dots that form a square are drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Add vertices.\n   *   vertex(30, 20);\n   *   vertex(85, 20);\n   *   vertex(85, 75);\n   *   vertex(30, 75);\n   *\n   *   // Stop drawing the shape.\n   *   endShape(CLOSE);\n   *\n   *   describe('A white square on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Add vertices.\n   *   vertex(-20, -30, 0);\n   *   vertex(35, -30, 0);\n   *   vertex(35, 25, 0);\n   *   vertex(-20, 25, 0);\n   *\n   *   // Stop drawing the shape.\n   *   endShape(CLOSE);\n   *\n   *   describe('A white square on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white square spins around slowly on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Add vertices.\n   *   vertex(-20, -30, 0);\n   *   vertex(35, -30, 0);\n   *   vertex(35, 25, 0);\n   *   vertex(-20, 25, 0);\n   *\n   *   // Stop drawing the shape.\n   *   endShape(CLOSE);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load an image to apply as a texture.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A photograph of a ceiling rotates slowly against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Style the shape.\n   *   noStroke();\n   *\n   *   // Apply the texture.\n   *   texture(img);\n   *   textureMode(NORMAL);\n   *\n   *   // Start drawing the shape\n   *   beginShape();\n   *\n   *   // Add vertices.\n   *   vertex(-20, -30, 0, 0, 0);\n   *   vertex(35, -30, 0, 1, 0);\n   *   vertex(35, 25, 0, 1, 1);\n   *   vertex(-20, 25, 0, 0, 1);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   * \n   * <div>\n   * <code>\n   * let vid;\n   * function setup() {\n   *   // Load a video and create a p5.MediaElement object.\n   *   vid = createVideo('/assets/fingers.mov');\n   *   createCanvas(100, 100, WEBGL);\n   * \n   *   // Hide the video.\n   *   vid.hide();\n   * \n   *   // Set the video to loop.\n   *   vid.loop();\n   * \n   *   describe('A rectangle with video as texture');\n   * }\n   * \n   * function draw() {\n   *   background(0);\n   * \n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   * \n   *   // Set the texture mode.\n   *   textureMode(NORMAL);\n   * \n   *   // Apply the video as a texture.\n   *   texture(vid);\n   * \n   *   // Draw a custom shape using uv coordinates.\n   *   beginShape();\n   *   vertex(-40, -40, 0, 0);\n   *   vertex(40, -40, 1, 0);\n   *   vertex(40, 40, 1, 1);\n   *   vertex(-40, 40, 0, 1);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method vertex\n   * @param  {Number} x\n   * @param  {Number} y\n   * @param  {Number} [u=0]   u-coordinate of the vertex's texture.\n   * @param  {Number} [v=0]   v-coordinate of the vertex's texture.\n   */\n  /**\n   * @method vertex\n   * @param  {Number} x\n   * @param  {Number} y\n   * @param  {Number} z\n   * @param  {Number} [u=0]   u-coordinate of the vertex's texture.\n   * @param  {Number} [v=0]   v-coordinate of the vertex's texture.\n   */\n  fn.vertex = function(x, y) {\n    let z, u, v;\n\n    // default to (x, y) mode: all other arguments assumed to be 0.\n    z = u = v = 0;\n\n    if (arguments.length === 3) {\n      // (x, y, z) mode: (u, v) assumed to be 0.\n      z = arguments[2];\n    } else if (arguments.length === 4) {\n      // (x, y, u, v) mode: z assumed to be 0.\n      u = arguments[2];\n      v = arguments[3];\n    } else if (arguments.length === 5) {\n      // (x, y, z, u, v) mode\n      z = arguments[2];\n      u = arguments[3];\n      v = arguments[4];\n    }\n    this._renderer.vertex(x, y, z, u, v);\n    return;\n  };\n\n  /**\n   * Begins creating a hole within a flat shape.\n   *\n   * The `beginContour()` and <a href=\"#/p5/endContour\">endContour()</a>\n   * functions allow for creating negative space within custom shapes that are\n   * flat. `beginContour()` begins adding vertices to a negative space and\n   * <a href=\"#/p5/endContour\">endContour()</a> stops adding them.\n   * `beginContour()` and <a href=\"#/p5/endContour\">endContour()</a> must be\n   * called between <a href=\"#/p5/beginShape\">beginShape()</a> and\n   * <a href=\"#/p5/endShape\">endShape()</a>.\n   *\n   * Transformations such as <a href=\"#/p5/translate\">translate()</a>,\n   * <a href=\"#/p5/rotate\">rotate()</a>, and <a href=\"#/p5/scale\">scale()</a>\n   * don't work between `beginContour()` and\n   * <a href=\"#/p5/endContour\">endContour()</a>. It's also not possible to use\n   * other shapes, such as <a href=\"#/p5/ellipse\">ellipse()</a> or\n   * <a href=\"#/p5/rect\">rect()</a>, between `beginContour()` and\n   * <a href=\"#/p5/endContour\">endContour()</a>.\n   *\n   * Note: The vertices that define a negative space must \"wind\" in the opposite\n   * direction from the outer shape. First, draw vertices for the outer shape\n   * clockwise order. Then, draw vertices for the negative space in\n   * counter-clockwise order.\n   *\n   * @method beginContour\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Exterior vertices, clockwise winding.\n   *   vertex(10, 10);\n   *   vertex(90, 10);\n   *   vertex(90, 90);\n   *   vertex(10, 90);\n   *\n   *   // Interior vertices, counter-clockwise winding.\n   *   beginContour();\n   *   vertex(30, 30);\n   *   vertex(30, 70);\n   *   vertex(70, 70);\n   *   vertex(70, 30);\n   *   endContour(CLOSE);\n   *\n   *   // Stop drawing the shape.\n   *   endShape(CLOSE);\n   *\n   *   describe('A white square with a square hole in its center drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white square with a square hole in its center drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Exterior vertices, clockwise winding.\n   *   vertex(-40, -40);\n   *   vertex(40, -40);\n   *   vertex(40, 40);\n   *   vertex(-40, 40);\n   *\n   *   // Interior vertices, counter-clockwise winding.\n   *   beginContour();\n   *   vertex(-20, -20);\n   *   vertex(-20, 20);\n   *   vertex(20, 20);\n   *   vertex(20, -20);\n   *   endContour(CLOSE);\n   *\n   *   // Stop drawing the shape.\n   *   endShape(CLOSE);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.beginContour = function(kind) {\n    this._renderer.beginContour(kind);\n  };\n\n  /**\n   * Stops creating a hole within a flat shape. \n   *\n   * The <a href=\"#/p5/beginContour\">beginContour()</a> and `endContour()`\n   * functions allow for creating negative space within custom shapes that are\n   * flat. <a href=\"#/p5/beginContour\">beginContour()</a> begins adding vertices\n   * to a negative space and `endContour()` stops adding them.\n   * <a href=\"#/p5/beginContour\">beginContour()</a> and `endContour()` must be\n   * called between <a href=\"#/p5/beginShape\">beginShape()</a> and\n   * <a href=\"#/p5/endShape\">endShape()</a>.\n   *\n   *  By default, \n   * the controur has an `OPEN` end, and to close it,\n   * call `endContour(CLOSE)`. The CLOSE contour mode closes splines smoothly.\n   * \n   * Transformations such as <a href=\"#/p5/translate\">translate()</a>,\n   * <a href=\"#/p5/rotate\">rotate()</a>, and <a href=\"#/p5/scale\">scale()</a>\n   * don't work between <a href=\"#/p5/beginContour\">beginContour()</a> and\n   * `endContour()`. It's also not possible to use other shapes, such as\n   * <a href=\"#/p5/ellipse\">ellipse()</a> or <a href=\"#/p5/rect\">rect()</a>,\n   * between <a href=\"#/p5/beginContour\">beginContour()</a> and `endContour()`.\n   *\n   * Note: The vertices that define a negative space must \"wind\" in the opposite\n   * direction from the outer shape. First, draw vertices for the outer shape\n   * clockwise order. Then, draw vertices for the negative space in\n   * counter-clockwise order.\n   *\n   * @method endContour\n   * @param {OPEN|CLOSE} [mode=OPEN] By default, the value is OPEN\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Exterior vertices, clockwise winding.\n   *   vertex(10, 10);\n   *   vertex(90, 10);\n   *   vertex(90, 90);\n   *   vertex(10, 90);\n   *\n   *   // Interior vertices, counter-clockwise winding.\n   *   beginContour();\n   *   vertex(30, 30);\n   *   vertex(30, 70);\n   *   vertex(70, 70);\n   *   vertex(70, 30);\n   *   endContour(CLOSE);\n   *\n   *   // Stop drawing the shape.\n   *   endShape(CLOSE);\n   *\n   *   describe('A white square with a square hole in its center drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white square with a square hole in its center drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Exterior vertices, clockwise winding.\n   *   vertex(-40, -40);\n   *   vertex(40, -40);\n   *   vertex(40, 40);\n   *   vertex(-40, 40);\n   *\n   *   // Interior vertices, counter-clockwise winding.\n   *   beginContour();\n   *   vertex(-20, -20);\n   *   vertex(-20, 20);\n   *   vertex(20, 20);\n   *   vertex(20, -20);\n   *   endContour(CLOSE);\n   *\n   *   // Stop drawing the shape.\n   *   endShape(CLOSE);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.endContour = function(mode = OPEN) {\n    this._renderer.endContour(mode);\n  };\n}\n\nif (typeof p5 !== 'undefined') {\n  customShapes(p5, p5.prototype);\n}\n\nexport { Anchor, BezierSegment, Contour, Line, LineSegment, Point, PointAtLengthGetter, PrimitiveToPath2DConverter, PrimitiveToVerticesConverter, PrimitiveVisitor, Quad, QuadStrip, Segment, Shape, ShapePrimitive, SplineSegment, Triangle, TriangleFan, TriangleStrip, Vertex, customShapes as default };\n","class States {\n  #modified = {};\n\n  constructor(initialState) {\n    for (const key in initialState) {\n      this[key] = initialState[key];\n    }\n  }\n\n  setValue(key, value) {\n    if (!(key in this.#modified)) {\n      this.#modified[key] = this[key];\n    }\n    this[key] = value;\n  }\n\n  getDiff() {\n    const diff = this.#modified;\n    this.#modified = {};\n    return diff;\n  }\n\n  getModified() {\n    return this.#modified;\n  }\n\n  applyDiff(prevModified) {\n    for (const key in this.#modified) {\n      this[key] = this.#modified[key];\n    }\n    this.#modified = prevModified;\n  }\n}\n\nexport { States };\n","import * as fileSaver from 'file-saver';\n\nfunction downloadFile(data, fName, extension) {\n  const fx = _checkFileExtension(fName, extension);\n  const filename = fx[0];\n  let saveData = data;\n\n  if (!(saveData instanceof Blob)) {\n    saveData = new Blob([data]);\n  }\n\n  fileSaver.saveAs(saveData, filename);\n}\n\nfunction _checkFileExtension(filename, extension) {\n  if (!extension || extension === true || extension === 'true') {\n    extension = '';\n  }\n  if (!filename) {\n    filename = 'untitled';\n  }\n  let ext = '';\n  // make sure the file will have a name, see if filename needs extension\n  if (filename && filename.includes('.')) {\n    ext = filename.split('.').pop();\n  }\n  // append extension if it doesn't exist\n  if (extension) {\n    if (ext !== extension) {\n      ext = extension;\n      filename = `${filename}.${ext}`;\n    }\n  }\n  return [filename, ext];\n}\n\nexport { _checkFileExtension, downloadFile };\n","import { C as Color } from './creating_reading-BdolPjuO.js';\nimport { N as NORMAL, am as WORD, an as BASELINE, ao as LEFT, C as CENTER, e as CORNER, I as INCLUDE } from './constants-8IpwyBct.js';\nimport Filters from './image/filters.js';\nimport { Vector } from './math/p5.Vector.js';\nimport { Shape } from './shape/custom_shapes.js';\nimport { States } from './core/States.js';\nimport { _checkFileExtension, downloadFile } from './io/utilities.js';\n\n/**\n * @module Image\n * @submodule Image\n * @requires core\n * @requires constants\n * @requires filters\n */\n\n\nclass Image {\n  constructor(width, height) {\n    this.width = width;\n    this.height = height;\n    this.canvas = document.createElement('canvas');\n    this.canvas.width = this.width;\n    this.canvas.height = this.height;\n    this.drawingContext = this.canvas.getContext('2d');\n    this._pixelsState = this;\n    this._pixelDensity = 1;\n    //Object for working with GIFs, defaults to null\n    this.gifProperties = null;\n    //For WebGL Texturing only: used to determine whether to reupload texture to GPU\n    this._modified = false;\n    this.pixels = [];\n  }\n\n  /**\n   * Gets or sets the pixel density for high pixel density displays.\n   *\n   * By default, the density will be set to 1.\n   *\n   * Call this method with no arguments to get the default density, or pass\n   * in a number to set the density. If a non-positive number is provided,\n   * it defaults to 1.\n   *\n   * @param {Number} [density] A scaling factor for the number of pixels per\n   * side\n   * @returns {Number} The current density if called without arguments, or the instance for chaining if setting density.\n   */\n  pixelDensity(density) {\n    if (typeof density !== 'undefined') {\n    // Setter: set the density and handle resize\n      if (density <= 0) {\n\n        // p5._friendlyParamError(errorObj, 'pixelDensity');\n\n        // Default to 1 in case of an invalid value\n        density = 1;\n      }\n\n      this._pixelDensity = density;\n\n      // Adjust canvas dimensions based on pixel density\n      this.width /= density;\n      this.height /= density;\n\n      return this; // Return the image instance for chaining if needed\n    } else {\n    // Getter: return the default density\n      return this._pixelDensity;\n    }\n  }\n\n  /**\n   * Helper function for animating GIF-based images with time\n   */\n  _animateGif(pInst) {\n    const props = this.gifProperties;\n    const curTime = pInst._lastRealFrameTime || window.performance.now();\n    if (props.lastChangeTime === 0) {\n      props.lastChangeTime = curTime;\n    }\n    if (props.playing) {\n      props.timeDisplayed = curTime - props.lastChangeTime;\n      const curDelay = props.frames[props.displayIndex].delay;\n      if (props.timeDisplayed >= curDelay) {\n        //GIF is bound to 'realtime' so can skip frames\n        const skips = Math.floor(props.timeDisplayed / curDelay);\n        props.timeDisplayed = 0;\n        props.lastChangeTime = curTime;\n        props.displayIndex += skips;\n        props.loopCount = Math.floor(props.displayIndex / props.numFrames);\n        if (props.loopLimit !== null && props.loopCount >= props.loopLimit) {\n          props.playing = false;\n        } else {\n          const ind = props.displayIndex % props.numFrames;\n          this.drawingContext.putImageData(props.frames[ind].image, 0, 0);\n          props.displayIndex = ind;\n          this.setModified(true);\n        }\n      }\n    }\n  }\n\n  /**\n   * Loads the current value of each pixel in the image into the `img.pixels`\n   * array.\n   *\n   * `img.loadPixels()` must be called before reading or modifying pixel\n   * values.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(66, 66);\n   *\n   *   // Load the image's pixels.\n   *   img.loadPixels();\n   *\n   *   // Set the pixels to black.\n   *   for (let x = 0; x < img.width; x += 1) {\n   *     for (let y = 0; y < img.height; y += 1) {\n   *       img.set(x, y, 0);\n   *     }\n   *   }\n   *\n   *   // Update the image.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 17, 17);\n   *\n   *   describe('A black square drawn in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(66, 66);\n   *\n   *   // Load the image's pixels.\n   *   img.loadPixels();\n   *\n   *   for (let i = 0; i < img.pixels.length; i += 4) {\n   *     // Red.\n   *     img.pixels[i] = 0;\n   *     // Green.\n   *     img.pixels[i + 1] = 0;\n   *     // Blue.\n   *     img.pixels[i + 2] = 0;\n   *     // Alpha.\n   *     img.pixels[i + 3] = 255;\n   *   }\n   *\n   *   // Update the image.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 17, 17);\n   *\n   *   describe('A black square drawn in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n  loadPixels() {\n    // Renderer2D.prototype.loadPixels.call(this);\n    const pixelsState = this._pixelsState;\n    const pd = this._pixelDensity;\n    const w = this.width * pd;\n    const h = this.height * pd;\n    const imageData = this.drawingContext.getImageData(0, 0, w, h);\n    // @todo this should actually set pixels per object, so diff buffers can\n    // have diff pixel arrays.\n    pixelsState.imageData = imageData;\n    this.pixels = pixelsState.pixels = imageData.data;\n    this.setModified(true);\n  }\n\n  /**\n   * Updates the canvas with the RGBA values in the\n   * <a href=\"#/p5.Image/pixels\">img.pixels</a> array.\n   *\n   * `img.updatePixels()` only needs to be called after changing values in\n   * the <a href=\"#/p5.Image/pixels\">img.pixels</a> array. Such changes can be\n   * made directly after calling\n   * <a href=\"#/p5.Image/loadPixels\">img.loadPixels()</a> or by calling\n   * <a href=\"#/p5.Image/set\">img.set()</a>.\n   *\n   * The optional parameters `x`, `y`, `width`, and `height` define a\n   * subsection of the image to update. Doing so can improve performance in\n   * some cases.\n   *\n   * If the image was loaded from a GIF, then calling `img.updatePixels()`\n   * will update the pixels in current frame.\n   *\n   * @param {Integer} x x-coordinate of the upper-left corner\n   *                    of the subsection to update.\n   * @param {Integer} y y-coordinate of the upper-left corner\n   *                    of the subsection to update.\n   * @param {Integer} w width of the subsection to update.\n   * @param {Integer} h height of the subsection to update.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(66, 66);\n   *\n   *   // Load the image's pixels.\n   *   img.loadPixels();\n   *\n   *   // Set the pixels to black.\n   *   for (let x = 0; x < img.width; x += 1) {\n   *     for (let y = 0; y < img.height; y += 1) {\n   *       img.set(x, y, 0);\n   *     }\n   *   }\n   *\n   *   // Update the image.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 17, 17);\n   *\n   *   describe('A black square drawn in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(66, 66);\n   *\n   *   // Load the image's pixels.\n   *   img.loadPixels();\n   *\n   *   // Set the pixels to black.\n   *   for (let i = 0; i < img.pixels.length; i += 4) {\n   *     // Red.\n   *     img.pixels[i] = 0;\n   *     // Green.\n   *     img.pixels[i + 1] = 0;\n   *     // Blue.\n   *     img.pixels[i + 2] = 0;\n   *     // Alpha.\n   *     img.pixels[i + 3] = 255;\n   *   }\n   *\n   *   // Update the image.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 17, 17);\n   *\n   *   describe('A black square drawn in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n  updatePixels(x, y, w, h) {\n    // Renderer2D.prototype.updatePixels.call(this, x, y, w, h);\n    const pixelsState = this._pixelsState;\n    const pd = this._pixelDensity;\n    if (\n      x === undefined &&\n      y === undefined &&\n      w === undefined &&\n      h === undefined\n    ) {\n      x = 0;\n      y = 0;\n      w = this.width;\n      h = this.height;\n    }\n    x *= pd;\n    y *= pd;\n    w *= pd;\n    h *= pd;\n\n    if (this.gifProperties) {\n      this.gifProperties.frames[this.gifProperties.displayIndex].image =\n        pixelsState.imageData;\n    }\n\n    this.drawingContext.putImageData(pixelsState.imageData, x, y, 0, 0, w, h);\n    this.setModified(true);\n  }\n\n  /**\n   * Gets a pixel or a region of pixels from the image.\n   *\n   * `img.get()` is easy to use but it's not as fast as\n   * <a href=\"#/p5.Image/pixels\">img.pixels</a>. Use\n   * <a href=\"#/p5.Image/pixels\">img.pixels</a> to read many pixel values.\n   *\n   * The version of `img.get()` with no parameters returns the entire image.\n   *\n   * The version of `img.get()` with two parameters, as in `img.get(10, 20)`,\n   * interprets them as coordinates. It returns an array with the\n   * `[R, G, B, A]` values of the pixel at the given point.\n   *\n   * The version of `img.get()` with four parameters, as in\n   * `img,get(10, 20, 50, 90)`, interprets them as\n   * coordinates and dimensions. The first two parameters are the coordinates\n   * of the upper-left corner of the subsection. The last two parameters are\n   * the width and height of the subsection. It returns a subsection of the\n   * canvas in a new <a href=\"#/p5.Image\">p5.Image</a> object.\n   *\n   * Use `img.get()` instead of <a href=\"#/p5/get\">get()</a> to work directly\n   * with images.\n   *\n   * @param  {Number}               x x-coordinate of the pixel.\n   * @param  {Number}               y y-coordinate of the pixel.\n   * @param  {Number}               w width of the subsection to be returned.\n   * @param  {Number}               h height of the subsection to be returned.\n   * @return {p5.Image}             subsection as a <a href=\"#/p5.Image\">p5.Image</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Copy the image.\n   *   let img2 = get();\n   *\n   *   // Display the copied image on the right.\n   *   image(img2, 50, 0);\n   *\n   *   describe('Two identical mountain landscapes shown side-by-side.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Get a pixel's color.\n   *   let c = img.get(50, 90);\n   *\n   *   // Style the square using the pixel's color.\n   *   fill(c);\n   *   noStroke();\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   *\n   *   describe('A mountain landscape with an olive green square in its center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Copy half of the image.\n   *   let img2 = img.get(0, 0, img.width / 2, img.height / 2);\n   *\n   *   // Display half of the image.\n   *   image(img2, 50, 50);\n   *\n   *   describe('A mountain landscape drawn on top of another mountain landscape.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @return {p5.Image}      whole <a href=\"#/p5.Image\">p5.Image</a>\n   */\n  /**\n   * @param  {Number}        x\n   * @param  {Number}        y\n   * @return {Number[]}      color of the pixel at (x, y) in array format `[R, G, B, A]`.\n   */\n  get(x, y, w, h) {\n    // p5._validateParameters('p5.Image.get', arguments);\n    // return Renderer2D.prototype.get.apply(this, arguments);\n    const pixelsState = this._pixelsState;\n    const pd = this._pixelDensity;\n    const canvas = this.canvas;\n\n    if (typeof x === 'undefined' && typeof y === 'undefined') {\n    // get()\n      x = y = 0;\n      w = pixelsState.width;\n      h = pixelsState.height;\n    } else {\n      x *= pd;\n      y *= pd;\n\n      if (typeof w === 'undefined' && typeof h === 'undefined') {\n      // get(x,y)\n        if (x < 0 || y < 0 || x >= canvas.width || y >= canvas.height) {\n          return [0, 0, 0, 0];\n        }\n\n        return this._getPixel(x, y);\n      }\n    // get(x,y,w,h)\n    }\n\n    const region = new Image(w*pd, h*pd);\n    region.pixelDensity(pd);\n    region.canvas\n      .getContext('2d')\n      .drawImage(canvas, x, y, w * pd, h * pd, 0, 0, w*pd, h*pd);\n\n    return region;\n  }\n\n  _getPixel(x, y) {\n    let imageData, index;\n    imageData = this.drawingContext.getImageData(x, y, 1, 1).data;\n    index = 0;\n    return [\n      imageData[index + 0],\n      imageData[index + 1],\n      imageData[index + 2],\n      imageData[index + 3]\n    ];\n    // return Renderer2D.prototype._getPixel.apply(this, args);\n  }\n\n  /**\n   * Sets the color of one or more pixels within an image.\n   *\n   * `img.set()` is easy to use but it's not as fast as\n   * <a href=\"#/p5.Image/pixels\">img.pixels</a>. Use\n   * <a href=\"#/p5.Image/pixels\">img.pixels</a> to set many pixel values.\n   *\n   * `img.set()` interprets the first two parameters as x- and y-coordinates. It\n   * interprets the last parameter as a grayscale value, a `[R, G, B, A]` pixel\n   * array, a <a href=\"#/p5.Color\">p5.Color</a> object, or another\n   * <a href=\"#/p5.Image\">p5.Image</a> object.\n   *\n   * <a href=\"#/p5.Image/updatePixels\">img.updatePixels()</a> must be called\n   * after using `img.set()` for changes to appear.\n   *\n   * @param {Number}              x x-coordinate of the pixel.\n   * @param {Number}              y y-coordinate of the pixel.\n   * @param {Number|Number[]|Object}   a grayscale value | pixel array |\n   *                                   <a href=\"#/p5.Color\">p5.Color</a> object |\n   *                                   <a href=\"#/p5.Image\">p5.Image</a> to copy.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(100, 100);\n   *\n   *   // Set four pixels to black.\n   *   img.set(30, 20, 0);\n   *   img.set(85, 20, 0);\n   *   img.set(85, 75, 0);\n   *   img.set(30, 75, 0);\n   *\n   *   // Update the image.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('Four black dots arranged in a square drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(100, 100);\n   *\n   *   // Create a p5.Color object.\n   *   let black = color(0);\n   *\n   *   // Set four pixels to black.\n   *   img.set(30, 20, black);\n   *   img.set(85, 20, black);\n   *   img.set(85, 75, black);\n   *   img.set(30, 75, black);\n   *\n   *   // Update the image.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('Four black dots arranged in a square drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(66, 66);\n   *\n   *   // Draw a color gradient.\n   *   for (let x = 0; x < img.width; x += 1) {\n   *     for (let y = 0; y < img.height; y += 1) {\n   *       let c = map(x, 0, img.width, 0, 255);\n   *       img.set(x, y, c);\n   *     }\n   *   }\n   *\n   *   // Update the image.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 17, 17);\n   *\n   *   describe('A square with a horiztonal color gradient from black to white drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Image object.\n   *   let img2 = createImage(100, 100);\n   *\n   *   // Set the blank image's pixels using the landscape.\n   *   img2.set(0, 0, img);\n   *\n   *   // Display the second image.\n   *   image(img2, 0, 0);\n   *\n   *   describe('An image of a mountain landscape.');\n   * }\n   * </code>\n   * </div>\n   */\n  set(x, y, imgOrCol) {\n    // Renderer2D.prototype.set.call(this, x, y, imgOrCol);\n    // round down to get integer numbers\n    x = Math.floor(x);\n    y = Math.floor(y);\n    const pixelsState = this._pixelsState;\n    if (imgOrCol instanceof Image) {\n      this.drawingContext.save();\n      this.drawingContext.setTransform(1, 0, 0, 1, 0, 0);\n      this.drawingContext.scale(\n        this._pixelDensity,\n        this._pixelDensity\n      );\n      this.drawingContext.clearRect(x, y, imgOrCol.width, imgOrCol.height);\n      this.drawingContext.drawImage(imgOrCol.canvas, x, y);\n      this.drawingContext.restore();\n    } else {\n      let r = 0,\n        g = 0,\n        b = 0,\n        a = 0;\n      let idx =\n        4 *\n        (y *\n          this._pixelDensity *\n          (this.width * this._pixelDensity) +\n          x * this._pixelDensity);\n      if (!pixelsState.imageData) {\n        pixelsState.loadPixels();\n      }\n      if (typeof imgOrCol === 'number') {\n        if (idx < pixelsState.pixels.length) {\n          r = imgOrCol;\n          g = imgOrCol;\n          b = imgOrCol;\n          a = 255;\n          //this.updatePixels.call(this);\n        }\n      } else if (Array.isArray(imgOrCol)) {\n        if (imgOrCol.length < 4) {\n          throw new Error('pixel array must be of the form [R, G, B, A]');\n        }\n        if (idx < pixelsState.pixels.length) {\n          r = imgOrCol[0];\n          g = imgOrCol[1];\n          b = imgOrCol[2];\n          a = imgOrCol[3];\n          //this.updatePixels.call(this);\n        }\n      } else if (imgOrCol instanceof p5.Color) {\n        if (idx < pixelsState.pixels.length) {\n          [r, g, b, a] = imgOrCol._getRGBA([255, 255, 255, 255]);\n          //this.updatePixels.call(this);\n        }\n      }\n      // loop over pixelDensity * pixelDensity\n      for (let i = 0; i < this._pixelDensity; i++) {\n        for (let j = 0; j < this._pixelDensity; j++) {\n          // loop over\n          idx =\n            4 *\n            ((y * this._pixelDensity + j) *\n              this.width *\n              this._pixelDensity +\n              (x * this._pixelDensity + i));\n          pixelsState.pixels[idx] = r;\n          pixelsState.pixels[idx + 1] = g;\n          pixelsState.pixels[idx + 2] = b;\n          pixelsState.pixels[idx + 3] = a;\n        }\n      }\n    }\n    this.setModified(true);\n  }\n\n  /**\n   * Resizes the image to a given width and height.\n   *\n   * The image's original aspect ratio can be kept by passing 0 for either\n   * `width` or `height`. For example, calling `img.resize(50, 0)` on an image\n   * that was 500 &times; 300 pixels will resize it to 50 &times; 30 pixels.\n   *\n   * @param {Number} width resized image width.\n   * @param {Number} height resized image height.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Resize the image.\n   *   img.resize(50, 100);\n   *\n   *   // Display the resized image.\n   *   image(img, 0, 0);\n   *\n   *   describe('Two images of a mountain landscape. One copy of the image is squeezed horizontally.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Resize the image, keeping the aspect ratio.\n   *   img.resize(0, 30);\n   *\n   *   // Display the resized image.\n   *   image(img, 0, 0);\n   *\n   *   describe('Two images of a mountain landscape. The small copy of the image covers the top-left corner of the larger image.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Resize the image, keeping the aspect ratio.\n   *   img.resize(60, 0);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('Two images of a mountain landscape. The small copy of the image covers the top-left corner of the larger image.');\n   * }\n   * </code>\n   * </div>\n   */\n  resize(width, height) {\n    // Copy contents to a temporary canvas, resize the original\n    // and then copy back.\n    //\n    // There is a faster approach that involves just one copy and swapping the\n    // this.canvas reference. We could switch to that approach if (as i think\n    // is the case) there an expectation that the user would not hold a\n    // reference to the backing canvas of a p5.Image. But since we do not\n    // enforce that at the moment, I am leaving in the slower, but safer\n    // implementation.\n\n    // auto-resize\n    if (width === 0 && height === 0) {\n      width = this.canvas.width;\n      height = this.canvas.height;\n    } else if (width === 0) {\n      width = this.canvas.width * height / this.canvas.height;\n    } else if (height === 0) {\n      height = this.canvas.height * width / this.canvas.width;\n    }\n\n    width = Math.floor(width);\n    height = Math.floor(height);\n\n    const tempCanvas = document.createElement('canvas');\n    tempCanvas.width = width;\n    tempCanvas.height = height;\n\n    if (this.gifProperties) {\n      const props = this.gifProperties;\n      //adapted from github.com/LinusU/resize-image-data\n      const nearestNeighbor = (src, dst) => {\n        let pos = 0;\n        for (let y = 0; y < dst.height; y++) {\n          for (let x = 0; x < dst.width; x++) {\n            const srcX = Math.floor(x * src.width / dst.width);\n            const srcY = Math.floor(y * src.height / dst.height);\n            let srcPos = (srcY * src.width + srcX) * 4;\n            dst.data[pos++] = src.data[srcPos++]; // R\n            dst.data[pos++] = src.data[srcPos++]; // G\n            dst.data[pos++] = src.data[srcPos++]; // B\n            dst.data[pos++] = src.data[srcPos++]; // A\n          }\n        }\n      };\n      for (let i = 0; i < props.numFrames; i++) {\n        const resizedImageData = this.drawingContext.createImageData(\n          width,\n          height\n        );\n        nearestNeighbor(props.frames[i].image, resizedImageData);\n        props.frames[i].image = resizedImageData;\n      }\n    }\n\n    tempCanvas.getContext('2d').drawImage(\n      this.canvas,\n      0, 0, this.canvas.width, this.canvas.height,\n      0, 0, tempCanvas.width, tempCanvas.height\n    );\n\n    // Resize the original canvas, which will clear its contents\n    this.canvas.width = this.width = width;\n    this.canvas.height = this.height = height;\n\n    //Copy the image back\n    this.drawingContext.drawImage(\n      tempCanvas,\n      0, 0, width, height,\n      0, 0, width, height\n    );\n\n    if (this.pixels.length > 0) {\n      this.loadPixels();\n    }\n\n    this.setModified(true);\n  }\n\n  /**\n   * Copies pixels from a source image to this image.\n   *\n   * The first parameter, `srcImage`, is an optional\n   * <a href=\"#/p5.Image\">p5.Image</a> object to copy. If a source image isn't\n   * passed, then `img.copy()` can copy a region of this image to another\n   * region.\n   *\n   * The next four parameters, `sx`, `sy`, `sw`, and `sh` determine the region\n   * to copy from the source image. `(sx, sy)` is the top-left corner of the\n   * region. `sw` and `sh` are the region's width and height.\n   *\n   * The next four parameters, `dx`, `dy`, `dw`, and `dh` determine the region\n   * of this image to copy into. `(dx, dy)` is the top-left corner of the\n   * region. `dw` and `dh` are the region's width and height.\n   *\n   * Calling `img.copy()` will scale pixels from the source region if it isn't\n   * the same size as the destination region.\n   *\n   * @param  {p5.Image|p5.Element} srcImage source image.\n   * @param  {Integer} sx x-coordinate of the source's upper-left corner.\n   * @param  {Integer} sy y-coordinate of the source's upper-left corner.\n   * @param  {Integer} sw source image width.\n   * @param  {Integer} sh source image height.\n   * @param  {Integer} dx x-coordinate of the destination's upper-left corner.\n   * @param  {Integer} dy y-coordinate of the destination's upper-left corner.\n   * @param  {Integer} dw destination image width.\n   * @param  {Integer} dh destination image height.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Copy one region of the image to another.\n   *   img.copy(7, 22, 10, 10, 35, 25, 50, 50);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Outline the copied region.\n   *   stroke(255);\n   *   noFill();\n   *   square(7, 22, 10);\n   *\n   *   describe('An image of a mountain landscape. A square region is outlined in white. A larger square contains a pixelated view of the outlined region.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let mountains;\n   * let bricks;\n   *\n   * async function setup() {\n   *   // Load the images.\n   *   mountains = await loadImage('assets/rockies.jpg');\n   *   bricks = await loadImage('assets/bricks.jpg');\n   *   createCanvas(100, 100);\n   *\n   *   // Calculate the center of the bricks image.\n   *   let x = bricks.width / 2;\n   *   let y = bricks.height / 2;\n   *\n   *   // Copy the bricks to the mountains image.\n   *   mountains.copy(bricks, 0, 0, x, y, 0, 0, x, y);\n   *\n   *   // Display the mountains image.\n   *   image(mountains, 0, 0);\n   *\n   *   describe('An image of a brick wall drawn at the top-left of an image of a mountain landscape.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {Integer} sx\n   * @param  {Integer} sy\n   * @param  {Integer} sw\n   * @param  {Integer} sh\n   * @param  {Integer} dx\n   * @param  {Integer} dy\n   * @param  {Integer} dw\n   * @param  {Integer} dh\n   */\n  copy(...args) {\n    // NOTE: Duplicate implementation here and pixels.js\n    let srcImage, sx, sy, sw, sh, dx, dy, dw, dh;\n    if (args.length === 9) {\n      srcImage = args[0];\n      sx = args[1];\n      sy = args[2];\n      sw = args[3];\n      sh = args[4];\n      dx = args[5];\n      dy = args[6];\n      dw = args[7];\n      dh = args[8];\n    } else if (args.length === 8) {\n      srcImage = this;\n      sx = args[0];\n      sy = args[1];\n      sw = args[2];\n      sh = args[3];\n      dx = args[4];\n      dy = args[5];\n      dw = args[6];\n      dh = args[7];\n    } else {\n      throw new Error('Signature not supported');\n    }\n\n    this._copyHelper(this, srcImage, sx, sy, sw, sh, dx, dy, dw, dh);\n  }\n\n  _copyHelper(\n    dstImage,\n    srcImage,\n    sx,\n    sy,\n    sw,\n    sh,\n    dx,\n    dy,\n    dw,\n    dh\n  ){\n    const s = srcImage.canvas.width / srcImage.width;\n    // adjust coord system for 3D when renderer\n    // ie top-left = -width/2, -height/2\n    let sxMod = 0;\n    let syMod = 0;\n    if (srcImage._renderer && srcImage._renderer.isP3D) {\n      sxMod = srcImage.width / 2;\n      syMod = srcImage.height / 2;\n    }\n    if (dstImage._renderer && dstImage._renderer.isP3D) {\n      dstImage.push();\n      dstImage.resetMatrix();\n      dstImage.noLights();\n      dstImage.blendMode(dstImage.BLEND);\n      dstImage.imageMode(dstImage.CORNER);\n      dstImage._renderer.image(\n        srcImage,\n        sx + sxMod,\n        sy + syMod,\n        sw,\n        sh,\n        dx,\n        dy,\n        dw,\n        dh\n      );\n      dstImage.pop();\n    } else {\n      dstImage.drawingContext.drawImage(\n        srcImage.canvas,\n        s * (sx + sxMod),\n        s * (sy + syMod),\n        s * sw,\n        s * sh,\n        dx,\n        dy,\n        dw,\n        dh\n      );\n    }\n  }\n\n  /**\n   * Masks part of the image with another.\n   *\n   * `img.mask()` uses another <a href=\"#/p5.Image\">p5.Image</a> object's\n   * alpha channel as the alpha channel for this image. Masks are cumulative\n   * and can't be removed once applied. If the mask has a different\n   * pixel density from this image, the mask will be scaled.\n   *\n   * @param {p5.Image} srcImage source image.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let photo;\n   * let maskImage;\n   *\n   * async function setup() {\n   *   // Load the images.\n   *   photo = await loadImage('assets/rockies.jpg');\n   *   maskImage = await loadImage('assets/mask2.png');\n   *   createCanvas(100, 100);\n   *\n   *   // Apply the mask.\n   *   photo.mask(maskImage);\n   *\n   *   // Display the image.\n   *   image(photo, 0, 0);\n   *\n   *   describe('An image of a mountain landscape. The right side of the image has a faded patch of white.');\n   * }\n   * </code>\n   * </div>\n   */\n  // TODO: - Accept an array of alpha values.\n  mask(p5Image) {\n    if (p5Image === undefined) {\n      p5Image = this;\n    }\n    const currBlend = this.drawingContext.globalCompositeOperation;\n\n    let imgScaleFactor = this._pixelDensity;\n    let maskScaleFactor = 1;\n    if (p5Image instanceof Renderer) {\n      maskScaleFactor = p5Image._pInst._renderer._pixelDensity;\n    }\n\n    const copyArgs = [\n      p5Image,\n      0,\n      0,\n      maskScaleFactor * p5Image.width,\n      maskScaleFactor * p5Image.height,\n      0,\n      0,\n      imgScaleFactor * this.width,\n      imgScaleFactor * this.height\n    ];\n\n    this.drawingContext.globalCompositeOperation = 'destination-in';\n    if (this.gifProperties) {\n      for (let i = 0; i < this.gifProperties.frames.length; i++) {\n        this.drawingContext.putImageData(\n          this.gifProperties.frames[i].image,\n          0,\n          0\n        );\n        this.copy(...copyArgs);\n        this.gifProperties.frames[i].image = this.drawingContext.getImageData(\n          0,\n          0,\n          imgScaleFactor * this.width,\n          imgScaleFactor * this.height\n        );\n      }\n      this.drawingContext.putImageData(\n        this.gifProperties.frames[this.gifProperties.displayIndex].image,\n        0,\n        0\n      );\n    } else {\n      this.copy(...copyArgs);\n    }\n    this.drawingContext.globalCompositeOperation = currBlend;\n    this.setModified(true);\n  }\n\n  /**\n   * Applies an image filter to the image.\n   *\n   * The preset options are:\n   *\n   * `INVERT`\n   * Inverts the colors in the image. No parameter is used.\n   *\n   * `GRAY`\n   * Converts the image to grayscale. No parameter is used.\n   *\n   * `THRESHOLD`\n   * Converts the image to black and white. Pixels with a grayscale value\n   * above a given threshold are converted to white. The rest are converted to\n   * black. The threshold must be between 0.0 (black) and 1.0 (white). If no\n   * value is specified, 0.5 is used.\n   *\n   * `OPAQUE`\n   * Sets the alpha channel to be entirely opaque. No parameter is used.\n   *\n   * `POSTERIZE`\n   * Limits the number of colors in the image. Each color channel is limited to\n   * the number of colors specified. Values between 2 and 255 are valid, but\n   * results are most noticeable with lower values. The default value is 4.\n   *\n   * `BLUR`\n   * Blurs the image. The level of blurring is specified by a blur radius. Larger\n   * values increase the blur. The default value is 4. A gaussian blur is used\n   * in `P2D` mode. A box blur is used in `WEBGL` mode.\n   *\n   * `ERODE`\n   * Reduces the light areas. No parameter is used.\n   *\n   * `DILATE`\n   * Increases the light areas. No parameter is used.\n   *\n   * @param  {(THRESHOLD|GRAY|OPAQUE|INVERT|POSTERIZE|ERODE|DILATE|BLUR)} filterType  either THRESHOLD, GRAY, OPAQUE, INVERT,\n   *                                POSTERIZE, ERODE, DILATE or BLUR.\n   * @param  {Number} [filterParam] parameter unique to each filter.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Apply the INVERT filter.\n   *   img.filter(INVERT);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('A blue brick wall.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Apply the GRAY filter.\n   *   img.filter(GRAY);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('A brick wall drawn in grayscale.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Apply the THRESHOLD filter.\n   *   img.filter(THRESHOLD);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('A brick wall drawn in black and white.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Apply the OPAQUE filter.\n   *   img.filter(OPAQUE);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('A red brick wall.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Apply the POSTERIZE filter.\n   *   img.filter(POSTERIZE, 3);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('An image of a red brick wall drawn with a limited color palette.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Apply the BLUR filter.\n   *   img.filter(BLUR, 3);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('A blurry image of a red brick wall.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Apply the DILATE filter.\n   *   img.filter(DILATE);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('A red brick wall with bright lines between each brick.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Apply the ERODE filter.\n   *   img.filter(ERODE);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('A red brick wall with faint lines between each brick.');\n   * }\n   * </code>\n   * </div>\n   */\n  filter(operation, value) {\n    Filters.apply(this.canvas, Filters[operation], value);\n    this.setModified(true);\n  }\n\n  /**\n   * Copies a region of pixels from another image into this one.\n   *\n    * The first parameter, `srcImage`, is the\n   * <a href=\"#/p5.Image\">p5.Image</a> object to blend.\n   *\n   * The next four parameters, `sx`, `sy`, `sw`, and `sh` determine the region\n   * to blend from the source image. `(sx, sy)` is the top-left corner of the\n   * region. `sw` and `sh` are the regions width and height.\n   *\n   * The next four parameters, `dx`, `dy`, `dw`, and `dh` determine the region\n   * of the canvas to blend into. `(dx, dy)` is the top-left corner of the\n   * region. `dw` and `dh` are the regions width and height.\n   *\n   * The tenth parameter, `blendMode`, sets the effect used to blend the images'\n   * colors. The options are `BLEND`, `DARKEST`, `LIGHTEST`, `DIFFERENCE`,\n   * `MULTIPLY`, `EXCLUSION`, `SCREEN`, `REPLACE`, `OVERLAY`, `HARD_LIGHT`,\n   * `SOFT_LIGHT`, `DODGE`, `BURN`, `ADD`, or `NORMAL`.\n   *\n   * @param  {p5.Image} srcImage source image\n   * @param  {Integer} sx x-coordinate of the source's upper-left corner.\n   * @param  {Integer} sy y-coordinate of the source's upper-left corner.\n   * @param  {Integer} sw source image width.\n   * @param  {Integer} sh source image height.\n   * @param  {Integer} dx x-coordinate of the destination's upper-left corner.\n   * @param  {Integer} dy y-coordinate of the destination's upper-left corner.\n   * @param  {Integer} dw destination image width.\n   * @param  {Integer} dh destination image height.\n   * @param  {(BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL)} blendMode the blend mode. either\n   *     BLEND, DARKEST, LIGHTEST, DIFFERENCE,\n   *     MULTIPLY, EXCLUSION, SCREEN, REPLACE, OVERLAY, HARD_LIGHT,\n   *     SOFT_LIGHT, DODGE, BURN, ADD or NORMAL.\n   *\n   * Available blend modes are: normal | multiply | screen | overlay |\n   *            darken | lighten | color-dodge | color-burn | hard-light |\n   *            soft-light | difference | exclusion | hue | saturation |\n   *            color | luminosity\n   *\n   * http://blogs.adobe.com/webplatform/2013/01/28/blending-features-in-canvas/\n   *\n   * @example\n   * <div>\n   * <code>\n   * let mountains;\n   * let bricks;\n   *\n   * async function setup() {\n   *   // Load the images.\n   *   mountains = await loadImage('assets/rockies.jpg');\n   *   bricks = await loadImage('assets/bricks_third.jpg');\n   *   createCanvas(100, 100);\n   *\n   *   // Blend the bricks image into the mountains.\n   *   mountains.blend(bricks, 0, 0, 33, 100, 67, 0, 33, 100, ADD);\n   *\n   *   // Display the mountains image.\n   *   image(mountains, 0, 0);\n   *\n   *   // Display the bricks image.\n   *   image(bricks, 0, 0);\n   *\n   *   describe('A wall of bricks in front of a mountain landscape. The same wall of bricks appears faded on the right of the image.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let mountains;\n   * let bricks;\n   *\n   * async function setup() {\n   *   // Load the images.\n   *   mountains = await loadImage('assets/rockies.jpg');\n   *   bricks = await loadImage('assets/bricks_third.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Blend the bricks image into the mountains.\n   *   mountains.blend(bricks, 0, 0, 33, 100, 67, 0, 33, 100, DARKEST);\n   *\n   *   // Display the mountains image.\n   *   image(mountains, 0, 0);\n   *\n   *   // Display the bricks image.\n   *   image(bricks, 0, 0);\n   *\n   *   describe('A wall of bricks in front of a mountain landscape. The same wall of bricks appears transparent on the right of the image.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let mountains;\n   * let bricks;\n   *\n   * async function setup() {\n   *   // Load the images.\n   *   mountains = await loadImage('assets/rockies.jpg');\n   *   bricks = await loadImage('assets/bricks_third.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Blend the bricks image into the mountains.\n   *   mountains.blend(bricks, 0, 0, 33, 100, 67, 0, 33, 100, LIGHTEST);\n   *\n   *   // Display the mountains image.\n   *   image(mountains, 0, 0);\n   *\n   *   // Display the bricks image.\n   *   image(bricks, 0, 0);\n   *\n   *   describe('A wall of bricks in front of a mountain landscape. The same wall of bricks appears washed out on the right of the image.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param  {Integer} sx\n   * @param  {Integer} sy\n   * @param  {Integer} sw\n   * @param  {Integer} sh\n   * @param  {Integer} dx\n   * @param  {Integer} dy\n   * @param  {Integer} dw\n   * @param  {Integer} dh\n   * @param  {(BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL)} blendMode\n   */\n  blend(...args) {\n    const currBlend = this.drawingContext.globalCompositeOperation;\n    const blendMode = args[args.length - 1];\n    const copyArgs = Array.prototype.slice.call(args, 0, args.length - 1);\n\n    this.drawingContext.globalCompositeOperation = blendMode;\n    this.copy(...copyArgs);\n    this.drawingContext.globalCompositeOperation = currBlend;\n    this.setModified(true);\n  }\n\n  /**\n   * helper method for web GL mode to indicate that an image has been\n   * changed or unchanged since last upload. gl texture upload will\n   * set this value to false after uploading the texture.\n   * @param {Boolean} val sets whether or not the image has been\n   * modified.\n   * @private\n   */\n  setModified(val) {\n    this._modified = val; //enforce boolean?\n  }\n\n  /**\n   * helper method for web GL mode to figure out if the image\n   * has been modified and might need to be re-uploaded to texture\n   * memory between frames.\n   * @private\n   * @return {boolean} a boolean indicating whether or not the\n   * image has been updated or modified since last texture upload.\n   */\n  isModified() {\n    return this._modified;\n  }\n\n  /**\n   * Saves the image to a file.\n   *\n   * By default, `img.save()` saves the image as a PNG image called\n   * `untitled.png`.\n   *\n   * The first parameter, `filename`, is optional. It's a string that sets the\n   * file's name. If a file extension is included, as in\n   * `img.save('drawing.png')`, then the image will be saved using that\n   * format.\n   *\n   * The second parameter, `extension`, is also optional. It sets the files format.\n   * Either `'png'` or `'jpg'` can be used. For example, `img.save('drawing', 'jpg')`\n   * saves the canvas to a file called `drawing.jpg`.\n   *\n   * Note: The browser will either save the file immediately or prompt the user\n   * with a dialogue window.\n   *\n   * The image will only be downloaded as an animated GIF if it was loaded\n   * from a GIF file. See <a href=\"#/p5/saveGif\">saveGif()</a> to create new\n   * GIFs.\n   *\n   * @param {String} filename filename. Defaults to 'untitled'.\n   * @param  {String} [extension] file extension, either 'png' or 'jpg'.\n   *                            Defaults to 'png'.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('An image of a mountain landscape. The image is downloaded when the user presses the \"s\", \"j\", or \"p\" key.');\n   * }\n   *\n   * // Save the image with different options when the user presses a key.\n   * function keyPressed() {\n   *   if (key === 's') {\n   *     img.save();\n   *   } else if (key === 'j') {\n   *     img.save('rockies.jpg');\n   *   } else if (key === 'p') {\n   *     img.save('rockies', 'png');\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  save(filename, extension) {\n    if (this.gifProperties) {\n      encodeAndDownloadGif(this, filename);\n    } else {\n      let htmlCanvas = this.canvas;\n      extension =\n        extension ||\n        _checkFileExtension(filename, extension)[1] ||\n        'png';\n\n      let mimeType;\n      switch (extension) {\n        default:\n          //case 'png':\n          mimeType = 'image/png';\n          break;\n        case 'webp':\n          mimeType = 'image/webp';\n          break;\n        case 'jpeg':\n        case 'jpg':\n          mimeType = 'image/jpeg';\n          break;\n      }\n\n      htmlCanvas.toBlob(blob => {\n        downloadFile(blob, filename, extension);\n      }, mimeType);\n    }\n  }\n\n  async toBlob() {\n    return new Promise(resolve => {\n      this.canvas.toBlob(resolve);\n    });\n  }\n\n  // GIF Section\n  /**\n   * Restarts an animated GIF at its first frame.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let gif;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   gif = await loadImage('assets/arnott-wallace-wink-loop-once.gif');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   describe('A cartoon face winks once and then freezes. Clicking resets the face and makes it wink again.');\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *\n   *   // Display the image.\n   *   image(gif, 0, 0);\n   * }\n   *\n   * // Reset the GIF when the user presses the mouse.\n   * function mousePressed() {\n   *   gif.reset();\n   * }\n   * </code>\n   * </div>\n   */\n  reset() {\n    if (this.gifProperties) {\n      const props = this.gifProperties;\n      props.playing = true;\n      props.timeSinceStart = 0;\n      props.timeDisplayed = 0;\n      props.lastChangeTime = 0;\n      props.loopCount = 0;\n      props.displayIndex = 0;\n      this.drawingContext.putImageData(props.frames[0].image, 0, 0);\n    }\n  }\n\n  /**\n   * Gets the index of the current frame in an animated GIF.\n   *\n   * @return {Number}       index of the GIF's current frame.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let gif;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   gif = await loadImage('assets/arnott-wallace-eye-loop-forever.gif');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   describe('A cartoon eye repeatedly looks around, then outwards. A number displayed in the bottom-left corner increases from 0 to 124, then repeats.');\n   * }\n   *\n   * function draw() {\n   *   // Get the index of the current GIF frame.\n   *   let index = gif.getCurrentFrame();\n   *\n   *   // Display the image.\n   *   image(gif, 0, 0);\n   *\n   *   // Display the current frame.\n   *   text(index, 10, 90);\n   * }\n   * </code>\n   * </div>\n   */\n  getCurrentFrame() {\n    if (this.gifProperties) {\n      const props = this.gifProperties;\n      return props.displayIndex % props.numFrames;\n    }\n  }\n\n  /**\n   * Sets the current frame in an animated GIF.\n   *\n   * @param {Number} index index of the frame to display.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let gif;\n   * let frameSlider;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   gif = await loadImage('assets/arnott-wallace-eye-loop-forever.gif');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Get the index of the last frame.\n   *   let maxFrame = gif.numFrames() - 1;\n   *\n   *   // Create a slider to control which frame is drawn.\n   *   frameSlider = createSlider(0, maxFrame);\n   *   frameSlider.position(10, 80);\n   *   frameSlider.size(80);\n   *\n   *   describe('A cartoon eye looks around when a slider is moved.');\n   * }\n   *\n   * function draw() {\n   *   // Get the slider's value.\n   *   let index = frameSlider.value();\n   *\n   *   // Set the GIF's frame.\n   *   gif.setFrame(index);\n   *\n   *   // Display the image.\n   *   image(gif, 0, 0);\n   * }\n   * </code>\n   * </div>\n   */\n  setFrame(index) {\n    if (this.gifProperties) {\n      const props = this.gifProperties;\n      if (index < props.numFrames && index >= 0) {\n        props.timeDisplayed = 0;\n        props.lastChangeTime = 0;\n        props.displayIndex = index;\n        this.drawingContext.putImageData(props.frames[index].image, 0, 0);\n      } else {\n        console.log(\n          'Cannot set GIF to a frame number that is higher than total number of frames or below zero.'\n        );\n      }\n    }\n  }\n\n  /**\n   * Returns the number of frames in an animated GIF.\n   *\n   * @return {Number} number of frames in the GIF.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let gif;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   gif = await loadImage('assets/arnott-wallace-eye-loop-forever.gif');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   describe('A cartoon eye looks around. The text \"n / 125\" is shown at the bottom of the canvas.');\n   * }\n   *\n   * function draw() {\n   *   // Display the image.\n   *   image(gif, 0, 0);\n   *\n   *   // Display the current state of playback.\n   *   let total = gif.numFrames();\n   *   let index = gif.getCurrentFrame();\n   *   text(`${index} / ${total}`, 30, 90);\n   * }\n   * </code>\n   * </div>\n   */\n  numFrames() {\n    if (this.gifProperties) {\n      return this.gifProperties.numFrames;\n    }\n  }\n\n  /**\n   * Plays an animated GIF that was paused with\n   * <a href=\"#/p5.Image/pause\">img.pause()</a>.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let gif;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   gif = await loadImage('assets/nancy-liang-wind-loop-forever.gif');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   describe('A drawing of a child with hair blowing in the wind. The animation freezes when clicked and resumes when released.');\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   image(gif, 0, 0);\n   * }\n   *\n   * // Pause the GIF when the user presses the mouse.\n   * function mousePressed() {\n   *   gif.pause();\n   * }\n   *\n   * // Play the GIF when the user releases the mouse.\n   * function mouseReleased() {\n   *   gif.play();\n   * }\n   * </code>\n   * </div>\n   */\n  play() {\n    if (this.gifProperties) {\n      this.gifProperties.playing = true;\n    }\n  }\n\n  /**\n   * Pauses an animated GIF.\n   *\n   * The GIF can be resumed by calling\n   * <a href=\"#/p5.Image/play\">img.play()</a>.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let gif;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   gif = await loadImage('assets/nancy-liang-wind-loop-forever.gif');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   describe('A drawing of a child with hair blowing in the wind. The animation freezes when clicked and resumes when released.');\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *\n   *   // Display the image.\n   *   image(gif, 0, 0);\n   * }\n   *\n   * // Pause the GIF when the user presses the mouse.\n   * function mousePressed() {\n   *   gif.pause();\n   * }\n   *\n   * // Play the GIF when the user presses the mouse.\n   * function mouseReleased() {\n   *   gif.play();\n   * }\n   * </code>\n   * </div>\n   */\n  pause() {\n    if (this.gifProperties) {\n      this.gifProperties.playing = false;\n    }\n  }\n\n  /**\n   * Changes the delay between frames in an animated GIF.\n   *\n   * The first parameter, `delay`, is the length of the delay in milliseconds.\n   *\n   * The second parameter, `index`, is optional. If provided, only the frame\n   * at `index` will have its delay modified. All other frames will keep\n   * their default delay.\n   *\n   * @param {Number} d delay in milliseconds between switching frames.\n   * @param {Number} [index] index of the frame that will have its delay modified.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let gifFast;\n   * let gifSlow;\n   *\n   * async function setup() {\n   *   // Load the images.\n   *   gifFast = await loadImage('assets/arnott-wallace-eye-loop-forever.gif');\n   *   gifSlow = await loadImage('assets/arnott-wallace-eye-loop-forever.gif');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Resize the images.\n   *   gifFast.resize(50, 50);\n   *   gifSlow.resize(50, 50);\n   *\n   *   // Set the delay lengths.\n   *   gifFast.delay(10);\n   *   gifSlow.delay(100);\n   *\n   *   describe('Two animated eyes looking around. The eye on the left moves faster than the eye on the right.');\n   * }\n   *\n   * function draw() {\n   *   // Display the images.\n   *   image(gifFast, 0, 0);\n   *   image(gifSlow, 50, 0);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let gif;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   gif = await loadImage('assets/arnott-wallace-eye-loop-forever.gif');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Set the delay of frame 67.\n   *   gif.delay(3000, 67);\n   *\n   *   describe('An animated eye looking around. It pauses for three seconds while it looks down.');\n   * }\n   *\n   * function draw() {\n   *   // Display the image.\n   *   image(gif, 0, 0);\n   * }\n   * </code>\n   * </div>\n   */\n  delay(d, index) {\n    if (this.gifProperties) {\n      const props = this.gifProperties;\n      if (index < props.numFrames && index >= 0) {\n        props.frames[index].delay = d;\n      } else {\n        // change all frames\n        for (const frame of props.frames) {\n          frame.delay = d;\n        }\n      }\n    }\n  }\n}\nfunction encodeAndDownloadGif(pImg, filename) {\n  const props = pImg.gifProperties;\n\n  //convert loopLimit back into Netscape Block formatting\n  let loopLimit = props.loopLimit;\n  if (loopLimit === 1) {\n    loopLimit = null;\n  } else if (loopLimit === null) {\n    loopLimit = 0;\n  }\n  const buffer = new Uint8Array(pImg.width * pImg.height * props.numFrames);\n\n  const allFramesPixelColors = [];\n\n  // Used to determine the occurrence of unique palettes and the frames\n  // which use them\n  const paletteFreqsAndFrames = {};\n\n  // Pass 1:\n  //loop over frames and get the frequency of each palette\n  for (let i = 0; i < props.numFrames; i++) {\n    const paletteSet = new Set();\n    const data = props.frames[i].image.data;\n    const dataLength = data.length;\n    // The color for each pixel in this frame ( for easier lookup later )\n    const pixelColors = new Uint32Array(pImg.width * pImg.height);\n    for (let j = 0, k = 0; j < dataLength; j += 4, k++) {\n      const r = data[j + 0];\n      const g = data[j + 1];\n      const b = data[j + 2];\n      const color = (r << 16) | (g << 8) | (b << 0);\n      paletteSet.add(color);\n\n      // What color does this pixel have in this frame ?\n      pixelColors[k] = color;\n    }\n\n    // A way to put use the entire palette as an object key\n    const paletteStr = [...paletteSet].sort().toString();\n    if (paletteFreqsAndFrames[paletteStr] === undefined) {\n      paletteFreqsAndFrames[paletteStr] = { freq: 1, frames: [i] };\n    } else {\n      paletteFreqsAndFrames[paletteStr].freq += 1;\n      paletteFreqsAndFrames[paletteStr].frames.push(i);\n    }\n\n    allFramesPixelColors.push(pixelColors);\n  }\n\n  let framesUsingGlobalPalette = [];\n\n  // Now to build the global palette\n  // Sort all the unique palettes in descending order of their occurrence\n  const palettesSortedByFreq = Object.keys(paletteFreqsAndFrames).sort(function(\n    a,\n    b\n  ) {\n    return paletteFreqsAndFrames[b].freq - paletteFreqsAndFrames[a].freq;\n  });\n\n  // The initial global palette is the one with the most occurrence\n  const globalPalette = palettesSortedByFreq[0]\n    .split(',')\n    .map(a => parseInt(a));\n\n  framesUsingGlobalPalette = framesUsingGlobalPalette.concat(\n    paletteFreqsAndFrames[globalPalette].frames\n  );\n\n  const globalPaletteSet = new Set(globalPalette);\n\n  // Build a more complete global palette\n  // Iterate over the remaining palettes in the order of\n  // their occurrence and see if the colors in this palette which are\n  // not in the global palette can be added there, while keeping the length\n  // of the global palette <= 256\n  for (let i = 1; i < palettesSortedByFreq.length; i++) {\n    const palette = palettesSortedByFreq[i].split(',').map(a => parseInt(a));\n\n    const difference = palette.filter(x => !globalPaletteSet.has(x));\n    if (globalPalette.length + difference.length <= 256) {\n      for (let j = 0; j < difference.length; j++) {\n        globalPalette.push(difference[j]);\n        globalPaletteSet.add(difference[j]);\n      }\n\n      // All frames using this palette now use the global palette\n      framesUsingGlobalPalette = framesUsingGlobalPalette.concat(\n        paletteFreqsAndFrames[palettesSortedByFreq[i]].frames\n      );\n    }\n  }\n\n  framesUsingGlobalPalette = new Set(framesUsingGlobalPalette);\n\n  // Build a lookup table of the index of each color in the global palette\n  // Maps a color to its index\n  const globalIndicesLookup = {};\n  for (let i = 0; i < globalPalette.length; i++) {\n    if (!globalIndicesLookup[globalPalette[i]]) {\n      globalIndicesLookup[globalPalette[i]] = i;\n    }\n  }\n\n  // force palette to be power of 2\n  let powof2 = 1;\n  while (powof2 < globalPalette.length) {\n    powof2 <<= 1;\n  }\n  globalPalette.length = powof2;\n\n  // global opts\n  const opts = {\n    loop: loopLimit,\n    palette: new Uint32Array(globalPalette)\n  };\n  const gifWriter = new omggif.GifWriter(buffer, pImg.width, pImg.height, opts);\n  let previousFrame = {};\n\n  // Pass 2\n  // Determine if the frame needs a local palette\n  // Also apply transparency optimization. This function will often blow up\n  // the size of a GIF if not for transparency. If a pixel in one frame has\n  // the same color in the previous frame, that pixel can be marked as\n  // transparent. We decide one particular color as transparent and make all\n  // transparent pixels take this color. This helps in later in compression.\n  for (let i = 0; i < props.numFrames; i++) {\n    const localPaletteRequired = !framesUsingGlobalPalette.has(i);\n    const palette = localPaletteRequired ? [] : globalPalette;\n    const pixelPaletteIndex = new Uint8Array(pImg.width * pImg.height);\n\n    // Lookup table mapping color to its indices\n    const colorIndicesLookup = {};\n\n    // All the colors that cannot be marked transparent in this frame\n    const cannotBeTransparent = new Set();\n\n    allFramesPixelColors[i].forEach((color, k) => {\n      if (localPaletteRequired) {\n        if (colorIndicesLookup[color] === undefined) {\n          colorIndicesLookup[color] = palette.length;\n          palette.push(color);\n        }\n        pixelPaletteIndex[k] = colorIndicesLookup[color];\n      } else {\n        pixelPaletteIndex[k] = globalIndicesLookup[color];\n      }\n\n      if (i > 0) {\n        // If even one pixel of this color has changed in this frame\n        // from the previous frame, we cannot mark it as transparent\n        if (allFramesPixelColors[i - 1][k] !== color) {\n          cannotBeTransparent.add(color);\n        }\n      }\n    });\n\n    const frameOpts = {};\n\n    // Transparency optimization\n    const canBeTransparent = palette.filter(a => !cannotBeTransparent.has(a));\n    if (canBeTransparent.length > 0) {\n      // Select a color to mark as transparent\n      const transparent = canBeTransparent[0];\n      const transparentIndex = localPaletteRequired\n        ? colorIndicesLookup[transparent]\n        : globalIndicesLookup[transparent];\n      if (i > 0) {\n        for (let k = 0; k < allFramesPixelColors[i].length; k++) {\n          // If this pixel in this frame has the same color in previous frame\n          if (allFramesPixelColors[i - 1][k] === allFramesPixelColors[i][k]) {\n            pixelPaletteIndex[k] = transparentIndex;\n          }\n        }\n        frameOpts.transparent = transparentIndex;\n        // If this frame has any transparency, do not dispose the previous frame\n        previousFrame.frameOpts.disposal = 1;\n      }\n    }\n    frameOpts.delay = props.frames[i].delay / 10; // Move timing back into GIF formatting\n    if (localPaletteRequired) {\n      // force palette to be power of 2\n      let powof2 = 1;\n      while (powof2 < palette.length) {\n        powof2 <<= 1;\n      }\n      palette.length = powof2;\n      frameOpts.palette = new Uint32Array(palette);\n    }\n    if (i > 0) {\n      // add the frame that came before the current one\n      gifWriter.addFrame(\n        0,\n        0,\n        pImg.width,\n        pImg.height,\n        previousFrame.pixelPaletteIndex,\n        previousFrame.frameOpts\n      );\n    }\n    // previous frame object should now have details of this frame\n    previousFrame = {\n      pixelPaletteIndex,\n      frameOpts\n    };\n  }\n\n  previousFrame.frameOpts.disposal = 1;\n  // add the last frame\n  gifWriter.addFrame(\n    0,\n    0,\n    pImg.width,\n    pImg.height,\n    previousFrame.pixelPaletteIndex,\n    previousFrame.frameOpts\n  );\n\n  const extension = 'gif';\n  const blob = new Blob([buffer.slice(0, gifWriter.end())], {\n    type: 'image/gif'\n  });\n  downloadFile(blob, filename, extension);\n}\nfunction image(p5, fn){\n  /**\n   * A class to describe an image.\n   *\n   * Images are rectangular grids of pixels that can be displayed and modified.\n   *\n   * Existing images can be loaded by calling\n   * <a href=\"#/p5/loadImage\">loadImage()</a>. Blank images can be created by\n   * calling <a href=\"#/p5/createImage\">createImage()</a>. `p5.Image` objects\n   * have methods for common tasks such as applying filters and modifying\n   * pixel values.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('An image of a brick wall.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Apply the GRAY filter.\n   *   img.filter(GRAY);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('A grayscale image of a brick wall.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(66, 66);\n   *\n   *   // Load the image's pixels.\n   *   img.loadPixels();\n   *\n   *   // Set the pixels to black.\n   *   for (let x = 0; x < img.width; x += 1) {\n   *     for (let y = 0; y < img.height; y += 1) {\n   *       img.set(x, y, 0);\n   *     }\n   *   }\n   *\n   *   // Update the image.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 17, 17);\n   *\n   *   describe('A black square drawn in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @class p5.Image\n   * @param {Number} width\n   * @param {Number} height\n   */\n  p5.Image = Image;\n\n  /**\n   * The image's width in pixels.\n   *\n   * @type {Number}\n   * @property {Number} width\n   * @for p5.Image\n   * @name width\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Calculate the center coordinates.\n   *   let x = img.width / 2;\n   *   let y = img.height / 2;\n   *\n   *   // Draw a circle at the image's center.\n   *   circle(x, y, 20);\n   *\n   *   describe('An image of a mountain landscape with a white circle drawn in the middle.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The image's height in pixels.\n   *\n   * @type {Number}\n   * @property height\n   * @for p5.Image\n   * @name height\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Calculate the center coordinates.\n   *   let x = img.width / 2;\n   *   let y = img.height / 2;\n   *\n   *   // Draw a circle at the image's center.\n   *   circle(x, y, 20);\n   *\n   *   describe('An image of a mountain landscape with a white circle drawn in the middle.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * An array containing the color of each pixel in the image.\n   *\n   * Colors are stored as numbers representing red, green, blue, and alpha\n   * (RGBA) values. `img.pixels` is a one-dimensional array for performance\n   * reasons.\n   *\n   * Each pixel occupies four elements in the pixels array, one for each\n   * RGBA value. For example, the pixel at coordinates (0, 0) stores its\n   * RGBA values at `img.pixels[0]`, `img.pixels[1]`, `img.pixels[2]`,\n   * and `img.pixels[3]`, respectively. The next pixel at coordinates (1, 0)\n   * stores its RGBA values at `img.pixels[4]`, `img.pixels[5]`,\n   * `img.pixels[6]`, and `img.pixels[7]`. And so on. The `img.pixels` array\n   * for a 100100 <a href=\"#/p5.Image\">p5.Image</a> object has\n   * 100  100  4 = 40,000 elements.\n   *\n   * Accessing the RGBA values for a pixel in the image requires a little\n   * math as shown in the examples below. The\n   * <a href=\"#/p5.Image/loadPixels\">img.loadPixels()</a>\n   * method must be called before accessing the `img.pixels` array. The\n   * <a href=\"#/p5.Image/updatePixels\">img.updatePixels()</a> method must be\n   * called after any changes are made.\n   *\n   * @property {Number[]} pixels\n   * @for p5.Image\n   * @name pixels\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(66, 66);\n   *\n   *   // Load the image's pixels.\n   *   img.loadPixels();\n   *\n   *   for (let i = 0; i < img.pixels.length; i += 4) {\n   *     // Red.\n   *     img.pixels[i] = 0;\n   *     // Green.\n   *     img.pixels[i + 1] = 0;\n   *     // Blue.\n   *     img.pixels[i + 2] = 0;\n   *     // Alpha.\n   *     img.pixels[i + 3] = 255;\n   *   }\n   *\n   *   // Update the image.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 17, 17);\n   *\n   *   describe('A black square drawn in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(66, 66);\n   *\n   *   // Load the image's pixels.\n   *   img.loadPixels();\n   *\n   *   // Set the pixels to red.\n   *   for (let i = 0; i < img.pixels.length; i += 4) {\n   *     // Red.\n   *     img.pixels[i] = 255;\n   *     // Green.\n   *     img.pixels[i + 1] = 0;\n   *     // Blue.\n   *     img.pixels[i + 2] = 0;\n   *     // Alpha.\n   *     img.pixels[i + 3] = 255;\n   *   }\n   *\n   *   // Update the image.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 17, 17);\n   *\n   *   describe('A red square drawn in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n}\n\nif(typeof p5 !== 'undefined'){\n  image(p5, p5.prototype);\n}\n\n/**\n * @module Rendering\n * @submodule Rendering\n * @for p5\n */\n\n\nclass ClonableObject {\n  constructor(obj = {}) {\n    for (const key in obj) {\n      this[key] = obj[key];\n    }\n  }\n\n  clone() {\n    return new ClonableObject(this);\n  }\n}\nclass Renderer {\n  static states = {\n    strokeColor: null,\n    strokeSet: false,\n    fillColor: null,\n    fillSet: false,\n    tint: null,\n\n    imageMode: CORNER,\n    rectMode: CORNER,\n    ellipseMode: CENTER,\n    strokeWeight: 1,\n\n    textFont: { family: 'sans-serif' },\n    textLeading: 15,\n    leadingSet: false,\n    textSize: 12,\n    textAlign: LEFT,\n    textBaseline: BASELINE,\n    bezierOrder: 3,\n    splineProperties: new ClonableObject({ ends: INCLUDE, tightness: 0 }),\n    textWrap: WORD,\n\n    // added v2.0\n    fontStyle: NORMAL, // v1: textStyle\n    fontStretch: NORMAL,\n    fontWeight: NORMAL,\n    lineHeight: NORMAL,\n    fontVariant: NORMAL,\n    direction: 'inherit'\n  }\n\n  constructor(pInst, w, h, isMainCanvas) {\n    this._pInst = pInst;\n    this._isMainCanvas = isMainCanvas;\n    this.pixels = [];\n    this._pixelDensity = Math.ceil(window.devicePixelRatio) || 1;\n\n    this.width = w;\n    this.height = h;\n\n    this._events = {};\n\n    if (isMainCanvas) {\n      this._isMainCanvas = true;\n    }\n\n    // Renderer state machine\n    this.states = new States(Renderer.states);\n\n    this.states.strokeColor = new Color([0, 0, 0]);\n    this.states.fillColor = new Color([1, 1, 1]);\n\n    this._pushPopStack = [];\n    // NOTE: can use the length of the push pop stack instead\n    this._pushPopDepth = 0;\n\n    this._clipping = false;\n    this._clipInvert = false;\n\n    this._currentShape = undefined; // Lazily generate current shape\n  }\n\n  get currentShape() {\n    if (!this._currentShape) {\n      this._currentShape = new Shape(this.getCommonVertexProperties());\n    }\n    return this._currentShape;\n  }\n\n  remove() {\n\n  }\n\n  pixelDensity(val){\n    let returnValue;\n    if (typeof val === 'number') {\n      if (val !== this._pixelDensity) {\n        this._pixelDensity = val;\n      }\n      returnValue = this;\n      this.resize(this.width, this.height);\n    } else {\n      returnValue = this._pixelDensity;\n    }\n    return returnValue;\n  }\n\n  // Makes a shallow copy of the current states\n  // and push it into the push pop stack\n  push() {\n    this._pushPopDepth++;\n    this._pushPopStack.push(this.states.getDiff());\n  }\n\n  // Pop the previous states out of the push pop stack and\n  // assign it back to the current state\n  pop() {\n    this._pushPopDepth--;\n    const diff = this._pushPopStack.pop() || {};\n    const modified = this.states.getModified();\n    this.states.applyDiff(diff);\n    this.updateShapeVertexProperties(modified);\n    this.updateShapeProperties(modified);\n  }\n\n  bezierOrder(order) {\n    if (order === undefined) {\n      return this.states.bezierOrder;\n    } else {\n      this.states.setValue('bezierOrder', order);\n      this.updateShapeProperties();\n    }\n  }\n\n  bezierVertex(x, y, z = 0, u = 0, v = 0) {\n    const position = new Vector(x, y, z);\n    const textureCoordinates = this.getSupportedIndividualVertexProperties().textureCoordinates\n      ? new Vector(u, v)\n      : undefined;\n    this.currentShape.bezierVertex(position, textureCoordinates);\n  }\n\n  splineProperty(key, value) {\n    if (value === undefined) {\n      return this.states.splineProperties[key];\n    } else {\n      this.states.setValue('splineProperties', this.states.splineProperties.clone());\n      this.states.splineProperties[key] = value;\n    }\n    this.updateShapeProperties();\n  }\n\n  splineProperties(values) {\n    if (values) {\n      for (const key in values) {\n        this.splineProperty(key, values[key]);\n      }\n    } else {\n      return { ...this.states.splineProperties };\n    }\n  }\n\n  splineVertex(x, y, z = 0, u = 0, v = 0) {\n    const position = new Vector(x, y, z);\n    const textureCoordinates = this.getSupportedIndividualVertexProperties().textureCoordinates\n      ? new Vector(u, v)\n      : undefined;\n    this.currentShape.splineVertex(position, textureCoordinates);\n  }\n\n  curveDetail(d) {\n    if (d === undefined) {\n      return this.states.curveDetail;\n    } else {\n      this.states.setValue('curveDetail', d);\n    }\n  }\n\n  beginShape(...args) {\n    this.currentShape.reset();\n    this.updateShapeVertexProperties();\n    this.currentShape.beginShape(...args);\n  }\n\n  endShape(...args) {\n    this.currentShape.endShape(...args);\n    this.drawShape(this.currentShape);\n  }\n\n  beginContour(shapeKind) {\n    this.currentShape.beginContour(shapeKind);\n  }\n\n  endContour(mode) {\n    this.currentShape.endContour(mode);\n  }\n\n  drawShape(shape, count) {\n    throw new Error('Unimplemented')\n  }\n\n  vertex(x, y, z = 0, u = 0, v = 0) {\n    const position = new Vector(x, y, z);\n    const textureCoordinates = this.getSupportedIndividualVertexProperties().textureCoordinates\n      ? new Vector(u, v)\n      : undefined;\n    this.currentShape.vertex(position, textureCoordinates);\n  }\n\n  bezier(x1, y1, x2, y2, x3, y3, x4, y4) {\n    const oldOrder = this._pInst.bezierOrder();\n    this._pInst.bezierOrder(oldOrder);\n    this._pInst.beginShape();\n    this._pInst.bezierVertex(x1, y1);\n    this._pInst.bezierVertex(x2, y2);\n    this._pInst.bezierVertex(x3, y3);\n    this._pInst.bezierVertex(x4, y4);\n    this._pInst.endShape();\n    return this;\n  }\n\n  spline(...args) {\n    if (args.length === 2 * 4) {\n      const [x1, y1, x2, y2, x3, y3, x4, y4] = args;\n      this._pInst.beginShape();\n      this._pInst.splineVertex(x1, y1);\n      this._pInst.splineVertex(x2, y2);\n      this._pInst.splineVertex(x3, y3);\n      this._pInst.splineVertex(x4, y4);\n      this._pInst.endShape();\n    } else if (args.length === 3 * 4) {\n      const [x1, y1, z1, x2, y2, z2, x3, y3, z3, x4, y4, z4] = args;\n      this._pInst.beginShape();\n      this._pInst.splineVertex(x1, y1, z1);\n      this._pInst.splineVertex(x2, y2, z2);\n      this._pInst.splineVertex(x3, y3, z3);\n      this._pInst.splineVertex(x4, y4, z4);\n      this._pInst.endShape();\n    }\n    return this;\n  }\n\n  beginClip(options = {}) {\n    if (this._clipping) {\n      throw new Error(\"It looks like you're trying to clip while already in the middle of clipping. Did you forget to endClip()?\");\n    }\n    this._clipping = true;\n    this._clipInvert = options.invert;\n  }\n\n  endClip() {\n    if (!this._clipping) {\n      throw new Error(\"It looks like you've called endClip() without beginClip(). Did you forget to call beginClip() first?\");\n    }\n    this._clipping = false;\n  }\n\n  /**\n   * Resize our canvas element.\n   */\n  resize(w, h) {\n    this.width = w;\n    this.height = h;\n  }\n\n  get(x, y, w, h) {\n    const pd = this._pixelDensity;\n    const canvas = this.canvas;\n\n    if (typeof x === 'undefined' && typeof y === 'undefined') {\n    // get()\n      x = y = 0;\n      w = this.width;\n      h = this.height;\n    } else {\n      x *= pd;\n      y *= pd;\n\n      if (typeof w === 'undefined' && typeof h === 'undefined') {\n      // get(x,y)\n        if (x < 0 || y < 0 || x >= canvas.width || y >= canvas.height) {\n          return [0, 0, 0, 0];\n        }\n\n        return this._getPixel(x, y);\n      }\n    // get(x,y,w,h)\n    }\n\n    const region = new Image(w*pd, h*pd);\n    region.pixelDensity(pd);\n    region.canvas\n      .getContext('2d')\n      .drawImage(canvas, x, y, w * pd, h * pd, 0, 0, w*pd, h*pd);\n\n    return region;\n  }\n\n  scale(x, y){\n\n  }\n\n  fill(...args) {\n    this.states.setValue('fillSet', true);\n    this.states.setValue('fillColor', this._pInst.color(...args));\n    this.updateShapeVertexProperties();\n  }\n\n  noFill() {\n    this.states.setValue('fillColor', null);\n  }\n\n  strokeWeight(w) {\n    if (w === undefined) {\n      return this.states.strokeWeight;\n    } else {\n      this.states.setValue('strokeWeight', w);\n    }\n  }\n\n  stroke(...args) {\n    this.states.setValue('strokeSet', true);\n    this.states.setValue('strokeColor', this._pInst.color(...args));\n    this.updateShapeVertexProperties();\n  }\n\n  noStroke() {\n    this.states.setValue('strokeColor', null);\n  }\n\n  getCommonVertexProperties() {\n    return {}\n  }\n\n  getSupportedIndividualVertexProperties() {\n    return {\n      textureCoordinates: false,\n    }\n  }\n\n  updateShapeProperties(modified) {\n    if (!modified || modified.bezierOrder || modified.splineProperties) {\n      const shape = this.currentShape;\n      shape.bezierOrder(this.states.bezierOrder);\n      shape.splineProperty('ends', this.states.splineProperties.ends);\n      shape.splineProperty('tightness', this.states.splineProperties.tightness);\n    }\n  }\n\n  updateShapeVertexProperties(modified) {\n    const props = this.getCommonVertexProperties();\n    if (!modified || Object.keys(modified).some((k) => k in props)) {\n      const shape = this.currentShape;\n      for (const key in props) {\n        shape[key](props[key]);\n      }\n    }\n  }\n\n  _applyDefaults() {\n    return this;\n  }\n\n}\nfunction renderer(p5, fn){\n  /**\n   * Main graphics and rendering context, as well as the base API\n   * implementation for p5.js \"core\". To be used as the superclass for\n   * Renderer2D and Renderer3D classes, respectively.\n   *\n   * @class p5.Renderer\n   * @param {HTMLElement} elt DOM node that is wrapped\n   * @param {p5} [pInst] pointer to p5 instance\n   * @param {Boolean} [isMainCanvas] whether we're using it as main canvas\n   * @private\n   */\n  p5.Renderer = Renderer;\n}\n\nexport { Image as I, Renderer as R, image as i, renderer as r };\n","import { Element } from './p5.Element.js';\nimport './p5.File.js';\nimport '../io/p5.XML.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../constants-8IpwyBct.js';\n\n/**\n * @module DOM\n * @submodule DOM\n */\n\n\nclass MediaElement extends Element {\n  constructor(elt, pInst) {\n    super(elt, pInst);\n\n    const self = this;\n    this.elt.crossOrigin = 'anonymous';\n\n    this._prevTime = 0;\n    this._cueIDCounter = 0;\n    this._cues = [];\n    this.pixels = [];\n    this._pixelsState = this;\n    this._pixelDensity = 1;\n    this._modified = false;\n\n    // Media has an internal canvas that is used when drawing it to the main\n    // canvas. It will need to be updated each frame as the video itself plays.\n    // We don't want to update it every time we draw, however, in case the user\n    // has used load/updatePixels. To handle this, we record the frame drawn to\n    // the internal canvas so we only update it if the frame has changed.\n    this._frameOnCanvas = -1;\n\n    Object.defineProperty(self, 'src', {\n      get() {\n        const firstChildSrc = self.elt.children[0].src;\n        const srcVal = self.elt.src === window.location.href ? '' : self.elt.src;\n        const ret =\n          firstChildSrc === window.location.href ? srcVal : firstChildSrc;\n        return ret;\n      },\n      set(newValue) {\n        for (let i = 0; i < self.elt.children.length; i++) {\n          self.elt.removeChild(self.elt.children[i]);\n        }\n        const source = document.createElement('source');\n        source.src = newValue;\n        elt.appendChild(source);\n        self.elt.src = newValue;\n        self.modified = true;\n      }\n    });\n\n    // private _onended callback, set by the method: onended(callback)\n    self._onended = function () { };\n    self.elt.onended = function () {\n      self._onended(self);\n    };\n  }\n\n\n  /**\n   * Plays audio or video from a media element.\n   *\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let beat;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display a message.\n   *   text('Click to play', 50, 50);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   beat = createAudio('assets/beat.mp3');\n   *\n   *   describe('The text \"Click to play\" written in black on a gray background. A beat plays when the user clicks the square.');\n   * }\n   *\n   * // Play the beat when the user presses the mouse.\n   * function mousePressed() {\n   *   beat.play();\n   * }\n   * </code>\n   * </div>\n   */\n  play() {\n    if (this.elt.currentTime === this.elt.duration) {\n      this.elt.currentTime = 0;\n    }\n    let promise;\n    if (this.elt.readyState > 1) {\n      promise = this.elt.play();\n    } else {\n      // in Chrome, playback cannot resume after being stopped and must reload\n      this.elt.load();\n      promise = this.elt.play();\n    }\n    if (promise && promise.catch) {\n      promise.catch(e => {\n        // if it's an autoplay failure error\n        if (e.name === 'NotAllowedError') {\n          if (typeof IS_MINIFIED === 'undefined') {\n            p5._friendlyAutoplayError(this.src);\n          } else {\n            console.error(e);\n          }\n        } else {\n          // any other kind of error\n          console.error('Media play method encountered an unexpected error', e);\n        }\n      });\n    }\n    return this;\n  }\n\n  /**\n   * Stops a media element and sets its current time to 0.\n   *\n   * Calling `media.play()` will restart playing audio/video from the beginning.\n   *\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let beat;\n   * let isStopped = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   beat = createAudio('assets/beat.mp3');\n   *\n   *   describe('The text \"Click to start\" written in black on a gray background. The beat starts or stops when the user presses the mouse.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display different instructions based on playback.\n   *   if (isStopped === true) {\n   *     text('Click to start', 50, 50);\n   *   } else {\n   *     text('Click to stop', 50, 50);\n   *   }\n   * }\n   *\n   * // Adjust playback when the user presses the mouse.\n   * function mousePressed() {\n   *   if (isStopped === true) {\n   *     // If the beat is stopped, play it.\n   *     beat.play();\n   *     isStopped = false;\n   *   } else {\n   *     // If the beat is playing, stop it.\n   *     beat.stop();\n   *     isStopped = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  stop() {\n    this.elt.pause();\n    this.elt.currentTime = 0;\n    return this;\n  }\n\n  /**\n   * Pauses a media element.\n   *\n   * Calling `media.play()` will resume playing audio/video from the moment it paused.\n   *\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let beat;\n   * let isPaused = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   beat = createAudio('assets/beat.mp3');\n   *\n   *   describe('The text \"Click to play\" written in black on a gray background. The beat plays or pauses when the user clicks the square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display different instructions based on playback.\n   *   if (isPaused === true) {\n   *     text('Click to play', 50, 50);\n   *   } else {\n   *     text('Click to pause', 50, 50);\n   *   }\n   * }\n   *\n   * // Adjust playback when the user presses the mouse.\n   * function mousePressed() {\n   *   if (isPaused === true) {\n   *     // If the beat is paused,\n   *     // play it.\n   *     beat.play();\n   *     isPaused = false;\n   *   } else {\n   *     // If the beat is playing,\n   *     // pause it.\n   *     beat.pause();\n   *     isPaused = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  pause() {\n    this.elt.pause();\n    return this;\n  }\n\n  /**\n   * Plays the audio/video repeatedly in a loop.\n   *\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let beat;\n   * let isLooping = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   beat = createAudio('assets/beat.mp3');\n   *\n   *   describe('The text \"Click to loop\" written in black on a gray background. A beat plays repeatedly in a loop when the user clicks. The beat stops when the user clicks again.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display different instructions based on playback.\n   *   if (isLooping === true) {\n   *     text('Click to stop', 50, 50);\n   *   } else {\n   *     text('Click to loop', 50, 50);\n   *   }\n   * }\n   *\n   * // Adjust playback when the user presses the mouse.\n   * function mousePressed() {\n   *   if (isLooping === true) {\n   *     // If the beat is looping, stop it.\n   *     beat.stop();\n   *     isLooping = false;\n   *   } else {\n   *     // If the beat is stopped, loop it.\n   *     beat.loop();\n   *     isLooping = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  loop() {\n    this.elt.setAttribute('loop', true);\n    this.play();\n    return this;\n  }\n  /**\n   * Stops the audio/video from playing in a loop.\n   *\n   * The media will stop when it finishes playing.\n   *\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let beat;\n   * let isPlaying = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   beat = createAudio('assets/beat.mp3');\n   *\n   *   describe('The text \"Click to play\" written in black on a gray background. A beat plays when the user clicks. The beat stops when the user clicks again.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display different instructions based on playback.\n   *   if (isPlaying === true) {\n   *     text('Click to stop', 50, 50);\n   *   } else {\n   *     text('Click to play', 50, 50);\n   *   }\n   * }\n   *\n   * // Adjust playback when the user presses the mouse.\n   * function mousePressed() {\n   *   if (isPlaying === true) {\n   *     // If the beat is playing, stop it.\n   *     beat.stop();\n   *     isPlaying = false;\n   *   } else {\n   *     // If the beat is stopped, play it.\n   *     beat.play();\n   *     isPlaying = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  noLoop() {\n    this.elt.removeAttribute('loop');\n    return this;\n  }\n\n  /**\n   * Sets up logic to check that autoplay succeeded.\n   *\n   * @private\n   */\n  _setupAutoplayFailDetection() {\n    const timeout = setTimeout(() => {\n      if (typeof IS_MINIFIED === 'undefined') {\n        p5._friendlyAutoplayError(this.src);\n      } else {\n        console.error(e);\n      }\n    }, 500);\n    this.elt.addEventListener('play', () => clearTimeout(timeout), {\n      passive: true,\n      once: true\n    });\n  }\n\n  /**\n   * Sets the audio/video to play once it's loaded.\n   *\n   * The parameter, `shouldAutoplay`, is optional. Calling\n   * `media.autoplay()` without an argument causes the media to play\n   * automatically. If `true` is passed, as in `media.autoplay(true)`, the\n   * media will automatically play. If `false` is passed, as in\n   * `media.autoPlay(false)`, it won't play automatically.\n   *\n   * @param {Boolean} [shouldAutoplay] whether the element should autoplay.\n   * @chainable\n   *\n   * @example\n   * <div class='notest'>\n   * <code>\n   * let video;\n   *\n   * function setup() {\n   *   noCanvas();\n   *\n   *   // Call handleVideo() once the video loads.\n   *   video = createVideo('assets/fingers.mov', handleVideo);\n   *\n   *   describe('A video of fingers walking on a treadmill.');\n   * }\n   *\n   * // Set the video's size and play it.\n   * function handleVideo() {\n   *   video.size(100, 100);\n   *   video.autoplay();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='notest'>\n   * <code>\n   * function setup() {\n   *   noCanvas();\n   *\n   *   // Load a video, but don't play it automatically.\n   *   let video = createVideo('assets/fingers.mov', handleVideo);\n   *\n   *   // Play the video when the user clicks on it.\n   *   video.mousePressed(handlePress);\n   *\n   *   describe('An image of fingers on a treadmill. They start walking when the user double-clicks on them.');\n   * }\n   * </code>\n   * </div>\n   *\n   * // Set the video's size and playback mode.\n   * function handleVideo() {\n   *   video.size(100, 100);\n   *   video.autoplay(false);\n   * }\n   *\n   * // Play the video.\n   * function handleClick() {\n   *   video.play();\n   * }\n   */\n  autoplay(val) {\n    const oldVal = this.elt.getAttribute('autoplay');\n    this.elt.setAttribute('autoplay', val);\n    // if we turned on autoplay\n    if (val && !oldVal) {\n      // bind method to this scope\n      const setupAutoplayFailDetection =\n        () => this._setupAutoplayFailDetection();\n      // if media is ready to play, schedule check now\n      if (this.elt.readyState === 4) {\n        setupAutoplayFailDetection();\n      } else {\n        // otherwise, schedule check whenever it is ready\n        this.elt.addEventListener('canplay', setupAutoplayFailDetection, {\n          passive: true,\n          once: true\n        });\n      }\n    }\n\n    return this;\n  }\n\n  /**\n   * Sets the audio/video volume.\n   *\n   * Calling `media.volume()` without an argument returns the current volume\n   * as a number in the range 0 (off) to 1 (maximum).\n   *\n   * The parameter, `val`, is optional. It's a number that sets the volume\n   * from 0 (off) to 1 (maximum). For example, calling `media.volume(0.5)`\n   * sets the volume to half of its maximum.\n   *\n   * @return {Number} current volume.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let dragon;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   dragon = createAudio('assets/lucky_dragons.mp3');\n   *\n   *   // Show the default media controls.\n   *   dragon.showControls();\n   *\n   *   describe('The text \"Volume: V\" on a gray square with media controls beneath it. The number \"V\" oscillates between 0 and 1 as the music plays.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Produce a number between 0 and 1.\n   *   let n = 0.5 * sin(frameCount * 0.01) + 0.5;\n   *\n   *   // Use n to set the volume.\n   *   dragon.volume(n);\n   *\n   *   // Get the current volume and display it.\n   *   let v = dragon.volume();\n   *\n   *   // Round v to 1 decimal place for display.\n   *   v = round(v, 1);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the volume.\n   *   text(`Volume: ${v}`, 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param {Number}            val volume between 0.0 and 1.0.\n   * @chainable\n   */\n  volume(val) {\n    if (typeof val === 'undefined') {\n      return this.elt.volume;\n    } else {\n      this.elt.volume = val;\n    }\n  }\n\n  /**\n   * Sets the audio/video playback speed.\n   *\n   * The parameter, `val`, is optional. It's a number that sets the playback\n   * speed. 1 plays the media at normal speed, 0.5 plays it at half speed, 2\n   * plays it at double speed, and so on. -1 plays the media at normal speed\n   * in reverse.\n   *\n   * Calling `media.speed()` returns the current speed as a number.\n   *\n   * Note: Not all browsers support backward playback. Even if they do,\n   * playback might not be smooth.\n   *\n   * @return {Number} current playback speed.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let dragon;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   dragon = createAudio('assets/lucky_dragons.mp3');\n   *\n   *   // Show the default media controls.\n   *   dragon.showControls();\n   *\n   *   describe('The text \"Speed: S\" on a gray square with media controls beneath it. The number \"S\" oscillates between 0 and 1 as the music plays.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Produce a number between 0 and 2.\n   *   let n = sin(frameCount * 0.01) + 1;\n   *\n   *   // Use n to set the playback speed.\n   *   dragon.speed(n);\n   *\n   *   // Get the current speed and display it.\n   *   let s = dragon.speed();\n   *\n   *   // Round s to 1 decimal place for display.\n   *   s = round(s, 1);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the speed.\n   *   text(`Speed: ${s}`, 50, 50);\n   * }\n   * </code>\n   */\n  /**\n   * @param {Number} speed  speed multiplier for playback.\n   * @chainable\n   */\n  speed(val) {\n    if (typeof val === 'undefined') {\n      return this.presetPlaybackRate || this.elt.playbackRate;\n    } else {\n      if (this.loadedmetadata) {\n        this.elt.playbackRate = val;\n      } else {\n        this.presetPlaybackRate = val;\n      }\n    }\n  }\n\n  /**\n   * Sets the media element's playback time.\n   *\n   * The parameter, `time`, is optional. It's a number that specifies the\n   * time, in seconds, to jump to when playback begins.\n   *\n   * Calling `media.time()` without an argument returns the number of seconds\n   * the audio/video has played.\n   *\n   * Note: Time resets to 0 when looping media restarts.\n   *\n   * @return {Number} current time (in seconds).\n   *\n   * @example\n   * <div>\n   * <code>\n   * let dragon;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   dragon = createAudio('assets/lucky_dragons.mp3');\n   *\n   *   // Show the default media controls.\n   *   dragon.showControls();\n   *\n   *   describe('The text \"S seconds\" on a gray square with media controls beneath it. The number \"S\" increases as the song plays.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Get the current playback time.\n   *   let s = dragon.time();\n   *\n   *   // Round s to 1 decimal place for display.\n   *   s = round(s, 1);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the playback time.\n   *   text(`${s} seconds`, 50, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let dragon;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   dragon = createAudio('assets/lucky_dragons.mp3');\n   *\n   *   // Show the default media controls.\n   *   dragon.showControls();\n   *\n   *   // Jump to 2 seconds to start.\n   *   dragon.time(2);\n   *\n   *   describe('The text \"S seconds\" on a gray square with media controls beneath it. The number \"S\" increases as the song plays.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Get the current playback time.\n   *   let s = dragon.time();\n   *\n   *   // Round s to 1 decimal place for display.\n   *   s = round(s, 1);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the playback time.\n   *   text(`${s} seconds`, 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @param {Number} time time to jump to (in seconds).\n   * @chainable\n   */\n  time(val) {\n    if (typeof val === 'undefined') {\n      return this.elt.currentTime;\n    } else {\n      this.elt.currentTime = val;\n      return this;\n    }\n  }\n\n  /**\n   * Returns the audio/video's duration in seconds.\n   *\n   * @return {Number} duration (in seconds).\n   *\n   * @example\n   * <div>\n   * <code>\n   * let dragon;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   dragon = createAudio('assets/lucky_dragons.mp3');\n   *\n   *   // Show the default media controls.\n   *   dragon.showControls();\n   *\n   *   describe('The text \"S seconds left\" on a gray square with media controls beneath it. The number \"S\" decreases as the song plays.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the time remaining.\n   *   let s = dragon.duration() - dragon.time();\n   *\n   *   // Round s to 1 decimal place for display.\n   *   s = round(s, 1);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the time remaining.\n   *   text(`${s} seconds left`, 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  duration() {\n    return this.elt.duration;\n  }\n  _ensureCanvas() {\n    if (!this.canvas) {\n      this.canvas = document.createElement('canvas');\n      this.drawingContext = this.canvas.getContext('2d');\n      this.setModified(true);\n    }\n\n    // Don't update the canvas again if we have already updated the canvas with\n    // the current frame\n    const needsRedraw = this._frameOnCanvas !== this._pInst.frameCount;\n    if (this.loadedmetadata && needsRedraw) {\n      // wait for metadata for w/h\n      if (this.canvas.width !== this.elt.width) {\n        this.canvas.width = this.elt.width;\n        this.canvas.height = this.elt.height;\n        this.width = this.canvas.width;\n        this.height = this.canvas.height;\n      }\n\n      this.drawingContext.clearRect(\n        0, 0, this.canvas.width, this.canvas.height);\n\n      if (this.flipped === true) {\n        this.drawingContext.save();\n        this.drawingContext.scale(-1, 1);\n        this.drawingContext.translate(-this.canvas.width, 0);\n      }\n\n      this.drawingContext.drawImage(\n        this.elt,\n        0,\n        0,\n        this.canvas.width,\n        this.canvas.height\n      );\n\n      if (this.flipped === true) {\n        this.drawingContext.restore();\n      }\n\n      this.setModified(true);\n      this._frameOnCanvas = this._pInst.frameCount;\n    }\n  }\n  loadPixels(...args) {\n    this._ensureCanvas();\n    return p5.Renderer2D.prototype.loadPixels.apply(this, args);\n  }\n  updatePixels(x, y, w, h) {\n    if (this.loadedmetadata) {\n      // wait for metadata\n      this._ensureCanvas();\n      p5.Renderer2D.prototype.updatePixels.call(this, x, y, w, h);\n    }\n    this.setModified(true);\n    return this;\n  }\n  get(...args) {\n    this._ensureCanvas();\n    return p5.Renderer2D.prototype.get.apply(this, args);\n  }\n  _getPixel(...args) {\n    this.loadPixels();\n    return p5.Renderer2D.prototype._getPixel.apply(this, args);\n  }\n\n  set(x, y, imgOrCol) {\n    if (this.loadedmetadata) {\n      // wait for metadata\n      this._ensureCanvas();\n      p5.Renderer2D.prototype.set.call(this, x, y, imgOrCol);\n      this.setModified(true);\n    }\n  }\n  copy(...args) {\n    this._ensureCanvas();\n    p5.prototype.copy.apply(this, args);\n  }\n  mask(...args) {\n    this.loadPixels();\n    this.setModified(true);\n    p5.Image.prototype.mask.apply(this, args);\n  }\n  /**\n   * helper method for web GL mode to figure out if the element\n   * has been modified and might need to be re-uploaded to texture\n   * memory between frames.\n   * @private\n   * @return {boolean} a boolean indicating whether or not the\n   * image has been updated or modified since last texture upload.\n   */\n  isModified() {\n    return this._modified;\n  }\n  /**\n   * helper method for web GL mode to indicate that an element has been\n   * changed or unchanged since last upload. gl texture upload will\n   * set this value to false after uploading the texture; or might set\n   * it to true if metadata has become available but there is no actual\n   * texture data available yet..\n   * @param {Boolean} val sets whether or not the element has been\n   * modified.\n   * @private\n   */\n  setModified(value) {\n    this._modified = value;\n  }\n  /**\n   * Calls a function when the audio/video reaches the end of its playback.\n   *\n   * The element is passed as an argument to the callback function.\n   *\n   * Note: The function won't be called if the media is looping.\n   *\n   * @param  {Function} callback function to call when playback ends.\n   *                             The `p5.MediaElement` is passed as\n   *                             the argument.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let beat;\n   * let isPlaying = false;\n   * let isDone = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   beat = createAudio('assets/beat.mp3');\n   *\n   *   // Call handleEnd() when the beat finishes.\n   *   beat.onended(handleEnd);\n   *\n   *   describe('The text \"Click to play\" written in black on a gray square. A beat plays when the user clicks. The text \"Done!\" appears when the beat finishes playing.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display different messages based on playback.\n   *   if (isDone === true) {\n   *     text('Done!', 50, 50);\n   *   } else if (isPlaying === false) {\n   *     text('Click to play', 50, 50);\n   *   } else {\n   *     text('Playing...', 50, 50);\n   *   }\n   * }\n   *\n   * // Play the beat when the user presses the mouse.\n   * function mousePressed() {\n   *   if (isPlaying === false) {\n   *     isPlaying = true;\n   *     beat.play();\n   *   }\n   * }\n   *\n   * // Set isDone when playback ends.\n   * function handleEnd() {\n   *   isDone = false;\n   * }\n   * </code>\n   * </div>\n   */\n  onended(callback) {\n    this._onended = callback;\n    return this;\n  }\n\n  /*** CONNECT TO WEB AUDIO API / p5.sound.js ***/\n\n  /**\n   * Sends the element's audio to an output.\n   *\n   * The parameter, `audioNode`, can be an `AudioNode` or an object from the\n   * `p5.sound` library.\n   *\n   * If no element is provided, as in `myElement.connect()`, the element\n   * connects to the main output. All connections are removed by the\n   * `.disconnect()` method.\n   *\n   * Note: This method is meant to be used with the p5.sound.js addon library.\n   *\n   * @param  {AudioNode|Object} audioNode AudioNode from the Web Audio API,\n   * or an object from the p5.sound library\n   */\n  connect(obj) {\n    let audioContext, mainOutput;\n\n    // if p5.sound exists, same audio context\n    if (typeof fn.getAudioContext === 'function') {\n      audioContext = fn.getAudioContext();\n      mainOutput = p5.soundOut.input;\n    } else {\n      try {\n        audioContext = obj.context;\n        mainOutput = audioContext.destination;\n      } catch (e) {\n        throw 'connect() is meant to be used with Web Audio API or p5.sound.js';\n      }\n    }\n\n    // create a Web Audio MediaElementAudioSourceNode if none already exists\n    if (!this.audioSourceNode) {\n      this.audioSourceNode = audioContext.createMediaElementSource(this.elt);\n\n      // connect to main output when this method is first called\n      this.audioSourceNode.connect(mainOutput);\n    }\n\n    // connect to object if provided\n    if (obj) {\n      if (obj.input) {\n        this.audioSourceNode.connect(obj.input);\n      } else {\n        this.audioSourceNode.connect(obj);\n      }\n    } else {\n      // otherwise connect to main output of p5.sound / AudioContext\n      this.audioSourceNode.connect(mainOutput);\n    }\n  }\n\n  /**\n   * Disconnect all Web Audio routing, including to the main output.\n   *\n   * This is useful if you want to re-route the output through audio effects,\n   * for example.\n   *\n   */\n  disconnect() {\n    if (this.audioSourceNode) {\n      this.audioSourceNode.disconnect();\n    } else {\n      throw 'nothing to disconnect';\n    }\n  }\n\n  /*** SHOW / HIDE CONTROLS ***/\n\n  /**\n   * Show the default\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement\" target=\"_blank\">HTMLMediaElement</a>\n   * controls.\n   *\n   * Note: The controls vary between web browsers.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background('cornflowerblue');\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(50);\n   *\n   *   // Display a dragon.\n   *   text('', 50, 50);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   let dragon = createAudio('assets/lucky_dragons.mp3');\n   *\n   *   // Show the default media controls.\n   *   dragon.showControls();\n   *\n   *   describe('A dragon emoji, , drawn in the center of a blue square. A song plays in the background. Audio controls are displayed beneath the canvas.');\n   * }\n   * </code>\n   * </div>\n   */\n  showControls() {\n    // must set style for the element to show on the page\n    this.elt.style['text-align'] = 'inherit';\n    this.elt.controls = true;\n  }\n\n  /**\n   * Hide the default\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement\" target=\"_blank\">HTMLMediaElement</a>\n   * controls.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let dragon;\n   * let isHidden = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   dragon = createAudio('assets/lucky_dragons.mp3');\n   *\n   *   // Show the default media controls.\n   *   dragon.showControls();\n   *\n   *   describe('The text \"Double-click to hide controls\" written in the middle of a gray square. A song plays in the background. Audio controls are displayed beneath the canvas. The controls appear/disappear when the user double-clicks the square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *\n   *   // Display a different message when controls are hidden or shown.\n   *   if (isHidden === true) {\n   *     text('Double-click to show controls', 10, 20, 80, 80);\n   *   } else {\n   *     text('Double-click to hide controls', 10, 20, 80, 80);\n   *   }\n   * }\n   *\n   * // Show/hide controls based on a double-click.\n   * function doubleClicked() {\n   *   if (isHidden === true) {\n   *     dragon.showControls();\n   *     isHidden = false;\n   *   } else {\n   *     dragon.hideControls();\n   *     isHidden = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  hideControls() {\n    this.elt.controls = false;\n  }\n\n  /**\n   * Schedules a function to call when the audio/video reaches a specific time\n   * during its playback.\n   *\n   * The first parameter, `time`, is the time, in seconds, when the function\n   * should run. This value is passed to `callback` as its first argument.\n   *\n   * The second parameter, `callback`, is the function to call at the specified\n   * cue time.\n   *\n   * The third parameter, `value`, is optional and can be any type of value.\n   * `value` is passed to `callback`.\n   *\n   * Calling `media.addCue()` returns an ID as a string. This is useful for\n   * removing the cue later.\n   *\n   * @param {Number}   time     cue time to run the callback function.\n   * @param {Function} callback function to call at the cue time.\n   * @param {Object} [value]    object to pass as the argument to\n   *                            `callback`.\n   * @return {Number} id ID of this cue,\n   *                     useful for `media.removeCue(id)`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   let beat = createAudio('assets/beat.mp3');\n   *\n   *   // Play the beat in a loop.\n   *   beat.loop();\n   *\n   *   // Schedule a few events.\n   *   beat.addCue(0, changeBackground, 'red');\n   *   beat.addCue(2, changeBackground, 'deeppink');\n   *   beat.addCue(4, changeBackground, 'orchid');\n   *   beat.addCue(6, changeBackground, 'lavender');\n   *\n   *   describe('A red square with a beat playing in the background. Its color changes every 2 seconds while the audio plays.');\n   * }\n   *\n   * // Change the background color.\n   * function changeBackground(c) {\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   */\n  addCue(time, callback, val) {\n    const id = this._cueIDCounter++;\n\n    const cue = new Cue(callback, time, id, val);\n    this._cues.push(cue);\n\n    if (!this.elt.ontimeupdate) {\n      this.elt.ontimeupdate = this._onTimeUpdate.bind(this);\n    }\n\n    return id;\n  }\n\n  /**\n   * Removes a callback based on its ID.\n   *\n   * @param  {Number} id ID of the cue, created by `media.addCue()`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let lavenderID;\n   * let isRemoved = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   let beat = createAudio('assets/beat.mp3');\n   *\n   *   // Play the beat in a loop.\n   *   beat.loop();\n   *\n   *   // Schedule a few events.\n   *   beat.addCue(0, changeBackground, 'red');\n   *   beat.addCue(2, changeBackground, 'deeppink');\n   *   beat.addCue(4, changeBackground, 'orchid');\n   *\n   *   // Record the ID of the \"lavender\" callback.\n   *   lavenderID = beat.addCue(6, changeBackground, 'lavender');\n   *\n   *   describe('The text \"Double-click to remove lavender.\" written on a red square. The color changes every 2 seconds while the audio plays. The lavender option is removed when the user double-clicks the square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Display different instructions based on the available callbacks.\n   *   if (isRemoved === false) {\n   *     text('Double-click to remove lavender.', 10, 10, 80, 80);\n   *   } else {\n   *     text('No more lavender.', 10, 10, 80, 80);\n   *   }\n   * }\n   *\n   * // Change the background color.\n   * function changeBackground(c) {\n   *   background(c);\n   * }\n   *\n   * // Remove the lavender color-change cue when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isRemoved === false) {\n   *     beat.removeCue(lavenderID);\n   *     isRemoved = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  removeCue(id) {\n    for (let i = 0; i < this._cues.length; i++) {\n      if (this._cues[i].id === id) {\n        console.log(id);\n        this._cues.splice(i, 1);\n      }\n    }\n\n    if (this._cues.length === 0) {\n      this.elt.ontimeupdate = null;\n    }\n  }\n\n  /**\n   * Removes all functions scheduled with `media.addCue()`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let isChanging = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   let beat = createAudio('assets/beat.mp3');\n   *\n   *   // Play the beat in a loop.\n   *   beat.loop();\n   *\n   *   // Schedule a few events.\n   *   beat.addCue(0, changeBackground, 'red');\n   *   beat.addCue(2, changeBackground, 'deeppink');\n   *   beat.addCue(4, changeBackground, 'orchid');\n   *   beat.addCue(6, changeBackground, 'lavender');\n   *\n   *   describe('The text \"Double-click to stop changing.\" written on a square. The color changes every 2 seconds while the audio plays. The color stops changing when the user double-clicks the square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Display different instructions based on the available callbacks.\n   *   if (isChanging === true) {\n   *     text('Double-click to stop changing.', 10, 10, 80, 80);\n   *   } else {\n   *     text('No more changes.', 10, 10, 80, 80);\n   *   }\n   * }\n   *\n   * // Change the background color.\n   * function changeBackground(c) {\n   *   background(c);\n   * }\n   *\n   * // Remove cued functions and stop changing colors when the user\n   * // double-clicks.\n   * function doubleClicked() {\n   *   if (isChanging === true) {\n   *     beat.clearCues();\n   *     isChanging = false;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  clearCues() {\n    this._cues = [];\n    this.elt.ontimeupdate = null;\n  }\n\n  // private method that checks for cues to be fired if events\n  // have been scheduled using addCue(callback, time).\n  _onTimeUpdate() {\n    const playbackTime = this.time();\n\n    for (let i = 0; i < this._cues.length; i++) {\n      const callbackTime = this._cues[i].time;\n      const val = this._cues[i].val;\n\n      if (this._prevTime < callbackTime && callbackTime <= playbackTime) {\n        // pass the scheduled callbackTime as parameter to the callback\n        this._cues[i].callback(val);\n      }\n    }\n\n    this._prevTime = playbackTime;\n  }\n}\n\n// Cue inspired by JavaScript setTimeout, and the\n// Tone.js Transport Timeline Event, MIT License Yotam Mann 2015 tonejs.org\n// eslint-disable-next-line no-unused-vars\nclass Cue {\n  constructor(callback, time, id, val) {\n    this.callback = callback;\n    this.time = time;\n    this.id = id;\n    this.val = val;\n  }\n}\n\nfunction media(p5, fn){\n  /**\n   * Helpers for create methods.\n   */\n  function addElement(elt, pInst, media) {\n    const node = pInst._userNode ? pInst._userNode : document.body;\n    node.appendChild(elt);\n    const c = media\n      ? new MediaElement(elt, pInst)\n      : new Element(elt, pInst);\n    pInst._elements.push(c);\n    return c;\n  }\n\n  /** VIDEO STUFF **/\n\n  // Helps perform similar tasks for media element methods.\n  function createMedia(pInst, type, src, callback) {\n    const elt = document.createElement(type);\n\n    // Create source elements from given sources\n    src = src || '';\n    if (typeof src === 'string') {\n      src = [src];\n    }\n    for (const mediaSource of src) {\n      const sourceEl = document.createElement('source');\n      sourceEl.setAttribute('src', mediaSource);\n      elt.appendChild(sourceEl);\n    }\n\n    const mediaEl = addElement(elt, pInst, true);\n    mediaEl.loadedmetadata = false;\n\n    // set width and height onload metadata\n    elt.addEventListener('loadedmetadata', () => {\n      mediaEl.width = elt.videoWidth;\n      mediaEl.height = elt.videoHeight;\n\n      // set elt width and height if not set\n      if (mediaEl.elt.width === 0) mediaEl.elt.width = elt.videoWidth;\n      if (mediaEl.elt.height === 0) mediaEl.elt.height = elt.videoHeight;\n      if (mediaEl.presetPlaybackRate) {\n        mediaEl.elt.playbackRate = mediaEl.presetPlaybackRate;\n        delete mediaEl.presetPlaybackRate;\n      }\n      mediaEl.loadedmetadata = true;\n    });\n\n    // If callback is provided, attach to element\n    if (typeof callback === 'function') {\n      const callbackHandler = () => {\n        callback(mediaEl);\n        elt.removeEventListener('canplaythrough', callbackHandler);\n      };\n      elt.addEventListener('canplaythrough', callbackHandler);\n    }\n\n    return mediaEl;\n  }\n\n  /**\n   * Creates a `&lt;video&gt;` element for simple audio/video playback.\n   *\n   * `createVideo()` returns a new\n   * <a href=\"#/p5.MediaElement\">p5.MediaElement</a> object. Videos are shown by\n   * default. They can be hidden by calling `video.hide()` and drawn to the\n   * canvas using <a href=\"#/p5/image\">image()</a>.\n   *\n   * The first parameter, `src`, is the path the video. If a single string is\n   * passed, as in `'assets/topsecret.mp4'`, a single video is loaded. An array\n   * of strings can be used to load the same video in different formats. For\n   * example, `['assets/topsecret.mp4', 'assets/topsecret.ogv', 'assets/topsecret.webm']`.\n   * This is useful for ensuring that the video can play across different browsers with\n   * different capabilities. See\n   * <a href='https://developer.mozilla.org/en-US/docs/Web/HTML/Supported_media_formats'>MDN</a>\n   * for more information about supported formats.\n   *\n   * The second parameter, `callback`, is optional. It's a function to call once\n   * the video is ready to play.\n   *\n   * @param  {String|String[]} src path to a video file, or an array of paths for\n   *                               supporting different browsers.\n   * @param  {Function} [callback] function to call once the video is ready to play.\n   * @return {p5.MediaElement}   new <a href=\"#/p5.MediaElement\">p5.MediaElement</a> object.\n   *\n   * @example\n   * <div class='notest'>\n   * <code>\n   * function setup() {\n   *   noCanvas();\n   *\n   *   // Load a video and add it to the page.\n   *   // Note: this may not work in some browsers.\n   *   let video = createVideo('assets/small.mp4');\n   *\n   *   // Show the default video controls.\n   *   video.showControls();\n   *\n   *   describe('A video of a toy robot with playback controls beneath it.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='notest'>\n   * <code>\n   * function setup() {\n   *   noCanvas();\n   *\n   *   // Load a video and add it to the page.\n   *   // Provide an array options for different file formats.\n   *   let video = createVideo(\n   *     ['assets/small.mp4', 'assets/small.ogv', 'assets/small.webm']\n   *   );\n   *\n   *   // Show the default video controls.\n   *   video.showControls();\n   *\n   *   describe('A video of a toy robot with playback controls beneath it.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='notest'>\n   * <code>\n   * let video;\n   *\n   * function setup() {\n   *   noCanvas();\n   *\n   *   // Load a video and add it to the page.\n   *   // Provide an array options for different file formats.\n   *   // Call mute() once the video loads.\n   *   video = createVideo(\n   *     ['assets/small.mp4', 'assets/small.ogv', 'assets/small.webm'],\n   *     muteVideo\n   *   );\n   *\n   *   // Show the default video controls.\n   *   video.showControls();\n   *\n   *   describe('A video of a toy robot with playback controls beneath it.');\n   * }\n   *\n   * // Mute the video once it loads.\n   * function muteVideo() {\n   *   video.volume(0);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createVideo = function (src, callback) {\n    // p5._validateParameters('createVideo', arguments);\n    return createMedia(this, 'video', src, callback);\n  };\n\n  /** AUDIO STUFF **/\n\n  /**\n   * Creates a hidden `&lt;audio&gt;` element for simple audio playback.\n   *\n   * `createAudio()` returns a new\n   * <a href=\"#/p5.MediaElement\">p5.MediaElement</a> object.\n   *\n   * The first parameter, `src`, is the path the video. If a single string is\n   * passed, as in `'assets/video.mp4'`, a single video is loaded. An array\n   * of strings can be used to load the same video in different formats. For\n   * example, `['assets/video.mp4', 'assets/video.ogv', 'assets/video.webm']`.\n   * This is useful for ensuring that the video can play across different\n   * browsers with different capabilities. See\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Supported_media_formats\" target=\"_blank\">MDN</a>\n   * for more information about supported formats.\n   *\n   * The second parameter, `callback`, is optional. It's a function to call once\n   * the audio is ready to play.\n   *\n   * @param  {String|String[]} [src] path to an audio file, or an array of paths\n   *                                 for supporting different browsers.\n   * @param  {Function} [callback]   function to call once the audio is ready to play.\n   * @return {p5.MediaElement}       new <a href=\"#/p5.MediaElement\">p5.MediaElement</a> object.\n   *\n   * @example\n   * <div class='notest'>\n   * <code>\n   * function setup() {\n   *   noCanvas();\n   *\n   *   // Load the audio.\n   *   let beat = createAudio('assets/beat.mp3');\n   *\n   *   // Show the default audio controls.\n   *   beat.showControls();\n   *\n   *   describe('An audio beat plays when the user double-clicks the square.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createAudio = function (src, callback) {\n    // p5._validateParameters('createAudio', arguments);\n    return createMedia(this, 'audio', src, callback);\n  };\n\n  /** CAMERA STUFF **/\n\n  fn.VIDEO = 'video';\n\n  fn.AUDIO = 'audio';\n\n  // from: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n  // Older browsers might not implement mediaDevices at all, so we set an empty object first\n  if (navigator.mediaDevices === undefined) {\n    navigator.mediaDevices = {};\n  }\n\n  // Some browsers partially implement mediaDevices. We can't just assign an object\n  // with getUserMedia as it would overwrite existing properties.\n  // Here, we will just add the getUserMedia property if it's missing.\n  if (navigator.mediaDevices.getUserMedia === undefined) {\n    navigator.mediaDevices.getUserMedia = function (constraints) {\n      // First get ahold of the legacy getUserMedia, if present\n      const getUserMedia =\n        navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n\n      // Some browsers just don't implement it - return a rejected promise with an error\n      // to keep a consistent interface\n      if (!getUserMedia) {\n        return Promise.reject(\n          new Error('getUserMedia is not implemented in this browser')\n        );\n      }\n\n      // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n      return new Promise(function (resolve, reject) {\n        getUserMedia.call(navigator, constraints, resolve, reject);\n      });\n    };\n  }\n\n  /**\n   * Creates a `&lt;video&gt;` element that \"captures\" the audio/video stream from\n   * the webcam and microphone.\n   *\n   * `createCapture()` returns a new\n   * <a href=\"#/p5.MediaElement\">p5.MediaElement</a> object. Videos are shown by\n   * default. They can be hidden by calling `capture.hide()` and drawn to the\n   * canvas using <a href=\"#/p5/image\">image()</a>.\n   *\n   * The first parameter, `type`, is optional. It sets the type of capture to\n   * use. By default, `createCapture()` captures both audio and video. If `VIDEO`\n   * is passed, as in `createCapture(VIDEO)`, only video will be captured.\n   * If `AUDIO` is passed, as in `createCapture(AUDIO)`, only audio will be\n   * captured. A constraints object can also be passed to customize the stream.\n   * See the <a href=\"http://w3c.github.io/mediacapture-main/getusermedia.html#media-track-constraints\" target=\"_blank\">\n   * W3C documentation</a> for possible properties. Different browsers support different\n   * properties.\n   *\n   * The 'flipped' property is an optional property which can be set to `{flipped:true}`\n   * to mirror the video output.If it is true then it means that video will be mirrored\n   * or flipped and if nothing is mentioned then by default it will be `false`.\n   *\n   * The second parameter,`callback`, is optional. It's a function to call once\n   * the capture is ready for use. The callback function should have one\n   * parameter, `stream`, that's a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/MediaStream\" target=\"_blank\">MediaStream</a> object.\n   *\n   * Note: `createCapture()` only works when running a sketch locally or using HTTPS. Learn more\n   * <a href=\"http://stackoverflow.com/questions/34197653/getusermedia-in-chrome-47-without-using-https\" target=\"_blank\">here</a>\n   * and <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\" target=\"_blank\">here</a>.\n   *\n   * @param  {(AUDIO|VIDEO|Object)}  [type] type of capture, either AUDIO or VIDEO,\n   *                                   or a constraints object. Both video and audio\n   *                                   audio streams are captured by default.\n   * @param  {Object}                  [flipped] flip the capturing video and mirror the output with `{flipped:true}`. By\n   *                                   default it is false.\n   * @param  {Function}                [callback] function to call once the stream\n   *                                   has loaded.\n   * @return {p5.MediaElement} new <a href=\"#/p5.MediaElement\">p5.MediaElement</a> object.\n   *\n   * @example\n   * <div class='notest'>\n   * <code>\n   * function setup() {\n   *   noCanvas();\n   *\n   *   // Create the video capture.\n   *   createCapture(VIDEO);\n   *\n   *   describe('A video stream from the webcam.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='notest'>\n   * <code>\n   * let capture;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create the video capture and hide the element.\n   *   capture = createCapture(VIDEO);\n   *   capture.hide();\n   *\n   *   describe('A video stream from the webcam with inverted colors.');\n   * }\n   *\n   * function draw() {\n   *   // Draw the video capture within the canvas.\n   *   image(capture, 0, 0, width, width * capture.height / capture.width);\n   *\n   *   // Invert the colors in the stream.\n   *   filter(INVERT);\n   * }\n   * </code>\n   * </div>\n   * <div class='notest'>\n   * <code>\n   * let capture;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create the video capture with mirrored output.\n   *   capture = createCapture(VIDEO,{ flipped:true });\n   *   capture.size(100,100);\n   *\n   *   describe('A video stream from the webcam with flipped or mirrored output.');\n   * }\n   *\n   * </code>\n   * </div>\n   *\n   * <div class='notest norender'>\n   * <code>\n   * function setup() {\n   *   createCanvas(480, 120);\n   *\n   *   // Create a constraints object.\n   *   let constraints = {\n   *     video: {\n   *       mandatory: {\n   *         minWidth: 1280,\n   *         minHeight: 720\n   *       },\n   *       optional: [{ maxFrameRate: 10 }]\n   *     },\n   *     audio: false\n   *   };\n   *\n   *   // Create the video capture.\n   *   createCapture(constraints);\n   *\n   *   describe('A video stream from the webcam.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createCapture = function (...args) {\n    // p5._validateParameters('createCapture', args);\n\n    // return if getUserMedia is not supported by the browser\n    if (!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia)) {\n      throw new DOMException('getUserMedia not supported in this browser');\n    }\n\n    let useVideo = true;\n    let useAudio = true;\n    let constraints;\n    let callback;\n    let flipped = false;\n\n    for (const arg of args) {\n      if (arg === fn.VIDEO) useAudio = false;\n      else if (arg === fn.AUDIO) useVideo = false;\n      else if (typeof arg === 'object') {\n        if (arg.flipped !== undefined) {\n          flipped = arg.flipped;\n          delete arg.flipped;\n        }\n        constraints = Object.assign({}, constraints, arg);\n      }\n      else if (typeof arg === 'function') {\n        callback = arg;\n      }\n    }\n\n    const videoConstraints = { video: useVideo, audio: useAudio };\n    constraints = Object.assign({}, videoConstraints, constraints);\n    const domElement = document.createElement('video');\n    // required to work in iOS 11 & up:\n    domElement.setAttribute('playsinline', '');\n    navigator.mediaDevices.getUserMedia(constraints).then(function (stream) {\n      try {\n        if ('srcObject' in domElement) {\n          domElement.srcObject = stream;\n        } else {\n          domElement.src = window.URL.createObjectURL(stream);\n        }\n      }\n      catch (err) {\n        domElement.src = stream;\n      }\n    }).catch(e => {\n      if (e.name === 'NotFoundError')\n        p5._friendlyError('No webcam found on this device', 'createCapture');\n      if (e.name === 'NotAllowedError')\n        p5._friendlyError('Access to the camera was denied', 'createCapture');\n\n      console.error(e);\n    });\n\n    const videoEl = addElement(domElement, this, true);\n    videoEl.loadedmetadata = false;\n    // set width and height onload metadata\n    domElement.addEventListener('loadedmetadata', function () {\n      domElement.play();\n      if (domElement.width) {\n        videoEl.width = domElement.width;\n        videoEl.height = domElement.height;\n        if (flipped) {\n          videoEl.elt.style.transform = 'scaleX(-1)';\n        }\n      } else {\n        videoEl.width = videoEl.elt.width = domElement.videoWidth;\n        videoEl.height = videoEl.elt.height = domElement.videoHeight;\n      }\n      videoEl.loadedmetadata = true;\n\n      if (callback) callback(domElement.srcObject);\n    });\n    videoEl.flipped = flipped;\n    return videoEl;\n  };\n\n  // =============================================================================\n  //                         p5.MediaElement additions\n  // =============================================================================\n\n  /**\n   * A class to handle audio and video.\n   *\n   * `p5.MediaElement` extends <a href=\"#/p5.Element\">p5.Element</a> with\n   * methods to handle audio and video. `p5.MediaElement` objects are created by\n   * calling <a href=\"#/p5/createVideo\">createVideo</a>,\n   * <a href=\"#/p5/createAudio\">createAudio</a>, and\n   * <a href=\"#/p5/createCapture\">createCapture</a>.\n   *\n   * @class p5.MediaElement\n   * @param {String} elt DOM node that is wrapped\n   * @extends p5.Element\n   *\n   * @example\n   * <div class='notest'>\n   * <code>\n   * let capture;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createCapture().\n   *   capture = createCapture(VIDEO);\n   *   capture.hide();\n   *\n   *   describe('A webcam feed with inverted colors.');\n   * }\n   *\n   * function draw() {\n   *   // Display the video stream and invert the colors.\n   *   image(capture, 0, 0, width, width * capture.height / capture.width);\n   *   filter(INVERT);\n   * }\n   * </code>\n   * </div>\n   */\n  p5.MediaElement = MediaElement;\n\n  /**\n   * Path to the media element's source as a string.\n   *\n   * @for p5.MediaElement\n   * @property src\n   * @return {String} src\n   * @example\n   * <div>\n   * <code>\n   * let beat;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.MediaElement using createAudio().\n   *   beat = createAudio('assets/beat.mp3');\n   *\n   *   describe('The text \"https://p5js.org/reference/assets/beat.mp3\" written in black on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   textWrap(CHAR);\n   *   text(beat.src, 10, 10, 80, 80);\n   * }\n   * </code>\n   * </div>\n   */\n}\n\nif(typeof p5 !== 'undefined'){\n  media(p5, p5.prototype);\n}\n\nexport { MediaElement, media as default };\n","import { e as CORNER, i as CORNERS, a as RADIUS, C as CENTER } from '../constants-8IpwyBct.js';\n\n/**\n * @requires constants\n */\n\n\n/*\n  This function normalizes the first four arguments given to rect, ellipse and arc\n  according to the mode.\n  It returns a 'bounding box' object containing the coordinates of the upper left corner (x, y),\n  and width and height (w, h). The returned width and height are always positive.\n*/\nfunction modeAdjust(a, b, c, d, mode) {\n  let bbox;\n\n  if (mode === CORNER) {\n\n    // CORNER mode already corresponds to a bounding box (top-left corner, width, height).\n    // For negative widhts or heights, the absolute value is used.\n    bbox = {\n      x: a,\n      y: b,\n      w: Math.abs(c),\n      h: Math.abs(d)\n    };\n\n  } else if (mode === CORNERS) {\n\n    // CORNERS mode uses two opposite corners, in any configuration.\n    // Make sure to get the top left corner by using the minimum of the x and y coordniates.\n    bbox = {\n      x: Math.min(a, c),\n      y: Math.min(b, d),\n      w: Math.abs(c - a),\n      h: Math.abs(d - b)\n    };\n\n  } else if (mode === RADIUS) {\n\n    // RADIUS mode uses the center point and half the width and height.\n    // c (half width) and d (half height) could be negative, so use the absolute value\n    // in calculating the top left corner (x, y).\n    c = Math.abs(c);\n    d = Math.abs(d);\n    bbox = {\n      x: a - c,\n      y: b - d,\n      w: 2 * c,\n      h: 2 * d\n    };\n\n  } else if (mode === CENTER) {\n\n    // CENTER mode uses the center point, width and height.\n    // c (width) and d (height) could be negative, so use the absolute value\n    // in calculating the top-left corner (x, y).\n    c = Math.abs(c);\n    d = Math.abs(d);\n    bbox = {\n      x: a - (c * 0.5),\n      y: b - (d * 0.5),\n      w: c,\n      h: d\n    };\n\n  }\n\n  return bbox;\n}\n\nvar canvas = { modeAdjust };\n\nexport { canvas as default };\n","import { e as CORNER, f as TWO_PI, g as HALF_PI, h as PI } from '../constants-8IpwyBct.js';\nimport canvas from '../core/helpers.js';\n\n/**\n * @module Shape\n * @submodule 2D Primitives\n * @for p5\n * @requires core\n * @requires constants\n */\n\n\nfunction primitives(p5, fn){\n  /**\n   * This function does 3 things:\n   *\n   *   1. Bounds the desired start/stop angles for an arc (in radians) so that:\n   *\n   *          0 <= start < TWO_PI ;    start <= stop < start + TWO_PI\n   *\n   *      This means that the arc rendering functions don't have to be concerned\n   *      with what happens if stop is smaller than start, or if the arc 'goes\n   *      round more than once', etc.: they can just start at start and increase\n   *      until stop and the correct arc will be drawn.\n   *\n   *   2. Optionally adjusts the angles within each quadrant to counter the naive\n   *      scaling of the underlying ellipse up from the unit circle.  Without\n   *      this, the angles become arbitrary when width != height: 45 degrees\n   *      might be drawn at 5 degrees on a 'wide' ellipse, or at 85 degrees on\n   *      a 'tall' ellipse.\n   *\n   *   3. Flags up when start and stop correspond to the same place on the\n   *      underlying ellipse.  This is useful if you want to do something special\n   *      there (like rendering a whole ellipse instead).\n   */\n  fn._normalizeArcAngles = (\n    start,\n    stop,\n    width,\n    height,\n    correctForScaling\n  ) => {\n    const epsilon = 0.00001; // Smallest visible angle on displays up to 4K.\n    let separation;\n\n    // The order of the steps is important here: each one builds upon the\n    // adjustments made in the steps that precede it.\n\n    // Constrain both start and stop to [0,TWO_PI).\n    start = start - TWO_PI * Math.floor(start / TWO_PI);\n    stop = stop - TWO_PI * Math.floor(stop / TWO_PI);\n\n    // Get the angular separation between the requested start and stop points.\n    //\n    // Technically this separation only matches what gets drawn if\n    // correctForScaling is enabled.  We could add a more complicated calculation\n    // for when the scaling is uncorrected (in which case the drawn points could\n    // end up pushed together or pulled apart quite dramatically relative to what\n    // was requested), but it would make things more opaque for little practical\n    // benefit.\n    //\n    // (If you do disable correctForScaling and find that correspondToSamePoint\n    // is set too aggressively, the easiest thing to do is probably to just make\n    // epsilon smaller...)\n    separation = Math.min(\n      Math.abs(start - stop),\n      TWO_PI - Math.abs(start - stop)\n    );\n\n    // Optionally adjust the angles to counter linear scaling.\n    if (correctForScaling) {\n      if (start <= HALF_PI) {\n        start = Math.atan(width / height * Math.tan(start));\n      } else if (start > HALF_PI && start <= 3 * HALF_PI) {\n        start = Math.atan(width / height * Math.tan(start)) + PI;\n      } else {\n        start = Math.atan(width / height * Math.tan(start)) + TWO_PI;\n      }\n      if (stop <= HALF_PI) {\n        stop = Math.atan(width / height * Math.tan(stop));\n      } else if (stop > HALF_PI && stop <= 3 * HALF_PI) {\n        stop = Math.atan(width / height * Math.tan(stop)) + PI;\n      } else {\n        stop = Math.atan(width / height * Math.tan(stop)) + TWO_PI;\n      }\n    }\n\n    // Ensure that start <= stop < start + TWO_PI.\n    if (start > stop) {\n      stop += TWO_PI;\n    }\n\n    return {\n      start,\n      stop,\n      correspondToSamePoint: separation < epsilon\n    };\n  };\n\n  /**\n   * Draws an arc.\n   *\n   * An arc is a section of an ellipse defined by the `x`, `y`, `w`, and\n   * `h` parameters. `x` and `y` set the location of the arc's center. `w` and\n   * `h` set the arc's width and height. See\n   * <a href=\"#/p5/ellipse\">ellipse()</a> and\n   * <a href=\"#/p5/ellipseMode\">ellipseMode()</a> for more details.\n   *\n   * The fifth and sixth parameters, `start` and `stop`, set the angles\n   * between which to draw the arc. Arcs are always drawn clockwise from\n   * `start` to `stop`. Angles are always given in radians.\n   *\n   * The seventh parameter, `mode`, is optional. It determines the arc's fill\n   * style. The fill modes are a semi-circle (`OPEN`), a closed semi-circle\n   * (`CHORD`), or a closed pie segment (`PIE`).\n   *\n   * The eighth parameter, `detail`, is also optional. It determines how many\n   * vertices are used to draw the arc in WebGL mode. The default value is 25.\n   *\n   * @method arc\n   * @param  {Number} x      x-coordinate of the arc's ellipse.\n   * @param  {Number} y      y-coordinate of the arc's ellipse.\n   * @param  {Number} w      width of the arc's ellipse by default.\n   * @param  {Number} h      height of the arc's ellipse by default.\n   * @param  {Number} start  angle to start the arc, specified in radians.\n   * @param  {Number} stop   angle to stop the arc, specified in radians.\n   * @param  {(CHORD|PIE|OPEN)} [mode] optional parameter to determine the way of drawing\n   *                         the arc. either CHORD, PIE, or OPEN.\n   * @param  {Integer} [detail] optional parameter for WebGL mode only. This is to\n   *                         specify the number of vertices that makes up the\n   *                         perimeter of the arc. Default value is 25. Won't\n   *                         draw a stroke for a detail of more than 50.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   arc(50, 50, 80, 80, 0, PI + HALF_PI);\n   *\n   *   describe('A white circle on a gray canvas. The top-right quarter of the circle is missing.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   arc(50, 50, 80, 40, 0, PI + HALF_PI);\n   *\n   *   describe('A white ellipse on a gray canvas. The top-right quarter of the ellipse is missing.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Bottom-right.\n   *   arc(50, 55, 50, 50, 0, HALF_PI);\n   *\n   *   noFill();\n   *\n   *   // Bottom-left.\n   *   arc(50, 55, 60, 60, HALF_PI, PI);\n   *\n   *   // Top-left.\n   *   arc(50, 55, 70, 70, PI, PI + QUARTER_PI);\n   *\n   *   // Top-right.\n   *   arc(50, 55, 80, 80, PI + QUARTER_PI, TWO_PI);\n   *\n   *   describe(\n   *     'A shattered outline of an circle with a quarter of a white circle at the bottom-right.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Default fill mode.\n   *   arc(50, 50, 80, 80, 0, PI + QUARTER_PI);\n   *\n   *   describe('A white circle with the top-right third missing. The bottom is outlined in black.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // OPEN fill mode.\n   *   arc(50, 50, 80, 80, 0, PI + QUARTER_PI, OPEN);\n   *\n   *   describe(\n   *     'A white circle missing a section from the top-right. The bottom is outlined in black.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // CHORD fill mode.\n   *   arc(50, 50, 80, 80, 0, PI + QUARTER_PI, CHORD);\n   *\n   *   describe('A white circle with a black outline missing a section from the top-right.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // PIE fill mode.\n   *   arc(50, 50, 80, 80, 0, PI + QUARTER_PI, PIE);\n   *\n   *   describe('A white circle with a black outline. The top-right third is missing.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // PIE fill mode.\n   *   arc(0, 0, 80, 80, 0, PI + QUARTER_PI, PIE);\n   *\n   *   describe('A white circle with a black outline. The top-right third is missing.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // PIE fill mode with 5 vertices.\n   *   arc(0, 0, 80, 80, 0, PI + QUARTER_PI, PIE, 5);\n   *\n   *   describe('A white circle with a black outline. The top-right third is missing.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A yellow circle on a black background. The circle opens and closes its mouth.');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Style the arc.\n   *   noStroke();\n   *   fill(255, 255, 0);\n   *\n   *   // Update start and stop angles.\n   *   let biteSize = PI / 16;\n   *   let startAngle = biteSize * sin(frameCount * 0.1) + biteSize;\n   *   let endAngle = TWO_PI - startAngle;\n   *\n   *   // Draw the arc.\n   *   arc(50, 50, 80, 80, startAngle, endAngle, PIE);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.arc = function(x, y, w, h, start, stop, mode, detail) {\n    // this.validate(\"p5.arc\", arguments);\n    // p5._validateParameters('arc', arguments);\n\n    // if the current stroke and fill settings wouldn't result in something\n    // visible, exit immediately\n    if (!this._renderer.states.strokeColor && !this._renderer.states.fillColor) {\n      return this;\n    }\n\n    if (start === stop) {\n      return this;\n    }\n\n    start = this._toRadians(start);\n    stop = this._toRadians(stop);\n\n    const vals = canvas.modeAdjust(x, y, w, h, this._renderer.states.ellipseMode);\n    const angles = this._normalizeArcAngles(start, stop, vals.w, vals.h, true);\n\n    if (angles.correspondToSamePoint) {\n      // If the arc starts and ends at (near enough) the same place, we choose to\n      // draw an ellipse instead.  This is preferable to faking an ellipse (by\n      // making stop ever-so-slightly less than start + TWO_PI) because the ends\n      // join up to each other rather than at a vertex at the centre (leaving\n      // an unwanted spike in the stroke/fill).\n      this._renderer.ellipse([vals.x, vals.y, vals.w, vals.h, detail]);\n    } else {\n      this._renderer.arc(\n        vals.x,\n        vals.y,\n        vals.w,\n        vals.h,\n        angles.start, // [0, TWO_PI)\n        angles.stop, // [start, start + TWO_PI)\n        mode,\n        detail\n      );\n\n      //accessible Outputs\n      if (this._accessibleOutputs.grid || this._accessibleOutputs.text) {\n        this._accsOutput('arc', [\n          vals.x,\n          vals.y,\n          vals.w,\n          vals.h,\n          angles.start,\n          angles.stop,\n          mode\n        ]);\n      }\n    }\n\n    return this;\n  };\n\n  /**\n   * Draws an ellipse (oval).\n   *\n   * An ellipse is a round shape defined by the `x`, `y`, `w`, and\n   * `h` parameters. `x` and `y` set the location of its center. `w` and\n   * `h` set its width and height. See\n   * <a href=\"#/p5/ellipseMode\">ellipseMode()</a> for other ways to set\n   * its position.\n   *\n   * If no height is set, the value of width is used for both the width and\n   * height. If a negative height or width is specified, the absolute value is\n   * taken.\n   *\n   * The fifth parameter, `detail`, is also optional. It determines how many\n   * vertices are used to draw the ellipse in WebGL mode. The default value is\n   * 25.\n   *\n   * @method ellipse\n   * @param  {Number} x x-coordinate of the center of the ellipse.\n   * @param  {Number} y y-coordinate of the center of the ellipse.\n   * @param  {Number} w width of the ellipse.\n   * @param  {Number} [h] height of the ellipse.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   ellipse(50, 50, 80, 80);\n   *\n   *   describe('A white circle on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   ellipse(50, 50, 80);\n   *\n   *   describe('A white circle on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   ellipse(50, 50, 80, 40);\n   *\n   *   describe('A white ellipse on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   ellipse(0, 0, 80, 40);\n   *\n   *   describe('A white ellipse on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Use 6 vertices.\n   *   ellipse(0, 0, 80, 40, 6);\n   *\n   *   describe('A white hexagon on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method ellipse\n   * @param  {Number} x\n   * @param  {Number} y\n   * @param  {Number} w\n   * @param  {Number} h\n   * @param  {Integer} [detail] optional parameter for WebGL mode only. This is to\n   *                         specify the number of vertices that makes up the\n   *                         perimeter of the ellipse. Default value is 25. Won't\n   *                         draw a stroke for a detail of more than 50.\n   */\n  fn.ellipse = function(x, y, w, h, detailX) {\n    // p5._validateParameters('ellipse', arguments);\n    return this._renderEllipse(...arguments);\n  };\n\n  /**\n   * Draws a circle.\n   *\n   * A circle is a round shape defined by the `x`, `y`, and `d` parameters.\n   * `x` and `y` set the location of its center. `d` sets its width and height (diameter).\n   * Every point on the circle's edge is the same distance, `0.5 * d`, from its center.\n   * `0.5 * d` (half the diameter) is the circle's radius.\n   * See <a href=\"#/p5/ellipseMode\">ellipseMode()</a> for other ways to set its position.\n   *\n   * @method circle\n   * @param  {Number} x  x-coordinate of the center of the circle.\n   * @param  {Number} y  y-coordinate of the center of the circle.\n   * @param  {Number} d  diameter of the circle.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   circle(50, 50, 25);\n   *\n   *   describe('A white circle with black outline in the middle of a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   circle(0, 0, 25);\n   *\n   *   describe('A white circle with black outline in the middle of a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.circle = function(...args) {\n    // p5._validateParameters('circle', args);\n    const argss = args.slice( 0, 2);\n    argss.push(args[2], args[2]);\n    return this._renderEllipse(...argss);\n  };\n\n  // internal method for drawing ellipses (without parameter validation)\n  fn._renderEllipse = function(x, y, w, h, detailX) {\n    // if the current stroke and fill settings wouldn't result in something\n    // visible, exit immediately\n    if (!this._renderer.states.strokeColor && !this._renderer.states.fillColor) {\n      return this;\n    }\n\n    // Duplicate 3rd argument if only 3 given.\n    if (typeof h === 'undefined') {\n      h = w;\n    }\n\n    const vals = canvas.modeAdjust(x, y, w, h, this._renderer.states.ellipseMode);\n    this._renderer.ellipse([vals.x, vals.y, vals.w, vals.h, detailX]);\n\n    //accessible Outputs\n    if (this._accessibleOutputs.grid || this._accessibleOutputs.text) {\n      this._accsOutput('ellipse', [vals.x, vals.y, vals.w, vals.h]);\n    }\n\n    return this;\n  };\n\n  /**\n   * Draws a straight line between two points.\n   *\n   * A line's default width is one pixel. The version of `line()` with four\n   * parameters draws the line in 2D. To color a line, use the\n   * <a href=\"#/p5/stroke\">stroke()</a> function. To change its width, use the\n   * <a href=\"#/p5/strokeWeight\">strokeWeight()</a> function. A line\n   * can't be filled, so the <a href=\"#/p5/fill\">fill()</a> function won't\n   * affect the line's color.\n   *\n   * The version of `line()` with six parameters allows the line to be drawn in\n   * 3D space. Doing so requires adding the `WEBGL` argument to\n   * <a href=\"#/p5/createCanvas\">createCanvas()</a>.\n   *\n   * @method line\n   * @param  {Number} x1 the x-coordinate of the first point.\n   * @param  {Number} y1 the y-coordinate of the first point.\n   * @param  {Number} x2 the x-coordinate of the second point.\n   * @param  {Number} y2 the y-coordinate of the second point.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   line(30, 20, 85, 75);\n   *\n   *   describe(\n   *     'A black line on a gray canvas running from top-center to bottom-right.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the line.\n   *   stroke('magenta');\n   *   strokeWeight(5);\n   *\n   *   line(30, 20, 85, 75);\n   *\n   *   describe(\n   *     'A thick, magenta line on a gray canvas running from top-center to bottom-right.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top.\n   *   line(30, 20, 85, 20);\n   *\n   *   // Right.\n   *   stroke(126);\n   *   line(85, 20, 85, 75);\n   *\n   *   // Bottom.\n   *   stroke(255);\n   *   line(85, 75, 30, 75);\n   *\n   *   describe(\n   *     'Three lines drawn in grayscale on a gray canvas. They form the top, right, and bottom sides of a square.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   line(-20, -30, 35, 25);\n   *\n   *   describe(\n   *     'A black line on a gray canvas running from top-center to bottom-right.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A black line connecting two spheres. The scene spins slowly.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Draw a line.\n   *   line(0, 0, 0, 30, 20, -10);\n   *\n   *   // Draw the center sphere.\n   *   sphere(10);\n   *\n   *   // Translate to the second point.\n   *   translate(30, 20, -10);\n   *\n   *   // Draw the bottom-right sphere.\n   *   sphere(10);\n   * }\n   * </code>\n   * </div>\n   *\n   */\n\n  /**\n   * @method line\n   * @param  {Number} x1\n   * @param  {Number} y1\n   * @param  {Number} z1 the z-coordinate of the first point.\n   * @param  {Number} x2\n   * @param  {Number} y2\n   * @param  {Number} z2 the z-coordinate of the second point.\n   * @chainable\n   */\n  fn.line = function(...args) {\n    // p5._validateParameters('line', args);\n\n    if (this._renderer.states.strokeColor) {\n      this._renderer.line(...args);\n    }\n\n    //accessible Outputs\n    if (this._accessibleOutputs.grid || this._accessibleOutputs.text) {\n      this._accsOutput('line', args);\n    }\n\n    return this;\n  };\n\n  /**\n   * Draws a single point in space.\n   *\n   * A point's default width is one pixel. To color a point, use the\n   * <a href=\"#/p5/stroke\">stroke()</a> function. To change its width, use the\n   * <a href=\"#/p5/strokeWeight\">strokeWeight()</a> function. A point\n   * can't be filled, so the <a href=\"#/p5/fill\">fill()</a> function won't\n   * affect the point's color.\n   *\n   * The version of `point()` with two parameters allows the point's location to\n   * be set with its x- and y-coordinates, as in `point(10, 20)`.\n   *\n   * The version of `point()` with three parameters allows the point to be drawn\n   * in 3D space with x-, y-, and z-coordinates, as in `point(10, 20, 30)`.\n   * Doing so requires adding the `WEBGL` argument to\n   * <a href=\"#/p5/createCanvas\">createCanvas()</a>.\n   *\n   * The version of `point()` with one parameter allows the point's location to\n   * be set with a <a href=\"#/p5/p5.Vector\">p5.Vector</a> object.\n   *\n   * @method point\n   * @param  {Number} x the x-coordinate.\n   * @param  {Number} y the y-coordinate.\n   * @param  {Number} [z] the z-coordinate (for WebGL mode).\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top-left.\n   *   point(30, 20);\n   *\n   *   // Top-right.\n   *   point(85, 20);\n   *\n   *   // Bottom-right.\n   *   point(85, 75);\n   *\n   *   // Bottom-left.\n   *   point(30, 75);\n   *\n   *   describe(\n   *     'Four small, black points drawn on a gray canvas. The points form the corners of a square.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top-left.\n   *   point(30, 20);\n   *\n   *   // Top-right.\n   *   point(70, 20);\n   *\n   *   // Style the next points.\n   *   stroke('purple');\n   *   strokeWeight(10);\n   *\n   *   // Bottom-right.\n   *   point(70, 80);\n   *\n   *   // Bottom-left.\n   *   point(30, 80);\n   *\n   *   describe(\n   *     'Four points drawn on a gray canvas. Two are black and two are purple. The points form the corners of a square.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top-left.\n   *   let a = createVector(30, 20);\n   *   point(a);\n   *\n   *   // Top-right.\n   *   let b = createVector(70, 20);\n   *   point(b);\n   *\n   *   // Bottom-right.\n   *   let c = createVector(70, 80);\n   *   point(c);\n   *\n   *   // Bottom-left.\n   *   let d = createVector(30, 80);\n   *   point(d);\n   *\n   *   describe(\n   *     'Four small, black points drawn on a gray canvas. The points form the corners of a square.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('Two purple points drawn on a gray canvas.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the points.\n   *   stroke('purple');\n   *   strokeWeight(10);\n   *\n   *   // Top-left.\n   *   point(-20, -30);\n   *\n   *   // Bottom-right.\n   *   point(20, 30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('Two purple points drawn on a gray canvas. The scene spins slowly.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Style the points.\n   *   stroke('purple');\n   *   strokeWeight(10);\n   *\n   *   // Top-left.\n   *   point(-20, -30, 0);\n   *\n   *   // Bottom-right.\n   *   point(20, 30, -50);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method point\n   * @param {p5.Vector} coordinateVector the coordinate vector.\n   * @chainable\n   */\n  fn.point = function(...args) {\n    // p5._validateParameters('point', args);\n\n    if (this._renderer.states.strokeColor) {\n      if (args.length === 1 && args[0] instanceof p5.Vector) {\n        this._renderer.point.call(\n          this._renderer,\n          args[0].x,\n          args[0].y,\n          args[0].z\n        );\n      } else {\n        this._renderer.point(...args);\n        //accessible Outputs\n        if (this._accessibleOutputs.grid || this._accessibleOutputs.text) {\n          this._accsOutput('point', args);\n        }\n      }\n    }\n\n    return this;\n  };\n\n  /**\n   * Draws a quadrilateral (four-sided shape).\n   *\n   * Quadrilaterals include rectangles, squares, rhombuses, and trapezoids. The\n   * first pair of parameters `(x1, y1)` sets the quad's first point. The next\n   * three pairs of parameters set the coordinates for its next three points\n   * `(x2, y2)`, `(x3, y3)`, and `(x4, y4)`. Points should be added in either\n   * clockwise or counter-clockwise order.\n   *\n   * The version of `quad()` with twelve parameters allows the quad to be drawn\n   * in 3D space. Doing so requires adding the `WEBGL` argument to\n   * <a href=\"#/p5/createCanvas\">createCanvas()</a>.\n   *\n   * The thirteenth and fourteenth parameters are optional. In WebGL mode, they\n   * set the number of segments used to draw the quadrilateral in the x- and\n   * y-directions. They're both 2 by default.\n   *\n   * @method quad\n   * @param {Number} x1 the x-coordinate of the first point.\n   * @param {Number} y1 the y-coordinate of the first point.\n   * @param {Number} x2 the x-coordinate of the second point.\n   * @param {Number} y2 the y-coordinate of the second point.\n   * @param {Number} x3 the x-coordinate of the third point.\n   * @param {Number} y3 the y-coordinate of the third point.\n   * @param {Number} x4 the x-coordinate of the fourth point.\n   * @param {Number} y4 the y-coordinate of the fourth point.\n   * @param {Integer} [detailX] number of segments in the x-direction.\n   * @param {Integer} [detailY] number of segments in the y-direction.\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   quad(20, 20, 80, 20, 80, 80, 20, 80);\n   *\n   *   describe('A white square with a black outline drawn on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   quad(20, 30, 80, 30, 80, 70, 20, 70);\n   *\n   *   describe('A white rectangle with a black outline drawn on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   quad(50, 62, 86, 50, 50, 38, 14, 50);\n   *\n   *   describe('A white rhombus with a black outline drawn on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   quad(20, 50, 80, 30, 80, 70, 20, 70);\n   *\n   *   describe('A white trapezoid with a black outline drawn on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   quad(-30, -30, 30, -30, 30, 30, -30, 30);\n   *\n   *   describe('A white square with a black outline drawn on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A wavy white surface spins around on gray canvas.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Draw the quad.\n   *   quad(-30, -30, 0, 30, -30, 0, 30, 30, 20, -30, 30, -20);\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method quad\n   * @param {Number} x1\n   * @param {Number} y1\n   * @param {Number} z1 the z-coordinate of the first point.\n   * @param {Number} x2\n   * @param {Number} y2\n   * @param {Number} z2 the z-coordinate of the second point.\n   * @param {Number} x3\n   * @param {Number} y3\n   * @param {Number} z3 the z-coordinate of the third point.\n   * @param {Number} x4\n   * @param {Number} y4\n   * @param {Number} z4 the z-coordinate of the fourth point.\n   * @param {Integer} [detailX]\n   * @param {Integer} [detailY]\n   * @chainable\n   */\n  fn.quad = function(...args) {\n    // p5._validateParameters('quad', args);\n\n    if (this._renderer.states.strokeColor || this._renderer.states.fillColor) {\n      if (this._renderer.isP3D && args.length < 12) {\n        // if 3D and we weren't passed 12 args, assume Z is 0\n        this._renderer.quad.call(\n          this._renderer,\n          args[0], args[1], 0,\n          args[2], args[3], 0,\n          args[4], args[5], 0,\n          args[6], args[7], 0,\n          args[8], args[9]);\n      } else {\n        this._renderer.quad(...args);\n        //accessibile outputs\n        if (this._accessibleOutputs.grid || this._accessibleOutputs.text) {\n          this._accsOutput('quadrilateral', args);\n        }\n      }\n    }\n\n    return this;\n  };\n\n  /**\n   * Draws a rectangle.\n   *\n   * A rectangle is a four-sided shape defined by the `x`, `y`, `w`, and `h`\n   * parameters. `x` and `y` set the location of its top-left corner. `w` sets\n   * its width and `h` sets its height. Every angle in the rectangle measures\n   * 90. See <a href=\"#/p5/rectMode\">rectMode()</a> for other ways to define\n   * rectangles.\n   *\n   * The version of `rect()` with five parameters creates a rounded rectangle. The\n   * fifth parameter sets the radius for all four corners.\n   *\n   * The version of `rect()` with eight parameters also creates a rounded\n   * rectangle. Each of the last four parameters set the radius of a corner. The\n   * radii start with the top-left corner and move clockwise around the\n   * rectangle. If any of these parameters are omitted, they are set to the\n   * value of the last radius that was set.\n   *\n   * @method rect\n   * @param  {Number} x  x-coordinate of the rectangle.\n   * @param  {Number} y  y-coordinate of the rectangle.\n   * @param  {Number} w  width of the rectangle.\n   * @param  {Number} [h]  height of the rectangle.\n   * @param  {Number} [tl] optional radius of top-left corner.\n   * @param  {Number} [tr] optional radius of top-right corner.\n   * @param  {Number} [br] optional radius of bottom-right corner.\n   * @param  {Number} [bl] optional radius of bottom-left corner.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   rect(30, 20, 55, 55);\n   *\n   *   describe('A white square with a black outline on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   rect(30, 20, 55, 40);\n   *\n   *   describe('A white rectangle with a black outline on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Give all corners a radius of 20.\n   *   rect(30, 20, 55, 50, 20);\n   *\n   *   describe('A white rectangle with a black outline and round edges on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Give each corner a unique radius.\n   *   rect(30, 20, 55, 50, 20, 15, 10, 5);\n   *\n   *   describe('A white rectangle with a black outline and round edges of different radii.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   rect(-20, -30, 55, 55);\n   *\n   *   describe('A white square with a black outline on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white square spins around on gray canvas.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Draw the rectangle.\n   *   rect(-20, -30, 55, 55);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method rect\n   * @param  {Number} x\n   * @param  {Number} y\n   * @param  {Number} w\n   * @param  {Number} h\n   * @param  {Integer} [detailX] number of segments in the x-direction (for WebGL mode).\n   * @param  {Integer} [detailY] number of segments in the y-direction (for WebGL mode).\n   * @chainable\n   */\n  fn.rect = function(...args) {\n    // p5._validateParameters('rect', args);\n    return this._renderRect(...args);\n  };\n\n  /**\n   * Draws a square.\n   *\n   * A square is a four-sided shape defined by the `x`, `y`, and `s`\n   * parameters. `x` and `y` set the location of its top-left corner. `s` sets\n   * its width and height. Every angle in the square measures 90 and all its\n   * sides are the same length. See <a href=\"#/p5/rectMode\">rectMode()</a> for\n   * other ways to define squares.\n   *\n   * The version of `square()` with four parameters creates a rounded square.\n   * The fourth parameter sets the radius for all four corners.\n   *\n   * The version of `square()` with seven parameters also creates a rounded\n   * square. Each of the last four parameters set the radius of a corner. The\n   * radii start with the top-left corner and move clockwise around the\n   * square. If any of these parameters are omitted, they are set to the\n   * value of the last radius that was set.\n   *\n   * @method square\n   * @param  {Number} x  x-coordinate of the square.\n   * @param  {Number} y  y-coordinate of the square.\n   * @param  {Number} s  side size of the square.\n   * @param  {Number} [tl] optional radius of top-left corner.\n   * @param  {Number} [tr] optional radius of top-right corner.\n   * @param  {Number} [br] optional radius of bottom-right corner.\n   * @param  {Number} [bl] optional radius of bottom-left corner.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   square(30, 20, 55);\n   *\n   *   describe('A white square with a black outline in on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Give all corners a radius of 20.\n   *   square(30, 20, 55, 20);\n   *\n   *   describe(\n   *     'A white square with a black outline and round edges on a gray canvas.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Give each corner a unique radius.\n   *   square(30, 20, 55, 20, 15, 10, 5);\n   *\n   *   describe('A white square with a black outline and round edges of different radii.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   square(-20, -30, 55);\n   *\n   *   describe('A white square with a black outline in on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white square spins around on gray canvas.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Draw the square.\n   *   square(-20, -30, 55);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.square = function(x, y, s, tl, tr, br, bl) {\n    // p5._validateParameters('square', arguments);\n    // duplicate width for height in case of square\n    return this._renderRect.call(this, x, y, s, s, tl, tr, br, bl);\n  };\n\n  // internal method to have renderer draw a rectangle\n  fn._renderRect = function() {\n    if (this._renderer.states.strokeColor || this._renderer.states.fillColor) {\n      // duplicate width for height in case only 3 arguments is provided\n      if (arguments.length === 3) {\n        arguments[3] = arguments[2];\n      }\n      const vals = canvas.modeAdjust(\n        arguments[0],\n        arguments[1],\n        arguments[2],\n        arguments[3],\n        this._renderer.states.rectMode\n      );\n\n      // For the default rectMode (CORNER), restore a possible negative width/height\n      // removed by modeAdjust(). This results in flipped/mirrored rendering,\n      // which is especially noticable when using WEGBL rendering and texture().\n      // Note that this behavior only applies to rect(), NOT to ellipse() and arc().\n      if (this._renderer.states.rectMode === CORNER) {\n        vals.w = arguments[2];\n        vals.h = arguments[3];\n      }\n\n      const args = [vals.x, vals.y, vals.w, vals.h];\n      // append the additional arguments (either cornder radii, or\n      // segment details) to the argument list\n      for (let i = 4; i < arguments.length; i++) {\n        args[i] = arguments[i];\n      }\n      this._renderer.rect(args);\n\n      //accessible outputs\n      if (this._accessibleOutputs.grid || this._accessibleOutputs.text) {\n        this._accsOutput('rectangle', [vals.x, vals.y, vals.w, vals.h]);\n      }\n    }\n\n    return this;\n  };\n\n  /**\n   * Draws a triangle.\n   *\n   * A triangle is a three-sided shape defined by three points. The\n   * first two parameters specify the triangle's first point `(x1, y1)`. The\n   * middle two parameters specify its second point `(x2, y2)`. And the last two\n   * parameters specify its third point `(x3, y3)`.\n   *\n   * @method triangle\n   * @param  {Number} x1 x-coordinate of the first point.\n   * @param  {Number} y1 y-coordinate of the first point.\n   * @param  {Number} x2 x-coordinate of the second point.\n   * @param  {Number} y2 y-coordinate of the second point.\n   * @param  {Number} x3 x-coordinate of the third point.\n   * @param  {Number} y3 y-coordinate of the third point.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   triangle(30, 75, 58, 20, 86, 75);\n   *\n   *   describe('A white triangle with a black outline on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   triangle(-20, 25, 8, -30, 36, 25);\n   *\n   *   describe('A white triangle with a black outline on a gray canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white triangle spins around on a gray canvas.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Draw the triangle.\n   *   triangle(-20, 25, 8, -30, 36, 25);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.triangle = function(...args) {\n    // p5._validateParameters('triangle', args);\n\n    if (this._renderer.states.strokeColor || this._renderer.states.fillColor) {\n      this._renderer.triangle(args);\n    }\n\n    //accessible outputs\n    if (this._accessibleOutputs.grid || this._accessibleOutputs.text) {\n      this._accsOutput('triangle', args);\n    }\n\n    return this;\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  primitives(p5, p5.prototype);\n}\n\nexport { primitives as default };\n","import { e as CORNER, i as CORNERS, a as RADIUS, C as CENTER, j as ROUND, S as SQUARE, k as PROJECT, B as BEVEL, l as MITER } from '../constants-8IpwyBct.js';\n\n/**\n * @module Shape\n * @submodule Attributes\n * @for p5\n * @requires core\n * @requires constants\n */\n\n\nfunction attributes(p5, fn){\n  /**\n   * Changes where ellipses, circles, and arcs are drawn.\n   *\n   * By default, the first two parameters of\n   * <a href=\"#/p5/ellipse\">ellipse()</a>, <a href=\"#/p5/circle\">circle()</a>,\n   * and <a href=\"#/p5/arc\">arc()</a>\n   * are the x- and y-coordinates of the shape's center. The next parameters set\n   * the shape's width and height. This is the same as calling\n   * `ellipseMode(CENTER)`.\n   *\n   * `ellipseMode(RADIUS)` also uses the first two parameters to set the x- and\n   * y-coordinates of the shape's center. The next parameters are half of the\n   * shapes's width and height. Calling `ellipse(0, 0, 10, 15)` draws a shape\n   * with a width of 20 and height of 30.\n   *\n   * `ellipseMode(CORNER)` uses the first two parameters as the upper-left\n   * corner of the shape. The next parameters are its width and height.\n   *\n   * `ellipseMode(CORNERS)` uses the first two parameters as the location of one\n   * corner of the ellipse's bounding box. The next parameters are the location\n   * of the opposite corner.\n   *\n   * The argument passed to `ellipseMode()` must be written in ALL CAPS because\n   * the constants `CENTER`, `RADIUS`, `CORNER`, and `CORNERS` are defined this\n   * way. JavaScript is a case-sensitive language.\n   *\n   * @method ellipseMode\n   * @param  {(CENTER|RADIUS|CORNER|CORNERS)} mode either CENTER, RADIUS, CORNER, or CORNERS\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // White ellipse.\n   *   ellipseMode(RADIUS);\n   *   fill(255);\n   *   ellipse(50, 50, 30, 30);\n   *\n   *   // Gray ellipse.\n   *   ellipseMode(CENTER);\n   *   fill(100);\n   *   ellipse(50, 50, 30, 30);\n   *\n   *   describe('A white circle with a gray circle at its center. Both circles have black outlines.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // White ellipse.\n   *   ellipseMode(CORNER);\n   *   fill(255);\n   *   ellipse(25, 25, 50, 50);\n   *\n   *   // Gray ellipse.\n   *   ellipseMode(CORNERS);\n   *   fill(100);\n   *   ellipse(25, 25, 50, 50);\n   *\n   *   describe('A white circle with a gray circle at its top-left corner. Both circles have black outlines.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.ellipseMode = function(m) {\n    // p5._validateParameters('ellipseMode', arguments);\n    if (\n      m === CORNER ||\n      m === CORNERS ||\n      m === RADIUS ||\n      m === CENTER\n    ) {\n      this._renderer.states.setValue('ellipseMode', m);\n    }\n    return this;\n  };\n\n  /**\n   * Draws certain features with jagged (aliased) edges.\n   *\n   * <a href=\"#/p5/smooth\">smooth()</a> is active by default. In 2D mode,\n   * `noSmooth()` is helpful for scaling up images without blurring. The\n   * functions don't affect shapes or fonts.\n   *\n   * In WebGL mode, `noSmooth()` causes all shapes to be drawn with jagged\n   * (aliased) edges. The functions don't affect images or fonts.\n   *\n   * @method noSmooth\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let heart;\n   *\n   * async function setup() {\n   *   // Load a pixelated heart image from an image data string.\n   *   heart = await loadImage('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAAAXNSR0IArs4c6QAAAEZJREFUGFd9jcsNACAIQ9tB2MeR3YdBMBBq8CIXPi2vBICIiOwkOedatllqWO6Y8yOWoyuNf1GZwgmf+RRG2YXr+xVFmA8HZ9Mx/KGPMtcAAAAASUVORK5CYII=');\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Antialiased hearts.\n   *   image(heart, 10, 10);\n   *   image(heart, 20, 10, 16, 16);\n   *   image(heart, 40, 10, 32, 32);\n   *\n   *   // Aliased hearts.\n   *   noSmooth();\n   *   image(heart, 10, 60);\n   *   image(heart, 20, 60, 16, 16);\n   *   image(heart, 40, 60, 32, 32);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   circle(0, 0, 80);\n   *\n   *   describe('A white circle on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Disable smoothing.\n   *   noSmooth();\n   *\n   *   background(200);\n   *\n   *   circle(0, 0, 80);\n   *\n   *   describe('A pixelated white circle on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noSmooth = function() {\n    if (!this._renderer.isP3D) {\n      if ('imageSmoothingEnabled' in this.drawingContext) {\n        this.drawingContext.imageSmoothingEnabled = false;\n      }\n    } else {\n      this.setAttributes('antialias', false);\n    }\n    return this;\n  };\n\n  /**\n   * Changes where rectangles and squares are drawn.\n   *\n   * By default, the first two parameters of\n   * <a href=\"#/p5/rect\">rect()</a> and <a href=\"#/p5/square\">square()</a>,\n   * are the x- and y-coordinates of the shape's upper left corner. The next parameters set\n   * the shape's width and height. This is the same as calling\n   * `rectMode(CORNER)`.\n   *\n   * `rectMode(CORNERS)` also uses the first two parameters as the location of\n   * one of the corners. The next parameters are the location of the opposite\n   * corner. This mode only works for <a href=\"#/p5/rect\">rect()</a>.\n   *\n   * `rectMode(CENTER)` uses the first two parameters as the x- and\n   * y-coordinates of the shape's center. The next parameters are its width and\n   * height.\n   *\n   * `rectMode(RADIUS)` also uses the first two parameters as the x- and\n   * y-coordinates of the shape's center. The next parameters are\n   * half of the shape's width and height.\n   *\n   * The argument passed to `rectMode()` must be written in ALL CAPS because the\n   * constants `CENTER`, `RADIUS`, `CORNER`, and `CORNERS` are defined this way.\n   * JavaScript is a case-sensitive language.\n   *\n   * @method rectMode\n   * @param  {(CENTER|RADIUS|CORNER|CORNERS)} mode either CORNER, CORNERS, CENTER, or RADIUS\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   rectMode(CORNER);\n   *   fill(255);\n   *   rect(25, 25, 50, 50);\n   *\n   *   rectMode(CORNERS);\n   *   fill(100);\n   *   rect(25, 25, 50, 50);\n   *\n   *   describe('A small gray square drawn at the top-left corner of a white square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   rectMode(RADIUS);\n   *   fill(255);\n   *   rect(50, 50, 30, 30);\n   *\n   *   rectMode(CENTER);\n   *   fill(100);\n   *   rect(50, 50, 30, 30);\n   *\n   *   describe('A small gray square drawn at the center of a white square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   rectMode(CORNER);\n   *   fill(255);\n   *   square(25, 25, 50);\n   *\n   *   describe('A white square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   rectMode(RADIUS);\n   *   fill(255);\n   *   square(50, 50, 30);\n   *\n   *   rectMode(CENTER);\n   *   fill(100);\n   *   square(50, 50, 30);\n   *\n   *   describe('A small gray square drawn at the center of a white square.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.rectMode = function(m) {\n    // p5._validateParameters('rectMode', arguments);\n    if (\n      m === CORNER ||\n      m === CORNERS ||\n      m === RADIUS ||\n      m === CENTER\n    ) {\n      this._renderer.states.setValue('rectMode', m);\n    }\n    return this; // return current rectMode ?\n  };\n\n  /**\n   * Draws certain features with smooth (antialiased) edges.\n   *\n   * `smooth()` is active by default. In 2D mode,\n   * <a href=\"#/p5/noSmooth\">noSmooth()</a> is helpful for scaling up images\n   * without blurring. The functions don't affect shapes or fonts.\n   *\n   * In WebGL mode, <a href=\"#/p5/noSmooth\">noSmooth()</a> causes all shapes to\n   * be drawn with jagged (aliased) edges. The functions don't affect images or\n   * fonts.\n   *\n   * @method smooth\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let heart;\n   *\n   * async function setup() {\n   *   // Load a pixelated heart image from an image data string.\n   *   heart = await loadImage('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAYAAADEUlfTAAAAAXNSR0IArs4c6QAAAEZJREFUGFd9jcsNACAIQ9tB2MeR3YdBMBBq8CIXPi2vBICIiOwkOedatllqWO6Y8yOWoyuNf1GZwgmf+RRG2YXr+xVFmA8HZ9Mx/KGPMtcAAAAASUVORK5CYII=');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Antialiased hearts.\n   *   image(heart, 10, 10);\n   *   image(heart, 20, 10, 16, 16);\n   *   image(heart, 40, 10, 32, 32);\n   *\n   *   // Aliased hearts.\n   *   noSmooth();\n   *   image(heart, 10, 60);\n   *   image(heart, 20, 60, 16, 16);\n   *   image(heart, 40, 60, 32, 32);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   circle(0, 0, 80);\n   *\n   *   describe('A white circle on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Disable smoothing.\n   *   noSmooth();\n   *\n   *   background(200);\n   *\n   *   circle(0, 0, 80);\n   *\n   *   describe('A pixelated white circle on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.smooth = function() {\n    if (!this._renderer.isP3D) {\n      if ('imageSmoothingEnabled' in this.drawingContext) {\n        this.drawingContext.imageSmoothingEnabled = true;\n      }\n    } else {\n      this.setAttributes('antialias', true);\n    }\n    return this;\n  };\n\n  /**\n   * Sets the style for rendering the ends of lines.\n   *\n   * The caps for line endings are either rounded (`ROUND`), squared\n   * (`SQUARE`), or extended (`PROJECT`). The default cap is `ROUND`.\n   *\n   * The argument passed to `strokeCap()` must be written in ALL CAPS because\n   * the constants `ROUND`, `SQUARE`, and `PROJECT` are defined this way.\n   * JavaScript is a case-sensitive language.\n   *\n   * @method strokeCap\n   * @param  {(ROUND|SQUARE|PROJECT)} cap either ROUND, SQUARE, or PROJECT\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   strokeWeight(12);\n   *\n   *   // Top.\n   *   strokeCap(ROUND);\n   *   line(20, 30, 80, 30);\n   *\n   *   // Middle.\n   *   strokeCap(SQUARE);\n   *   line(20, 50, 80, 50);\n   *\n   *   // Bottom.\n   *   strokeCap(PROJECT);\n   *   line(20, 70, 80, 70);\n   *\n   *   describe(\n   *     'Three horizontal lines. The top line has rounded ends, the middle line has squared ends, and the bottom line has longer, squared ends.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  fn.strokeCap = function(cap) {\n    // p5._validateParameters('strokeCap', arguments);\n    if (\n      cap === ROUND ||\n      cap === SQUARE ||\n      cap === PROJECT\n    ) {\n      this._renderer.strokeCap(cap);\n    }\n    return this;\n  };\n\n  /**\n   * Sets the style of the joints that connect line segments.\n   *\n   * Joints are either mitered (`MITER`), beveled (`BEVEL`), or rounded\n   * (`ROUND`). The default joint is `MITER` in 2D mode and `ROUND` in WebGL\n   * mode.\n   *\n   * The argument passed to `strokeJoin()` must be written in ALL CAPS because\n   * the constants `MITER`, `BEVEL`, and `ROUND` are defined this way.\n   * JavaScript is a case-sensitive language.\n   *\n   * @method strokeJoin\n   * @param  {(MITER|BEVEL|ROUND)} join either MITER, BEVEL, or ROUND\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the line.\n   *   noFill();\n   *   strokeWeight(10);\n   *   strokeJoin(MITER);\n   *\n   *   // Draw the line.\n   *   beginShape();\n   *   vertex(35, 20);\n   *   vertex(65, 50);\n   *   vertex(35, 80);\n   *   endShape();\n   *\n   *   describe('A right-facing arrowhead shape with a pointed tip in center of canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the line.\n   *   noFill();\n   *   strokeWeight(10);\n   *   strokeJoin(BEVEL);\n   *\n   *   // Draw the line.\n   *   beginShape();\n   *   vertex(35, 20);\n   *   vertex(65, 50);\n   *   vertex(35, 80);\n   *   endShape();\n   *\n   *   describe('A right-facing arrowhead shape with a flat tip in center of canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the line.\n   *   noFill();\n   *   strokeWeight(10);\n   *   strokeJoin(ROUND);\n   *\n   *   // Draw the line.\n   *   beginShape();\n   *   vertex(35, 20);\n   *   vertex(65, 50);\n   *   vertex(35, 80);\n   *   endShape();\n   *\n   *   describe('A right-facing arrowhead shape with a rounded tip in center of canvas.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.strokeJoin = function(join) {\n    // p5._validateParameters('strokeJoin', arguments);\n    if (\n      join === ROUND ||\n      join === BEVEL ||\n      join === MITER\n    ) {\n      this._renderer.strokeJoin(join);\n    }\n    return this;\n  };\n\n  /**\n   * Sets the width of the stroke used for points, lines, and the outlines of\n   * shapes.\n   *\n   * Note: `strokeWeight()` is affected by transformations, especially calls to\n   * <a href=\"#/p5/scale\">scale()</a>.\n   *\n   * @method strokeWeight\n   * @param  {Number} weight the weight of the stroke (in pixels).\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top.\n   *   line(20, 20, 80, 20);\n   *\n   *   // Middle.\n   *   strokeWeight(4);\n   *   line(20, 40, 80, 40);\n   *\n   *   // Bottom.\n   *   strokeWeight(10);\n   *   line(20, 70, 80, 70);\n   *\n   *   describe('Three horizontal black lines. The top line is thin, the middle is medium, and the bottom is thick.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top.\n   *   line(20, 20, 80, 20);\n   *\n   *   // Scale by a factor of 5.\n   *   scale(5);\n   *\n   *   // Bottom. Coordinates are adjusted for scaling.\n   *   line(4, 8, 16, 8);\n   *\n   *   describe('Two horizontal black lines. The top line is thin and the bottom is five times thicker than the top.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.strokeWeight = function(w) {\n    // p5._validateParameters('strokeWeight', arguments);\n    this._renderer.strokeWeight(w);\n    return this;\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  attributes(p5, p5.prototype);\n}\n\nexport { attributes as default };\n","/**\n * @module Shape\n * @submodule Curves\n * @for p5\n * @requires core\n */\n\nfunction curves(p5, fn){\n  /**\n   * Draws a Bzier curve.\n   *\n   * Bzier curves can form shapes and curves that slope gently. They're defined\n   * by two anchor points and two control points. Bzier curves provide more\n   * control than the spline curves created with the\n   * <a href=\"#/p5/spline\">spline()</a> function.\n   *\n   * The first two parameters, `x1` and `y1`, set the first anchor point. The\n   * first anchor point is where the curve starts.\n   *\n   * The next four parameters, `x2`, `y2`, `x3`, and `y3`, set the two control\n   * points. The control points \"pull\" the curve towards them.\n   *\n   * The seventh and eighth parameters, `x4` and `y4`, set the last anchor\n   * point. The last anchor point is where the curve ends.\n   *\n   * Bzier curves can also be drawn in 3D using WebGL mode. The 3D version of\n   * `bezier()` has twelve arguments because each point has x-, y-,\n   * and z-coordinates.\n   *\n   * @method bezier\n   * @param  {Number} x1 x-coordinate of the first anchor point.\n   * @param  {Number} y1 y-coordinate of the first anchor point.\n   * @param  {Number} x2 x-coordinate of the first control point.\n   * @param  {Number} y2 y-coordinate of the first control point.\n   * @param  {Number} x3 x-coordinate of the second control point.\n   * @param  {Number} y3 y-coordinate of the second control point.\n   * @param  {Number} x4 x-coordinate of the second anchor point.\n   * @param  {Number} y4 y-coordinate of the second anchor point.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Draw the anchor points in black.\n   *   stroke(0);\n   *   strokeWeight(5);\n   *   point(85, 20);\n   *   point(15, 80);\n   *\n   *   // Draw the control points in red.\n   *   stroke(255, 0, 0);\n   *   point(10, 10);\n   *   point(90, 90);\n   *\n   *   // Draw a black bezier curve.\n   *   noFill();\n   *   stroke(0);\n   *   strokeWeight(1);\n   *   bezier(85, 20, 10, 10, 90, 90, 15, 80);\n   *\n   *   // Draw red lines from the anchor points to the control points.\n   *   stroke(255, 0, 0);\n   *   line(85, 20, 10, 10);\n   *   line(15, 80, 90, 90);\n   *\n   *   describe(\n   *     'A gray square with three curves. A black s-curve has two straight, red lines that extend from its ends. The endpoints of all the curves are marked with dots.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click the mouse near the red dot in the top-left corner\n   * // and drag to change the curve's shape.\n   *\n   * let x2 = 10;\n   * let y2 = 10;\n   * let isChanging = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with three curves. A black s-curve has two straight, red lines that extend from its ends. The endpoints of all the curves are marked with dots.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the anchor points in black.\n   *   stroke(0);\n   *   strokeWeight(5);\n   *   point(85, 20);\n   *   point(15, 80);\n   *\n   *   // Draw the control points in red.\n   *   stroke(255, 0, 0);\n   *   point(x2, y2);\n   *   point(90, 90);\n   *\n   *   // Draw a black bezier curve.\n   *   noFill();\n   *   stroke(0);\n   *   strokeWeight(1);\n   *   bezier(85, 20, x2, y2, 90, 90, 15, 80);\n   *\n   *   // Draw red lines from the anchor points to the control points.\n   *   stroke(255, 0, 0);\n   *   line(85, 20, x2, y2);\n   *   line(15, 80, 90, 90);\n   * }\n   *\n   * // Start changing the first control point if the user clicks near it.\n   * function mousePressed() {\n   *   if (dist(mouseX, mouseY, x2, y2) < 20) {\n   *     isChanging = true;\n   *   }\n   * }\n   *\n   * // Stop changing the first control point when the user releases the mouse.\n   * function mouseReleased() {\n   *   isChanging = false;\n   * }\n   *\n   * // Update the first control point while the user drags the mouse.\n   * function mouseDragged() {\n   *   if (isChanging === true) {\n   *     x2 = mouseX;\n   *     y2 = mouseY;\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background('skyblue');\n   *\n   *   // Draw the red balloon.\n   *   fill('red');\n   *   bezier(50, 60, 5, 15, 95, 15, 50, 60);\n   *\n   *   // Draw the balloon string.\n   *   line(50, 60, 50, 80);\n   *\n   *   describe('A red balloon in a blue sky.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A red balloon in a blue sky. The balloon rotates slowly, revealing that it is flat.');\n   * }\n   *\n   * function draw() {\n   *   background('skyblue');\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Draw the red balloon.\n   *   fill('red');\n   *   bezier(0, 0, 0, -45, -45, 0, 45, -45, 0, 0, 0, 0);\n   *\n   *   // Draw the balloon string.\n   *   line(0, 0, 0, 0, 20, 0);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method bezier\n   * @param  {Number} x1\n   * @param  {Number} y1\n   * @param  {Number} z1 z-coordinate of the first anchor point.\n   * @param  {Number} x2\n   * @param  {Number} y2\n   * @param  {Number} z2 z-coordinate of the first control point.\n   * @param  {Number} x3\n   * @param  {Number} y3\n   * @param  {Number} z3 z-coordinate of the second control point.\n   * @param  {Number} x4\n   * @param  {Number} y4\n   * @param  {Number} z4 z-coordinate of the second anchor point.\n   * @chainable\n   */\n  fn.bezier = function(...args) {\n    // p5._validateParameters('bezier', args);\n\n    // if the current stroke and fill settings wouldn't result in something\n    // visible, exit immediately\n    if (!this._renderer.states.strokeColor && !this._renderer.states.fillColor) {\n      return this;\n    }\n\n    this._renderer.bezier(...args);\n\n    return this;\n  };\n\n  /**\n   * Calculates coordinates along a Bzier curve using interpolation.\n   *\n   * `bezierPoint()` calculates coordinates along a Bzier curve using the\n   * anchor and control points. It expects points in the same order as the\n   * <a href=\"#/p5/bezier\">bezier()</a> function. `bezierPoint()` works one axis\n   * at a time. Passing the anchor and control points' x-coordinates will\n   * calculate the x-coordinate of a point on the curve. Passing the anchor and\n   * control points' y-coordinates will calculate the y-coordinate of a point on\n   * the curve.\n   *\n   * The first parameter, `a`, is the coordinate of the first anchor point.\n   *\n   * The second and third parameters, `b` and `c`, are the coordinates of the\n   * control points.\n   *\n   * The fourth parameter, `d`, is the coordinate of the last anchor point.\n   *\n   * The fifth parameter, `t`, is the amount to interpolate along the curve. 0\n   * is the first anchor point, 1 is the second anchor point, and 0.5 is halfway\n   * between them.\n   *\n   * @method bezierPoint\n   * @param {Number} a coordinate of first anchor point.\n   * @param {Number} b coordinate of first control point.\n   * @param {Number} c coordinate of second control point.\n   * @param {Number} d coordinate of second anchor point.\n   * @param {Number} t amount to interpolate between 0 and 1.\n   * @return {Number} coordinate of the point on the curve.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the coordinates for the curve's anchor and control points.\n   *   let x1 = 85;\n   *   let x2 = 10;\n   *   let x3 = 90;\n   *   let x4 = 15;\n   *   let y1 = 20;\n   *   let y2 = 10;\n   *   let y3 = 90;\n   *   let y4 = 80;\n   *\n   *   // Style the curve.\n   *   noFill();\n   *\n   *   // Draw the curve.\n   *   bezier(x1, y1, x2, y2, x3, y3, x4, y4);\n   *\n   *   // Draw circles along the curve's path.\n   *   fill(255);\n   *\n   *   // Top-right.\n   *   let x = bezierPoint(x1, x2, x3, x4, 0);\n   *   let y = bezierPoint(y1, y2, y3, y4, 0);\n   *   circle(x, y, 5);\n   *\n   *   // Center.\n   *   x = bezierPoint(x1, x2, x3, x4, 0.5);\n   *   y = bezierPoint(y1, y2, y3, y4, 0.5);\n   *   circle(x, y, 5);\n   *\n   *   // Bottom-left.\n   *   x = bezierPoint(x1, x2, x3, x4, 1);\n   *   y = bezierPoint(y1, y2, y3, y4, 1);\n   *   circle(x, y, 5);\n   *\n   *   describe('A black s-curve on a gray square. The endpoints and center of the curve are marked with white circles.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A black s-curve on a gray square. A white circle moves back and forth along the curve.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Set the coordinates for the curve's anchor and control points.\n   *   let x1 = 85;\n   *   let x2 = 10;\n   *   let x3 = 90;\n   *   let x4 = 15;\n   *   let y1 = 20;\n   *   let y2 = 10;\n   *   let y3 = 90;\n   *   let y4 = 80;\n   *\n   *   // Draw the curve.\n   *   noFill();\n   *   bezier(x1, y1, x2, y2, x3, y3, x4, y4);\n   *\n   *   // Calculate the circle's coordinates.\n   *   let t = 0.5 * sin(frameCount * 0.01) + 0.5;\n   *   let x = bezierPoint(x1, x2, x3, x4, t);\n   *   let y = bezierPoint(y1, y2, y3, y4, t);\n   *\n   *   // Draw the circle.\n   *   fill(255);\n   *   circle(x, y, 5);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.bezierPoint = function(a, b, c, d, t) {\n    // p5._validateParameters('bezierPoint', arguments);\n\n    const adjustedT = 1 - t;\n    return (\n      Math.pow(adjustedT, 3) * a +\n      3 * Math.pow(adjustedT, 2) * t * b +\n      3 * adjustedT * Math.pow(t, 2) * c +\n      Math.pow(t, 3) * d\n    );\n  };\n\n  /**\n   * Calculates coordinates along a line that's tangent to a Bzier curve.\n   *\n   * Tangent lines skim the surface of a curve. A tangent line's slope equals\n   * the curve's slope at the point where it intersects.\n   *\n   * `bezierTangent()` calculates coordinates along a tangent line using the\n   * Bzier curve's anchor and control points. It expects points in the same\n   * order as the <a href=\"#/p5/bezier\">bezier()</a> function. `bezierTangent()`\n   * works one axis at a time. Passing the anchor and control points'\n   * x-coordinates will calculate the x-coordinate of a point on the tangent\n   * line. Passing the anchor and control points' y-coordinates will calculate\n   * the y-coordinate of a point on the tangent line.\n   *\n   * The first parameter, `a`, is the coordinate of the first anchor point.\n   *\n   * The second and third parameters, `b` and `c`, are the coordinates of the\n   * control points.\n   *\n   * The fourth parameter, `d`, is the coordinate of the last anchor point.\n   *\n   * The fifth parameter, `t`, is the amount to interpolate along the curve. 0\n   * is the first anchor point, 1 is the second anchor point, and 0.5 is halfway\n   * between them.\n   *\n   * @method bezierTangent\n   * @param {Number} a coordinate of first anchor point.\n   * @param {Number} b coordinate of first control point.\n   * @param {Number} c coordinate of second control point.\n   * @param {Number} d coordinate of second anchor point.\n   * @param {Number} t amount to interpolate between 0 and 1.\n   * @return {Number} coordinate of a point on the tangent line.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the coordinates for the curve's anchor and control points.\n   *   let x1 = 85;\n   *   let x2 = 10;\n   *   let x3 = 90;\n   *   let x4 = 15;\n   *   let y1 = 20;\n   *   let y2 = 10;\n   *   let y3 = 90;\n   *   let y4 = 80;\n   *\n   *   // Style the curve.\n   *   noFill();\n   *\n   *   // Draw the curve.\n   *   bezier(x1, y1, x2, y2, x3, y3, x4, y4);\n   *\n   *   // Draw tangents along the curve's path.\n   *   fill(255);\n   *\n   *   // Top-right circle.\n   *   stroke(0);\n   *   let x = bezierPoint(x1, x2, x3, x4, 0);\n   *   let y = bezierPoint(y1, y2, y3, y4, 0);\n   *   circle(x, y, 5);\n   *\n   *   // Top-right tangent line.\n   *   // Scale the tangent point to draw a shorter line.\n   *   stroke(255, 0, 0);\n   *   let tx = 0.1 * bezierTangent(x1, x2, x3, x4, 0);\n   *   let ty = 0.1 * bezierTangent(y1, y2, y3, y4, 0);\n   *   line(x + tx, y + ty, x - tx, y - ty);\n   *\n   *   // Center circle.\n   *   stroke(0);\n   *   x = bezierPoint(x1, x2, x3, x4, 0.5);\n   *   y = bezierPoint(y1, y2, y3, y4, 0.5);\n   *   circle(x, y, 5);\n   *\n   *   // Center tangent line.\n   *   // Scale the tangent point to draw a shorter line.\n   *   stroke(255, 0, 0);\n   *   tx = 0.1 * bezierTangent(x1, x2, x3, x4, 0.5);\n   *   ty = 0.1 * bezierTangent(y1, y2, y3, y4, 0.5);\n   *   line(x + tx, y + ty, x - tx, y - ty);\n   *\n   *   // Bottom-left circle.\n   *   stroke(0);\n   *   x = bezierPoint(x1, x2, x3, x4, 1);\n   *   y = bezierPoint(y1, y2, y3, y4, 1);\n   *   circle(x, y, 5);\n   *\n   *   // Bottom-left tangent.\n   *   // Scale the tangent point to draw a shorter line.\n   *   stroke(255, 0, 0);\n   *   tx = 0.1 * bezierTangent(x1, x2, x3, x4, 1);\n   *   ty = 0.1 * bezierTangent(y1, y2, y3, y4, 1);\n   *   line(x + tx, y + ty, x - tx, y - ty);\n   *\n   *   describe(\n   *     'A black s-curve on a gray square. The endpoints and center of the curve are marked with white circles. Red tangent lines extend from the white circles.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  fn.bezierTangent = function(a, b, c, d, t) {\n    // p5._validateParameters('bezierTangent', arguments);\n\n    const adjustedT = 1 - t;\n    return (\n      3 * d * Math.pow(t, 2) -\n      3 * c * Math.pow(t, 2) +\n      6 * c * adjustedT * t -\n      6 * b * adjustedT * t +\n      3 * b * Math.pow(adjustedT, 2) -\n      3 * a * Math.pow(adjustedT, 2)\n    );\n  };\n\n  /**\n   * Draws a curve using a Catmull-Rom spline.\n   * \n   * Spline curves can form shapes and curves that slope gently. Theyre like\n   * cables that are attached to a set of points. By default (`ends: INCLUDE`),\n   * the curve passes through all four points you provide, in order\n   * `p0(x1,y1)` -> `p1(x2,y2)` -> `p2(x3,y3)` -> `p3(x4,y4)`. Think of them as \n   * points on a curve. If you switch to `ends: EXCLUDE`, p0 and p3 act\n   * like control points and only the middle span `p1->p2` is drawn.\n   *\n   * Spline curves can also be drawn in 3D using WebGL mode. The 3D version of\n   * `spline()` has twelve arguments because each point has x-, y-, and\n   * z-coordinates.\n   *\n   * @method spline\n   * @param  {Number} x1 x-coordinate of point p0.\n   * @param  {Number} y1 y-coordinate of point p0.\n   * @param  {Number} x2 x-coordinate of point p1.\n   * @param  {Number} y2 y-coordinate of point p1.\n   * @param  {Number} x3 x-coordinate of point p2.\n   * @param  {Number} y3 y-coordinate of point p2.\n   * @param  {Number} x4 x-coordinate of point p3.\n   * @param  {Number} y4 y-coordinate of point p3.\n   * @chainable\n   *\n   * @example\n   * \n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(200, 200);\n   *   background(240);\n   *   noFill();\n   *\n   *   stroke(0);\n   *   strokeWeight(2);\n   *   spline(40, 60, 100, 40, 120, 120, 60, 140);\n   *\n   *   strokeWeight(5);\n   *   point(40, 60);\n   *   point(100, 40);\n   *   point(120, 120);\n   *   point(60, 140);\n   *\n   *   describe('A black spline passes smoothly through four points');\n   * }\n   * </code>\n   * </div>\n   * \n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Exclude the endsskip the outer spans (p0p1 and p2p3) so only the middle span (p1p2) is drawn.\n   *   splineProperty('ends', EXCLUDE);\n   * \n   *   // Draw a black spline curve.\n   *   noFill();\n   *   strokeWeight(1);\n   *   stroke(0);\n   *   spline(5, 26, 73, 24, 73, 61, 15, 65);\n   *\n   *   // Draw red spline curves from the points.\n   *   stroke(255, 0, 0);\n   *   spline(5, 26, 5, 26, 73, 24, 73, 61);\n   *   spline(73, 24, 73, 61, 15, 65, 15, 65);\n   *\n   *   // Draw the points in black.\n   *   strokeWeight(5);\n   *   stroke(0);\n   *   point(73, 24);\n   *   point(73, 61);\n   *\n   *   // Draw the points in red.\n   *   stroke(255, 0, 0);\n   *   point(5, 26);\n   *   point(15, 65);\n   *\n   *   describe(\n   *     'A gray square with a curve drawn in three segments. The curve is a sideways U shape with red segments on top and bottom, and a black segment on the right. The endpoints of all the segments are marked with dots.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let x1 = 5;\n   * let y1 = 26;\n   * let isChanging = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a curve drawn in three segments. The curve is a sideways U shape with red segments on top and bottom, and a black segment on the right. The endpoints of all the segments are marked with dots.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   * \n   *   // Exclude the endsskip the outer spans (p0p1 and p2p3) so only the middle span (p1p2) is drawn.\n   *   splineProperty('ends', EXCLUDE);\n   * \n   *   // Draw a black spline curve.\n   *   noFill();\n   *   strokeWeight(1);\n   *   stroke(0);\n   *   spline(x1, y1, 73, 24, 73, 61, 15, 65);\n   *\n   *   // Draw red spline curves from the points.\n   *   stroke(255, 0, 0);\n   *   spline(x1, y1, x1, y1, 73, 24, 73, 61);\n   *   spline(73, 24, 73, 61, 15, 65, 15, 65);\n   *\n   *   // Draw the anchor points in black.\n   *   strokeWeight(5);\n   *   stroke(0);\n   *   point(73, 24);\n   *   point(73, 61);\n   *\n   *   // Draw the points in red.\n   *   stroke(255, 0, 0);\n   *   point(x1, y1);\n   *   point(15, 65);\n   * }\n   *\n   * // Start changing the first point if the user clicks near it.\n   * function mousePressed() {\n   *   if (dist(mouseX, mouseY, x1, y1) < 20) {\n   *     isChanging = true;\n   *   }\n   * }\n   *\n   * // Stop changing the first point when the user releases the mouse.\n   * function mouseReleased() {\n   *   isChanging = false;\n   * }\n   *\n   * // Update the first point while the user drags the mouse.\n   * function mouseDragged() {\n   *   if (isChanging === true) {\n   *     x1 = mouseX;\n   *     y1 = mouseY;\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background('skyblue');\n   * \n   *   // Exclude the endsskip the outer spans (p0p1 and p2p3) so only the middle span (p1p2) is drawn.\n   *   splineProperty('ends', EXCLUDE);\n   * \n   *   // Draw the red balloon.\n   *   fill('red');\n   *   spline(-150, 275, 50, 60, 50, 60, 250, 275);\n   *\n   *   // Draw the balloon string.\n   *   line(50, 60, 50, 80);\n   *\n   *   describe('A red balloon in a blue sky.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A red balloon in a blue sky.');\n   * }\n   *\n   * function draw() {\n   *   background('skyblue');\n   * \n   *   // Exclude the endsskip the outer spans (p0p1 and p2p3) so only the middle span (p1p2) is drawn.\n   *   splineProperty('ends', EXCLUDE);\n   * \n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Draw the red balloon.\n   *   fill('red');\n   *   spline(-200, 225, 0, 0, 10, 0, 0, 10, 0, 200, 225, 0);\n   *\n   *   // Draw the balloon string.\n   *   line(0, 10, 0, 0, 30, 0);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method spline\n   * @param  {Number} x1\n   * @param  {Number} y1\n   * @param  {Number} z1 z-coordinate of point p0.\n   * @param  {Number} x2\n   * @param  {Number} y2\n   * @param  {Number} z2 z-coordinate of point p1.\n   * @param  {Number} x3\n   * @param  {Number} y3\n   * @param  {Number} z3 z-coordinate of point p2.\n   * @param  {Number} x4\n   * @param  {Number} y4\n   * @param  {Number} z4 z-coordinate of point p3.\n   * @chainable\n   */\n  fn.spline = function(...args) {\n    if (!this._renderer.states.strokeColor && !this._renderer.states.fillColor) {\n      return this;\n    }\n    this._renderer.spline(...args);\n\n    return this;\n  };\n\n  /**\n   * Calculates coordinates along a spline curve using interpolation.\n   *\n   * `splinePoint()` calculates coordinates along a spline curve using four\n   * points p0, p1, p2, p3. It expects points in the same order as the\n   * <a href=\"#/p5/spline\">spline()</a> function. `splinePoint()` works one axis\n   * at a time. Passing the points' x-coordinates will\n   * calculate the x-coordinate of a point on the curve. Passing the\n   * points' y-coordinates will calculate the y-coordinate of a point on\n   * the curve.\n   *\n   * The first parameter, `a`, is the coordinate of point p0.\n   *\n   * The second and third parameters, `b` and `c`, are the coordinates of\n   * points p1 and p2.\n   *\n   * The fourth parameter, `d`, is the coordinate of point p3.\n   *\n   * The fifth parameter, `t`, is the amount to interpolate along the span\n   * from p1 to p2. `t = 0` is p1, `t = 1` is p2, and `t = 0.5` is halfway\n   * between them.\n   *\n   * @method splinePoint\n   * @param {Number} a coordinate of point p0.\n   * @param {Number} b coordinate of point p1.\n   * @param {Number} c coordinate of point p2.\n   * @param {Number} d coordinate of point p3.\n   * @param {Number} t amount to interpolate between 0 and 1.\n   * @return {Number} coordinate of a point on the curve.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *\n   *   // Set the coordinates for the curve's four points (p0, p1, p2, p3).\n   *   let x1 = 5;\n   *   let y1 = 26;\n   *   let x2 = 73;\n   *   let y2 = 24;\n   *   let x3 = 73;\n   *   let y3 = 61;\n   *   let x4 = 15;\n   *   let y4 = 65;\n   *\n   *   // Draw the curve.\n   *   noFill();\n   *   spline(x1, y1, x2, y2, x3, y3, x4, y4);\n   *\n   *   // Draw circles along the curve's path.\n   *   fill(255);\n   *\n   *   // Top.\n   *   let x = splinePoint(x1, x2, x3, x4, 0);\n   *   let y = splinePoint(y1, y2, y3, y4, 0);\n   *   circle(x, y, 5);\n   *\n   *   // Center.\n   *   x = splinePoint(x1, x2, x3, x4, 0.5);\n   *   y = splinePoint(y1, y2, y3, y4, 0.5);\n   *   circle(x, y, 5);\n   *\n   *   // Bottom.\n   *   x = splinePoint(x1, x2, x3, x4, 1);\n   *   y = splinePoint(y1, y2, y3, y4, 1);\n   *   circle(x, y, 5);\n   *\n   *   describe('A black curve on a gray square. The endpoints and center of the curve are marked with white circles.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A black curve on a gray square. A white circle moves back and forth along the curve.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Set the coordinates for the curve's four points (p0, p1, p2, p3).\n   *   let x1 = 5;\n   *   let y1 = 26;\n   *   let x2 = 73;\n   *   let y2 = 24;\n   *   let x3 = 73;\n   *   let y3 = 61;\n   *   let x4 = 15;\n   *   let y4 = 65;\n   *\n   *   // Draw the curve.\n   *   noFill();\n   *   spline(x1, y1, x2, y2, x3, y3, x4, y4);\n   *\n   *   // Calculate the circle's coordinates.\n   *   let t = 0.5 * sin(frameCount * 0.01) + 0.5;\n   *   let x = splinePoint(x1, x2, x3, x4, t);\n   *   let y = splinePoint(y1, y2, y3, y4, t);\n   *\n   *   // Draw the circle.\n   *   fill(255);\n   *   circle(x, y, 5);\n   * }\n   * </code>\n   * </div>\n   */\n\n  fn.splinePoint = function(a, b, c, d, t) {\n    const s = this._renderer.states.splineProperties.tightness,\n      t3 = t * t * t,\n      t2 = t * t,\n      f1 = (s - 1) / 2 * t3 + (1 - s) * t2 + (s - 1) / 2 * t,\n      f2 = (s + 3) / 2 * t3 + (-5 - s) / 2 * t2 + 1.0,\n      f3 = (-3 - s) / 2 * t3 + (s + 2) * t2 + (1 - s) / 2 * t,\n      f4 = (1 - s) / 2 * t3 + (s - 1) / 2 * t2;\n    return a * f1 + b * f2 + c * f3 + d * f4;\n  };\n\n  /**\n   * Calculates coordinates along a line that's tangent to a spline curve.\n   *\n   * Tangent lines skim the surface of a curve. A tangent line's slope equals\n   * the curve's slope at the point where it intersects.\n   *\n   * `splineTangent()` calculates coordinates along a tangent line using four\n   * points p0, p1, p2, p3. It expects points in the same order as the\n   * <a href=\"#/p5/spline\">spline()</a> function. `splineTangent()` works one\n   * axis at a time. Passing the points' x-coordinates returns the x-component of \n   * the tangent vector; passing the points' y-coordinates returns the y-component.\n   * The first parameter, `a`, is the coordinate of point p0.\n   *\n   * The second and third parameters, `b` and `c`, are the coordinates of\n   * points p1 and p2.\n   *\n   * The fourth parameter, `d`, is the coordinate of point p3.\n   *\n   * The fifth parameter, `t`, is the amount to interpolate along the span\n   * from p1 to p2. `t = 0` is p1, `t = 1` is p2, and `t = 0.5` is halfway\n   * between them.\n   *\n   * @method splineTangent\n   * @param {Number} a coordinate of point p0.\n   * @param {Number} b coordinate of point p1.\n   * @param {Number} c coordinate of point p2.\n   * @param {Number} d coordinate of point p3.\n   * @param {Number} t amount to interpolate between 0 and 1.\n   * @return {Number} coordinate of a point on the tangent line.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(120, 120);\n   *   describe('A black spline on a gray canvas. A red dot moves along the curve on its own. A short line shows the tangent direction at the dot.');\n   * }\n   *\n   * function draw() {\n   *   background(240);\n   *\n   *   const x1 = 15, y1 = 40;\n   *   const x2 = 90, y2 = 25;\n   *   const x3 = 95, y3 = 95;\n   *   const x4 = 30, y4 = 110;\n   *\n   *   noFill();\n   *   stroke(0);\n   *   strokeWeight(2);\n   *   spline(x1, y1, x2, y2, x3, y3, x4, y4);\n   *\n   *   const t = 0.5 + 0.5 * sin(frameCount * 0.03);\n   *\n   *   const px = splinePoint(x1, x2, x3, x4, t);\n   *   const py = splinePoint(y1, y2, y3, y4, t);\n   *\n   *   let tx = splineTangent(x1, x2, x3, x4, t);\n   *   let ty = splineTangent(y1, y2, y3, y4, t);\n   *\n   *   const m = Math.hypot(tx, ty) || 1;\n   *   tx = (tx / m) * 16;\n   *   ty = (ty / m) * 16;\n   *\n   *   stroke(0);\n   *   strokeWeight(2);\n   *   line(px, py, px + tx, py + ty);\n   *\n   *   noStroke();\n   *   fill('red');\n   *   circle(px, py, 7);\n   * }\n   * </code>\n   * </div>\n   * \n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the coordinates for the curve's four points (p0, p1, p2, p3).\n   *   let x1 = 5;\n   *   let y1 = 26;\n   *   let x2 = 73;\n   *   let y2 = 24;\n   *   let x3 = 73;\n   *   let y3 = 61;\n   *   let x4 = 15;\n   *   let y4 = 65;\n   *\n   *   // Draw the curve.\n   *   noFill();\n   *   spline(x1, y1, x2, y2, x3, y3, x4, y4);\n   *\n   *   // Draw tangents along the curve's path.\n   *   fill(255);\n   *\n   *   // Top circle.\n   *   stroke(0);\n   *   let x = splinePoint(x1, x2, x3, x4, 0);\n   *   let y = splinePoint(y1, y2, y3, y4, 0);\n   *   circle(x, y, 5);\n   *\n   *   // Top tangent line.\n   *   // Scale the tangent point to draw a shorter line.\n   *   stroke(255, 0, 0);\n   *   let tx = 0.2 * splineTangent(x1, x2, x3, x4, 0);\n   *   let ty = 0.2 * splineTangent(y1, y2, y3, y4, 0);\n   *   line(x + tx, y + ty, x - tx, y - ty);\n   *\n   *   // Center circle.\n   *   stroke(0);\n   *   x = splinePoint(x1, x2, x3, x4, 0.5);\n   *   y = splinePoint(y1, y2, y3, y4, 0.5);\n   *   circle(x, y, 5);\n   *\n   *   // Center tangent line.\n   *   // Scale the tangent point to draw a shorter line.\n   *   stroke(255, 0, 0);\n   *   tx = 0.2 * splineTangent(x1, x2, x3, x4, 0.5);\n   *   ty = 0.2 * splineTangent(y1, y2, y3, y4, 0.5);\n   *   line(x + tx, y + ty, x - tx, y - ty);\n   *\n   *   // Bottom circle.\n   *   stroke(0);\n   *   x = splinePoint(x1, x2, x3, x4, 1);\n   *   y = splinePoint(y1, y2, y3, y4, 1);\n   *   circle(x, y, 5);\n   *\n   *   // Bottom tangent line.\n   *   // Scale the tangent point to draw a shorter line.\n   *   stroke(255, 0, 0);\n   *   tx = 0.2 * splineTangent(x1, x2, x3, x4, 1);\n   *   ty = 0.2 * splineTangent(y1, y2, y3, y4, 1);\n   *   line(x + tx, y + ty, x - tx, y - ty);\n   *\n   *   describe(\n   *     'A black curve on a gray square. A white circle moves back and forth along the curve.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  fn.splineTangent = function(a, b, c, d, t) {\n    const s = this._renderer.states.splineProperties.tightness,\n      tt3 = t * t * 3,\n      t2 = t * 2,\n      f1 = (s - 1) / 2 * tt3 + (1 - s) * t2 + (s - 1) / 2,\n      f2 = (s + 3) / 2 * tt3 + (-5 - s) / 2 * t2,\n      f3 = (-3 - s) / 2 * tt3 + (s + 2) * t2 + (1 - s) / 2,\n      f4 = (1 - s) / 2 * tt3 + (s - 1) / 2 * t2;\n    return a * f1 + b * f2 + c * f3 + d * f4;\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  curves(p5, p5.prototype);\n}\n\nexport { curves as default };\n","/**\n * @module Shape\n * @submodule Custom Shapes\n * @for p5\n * @requires core\n * @requires constants\n */\n\n\nfunction vertex(p5, fn){\n  /**\n   * Begins adding vertices to a custom shape.\n   *\n   * The `beginShape()` and <a href=\"#/p5/endShape\">endShape()</a> functions\n   * allow for creating custom shapes in 2D or 3D. `beginShape()` begins adding\n   * vertices to a custom shape and <a href=\"#/p5/endShape\">endShape()</a> stops\n   * adding them.\n   *\n   * The parameter, `kind`, sets the kind of shape to make. The available kinds are:\n   *\n   * - `PATH` (the default) to draw shapes by tracing out the path along their edges.\n   * - `POINTS` to draw a series of points.\n   * - `LINES` to draw a series of unconnected line segments.\n   * - `TRIANGLES` to draw a series of separate triangles.\n   * - `TRIANGLE_FAN` to draw a series of connected triangles sharing the first vertex in a fan-like fashion.\n   * - `TRIANGLE_STRIP` to draw a series of connected triangles in strip fashion.\n   * - `QUADS` to draw a series of separate quadrilaterals (quads).\n   * - `QUAD_STRIP` to draw quad strip using adjacent edges to form the next quad.\n   *\n   * After calling `beginShape()`, shapes can be built by calling\n   * <a href=\"#/p5/vertex\">vertex()</a>,\n   * <a href=\"#/p5/bezierVertex\">bezierVertex()</a>, and/or\n   * <a href=\"#/p5/splineVertex\">splineVertex()</a>. Calling\n   * <a href=\"#/p5/endShape\">endShape()</a> will stop adding vertices to the\n   * shape. Each shape will be outlined with the current stroke color and filled\n   * with the current fill color.\n   *\n   * Transformations such as <a href=\"#/p5/translate\">translate()</a>,\n   * <a href=\"#/p5/rotate\">rotate()</a>, and\n   * <a href=\"#/p5/scale\">scale()</a> don't work between `beginShape()` and\n   * <a href=\"#/p5/endShape\">endShape()</a>. It's also not possible to use\n   * other shapes, such as <a href=\"#/p5/ellipse\">ellipse()</a> or\n   * <a href=\"#/p5/rect\">rect()</a>, between `beginShape()` and\n   * <a href=\"#/p5/endShape\">endShape()</a>.\n   *\n   * @method beginShape\n   * @param  {(POINTS|LINES|TRIANGLES|TRIANGLE_FAN|TRIANGLE_STRIP|QUADS|QUAD_STRIP|PATH)} [kind=PATH] either POINTS, LINES, TRIANGLES, TRIANGLE_FAN\n   *                                TRIANGLE_STRIP, QUADS, QUAD_STRIP or PATH. Defaults to PATH.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Add vertices.\n   *   vertex(30, 20);\n   *   vertex(85, 20);\n   *   vertex(85, 75);\n   *   vertex(30, 75);\n   *\n   *   // Stop drawing the shape.\n   *   endShape(CLOSE);\n   *\n   *   describe('A white square on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   // Only draw the vertices (points).\n   *   beginShape(POINTS);\n   *\n   *   // Add vertices.\n   *   vertex(30, 20);\n   *   vertex(85, 20);\n   *   vertex(85, 75);\n   *   vertex(30, 75);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('Four black dots that form a square are drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   // Only draw lines between alternating pairs of vertices.\n   *   beginShape(LINES);\n   *\n   *   // Add vertices.\n   *   vertex(30, 20);\n   *   vertex(85, 20);\n   *   vertex(85, 75);\n   *   vertex(30, 75);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('Two horizontal black lines on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the shape.\n   *   noFill();\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Add vertices.\n   *   vertex(30, 20);\n   *   vertex(85, 20);\n   *   vertex(85, 75);\n   *   vertex(30, 75);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('Three black lines form a sideways U shape on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the shape.\n   *   noFill();\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Add vertices.\n   *   vertex(30, 20);\n   *   vertex(85, 20);\n   *   vertex(85, 75);\n   *   vertex(30, 75);\n   *\n   *   // Stop drawing the shape.\n   *   // Connect the first and last vertices.\n   *   endShape(CLOSE);\n   *\n   *   describe('A black outline of a square drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   // Draw a series of triangles.\n   *   beginShape(TRIANGLES);\n   *\n   *   // Left triangle.\n   *   vertex(30, 75);\n   *   vertex(40, 20);\n   *   vertex(50, 75);\n   *\n   *   // Right triangle.\n   *   vertex(60, 20);\n   *   vertex(70, 75);\n   *   vertex(80, 20);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('Two white triangles drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   // Draw a series of triangles.\n   *   beginShape(TRIANGLE_STRIP);\n   *\n   *   // Add vertices.\n   *   vertex(30, 75);\n   *   vertex(40, 20);\n   *   vertex(50, 75);\n   *   vertex(60, 20);\n   *   vertex(70, 75);\n   *   vertex(80, 20);\n   *   vertex(90, 75);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('Five white triangles that are interleaved drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   // Draw a series of triangles that share their first vertex.\n   *   beginShape(TRIANGLE_FAN);\n   *\n   *   // Add vertices.\n   *   vertex(57.5, 50);\n   *   vertex(57.5, 15);\n   *   vertex(92, 50);\n   *   vertex(57.5, 85);\n   *   vertex(22, 50);\n   *   vertex(57.5, 15);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('Four white triangles form a square are drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   // Draw a series of quadrilaterals.\n   *   beginShape(QUADS);\n   *\n   *   // Left rectangle.\n   *   vertex(30, 20);\n   *   vertex(30, 75);\n   *   vertex(50, 75);\n   *   vertex(50, 20);\n   *\n   *   // Right rectangle.\n   *   vertex(65, 20);\n   *   vertex(65, 75);\n   *   vertex(85, 75);\n   *   vertex(85, 20);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('Two white rectangles drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   // Draw a series of quadrilaterals.\n   *   beginShape(QUAD_STRIP);\n   *\n   *   // Add vertices.\n   *   vertex(30, 20);\n   *   vertex(30, 75);\n   *   vertex(50, 20);\n   *   vertex(50, 75);\n   *   vertex(65, 20);\n   *   vertex(65, 75);\n   *   vertex(85, 20);\n   *   vertex(85, 75);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('Three white rectangles that share edges are drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   // Draw a series of quadrilaterals.\n   *   beginShape(PATH);\n   *\n   *   // Add the vertices.\n   *   vertex(-30, -30, 0);\n   *   vertex(30, -30, 0);\n   *   vertex(30, -10, 0);\n   *   vertex(-10, -10, 0);\n   *   vertex(-10, 10, 0);\n   *   vertex(30, 10, 0);\n   *   vertex(30, 30, 0);\n   *   vertex(-30, 30, 0);\n   *\n   *   // Stop drawing the shape.\n   *   // Connect the first and last vertices.\n   *   endShape(CLOSE);\n   *\n   *   describe('A blocky C shape drawn in white on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag with the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A blocky C shape drawn in red, blue, and green on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Start drawing the shape.\n   *   // Draw a series of quadrilaterals.\n   *   beginShape(PATH);\n   *\n   *   // Add the vertices.\n   *   fill('red');\n   *   stroke('red');\n   *   vertex(-30, -30, 0);\n   *   vertex(30, -30, 0);\n   *   vertex(30, -10, 0);\n   *   fill('green');\n   *   stroke('green');\n   *   vertex(-10, -10, 0);\n   *   vertex(-10, 10, 0);\n   *   vertex(30, 10, 0);\n   *   fill('blue');\n   *   stroke('blue');\n   *   vertex(30, 30, 0);\n   *   vertex(-30, 30, 0);\n   *\n   *   // Stop drawing the shape.\n   *   // Connect the first and last vertices.\n   *   endShape(CLOSE);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.beginShape = function(kind) {\n    // p5._validateParameters('beginShape', arguments);\n    this._renderer.beginShape(...arguments);\n  };\n\n  /**\n   * Adds a Bzier curve segment to a custom shape.\n   *\n   * `bezierVertex()` adds a curved segment to custom shapes. The Bzier curves\n   * it creates are defined like those made by the\n   * <a href=\"#/p5/bezier\">bezier()</a> function. `bezierVertex()` must be\n   * called between the\n   * <a href=\"#/p5/beginShape\">beginShape()</a> and\n   * <a href=\"#/p5/endShape\">endShape()</a> functions.\n   * Bzier need a starting point. Building a shape\n   * only with Bzier curves needs one initial\n   * call to <a href=\"#/p5/vertex\">bezierVertex()</a>, before\n   * a number of `bezierVertex()` calls that is a multiple of the parameter\n   * set by <a href=\"#/p5/bezierOrder\">bezierOrder(...)</a> (default 3).\n   * But shapes can mix different types of vertices, so if there\n   * are some previous vertices, then the initial anchor is not needed, \n   * only the multiples of 3 (or the Bzier order) calls to \n   *  `bezierVertex` for each curve.\n   * \n   * Each curve of order 3 requires three calls to `bezierVertex`, so\n   * 2 curves would need 7 calls to `bezierVertex()`:\n   * (1 one initial anchor point, two sets of 3 curves describing the curves)\n   * With `bezierOrder(2)`, two curves would need 5 calls: 1 + 2 + 2. \n   *\n   * Bzier curves can also be drawn in 3D using WebGL mode.\n   *\n   * Note: `bezierVertex()` wont work when an argument is passed to\n   * <a href=\"#/p5/beginShape\">beginShape()</a>.\n   *\n   * @method bezierVertex\n   * @param  {Number} x x-coordinate of the first control point.\n   * @param  {Number} y y-coordinate of the first control point.\n   * @param  {Number} [u]\n   * @param  {Number} [v]\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the shape.\n   *   noFill();\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Add the first anchor point.\n   *   bezierVertex(30, 20);\n   *\n   *   // Add the Bzier vertex.\n   *   bezierVertex(80, 0);\n   *   bezierVertex(80, 75);\n   *   bezierVertex(30, 75);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('A black C curve on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Draw the anchor points in black.\n   *   stroke(0);\n   *   strokeWeight(5);\n   *   point(30, 20);\n   *   point(30, 75);\n   *\n   *   // Draw the control points in red.\n   *   stroke(255, 0, 0);\n   *   point(80, 0);\n   *   point(80, 75);\n   *\n   *   // Style the shape.\n   *   noFill();\n   *   stroke(0);\n   *   strokeWeight(1);\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Add the first anchor point.\n   *   bezierVertex(30, 20);\n   *\n   *   // Add the Bzier vertex.\n   *   bezierVertex(80, 0);\n   *   bezierVertex(80, 75);\n   *   bezierVertex(30, 75);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   // Draw red lines from the anchor points to the control points.\n   *   stroke(255, 0, 0);\n   *   line(30, 20, 80, 0);\n   *   line(30, 75, 80, 75);\n   *\n   *   describe(\n   *     'A gray square with three curves. A black curve has two straight, red lines that extend from its ends. The endpoints of all the curves are marked with dots.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click the mouse near the red dot in the top-right corner\n   * // and drag to change the curve's shape.\n   *\n   * let x2 = 80;\n   * let y2 = 0;\n   * let isChanging = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with three curves. A black curve has two straight, red lines that extend from its ends. The endpoints of all the curves are marked with dots.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the anchor points in black.\n   *   stroke(0);\n   *   strokeWeight(5);\n   *   point(30, 20);\n   *   point(30, 75);\n   *\n   *   // Draw the control points in red.\n   *   stroke(255, 0, 0);\n   *   point(x2, y2);\n   *   point(80, 75);\n   *\n   *   // Style the shape.\n   *   noFill();\n   *   stroke(0);\n   *   strokeWeight(1);\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Add the first anchor point.\n   *   bezierVertex(30, 20);\n   *\n   *   // Add the Bzier vertex.\n   *   bezierVertex(x2, y2);\n   *   bezierVertex(80, 75);\n   *   bezierVertex(30, 75);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   // Draw red lines from the anchor points to the control points.\n   *   stroke(255, 0, 0);\n   *   line(30, 20, x2, y2);\n   *   line(30, 75, 80, 75);\n   * }\n   *\n   * // Start changing the first control point if the user clicks near it.\n   * function mousePressed() {\n   *   if (dist(mouseX, mouseY, x2, y2) < 20) {\n   *     isChanging = true;\n   *   }\n   * }\n   *\n   * // Stop changing the first control point when the user releases the mouse.\n   * function mouseReleased() {\n   *   isChanging = false;\n   * }\n   *\n   * // Update the first control point while the user drags the mouse.\n   * function mouseDragged() {\n   *   if (isChanging === true) {\n   *     x2 = mouseX;\n   *     y2 = mouseY;\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Start drawing the shape.\n   *   beginShape();\n   *\n   *   // Add the first anchor point.\n   *   bezierVertex(30, 20);\n   *\n   *   // Add the Bzier vertices.\n   *   bezierVertex(80, 0);\n   *   bezierVertex(80, 75);\n   *   bezierVertex(30, 75);\n   * \n   *   bezierVertex(50, 80);\n   *   bezierVertex(60, 25);\n   *   bezierVertex(30, 20);\n   *\n   *   // Stop drawing the shape.\n   *   endShape();\n   *\n   *   describe('A crescent moon shape drawn in white on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A crescent moon shape drawn in white on a blue background. When the user drags the mouse, the scene rotates and a second moon is revealed.');\n   * }\n   *\n   * function draw() {\n   *   background('midnightblue');\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the moons.\n   *   noStroke();\n   *   fill('lemonchiffon');\n   *\n   *   // Draw the first moon.\n   *   beginShape();\n   *   bezierVertex(-20, -30, 0);\n   * \n   *   bezierVertex(30, -50, 0);\n   *   bezierVertex(30, 25, 0);\n   *   bezierVertex(-20, 25, 0);\n   * \n   *   bezierVertex(0, 30, 0);\n   *   bezierVertex(10, -25, 0);\n   *   bezierVertex(-20, -30, 0);\n   *   endShape();\n   *\n   *   // Draw the second moon.\n   *   beginShape();\n   * \n   *   bezierVertex(-20, -30, -20);\n   * \n   *   bezierVertex(30, -50, -20);\n   *   bezierVertex(30, 25, -20);\n   *   bezierVertex(-20, 25, -20);\n   * \n   *   bezierVertex(0, 30, -20);\n   *   bezierVertex(10, -25, -20);\n   *   bezierVertex(-20, -30, -20);\n   * \n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method bezierVertex\n   * @param  {Number} x\n   * @param  {Number} y\n   * @param  {Number} z\n   * @param  {Number} [u]\n   * @param  {Number} [v]\n   */\n  fn.bezierVertex = function(...args) {\n    this._renderer.bezierVertex(...args);\n  };\n\n  /**\n   * Concludes the vertices of a custom shape. \n   * \n   * The <a href=\"#/p5/beginShape\">beginShape()</a> and `endShape()` functions\n   * allow for creating custom shapes in 2D or 3D.\n   * <a href=\"#/p5/beginShape\">beginShape()</a> begins adding vertices to a\n   * custom shape and `endShape()` stops adding them.\n   *\n   * The first parameter, `mode`, is optional. By default, the first and last\n   * vertices of a shape aren't connected. If the constant `CLOSE` is passed, as\n   * in `endShape(CLOSE)`, then the first and last vertices will be connected.\n   * When CLOSE mode is used for splines (with `splineVeertex()`), the shape is ended smoothly.\n   *\n   * \n   * The second parameter, `count`, is also optional. In WebGL mode, its more\n   * efficient to draw many copies of the same shape using a technique called\n   * <a href=\"https://webglfundamentals.org/webgl/lessons/webgl-instanced-drawing.html\" target=\"_blank\">instancing</a>.\n   * The `count` parameter tells WebGL mode how many copies to draw. For\n   * example, calling `endShape(CLOSE, 400)` after drawing a custom shape will\n   * make it efficient to draw 400 copies. This feature requires\n   * <a href=\"https://p5js.org/tutorials/intro-to-shaders/\" target=\"_blank\">writing a custom shader</a>.\n   *\n   * After calling <a href=\"#/p5/beginShape\">beginShape()</a>, shapes can be\n   * built by calling <a href=\"#/p5/vertex\">vertex()</a>,\n   * <a href=\"#/p5/bezierVertex\">bezierVertex()</a> and/or\n   * <a href=\"#/p5/splineVertex\">splineVertex()</a>. Calling\n   * `endShape()` will stop adding vertices to the\n   * shape. Each shape will be outlined with the current stroke color and filled\n   * with the current fill color.\n   *\n   * Transformations such as <a href=\"#/p5/translate\">translate()</a>,\n   * <a href=\"#/p5/rotate\">rotate()</a>, and\n   * <a href=\"#/p5/scale\">scale()</a> don't work between\n   * <a href=\"#/p5/beginShape\">beginShape()</a> and `endShape()`. It's also not\n   * possible to use other shapes, such as <a href=\"#/p5/ellipse\">ellipse()</a> or\n   * <a href=\"#/p5/rect\">rect()</a>, between\n   * <a href=\"#/p5/beginShape\">beginShape()</a> and `endShape()`.\n   *\n   * @method endShape\n   * @param  {CLOSE} [mode] use CLOSE to close the shape\n   * @param  {Integer} [count] number of times you want to draw/instance the shape (for WebGL mode).\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the shapes.\n   *   noFill();\n   *\n   *   // Left triangle.\n   *   beginShape();\n   *   vertex(20, 20);\n   *   vertex(45, 20);\n   *   vertex(45, 80);\n   *   endShape(CLOSE);\n   *\n   *   // Right triangle.\n   *   beginShape();\n   *   vertex(50, 20);\n   *   vertex(75, 20);\n   *   vertex(75, 80);\n   *   endShape();\n   *\n   *   describe(\n   *     'Two sets of black lines drawn on a gray background. The three lines on the left form a right triangle. The two lines on the right form a right angle.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   * \n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(200);\n   * \n   *   beginShape();\n   * \n   *   splineVertex(32, 91);\n   *   splineVertex(21, 17);\n   *   splineVertex(68, 19);\n   *   splineVertex(82, 91);\n   * \n   *   endShape(CLOSE);\n   * \n   *   describe(\n   *     'A curvy four-sided slightly lopsided blob.'\n   *   );\n   * }\n   * </div>\n   * </code>\n   *\n   * <div>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `#version 300 es\n   *\n   * precision mediump float;\n   *\n   * in vec3 aPosition;\n   * flat out int instanceID;\n   *\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   *\n   * void main() {\n   *\n   *   // Copy the instance ID to the fragment shader.\n   *   instanceID = gl_InstanceID;\n   *   vec4 positionVec4 = vec4(aPosition, 1.0);\n   *\n   *   // gl_InstanceID represents a numeric value for each instance.\n   *   // Using gl_InstanceID allows us to move each instance separately.\n   *   // Here we move each instance horizontally by ID * 23.\n   *   float xOffset = float(gl_InstanceID) * 23.0;\n   *\n   *   // Apply the offset to the final position.\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * (positionVec4 -\n   *     vec4(xOffset, 0.0, 0.0, 0.0));\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `#version 300 es\n   *\n   * precision mediump float;\n   *\n   * out vec4 outColor;\n   * flat in int instanceID;\n   * uniform float numInstances;\n   *\n   * void main() {\n   *   vec4 red = vec4(1.0, 0.0, 0.0, 1.0);\n   *   vec4 blue = vec4(0.0, 0.0, 1.0, 1.0);\n   *\n   *   // Normalize the instance ID.\n   *   float normId = float(instanceID) / numInstances;\n   *\n   *   // Mix between two colors using the normalized instance ID.\n   *   outColor = mix(red, blue, normId);\n   * }\n   * `;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Shader object.\n   *   let myShader = createShader(vertSrc, fragSrc);\n   *\n   *   background(220);\n   *\n   *   // Compile and apply the p5.Shader.\n   *   shader(myShader);\n   *\n   *   // Set the numInstances uniform.\n   *   myShader.setUniform('numInstances', 4);\n   *\n   *   // Translate the origin to help align the drawing.\n   *   translate(25, -10);\n   *\n   *   // Style the shapes.\n   *   noStroke();\n   *\n   *   // Draw the shapes.\n   *   beginShape();\n   *   vertex(0, 0);\n   *   vertex(0, 20);\n   *   vertex(20, 20);\n   *   vertex(20, 0);\n   *   vertex(0, 0);\n   *   endShape(CLOSE, 4);\n   *\n   *   describe('A row of four squares. Their colors transition from purple on the left to red on the right');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.endShape = function(mode, count = 1) {\n    // p5._validateParameters('endShape', arguments);\n    if (count < 1) {\n      console.log(' p5.js says: You can not have less than one instance');\n      count = 1;\n    }\n\n    this._renderer.endShape(mode, count);\n  };\n\n  /**\n   * Sets the normal vector for vertices in a custom 3D shape.\n   *\n   * 3D shapes created with <a href=\"#/p5/beginShape\">beginShape()</a> and\n   * <a href=\"#/p5/endShape\">endShape()</a> are made by connecting sets of\n   * points called vertices. Each vertex added with\n   * <a href=\"#/p5/vertex\">vertex()</a> has a normal vector that points away\n   * from it. The normal vector controls how light reflects off the shape.\n   *\n   * `normal()` can be called two ways with different parameters to define the\n   * normal vector's components.\n   *\n   * The first way to call `normal()` has three parameters, `x`, `y`, and `z`.\n   * If `Number`s are passed, as in `normal(1, 2, 3)`, they set the x-, y-, and\n   * z-components of the normal vector.\n   *\n   * The second way to call `normal()` has one parameter, `vector`. If a\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object is passed, as in\n   * `normal(myVector)`, its components will be used to set the normal vector.\n   *\n   * `normal()` changes the normal vector of vertices added to a custom shape\n   * with <a href=\"#/p5/vertex\">vertex()</a>. `normal()` must be called between\n   * the <a href=\"#/p5/beginShape\">beginShape()</a> and\n   * <a href=\"#/p5/endShape\">endShape()</a> functions, just like\n   * <a href=\"#/p5/vertex\">vertex()</a>. The normal vector set by calling\n   * `normal()` will affect all following vertices until `normal()` is called\n   * again:\n   *\n   * ```js\n   * beginShape();\n   *\n   * // Set the vertex normal.\n   * normal(-0.4, -0.4, 0.8);\n   *\n   * // Add a vertex.\n   * vertex(-30, -30, 0);\n   *\n   * // Set the vertex normal.\n   * normal(0, 0, 1);\n   *\n   * // Add vertices.\n   * vertex(30, -30, 0);\n   * vertex(30, 30, 0);\n   *\n   * // Set the vertex normal.\n   * normal(0.4, -0.4, 0.8);\n   *\n   * // Add a vertex.\n   * vertex(-30, 30, 0);\n   *\n   * endShape();\n   * ```\n   *\n   * @method normal\n   * @param  {p5.Vector} vector vertex normal as a <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click the and drag the mouse to view the scene from a different angle.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'A colorful square on a black background. The square changes color and rotates when the user drags the mouse. Parts of its surface reflect light in different directions.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the shape.\n   *   normalMaterial();\n   *   noStroke();\n   *\n   *   // Draw the shape.\n   *   beginShape();\n   *   vertex(-30, -30, 0);\n   *   vertex(30, -30, 0);\n   *   vertex(30, 30, 0);\n   *   vertex(-30, 30, 0);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click the and drag the mouse to view the scene from a different angle.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'A colorful square on a black background. The square changes color and rotates when the user drags the mouse. Parts of its surface reflect light in different directions.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the shape.\n   *   normalMaterial();\n   *   noStroke();\n   *\n   *   // Draw the shape.\n   *   // Use normal() to set vertex normals.\n   *   beginShape();\n   *   normal(-0.4, -0.4, 0.8);\n   *   vertex(-30, -30, 0);\n   *\n   *   normal(0, 0, 1);\n   *   vertex(30, -30, 0);\n   *   vertex(30, 30, 0);\n   *\n   *   normal(0.4, -0.4, 0.8);\n   *   vertex(-30, 30, 0);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='notest'>\n   * <code>\n   * // Click the and drag the mouse to view the scene from a different angle.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'A colorful square on a black background. The square changes color and rotates when the user drags the mouse. Parts of its surface reflect light in different directions.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the shape.\n   *   normalMaterial();\n   *   noStroke();\n   *\n   *   // Create p5.Vector objects.\n   *   let n1 = createVector(-0.4, -0.4, 0.8);\n   *   let n2 = createVector(0, 0, 1);\n   *   let n3 = createVector(0.4, -0.4, 0.8);\n   *\n   *   // Draw the shape.\n   *   // Use normal() to set vertex normals.\n   *   beginShape();\n   *   normal(n1);\n   *   vertex(-30, -30, 0);\n   *\n   *   normal(n2);\n   *   vertex(30, -30, 0);\n   *   vertex(30, 30, 0);\n   *\n   *   normal(n3);\n   *   vertex(-30, 30, 0);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method normal\n   * @param  {Number} x x-component of the vertex normal.\n   * @param  {Number} y y-component of the vertex normal.\n   * @param  {Number} z z-component of the vertex normal.\n   * @chainable\n   */\n  fn.normal = function(x, y, z) {\n    this._assert3d('normal');\n    // p5._validateParameters('normal', arguments);\n    this._renderer.normal(...arguments);\n\n    return this;\n  };\n\n  /**\n   * Sets the shader's vertex property or attribute variables.\n   *\n   * A vertex property, or vertex attribute, is a variable belonging to a vertex in a shader. p5.js provides some\n   * default properties, such as `aPosition`, `aNormal`, `aVertexColor`, etc. These are\n   * set using <a href=\"#/p5/vertex\">vertex()</a>, <a href=\"#/p5/normal\">normal()</a>\n   * and <a href=\"#/p5/fill\">fill()</a> respectively. Custom properties can also\n   * be defined within <a href=\"#/p5/beginShape\">beginShape()</a> and\n   * <a href=\"#/p5/endShape\">endShape()</a>.\n   *\n   * The first parameter, `propertyName`, is a string with the property's name.\n   * This is the same variable name which should be declared in the shader, such as\n   * `in vec3 aProperty`, similar to .`setUniform()`.\n   *\n   * The second parameter, `data`, is the value assigned to the shader variable. This\n   * value will be applied to subsequent vertices created with\n   * <a href=\"#/p5/vertex\">vertex()</a>. It can be a Number or an array of numbers,\n   * and in the shader program the type can be declared according to the WebGL\n   * specification. Common types include `float`, `vec2`, `vec3`, `vec4` or matrices.\n   *\n   * See also the <a href=\"#/p5/vertexProperty\">vertexProperty()</a> method on\n   * <a href=\"#/p5/Geometry\">Geometry</a> objects.\n   *\n   * @method vertexProperty\n   * @for p5\n   * @param {String} attributeName the name of the vertex attribute.\n   * @param {Number|Number[]} data the data tied to the vertex attribute.\n   *\n   * @example\n   * <div>\n   * <code>\n   * const vertSrc = `#version 300 es\n   *  precision mediump float;\n   *  uniform mat4 uModelViewMatrix;\n   *  uniform mat4 uProjectionMatrix;\n   *\n   *  in vec3 aPosition;\n   *  in vec2 aOffset;\n   *\n   *  void main(){\n   *    vec4 positionVec4 = vec4(aPosition.xyz, 1.0);\n   *    positionVec4.xy += aOffset;\n   *    gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   *  }\n   * `;\n   *\n   * const fragSrc = `#version 300 es\n   *  precision mediump float;\n   *  out vec4 outColor;\n   *  void main(){\n   *    outColor = vec4(0.0, 1.0, 1.0, 1.0);\n   *  }\n   * `;\n   *\n   * function setup(){\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create and use the custom shader.\n   *   const myShader = createShader(vertSrc, fragSrc);\n   *   shader(myShader);\n   *\n   *   describe('A wobbly, cyan circle on a gray background.');\n   * }\n   *\n   * function draw(){\n   *   // Set the styles\n   *   background(125);\n   *   noStroke();\n   *\n   *   // Draw the circle.\n   *   beginShape();\n   *   for (let i = 0; i < 30; i++){\n   *     const x = 40 * cos(i/30 * TWO_PI);\n   *     const y = 40 * sin(i/30 * TWO_PI);\n   *\n   *     // Apply some noise to the coordinates.\n   *     const xOff = 10 * noise(x + millis()/1000) - 5;\n   *     const yOff = 10 * noise(y + millis()/1000) - 5;\n   *\n   *     // Apply these noise values to the following vertex.\n   *     vertexProperty('aOffset', [xOff, yOff]);\n   *     vertex(x, y);\n   *   }\n   *   endShape(CLOSE);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myShader;\n   * const cols = 10;\n   * const rows = 10;\n   * const cellSize = 6;\n   *\n   * const vertSrc = `#version 300 es\n   *   precision mediump float;\n   *   uniform mat4 uProjectionMatrix;\n   *   uniform mat4 uModelViewMatrix;\n   *\n   *   in vec3 aPosition;\n   *   in vec3 aNormal;\n   *   in vec3 aVertexColor;\n   *   in float aDistance;\n   *\n   *   out vec3 vVertexColor;\n   *\n   *   void main(){\n   *     vec4 positionVec4 = vec4(aPosition, 1.0);\n   *     positionVec4.xyz += aDistance * aNormal * 2.0;;\n   *     vVertexColor = aVertexColor;\n   *     gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   *   }\n   * `;\n   *\n   * const fragSrc = `#version 300 es\n   *   precision mediump float;\n   *\n   *   in vec3 vVertexColor;\n   *   out vec4 outColor;\n   *\n   *   void main(){\n   *     outColor = vec4(vVertexColor, 1.0);\n   *   }\n   * `;\n   *\n   * function setup(){\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create and apply the custom shader.\n   *   myShader = createShader(vertSrc, fragSrc);\n   *   shader(myShader);\n   *   noStroke();\n   *   describe('A blue grid, which moves away from the mouse position, on a gray background.');\n   * }\n   *\n   * function draw(){\n   *   background(200);\n   *\n   *   // Draw the grid in the middle of the screen.\n   *   translate(-cols*cellSize/2, -rows*cellSize/2);\n   *   beginShape(QUADS);\n   *   for (let i = 0; i < cols; i++) {\n   *     for (let j = 0; j < rows; j++) {\n   *\n   *       // Calculate the cell position.\n   *       let x = i * cellSize;\n   *       let y = j * cellSize;\n   *\n   *       fill(j/rows*255, j/cols*255, 255);\n   *\n   *       // Calculate the distance from the corner of each cell to the mouse.\n   *       let distance = dist(x, y, mouseX, mouseY);\n   *\n   *       // Send the distance to the shader.\n   *       vertexProperty('aDistance', min(distance, 100));\n   *\n   *       vertex(x, y);\n   *       vertex(x + cellSize, y);\n   *       vertex(x + cellSize, y + cellSize);\n   *       vertex(x, y + cellSize);\n   *     }\n   *   }\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.vertexProperty = function(attributeName, data){\n    // this._assert3d('vertexProperty');\n    // p5._validateParameters('vertexProperty', arguments);\n    this._renderer.vertexProperty(attributeName, data);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  vertex(p5, p5.prototype);\n}\n\nexport { vertex as default };\n","import { N as NORMAL, u as BLEND } from '../constants-8IpwyBct.js';\nimport { R as RGB, b as RGBHDR, H as HSB, d as HSL, e as HWB, L as LAB, f as LCH, O as OKLAB, g as OKLCH } from '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport './color_spaces/hsb.js';\n\n/**\n * @module Color\n * @submodule Setting\n * @for p5\n * @requires core\n * @requires constants\n */\n\n\nfunction setting(p5, fn){\n  /**\n   * Starts defining a shape that will mask any shapes drawn afterward.\n   *\n   * Any shapes drawn between `beginClip()` and\n   * <a href=\"#/p5/endClip\">endClip()</a> will add to the mask shape. The mask\n   * will apply to anything drawn after <a href=\"#/p5/endClip\">endClip()</a>.\n   *\n   * The parameter, `options`, is optional. If an object with an `invert`\n   * property is passed, as in `beginClip({ invert: true })`, it will be used to\n   * set the masking mode. `{ invert: true }` inverts the mask, creating holes\n   * in shapes that are masked. `invert` is `false` by default.\n   *\n   * Masks can be contained between the\n   * <a href=\"#/p5/push\">push()</a> and <a href=\"#/p5/pop\">pop()</a> functions.\n   * Doing so allows unmasked shapes to be drawn after masked shapes.\n   *\n   * Masks can also be defined in a callback function that's passed to\n   * <a href=\"#/p5/clip\">clip()</a>.\n   *\n   * @method beginClip\n   * @param {Object} [options] an object containing clip settings.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a mask.\n   *   beginClip();\n   *   triangle(15, 37, 30, 13, 43, 37);\n   *   circle(45, 45, 7);\n   *   endClip();\n   *\n   *   // Draw a backing shape.\n   *   square(5, 5, 45);\n   *\n   *   describe('A white triangle and circle on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an inverted mask.\n   *   beginClip({ invert: true });\n   *   triangle(15, 37, 30, 13, 43, 37);\n   *   circle(45, 45, 7);\n   *   endClip();\n   *\n   *   // Draw a backing shape.\n   *   square(5, 5, 45);\n   *\n   *   describe('A white square at the top-left corner of a gray square. The white square has a triangle and a circle cut out of it.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   noStroke();\n   *\n   *   // Draw a masked shape.\n   *   push();\n   *   // Create a mask.\n   *   beginClip();\n   *   triangle(15, 37, 30, 13, 43, 37);\n   *   circle(45, 45, 7);\n   *   endClip();\n   *\n   *   // Draw a backing shape.\n   *   square(5, 5, 45);\n   *   pop();\n   *\n   *   // Translate the origin to the center.\n   *   translate(50, 50);\n   *\n   *   // Draw an inverted masked shape.\n   *   push();\n   *   // Create an inverted mask.\n   *   beginClip({ invert: true });\n   *   triangle(15, 37, 30, 13, 43, 37);\n   *   circle(45, 45, 7);\n   *   endClip();\n   *\n   *   // Draw a backing shape.\n   *   square(5, 5, 45);\n   *   pop();\n   *\n   *   describe('In the top left, a white triangle and circle. In the bottom right, a white square with a triangle and circle cut out of it.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A silhouette of a rotating torus colored fuchsia.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create a mask.\n   *   beginClip();\n   *   push();\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   scale(0.5);\n   *   torus(30, 15);\n   *   pop();\n   *   endClip();\n   *\n   *   // Draw a backing shape.\n   *   noStroke();\n   *   fill('fuchsia');\n   *   plane(100);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A silhouette of a rotating torus colored with a gradient from cyan to purple.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create a mask.\n   *   beginClip();\n   *   push();\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   scale(0.5);\n   *   torus(30, 15);\n   *   pop();\n   *   endClip();\n   *\n   *   // Draw a backing shape.\n   *   noStroke();\n   *   beginShape(QUAD_STRIP);\n   *   fill(0, 255, 255);\n   *   vertex(-width / 2, -height / 2);\n   *   vertex(width / 2, -height / 2);\n   *   fill(100, 0, 100);\n   *   vertex(-width / 2, height / 2);\n   *   vertex(width / 2, height / 2);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.beginClip = function(options = {}) {\n    this._renderer.beginClip(options);\n  };\n\n  /**\n   * Ends defining a mask that was started with\n   * <a href=\"#/p5/beginClip\">beginClip()</a>.\n   *\n   * @method endClip\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a mask.\n   *   beginClip();\n   *   triangle(15, 37, 30, 13, 43, 37);\n   *   circle(45, 45, 7);\n   *   endClip();\n   *\n   *   // Draw a backing shape.\n   *   square(5, 5, 45);\n   *\n   *   describe('A white triangle and circle on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.endClip = function() {\n    this._renderer.endClip();\n  };\n\n  /**\n   * Defines a shape that will mask any shapes drawn afterward.\n   *\n   * The first parameter, `callback`, is a function that defines the mask.\n   * Any shapes drawn in  `callback` will add to the mask shape. The mask\n   * will apply to anything drawn after `clip()` is called.\n   *\n   * The second parameter, `options`, is optional. If an object with an `invert`\n   * property is passed, as in `beginClip({ invert: true })`, it will be used to\n   * set the masking mode. `{ invert: true }` inverts the mask, creating holes\n   * in shapes that are masked. `invert` is `false` by default.\n   *\n   * Masks can be contained between the\n   * <a href=\"#/p5/push\">push()</a> and <a href=\"#/p5/pop\">pop()</a> functions.\n   * Doing so allows unmasked shapes to be drawn after masked shapes.\n   *\n   * Masks can also be defined with <a href=\"#/p5/beginClip\">beginClip()</a>\n   * and <a href=\"#/p5/endClip\">endClip()</a>.\n   *\n   * @method clip\n   * @param {Function} callback a function that draws the mask shape.\n   * @param {Object} [options] an object containing clip settings.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a mask.\n   *   clip(mask);\n   *\n   *   // Draw a backing shape.\n   *   square(5, 5, 45);\n   *\n   *   describe('A white triangle and circle on a gray background.');\n   * }\n   *\n   * // Declare a function that defines the mask.\n   * function mask() {\n   *   triangle(15, 37, 30, 13, 43, 37);\n   *   circle(45, 45, 7);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an inverted mask.\n   *   clip(mask, { invert: true });\n   *\n   *   // Draw a backing shape.\n   *   square(5, 5, 45);\n   *\n   *   describe('A white square at the top-left corner of a gray square. The white square has a triangle and a circle cut out of it.');\n   * }\n   *\n   * // Declare a function that defines the mask.\n   * function mask() {\n   *   triangle(15, 37, 30, 13, 43, 37);\n   *   circle(45, 45, 7);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   noStroke();\n   *\n   *   // Draw a masked shape.\n   *   push();\n   *   // Create a mask.\n   *   clip(mask);\n   *\n   *   // Draw a backing shape.\n   *   square(5, 5, 45);\n   *   pop();\n   *\n   *   // Translate the origin to the center.\n   *   translate(50, 50);\n   *\n   *   // Draw an inverted masked shape.\n   *   push();\n   *   // Create an inverted mask.\n   *   clip(mask, { invert: true });\n   *\n   *   // Draw a backing shape.\n   *   square(5, 5, 45);\n   *   pop();\n   *\n   *   describe('In the top left, a white triangle and circle. In the bottom right, a white square with a triangle and circle cut out of it.');\n   * }\n   *\n   * // Declare a function that defines the mask.\n   * function mask() {\n   *   triangle(15, 37, 30, 13, 43, 37);\n   *   circle(45, 45, 7);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A silhouette of a rotating torus colored fuchsia.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create a mask.\n   *   clip(mask);\n   *\n   *   // Draw a backing shape.\n   *   noStroke();\n   *   fill('fuchsia');\n   *   plane(100);\n   * }\n   *\n   * // Declare a function that defines the mask.\n   * function mask() {\n   *   push();\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   scale(0.5);\n   *   torus(30, 15);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A silhouette of a rotating torus colored with a gradient from cyan to purple.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create a mask.\n   *   clip(mask);\n   *\n   *   // Draw a backing shape.\n   *   noStroke();\n   *   beginShape(QUAD_STRIP);\n   *   fill(0, 255, 255);\n   *   vertex(-width / 2, -height / 2);\n   *   vertex(width / 2, -height / 2);\n   *   fill(100, 0, 100);\n   *   vertex(-width / 2, height / 2);\n   *   vertex(width / 2, height / 2);\n   *   endShape();\n   * }\n   *\n   * // Declare a function that defines the mask.\n   * function mask() {\n   *   push();\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   scale(0.5);\n   *   torus(30, 15);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.clip = function(callback, options) {\n    this._renderer.beginClip(options);\n    callback();\n    this._renderer.endClip(options);\n  };\n\n  /**\n   * Sets the color used for the background of the canvas.\n   *\n   * By default, the background is transparent. `background()` is typically used\n   * within <a href=\"#/p5/draw\">draw()</a> to clear the display window at the\n   * beginning of each frame. It can also be used inside\n   * <a href=\"#/p5/setup\">setup()</a> to set the background on the first frame\n   * of animation.\n   *\n   * The version of `background()` with one parameter interprets the value one\n   * of four ways. If the parameter is a `Number`, it's interpreted as a grayscale\n   * value. If the parameter is a `String`, it's interpreted as a CSS color string.\n   * RGB, RGBA, HSL, HSLA, hex, and named color strings are supported. If the\n   * parameter is a <a href=\"#/p5.Color\">p5.Color</a> object, it will be used as\n   * the background color. If the parameter is a\n   * <a href=\"#/p5.Image\">p5.Image</a> object, it will be used as the background\n   * image.\n   *\n   * The version of `background()` with two parameters interprets the first one\n   * as a grayscale value. The second parameter sets the alpha (transparency)\n   * value.\n   *\n   * The version of `background()` with three parameters interprets them as RGB,\n   * HSB, or HSL colors, depending on the current\n   * <a href=\"#/p5/colorMode\">colorMode()</a>. By default, colors are specified\n   * in RGB values. Calling `background(255, 204, 0)` sets the background a bright\n   * yellow color.\n   *\n   * @method background\n   * @param {p5.Color} color  any value created by the <a href=\"#/p5/color\">color()</a> function\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // A grayscale value.\n   *   background(51);\n   *\n   *   describe('A canvas with a dark charcoal gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // A grayscale value and an alpha value.\n   *   background(51, 0.4);\n   *   describe('A canvas with a transparent gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // R, G & B values.\n   *   background(255, 204, 0);\n   *\n   *   describe('A canvas with a yellow background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Use HSB color.\n   *   colorMode(HSB);\n   *\n   *   // H, S & B values.\n   *   background(255, 204, 100);\n   *\n   *   describe('A canvas with a royal blue background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // A CSS named color.\n   *   background('red');\n   *\n   *   describe('A canvas with a red background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Three-digit hex RGB notation.\n   *   background('#fae');\n   *\n   *   describe('A canvas with a pink background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Six-digit hex RGB notation.\n   *   background('#222222');\n   *\n   *   describe('A canvas with a black background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Integer RGB notation.\n   *   background('rgb(0, 255, 0)');\n   *\n   *   describe('A canvas with a bright green background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Integer RGBA notation.\n   *   background('rgba(0, 255, 0, 0.25)');\n   *\n   *   describe('A canvas with a transparent green background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Percentage RGB notation.\n   *   background('rgb(100%, 0%, 10%)');\n   *\n   *   describe('A canvas with a red background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Percentage RGBA notation.\n   *   background('rgba(100%, 0%, 100%, 0.5)');\n   *\n   *   describe('A canvas with a transparent purple background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // A p5.Color object.\n   *   let c = color(0, 0, 255);\n   *   background(c);\n   *\n   *   describe('A canvas with a blue background.');\n   * }\n   * </code>\n   * </div>\n   *\n   */\n\n  /**\n   * @method background\n   * @param {String} colorstring color string, possible formats include: integer\n   *                         rgb() or rgba(), percentage rgb() or rgba(),\n   *                         3-digit hex, 6-digit hex.\n   * @param {Number} [a]         opacity of the background relative to current\n   *                             color range (default is 0-255).\n   * @chainable\n   */\n\n  /**\n   * @method background\n   * @param {Number} gray   specifies a value between white and black.\n   * @param {Number} [a]\n   * @chainable\n   */\n\n  /**\n   * @method background\n   * @param {Number} v1     red value if color mode is RGB, or hue value if color mode is HSB.\n   * @param {Number} v2     green value if color mode is RGB, or saturation value if color mode is HSB.\n   * @param {Number} v3     blue value if color mode is RGB, or brightness value if color mode is HSB.\n   * @param  {Number} [a]\n   * @chainable\n   */\n\n  /**\n   * @method background\n   * @param  {Number[]}      values  an array containing the red, green, blue\n   *                                 and alpha components of the color.\n   * @chainable\n   */\n\n  /**\n   * @method background\n   * @param {p5.Image} image     image created with <a href=\"#/p5/loadImage\">loadImage()</a>\n   *                             or <a href=\"#/p5/createImage\">createImage()</a>,\n   *                             to set as background.\n   *                             (must be same size as the sketch window).\n   * @param  {Number}  [a]\n   * @chainable\n   */\n  fn.background = function(...args) {\n    this._renderer.background(...args);\n    return this;\n  };\n\n  /**\n   * Clears the pixels on the canvas.\n   *\n   * `clear()` makes every pixel 100% transparent. Calling `clear()` doesn't\n   * clear objects created by `createX()` functions such as\n   * <a href=\"#/p5/createGraphics\">createGraphics()</a>,\n   * <a href=\"#/p5/createVideo\">createVideo()</a>, and\n   * <a href=\"#/p5/createImg\">createImg()</a>. These objects will remain\n   * unchanged after calling `clear()` and can be redrawn.\n   *\n   * In WebGL mode, this function can clear the screen to a specific color. It\n   * interprets four numeric parameters as normalized RGBA color values. It also\n   * clears the depth buffer. If you are not using the WebGL renderer, these\n   * parameters will have no effect.\n   *\n   * @method clear\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A gray square. White circles are drawn as the user moves the mouse. The circles disappear when the user presses the mouse.');\n   * }\n   *\n   * function draw() {\n   *   circle(mouseX, mouseY, 20);\n   * }\n   *\n   * function mousePressed() {\n   *   clear();\n   *   background(200);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(200);\n   *\n   *   pg = createGraphics(60, 60);\n   *   pg.background(200);\n   *   pg.noStroke();\n   *   pg.circle(pg.width / 2, pg.height / 2, 15);\n   *   image(pg, 20, 20);\n   *\n   *   describe('A white circle drawn on a gray square. The square gets smaller when the mouse is pressed.');\n   * }\n   *\n   * function mousePressed() {\n   *   clear();\n   *   image(pg, 20, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * @param {Number} [r] normalized red value.\n   * @param {Number} [g] normalized green value.\n   * @param {Number} [b] normalized blue value.\n   * @param {Number} [a] normalized alpha value.\n   */\n  fn.clear = function(...args) {\n    const _r = args[0] || 0;\n    const _g = args[1] || 0;\n    const _b = args[2] || 0;\n    const _a = args[3] || 0;\n\n    this._renderer.clear(_r, _g, _b, _a);\n    return this;\n  };\n\n  /**\n   * Changes the way color values are interpreted.\n   *\n   * By default, the `Number` parameters for <a href=\"#/p5/fill\">fill()</a>,\n   * <a href=\"#/p5/stroke\">stroke()</a>,\n   * <a href=\"#/p5/background\">background()</a>, and\n   * <a href=\"#/p5/color\">color()</a> are defined by values between 0 and 255\n   * using the RGB color model. This is equivalent to calling\n   * `colorMode(RGB, 255)`. Pure red is `color(255, 0, 0)` in this model.\n   *\n   * Calling `colorMode(RGB, 100)` sets colors to use RGB color values\n   * between 0 and 100. Pure red is `color(100, 0, 0)` in this model.\n   *\n   * Calling `colorMode(HSB)` or `colorMode(HSL)` changes to HSB or HSL systems instead of RGB.\n   * Pure red is `color(0, 100, 100)` in HSB and `color(0, 100, 50)` in HSL.\n   *\n   * Some additional color modes that p5.js supports are:\n   *\n   * `RGBHDR` - High Dynamic Range RGB defined within the Display P3 color space.\n   *          Colors are expressed with an extended dynamic range. To render these colors\n   *          accurately, you must use the HDR canvas.\n   *\n   * `HWB`    - Hue, Whiteness, Blackness.\n   *          Similar to HSB and HSL, this mode uses a hue angle.\n   *          Instead of saturation and lightness, HWB defines colors based on the percentage\n   *          of whiteness and blackness. This is the color model used by Chrome's GUI color picker.\n   *          Pure red in HWB is represented as `color(0, 0, 0)` (i.e., hue 0 with 0% whiteness and 0% blackness).\n   *    \n   *          <img src=\"assets/hwb.png\"></img>\n   *\n   * `LAB`    - Also known as CIE Lab, this color mode defines colors with Lightness, Alpha, and Beta.\n   *          It is widely used in professional color measurement contexts due to its perceptual uniformity.\n   *\n   * `LCH`    - A more intuitive representation of the CIE Lab color space using Lightness, Chroma, and Hue.\n   *          This mode separates the color's chromatic intensity (chroma) from its lightness,\n   *          simplifying color selection and manipulation.\n   *\n   * `OKLAB`  - A variant of the CIE Lab color space that corrects for non-uniformities inherent in LAB.\n   *          The adjustment provides a more perceptually accurate and uniform representation,\n   *          which is particularly beneficial for smooth color transitions.\n   *\n   * `OKLCH`  - An easier-to-use representation of OKLAB, expressing colors in terms of Lightness, Chroma, and Hue.\n   *          This mode retains the perceptual benefits of OKLAB while offering a more intuitive format for color manipulation.\n   *\n   * <a href=\"#/p5.Color\">p5.Color</a> objects remember the mode that they were\n   * created in. Changing modes doesn't affect their appearance.\n   *\n   *  `Single-value (Grayscale) Colors`:    \n   *  When a color is specified with only one parameter (e.g., `color(g)`), p5.js will interpret it\n   *  as a grayscale color. However, how that single parameter translates into a grayscale value\n   *  depends on the color mode:\n   *\n   * - `RGB, HSB, and HSL`: In RGB, the single value is interpreted using the blue maximum \n   *   (i.e., the single parameter is mapped to the blue channel's max). \n   *   In HSB and HSL, the single value is mapped to Brightness and Lightness max respectively with hue=0 . \n   *   and saturation=0.\n   *\n   * - `LAB, LCH, OKLAB, and OKLCH`: The single value is taken to be the `lightness (L)` component,\n   *   with the specified max range for that channel.\n   *\n   * - `HWB`: Grayscale relies on both the `whiteness (W)` and `blackness (B)` channels. Since\n   *   a single value cannot directly account for two distinct channels, the library uses an\n   *   average of their max values to interpret the single grayscale parameter. For instance,\n   *   if W has a max of 50 and B has a max of 100, then the single grayscale parameter\n   *   is mapped using (50 + 100) / 2 = 75 as its effective maximum. More complex or negative\n   *   ranges are currently not handled, so results in those cases may be ambiguous.\n   *\n   * @method colorMode\n   * @param {RGB|HSB|HSL|RGBHDR|HWB|LAB|LCH|OKLAB|OKLCH} mode   either RGB, HSB, HSL,\n   *          or one of the extended modes described above.\n   * @param {Number}  [max]  range for all values.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Fill with pure red.\n   *   fill(255, 0, 0);\n   *\n   *   circle(50, 50, 25);\n   *\n   *   describe('A gray square with a red circle at its center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use RGB color with values in the range 0-100.\n   *   colorMode(RGB, 100);\n   *\n   *   // Fill with pure red.\n   *   fill(100, 0, 0);\n   *\n   *   circle(50, 50, 25);\n   *\n   *   describe('A gray square with a red circle at its center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use HSB color.\n   *   colorMode(HSB);\n   *\n   *   // Fill with pure red.\n   *   fill(0, 100, 100);\n   *\n   *   circle(50, 50, 25);\n   *\n   *   describe('A gray square with a red circle at its center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use HSL color.\n   *   colorMode(HSL);\n   *\n   *   // Fill with pure red.\n   *   fill(0, 100, 50);\n   *\n   *   circle(50, 50, 25);\n   *\n   *   describe('A gray square with a red circle at its center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   \n   *   // Draw a neutral gray background using the default color mode.\n   *   background(200); \n   *   \n   *   // Switch to HWB color mode.\n   *   // (Assuming p5.js supports HWB with a range of:\n   *   // hue: 0360, whiteness: 0100, blackness: 0100.)\n   *   colorMode(HWB);\n   *   \n   *   // Set fill to pure red in HWB.\n   *   // Pure red in HWB is: hue = 0, whiteness = 0%, blackness = 0%.\n   *   fill(0, 0, 0);\n   *   \n   *   // Draw a circle at the center.\n   *   circle(50, 50, 25);\n   *   \n   *   describe('A gray square with a red circle at its center, drawn using HWB color mode.');\n   * }\n   * </code>\n   * </div>\n   * \n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   \n   *   // Draw a neutral gray background using the default color mode.\n   *   background(200);\n   *   \n   *   // Switch to LAB color mode.\n   *   // In this mode, L typically ranges from 0 to 100 while a and b span roughly -128 to 127.\n   *   colorMode(LAB);\n   *   \n   *   // Set fill to pure red in LAB.\n   *   // The sRGB red (255, 0, 0) converts approximately to LAB as:\n   *   // L = 53, a = 80, b = 67.\n   *   fill(53, 80, 67);\n   *   \n   *   // Draw a circle at the center.\n   *   circle(50, 50, 25);\n   *   \n   *   describe('A gray square with a red circle at its center, drawn using LAB color mode.');\n   * }\n   * </code>\n   * </div>\n   * \n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   \n   *   // Draw a neutral gray background.\n   *   background(200);\n   *   \n   *   // Switch to LCH color mode.\n   *   // In LCH, colors are defined by Lightness, Chroma, and Hue (in degrees).\n   *   colorMode(LCH);\n   *   \n   *   // Set fill to an approximation of pure red in LCH:\n   *   // Lightness  53, Chroma  104, Hue  40.\n   *   fill(53, 104, 40);\n   *   \n   *   // Draw a circle at the center.\n   *   circle(50, 50, 25);\n   *   \n   *   describe('A gray square with a red circle at its center, drawn using LCH color mode.');\n   * }\n   * </code>  \n   * </div>\n   * \n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Use RGB color with values in the range 0-100.\n   *   colorMode(RGB, 100);\n   *\n   *   for (let x = 0; x < 100; x += 1) {\n   *     for (let y = 0; y < 100; y += 1) {\n   *       stroke(x, y, 0);\n   *       point(x, y);\n   *     }\n   *   }\n   *\n   *   describe(\n   *     'A diagonal green to red gradient from bottom-left to top-right with shading transitioning to black at top-left corner.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Use HSB color with values in the range 0-100.\n   *   colorMode(HSB, 100);\n   *\n   *   for (let x = 0; x < 100; x += 1) {\n   *     for (let y = 0; y < 100; y += 1) {\n   *       stroke(x, y, 100);\n   *       point(x, y);\n   *     }\n   *   }\n   *\n   *   describe('A rainbow gradient from left-to-right. Brightness transitions to white at the top.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Color object.\n   *   let myColor = color(180, 175, 230);\n   *   background(myColor);\n   *\n   *   // Use RGB color with values in the range 0-1.\n   *   colorMode(RGB, 1);\n   *\n   *   // Get the red, green, and blue color components.\n   *   let redValue = red(myColor);\n   *   let greenValue = green(myColor);\n   *   let blueValue = blue(myColor);\n   *\n   *   // Round the color components for display.\n   *   redValue = round(redValue, 2);\n   *   greenValue = round(greenValue, 2);\n   *   blueValue = round(blueValue, 2);\n   *\n   *   // Display the color components.\n   *   text(`Red: ${redValue}`, 10, 10, 80, 80);\n   *   text(`Green: ${greenValue}`, 10, 40, 80, 80);\n   *   text(`Blue: ${blueValue}`, 10, 70, 80, 80);\n   *\n   *   describe('A purple canvas with the red, green, and blue decimal values of the color written on it.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(255);\n   *\n   *   // Use RGB color with alpha values in the range 0-1.\n   *   colorMode(RGB, 255, 255, 255, 1);\n   *\n   *   noFill();\n   *   strokeWeight(4);\n   *   stroke(255, 0, 10, 0.3);\n   *   circle(40, 40, 50);\n   *   circle(50, 60, 50);\n   *\n   *   describe('Two overlapping translucent pink circle outlines.');\n   * }\n   * </code>\n   * </div>\n   * \n   * @example\n   * <div>\n   * <code>\n   * let hslGraphic, lchGraphic, oklchGraphic;\n   *\n   * function setup() {\n   *   createCanvas(600, 200);\n   *   noLoop();\n   *\n   *   // Create three graphics objects for HSL, LCH, and OKLCH color modes\n   *   hslGraphic = createGraphics(200, 200);\n   *   lchGraphic = createGraphics(200, 200);\n   *   oklchGraphic = createGraphics(200, 200);\n   *\n   *   // Draw HSL color wheel\n   *   colorMode(HSL);\n   *   hslGraphic.translate(100, 100);\n   *   for (let i = 0; i < 1000; i++) {\n   *     hslGraphic.stroke(360 / 1000 * i, 70, 50);\n   *     hslGraphic.line(0, 0, hslGraphic.width / 2, 0);\n   *     hslGraphic.rotate(TAU / 1000);\n   *   }\n   *\n   *   // Draw LCH color wheel\n   *   colorMode(LCH);\n   *   lchGraphic.translate(100, 100);\n   *   for (let i = 0; i < 1000; i++) {\n   *     lchGraphic.stroke(54, 106, 360 / 1000 * i);\n   *     lchGraphic.line(0, 0, lchGraphic.width / 2, 0);\n   *     lchGraphic.rotate(TAU / 1000);\n   *   }\n   *\n   *   // Draw OKLCH color wheel\n   *   colorMode(OKLCH);\n   *   oklchGraphic.translate(100, 100);\n   *   for (let i = 0; i < 1000; i++) {\n   *     oklchGraphic.stroke(54, 106, 360 / 1000 * i);\n   *     oklchGraphic.line(0, 0, oklchGraphic.width / 2, 0);\n   *     oklchGraphic.rotate(TAU / 1000);\n   *   }\n   * }\n   *\n   * function draw() {\n   *   // Set the styles\n   *   colorMode(RGB);\n   *   background(220);\n   *\n   *   // Display the color wheels\n   *   image(hslGraphic, 0, 0);\n   *   image(lchGraphic, 200, 0);\n   *   image(oklchGraphic, 400, 0);\n   * }\n   * </code>\n   * </div>\n   * \n   * @example\n   * <div>\n   * <code>\n   * // Example: Single-value (Grayscale) colors in different color modes.\n   * // The rectangle is filled with one parameter, but its final color depends\n   * // on how that parameter is interpreted by the current color mode.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   noStroke();\n   *   noLoop();\n   * }\n   *\n   * function draw() {\n   *   // Set color mode to RGB with range 0-255\n   *   colorMode(RGB, 255);\n   *   \n   *   // Fill with single grayscale value\n   *   fill(128);\n   *   rect(0, 0, 100, 100);\n   *\n   *   // Add text label\n   *   fill(0); // Switch to black text for clarity\n   *   textSize(14);\n   *   text(\"RGB (128)\", 10, 20);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method colorMode\n   * @param {RGB|HSB|HSL|RGBHDR|HWB|LAB|LCH|OKLAB|OKLCH} mode\n   * @param {Number} max1     range for the red or hue depending on the\n   *                              current color mode.\n   * @param {Number} max2     range for the green or saturation depending\n   *                              on the current color mode.\n   * @param {Number} max3     range for the blue or brightness/lightness\n   *                              depending on the current color mode.\n   * @param {Number} [maxA]   range for the alpha.\n   *\n   * @return {String}      The current color mode.\n   */\n  fn.colorMode = function(mode, max1, max2, max3, maxA) {\n    // p5._validateParameters('colorMode', arguments);\n    if (\n      [\n        RGB,\n        RGBHDR,\n        HSB,\n        HSL,\n        HWB,\n        LAB,\n        LCH,\n        OKLAB,\n        OKLCH\n      ].includes(mode)\n    ) {\n      // Set color mode.\n      this._renderer.states.setValue('colorMode', mode);\n\n      // Set color maxes.\n      this._renderer.states.setValue('colorMaxes', this._renderer.states.colorMaxes.clone());\n      const maxes = this._renderer.states.colorMaxes[mode];\n      if (arguments.length === 2) {\n        maxes[0] = max1; // Red\n        maxes[1] = max1; // Green\n        maxes[2] = max1; // Blue\n        maxes[3] = max1; // Alpha\n      } else if (arguments.length === 4) {\n        maxes[0] = max1; // Red\n        maxes[1] = max2; // Green\n        maxes[2] = max3; // Blue\n      } else if (arguments.length === 5) {\n        maxes[0] = max1; // Red\n        maxes[1] = max2; // Green\n        maxes[2] = max3; // Blue\n        maxes[3] = maxA; // Alpha\n      }\n    }\n\n    return this._renderer.states.colorMode;\n  };\n\n  /**\n   * Sets the color used to fill shapes.\n   *\n   * Calling `fill(255, 165, 0)` or `fill('orange')` means all shapes drawn\n   * after the fill command will be filled with the color orange.\n   *\n   * The version of `fill()` with one parameter interprets the value one of\n   * three ways. If the parameter is a `Number`, it's interpreted as a grayscale\n   * value. If the parameter is a `String`, it's interpreted as a CSS color\n   * string. A <a href=\"#/p5.Color\">p5.Color</a> object can also be provided to\n   * set the fill color.\n   *\n   * The version of `fill()` with three parameters interprets them as RGB, HSB,\n   * or HSL colors, depending on the current\n   * <a href=\"#/p5/colorMode\">colorMode()</a>. The default color space is RGB,\n   * with each value in the range from 0 to 255.\n   *\n   * @method fill\n   * @param  {Number}        v1      red value if color mode is RGB or hue value if color mode is HSB.\n   * @param  {Number}        v2      green value if color mode is RGB or saturation value if color mode is HSB.\n   * @param  {Number}        v3      blue value if color mode is RGB or brightness value if color mode is HSB.\n   * @param  {Number}        [alpha] alpha value, controls transparency (0 - transparent, 255 - opaque).\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // A grayscale value.\n   *   fill(51);\n   *   square(20, 20, 60);\n   *\n   *   describe('A dark charcoal gray square with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // R, G & B values.\n   *   fill(255, 204, 0);\n   *   square(20, 20, 60);\n   *\n   *   describe('A yellow square with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(100);\n   *\n   *   // Use HSB color.\n   *   colorMode(HSB);\n   *\n   *   // H, S & B values.\n   *   fill(255, 204, 100);\n   *   square(20, 20, 60);\n   *\n   *   describe('A royal blue square with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // A CSS named color.\n   *   fill('red');\n   *   square(20, 20, 60);\n   *\n   *   describe('A red square with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Three-digit hex RGB notation.\n   *   fill('#fae');\n   *   square(20, 20, 60);\n   *\n   *   describe('A pink square with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Six-digit hex RGB notation.\n   *   fill('#A251FA');\n   *   square(20, 20, 60);\n   *\n   *   describe('A purple square with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Integer RGB notation.\n   *   fill('rgb(0, 255, 0)');\n   *   square(20, 20, 60);\n   *\n   *   describe('A bright green square with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Integer RGBA notation.\n   *   fill('rgba(0, 255, 0, 0.25)');\n   *   square(20, 20, 60);\n   *\n   *   describe('A soft green rectange with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Percentage RGB notation.\n   *   fill('rgb(100%, 0%, 10%)');\n   *   square(20, 20, 60);\n   *\n   *   describe('A red square with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Percentage RGBA notation.\n   *   fill('rgba(100%, 0%, 100%, 0.5)');\n   *   square(20, 20, 60);\n   *\n   *   describe('A dark fuchsia square with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // A p5.Color object.\n   *   let c = color(0, 0, 255);\n   *   fill(c);\n   *   square(20, 20, 60);\n   *\n   *   describe('A blue square with a black outline.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method fill\n   * @param  {String}        value   a color string.\n   * @chainable\n   */\n\n  /**\n   * @method fill\n   * @param  {Number}        gray   a grayscale value.\n   * @param  {Number}        [alpha]\n   * @chainable\n   */\n\n  /**\n   * @method fill\n   * @param  {Number[]}      values  an array containing the red, green, blue &\n   *                                 and alpha components of the color.\n   * @chainable\n   */\n\n  /**\n   * @method fill\n   * @param  {p5.Color}      color   the fill color.\n   * @chainable\n   */\n  fn.fill = function(...args) {\n    this._renderer.fill(...args);\n    return this;\n  };\n\n  /**\n   * Disables setting the fill color for shapes.\n   *\n   * Calling `noFill()` is the same as making the fill completely transparent,\n   * as in `fill(0, 0)`. If both <a href=\"#/p5/noStroke\">noStroke()</a> and\n   * `noFill()` are called, nothing will be drawn to the screen.\n   *\n   * @method noFill\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Draw the top square.\n   *   square(32, 10, 35);\n   *\n   *   // Draw the bottom square.\n   *   noFill();\n   *   square(32, 55, 35);\n   *\n   *   describe('A white square on above an empty square. Both squares have black outlines.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div modernizr='webgl'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A purple cube wireframe spinning on a black canvas.');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Style the box.\n   *   noFill();\n   *   stroke(100, 100, 240);\n   *\n   *   // Rotate the coordinates.\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Draw the box.\n   *   box(45);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noFill = function() {\n    this._renderer.noFill();\n    return this;\n  };\n\n  /**\n   * Disables drawing points, lines, and the outlines of shapes.\n   *\n   * Calling `noStroke()` is the same as making the stroke completely transparent,\n   * as in `stroke(0, 0)`. If both `noStroke()` and\n   * <a href=\"#/p5/noFill\">noFill()</a> are called, nothing will be drawn to the\n   * screen.\n   *\n   * @method noStroke\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   noStroke();\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with no outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div modernizr='webgl'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A pink cube with no edge outlines spinning on a black canvas.');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Style the box.\n   *   noStroke();\n   *   fill(240, 150, 150);\n   *\n   *   // Rotate the coordinates.\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Draw the box.\n   *   box(45);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noStroke = function() {\n    this._renderer.states.setValue('strokeColor', null);\n    return this;\n  };\n\n  /**\n   * Sets the color used to draw points, lines, and the outlines of shapes.\n   *\n   * Calling `stroke(255, 165, 0)` or `stroke('orange')` means all shapes drawn\n   * after calling `stroke()` will be filled with the color orange. The way\n   * these parameters are interpreted may be changed with the\n   * <a href=\"#/p5/colorMode\">colorMode()</a> function.\n   *\n   * The version of `stroke()` with one parameter interprets the value one of\n   * three ways. If the parameter is a `Number`, it's interpreted as a grayscale\n   * value. If the parameter is a `String`, it's interpreted as a CSS color\n   * string. A <a href=\"#/p5.Color\">p5.Color</a> object can also be provided to\n   * set the stroke color.\n   *\n   * The version of `stroke()` with two parameters interprets the first one as a\n   * grayscale value. The second parameter sets the alpha (transparency) value.\n   *\n   * The version of `stroke()` with three parameters interprets them as RGB, HSB,\n   * or HSL colors, depending on the current `colorMode()`.\n   *\n   * The version of `stroke()` with four parameters interprets them as RGBA, HSBA,\n   * or HSLA colors, depending on the current `colorMode()`. The last parameter\n   * sets the alpha (transparency) value.\n   *\n   * @method stroke\n   * @param  {Number}        v1      red value if color mode is RGB or hue value if color mode is HSB.\n   * @param  {Number}        v2      green value if color mode is RGB or saturation value if color mode is HSB.\n   * @param  {Number}        v3      blue value if color mode is RGB or brightness value if color mode is HSB.\n   * @param  {Number}        [alpha] alpha value, controls transparency (0 - transparent, 255 - opaque).\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // A grayscale value.\n   *   strokeWeight(4);\n   *   stroke(51);\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with a dark charcoal gray outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // R, G & B values.\n   *   stroke(255, 204, 0);\n   *   strokeWeight(4);\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with a yellow outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use HSB color.\n   *   colorMode(HSB);\n   *\n   *   // H, S & B values.\n   *   strokeWeight(4);\n   *   stroke(255, 204, 100);\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with a royal blue outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // A CSS named color.\n   *   stroke('red');\n   *   strokeWeight(4);\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with a red outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Three-digit hex RGB notation.\n   *   stroke('#fae');\n   *   strokeWeight(4);\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with a pink outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Six-digit hex RGB notation.\n   *   stroke('#222222');\n   *   strokeWeight(4);\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Integer RGB notation.\n   *   stroke('rgb(0, 255, 0)');\n   *   strokeWeight(4);\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with a bright green outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Integer RGBA notation.\n   *   stroke('rgba(0, 255, 0, 0.25)');\n   *   strokeWeight(4);\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with a soft green outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Percentage RGB notation.\n   *   stroke('rgb(100%, 0%, 10%)');\n   *   strokeWeight(4);\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with a red outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Percentage RGBA notation.\n   *   stroke('rgba(100%, 0%, 100%, 0.5)');\n   *   strokeWeight(4);\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with a dark fuchsia outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // A p5.Color object.\n   *   stroke(color(0, 0, 255));\n   *   strokeWeight(4);\n   *   square(20, 20, 60);\n   *\n   *   describe('A white square with a blue outline.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method stroke\n   * @param  {String}        value   a color string.\n   * @chainable\n   */\n\n  /**\n   * @method stroke\n   * @param  {Number}        gray   a grayscale value.\n   * @param  {Number}        [alpha]\n   * @chainable\n   */\n\n  /**\n   * @method stroke\n   * @param  {Number[]}      values  an array containing the red, green, blue,\n   *                                 and alpha components of the color.\n   * @chainable\n   */\n\n  /**\n   * @method stroke\n   * @param  {p5.Color}      color   the stroke color.\n   * @chainable\n   */\n  fn.stroke = function(...args) {\n    this._renderer.stroke(...args);\n    return this;\n  };\n\n  /**\n   * Starts using shapes to erase parts of the canvas.\n   *\n   * All drawing that follows `erase()` will subtract from the canvas, revealing\n   * the web page underneath. The erased areas will become transparent, allowing\n   * the content behind the canvas to show through. The\n   * <a href=\"#/p5/fill\">fill()</a>, <a href=\"#/p5/stroke\">stroke()</a>, and\n   * <a href=\"#/p5/blendMode\">blendMode()</a> have no effect once `erase()` is\n   * called.\n   *\n   * The `erase()` function has two optional parameters. The first parameter\n   * sets the strength of erasing by the shape's interior. A value of 0 means\n   * that no erasing will occur. A value of 255 means that the shape's interior\n   * will fully erase the content underneath. The default value is 255\n   * (full strength).\n   *\n   * The second parameter sets the strength of erasing by the shape's edge. A\n   * value of 0 means that no erasing will occur. A value of 255 means that the\n   * shape's edge will fully erase the content underneath. The default value is\n   * 255 (full strength).\n   *\n   * To cancel the erasing effect, use the <a href=\"#/p5/noErase\">noErase()</a>\n   * function.\n   *\n   * `erase()` has no effect on drawing done with the\n   * <a href=\"#/p5/image\">image()</a> and\n   * <a href=\"#/p5/background\">background()</a> functions.\n   *\n   * @method erase\n   * @param  {Number}   [strengthFill]      a number (0-255) for the strength of erasing under a shape's interior.\n   *                                        Defaults to 255, which is full strength.\n   * @param  {Number}   [strengthStroke]    a number (0-255) for the strength of erasing under a shape's edge.\n   *                                        Defaults to 255, which is full strength.\n   *\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(100, 100, 250);\n   *\n   *   // Draw a pink square.\n   *   fill(250, 100, 100);\n   *   square(20, 20, 60);\n   *\n   *   // Erase a circular area.\n   *   erase();\n   *   circle(25, 30, 30);\n   *   noErase();\n   *\n   *   describe('A purple canvas with a pink square in the middle. A circle is erased from the top-left, leaving a hole.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(100, 100, 250);\n   *\n   *   // Draw a pink square.\n   *   fill(250, 100, 100);\n   *   square(20, 20, 60);\n   *\n   *   // Erase a circular area.\n   *   strokeWeight(5);\n   *   erase(150, 255);\n   *   circle(25, 30, 30);\n   *   noErase();\n   *\n   *   describe('A purple canvas with a pink square in the middle. A circle at the top-left partially erases its interior and a fully erases its outline.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.erase = function(opacityFill = 255, opacityStroke = 255) {\n    this._renderer.erase(opacityFill, opacityStroke);\n\n    return this;\n  };\n\n  /**\n   * Ends erasing that was started with <a href=\"#/p5/erase\">erase()</a>.\n   *\n   * The <a href=\"#/p5/fill\">fill()</a>, <a href=\"#/p5/stroke\">stroke()</a>, and\n   * <a href=\"#/p5/blendMode\">blendMode()</a> settings will return to what they\n   * were prior to calling <a href=\"#/p5/erase\">erase()</a>.\n   *\n   * @method noErase\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(235, 145, 15);\n   *\n   *   // Draw the left rectangle.\n   *   noStroke();\n   *   fill(30, 45, 220);\n   *   rect(30, 10, 10, 80);\n   *\n   *   // Erase a circle.\n   *   erase();\n   *   circle(50, 50, 60);\n   *   noErase();\n   *\n   *   // Draw the right rectangle.\n   *   rect(70, 10, 10, 80);\n   *\n   *   describe('An orange canvas with two tall blue rectangles. A circular hole in the center erases the rectangle on the left but not the one on the right.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noErase = function() {\n    this._renderer.noErase();\n    return this;\n  };\n\n  /**\n   * Sets the way colors blend when added to the canvas.\n   *\n   * By default, drawing with a solid color paints over the current pixel values\n   * on the canvas. `blendMode()` offers many options for blending colors.\n   *\n   * Shapes, images, and text can be used as sources for drawing to the canvas.\n   * A source pixel changes the color of the canvas pixel where it's drawn. The\n   * final color results from blending the source pixel's color with the canvas\n   * pixel's color. RGB color values from the source and canvas pixels are\n   * compared, added, subtracted, multiplied, and divided to create different\n   * effects. Red values with red values, greens with greens, and blues with\n   * blues.\n   *\n   * The parameter, `mode`, sets the blend mode. For example, calling\n   * `blendMode(ADD)` sets the blend mode to `ADD`. The following blend modes\n   * are available in both 2D and WebGL mode:\n   *\n   * - `BLEND`: color values from the source overwrite the canvas. This is the default mode.\n   * - `ADD`: color values from the source are added to values from the canvas.\n   * - `DARKEST`: keeps the darkest color value.\n   * - `LIGHTEST`: keeps the lightest color value.\n   * - `EXCLUSION`: similar to `DIFFERENCE` but with less contrast.\n   * - `MULTIPLY`: color values from the source are multiplied with values from the canvas. The result is always darker.\n   * - `SCREEN`: all color values are inverted, then multiplied, then inverted again. The result is always lighter. (Opposite of `MULTIPLY`)\n   * - `REPLACE`: the last source drawn completely replaces the rest of the canvas.\n   * - `REMOVE`: overlapping pixels are removed by making them completely transparent.\n   *\n   * The following blend modes are only available in 2D mode:\n   *\n   * - `DIFFERENCE`: color values from the source are subtracted from the values from the canvas. If the difference is a negative number, it's made positive.\n   * - `OVERLAY`: combines `MULTIPLY` and `SCREEN`. Dark values in the canvas get darker and light values get lighter.\n   * - `HARD_LIGHT`: combines `MULTIPLY` and `SCREEN`. Dark values in the source get darker and light values get lighter.\n   * - `SOFT_LIGHT`: a softer version of `HARD_LIGHT`.\n   * - `DODGE`: lightens light tones and increases contrast. Divides the canvas color values by the inverted color values from the source.\n   * - `BURN`: darkens dark tones and increases contrast. Divides the source color values by the inverted color values from the canvas, then inverts the result.\n   *\n   * The following blend modes are only available in WebGL mode:\n   *\n   * - `SUBTRACT`: RGB values from the source are subtracted from the values from the canvas. If the difference is a negative number, it's made positive. Alpha (transparency) values from the source and canvas are added.\n   *\n   * @method blendMode\n   * @param  {(BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|REMOVE|SUBTRACT)} mode blend mode to set.\n   *                either BLEND, DARKEST, LIGHTEST, DIFFERENCE, MULTIPLY,\n   *                EXCLUSION, SCREEN, REPLACE, OVERLAY, HARD_LIGHT,\n   *                SOFT_LIGHT, DODGE, BURN, ADD, REMOVE or SUBTRACT\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use the default blend mode.\n   *   blendMode(BLEND);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A blue line and a red line form an X on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(ADD);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A faint blue line and a faint red line form an X on a gray background. The area where they overlap is faint magenta.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(DARKEST);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A blue line and a red line form an X on a gray background. The area where they overlap is black.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(LIGHTEST);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A faint blue line and a faint red line form an X on a gray background. The area where they overlap is faint magenta.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(EXCLUSION);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A yellow line and a cyan line form an X on a gray background. The area where they overlap is green.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(MULTIPLY);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A blue line and a red line form an X on a gray background. The area where they overlap is black.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(SCREEN);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A faint blue line and a faint red line form an X on a gray background. The area where they overlap is faint magenta.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(REPLACE);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A diagonal red line.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(REMOVE);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('The silhouette of an X is missing from a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(DIFFERENCE);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A yellow line and a cyan line form an X on a gray background. The area where they overlap is green.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(OVERLAY);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A faint blue line and a faint red line form an X on a gray background. The area where they overlap is bright magenta.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(HARD_LIGHT);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A blue line and a red line form an X on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(SOFT_LIGHT);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A faint blue line and a faint red line form an X on a gray background. The area where they overlap is violet.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(DODGE);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A faint blue line and a faint red line form an X on a gray background. The area where they overlap is faint violet.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(BURN);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A blue line and a red line form an X on a gray background. The area where they overlap is black.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the blend mode.\n   *   blendMode(SUBTRACT);\n   *\n   *   // Style the lines.\n   *   strokeWeight(30);\n   *\n   *   // Draw the blue line.\n   *   stroke('blue');\n   *   line(25, 25, 75, 75);\n   *\n   *   // Draw the red line.\n   *   stroke('red');\n   *   line(75, 25, 25, 75);\n   *\n   *   describe('A yellow line and a turquoise line form an X on a gray background. The area where they overlap is green.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.blendMode = function (mode) {\n    // p5._validateParameters('blendMode', arguments);\n    if (mode === NORMAL) {\n      // Warning added 3/26/19, can be deleted in future (1.0 release?)\n      console.warn(\n        'NORMAL has been deprecated for use in blendMode. defaulting to BLEND instead.'\n      );\n      mode = BLEND;\n    }\n    this._renderer.blendMode(mode);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  setting(p5, p5.prototype);\n}\n\nexport { setting as default };\n","/*\nThe MIT License (MIT)\n\nCopyright (c) 2019 Evan Plaice <evanplaice@gmail.com>\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n'Software'), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\nCLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\nTORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n*/\nfunction parse (csv, options, reviver = v => v) {\n  const ctx = Object.create(null);\n  ctx.options = options || {};\n  ctx.reviver = reviver;\n  ctx.value = '';\n  ctx.entry = [];\n  ctx.output = [];\n  ctx.col = 1;\n  ctx.row = 1;\n\n  ctx.options.delimiter = ctx.options.delimiter === undefined ? '\"' : options.delimiter;\n  if(ctx.options.delimiter.length > 1 || ctx.options.delimiter.length === 0)\n    throw Error(`CSVError: delimiter must be one character [${ctx.options.separator}]`)\n\n  ctx.options.separator = ctx.options.separator === undefined ? ',' : options.separator;\n  if(ctx.options.separator.length > 1 || ctx.options.separator.length === 0)\n    throw Error(`CSVError: separator must be one character [${ctx.options.separator}]`)\n\n  const lexer = new RegExp(`${escapeRegExp(ctx.options.delimiter)}|${escapeRegExp(ctx.options.separator)}|\\r\\n|\\n|\\r|[^${escapeRegExp(ctx.options.delimiter)}${escapeRegExp(ctx.options.separator)}\\r\\n]+`, 'y');\n  const isNewline = /^(\\r\\n|\\n|\\r)$/;\n\n  let matches = [];\n  let match = '';\n  let state = 0;\n\n  while ((matches = lexer.exec(csv)) !== null) {\n    match = matches[0];\n\n    switch (state) {\n      case 0: // start of entry\n        switch (true) {\n          case match === ctx.options.delimiter:\n            state = 3;\n            break\n          case match === ctx.options.separator:\n            state = 0;\n            valueEnd(ctx);\n            break\n          case isNewline.test(match):\n            state = 0;\n            valueEnd(ctx);\n            entryEnd(ctx);\n            break\n          default:\n            ctx.value += match;\n            state = 2;\n            break\n        }\n        break\n      case 2: // un-delimited input\n        switch (true) {\n          case match === ctx.options.separator:\n            state = 0;\n            valueEnd(ctx);\n            break\n          case isNewline.test(match):\n            state = 0;\n            valueEnd(ctx);\n            entryEnd(ctx);\n            break\n          default:\n            state = 4;\n            throw Error(`CSVError: Illegal state [row:${ctx.row}, col:${ctx.col}]`)\n        }\n        break\n      case 3: // delimited input\n        switch (true) {\n          case match === ctx.options.delimiter:\n            state = 4;\n            break\n          default:\n            state = 3;\n            ctx.value += match;\n            break\n        }\n        break\n      case 4: // escaped or closing delimiter\n        switch (true) {\n          case match === ctx.options.delimiter:\n            state = 3;\n            ctx.value += match;\n            break\n          case match === ctx.options.separator:\n            state = 0;\n            valueEnd(ctx);\n            break\n          case isNewline.test(match):\n            state = 0;\n            valueEnd(ctx);\n            entryEnd(ctx);\n            break\n          default:\n            throw Error(`CSVError: Illegal state [row:${ctx.row}, col:${ctx.col}]`)\n        }\n        break\n    }\n  }\n\n  // flush the last value\n  if (ctx.entry.length !== 0) {\n    valueEnd(ctx);\n    entryEnd(ctx);\n  }\n\n  return ctx.output\n}\n\nfunction stringify (array, options = {}, replacer = v => v) {\n  const ctx = Object.create(null);\n  ctx.options = options;\n  ctx.options.eof = ctx.options.eof !== undefined ? ctx.options.eof : true;\n  ctx.row = 1;\n  ctx.col = 1;\n  ctx.output = '';\n\n  ctx.options.delimiter = ctx.options.delimiter === undefined ? '\"' : options.delimiter;\n  if(ctx.options.delimiter.length > 1 || ctx.options.delimiter.length === 0)\n    throw Error(`CSVError: delimiter must be one character [${ctx.options.separator}]`)\n\n  ctx.options.separator = ctx.options.separator === undefined ? ',' : options.separator;\n  if(ctx.options.separator.length > 1 || ctx.options.separator.length === 0)\n    throw Error(`CSVError: separator must be one character [${ctx.options.separator}]`)\n\n  const needsDelimiters = new RegExp(`${escapeRegExp(ctx.options.delimiter)}|${escapeRegExp(ctx.options.separator)}|\\r\\n|\\n|\\r`);\n\n  array.forEach((row, rIdx) => {\n    let entry = '';\n    ctx.col = 1;\n    row.forEach((col, cIdx) => {\n      if (typeof col === 'string') {\n        col = col.replace(new RegExp(ctx.options.delimiter, 'g'), `${ctx.options.delimiter}${ctx.options.delimiter}`);\n        col = needsDelimiters.test(col) ? `${ctx.options.delimiter}${col}${ctx.options.delimiter}` : col;\n      }\n      entry += replacer(col, ctx.row, ctx.col);\n      if (cIdx !== row.length - 1) {\n        entry += ctx.options.separator;\n      }\n      ctx.col++;\n    });\n    switch (true) {\n      case ctx.options.eof:\n      case !ctx.options.eof && rIdx !== array.length - 1:\n        ctx.output += `${entry}\\n`;\n        break\n      default:\n        ctx.output += `${entry}`;\n        break\n    }\n    ctx.row++;\n  });\n\n  return ctx.output\n}\n\nfunction valueEnd (ctx) {\n  const value = ctx.options.typed ? inferType(ctx.value) : ctx.value;\n  ctx.entry.push(ctx.reviver(value, ctx.row, ctx.col));\n  ctx.value = '';\n  ctx.col++;\n}\n\nfunction entryEnd (ctx) {\n  ctx.output.push(ctx.entry);\n  ctx.entry = [];\n  ctx.row++;\n  ctx.col = 1;\n}\n\nfunction inferType (value) {\n  const isNumber = /.\\./;\n\n  switch (true) {\n    case value === 'true':\n    case value === 'false':\n      return value === 'true'\n    case isNumber.test(value):\n      return parseFloat(value)\n    case isFinite(value):\n      return parseInt(value)\n    default:\n      return value\n  }\n}\n\nfunction escapeRegExp(str) {\n  return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n}\n\nexport { parse, stringify };\n","import Filters from './filters.js';\n\n/**\n * @module Image\n * @submodule Pixels\n * @for p5\n * @requires core\n */\n\n\nfunction pixels(p5, fn){\n  /**\n   * An array containing the color of each pixel on the canvas.\n   *\n   * Colors are stored as numbers representing red, green, blue, and alpha\n   * (RGBA) values. `pixels` is a one-dimensional array for performance reasons.\n   *\n   * Each pixel occupies four elements in the `pixels` array, one for each RGBA\n   * value. For example, the pixel at coordinates (0, 0) stores its RGBA values\n   * at `pixels[0]`, `pixels[1]`, `pixels[2]`, and `pixels[3]`, respectively.\n   * The next pixel at coordinates (1, 0) stores its RGBA values at `pixels[4]`,\n   * `pixels[5]`, `pixels[6]`, and `pixels[7]`. And so on. The `pixels` array\n   * for a 100&times;100 canvas has 100 &times; 100 &times; 4 = 40,000 elements.\n   *\n   * Some displays use several smaller pixels to set the color at a single\n   * point. The <a href=\"#/p5/pixelDensity\">pixelDensity()</a> function returns\n   * the pixel density of the canvas. High density displays often have a\n   * <a href=\"#/p5/pixelDensity\">pixelDensity()</a> of 2. On such a display, the\n   * `pixels` array for a 100&times;100 canvas has 200 &times; 200 &times; 4 =\n   * 160,000 elements.\n   *\n   * Accessing the RGBA values for a point on the canvas requires a little math\n   * as shown below. The <a href=\"#/p5/loadPixels\">loadPixels()</a> function\n   * must be called before accessing the `pixels` array. The\n   * <a href=\"#/p5/updatePixels\">updatePixels()</a> function must be called\n   * after any changes are made.\n   *\n   * @property {Number[]} pixels\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(128);\n   *\n   *   // Load the pixels array.\n   *   loadPixels();\n   *\n   *   // Set the dot's coordinates.\n   *   let x = 50;\n   *   let y = 50;\n   *\n   *   // Get the pixel density.\n   *   let d = pixelDensity();\n   *\n   *   // Set the pixel(s) at the center of the canvas black.\n   *   for (let i = 0; i < d; i += 1) {\n   *     for (let j = 0; j < d; j += 1) {\n   *       let index = 4 * ((y * d + j) * width * d + (x * d + i));\n   *       // Red.\n   *       pixels[index] = 0;\n   *       // Green.\n   *       pixels[index + 1] = 0;\n   *       // Blue.\n   *       pixels[index + 2] = 0;\n   *       // Alpha.\n   *       pixels[index + 3] = 255;\n   *     }\n   *   }\n   *\n   *   // Update the canvas.\n   *   updatePixels();\n   *\n   *   describe('A black dot in the middle of a gray rectangle.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Load the pixels array.\n   *   loadPixels();\n   *\n   *   // Get the pixel density.\n   *   let d = pixelDensity();\n   *\n   *   // Calculate the halfway index in the pixels array.\n   *   let halfImage = 4 * (d * width) * (d * height / 2);\n   *\n   *   // Make the top half of the canvas red.\n   *   for (let i = 0; i < halfImage; i += 4) {\n   *     // Red.\n   *     pixels[i] = 255;\n   *     // Green.\n   *     pixels[i + 1] = 0;\n   *     // Blue.\n   *     pixels[i + 2] = 0;\n   *     // Alpha.\n   *     pixels[i + 3] = 255;\n   *   }\n   *\n   *   // Update the canvas.\n   *   updatePixels();\n   *\n   *   describe('A red rectangle drawn above a gray rectangle.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Color object.\n   *   let pink = color(255, 102, 204);\n   *\n   *   // Load the pixels array.\n   *   loadPixels();\n   *\n   *   // Get the pixel density.\n   *   let d = pixelDensity();\n   *\n   *   // Calculate the halfway index in the pixels array.\n   *   let halfImage = 4 * (d * width) * (d * height / 2);\n   *\n   *   // Make the top half of the canvas red.\n   *   for (let i = 0; i < halfImage; i += 4) {\n   *     pixels[i] = red(pink);\n   *     pixels[i + 1] = green(pink);\n   *     pixels[i + 2] = blue(pink);\n   *     pixels[i + 3] = alpha(pink);\n   *   }\n   *\n   *   // Update the canvas.\n   *   updatePixels();\n   *\n   *   describe('A pink rectangle drawn above a gray rectangle.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * Copies a region of pixels from one image to another.\n   *\n   * The first parameter, `srcImage`, is the\n   * <a href=\"#/p5.Image\">p5.Image</a> object to blend.\n   *\n   * The next four parameters, `sx`, `sy`, `sw`, and `sh` determine the region\n   * to blend from the source image. `(sx, sy)` is the top-left corner of the\n   * region. `sw` and `sh` are the regions width and height.\n   *\n   * The next four parameters, `dx`, `dy`, `dw`, and `dh` determine the region\n   * of the canvas to blend into. `(dx, dy)` is the top-left corner of the\n   * region. `dw` and `dh` are the regions width and height.\n   *\n   * The tenth parameter, `blendMode`, sets the effect used to blend the images'\n   * colors. The options are `BLEND`, `DARKEST`, `LIGHTEST`, `DIFFERENCE`,\n   * `MULTIPLY`, `EXCLUSION`, `SCREEN`, `REPLACE`, `OVERLAY`, `HARD_LIGHT`,\n   * `SOFT_LIGHT`, `DODGE`, `BURN`, `ADD`, or `NORMAL`\n   *\n   * @method blend\n   * @param  {p5.Image} srcImage source image.\n   * @param  {Integer} sx x-coordinate of the source's upper-left corner.\n   * @param  {Integer} sy y-coordinate of the source's upper-left corner.\n   * @param  {Integer} sw source image width.\n   * @param  {Integer} sh source image height.\n   * @param  {Integer} dx x-coordinate of the destination's upper-left corner.\n   * @param  {Integer} dy y-coordinate of the destination's upper-left corner.\n   * @param  {Integer} dw destination image width.\n   * @param  {Integer} dh destination image height.\n   * @param  {(BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL)} blendMode the blend mode. either\n   *     BLEND, DARKEST, LIGHTEST, DIFFERENCE,\n   *     MULTIPLY, EXCLUSION, SCREEN, REPLACE, OVERLAY, HARD_LIGHT,\n   *     SOFT_LIGHT, DODGE, BURN, ADD or NORMAL.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img0;\n   * let img1;\n   *\n   * async function setup() {\n   *   // Load the images.\n   *   img0 = await loadImage('assets/rockies.jpg');\n   *   img1 = await loadImage('assets/bricks_third.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Use the mountains as the background.\n   *   background(img0);\n   *\n   *   // Display the bricks.\n   *   image(img1, 0, 0);\n   *\n   *   // Display the bricks faded into the landscape.\n   *   blend(img1, 0, 0, 33, 100, 67, 0, 33, 100, LIGHTEST);\n   *\n   *   describe('A wall of bricks in front of a mountain landscape. The same wall of bricks appears faded on the right of the image.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img0;\n   * let img1;\n   *\n   * async function setup() {\n   *   // Load the images.\n   *   img0 = await loadImage('assets/rockies.jpg');\n   *   img1 = await loadImage('assets/bricks_third.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Use the mountains as the background.\n   *   background(img0);\n   *\n   *   // Display the bricks.\n   *   image(img1, 0, 0);\n   *\n   *   // Display the bricks partially transparent.\n   *   blend(img1, 0, 0, 33, 100, 67, 0, 33, 100, DARKEST);\n   *\n   *   describe('A wall of bricks in front of a mountain landscape. The same wall of bricks appears transparent on the right of the image.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img0;\n   * let img1;\n   *\n   * async function setup() {\n   *   // Load the images.\n   *   img0 = await loadImage('assets/rockies.jpg');\n   *   img1 = await loadImage('assets/bricks_third.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Use the mountains as the background.\n   *   background(img0);\n   *\n   *   // Display the bricks.\n   *   image(img1, 0, 0);\n   *\n   *   // Display the bricks washed out into the landscape.\n   *   blend(img1, 0, 0, 33, 100, 67, 0, 33, 100, ADD);\n   *\n   *   describe('A wall of bricks in front of a mountain landscape. The same wall of bricks appears washed out on the right of the image.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method blend\n   * @param  {Integer} sx\n   * @param  {Integer} sy\n   * @param  {Integer} sw\n   * @param  {Integer} sh\n   * @param  {Integer} dx\n   * @param  {Integer} dy\n   * @param  {Integer} dw\n   * @param  {Integer} dh\n   * @param  {(BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL)} blendMode\n   */\n  fn.blend = function(...args) {\n    // p5._validateParameters('blend', args);\n    if (this._renderer) {\n      this._renderer.blend(...args);\n    } else {\n      p5.Renderer2D.prototype.blend.apply(this, args);\n    }\n  };\n\n  /**\n   * Copies pixels from a source image to a region of the canvas.\n   *\n   * The first parameter, `srcImage`, is the\n   * <a href=\"#/p5.Image\">p5.Image</a> object to blend. The source image can be\n   * the canvas itself or a\n   * <a href=\"#/p5.Image\">p5.Image</a> object. `copy()` will scale pixels from\n   * the source region if it isn't the same size as the destination region.\n   *\n   * The next four parameters, `sx`, `sy`, `sw`, and `sh` determine the region\n   * to copy from the source image. `(sx, sy)` is the top-left corner of the\n   * region. `sw` and `sh` are the region's width and height.\n   *\n   * The next four parameters, `dx`, `dy`, `dw`, and `dh` determine the region\n   * of the canvas to copy into. `(dx, dy)` is the top-left corner of the\n   * region. `dw` and `dh` are the region's width and height.\n   *\n   * @method copy\n   * @param  {p5.Image|p5.Element} srcImage source image.\n   * @param  {Integer} sx x-coordinate of the source's upper-left corner.\n   * @param  {Integer} sy y-coordinate of the source's upper-left corner.\n   * @param  {Integer} sw source image width.\n   * @param  {Integer} sh source image height.\n   * @param  {Integer} dx x-coordinate of the destination's upper-left corner.\n   * @param  {Integer} dy y-coordinate of the destination's upper-left corner.\n   * @param  {Integer} dw destination image width.\n   * @param  {Integer} dh destination image height.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Use the mountains as the background.\n   *   background(img);\n   *\n   *   // Copy a region of pixels to another spot.\n   *   copy(img, 7, 22, 10, 10, 35, 25, 50, 50);\n   *\n   *   // Outline the copied region.\n   *   stroke(255);\n   *   noFill();\n   *   square(7, 22, 10);\n   *\n   *   describe('An image of a mountain landscape. A square region is outlined in white. A larger square contains a pixelated view of the outlined region.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method copy\n   * @param  {Integer} sx\n   * @param  {Integer} sy\n   * @param  {Integer} sw\n   * @param  {Integer} sh\n   * @param  {Integer} dx\n   * @param  {Integer} dy\n   * @param  {Integer} dw\n   * @param  {Integer} dh\n   */\n  fn.copy = function(...args) {\n    let srcImage, sx, sy, sw, sh, dx, dy, dw, dh;\n    if (args.length === 9) {\n      srcImage = args[0];\n      sx = args[1];\n      sy = args[2];\n      sw = args[3];\n      sh = args[4];\n      dx = args[5];\n      dy = args[6];\n      dw = args[7];\n      dh = args[8];\n    } else if (args.length === 8) {\n      srcImage = this;\n      sx = args[0];\n      sy = args[1];\n      sw = args[2];\n      sh = args[3];\n      dx = args[4];\n      dy = args[5];\n      dw = args[6];\n      dh = args[7];\n    } else {\n      throw new Error('Signature not supported');\n    }\n\n    fn._copyHelper(this, srcImage, sx, sy, sw, sh, dx, dy, dw, dh);\n  };\n\n  fn._copyHelper = (\n    dstImage,\n    srcImage,\n    sx,\n    sy,\n    sw,\n    sh,\n    dx,\n    dy,\n    dw,\n    dh\n  ) => {\n    const s = srcImage.canvas.width / srcImage.width;\n    // adjust coord system for 3D when renderer\n    // ie top-left = -width/2, -height/2\n    let sxMod = 0;\n    let syMod = 0;\n    if (srcImage._renderer && srcImage._renderer.isP3D) {\n      sxMod = srcImage.width / 2;\n      syMod = srcImage.height / 2;\n    }\n    if (dstImage._renderer && dstImage._renderer.isP3D) {\n      dstImage.push();\n      dstImage.resetMatrix();\n      dstImage.noLights();\n      dstImage.blendMode(dstImage.BLEND);\n      dstImage.imageMode(dstImage.CORNER);\n      dstImage._renderer.image(\n        srcImage,\n        sx + sxMod,\n        sy + syMod,\n        sw,\n        sh,\n        dx,\n        dy,\n        dw,\n        dh\n      );\n      dstImage.pop();\n    } else {\n      dstImage.drawingContext.drawImage(\n        srcImage.canvas,\n        s * (sx + sxMod),\n        s * (sy + syMod),\n        s * sw,\n        s * sh,\n        dx,\n        dy,\n        dw,\n        dh\n      );\n    }\n  };\n\n  /**\n   * Applies an image filter to the canvas.\n   *\n   * The preset options are:\n   *\n   * `INVERT`\n   * Inverts the colors in the image. No parameter is used.\n   *\n   * `GRAY`\n   * Converts the image to grayscale. No parameter is used.\n   *\n   * `THRESHOLD`\n   * Converts the image to black and white. Pixels with a grayscale value\n   * above a given threshold are converted to white. The rest are converted to\n   * black. The threshold must be between 0.0 (black) and 1.0 (white). If no\n   * value is specified, 0.5 is used.\n   *\n   * `OPAQUE`\n   * Sets the alpha channel to entirely opaque. No parameter is used.\n   *\n   * `POSTERIZE`\n   * Limits the number of colors in the image. Each color channel is limited to\n   * the number of colors specified. Values between 2 and 255 are valid, but\n   * results are most noticeable with lower values. The default value is 4.\n   *\n   * `BLUR`\n   * Blurs the image. The level of blurring is specified by a blur radius. Larger\n   * values increase the blur. The default value is 4. A gaussian blur is used\n   * in `P2D` mode. A box blur is used in `WEBGL` mode.\n   *\n   * `ERODE`\n   * Reduces the light areas. No parameter is used.\n   *\n   * `DILATE`\n   * Increases the light areas. No parameter is used.\n   *\n   * `filter()` uses WebGL in the background by default because it's faster.\n   * This can be disabled in `P2D` mode by adding a `false` argument, as in\n   * `filter(BLUR, false)`. This may be useful to keep computation off the GPU\n   * or to work around a lack of WebGL support.\n   *\n   * In WebgL mode, `filter()` can also use custom shaders. See\n   * <a href=\"#/p5/createFilterShader\">createFilterShader()</a> for more\n   * information.\n   *\n   *\n   * @method filter\n   * @param  {(THRESHOLD|GRAY|OPAQUE|INVERT|POSTERIZE|BLUR|ERODE|DILATE|BLUR)} filterType  either THRESHOLD, GRAY, OPAQUE, INVERT,\n   *                                POSTERIZE, BLUR, ERODE, DILATE or BLUR.\n   * @param  {Number} [filterParam] parameter unique to each filter.\n   * @param  {Boolean} [useWebGL=true]   flag to control whether to use fast\n   *                                WebGL filters (GPU) or original image\n   *                                filters (CPU); defaults to `true`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Apply the INVERT filter.\n   *   filter(INVERT);\n   *\n   *   describe('A blue brick wall.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Apply the GRAY filter.\n   *   filter(GRAY);\n   *\n   *   describe('A brick wall drawn in grayscale.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Apply the THRESHOLD filter.\n   *   filter(THRESHOLD);\n   *\n   *   describe('A brick wall drawn in black and white.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Apply the OPAQUE filter.\n   *   filter(OPAQUE);\n   *\n   *   describe('A red brick wall.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Apply the POSTERIZE filter.\n   *   filter(POSTERIZE, 3);\n   *\n   *   describe('An image of a red brick wall drawn with limited color palette.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Apply the BLUR filter.\n   *   filter(BLUR, 3);\n   *\n   *   describe('A blurry image of a red brick wall.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Apply the DILATE filter.\n   *   filter(DILATE);\n   *\n   *   describe('A red brick wall with bright lines between each brick.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Apply the ERODE filter.\n   *   filter(ERODE);\n   *\n   *   describe('A red brick wall with faint lines between each brick.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Apply the BLUR filter.\n   *   // Don't use WebGL.\n   *   filter(BLUR, 3, false);\n   *\n   *   describe('A blurry image of a red brick wall.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method getFilterGraphicsLayer\n   * @private\n   * @returns {p5.Graphics}\n   */\n  fn.getFilterGraphicsLayer = function() {\n    return this._renderer.getFilterGraphicsLayer();\n  };\n\n  /**\n   * @method filter\n   * @param  {(THRESHOLD|GRAY|OPAQUE|INVERT|POSTERIZE|BLUR|ERODE|DILATE|BLUR)} filterType\n   * @param  {Number} [filterParam]\n   * @param  {Boolean} [useWebGL=true]\n   */\n  /**\n   * @method filter\n   * @param {p5.Shader}  shaderFilter  shader that's been loaded, with the\n   *                                   frag shader using a `tex0` uniform.\n   */\n  fn.filter = function(...args) {\n    // p5._validateParameters('filter', args);\n\n    let { shader, operation, value, useWebGL } = parseFilterArgs(...args);\n\n    // when passed a shader, use it directly\n    if (this._renderer.isP3D && shader) {\n      this._renderer.filter(shader);\n      return;\n    }\n\n    // when opting out of webgl, use old pixels method\n    if (!useWebGL && !this._renderer.isP3D) {\n      if (this.canvas !== undefined) {\n        Filters.apply(this.canvas, Filters[operation], value);\n      } else {\n        Filters.apply(this.elt, Filters[operation], value);\n      }\n      return;\n    }\n\n    if(!useWebGL && this._renderer.isP3D) {\n      console.warn('filter() with useWebGL=false is not supported in WEBGL');\n    }\n\n    // when this is a webgl renderer, apply constant shader filter\n    if (this._renderer.isP3D) {\n      this._renderer.filter(operation, value);\n    }\n\n    // when this is P2D renderer, create/use hidden webgl renderer\n    else {\n\n      if (shader) {\n        this._renderer.filterRenderer.setOperation(operation, value, shader);\n      } else {\n        this._renderer.filterRenderer.setOperation(operation, value);\n      }\n\n      this._renderer.filterRenderer.applyFilter();\n    }\n  };\n\n  function parseFilterArgs(...args) {\n    // args could be:\n    // - operation, value, [useWebGL]\n    // - operation, [useWebGL]\n    // - shader\n\n    let result = {\n      shader: undefined,\n      operation: undefined,\n      value: undefined,\n      useWebGL: true\n    };\n\n    if (args[0] instanceof p5.Shader) {\n      result.shader = args[0];\n      return result;\n    }\n    else {\n      result.operation = args[0];\n    }\n\n    if (args.length > 1 && typeof args[1] === 'number') {\n      result.value = args[1];\n    }\n\n    if (args[args.length-1] === false) {\n      result.useWebGL = false;\n    }\n    return result;\n  }\n\n  /**\n   * Gets a pixel or a region of pixels from the canvas.\n   *\n   * `get()` is easy to use but it's not as fast as\n   * <a href=\"#/p5/pixels\">pixels</a>. Use <a href=\"#/p5/pixels\">pixels</a>\n   * to read many pixel values.\n   *\n   * The version of `get()` with no parameters returns the entire canvas.\n   *\n   * The version of `get()` with two parameters interprets them as\n   * coordinates. It returns an array with the `[R, G, B, A]` values of the\n   * pixel at the given point.\n   *\n   * The version of `get()` with four parameters interprets them as coordinates\n   * and dimensions. It returns a subsection of the canvas as a\n   * <a href=\"#/p5.Image\">p5.Image</a> object. The first two parameters are the\n   * coordinates for the upper-left corner of the subsection. The last two\n   * parameters are the width and height of the subsection.\n   *\n   * Use <a href=\"#/p5.Image/get\">p5.Image.get()</a> to work directly with\n   * <a href=\"#/p5.Image\">p5.Image</a> objects.\n   *\n   * @method get\n   * @param  {Number}         x x-coordinate of the pixel.\n   * @param  {Number}         y y-coordinate of the pixel.\n   * @param  {Number}         w width of the subsection to be returned.\n   * @param  {Number}         h height of the subsection to be returned.\n   * @return {p5.Image}       subsection as a <a href=\"#/p5.Image\">p5.Image</a> object.\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Get the entire canvas.\n   *   let c = get();\n   *\n   *   // Display half the canvas.\n   *   image(c, 50, 0);\n   *\n   *   describe('Two identical mountain landscapes shown side-by-side.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Get the color of a pixel.\n   *   let c = get(50, 90);\n   *\n   *   // Style the square with the pixel's color.\n   *   fill(c);\n   *   noStroke();\n   *\n   *   // Display the square.\n   *   square(25, 25, 50);\n   *\n   *   describe('A mountain landscape with an olive green square in its center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0);\n   *\n   *   // Get a region of the image.\n   *   let c = get(0, 0, 50, 50);\n   *\n   *   // Display the region.\n   *   image(c, 50, 50);\n   *\n   *   describe('A mountain landscape drawn on top of another mountain landscape.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method get\n   * @return {p5.Image}      whole canvas as a <a href=\"#/p5.Image\">p5.Image</a>.\n   */\n  /**\n   * @method get\n   * @param  {Number}        x\n   * @param  {Number}        y\n   * @return {Number[]}      color of the pixel at (x, y) in array format `[R, G, B, A]`.\n   */\n  fn.get = function(x, y, w, h) {\n    // p5._validateParameters('get', arguments);\n    return this._renderer.get(...arguments);\n  };\n\n  /**\n   * Loads the current value of each pixel on the canvas into the\n   * <a href=\"#/p5/pixels\">pixels</a> array.\n   *\n   * `loadPixels()` must be called before reading from or writing to\n   * <a href=\"#/p5/pixels\">pixels</a>.\n   *\n   * @method loadPixels\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0, 100, 100);\n   *\n   *   // Get the pixel density.\n   *   let d = pixelDensity();\n   *\n   *   // Calculate the halfway index in the pixels array.\n   *   let halfImage = 4 * (d * width) * (d * height / 2);\n   *\n   *   // Load the pixels array.\n   *   loadPixels();\n   *\n   *   // Copy the top half of the canvas to the bottom.\n   *   for (let i = 0; i < halfImage; i += 1) {\n   *     pixels[i + halfImage] = pixels[i];\n   *   }\n   *\n   *   // Update the canvas.\n   *   updatePixels();\n   *\n   *   describe('Two identical images of mountain landscapes, one on top of the other.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.loadPixels = function(...args) {\n    // p5._validateParameters('loadPixels', args);\n    this._renderer.loadPixels();\n  };\n\n  /**\n   * Sets the color of a pixel or draws an image to the canvas.\n   *\n   * `set()` is easy to use but it's not as fast as\n   * <a href=\"#/p5/pixels\">pixels</a>. Use <a href=\"#/p5/pixels\">pixels</a>\n   * to set many pixel values.\n   *\n   * `set()` interprets the first two parameters as x- and y-coordinates. It\n   * interprets the last parameter as a grayscale value, a `[R, G, B, A]` pixel\n   * array, a <a href=\"#/p5.Color\">p5.Color</a> object, or a\n   * <a href=\"#/p5.Image\">p5.Image</a> object. If an image is passed, the first\n   * two parameters set the coordinates for the image's upper-left corner,\n   * regardless of the current <a href=\"#/p5/imageMode\">imageMode()</a>.\n   *\n   * <a href=\"#/p5/updatePixels\">updatePixels()</a> must be called after using\n   * `set()` for changes to appear.\n   *\n   * @method set\n   * @param {Number}              x x-coordinate of the pixel.\n   * @param {Number}              y y-coordinate of the pixel.\n   * @param {Number|Number[]|Object} c grayscale value | pixel array |\n   *                                <a href=\"#/p5.Color\">p5.Color</a> object | <a href=\"#/p5.Image\">p5.Image</a> to copy.\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set four pixels to black.\n   *   set(30, 20, 0);\n   *   set(85, 20, 0);\n   *   set(85, 75, 0);\n   *   set(30, 75, 0);\n   *\n   *   // Update the canvas.\n   *   updatePixels();\n   *\n   *   describe('Four black dots arranged in a square drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object.\n   *   let black = color(0);\n   *\n   *   // Set four pixels to black.\n   *   set(30, 20, black);\n   *   set(85, 20, black);\n   *   set(85, 75, black);\n   *   set(30, 75, black);\n   *\n   *   // Update the canvas.\n   *   updatePixels();\n   *\n   *   describe('Four black dots arranged in a square drawn on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(255);\n   *\n   *   // Draw a horizontal color gradient.\n   *   for (let x = 0; x < 100; x += 1) {\n   *     for (let y = 0; y < 100; y += 1) {\n   *       // Calculate the grayscale value.\n   *       let c = map(x, 0, 100, 0, 255);\n   *\n   *       // Set the pixel using the grayscale value.\n   *       set(x, y, c);\n   *     }\n   *   }\n   *\n   *   // Update the canvas.\n   *   updatePixels();\n   *\n   *   describe('A horiztonal color gradient from black to white.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Use the image to set all pixels.\n   *   set(0, 0, img);\n   *\n   *   // Update the canvas.\n   *   updatePixels();\n   *\n   *   describe('An image of a mountain landscape.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.set = function(x, y, imgOrCol) {\n    this._renderer.set(x, y, imgOrCol);\n  };\n\n  /**\n   * Updates the canvas with the RGBA values in the\n   * <a href=\"#/p5/pixels\">pixels</a> array.\n   *\n   * `updatePixels()` only needs to be called after changing values in the\n   * <a href=\"#/p5/pixels\">pixels</a> array. Such changes can be made directly\n   * after calling <a href=\"#/p5/loadPixels\">loadPixels()</a> or by calling\n   * <a href=\"#/p5/set\">set()</a>.\n   *\n   * @method updatePixels\n   * @param  {Number} [x]    x-coordinate of the upper-left corner of region\n   *                         to update.\n   * @param  {Number} [y]    y-coordinate of the upper-left corner of region\n   *                         to update.\n   * @param  {Number} [w]    width of region to update.\n   * @param  {Number} [h]    height of region to update.\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/rockies.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Display the image.\n   *   image(img, 0, 0, 100, 100);\n   *\n   *   // Get the pixel density.\n   *   let d = pixelDensity();\n   *\n   *   // Calculate the halfway index in the pixels array.\n   *   let halfImage = 4 * (d * width) * (d * height / 2);\n   *\n   *   // Load the pixels array.\n   *   loadPixels();\n   *\n   *   // Copy the top half of the canvas to the bottom.\n   *   for (let i = 0; i < halfImage; i += 1) {\n   *     pixels[i + halfImage] = pixels[i];\n   *   }\n   *\n   *   // Update the canvas.\n   *   updatePixels();\n   *\n   *   describe('Two identical images of mountain landscapes, one on top of the other.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.updatePixels = function(x, y, w, h) {\n    // p5._validateParameters('updatePixels', arguments);\n    // graceful fail - if loadPixels() or set() has not been called, pixel\n    // array will be empty, ignore call to updatePixels()\n    if (this.pixels.length === 0) {\n      return;\n    }\n    this._renderer.updatePixels(x, y, w, h);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  pixels(p5, p5.prototype);\n}\n\nexport { pixels as default };\n","let GLMAT_ARRAY_TYPE = Array;\nlet isMatrixArray = (x) => Array.isArray(x);\nif (typeof Float32Array !== \"undefined\") {\n  GLMAT_ARRAY_TYPE = Float32Array;\n  isMatrixArray = (x) => Array.isArray(x) || x instanceof Float32Array;\n}\nclass MatrixInterface {\n  // Private field to store the matrix\n  #matrix = null;\n  constructor(...args) {\n    if (this.constructor === MatrixInterface) {\n      throw new Error(\"Class is of abstract type and can't be instantiated\");\n    }\n    const methods = [\n      \"add\",\n      \"setElement\",\n      \"reset\",\n      \"set\",\n      \"get\",\n      \"copy\",\n      \"clone\",\n      \"diagonal\",\n      \"row\",\n      \"column\",\n      \"transpose\",\n      \"mult\",\n      \"multiplyVec\",\n      \"invert\",\n      \"createSubMatrix3x3\",\n      \"inverseTranspose4x4\",\n      \"apply\",\n      \"scale\",\n      \"rotate4x4\",\n      \"translate\",\n      \"rotateX\",\n      \"rotateY\",\n      \"rotateZ\",\n      \"perspective\",\n      \"ortho\",\n      \"multiplyVec4\",\n      \"multiplyPoint\",\n      \"multiplyAndNormalizePoint\",\n      \"multiplyDirection\",\n      \"multiplyVec3\",\n    ];\n\n    methods.forEach((method) => {\n      if (this[method] === undefined) {\n        throw new Error(`${method}() method must be implemented`);\n      }\n    });\n  }\n}\n\nexport { GLMAT_ARRAY_TYPE, MatrixInterface, isMatrixArray };\n","import { Vector } from '../p5.Vector.js';\nimport { MatrixInterface } from './MatrixInterface.js';\nimport '../../constants-8IpwyBct.js';\n\n/**\n * @module Math\n */\n\n\nconst isPerfectSquare = (arr) => {\n  const sqDimention = Math.sqrt(Array.from(arr).length);\n  if (sqDimention % 1 !== 0) {\n    throw new Error(\"Array length must be a perfect square.\");\n  }\n  return true;\n};\n\nlet GLMAT_ARRAY_TYPE = Array;\nlet isMatrixArray = (x) => Array.isArray(x);\nif (typeof Float32Array !== \"undefined\") {\n  GLMAT_ARRAY_TYPE = Float32Array;\n  isMatrixArray = (x) => Array.isArray(x) || x instanceof Float32Array;\n}\n\nclass Matrix extends MatrixInterface {\n  matrix;\n  #sqDimention;\n\n  constructor(...args) {\n    super(...args);\n    // This is default behavior when object\n    // instantiated using createMatrix()\n    if (isMatrixArray(args[0]) && isPerfectSquare(args[0])) {\n      const sqDimention = Math.sqrt(Array.from(args[0]).length);\n      this.#sqDimention = sqDimention;\n      this.matrix = GLMAT_ARRAY_TYPE.from(args[0]);\n    } else if (typeof args[0] === \"number\") {\n      this.#sqDimention = Number(args[0]);\n      this.matrix = this.#createIdentityMatrix(args[0]);\n    }\n    return this;\n  }\n\n  /**\n   * Returns the 3x3 matrix if the dimensions are 3x3, otherwise returns `undefined`.\n   *\n   * This method returns the matrix if its dimensions are 3x3.\n   * If the matrix is not 3x3, it returns `undefined`.\n   *\n   * @returns {Array|undefined} The 3x3 matrix or `undefined` if the matrix is not 3x3.\n   */\n  get mat3() {\n    if (this.#sqDimention === 3) {\n      return this.matrix;\n    } else {\n      return undefined;\n    }\n  }\n\n  /**\n   * Returns the 4x4 matrix if the dimensions are 4x4, otherwise returns `undefined`.\n   *\n   * This method returns the matrix if its dimensions are 4x4.\n   * If the matrix is not 4x4, it returns `undefined`.\n   *\n   * @returns {Array|undefined} The 4x4 matrix or `undefined` if the matrix is not 4x4.\n   */\n  get mat4() {\n    if (this.#sqDimention === 4) {\n      return this.matrix;\n    } else {\n      return undefined;\n    }\n  }\n\n  /**\n   * Adds the corresponding elements of the given matrix to this matrix, if the dimentions are the same.\n   *\n   * @param {Matrix} matrix - The matrix to add to this matrix. It must have the same dimensions as this matrix.\n   * @returns {Matrix} The resulting matrix after addition.\n   * @throws {Error} If the matrices do not have the same dimensions.\n   *\n   * @example\n   * const matrix1 = new p5.Matrix([1, 2, 3]);\n   * const matrix2 = new p5.Matrix([4, 5, 6]);\n   * matrix1.add(matrix2); // matrix1 is now [5, 7, 9]\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix1 = new p5.Matrix([1, 2, 3, 4]);\n   *   const matrix2 = new p5.Matrix([5, 6, 7, 8]);\n   *   matrix1.add(matrix2);\n   *   console.log(matrix1.matrix); // Output: [6, 8, 10, 12]\n   * }\n   * </code></div>\n   */\n  add(matrix) {\n    if (this.matrix.length !== matrix.matrix.length) {\n      throw new Error(\"Matrices must be of the same dimension to add.\");\n    }\n    for (let i = 0; i < this.matrix.length; i++) {\n      this.matrix[i] += matrix.matrix[i];\n    }\n    return this;\n  }\n\n  /**\n   * Sets the value of a specific element in the matrix in column-major order.\n   *\n   * A matrix is stored in column-major order, meaning elements are arranged column by column.\n   * This function allows you to update or change the value of a specific element\n   * in the matrix by specifying its index in the column-major order and the new value.\n   *\n   * Parameters:\n   * - `index` (number): The position in the matrix where the value should be set.\n   *   Indices start from 0 and follow column-major order.\n   * - `value` (any): The new value you want to assign to the specified element.\n   *\n   * Example:\n   * If you have the following 3x3 matrix stored in column-major order:\n   * ```\n   * [\n   *   1, 4, 7,  // Column 1\n   *   2, 5, 8,  // Column 2\n   *   3, 6, 9   // Column 3\n   * ]\n   * ```\n   * Calling `setElement(4, 10)` will update the element at index 4\n   * (which corresponds to row 2, column 2 in row-major order) to `10`.\n   * The updated matrix will look like this:\n   * ```\n   * [\n   *   1, 4, 7,\n   *   2, 10, 8,\n   *   3, 6, 9\n   * ]\n   * ```\n   *\n   * This function is useful for modifying specific parts of the matrix without\n   * having to recreate the entire structure.\n   *\n   * @param {Number} index - The position in the matrix where the value should be set.\n   *                         Must be a non-negative integer less than the length of the matrix.\n   * @param {Number} value - The new value to be assigned to the specified position in the matrix.\n   * @returns {Matrix} The current instance of the Matrix, allowing for method chaining.\n   *\n   * @example\n   * // Assuming matrix is an instance of Matrix with initial values [1, 2, 3, 4] matrix.setElement(2, 99);\n   * // Now the matrix values are [1, 2, 99, 4]\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix([1, 2, 3, 4]);\n   *   matrix.setElement(2, 99);\n   *   console.log(matrix.matrix); // Output: [1, 2, 99, 4]\n   * }\n   * </code></div>\n   */\n  setElement(index, value) {\n    if (index >= 0 && index < this.matrix.length) {\n      this.matrix[index] = value;\n    }\n    return this;\n  }\n\n  /**\n   * Resets the current matrix to an identity matrix.\n   *\n   * This method replaces the current matrix with an identity matrix of the same dimensions.\n   * An identity matrix is a square matrix with ones on the main diagonal and zeros elsewhere.\n   * This is useful for resetting transformations or starting fresh with a clean matrix.\n   *\n   * @returns {Matrix} The current instance of the Matrix class, allowing for method chaining.\n   *\n   * @example\n   * // Resetting a 4x4 matrix to an identity matrix\n   * const matrix = new p5.Matrix(4);\n   * matrix.scale(2, 2, 2); // Apply some transformations\n   * console.log(matrix.matrix); // Output: Transformed matrix\n   * matrix.reset(); // Reset to identity matrix\n   * console.log(matrix.matrix); // Output: Identity matrix\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix(4);\n   *   matrix.scale(2, 2, 2); // Apply scaling transformation\n   *   console.log(\"Before reset:\", matrix.matrix);\n   *   matrix.reset(); // Reset to identity matrix\n   *   console.log(\"After reset:\", matrix.matrix);\n   * }\n   * </code></div>\n   */\n  reset() {\n    this.matrix = this.#createIdentityMatrix(this.#sqDimention);\n    return this;\n  }\n\n  /**\n   * Replace the entire contents of a NxN matrix.\n   *\n   * This method allows you to replace the values of the current matrix with\n   * those from another matrix, an array, or individual arguments. The input\n   * can be a `Matrix` instance, an array of numbers, or individual numbers\n   * that match the dimensions of the current matrix. The values are copied\n   * without referencing the source object, ensuring that the original input\n   * remains unchanged.\n   *\n   * If the input dimensions do not match the current matrix, an error will\n   * be thrown to ensure consistency.\n   *\n   * @param {Matrix|Float32Array|Number[]} [inMatrix] - The input matrix, array,\n   * or individual numbers to replace the current matrix values.\n   * @returns {Matrix} The current instance of the Matrix class, allowing for\n   * method chaining.\n   *\n   * @example\n   * // Replacing the contents of a matrix with another matrix\n   * const matrix1 = new p5.Matrix([1, 2, 3, 4]);\n   * const matrix2 = new p5.Matrix([5, 6, 7, 8]);\n   * matrix1.set(matrix2);\n   * console.log(matrix1.matrix); // Output: [5, 6, 7, 8]\n   *\n   * // Replacing the contents of a matrix with an array\n   * const matrix = new p5.Matrix([1, 2, 3, 4]);\n   * matrix.set([9, 10, 11, 12]);\n   * console.log(matrix.matrix); // Output: [9, 10, 11, 12]\n   *\n   * // Replacing the contents of a matrix with individual numbers\n   * const matrix = new p5.Matrix(4); // Creates a 4x4 identity matrix\n   * matrix.set(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16);\n   * console.log(matrix.matrix); // Output: [1, 2, 3, ..., 16]\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix([1, 2, 3, 4]);\n   *   console.log(\"Before set:\", matrix.matrix);\n   *   matrix.set([5, 6, 7, 8]);\n   *   console.log(\"After set:\", matrix.matrix); // Output: [5, 6, 7, 8]\n   * }\n   * </code></div>\n   */\n  set(inMatrix) {\n    let refArray = GLMAT_ARRAY_TYPE.from([...arguments]);\n    if (inMatrix instanceof Matrix) {\n      refArray = GLMAT_ARRAY_TYPE.from(inMatrix.matrix);\n    } else if (isMatrixArray(inMatrix)) {\n      refArray = GLMAT_ARRAY_TYPE.from(inMatrix);\n    }\n    if (refArray.length !== this.matrix.length) {\n      p5._friendlyError(\n        `Expected same dimensions values but received different ${refArray.length}.`,\n        \"p5.Matrix.set\"\n      );\n      return this;\n    }\n    this.matrix = refArray;\n    return this;\n  }\n\n  /**\n   * Gets a copy of the matrix, returns a p5.Matrix object.\n   *\n   * This method creates a new instance of the `Matrix` class and copies the\n   * current matrix values into it. The returned matrix is independent of the\n   * original, meaning changes to the copy will not affect the original matrix.\n   *\n   * This is useful when you need to preserve the current state of a matrix\n   * while performing operations on a duplicate.\n   *\n   * @return {p5.Matrix} A new instance of the `Matrix` class containing the\n   *                     same values as the original matrix.\n   *\n   * @example\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const originalMatrix = new p5.Matrix([1, 2, 3, 4]);\n   *   const copiedMatrix = originalMatrix.get();\n   *   console.log(\"Original Matrix:\", originalMatrix.matrix); // Output: [1, 2, 3, 4]\n   *   console.log(\"Copied Matrix:\", copiedMatrix.matrix); // Output: [1, 2, 3, 4]\n   *\n   *   // Modify the copied matrix\n   *   copiedMatrix.setElement(2, 99);\n   *   console.log(\"Modified Copied Matrix:\", copiedMatrix.matrix); // Output: [1, 2, 99, 4]\n   *   console.log(\"Original Matrix remains unchanged:\", originalMatrix.matrix); // Output: [1, 2, 3, 4]\n   * }\n   * </code></div>\n   */\n  get() {\n    return new Matrix(this.matrix); // TODO: Pass p5\n  }\n\n  /**\n   * Return a copy of this matrix.\n   * If this matrix is 4x4, a 4x4 matrix with exactly the same entries will be\n   * generated. The same is true if this matrix is 3x3 or any NxN matrix.\n   *\n   * This method is useful when you need to preserve the current state of a matrix\n   * while performing operations on a duplicate. The returned matrix is independent\n   * of the original, meaning changes to the copy will not affect the original matrix.\n   *\n   * @return {p5.Matrix}   The result matrix.\n   *\n   * @example\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const originalMatrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   *   const copiedMatrix = originalMatrix.copy();\n   *   console.log(\"Original Matrix:\", originalMatrix.matrix);\n   *   console.log(\"Copied Matrix:\", copiedMatrix.matrix);\n   *\n   *   // Modify the copied matrix\n   *   copiedMatrix.setElement(4, 99);\n   *   console.log(\"Modified Copied Matrix:\", copiedMatrix.matrix);\n   *   console.log(\"Original Matrix remains unchanged:\", originalMatrix.matrix);\n   * }\n   * </code></div>\n   */\n  copy() {\n    return new Matrix(this.matrix);\n  }\n\n  /**\n   * Creates a copy of the current matrix instance.\n   * This method is useful when you need a duplicate of the matrix\n   * without modifying the original one.\n   *\n   * @returns {Matrix} A new matrix instance that is a copy of the current matrix.\n   *\n   * @example\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const originalMatrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   *   const clonedMatrix = originalMatrix.clone();\n   *   console.log(\"Original Matrix:\", originalMatrix.matrix);\n   *   console.log(\"Cloned Matrix:\", clonedMatrix.matrix);\n   *\n   *   // Modify the cloned matrix\n   *   clonedMatrix.setElement(4, 99);\n   *   console.log(\"Modified Cloned Matrix:\", clonedMatrix.matrix);\n   *   console.log(\"Original Matrix remains unchanged:\", originalMatrix.matrix);\n   * }\n   * </code></div>\n   */\n  clone() {\n    return this.copy();\n  }\n\n  /**\n   * Returns the diagonal elements of the matrix in the form of an array.\n   * A NxN matrix will return an array of length N.\n   *\n   * This method extracts the diagonal elements of the matrix, which are the\n   * elements where the row index equals the column index. For example, in a\n   * 3x3 matrix:\n   * ```\n   * [\n   *   1, 2, 3,\n   *   4, 5, 6,\n   *   7, 8, 9\n   * ]\n   * ```\n   * The diagonal elements are [1, 5, 9].\n   *\n   * This is useful for operations that require the main diagonal of a matrix,\n   * such as calculating the trace of a matrix or verifying if a matrix is diagonal.\n   *\n   * @return {Number[]} An array obtained by arranging the diagonal elements\n   *                    of the matrix in ascending order of index.\n   *\n   * @example\n   * // Extracting the diagonal elements of a matrix\n   * const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   * const diagonal = matrix.diagonal(); // [1, 5, 9]\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   *   const diagonal = matrix.diagonal();\n   *   console.log(\"Diagonal elements:\", diagonal); // Output: [1, 5, 9]\n   * }\n   * </code></div>\n   */\n  diagonal() {\n    const diagonal = [];\n    for (let i = 0; i < this.#sqDimention; i++) {\n      diagonal.push(this.matrix[i * (this.#sqDimention + 1)]);\n    }\n    return diagonal;\n  }\n\n  /**\n   * This function is only for 3x3 matrices A function that returns a row vector of a NxN matrix.\n   *\n   * This method extracts a specific row from the matrix and returns it as a `p5.Vector`.\n   * The row is determined by the `columnIndex` parameter, which specifies the column\n   * index of the matrix. This is useful for operations that require working with\n   * individual rows of a matrix, such as row transformations or dot products.\n   *\n   * @param {Number} columnIndex - The index of the column to extract as a row vector.\n   *                               Must be a non-negative integer less than the matrix dimension.\n   * @return {p5.Vector} A `p5.Vector` representing the extracted row of the matrix.\n   *\n   * @example\n   * // Extracting a row vector from a 3x3 matrix\n   * const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   * const rowVector = matrix.row(1); // Returns a vector [2, 5, 8]\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   *   const rowVector = matrix.row(1); // Extract the second row (index 1)\n   *   console.log(\"Row Vector:\", rowVector.toString()); // Output: Row Vector: [2, 5, 8]\n   * }\n   * </code></div>\n   */\n  row(columnIndex) {\n    const columnVector = [];\n    for (let i = 0; i < this.#sqDimention; i++) {\n      columnVector.push(this.matrix[i * this.#sqDimention + columnIndex]);\n    }\n    return new Vector(...columnVector);\n  }\n\n  /**\n   * A function that returns a column vector of a NxN matrix.\n   *\n   * This method extracts a specific column from the matrix and returns it as a `p5.Vector`.\n   * The column is determined by the `rowIndex` parameter, which specifies the row index\n   * of the matrix. This is useful for operations that require working with individual\n   * columns of a matrix, such as column transformations or dot products.\n   *\n   * @param {Number} rowIndex - The index of the row to extract as a column vector.\n   *                             Must be a non-negative integer less than the matrix dimension.\n   * @return {p5.Vector} A `p5.Vector` representing the extracted column of the matrix.\n   *\n   * @example\n   * // Extracting a column vector from a 3x3 matrix\n   * const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   * const columnVector = matrix.column(1); // Returns a vector [4, 5, 6]\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   *   const columnVector = matrix.column(1); // Extract the second column (index 1)\n   *   console.log(\"Column Vector:\", columnVector.toString()); // Output: Column Vector: [4, 5, 6]\n   * }\n   * </code></div>\n   */\n  column(rowIndex) {\n    const rowVector = [];\n    for (let i = 0; i < this.#sqDimention; i++) {\n      rowVector.push(this.matrix[rowIndex * this.#sqDimention + i]);\n    }\n    return new Vector(...rowVector);\n  }\n\n  /**\n   * Transposes the given matrix `a` based on the square dimension of the matrix.\n   *\n   * This method rearranges the elements of the matrix such that the rows become columns\n   * and the columns become rows. It handles matrices of different dimensions (4x4, 3x3, NxN)\n   * by delegating to specific transpose methods for each case.\n   *\n   * If no argument is provided, the method transposes the current matrix instance.\n   * If an argument is provided, it transposes the given matrix `a` and updates the current matrix.\n   *\n   * @param {Array} [a] - The matrix to be transposed. It should be a 2D array where each sub-array represents a row.\n   *                      If omitted, the current matrix instance is transposed.\n   * @returns {Matrix} - The current instance of the Matrix class, allowing for method chaining.\n   *\n   * @example\n   * // Transposing a 3x3 matrix\n   * const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   * matrix.transpose();\n   * console.log(matrix.matrix); // Output: [1, 4, 7, 2, 5, 8, 3, 6, 9]\n   *\n   * // Transposing a 4x4 matrix\n   * const matrix4x4 = new p5.Matrix(4);\n   * matrix4x4.transpose();\n   * console.log(matrix4x4.matrix); // Output: Transposed 4x4 identity matrix\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   *   console.log(\"Before transpose:\", matrix.matrix);\n   *   matrix.transpose();\n   *   console.log(\"After transpose:\", matrix.matrix); // Output: [1, 4, 7, 2, 5, 8, 3, 6, 9]\n   * }\n   * </code></div>\n   */\n  transpose(a) {\n    if (this.#sqDimention === 4) {\n      return this.#transpose4x4(a);\n    } else if (this.#sqDimention === 3) {\n      return this.#transpose3x3(a);\n    } else {\n      return this.#transposeNxN(a);\n    }\n  }\n\n  /**\n   * Multiplies the current matrix with another matrix or matrix-like array.\n   *\n   * This method supports several types of input:\n   * - Another Matrix instance\n   * - A matrix-like array (must be a perfect square, e.g., 4x4 or 3x3)\n   * - Multiple arguments that form a perfect square matrix\n   *\n   * If the input is the same as the current matrix, a copy is made to avoid modifying the original matrix.\n   *\n   * The method determines the appropriate multiplication strategy based on the dimensions of the current matrix\n   * and the input matrix. It supports 3x3, 4x4, and NxN matrices.\n   *\n   * @param {Matrix|Array|...number} multMatrix - The matrix or matrix-like array to multiply with.\n   * @returns {Matrix|undefined} The resulting matrix after multiplication, or undefined if the input is invalid.\n   * @chainable\n   *\n   * @example\n   * // Multiplying two 3x3 matrices\n   * const matrix1 = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   * const matrix2 = new p5.Matrix([9, 8, 7, 6, 5, 4, 3, 2, 1]);\n   * matrix1.mult(matrix2);\n   * console.log(matrix1.matrix); // Output: [30, 24, 18, 84, 69, 54, 138, 114, 90]\n   *\n   * // Multiplying a 4x4 matrix with another 4x4 matrix\n   * const matrix4x4_1 = new p5.Matrix(4); // Identity matrix\n   * const matrix4x4_2 = new p5.Matrix([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 2, 3, 1]);\n   * matrix4x4_1.mult(matrix4x4_2);\n   * console.log(matrix4x4_1.matrix); // Output: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 2, 3, 1]\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix1 = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   *   const matrix2 = new p5.Matrix([9, 8, 7, 6, 5, 4, 3, 2, 1]);\n   *   console.log(\"Before multiplication:\", matrix1.matrix);\n   *   matrix1.mult(matrix2);\n   *   console.log(\"After multiplication:\", matrix1.matrix); // Output: [30, 24, 18, 84, 69, 54, 138, 114, 90]\n   * }\n   * </code></div>\n   */\n  mult(multMatrix) {\n    let _src;\n    if (multMatrix === this || multMatrix === this.matrix) {\n      _src = this.copy().matrix; // only need to allocate in this rare case\n    } else if (multMatrix instanceof Matrix) {\n      _src = multMatrix.matrix;\n    } else if (isMatrixArray(multMatrix) && isPerfectSquare(multMatrix)) {\n      _src = multMatrix;\n    } else if (isPerfectSquare(arguments)) {\n      _src = Array.from(arguments);\n    } else ;\n    if (this.#sqDimention === 4 && _src.length === 16) {\n      return this.#mult4x4(_src);\n    } else if (this.#sqDimention === 3 && _src.length === 9) {\n      return this.#mult3x3(_src);\n    } else {\n      return this.#multNxN(_src);\n    }\n  }\n\n  /**\n   * Takes a vector and returns the vector resulting from multiplying to that vector by this matrix from left. This function is only for 3x3 matrices.\n   *\n   * This method applies the current 3x3 matrix to a given vector, effectively\n   * transforming the vector using the matrix. The resulting vector is returned\n   * as a new vector or stored in the provided target vector.\n   *\n   * @param {p5.Vector} multVector - The vector to which this matrix applies.\n   * @param {p5.Vector} [target] - The vector to receive the result. If not provided,\n   *                               a copy of the input vector will be created and returned.\n   * @return {p5.Vector} - The transformed vector after applying the matrix.\n   *\n   * @example\n   * // Multiplying a 3x3 matrix with a vector\n   * const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   * const vector = new p5.Vector(1, 2, 3);\n   * const result = matrix.multiplyVec(vector);\n   * console.log(result.toString()); // Output: Transformed vector\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   *   const vector = new p5.Vector(1, 2, 3);\n   *   const result = matrix.multiplyVec(vector);\n   *   console.log(\"Original Vector:\", vector.toString()); // Output : Original Vector: [1, 2, 3]\n   *   console.log(\"Transformed Vector:\", result.toString()); // Output : Transformed Vector: [30, 36, 42]\n   * }\n   * </code></div>\n   */\n  multiplyVec(multVector, target) {\n    if (target === undefined) {\n      target = multVector.copy();\n    }\n    for (let i = 0; i < this.#sqDimention; i++) {\n      target.values[i] = this.row(i).dot(multVector);\n    }\n    return target;\n  }\n\n  /**\n   * Inverts a given matrix.\n   *\n   * This method inverts a matrix based on its dimensions. Currently, it supports\n   * 3x3 and 4x4 matrices. If the matrix dimension is greater than 4, an error is thrown.\n   *\n   * For 4x4 matrices, it uses a specialized algorithm to compute the inverse.\n   * For 3x3 matrices, it uses a different algorithm optimized for smaller matrices.\n   *\n   * If the matrix is singular (non-invertible), the method will return `null`.\n   *\n   * @param {Array} a - The matrix to be inverted. It should be a 2D array representing the matrix.\n   * @returns {Array|null} - The inverted matrix, or `null` if the matrix is singular.\n   * @throws {Error} - Throws an error if the matrix dimension is greater than 4.\n   *\n   * @example\n   * // Inverting a 3x3 matrix\n   * const matrix = new p5.Matrix([1, 2, 3, 0, 1, 4, 5, 6, 0]);\n   * const invertedMatrix = matrix.invert();\n   * console.log(invertedMatrix.matrix); // Output: Inverted 3x3 matrix\n   *\n   * // Inverting a 4x4 matrix\n   * const matrix4x4 = new p5.Matrix(4); // Identity matrix\n   * matrix4x4.scale(2, 2, 2);\n   * const invertedMatrix4x4 = matrix4x4.invert();\n   * console.log(invertedMatrix4x4.matrix); // Output: Inverted 4x4 matrix\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix([1, 2, 3, 0, 1, 4, 5, 6, 0]);\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *   const invertedMatrix = matrix.invert();\n   *   if (invertedMatrix) {\n   *     console.log(\"Inverted Matrix:\", invertedMatrix.matrix);\n   *   } else {\n   *     console.log(\"Matrix is singular and cannot be inverted.\");\n   *   }\n   * }\n   * </code></div>\n   */\n  invert(a) {\n    if (this.#sqDimention === 4) {\n      return this.#invert4x4(a);\n    } else if (this.#sqDimention === 3) {\n      return this.#invert3x3(a);\n    } else {\n      throw new Error(\n        \"Invert is not implemented for N>4 at the moment, we are working on it\"\n      );\n    }\n  }\n\n  /**\n   * Creates a 3x3 matrix whose entries are the top left 3x3 part and returns it. This function is only for 4x4 matrices.\n   *\n   * This method extracts the top-left 3x3 portion of a 4x4 matrix and creates a new\n   * 3x3 matrix from it. This is particularly useful in 3D graphics for operations\n   * that require only the rotational or scaling components of a transformation matrix.\n   *\n   * If the current matrix is not 4x4, an error is thrown to ensure the method is used\n   * correctly. The resulting 3x3 matrix is independent of the original matrix, meaning\n   * changes to the new matrix will not affect the original.\n   *\n   * @return {p5.Matrix} A new 3x3 matrix containing the top-left portion of the original 4x4 matrix.\n   * @throws {Error} If the current matrix is not 4x4.\n   *\n   * @example\n   * // Extracting a 3x3 submatrix from a 4x4 matrix\n   * const matrix4x4 = new p5.Matrix(4); // Creates a 4x4 identity matrix\n   * matrix4x4.scale(2, 2, 2); // Apply scaling transformation\n   * const subMatrix3x3 = matrix4x4.createSubMatrix3x3();\n   * console.log(\"Original 4x4 Matrix:\", matrix4x4.matrix);\n   * console.log(\"Extracted 3x3 Submatrix:\", subMatrix3x3.matrix);\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix4x4 = new p5.Matrix(4); // Creates a 4x4 identity matrix\n   *   matrix4x4.scale(2, 2, 2); // Apply scaling transformation\n   *   console.log(\"Original 4x4 Matrix:\", matrix4x4.matrix);\n   *\n   *   const subMatrix3x3 = matrix4x4.createSubMatrix3x3();\n   *   console.log(\"Extracted 3x3 Submatrix:\", subMatrix3x3.matrix);\n   * }\n   * </code></div>\n   */\n  createSubMatrix3x3() {\n    if (this.#sqDimention === 4) {\n      const result = new Matrix(3);\n      result.mat3[0] = this.matrix[0];\n      result.mat3[1] = this.matrix[1];\n      result.mat3[2] = this.matrix[2];\n      result.mat3[3] = this.matrix[4];\n      result.mat3[4] = this.matrix[5];\n      result.mat3[5] = this.matrix[6];\n      result.mat3[6] = this.matrix[8];\n      result.mat3[7] = this.matrix[9];\n      result.mat3[8] = this.matrix[10];\n      return result;\n    } else {\n      throw new Error(\"Matrix dimension must be 4 to create a 3x3 submatrix.\");\n    }\n  }\n\n  /**\n   * Converts a 44 matrix to its 33 inverse transpose transform.\n   * This is commonly used in MVMatrix to NMatrix conversions, particularly\n   * in 3D graphics for transforming normal vectors.\n   *\n   * This method extracts the top-left 33 portion of a 44 matrix, inverts it,\n   * and then transposes the result. If the matrix is singular (non-invertible),\n   * the resulting matrix will be zeroed out.\n   *\n   * @param  {p5.Matrix} mat4 - The 44 matrix to be converted.\n   * @returns {Matrix} The current instance of the Matrix class, allowing for method chaining.\n   * @throws {Error} If the current matrix is not 33.\n   *\n   * @example\n   * // Converting a 44 matrix to its 33 inverse transpose\n   * const mat4 = new p5.Matrix(4); // Create a 44 identity matrix\n   * mat4.scale(2, 2, 2); // Apply scaling transformation\n   * const mat3 = new p5.Matrix(3); // Create a 33 matrix\n   * mat3.inverseTranspose4x4(mat4);\n   * console.log(\"Converted 33 Matrix:\", mat3.matrix);\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const mat4 = new p5.Matrix(4); // Create a 44 identity matrix\n   *   mat4.scale(2, 2, 2); // Apply scaling transformation\n   *   console.log(\"Original 44 Matrix:\", mat4.matrix);\n   *\n   *   const mat3 = new p5.Matrix(3); // Create a 33 matrix\n   *   mat3.inverseTranspose4x4(mat4);\n   *   console.log(\"Converted 33 Matrix:\", mat3.matrix);\n   * }\n   * </code></div>\n   */\n  inverseTranspose4x4({ mat4 }) {\n    if (this.#sqDimention !== 3) {\n      throw new Error(\"This function only works with 33 matrices.\");\n    } else {\n      // Convert mat4 -> mat3 by extracting the top-left 33 portion\n      this.matrix[0] = mat4[0];\n      this.matrix[1] = mat4[1];\n      this.matrix[2] = mat4[2];\n      this.matrix[3] = mat4[4];\n      this.matrix[4] = mat4[5];\n      this.matrix[5] = mat4[6];\n      this.matrix[6] = mat4[8];\n      this.matrix[7] = mat4[9];\n      this.matrix[8] = mat4[10];\n    }\n\n    const inverse = this.invert();\n    // Check if inversion succeeded\n    if (inverse) {\n      inverse.transpose(this.matrix);\n    } else {\n      // In case of singularity, zero out the matrix\n      for (let i = 0; i < 9; i++) {\n        this.matrix[i] = 0;\n      }\n    }\n    return this;\n  }\n\n  /**\n   * Applies a transformation matrix to the current matrix.\n   *\n   * This method multiplies the current matrix by another matrix, which can be provided\n   * in several forms: another Matrix instance, an array representing a matrix, or as\n   * individual arguments representing the elements of a 4x4 matrix.\n   *\n   * This operation is useful for combining transformations such as translation, rotation,\n   * scaling, and perspective projection into a single matrix. By applying a transformation\n   * matrix, you can modify the current matrix to represent a new transformation.\n   *\n   * @param {Matrix|Array|number} multMatrix - The matrix to multiply with. This can be:\n   *   - An instance of the Matrix class.\n   *   - An array of 16 numbers representing a 4x4 matrix.\n   *   - 16 individual numbers representing the elements of a 4x4 matrix.\n   * @returns {Matrix} The current matrix after applying the transformation.\n   *\n   * @example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   * // Assuming `matrix` is an instance of Matrix\n   * const anotherMatrix = new p5.Matrix(4);\n   * const anotherMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n   * matrix.apply(anotherMatrix);\n   *\n   * // Applying a transformation using an array\n   * const matrixArray = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n   * matrix.apply(matrixArray);\n   *\n   * // Applying a transformation using individual arguments\n   * matrix.apply(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);\n   *\n   *\n   *   // Create a 4x4 identity matrix\n   *   const matrix = new p5.Matrix(4);\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *\n   *   // Create a scaling transformation matrix\n   *   const scalingMatrix = new p5.Matrix([2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 1]);\n   *\n   *   // Apply the scaling transformation\n   *   matrix.apply(scalingMatrix);\n   *   console.log(\"After Scaling Transformation:\", matrix.matrix);\n   *\n   *   // Apply a translation transformation using an array\n   *   const translationMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 5, 5, 5, 1];\n   *   matrix.apply(translationMatrix);\n   *   console.log(\"After Translation Transformation:\", matrix.matrix);\n   * }\n   * </code></div>\n   */\n  apply(multMatrix) {\n    let _src;\n\n    if (multMatrix === this || multMatrix === this.matrix) {\n      _src = this.copy().matrix; // only need to allocate in this rare case\n    } else if (multMatrix instanceof Matrix) {\n      _src = multMatrix.matrix;\n    } else if (isMatrixArray(multMatrix)) {\n      _src = multMatrix;\n    } else if (arguments.length === 16) {\n      _src = arguments;\n    } else {\n      return; // nothing to do.\n    }\n\n    const mat4 = this.matrix;\n\n    // each row is used for the multiplier\n    const m0 = mat4[0];\n    const m4 = mat4[4];\n    const m8 = mat4[8];\n    const m12 = mat4[12];\n    mat4[0] = _src[0] * m0 + _src[1] * m4 + _src[2] * m8 + _src[3] * m12;\n    mat4[4] = _src[4] * m0 + _src[5] * m4 + _src[6] * m8 + _src[7] * m12;\n    mat4[8] = _src[8] * m0 + _src[9] * m4 + _src[10] * m8 + _src[11] * m12;\n    mat4[12] = _src[12] * m0 + _src[13] * m4 + _src[14] * m8 + _src[15] * m12;\n\n    const m1 = mat4[1];\n    const m5 = mat4[5];\n    const m9 = mat4[9];\n    const m13 = mat4[13];\n    mat4[1] = _src[0] * m1 + _src[1] * m5 + _src[2] * m9 + _src[3] * m13;\n    mat4[5] = _src[4] * m1 + _src[5] * m5 + _src[6] * m9 + _src[7] * m13;\n    mat4[9] = _src[8] * m1 + _src[9] * m5 + _src[10] * m9 + _src[11] * m13;\n    mat4[13] = _src[12] * m1 + _src[13] * m5 + _src[14] * m9 + _src[15] * m13;\n\n    const m2 = mat4[2];\n    const m6 = mat4[6];\n    const m10 = mat4[10];\n    const m14 = mat4[14];\n    mat4[2] = _src[0] * m2 + _src[1] * m6 + _src[2] * m10 + _src[3] * m14;\n    mat4[6] = _src[4] * m2 + _src[5] * m6 + _src[6] * m10 + _src[7] * m14;\n    mat4[10] = _src[8] * m2 + _src[9] * m6 + _src[10] * m10 + _src[11] * m14;\n    mat4[14] = _src[12] * m2 + _src[13] * m6 + _src[14] * m10 + _src[15] * m14;\n\n    const m3 = mat4[3];\n    const m7 = mat4[7];\n    const m11 = mat4[11];\n    const m15 = mat4[15];\n    mat4[3] = _src[0] * m3 + _src[1] * m7 + _src[2] * m11 + _src[3] * m15;\n    mat4[7] = _src[4] * m3 + _src[5] * m7 + _src[6] * m11 + _src[7] * m15;\n    mat4[11] = _src[8] * m3 + _src[9] * m7 + _src[10] * m11 + _src[11] * m15;\n    mat4[15] = _src[12] * m3 + _src[13] * m7 + _src[14] * m11 + _src[15] * m15;\n\n    return this;\n  }\n\n  /**\n   * Scales a p5.Matrix by scalars or a vector.\n   *\n   * This method applies a scaling transformation to the current matrix.\n   * Scaling is a transformation that enlarges or shrinks objects by a scale factor\n   * along the x, y, and z axes. The scale factors can be provided as individual\n   * numbers, an array, or a `p5.Vector`.\n   *\n   * If a `p5.Vector` or an array is provided, the x, y, and z components are extracted\n   * from it. If the z component is not provided, it defaults to 1 (no scaling along the z-axis).\n   *\n   * @param {p5.Vector|Float32Array|Number[]} s - The vector or scalars to scale by.\n   *                                              Can be a `p5.Vector`, an array, or individual numbers.\n   * @returns {Matrix} The current instance of the Matrix class, allowing for method chaining.\n   *\n   * @example\n   * // Scaling a matrix by individual scalars\n   * const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   * matrix.scale(2, 3, 4); // Scale by 2 along x, 3 along y, and 4 along z\n   * console.log(matrix.matrix);\n   *\n   * // Scaling a matrix by a p5.Vector\n   * const scaleVector = new p5.Vector(2, 3, 4);\n   * matrix.scale(scaleVector);\n   * console.log(matrix.matrix);\n   *\n   * // Scaling a matrix by an array\n   * const scaleArray = [2, 3, 4];\n   * matrix.scale(scaleArray);\n   * console.log(matrix.matrix);\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *\n   *   // Scale the matrix by individual scalars\n   *   matrix.scale(2, 3, 4);\n   *   console.log(\"Scaled Matrix (2, 3, 4):\", matrix.matrix);\n   *\n   *   // Scale the matrix by a p5.Vector\n   *   const scaleVector = new p5.Vector(1.5, 2.5, 3.5);\n   *   matrix.scale(scaleVector);\n   *   console.log(\"Scaled Matrix (Vector):\", matrix.matrix);\n   *\n   *   // Scale the matrix by an array\n   *   const scaleArray = [0.5, 0.5, 0.5];\n   *   matrix.scale(scaleArray);\n   *   console.log(\"Scaled Matrix (Array):\", matrix.matrix);\n   * }\n   * </code></div>\n   */\n  scale(x, y, z) {\n    if (x instanceof Vector) {\n      // x is a vector, extract the components from it.\n      y = x.y;\n      z = x.z;\n      x = x.x; // must be last\n    } else if (x instanceof Array) {\n      // x is an array, extract the components from it.\n      y = x[1];\n      z = x[2];\n      x = x[0]; // must be last\n    }\n\n    this.matrix[0] *= x;\n    this.matrix[1] *= x;\n    this.matrix[2] *= x;\n    this.matrix[3] *= x;\n    this.matrix[4] *= y;\n    this.matrix[5] *= y;\n    this.matrix[6] *= y;\n    this.matrix[7] *= y;\n    this.matrix[8] *= z;\n    this.matrix[9] *= z;\n    this.matrix[10] *= z;\n    this.matrix[11] *= z;\n\n    return this;\n  }\n\n  /**\n   * Rotate the Matrix around a specified axis by a given angle.\n   *\n   * This method applies a rotation transformation to the matrix, modifying its orientation\n   * in 3D space. The rotation is performed around the provided axis, which can be defined\n   * as a `p5.Vector` or an array of numbers representing the x, y, and z components of the axis.\n   * Rotate our Matrix around an axis by the given angle.\n   * @param  {Number} a The angle of rotation in radians.\n   *                    Angles in radians are a measure of rotation, where 2 radians\n   *                    represent a full circle (360 degrees). For example:\n   *                    - /2 radians = 90 degrees (quarter turn)\n   *                    -  radians = 180 degrees (half turn)\n   *                    - 2 radians = 360 degrees (full turn)\n   *                    Use `Math.PI` for  or `p5`'s `PI` constant if using p5.js.\n   * @param  {p5.Vector|Number[]} axis The axis or axes to rotate around.\n   *                                   This defines the direction of the rotation.\n   *                                   - If using a `p5.Vector`, it should represent\n   *                                     the x, y, and z components of the axis.\n   *                                   - If using an array, it should be in the form\n   *                                     [x, y, z], where x, y, and z are numbers.\n   *                                   For example:\n   *                                   - [1, 0, 0] rotates around the x-axis.\n   *                                   - [0, 1, 0] rotates around the y-axis.\n   *                                   - [0, 0, 1] rotates around the z-axis.   *\n   * @chainable\n   * inspired by Toji's gl-matrix lib, mat4 rotation\n   *\n   * @example\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *   const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   *   console.log(\"Original Matrix:\", matrix.matrix.slice().toString()); // [1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]\n   *\n   *   // Translate the matrix by a 3D vector\n   *   matrix.rotate4x4(Math.PI, [1,0,0]);\n   *   console.log(\"After rotation of PI degrees on vector [1,0,0]:\", matrix.matrix.slice().toString()); // [1,0,0,0,0,-1,1.2246468525851679e-16,0,0,-1.2246468525851679e-16,-1,0,0,0,0,1]\n   * }\n   * </code></div>\n   */\n  rotate4x4(a, x, y, z) {\n    if (x instanceof Vector) {\n      // x is a vector, extract the components from it.\n      y = x.y;\n      z = x.z;\n      x = x.x; //must be last\n    } else if (x instanceof Array) {\n      // x is an array, extract the components from it.\n      y = x[1];\n      z = x[2];\n      x = x[0]; //must be last\n    }\n\n    const len = Math.sqrt(x * x + y * y + z * z);\n    x *= 1 / len;\n    y *= 1 / len;\n    z *= 1 / len;\n\n    const a00 = this.matrix[0];\n    const a01 = this.matrix[1];\n    const a02 = this.matrix[2];\n    const a03 = this.matrix[3];\n    const a10 = this.matrix[4];\n    const a11 = this.matrix[5];\n    const a12 = this.matrix[6];\n    const a13 = this.matrix[7];\n    const a20 = this.matrix[8];\n    const a21 = this.matrix[9];\n    const a22 = this.matrix[10];\n    const a23 = this.matrix[11];\n\n    //sin,cos, and tan of respective angle\n    const sA = Math.sin(a);\n    const cA = Math.cos(a);\n    const tA = 1 - cA;\n    // Construct the elements of the rotation matrix\n    const b00 = x * x * tA + cA;\n    const b01 = y * x * tA + z * sA;\n    const b02 = z * x * tA - y * sA;\n    const b10 = x * y * tA - z * sA;\n    const b11 = y * y * tA + cA;\n    const b12 = z * y * tA + x * sA;\n    const b20 = x * z * tA + y * sA;\n    const b21 = y * z * tA - x * sA;\n    const b22 = z * z * tA + cA;\n\n    // rotation-specific matrix multiplication\n    this.matrix[0] = a00 * b00 + a10 * b01 + a20 * b02;\n    this.matrix[1] = a01 * b00 + a11 * b01 + a21 * b02;\n    this.matrix[2] = a02 * b00 + a12 * b01 + a22 * b02;\n    this.matrix[3] = a03 * b00 + a13 * b01 + a23 * b02;\n    this.matrix[4] = a00 * b10 + a10 * b11 + a20 * b12;\n    this.matrix[5] = a01 * b10 + a11 * b11 + a21 * b12;\n    this.matrix[6] = a02 * b10 + a12 * b11 + a22 * b12;\n    this.matrix[7] = a03 * b10 + a13 * b11 + a23 * b12;\n    this.matrix[8] = a00 * b20 + a10 * b21 + a20 * b22;\n    this.matrix[9] = a01 * b20 + a11 * b21 + a21 * b22;\n    this.matrix[10] = a02 * b20 + a12 * b21 + a22 * b22;\n    this.matrix[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n    return this;\n  }\n\n  /**\n   * Translates the current matrix by a given vector.\n   *\n   * This method applies a translation transformation to the current matrix.\n   * Translation moves the matrix by a specified amount along the x, y, and z axes.\n   * The input vector can be a 2D or 3D vector. If the z-component is not provided,\n   * it defaults to 0, meaning no translation along the z-axis.\n   *\n   * @param {Number[]} v - A vector representing the translation. It should be an array\n   *                       with two or three elements: [x, y, z]. The z-component is optional.\n   * @returns {Matrix} The current instance of the Matrix class, allowing for method chaining.\n   *\n   * @example\n   * // Translating a matrix by a 3D vector\n   * const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   * matrix.translate([10, 20, 30]); // Translate by 10 units along x, 20 along y, and 30 along z\n   * console.log(matrix.matrix);\n   *\n   * // Translating a matrix by a 2D vector\n   * matrix.translate([5, 15]); // Translate by 5 units along x and 15 along y\n   * console.log(matrix.matrix);\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *   const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   *   console.log(\"Original Matrix:\", matrix.matrix.slice().toString()); // [1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]\n   *\n   *   // Translate the matrix by a 3D vector\n   *   matrix.translate([10, 20, 30]);\n   *   console.log(\"After 3D Translation (10, 20, 30):\", matrix.matrix.slice().toString()); // [1,0,0,0,0,1,0,0,0,0,1,0,10,20,30,1]\n   *\n   *   // Translate the matrix by a 2D vector\n   *   matrix.translate([5, 15]);\n   *   console.log(\"After 2D Translation (5, 15):\", matrix.matrix.slice().toString()); // [1,0,0,0,0,1,0,0,0,0,1,0,15,35,30,1]\n   * }\n   * </code></div>\n   */\n  translate(v) {\n    const x = v[0],\n      y = v[1],\n      z = v[2] || 0;\n    this.matrix[12] +=\n      this.matrix[0] * x + this.matrix[4] * y + this.matrix[8] * z;\n    this.matrix[13] +=\n      this.matrix[1] * x + this.matrix[5] * y + this.matrix[9] * z;\n    this.matrix[14] +=\n      this.matrix[2] * x + this.matrix[6] * y + this.matrix[10] * z;\n    this.matrix[15] +=\n      this.matrix[3] * x + this.matrix[7] * y + this.matrix[11] * z;\n    return this;\n  }\n\n  /**\n   * Rotates the matrix around the X-axis by a given angle.\n   *\n   * This method modifies the current matrix to apply a rotation transformation\n   * around the X-axis. The rotation angle is specified in radians.\n   *\n   * Rotating around the X-axis means that the Y and Z coordinates of the matrix\n   * are transformed while the X coordinates remain unchanged. This is commonly\n   * used in 3D graphics to create animations or transformations along the X-axis.\n   *\n   * @param {Number} a - The angle in radians to rotate the matrix by.\n   *\n   * @example\n   * // Rotating a matrix around the X-axis\n   * const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   * matrix.rotateX(Math.PI / 4); // Rotate 45 degrees around the X-axis\n   * console.log(matrix.matrix);\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *\n   *   // Rotate the matrix 45 degrees (PI/4 radians) around the X-axis\n   *   matrix.rotateX(Math.PI / 4);\n   *   console.log(\"After Rotation (X-axis, 45 degrees):\", matrix.matrix);\n   * }\n   * </code></div>\n   */\n  rotateX(a) {\n    this.rotate4x4(a, 1, 0, 0);\n  }\n\n  /**\n   * Rotates the matrix around the Y-axis by a given angle.\n   *\n   * This method modifies the current matrix to apply a rotation transformation\n   * around the Y-axis. The rotation is performed in 3D space, and the angle\n   * is specified in radians. Rotating around the Y-axis means that the X and Z\n   * coordinates of the matrix are transformed while the Y coordinates remain\n   * unchanged. This is commonly used in 3D graphics to create animations or\n   * transformations along the Y-axis.\n   *\n   * @param {Number} a - The angle in radians to rotate the matrix by. Positive\n   * values rotate the matrix counterclockwise, and negative values rotate it\n   * clockwise.\n   *\n   * @example\n   * // Rotating a matrix around the Y-axis\n   * const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   * matrix.rotateY(Math.PI / 4); // Rotate 45 degrees around the Y-axis\n   * console.log(matrix.matrix);\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *\n   *   // Rotate the matrix 45 degrees (PI/4 radians) around the Y-axis\n   *   matrix.rotateY(Math.PI / 4);\n   *   console.log(\"After Rotation (Y-axis, 45 degrees):\", matrix.matrix);\n   * }\n   * </code></div>\n   */\n  rotateY(a) {\n    this.rotate4x4(a, 0, 1, 0);\n  }\n\n  /**\n   * Rotates the matrix around the Z-axis by a given angle.\n   *\n   * This method modifies the current matrix to apply a rotation transformation\n   * around the Z-axis. The rotation is performed in a 4x4 matrix context, which\n   * is commonly used in 3D graphics to handle transformations. Rotating around\n   * the Z-axis means that the X and Y coordinates of the matrix are transformed\n   * while the Z coordinates remain unchanged.\n   *\n   * @param {Number} a - The angle in radians to rotate the matrix by. Positive\n   * values rotate the matrix counterclockwise, and negative values rotate it\n   * clockwise.\n   *\n   * @returns {Matrix} The current instance of the Matrix class, allowing for\n   * method chaining.\n   *\n   * @example\n   * // Rotating a matrix around the Z-axis\n   * const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   * matrix.rotateZ(Math.PI / 4); // Rotate 45 degrees around the Z-axis\n   * console.log(matrix.matrix);\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *\n   *   // Rotate the matrix 45 degrees (PI/4 radians) around the Z-axis\n   *   matrix.rotateZ(Math.PI / 4);\n   *   console.log(\"After Rotation (Z-axis, 45 degrees):\", matrix.matrix);\n   * }\n   * </code></div>\n   */\n  rotateZ(a) {\n    this.rotate4x4(a, 0, 0, 1);\n  }\n\n  /**\n   * Sets the perspective projection matrix.\n   *\n   * This method modifies the current matrix to represent a perspective projection.\n   * Perspective projection is commonly used in 3D graphics to simulate the effect\n   * of objects appearing smaller as they move further away from the camera.\n   *\n   * The perspective matrix is defined by the field of view (fovy), aspect ratio,\n   * and the near and far clipping planes. The near and far clipping planes define\n   * the range of depth that will be rendered, with anything outside this range\n   * being clipped.\n   *\n   * @param {Number} fovy - The field of view in the y direction, in radians.\n   * @param {Number} aspect - The aspect ratio of the viewport (width / height).\n   * @param {Number} near - The distance to the near clipping plane. Must be greater than 0.\n   * @param {Number} far - The distance to the far clipping plane. Must be greater than the near value.\n   * @returns {Matrix} The current instance of the Matrix class, allowing for method chaining.\n   *\n   * @example\n   * // Setting a perspective projection matrix\n   * const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   * matrix.perspective(Math.PI / 4, 1.5, 0.1, 100); // Set perspective projection\n   * console.log(matrix.matrix);\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *\n   *   // Set a perspective projection with a 45-degree field of view,\n   *   // an aspect ratio of 1.5, and near/far clipping planes at 0.1 and 100.\n   *   matrix.perspective(Math.PI / 4, 1.5, 0.1, 100);\n   *   console.log(\"Perspective Matrix:\", matrix.matrix);\n   * }\n   * </code></div>\n   */\n  perspective(fovy, aspect, near, far) {\n    const f = 1.0 / Math.tan(fovy / 2),\n      nf = 1 / (near - far);\n\n    this.matrix[0] = f / aspect;\n    this.matrix[1] = 0;\n    this.matrix[2] = 0;\n    this.matrix[3] = 0;\n    this.matrix[4] = 0;\n    this.matrix[5] = f;\n    this.matrix[6] = 0;\n    this.matrix[7] = 0;\n    this.matrix[8] = 0;\n    this.matrix[9] = 0;\n    this.matrix[10] = (far + near) * nf;\n    this.matrix[11] = -1;\n    this.matrix[12] = 0;\n    this.matrix[13] = 0;\n    this.matrix[14] = 2 * far * near * nf;\n    this.matrix[15] = 0;\n\n    return this;\n  }\n\n  /**\n   * Sets this matrix to an orthographic projection matrix.\n   *\n   * An orthographic projection matrix is used to create a 2D rendering\n   * of a 3D scene by projecting points onto a plane without perspective\n   * distortion. This method modifies the current matrix to represent\n   * the orthographic projection defined by the given parameters.\n   *\n   * @param {number} left - The coordinate for the left vertical clipping plane.\n   * @param {number} right - The coordinate for the right vertical clipping plane.\n   * @param {number} bottom - The coordinate for the bottom horizontal clipping plane.\n   * @param {number} top - The coordinate for the top horizontal clipping plane.\n   * @param {number} near - The distance to the near depth clipping plane. Must be positive.\n   * @param {number} far - The distance to the far depth clipping plane. Must be positive.\n   * @chainable\n   * @returns {Matrix} The current matrix instance, updated with the orthographic projection.\n   *\n   * @example\n   * <div class=\"norender\"><code>\n   * // Example using p5.js to demonstrate orthographic projection\n   * function setup() {\n   *  let orthoMatrix = new p5.Matrix(4);\n   *  console.log(orthoMatrix.matrix.toString()) // Output: 1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1\n   *  orthoMatrix.ortho(-200, 200, -200, 200, 0.1, 1000);\n   *  console.log(orthoMatrix.matrix.toString()) // Output: [24 0.004999999888241291,0,0,0,0,0.004999999888241291,0,0,0,0,-0.0020002000965178013,0,0,0,-1.0002000331878662,1]\n   *  applyMatrix(\n   *     orthoMatrix.mat4[0], orthoMatrix.mat4[1], orthoMatrix.mat4[2], orthoMatrix.mat4[3],\n   *     orthoMatrix.mat4[4], orthoMatrix.mat4[5], orthoMatrix.mat4[6], orthoMatrix.mat4[7],\n   *     orthoMatrix.mat4[8], orthoMatrix.mat4[9], orthoMatrix.mat4[10], orthoMatrix.mat4[11],\n   *     orthoMatrix.mat4[12], orthoMatrix.mat4[13], orthoMatrix.mat4[14], orthoMatrix.mat4[15]\n   *  );\n   *  console.log(orthoMatrix.matrix.toString()) // Output: [31 0.004999999888241291,0,0,0,0,0.004999999888241291,0,0,0,0,-0.0020002000965178013,0,0,0,-1.0002000331878662,1]\n   *   }\n   * </code></div>\n   *\n   */\n  ortho(left, right, bottom, top, near, far) {\n    const lr = 1 / (left - right),\n      bt = 1 / (bottom - top),\n      nf = 1 / (near - far);\n    this.matrix[0] = -2 * lr;\n    this.matrix[1] = 0;\n    this.matrix[2] = 0;\n    this.matrix[3] = 0;\n    this.matrix[4] = 0;\n    this.matrix[5] = -2 * bt;\n    this.matrix[6] = 0;\n    this.matrix[7] = 0;\n    this.matrix[8] = 0;\n    this.matrix[9] = 0;\n    this.matrix[10] = 2 * nf;\n    this.matrix[11] = 0;\n    this.matrix[12] = (left + right) * lr;\n    this.matrix[13] = (top + bottom) * bt;\n    this.matrix[14] = (far + near) * nf;\n    this.matrix[15] = 1;\n\n    return this;\n  }\n\n  /**\n   * Applies a matrix to a vector with x, y, z, w components and returns the result as an array.\n   *\n   * This method multiplies the current matrix by a 4D vector (x, y, z, w) and computes the resulting vector.\n   * It is commonly used in 3D graphics for transformations such as translation, rotation, scaling, and perspective projection.\n   *\n   * The resulting vector is returned as an array of four numbers, representing the transformed x, y, z, and w components.\n   *\n   * @param {Number} x - The x component of the vector.\n   * @param {Number} y - The y component of the vector.\n   * @param {Number} z - The z component of the vector.\n   * @param {Number} w - The w component of the vector.\n   * @returns {Number[]} An array containing the transformed [x, y, z, w] components.\n   *\n   * @example\n   * // Applying a matrix to a 4D vector\n   * const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   * const result = matrix.multiplyVec4(1, 2, 3, 1); // Transform the vector [1, 2, 3, 1]\n   * console.log(result); // Output: [1, 2, 3, 1] (unchanged for identity matrix)\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *\n   *   // Apply the matrix to a 4D vector\n   *   const result = matrix.multiplyVec4(1, 2, 3, 1);\n   *   console.log(\"Transformed Vector:\", result); // Output: [1, 2, 3, 1]\n   *\n   *   // Modify the matrix (e.g., apply a translation)\n   *   matrix.translate([5, 5, 5]);\n   *   console.log(\"Modified Matrix:\", matrix.matrix);\n   *\n   *   // Apply the modified matrix to the same vector\n   *   const transformedResult = matrix.multiplyVec4(1, 2, 3, 1);\n   *   console.log(\"Transformed Vector after Translation:\", transformedResult); // Output: [6, 7, 8, 1]\n   * }\n   * </code></div>\n   */\n  multiplyVec4(x, y, z, w) {\n    const result = new Array(4);\n    const m = this.matrix;\n\n    result[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n    result[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n    result[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n    result[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n\n    return result;\n  }\n\n  /**\n   * Applies a matrix to a vector. The fourth component is set to 1.\n   * Returns a vector consisting of the first\n   * through third components of the result.\n   *\n   * This method multiplies the current matrix by a 4D vector (x, y, z, 1),\n   * effectively transforming the vector using the matrix. The resulting\n   * vector is returned as a new `p5.Vector` instance.\n   *\n   * This is useful for applying transformations such as translation,\n   * rotation, scaling, or perspective projection to a point in 3D space.\n   *\n   * @param {p5.Vector} vector - The input vector to transform. It should\n   *                              have x, y, and z components.\n   * @return {p5.Vector} A new `p5.Vector` instance representing the transformed point.\n   *\n   * @example\n   * // Applying a matrix to a 3D point\n   * const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   * const point = new p5.Vector(1, 2, 3); // Define a 3D point\n   * const transformedPoint = matrix.multiplyPoint(point);\n   * console.log(transformedPoint.toString()); // Output: [1, 2, 3] (unchanged for identity matrix)\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *\n   *   // Define a 3D point\n   *   const point = new p5.Vector(1, 2, 3);\n   *   console.log(\"Original Point:\", point.toString());\n   *\n   *   // Apply the matrix to the point\n   *   const transformedPoint = matrix.multiplyPoint(point);\n   *   console.log(\"Transformed Point:\", transformedPoint.toString());\n   *\n   *   // Modify the matrix (e.g., apply a translation)\n   *   matrix.translate([5, 5, 5]);\n   *   console.log(\"Modified Matrix:\", matrix.matrix);\n   *\n   *   // Apply the modified matrix to the same point\n   *   const translatedPoint = matrix.multiplyPoint(point);\n   *   console.log(\"Translated Point:\", translatedPoint.toString()); // Output: [6, 7, 8]\n   * }\n   * </code></div>\n   */\n  multiplyPoint({ x, y, z }) {\n    const array = this.multiplyVec4(x, y, z, 1);\n    return new Vector(array[0], array[1], array[2]);\n  }\n\n  /**\n   * Applies a matrix to a vector.\n   * The fourth component is set to 1.\n   * Returns the result of dividing the 1st to 3rd components\n   * of the result by the 4th component as a vector.\n   *\n   * This method multiplies the current matrix by a 4D vector (x, y, z, 1),\n   * effectively transforming the vector using the matrix. The resulting\n   * vector is normalized by dividing its x, y, and z components by the w component.\n   * This is useful for applying transformations such as perspective projection\n   * to a point in 3D space.\n   *\n   * @param {p5.Vector} vector - The input vector to transform. It should\n   *                              have x, y, and z components.\n   * @return {p5.Vector} A new `p5.Vector` instance representing the transformed and normalized point.\n   *\n   * @example\n   * // Applying a matrix to a 3D point and normalizing it\n   * const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   * const point = new p5.Vector(1, 2, 3); // Define a 3D point\n   * const transformedPoint = matrix.multiplyAndNormalizePoint(point);\n   * console.log(transformedPoint.toString()); // Output: [1, 2, 3] (unchanged for identity matrix)\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *\n   *   // Define a 3D point\n   *   const point = new p5.Vector(1, 2, 3);\n   *   console.log(\"Original Point:\", point.toString());\n   *\n   *   // Apply the matrix to the point and normalize it\n   *   const transformedPoint = matrix.multiplyAndNormalizePoint(point);\n   *   console.log(\"Transformed and Normalized Point:\", transformedPoint.toString());\n   *\n   *   // Modify the matrix (e.g., apply a perspective transformation)\n   *   matrix.perspective(Math.PI / 4, 1.5, 0.1, 100);\n   *   console.log(\"Modified Matrix (Perspective):\", matrix.matrix);\n   *\n   *   // Apply the modified matrix to the same point\n   *   const perspectivePoint = matrix.multiplyAndNormalizePoint(point);\n   *   console.log(\"Point after Perspective Transformation:\", perspectivePoint.toString());\n   * }\n   * </code></div>\n   */\n  multiplyAndNormalizePoint({ x, y, z }) {\n    const array = this.multiplyVec4(x, y, z, 1);\n    array[0] /= array[3];\n    array[1] /= array[3];\n    array[2] /= array[3];\n    return new Vector(array[0], array[1], array[2]);\n  }\n\n  /**\n   * Applies a matrix to a vector.\n   * The fourth component is set to 0.\n   * Returns a vector consisting of the first\n   * through third components of the result.\n   *\n   * This method multiplies the current matrix by a 4D vector (x, y, z, 0),\n   * effectively transforming the direction vector using the matrix. The resulting\n   * vector is returned as a new `p5.Vector` instance. This is particularly useful\n   * for transforming direction vectors (e.g., normals) without applying translation.\n   *\n   * @param {p5.Vector} vector - The input vector to transform. It should\n   *                              have x, y, and z components.\n   * @return {p5.Vector} A new `p5.Vector` instance representing the transformed direction.\n   *\n   * @example\n   * // Applying a matrix to a direction vector\n   * const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   * const direction = new p5.Vector(1, 0, 0); // Define a direction vector\n   * const transformedDirection = matrix.multiplyDirection(direction);\n   * console.log(transformedDirection.toString()); // Output: [1, 0, 0] (unchanged for identity matrix)\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   const matrix = new p5.Matrix(4); // Create a 4x4 identity matrix\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *\n   *   // Define a direction vector\n   *   const direction = new p5.Vector(1, 0, 0);\n   *   console.log(\"Original Direction:\", direction.toString());\n   *\n   *   // Apply the matrix to the direction vector\n   *   const transformedDirection = matrix.multiplyDirection(direction);\n   *   console.log(\"Transformed Direction:\", transformedDirection.toString());\n   *\n   *   // Modify the matrix (e.g., apply a rotation)\n   *   matrix.rotateY(Math.PI / 4); // Rotate 45 degrees around the Y-axis\n   *   console.log(\"Modified Matrix (Rotation):\", matrix.matrix);\n   *\n   *   // Apply the modified matrix to the same direction vector\n   *   const rotatedDirection = matrix.multiplyDirection(direction);\n   *   console.log(\"Rotated Direction:\", rotatedDirection.toString()); // Output: Rotated vector\n   * }\n   * </code></div>\n   */\n  multiplyDirection({ x, y, z }) {\n    const array = this.multiplyVec4(x, y, z, 0);\n    return new Vector(array[0], array[1], array[2]);\n  }\n\n  /**\n   * Takes a vector and returns the vector resulting from multiplying. This function is only for 3x3 matrices.\n   * that vector by this matrix from the left.\n   *\n   * This method applies the current 3x3 matrix to a given vector, effectively\n   * transforming the vector using the matrix. The resulting vector is returned\n   * as a new vector or stored in the provided target vector.\n   *\n   * This is useful for operations such as transforming points or directions\n   * in 2D or 3D space using a 3x3 transformation matrix.\n   *\n   * @param {p5.Vector} multVector - The vector to which this matrix applies.\n   * @param {p5.Vector} [target] - The vector to receive the result. If not provided,\n   *                               a copy of the input vector will be created and returned.\n   * @return {p5.Vector} - The transformed vector after applying the matrix.\n   *\n   * @example\n   * // Multiplying a 3x3 matrix with a vector\n   * const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   * const vector = new p5.Vector(1, 2, 3);\n   * const result = matrix.multiplyVec3(vector);\n   * console.log(result.toString()); // Output: Transformed vector\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   // Create a 3x3 matrix\n   *   const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   *   console.log(\"Original Matrix:\", matrix.matrix);\n   *\n   *   // Define a vector\n   *   const vector = new p5.Vector(1, 2, 3);\n   *   console.log(\"Original Vector:\", vector.toString()); // Output: [1, 2, 3]\n   *\n   *   // Apply the matrix to the vector\n   *   const transformedVector = matrix.multiplyVec3(vector);\n   *   console.log(\"Transformed Vector:\", transformedVector.toString()); // Output: [30, 36, 42]\n   *\n   *   // Modify the matrix (e.g., apply a scaling transformation)\n   *   matrix.scale(2, 2, 2);\n   *   console.log(\"Modified Matrix (Scaling):\", matrix.matrix); // Output: [2, 4, 6, 8, 10, 12, 14, 16, 18]\n   *\n   *   // Apply the modified matrix to the same vector\n   *   const scaledVector = matrix.multiplyVec3(vector);\n   *   console.log(\"Scaled Vector:\", scaledVector.toString()); // Output: [60, 72, 84]\n   * }\n   * </code></div>\n   */\n  multiplyVec3(multVector, target) {\n    if (target === undefined) {\n      target = multVector.copy();\n    }\n    target.x = this.row(0).dot(multVector);\n    target.y = this.row(1).dot(multVector);\n    target.z = this.row(2).dot(multVector);\n    return target;\n  }\n\n  // ====================\n  // PRIVATE\n  /**\n   * Creates identity matrix\n   * This method updates the current matrix with the result of the multiplication.\n   *\n   * @private\n   */\n  #createIdentityMatrix(dimension) {\n    // This it to prevent loops in the most common 3x3 and 4x4 cases\n    // TODO: check performance if it actually helps\n    if (dimension === 3)\n      return new GLMAT_ARRAY_TYPE([1, 0, 0, 0, 1, 0, 0, 0, 1]);\n    if (dimension === 4)\n      return new GLMAT_ARRAY_TYPE([\n        1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1,\n      ]);\n    const identityMatrix = new GLMAT_ARRAY_TYPE(dimension * dimension).fill(0);\n    for (let i = 0; i < dimension; i++) {\n      identityMatrix[i * dimension + i] = 1;\n    }\n    return identityMatrix;\n  }\n\n  /**\n   * Multiplies the current 4x4 matrix with another 4x4 matrix.\n   * This method updates the current matrix with the result of the multiplication.\n   *\n   * @private\n   * @param {number[]} _src - A 16-element array representing the 4x4 matrix to multiply with.\n   *\n   * @returns {this} The current instance with the updated matrix.\n   *\n   * @example\n   * // Assuming `matrix` is an instance of the Matrix class\n   * const srcMatrix = [\n   *   1, 0, 0, 0,\n   *   0, 1, 0, 0,\n   *   0, 0, 1, 0,\n   *   0, 0, 0, 1\n   * ];\n   * matrix.#mult4x4(srcMatrix);\n   */\n  #mult4x4(_src) {\n    // each row is used for the multiplier\n    let b0 = this.matrix[0],\n      b1 = this.matrix[1],\n      b2 = this.matrix[2],\n      b3 = this.matrix[3];\n    this.matrix[0] = b0 * _src[0] + b1 * _src[4] + b2 * _src[8] + b3 * _src[12];\n    this.matrix[1] = b0 * _src[1] + b1 * _src[5] + b2 * _src[9] + b3 * _src[13];\n    this.matrix[2] =\n      b0 * _src[2] + b1 * _src[6] + b2 * _src[10] + b3 * _src[14];\n    this.matrix[3] =\n      b0 * _src[3] + b1 * _src[7] + b2 * _src[11] + b3 * _src[15];\n\n    b0 = this.matrix[4];\n    b1 = this.matrix[5];\n    b2 = this.matrix[6];\n    b3 = this.matrix[7];\n    this.matrix[4] = b0 * _src[0] + b1 * _src[4] + b2 * _src[8] + b3 * _src[12];\n    this.matrix[5] = b0 * _src[1] + b1 * _src[5] + b2 * _src[9] + b3 * _src[13];\n    this.matrix[6] =\n      b0 * _src[2] + b1 * _src[6] + b2 * _src[10] + b3 * _src[14];\n    this.matrix[7] =\n      b0 * _src[3] + b1 * _src[7] + b2 * _src[11] + b3 * _src[15];\n\n    b0 = this.matrix[8];\n    b1 = this.matrix[9];\n    b2 = this.matrix[10];\n    b3 = this.matrix[11];\n    this.matrix[8] = b0 * _src[0] + b1 * _src[4] + b2 * _src[8] + b3 * _src[12];\n    this.matrix[9] = b0 * _src[1] + b1 * _src[5] + b2 * _src[9] + b3 * _src[13];\n    this.matrix[10] =\n      b0 * _src[2] + b1 * _src[6] + b2 * _src[10] + b3 * _src[14];\n    this.matrix[11] =\n      b0 * _src[3] + b1 * _src[7] + b2 * _src[11] + b3 * _src[15];\n\n    b0 = this.matrix[12];\n    b1 = this.matrix[13];\n    b2 = this.matrix[14];\n    b3 = this.matrix[15];\n    this.matrix[12] =\n      b0 * _src[0] + b1 * _src[4] + b2 * _src[8] + b3 * _src[12];\n    this.matrix[13] =\n      b0 * _src[1] + b1 * _src[5] + b2 * _src[9] + b3 * _src[13];\n    this.matrix[14] =\n      b0 * _src[2] + b1 * _src[6] + b2 * _src[10] + b3 * _src[14];\n    this.matrix[15] =\n      b0 * _src[3] + b1 * _src[7] + b2 * _src[11] + b3 * _src[15];\n\n    return this;\n  }\n\n  /**\n   * @param {p5.Matrix|Float32Array|Number[]} multMatrix The matrix\n   *                                                we want to multiply by\n   * @private\n   * @chainable\n   */\n  #multNxN(multMatrix) {\n    if (multMatrix.length !== this.matrix.length) {\n      throw new Error(\"Matrices must be of the same dimension to multiply.\");\n    }\n    const result = new GLMAT_ARRAY_TYPE(this.matrix.length).fill(0);\n    for (let i = 0; i < this.#sqDimention; i++) {\n      for (let j = 0; j < this.#sqDimention; j++) {\n        for (let k = 0; k < this.#sqDimention; k++) {\n          result[i * this.#sqDimention + j] +=\n            this.matrix[i * this.#sqDimention + k] *\n            multMatrix[k * this.#sqDimention + j];\n        }\n      }\n    }\n    this.matrix = result;\n    return this;\n  }\n\n  /**\n   * This function is only for 3x3 matrices.\n   * multiply two mat3s. It is an operation to multiply the 3x3 matrix of\n   * the argument from the right. Arguments can be a 3x3 p5.Matrix,\n   * a Float32Array of length 9, or a javascript array of length 9.\n   * In addition, it can also be done by enumerating 9 numbers.\n   *\n   * @param {p5.Matrix|Float32Array|Number[]} multMatrix The matrix\n   *                                                we want to multiply by\n   * @private\n   * @chainable\n   */\n  #mult3x3(_src) {\n    // each row is used for the multiplier\n    let b0 = this.mat3[0];\n    let b1 = this.mat3[1];\n    let b2 = this.mat3[2];\n    this.mat3[0] = b0 * _src[0] + b1 * _src[3] + b2 * _src[6];\n    this.mat3[1] = b0 * _src[1] + b1 * _src[4] + b2 * _src[7];\n    this.mat3[2] = b0 * _src[2] + b1 * _src[5] + b2 * _src[8];\n\n    b0 = this.mat3[3];\n    b1 = this.mat3[4];\n    b2 = this.mat3[5];\n    this.mat3[3] = b0 * _src[0] + b1 * _src[3] + b2 * _src[6];\n    this.mat3[4] = b0 * _src[1] + b1 * _src[4] + b2 * _src[7];\n    this.mat3[5] = b0 * _src[2] + b1 * _src[5] + b2 * _src[8];\n\n    b0 = this.mat3[6];\n    b1 = this.mat3[7];\n    b2 = this.mat3[8];\n    this.mat3[6] = b0 * _src[0] + b1 * _src[3] + b2 * _src[6];\n    this.mat3[7] = b0 * _src[1] + b1 * _src[4] + b2 * _src[7];\n    this.mat3[8] = b0 * _src[2] + b1 * _src[5] + b2 * _src[8];\n\n    return this;\n  }\n\n  /**\n   * Transposes a square matrix in place.\n   * This method swaps the rows and columns of the matrix, effectively flipping it over its diagonal.\n   *\n   * @private\n   * @returns {Matrix} The current instance of the Matrix, with the transposed values.\n   */\n  #transposeNxN() {\n    const n = this.#sqDimention;\n    for (let i = 0; i < n; i++) {\n      for (let j = 0; j < n; j++) {\n        this.matrix[i * n + j] = this.matrix[j * n + i];\n      }\n    }\n    return this;\n  }\n\n  /**\n   * transpose according to a given matrix\n   * @param  {p5.Matrix|Float32Array|Number[]} a  the matrix to be\n   *                                               based on to transpose\n   * @private\n   * @chainable\n   */\n  #transpose4x4(a) {\n    console.log(\"====> 4x4\");\n    let a01, a02, a03, a12, a13, a23;\n    if (a instanceof Matrix) {\n      a01 = a.matrix[1];\n      a02 = a.matrix[2];\n      a03 = a.matrix[3];\n      a12 = a.matrix[6];\n      a13 = a.matrix[7];\n      a23 = a.matrix[11];\n\n      this.matrix[0] = a.matrix[0];\n      this.matrix[1] = a.matrix[4];\n      this.matrix[2] = a.matrix[8];\n      this.matrix[3] = a.matrix[12];\n      this.matrix[4] = a01;\n      this.matrix[5] = a.matrix[5];\n      this.matrix[6] = a.matrix[9];\n      this.matrix[7] = a.matrix[13];\n      this.matrix[8] = a02;\n      this.matrix[9] = a12;\n      this.matrix[10] = a.matrix[10];\n      this.matrix[11] = a.matrix[14];\n      this.matrix[12] = a03;\n      this.matrix[13] = a13;\n      this.matrix[14] = a23;\n      this.matrix[15] = a.matrix[15];\n    } else if (isMatrixArray(a)) {\n      a01 = a[1];\n      a02 = a[2];\n      a03 = a[3];\n      a12 = a[6];\n      a13 = a[7];\n      a23 = a[11];\n\n      this.matrix[0] = a[0];\n      this.matrix[1] = a[4];\n      this.matrix[2] = a[8];\n      this.matrix[3] = a[12];\n      this.matrix[4] = a01;\n      this.matrix[5] = a[5];\n      this.matrix[6] = a[9];\n      this.matrix[7] = a[13];\n      this.matrix[8] = a02;\n      this.matrix[9] = a12;\n      this.matrix[10] = a[10];\n      this.matrix[11] = a[14];\n      this.matrix[12] = a03;\n      this.matrix[13] = a13;\n      this.matrix[14] = a23;\n      this.matrix[15] = a[15];\n    }\n    return this;\n  }\n\n  /**\n   * This function is only for 3x3 matrices.\n   * transposes a 33 p5.Matrix by a mat3\n   * If there is an array of arguments, the matrix obtained by transposing\n   * the 3x3 matrix generated based on that array is set.\n   * If no arguments, it transposes itself and returns it.\n   *\n   * @param  {Number[]} mat3 1-dimensional array\n   * @private\n   * @chainable\n   */\n  #transpose3x3(mat3) {\n    if (mat3 === undefined) {\n      mat3 = this.mat3;\n    }\n    const a01 = mat3[1];\n    const a02 = mat3[2];\n    const a12 = mat3[5];\n    this.mat3[0] = mat3[0];\n    this.mat3[1] = mat3[3];\n    this.mat3[2] = mat3[6];\n    this.mat3[3] = a01;\n    this.mat3[4] = mat3[4];\n    this.mat3[5] = mat3[7];\n    this.mat3[6] = a02;\n    this.mat3[7] = a12;\n    this.mat3[8] = mat3[8];\n\n    return this;\n  }\n\n  /**\n   * Only 4x4 becasuse determinant is only 4x4 currently\n   * invert  matrix according to a give matrix\n   * @param  {p5.Matrix|Float32Array|Number[]} a   the matrix to be\n   *                                                based on to invert\n   * @private\n   * @chainable\n   */\n  #invert4x4(a) {\n    let a00, a01, a02, a03, a10, a11, a12, a13;\n    let a20, a21, a22, a23, a30, a31, a32, a33;\n    if (a instanceof Matrix) {\n      a00 = a.matrix[0];\n      a01 = a.matrix[1];\n      a02 = a.matrix[2];\n      a03 = a.matrix[3];\n      a10 = a.matrix[4];\n      a11 = a.matrix[5];\n      a12 = a.matrix[6];\n      a13 = a.matrix[7];\n      a20 = a.matrix[8];\n      a21 = a.matrix[9];\n      a22 = a.matrix[10];\n      a23 = a.matrix[11];\n      a30 = a.matrix[12];\n      a31 = a.matrix[13];\n      a32 = a.matrix[14];\n      a33 = a.matrix[15];\n    } else if (isMatrixArray(a)) {\n      a00 = a[0];\n      a01 = a[1];\n      a02 = a[2];\n      a03 = a[3];\n      a10 = a[4];\n      a11 = a[5];\n      a12 = a[6];\n      a13 = a[7];\n      a20 = a[8];\n      a21 = a[9];\n      a22 = a[10];\n      a23 = a[11];\n      a30 = a[12];\n      a31 = a[13];\n      a32 = a[14];\n      a33 = a[15];\n    }\n    const b00 = a00 * a11 - a01 * a10;\n    const b01 = a00 * a12 - a02 * a10;\n    const b02 = a00 * a13 - a03 * a10;\n    const b03 = a01 * a12 - a02 * a11;\n    const b04 = a01 * a13 - a03 * a11;\n    const b05 = a02 * a13 - a03 * a12;\n    const b06 = a20 * a31 - a21 * a30;\n    const b07 = a20 * a32 - a22 * a30;\n    const b08 = a20 * a33 - a23 * a30;\n    const b09 = a21 * a32 - a22 * a31;\n    const b10 = a21 * a33 - a23 * a31;\n    const b11 = a22 * a33 - a23 * a32;\n\n    // Calculate the determinant\n    let det =\n      b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    if (!det) {\n      return null;\n    }\n    det = 1.0 / det;\n\n    this.matrix[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n    this.matrix[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n    this.matrix[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n    this.matrix[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n    this.matrix[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n    this.matrix[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n    this.matrix[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n    this.matrix[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n    this.matrix[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n    this.matrix[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n    this.matrix[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n    this.matrix[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n    this.matrix[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n    this.matrix[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n    this.matrix[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n    this.matrix[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n\n    return this;\n  }\n\n  /**\n   * Inverts a 33 matrix\n   * @chainable\n   * @private\n   */\n  #invert3x3() {\n    const a00 = this.mat3[0];\n    const a01 = this.mat3[1];\n    const a02 = this.mat3[2];\n    const a10 = this.mat3[3];\n    const a11 = this.mat3[4];\n    const a12 = this.mat3[5];\n    const a20 = this.mat3[6];\n    const a21 = this.mat3[7];\n    const a22 = this.mat3[8];\n    const b01 = a22 * a11 - a12 * a21;\n    const b11 = -a22 * a10 + a12 * a20;\n    const b21 = a21 * a10 - a11 * a20;\n\n    // Calculate the determinant\n    let det = a00 * b01 + a01 * b11 + a02 * b21;\n    if (!det) {\n      return null;\n    }\n    det = 1.0 / det;\n    this.mat3[0] = b01 * det;\n    this.mat3[1] = (-a22 * a01 + a02 * a21) * det;\n    this.mat3[2] = (a12 * a01 - a02 * a11) * det;\n    this.mat3[3] = b11 * det;\n    this.mat3[4] = (a22 * a00 - a02 * a20) * det;\n    this.mat3[5] = (-a12 * a00 + a02 * a10) * det;\n    this.mat3[6] = b21 * det;\n    this.mat3[7] = (-a21 * a00 + a01 * a20) * det;\n    this.mat3[8] = (a11 * a00 - a01 * a10) * det;\n    return this;\n  }\n\n  /**\n   * inspired by Toji's mat4 determinant\n   * @return {Number} Determinant of our 44 matrix\n   * @private\n   */\n  #determinant4x4() {\n    if (this.#sqDimention !== 4) {\n      throw new Error(\n        \"Determinant is only implemented for 4x4 matrices. We are working on it.\"\n      );\n    }\n\n    const d00 =\n        this.matrix[0] * this.matrix[5] - this.matrix[1] * this.matrix[4],\n      d01 = this.matrix[0] * this.matrix[6] - this.matrix[2] * this.matrix[4],\n      d02 = this.matrix[0] * this.matrix[7] - this.matrix[3] * this.matrix[4],\n      d03 = this.matrix[1] * this.matrix[6] - this.matrix[2] * this.matrix[5],\n      d04 = this.matrix[1] * this.matrix[7] - this.matrix[3] * this.matrix[5],\n      d05 = this.matrix[2] * this.matrix[7] - this.matrix[3] * this.matrix[6],\n      d06 = this.matrix[8] * this.matrix[13] - this.matrix[9] * this.matrix[12],\n      d07 =\n        this.matrix[8] * this.matrix[14] - this.matrix[10] * this.matrix[12],\n      d08 =\n        this.matrix[8] * this.matrix[15] - this.matrix[11] * this.matrix[12],\n      d09 =\n        this.matrix[9] * this.matrix[14] - this.matrix[10] * this.matrix[13],\n      d10 =\n        this.matrix[9] * this.matrix[15] - this.matrix[11] * this.matrix[13],\n      d11 =\n        this.matrix[10] * this.matrix[15] - this.matrix[11] * this.matrix[14];\n\n    // Calculate the determinant\n    return (\n      d00 * d11 - d01 * d10 + d02 * d09 + d03 * d08 - d04 * d07 + d05 * d06\n    );\n  }\n\n  /**\n   * PRIVATE\n   */\n  // matrix methods adapted from:\n  // https://developer.mozilla.org/en-US/docs/Web/WebGL/\n  // gluPerspective\n  //\n  // function _makePerspective(fovy, aspect, znear, zfar){\n  //    const ymax = znear * Math.tan(fovy * Math.PI / 360.0);\n  //    const ymin = -ymax;\n  //    const xmin = ymin * aspect;\n  //    const xmax = ymax * aspect;\n  //    return _makeFrustum(xmin, xmax, ymin, ymax, znear, zfar);\n  //  }\n\n  ////\n  //// glFrustum\n  ////\n  //function _makeFrustum(left, right, bottom, top, znear, zfar){\n  //  const X = 2*znear/(right-left);\n  //  const Y = 2*znear/(top-bottom);\n  //  const A = (right+left)/(right-left);\n  //  const B = (top+bottom)/(top-bottom);\n  //  const C = -(zfar+znear)/(zfar-znear);\n  //  const D = -2*zfar*znear/(zfar-znear);\n  //  const frustrumMatrix =[\n  //  X, 0, A, 0,\n  //  0, Y, B, 0,\n  //  0, 0, C, D,\n  //  0, 0, -1, 0\n  //];\n  //return frustrumMatrix;\n  // }\n\n  // function _setMVPMatrices(){\n  ////an identity matrix\n  ////@TODO use the p5.Matrix class to abstract away our MV matrices and\n  ///other math\n  //const _mvMatrix =\n  //[\n  //  1.0,0.0,0.0,0.0,\n  //  0.0,1.0,0.0,0.0,\n  //  0.0,0.0,1.0,0.0,\n  //  0.0,0.0,0.0,1.0\n  //];\n}\n\nexport { GLMAT_ARRAY_TYPE, Matrix, isMatrixArray };\n","import { Matrix } from './Matrices/Matrix.js';\nimport './p5.Vector.js';\nimport '../constants-8IpwyBct.js';\nimport './Matrices/MatrixInterface.js';\n\n/**\n * @module Math\n * @requires constants\n * @todo see methods below needing further implementation.\n * future consideration: implement SIMD optimizations\n * when browser compatibility becomes available\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/\n *   Reference/Global_Objects/SIMD\n */\n// import { MatrixNumjs as Matrix } from './Matrices/MatrixNumjs'\n\nfunction matrix(p5, fn) {\n  /**\n   * A class to describe a matrix\n   * for model and view matrix manipulation in the p5js webgl renderer.\n   * The `Matrix` class represents a mathematical matrix and provides various methods for matrix operations.\n   *\n   * The `Matrix` class represents a mathematical matrix and provides various methods for matrix operations.\n   * This class extends the `MatrixInterface` and includes methods for creating, manipulating, and performing\n   * operations on matrices. It supports both 3x3 and 4x4 matrices, as well as general NxN matrices.\n   * @private\n   * @class p5.Matrix\n   * @param {Array} [mat4] column-major array literal of our 44 matrix\n   * @example\n   * // Creating a 3x3 matrix from an array using column major arrangement\n   * const matrix = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   *\n   * // Creating a 4x4 identity matrix\n   * const identityMatrix = new p5.Matrix(4);\n   *\n   * // Adding two matrices\n   * const matrix1 = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   * const matrix2 = new p5.Matrix([9, 8, 7, 6, 5, 4, 3, 2, 1]);\n   * matrix1.add(matrix2); // matrix1 is now [10, 10, 10, 10, 10, 10, 10, 10, 10]\n   *\n   * // Setting an element in the matrix\n   * matrix.setElement(0, 10); // matrix is now [10, 2, 3, 4, 5, 6, 7, 8, 9]\n   *\n   * // Resetting the matrix to an identity matrix\n   * matrix.reset();\n   *\n   * // Getting the diagonal elements of the matrix\n   * const diagonal = matrix.diagonal(); // [1, 1, 1]\n   *\n   * // Transposing the matrix\n   * matrix.transpose();\n   *\n   * // Multiplying two matrices\n   * matrix1.mult(matrix2);\n   *\n   * // Inverting the matrix\n   * matrix.invert();\n   *\n   * // Scaling the matrix\n   * matrix.scale(2, 2, 2);\n   *\n   * // Rotating the matrix around an axis\n   * matrix.rotate4x4(Math.PI / 4, 1, 0, 0);\n   *\n   * // Applying a perspective transformation\n   * matrix.perspective(Math.PI / 4, 1, 0.1, 100);\n   *\n   * // Applying an orthographic transformation\n   * matrix.ortho(-1, 1, -1, 1, 0.1, 100);\n   *\n   * // Multiplying a vector by the matrix\n   * const vector = new Vector(1, 2, 3);\n   * const result = matrix.multiplyPoint(vector);\n   *\n   * // p5.js script example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *\n   *   // Create a 4x4 identity matrix\n   *   const matrix = new p5.Matrix(4);\n   *   console.log(\"Original p5.Matrix:\", matrix.matrix.toString()); // Output: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]\n   *\n   *   // Add two matrices\n   *   const matrix1 = new p5.Matrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   *   const matrix2 = new p5.Matrix([9, 8, 7, 6, 5, 4, 3, 2, 1]);\n   *   matrix1.add(matrix2);\n   *   console.log(\"After Addition:\", matrix1.matrix.toString()); // Output: [10, 10, 10, 10, 10, 10, 10, 10, 10]\n   *\n   *   // Reset the matrix to an identity matrix\n   *   matrix.reset();\n   *   console.log(\"Reset p5.Matrix:\", matrix.matrix.toString()); // [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]\n   *\n   *   // Apply a scaling transformation\n   *   matrix.scale(2, 2, 2);\n   *   console.log(\"Scaled p5.Matrix:\", matrix.matrix.toString()); // [2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 1]\n   *\n   *   // Apply a rotation around the X-axis\n   *   matrix.rotate4x4(Math.PI / 4, 1, 0, 0);\n   *   console.log(\"Rotated p5.Matrix (X-axis):\", matrix.matrix.toString()); // [2, 0, 0, 0, 0, 1.4142135381698608, 1.4142135381698608, 0, 0, -1.4142135381698608, 1.4142135381698608, 0, 0, 0, 0, 1]\n   *\n   *   // Apply a perspective transformation\n   *   matrix.perspective(Math.PI / 4, 1, 0.1, 100);\n   *   console.log(\"Perspective p5.Matrix:\", matrix.matrix.toString());// [2.4142136573791504, 0, 0, 0, 0, 2.4142136573791504, 0, 0, 0, 0, -1.0020020008087158, -1, 0, 0, -0.20020020008087158, 0]\n   *\n   *   // Multiply a vector by the matrix\n   *   const vector = new p5.Vector(1, 2, 3);\n   *   const transformedVector = matrix.multiplyPoint(vector);\n   *   console.log(\"Transformed Vector:\", transformedVector.toString());\n   * }\n   * </code></div>\n   */\n  p5.Matrix = Matrix;\n}\n\nif (typeof p5 !== \"undefined\") {\n  matrix(p5, p5.prototype);\n}\n\nexport { Matrix, matrix as default };\n","class DataArray {\n  constructor(initialLength = 128) {\n    this.length = 0;\n    this.data = new Float32Array(initialLength);\n    this.initialLength = initialLength;\n  }\n\n  /**\n   * Returns a Float32Array window sized to the exact length of the data\n   */\n  dataArray() {\n    return this.subArray(0, this.length);\n  }\n\n  /**\n   * A \"soft\" clear, which keeps the underlying storage size the same, but\n   * empties the contents of its dataArray()\n   */\n  clear() {\n    this.length = 0;\n  }\n\n  /**\n   * Can be used to scale a DataArray back down to fit its contents.\n   */\n  rescale() {\n    if (this.length < this.data.length / 2) {\n      // Find the power of 2 size that fits the data\n      const targetLength = 1 << Math.ceil(Math.log2(this.length));\n      const newData = new Float32Array(targetLength);\n      newData.set(this.data.subarray(0, this.length), 0);\n      this.data = newData;\n    }\n  }\n\n  /**\n   * A full reset, which allocates a new underlying Float32Array at its initial\n   * length\n   */\n  reset() {\n    this.clear();\n    this.data = new Float32Array(this.initialLength);\n  }\n\n  /**\n   * Adds values to the DataArray, expanding its internal storage to\n   * accommodate the new items.\n   */\n  push(...values) {\n    this.ensureLength(this.length + values.length);\n    this.data.set(values, this.length);\n    this.length += values.length;\n  }\n\n  /**\n   * Returns a copy of the data from the index `from`, inclusive, to the index\n   * `to`, exclusive\n   */\n  slice(from, to) {\n    return this.data.slice(from, Math.min(to, this.length));\n  }\n\n  /**\n   * Returns a mutable Float32Array window from the index `from`, inclusive, to\n   * the index `to`, exclusive\n   */\n  subArray(from, to) {\n    return this.data.subarray(from, Math.min(to, this.length));\n  }\n\n  /**\n   * Expand capacity of the internal storage until it can fit a target size\n   */\n  ensureLength(target) {\n    while (this.data.length < target) {\n      const newData = new Float32Array(this.data.length * 2);\n      newData.set(this.data, 0);\n      this.data = newData;\n    }\n  }\n}\nfunction dataArray(p5, fn){\n  /**\n   * An internal class to store data that will be sent to a p5.RenderBuffer.\n   * Those need to eventually go into a Float32Array, so this class provides a\n   * variable-length array container backed by a Float32Array so that it can be\n   * sent to the GPU without allocating a new array each frame.\n   *\n   * Like a C++ vector, its fixed-length Float32Array backing its contents will\n   * double in size when it goes over its capacity.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Initialize storage with a capacity of 4\n   * const storage = new DataArray(4);\n   * console.log(storage.data.length); // 4\n   * console.log(storage.length); // 0\n   * console.log(storage.dataArray()); // Empty Float32Array\n   *\n   * storage.push(1, 2, 3, 4, 5, 6);\n   * console.log(storage.data.length); // 8\n   * console.log(storage.length); // 6\n   * console.log(storage.dataArray()); // Float32Array{1, 2, 3, 4, 5, 6}\n   * </code>\n   * </div>\n   */\n  p5.DataArray = DataArray;\n}\n\nif(typeof p5 !== 'undefined'){\n  dataArray(p5, p5.prototype);\n}\n\nexport { DataArray, dataArray as default };\n","import { F as FLAT, y as SMOOTH } from '../constants-8IpwyBct.js';\nimport { DataArray } from './p5.DataArray.js';\nimport { Vector } from '../math/p5.Vector.js';\nimport { downloadFile } from '../io/utilities.js';\nimport 'file-saver';\n\n/**\n * @module Shape\n * @submodule 3D Primitives\n * @for p5\n * @requires core\n * @requires p5.Geometry\n */\n\n\nclass Geometry {\n  constructor(detailX, detailY, callback, renderer) {\n    this.renderer = renderer;\n    this.vertices = [];\n\n    this.boundingBoxCache = null;\n\n\n    //an array containing every vertex for stroke drawing\n    this.lineVertices = new DataArray();\n\n    // The tangents going into or out of a vertex on a line. Along a straight\n    // line segment, both should be equal. At an endpoint, one or the other\n    // will not exist and will be all 0. In joins between line segments, they\n    // may be different, as they will be the tangents on either side of the join.\n    this.lineTangentsIn = new DataArray();\n    this.lineTangentsOut = new DataArray();\n\n    // When drawing lines with thickness, entries in this buffer represent which\n    // side of the centerline the vertex will be placed. The sign of the number\n    // will represent the side of the centerline, and the absolute value will be\n    // used as an enum to determine which part of the cap or join each vertex\n    // represents. See the doc comments for _addCap and _addJoin for diagrams.\n    this.lineSides = new DataArray();\n\n    this.vertexNormals = [];\n\n    this.faces = [];\n\n    this.uvs = [];\n    // a 2D array containing edge connectivity pattern for create line vertices\n    //based on faces for most objects;\n    this.edges = [];\n    this.vertexColors = [];\n\n    // One color per vertex representing the stroke color at that vertex\n    this.vertexStrokeColors = [];\n\n    this.userVertexProperties = {};\n\n    // One color per line vertex, generated automatically based on\n    // vertexStrokeColors in _edgesToVertices()\n    this.lineVertexColors = new DataArray();\n    this.detailX = detailX !== undefined ? detailX : 1;\n    this.detailY = detailY !== undefined ? detailY : 1;\n    this.dirtyFlags = {};\n\n    this._hasFillTransparency = undefined;\n    this._hasStrokeTransparency = undefined;\n\n    this.gid = `_p5_Geometry_${Geometry.nextId}`;\n    Geometry.nextId++;\n    if (callback instanceof Function) {\n      callback.call(this);\n    }\n  }\n\n  /**\n * Calculates the position and size of the smallest box that contains the geometry.\n *\n * A bounding box is the smallest rectangular prism that contains the entire\n * geometry. It's defined by the box's minimum and maximum coordinates along\n * each axis, as well as the size (length) and offset (center).\n *\n * Calling `myGeometry.calculateBoundingBox()` returns an object with four\n * properties that describe the bounding box:\n *\n * ```js\n * // Get myGeometry's bounding box.\n * let bbox = myGeometry.calculateBoundingBox();\n *\n * // Print the bounding box to the console.\n * console.log(bbox);\n *\n * // {\n * //  // The minimum coordinate along each axis.\n * //  min: { x: -1, y: -2, z: -3 },\n * //\n * //  // The maximum coordinate along each axis.\n * //  max: { x: 1, y: 2, z: 3},\n * //\n * //  // The size (length) along each axis.\n * //  size: { x: 2, y: 4, z: 6},\n * //\n * //  // The offset (center) along each axis.\n * //  offset: { x: 0, y: 0, z: 0}\n * // }\n * ```\n *\n * @returns {Object} bounding box of the geometry.\n *\n * @example\n * <div>\n * <code>\n * // Click and drag the mouse to view the scene from different angles.\n *\n * let particles;\n *\n * function setup() {\n *   createCanvas(100, 100, WEBGL);\n *\n *   // Create a new p5.Geometry object with random spheres.\n *   particles = buildGeometry(createParticles);\n *\n *   describe('Ten white spheres placed randomly against a gray background. A box encloses the spheres.');\n * }\n *\n * function draw() {\n *   background(50);\n *\n *   // Enable orbiting with the mouse.\n *   orbitControl();\n *\n *   // Turn on the lights.\n *   lights();\n *\n *   // Style the particles.\n *   noStroke();\n *   fill(255);\n *\n *   // Draw the particles.\n *   model(particles);\n *\n *   // Calculate the bounding box.\n *   let bbox = particles.calculateBoundingBox();\n *\n *   // Translate to the bounding box's center.\n *   translate(bbox.offset.x, bbox.offset.y, bbox.offset.z);\n *\n *   // Style the bounding box.\n *   stroke(255);\n *   noFill();\n *\n *   // Draw the bounding box.\n *   box(bbox.size.x, bbox.size.y, bbox.size.z);\n * }\n *\n * function createParticles() {\n *   for (let i = 0; i < 10; i += 1) {\n *     // Calculate random coordinates.\n *     let x = randomGaussian(0, 15);\n *     let y = randomGaussian(0, 15);\n *     let z = randomGaussian(0, 15);\n *\n *     push();\n *     // Translate to the particle's coordinates.\n *     translate(x, y, z);\n *     // Draw the particle.\n *     sphere(3);\n *     pop();\n *   }\n * }\n * </code>\n * </div>\n */\n  calculateBoundingBox() {\n    if (this.boundingBoxCache) {\n      return this.boundingBoxCache; // Return cached result if available\n    }\n\n    let minVertex = new Vector(\n      Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE);\n    let maxVertex = new Vector(\n      Number.MIN_VALUE, Number.MIN_VALUE, Number.MIN_VALUE);\n\n    for (let i = 0; i < this.vertices.length; i++) {\n      let vertex = this.vertices[i];\n      minVertex.x = Math.min(minVertex.x, vertex.x);\n      minVertex.y = Math.min(minVertex.y, vertex.y);\n      minVertex.z = Math.min(minVertex.z, vertex.z);\n\n      maxVertex.x = Math.max(maxVertex.x, vertex.x);\n      maxVertex.y = Math.max(maxVertex.y, vertex.y);\n      maxVertex.z = Math.max(maxVertex.z, vertex.z);\n    }\n    // Calculate size and offset properties\n    let size = new Vector(maxVertex.x - minVertex.x,\n      maxVertex.y - minVertex.y, maxVertex.z - minVertex.z);\n    let offset = new Vector((minVertex.x + maxVertex.x) / 2,\n      (minVertex.y + maxVertex.y) / 2, (minVertex.z + maxVertex.z) / 2);\n\n    // Cache the result for future access\n    this.boundingBoxCache = {\n      min: minVertex,\n      max: maxVertex,\n      size: size,\n      offset: offset\n    };\n\n    return this.boundingBoxCache;\n  }\n\n  reset() {\n    this._hasFillTransparency = undefined;\n    this._hasStrokeTransparency = undefined;\n\n    this.lineVertices.clear();\n    this.lineTangentsIn.clear();\n    this.lineTangentsOut.clear();\n    this.lineSides.clear();\n\n    this.vertices.length = 0;\n    this.edges.length = 0;\n    this.vertexColors.length = 0;\n    this.vertexStrokeColors.length = 0;\n    this.lineVertexColors.clear();\n    this.vertexNormals.length = 0;\n    this.uvs.length = 0;\n\n    for (const propName in this.userVertexProperties){\n      this.userVertexProperties[propName].delete();\n    }\n    this.userVertexProperties = {};\n\n    this.dirtyFlags = {};\n  }\n\n  hasFillTransparency() {\n    if (this._hasFillTransparency === undefined) {\n      this._hasFillTransparency = false;\n      for (let i = 0; i < this.vertexColors.length; i += 4) {\n        if (this.vertexColors[i + 3] < 1) {\n          this._hasFillTransparency = true;\n          break;\n        }\n      }\n    }\n    return this._hasFillTransparency;\n  }\n  hasStrokeTransparency() {\n    if (this._hasStrokeTransparency === undefined) {\n      this._hasStrokeTransparency = false;\n      for (let i = 0; i < this.lineVertexColors.length; i += 4) {\n        if (this.lineVertexColors[i + 3] < 1) {\n          this._hasStrokeTransparency = true;\n          break;\n        }\n      }\n    }\n    return this._hasStrokeTransparency;\n  }\n\n  /**\n   * Removes the geometrys internal colors.\n   *\n   * `p5.Geometry` objects can be created with \"internal colors\" assigned to\n   * vertices or the entire shape. When a geometry has internal colors,\n   * <a href=\"#/p5/fill\">fill()</a> has no effect. Calling\n   * `myGeometry.clearColors()` allows the\n   * <a href=\"#/p5/fill\">fill()</a> function to apply color to the geometry.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Geometry object.\n   *   // Set its internal color to red.\n   *   let myGeometry = buildGeometry(function() {\n   *     fill(255, 0, 0);\n   *     plane(20);\n   *   });\n   *\n   *   // Style the shape.\n   *   noStroke();\n   *\n   *   // Draw the p5.Geometry object (center).\n   *   model(myGeometry);\n   *\n   *   // Translate the origin to the bottom-right.\n   *   translate(25, 25, 0);\n   *\n   *   // Try to fill the geometry with green.\n   *   fill(0, 255, 0);\n   *\n   *   // Draw the geometry again (bottom-right).\n   *   model(myGeometry);\n   *\n   *   // Clear the geometry's colors.\n   *   myGeometry.clearColors();\n   *\n   *   // Fill the geometry with blue.\n   *   fill(0, 0, 255);\n   *\n   *   // Translate the origin up.\n   *   translate(0, -50, 0);\n   *\n   *   // Draw the geometry again (top-right).\n   *   model(myGeometry);\n   *\n   *   describe(\n   *     'Three squares drawn against a gray background. Red squares are at the center and the bottom-right. A blue square is at the top-right.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  clearColors() {\n    this.vertexColors = [];\n    return this;\n  }\n\n  /**\n   * The `saveObj()` function exports `p5.Geometry` objects as\n   * 3D models in the Wavefront .obj file format.\n   * This way, you can use the 3D shapes you create in p5.js in other software\n   * for rendering, animation, 3D printing, or more.\n   *\n   * The exported .obj file will include the faces and vertices of the `p5.Geometry`,\n   * as well as its texture coordinates and normals, if it has them.\n   *\n   * @method saveObj\n   * @param {String} [fileName='model.obj'] The name of the file to save the model as.\n   *                                        If not specified, the default file name will be 'model.obj'.\n   * @example\n   * <div>\n   * <code>\n   * let myModel;\n   * let saveBtn;\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myModel = buildGeometry(function()) {\n   *     for (let i = 0; i < 5; i++) {\n   *       push();\n   *       translate(\n   *         random(-75, 75),\n   *         random(-75, 75),\n   *         random(-75, 75)\n   *       );\n   *       sphere(random(5, 50));\n   *       pop();\n   *     }\n   *   });\n   *\n   *   saveBtn = createButton('Save .obj');\n   *   saveBtn.mousePressed(() => myModel.saveObj());\n   *\n   *   describe('A few spheres rotating in space');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *   noStroke();\n   *   lights();\n   *   rotateX(millis() * 0.001);\n   *   rotateY(millis() * 0.002);\n   *   model(myModel);\n   * }\n   * </code>\n   * </div>\n   */\n  saveObj(fileName = 'model.obj') {\n    let objStr= '';\n\n\n    // Vertices\n    this.vertices.forEach(v => {\n      objStr += `v ${v.x} ${v.y} ${v.z}\\n`;\n    });\n\n    // Texture Coordinates (UVs)\n    if (this.uvs && this.uvs.length > 0) {\n      for (let i = 0; i < this.uvs.length; i += 2) {\n        objStr += `vt ${this.uvs[i]} ${this.uvs[i + 1]}\\n`;\n      }\n    }\n\n    // Vertex Normals\n    if (this.vertexNormals && this.vertexNormals.length > 0) {\n      this.vertexNormals.forEach(n => {\n        objStr += `vn ${n.x} ${n.y} ${n.z}\\n`;\n      });\n\n    }\n    // Faces, obj vertex indices begin with 1 and not 0\n    // texture coordinate (uvs) and vertexNormal indices\n    // are indicated with trailing ints vertex/normal/uv\n    // ex 1/1/1 or 2//2 for vertices without uvs\n    this.faces.forEach(face => {\n      let faceStr = 'f';\n      face.forEach(index =>{\n        faceStr += ' ';\n        faceStr += index + 1;\n        if (this.vertexNormals.length > 0 || this.uvs.length > 0) {\n          faceStr += '/';\n          if (this.uvs.length > 0) {\n            faceStr += index + 1;\n          }\n          faceStr += '/';\n          if (this.vertexNormals.length > 0) {\n            faceStr += index + 1;\n          }\n        }\n      });\n      objStr += faceStr + '\\n';\n    });\n\n    const blob = new Blob([objStr], { type: 'text/plain' });\n    downloadFile(blob, fileName , 'obj');\n\n  }\n\n  /**\n   * The `saveStl()` function exports `p5.Geometry` objects as\n   * 3D models in the STL stereolithography file format.\n   * This way, you can use the 3D shapes you create in p5.js in other software\n   * for rendering, animation, 3D printing, or more.\n   *\n   * The exported .stl file will include the faces, vertices, and normals of the `p5.Geometry`.\n   *\n   * By default, this method saves a text-based .stl file. Alternatively, you can save a more compact\n   * but less human-readable binary .stl file by passing `{ binary: true }` as a second parameter.\n   *\n   * @method saveStl\n   * @param {String} [fileName='model.stl'] The name of the file to save the model as.\n   *                                        If not specified, the default file name will be 'model.stl'.\n   * @param {Object} [options] Optional settings. Options can include a boolean `binary` property, which\n   * controls whether or not a binary .stl file is saved. It defaults to false.\n   * @example\n   * <div>\n   * <code>\n   * let myModel;\n   * let saveBtn1;\n   * let saveBtn2;\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myModel = buildGeometry(function() {\n   *     for (let i = 0; i < 5; i++) {\n   *       push();\n   *       translate(\n   *         random(-75, 75),\n   *         random(-75, 75),\n   *         random(-75, 75)\n   *       );\n   *       sphere(random(5, 50));\n   *       pop();\n   *     }\n   *   });\n   *\n   *   saveBtn1 = createButton('Save .stl');\n   *   saveBtn1.mousePressed(function() {\n   *     myModel.saveStl();\n   *   });\n   *   saveBtn2 = createButton('Save binary .stl');\n   *   saveBtn2.mousePressed(function() {\n   *     myModel.saveStl('model.stl', { binary: true });\n   *   });\n   *\n   *   describe('A few spheres rotating in space');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *   noStroke();\n   *   lights();\n   *   rotateX(millis() * 0.001);\n   *   rotateY(millis() * 0.002);\n   *   model(myModel);\n   * }\n   * </code>\n   * </div>\n   */\n  saveStl(fileName = 'model.stl', { binary = false } = {}){\n    let modelOutput;\n    let name = fileName.substring(0, fileName.lastIndexOf('.'));\n    let faceNormals = [];\n    for (let f of this.faces) {\n      const U = Vector.sub(this.vertices[f[1]], this.vertices[f[0]]);\n      const V = Vector.sub(this.vertices[f[2]], this.vertices[f[0]]);\n      const nx = U.y * V.z - U.z * V.y;\n      const ny = U.z * V.x - U.x * V.z;\n      const nz = U.x * V.y - U.y * V.x;\n      faceNormals.push(new Vector(nx, ny, nz).normalize());\n    }\n    if (binary) {\n      let offset = 80;\n      const bufferLength =\n        this.faces.length * 2 + this.faces.length * 3 * 4 * 4 + 80 + 4;\n      const arrayBuffer = new ArrayBuffer(bufferLength);\n      modelOutput = new DataView(arrayBuffer);\n      modelOutput.setUint32(offset, this.faces.length, true);\n      offset += 4;\n      for (const [key, f] of Object.entries(this.faces)) {\n        const norm = faceNormals[key];\n        modelOutput.setFloat32(offset, norm.x, true);\n        offset += 4;\n        modelOutput.setFloat32(offset, norm.y, true);\n        offset += 4;\n        modelOutput.setFloat32(offset, norm.z, true);\n        offset += 4;\n        for (let vertexIndex of f) {\n          const vert = this.vertices[vertexIndex];\n          modelOutput.setFloat32(offset, vert.x, true);\n          offset += 4;\n          modelOutput.setFloat32(offset, vert.y, true);\n          offset += 4;\n          modelOutput.setFloat32(offset, vert.z, true);\n          offset += 4;\n        }\n        modelOutput.setUint16(offset, 0, true);\n        offset += 2;\n      }\n    } else {\n      modelOutput = 'solid ' + name + '\\n';\n\n      for (const [key, f] of Object.entries(this.faces)) {\n        const norm = faceNormals[key];\n        modelOutput +=\n          ' facet norm ' + norm.x + ' ' + norm.y + ' ' + norm.z + '\\n';\n        modelOutput += '  outer loop' + '\\n';\n        for (let vertexIndex of f) {\n          const vert = this.vertices[vertexIndex];\n          modelOutput +=\n            '   vertex ' + vert.x + ' ' + vert.y + ' ' + vert.z + '\\n';\n        }\n        modelOutput += '  endloop' + '\\n';\n        modelOutput += ' endfacet' + '\\n';\n      }\n      modelOutput += 'endsolid ' + name + '\\n';\n    }\n    const blob = new Blob([modelOutput], { type: 'text/plain' });\n    downloadFile(blob, fileName, 'stl');\n  }\n\n  /**\n   * Flips the geometrys texture u-coordinates.\n   *\n   * In order for <a href=\"#/p5/texture\">texture()</a> to work, the geometry\n   * needs a way to map the points on its surface to the pixels in a rectangular\n   * image that's used as a texture. The geometry's vertex at coordinates\n   * `(x, y, z)` maps to the texture image's pixel at coordinates `(u, v)`.\n   *\n   * The <a href=\"#/p5.Geometry/uvs\">myGeometry.uvs</a> array stores the\n   * `(u, v)` coordinates for each vertex in the order it was added to the\n   * geometry. Calling `myGeometry.flipU()` flips a geometry's u-coordinates\n   * so that the texture appears mirrored horizontally.\n   *\n   * For example, a plane's four vertices are added clockwise starting from the\n   * top-left corner. Here's how calling `myGeometry.flipU()` would change a\n   * plane's texture coordinates:\n   *\n   * ```js\n   * // Print the original texture coordinates.\n   * // Output: [0, 0, 1, 0, 0, 1, 1, 1]\n   * console.log(myGeometry.uvs);\n   *\n   * // Flip the u-coordinates.\n   * myGeometry.flipU();\n   *\n   * // Print the flipped texture coordinates.\n   * // Output: [1, 0, 0, 0, 1, 1, 0, 1]\n   * console.log(myGeometry.uvs);\n   *\n   * // Notice the swaps:\n   * // Top vertices: [0, 0, 1, 0] --> [1, 0, 0, 0]\n   * // Bottom vertices: [0, 1, 1, 1] --> [1, 1, 0, 1]\n   * ```\n   *\n   * @for p5.Geometry\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   img = await loadImage('assets/laDefense.jpg');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Create p5.Geometry objects.\n   *   let geom1 = buildGeometry(createShape);\n   *   let geom2 = buildGeometry(createShape);\n   *\n   *   // Flip geom2's U texture coordinates.\n   *   geom2.flipU();\n   *\n   *   // Left (original).\n   *   push();\n   *   translate(-25, 0, 0);\n   *   texture(img);\n   *   noStroke();\n   *   model(geom1);\n   *   pop();\n   *\n   *   // Right (flipped).\n   *   push();\n   *   translate(25, 0, 0);\n   *   texture(img);\n   *   noStroke();\n   *   model(geom2);\n   *   pop();\n   *\n   *   describe(\n   *     'Two photos of a ceiling on a gray background. The photos are mirror images of each other.'\n   *   );\n   * }\n   *\n   * function createShape() {\n   *   plane(40);\n   * }\n   * </code>\n   * </div>\n   */\n  flipU() {\n    this.uvs = this.uvs.flat().map((val, index) => {\n      if (index % 2 === 0) {\n        return 1 - val;\n      } else {\n        return val;\n      }\n    });\n  }\n\n  /**\n   * Flips the geometrys texture v-coordinates.\n   *\n   * In order for <a href=\"#/p5/texture\">texture()</a> to work, the geometry\n   * needs a way to map the points on its surface to the pixels in a rectangular\n   * image that's used as a texture. The geometry's vertex at coordinates\n   * `(x, y, z)` maps to the texture image's pixel at coordinates `(u, v)`.\n   *\n   * The <a href=\"#/p5.Geometry/uvs\">myGeometry.uvs</a> array stores the\n   * `(u, v)` coordinates for each vertex in the order it was added to the\n   * geometry. Calling `myGeometry.flipV()` flips a geometry's v-coordinates\n   * so that the texture appears mirrored vertically.\n   *\n   * For example, a plane's four vertices are added clockwise starting from the\n   * top-left corner. Here's how calling `myGeometry.flipV()` would change a\n   * plane's texture coordinates:\n   *\n   * ```js\n   * // Print the original texture coordinates.\n   * // Output: [0, 0, 1, 0, 0, 1, 1, 1]\n   * console.log(myGeometry.uvs);\n   *\n   * // Flip the v-coordinates.\n   * myGeometry.flipV();\n   *\n   * // Print the flipped texture coordinates.\n   * // Output: [0, 1, 1, 1, 0, 0, 1, 0]\n   * console.log(myGeometry.uvs);\n   *\n   * // Notice the swaps:\n   * // Left vertices: [0, 0] <--> [1, 0]\n   * // Right vertices: [1, 0] <--> [1, 1]\n   * ```\n   *\n   * @method flipV\n   * @for p5.Geometry\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   img = await loadImage('assets/laDefense.jpg');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Create p5.Geometry objects.\n   *   let geom1 = buildGeometry(createShape);\n   *   let geom2 = buildGeometry(createShape);\n   *\n   *   // Flip geom2's V texture coordinates.\n   *   geom2.flipV();\n   *\n   *   // Left (original).\n   *   push();\n   *   translate(-25, 0, 0);\n   *   texture(img);\n   *   noStroke();\n   *   model(geom1);\n   *   pop();\n   *\n   *   // Right (flipped).\n   *   push();\n   *   translate(25, 0, 0);\n   *   texture(img);\n   *   noStroke();\n   *   model(geom2);\n   *   pop();\n   *\n   *   describe(\n   *     'Two photos of a ceiling on a gray background. The photos are mirror images of each other.'\n   *   );\n   * }\n   *\n   * function createShape() {\n   *   plane(40);\n   * }\n   * </code>\n   * </div>\n   */\n  flipV() {\n    this.uvs = this.uvs.flat().map((val, index) => {\n      if (index % 2 === 0) {\n        return val;\n      } else {\n        return 1 - val;\n      }\n    });\n  }\n\n  /**\n   * Computes the geometry's faces using its vertices.\n   *\n   * All 3D shapes are made by connecting sets of points called *vertices*. A\n   * geometry's surface is formed by connecting vertices to form triangles that\n   * are stitched together. Each triangular patch on the geometry's surface is\n   * called a *face*. `myGeometry.computeFaces()` performs the math needed to\n   * define each face based on the distances between vertices.\n   *\n   * The geometry's vertices are stored as <a href=\"#/p5.Vector\">p5.Vector</a>\n   * objects in the <a href=\"#/p5.Geometry/vertices\">myGeometry.vertices</a>\n   * array. The geometry's first vertex is the\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object at `myGeometry.vertices[0]`,\n   * its second vertex is `myGeometry.vertices[1]`, its third vertex is\n   * `myGeometry.vertices[2]`, and so on.\n   *\n   * Calling `myGeometry.computeFaces()` fills the\n   * <a href=\"#/p5.Geometry/faces\">myGeometry.faces</a> array with three-element\n   * arrays that list the vertices that form each face. For example, a geometry\n   * made from a rectangle has two faces because a rectangle is made by joining\n   * two triangles. <a href=\"#/p5.Geometry/faces\">myGeometry.faces</a> for a\n   * rectangle would be the two-dimensional array\n   * `[[0, 1, 2], [2, 1, 3]]`. The first face, `myGeometry.faces[0]`, is the\n   * array `[0, 1, 2]` because it's formed by connecting\n   * `myGeometry.vertices[0]`, `myGeometry.vertices[1]`,and\n   * `myGeometry.vertices[2]`. The second face, `myGeometry.faces[1]`, is the\n   * array `[2, 1, 3]` because it's formed by connecting\n   * `myGeometry.vertices[2]`, `myGeometry.vertices[1]`, and\n   * `myGeometry.vertices[3]`.\n   *\n   * Note: `myGeometry.computeFaces()` only works when geometries have four or more vertices.\n   *\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object.\n   *   myGeometry = new p5.Geometry();\n   *\n   *   // Create p5.Vector objects to position the vertices.\n   *   let v0 = createVector(-40, 0, 0);\n   *   let v1 = createVector(0, -40, 0);\n   *   let v2 = createVector(0, 40, 0);\n   *   let v3 = createVector(40, 0, 0);\n   *\n   *   // Add the vertices to myGeometry's vertices array.\n   *   myGeometry.vertices.push(v0, v1, v2, v3);\n   *\n   *   // Compute myGeometry's faces array.\n   *   myGeometry.computeFaces();\n   *\n   *   describe('A red square drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the shape.\n   *   noStroke();\n   *   fill(255, 0, 0);\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(myGeometry);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object using a callback function.\n   *   myGeometry = new p5.Geometry(1, 1, createShape);\n   *\n   *   describe('A red square drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the shape.\n   *   noStroke();\n   *   fill(255, 0, 0);\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(myGeometry);\n   * }\n   *\n   * function createShape() {\n   *   // Create p5.Vector objects to position the vertices.\n   *   let v0 = createVector(-40, 0, 0);\n   *   let v1 = createVector(0, -40, 0);\n   *   let v2 = createVector(0, 40, 0);\n   *   let v3 = createVector(40, 0, 0);\n   *\n   *   // Add the vertices to the p5.Geometry object's vertices array.\n   *   this.vertices.push(v0, v1, v2, v3);\n   *\n   *   // Compute the faces array.\n   *   this.computeFaces();\n   * }\n   * </code>\n   * </div>\n   */\n  computeFaces() {\n    this.faces.length = 0;\n    const sliceCount = this.detailX + 1;\n    let a, b, c, d;\n    for (let i = 0; i < this.detailY; i++) {\n      for (let j = 0; j < this.detailX; j++) {\n        a = i * sliceCount + j; // + offset;\n        b = i * sliceCount + j + 1; // + offset;\n        c = (i + 1) * sliceCount + j + 1; // + offset;\n        d = (i + 1) * sliceCount + j; // + offset;\n        this.faces.push([a, b, d]);\n        this.faces.push([d, b, c]);\n      }\n    }\n    return this;\n  }\n\n  _getFaceNormal(faceId) {\n    //This assumes that vA->vB->vC is a counter-clockwise ordering\n    const face = this.faces[faceId];\n    const vA = this.vertices[face[0]];\n    const vB = this.vertices[face[1]];\n    const vC = this.vertices[face[2]];\n    const ab = Vector.sub(vB, vA);\n    const ac = Vector.sub(vC, vA);\n    const n = Vector.cross(ab, ac);\n    const ln = Vector.mag(n);\n    let sinAlpha = ln / (Vector.mag(ab) * Vector.mag(ac));\n    if (sinAlpha === 0 || isNaN(sinAlpha)) {\n      console.warn(\n        'p5.Geometry.prototype._getFaceNormal:',\n        'face has colinear sides or a repeated vertex'\n      );\n      return n;\n    }\n    if (sinAlpha > 1) sinAlpha = 1; // handle float rounding error\n    return n.mult(Math.asin(sinAlpha) / ln);\n  }\n  /**\n   * Calculates the normal vector for each vertex on the geometry.\n   *\n   * All 3D shapes are made by connecting sets of points called *vertices*. A\n   * geometry's surface is formed by connecting vertices to create triangles\n   * that are stitched together. Each triangular patch on the geometry's\n   * surface is called a *face*. `myGeometry.computeNormals()` performs the\n   * math needed to orient each face. Orientation is important for lighting\n   * and other effects.\n   *\n   * A face's orientation is defined by its *normal vector* which points out\n   * of the face and is normal (perpendicular) to the surface. Calling\n   * `myGeometry.computeNormals()` first calculates each face's normal vector.\n   * Then it calculates the normal vector for each vertex by averaging the\n   * normal vectors of the faces surrounding the vertex. The vertex normals\n   * are stored as <a href=\"#/p5.Vector\">p5.Vector</a> objects in the\n   * <a href=\"#/p5.Geometry/vertexNormals\">myGeometry.vertexNormals</a> array.\n   *\n   * The first parameter, `shadingType`, is optional. Passing the constant\n   * `FLAT`, as in `myGeometry.computeNormals(FLAT)`, provides neighboring\n   * faces with their own copies of the vertices they share. Surfaces appear\n   * tiled with flat shading. Passing the constant `SMOOTH`, as in\n   * `myGeometry.computeNormals(SMOOTH)`, makes neighboring faces reuse their\n   * shared vertices. Surfaces appear smoother with smooth shading. By\n   * default, `shadingType` is `FLAT`.\n   *\n   * The second parameter, `options`, is also optional. If an object with a\n   * `roundToPrecision` property is passed, as in\n   * `myGeometry.computeNormals(SMOOTH, { roundToPrecision: 5 })`, it sets the\n   * number of decimal places to use for calculations. By default,\n   * `roundToPrecision` uses 3 decimal places.\n   *\n   * @param {(FLAT|SMOOTH)} [shadingType=FLAT] shading type. either FLAT or SMOOTH. Defaults to `FLAT`.\n   * @param {Object} [options] shading options.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object.\n   *   myGeometry = buildGeometry(function() {\n   *     torus();\n   *   });\n   *\n   *   // Compute the vertex normals.\n   *   myGeometry.computeNormals();\n   *\n   *   describe(\n   *     \"A white torus drawn on a dark gray background. Red lines extend outward from the torus' vertices.\"\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Rotate the coordinate system.\n   *   rotateX(1);\n   *\n   *   // Style the helix.\n   *   stroke(0);\n   *\n   *   // Display the helix.\n   *   model(myGeometry);\n   *\n   *   // Style the normal vectors.\n   *   stroke(255, 0, 0);\n   *\n   *   // Iterate over the vertices and vertexNormals arrays.\n   *   for (let i = 0; i < myGeometry.vertices.length; i += 1) {\n   *\n   *     // Get the vertex p5.Vector object.\n   *     let v = myGeometry.vertices[i];\n   *\n   *     // Get the vertex normal p5.Vector object.\n   *     let n = myGeometry.vertexNormals[i];\n   *\n   *     // Calculate a point along the vertex normal.\n   *     let p = p5.Vector.mult(n, 5);\n   *\n   *     // Draw the vertex normal as a red line.\n   *     push();\n   *     translate(v);\n   *     line(0, 0, 0, p.x, p.y, p.z);\n   *     pop();\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object using a callback function.\n   *   myGeometry = new p5.Geometry();\n   *\n   *   // Create p5.Vector objects to position the vertices.\n   *   let v0 = createVector(-40, 0, 0);\n   *   let v1 = createVector(0, -40, 0);\n   *   let v2 = createVector(0, 40, 0);\n   *   let v3 = createVector(40, 0, 0);\n   *\n   *   // Add the vertices to the p5.Geometry object's vertices array.\n   *   myGeometry.vertices.push(v0, v1, v2, v3);\n   *\n   *   // Compute the faces array.\n   *   myGeometry.computeFaces();\n   *\n   *   // Compute the surface normals.\n   *   myGeometry.computeNormals();\n   *\n   *   describe('A red square drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Add a white point light.\n   *   pointLight(255, 255, 255, 0, 0, 10);\n   *\n   *   // Style the p5.Geometry object.\n   *   noStroke();\n   *   fill(255, 0, 0);\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(myGeometry);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object.\n   *   myGeometry = buildGeometry(createShape);\n   *\n   *   // Compute normals using default (FLAT) shading.\n   *   myGeometry.computeNormals(FLAT);\n   *\n   *   describe('A white, helical structure drawn on a dark gray background. Its faces appear faceted.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Rotate the coordinate system.\n   *   rotateX(1);\n   *\n   *   // Style the helix.\n   *   noStroke();\n   *\n   *   // Display the helix.\n   *   model(myGeometry);\n   * }\n   *\n   * function createShape() {\n   *   // Create a helical shape.\n   *   beginShape();\n   *   for (let i = 0; i < TWO_PI * 3; i += 0.5) {\n   *     let x = 30 * cos(i);\n   *     let y = 30 * sin(i);\n   *     let z = map(i, 0, TWO_PI * 3, -40, 40);\n   *     vertex(x, y, z);\n   *   }\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object.\n   *   myGeometry = buildGeometry(createShape);\n   *\n   *   // Compute normals using smooth shading.\n   *   myGeometry.computeNormals(SMOOTH);\n   *\n   *   describe('A white, helical structure drawn on a dark gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Rotate the coordinate system.\n   *   rotateX(1);\n   *\n   *   // Style the helix.\n   *   noStroke();\n   *\n   *   // Display the helix.\n   *   model(myGeometry);\n   * }\n   *\n   * function createShape() {\n   *   // Create a helical shape.\n   *   beginShape();\n   *   for (let i = 0; i < TWO_PI * 3; i += 0.5) {\n   *     let x = 30 * cos(i);\n   *     let y = 30 * sin(i);\n   *     let z = map(i, 0, TWO_PI * 3, -40, 40);\n   *     vertex(x, y, z);\n   *   }\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object.\n   *   myGeometry = buildGeometry(createShape);\n   *\n   *   // Create an options object.\n   *   let options = { roundToPrecision: 5 };\n   *\n   *   // Compute normals using smooth shading.\n   *   myGeometry.computeNormals(SMOOTH, options);\n   *\n   *   describe('A white, helical structure drawn on a dark gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Rotate the coordinate system.\n   *   rotateX(1);\n   *\n   *   // Style the helix.\n   *   noStroke();\n   *\n   *   // Display the helix.\n   *   model(myGeometry);\n   * }\n   *\n   * function createShape() {\n   *   // Create a helical shape.\n   *   beginShape();\n   *   for (let i = 0; i < TWO_PI * 3; i += 0.5) {\n   *     let x = 30 * cos(i);\n   *     let y = 30 * sin(i);\n   *     let z = map(i, 0, TWO_PI * 3, -40, 40);\n   *     vertex(x, y, z);\n   *   }\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n  computeNormals(shadingType = FLAT, { roundToPrecision = 3 } = {}) {\n    const vertexNormals = this.vertexNormals;\n    let vertices = this.vertices;\n    const faces = this.faces;\n    let iv;\n\n    if (shadingType === SMOOTH) {\n      const vertexIndices = {};\n      const uniqueVertices = [];\n\n      const power = Math.pow(10, roundToPrecision);\n      const rounded = val => Math.round(val * power) / power;\n      const getKey = vert =>\n        `${rounded(vert.x)},${rounded(vert.y)},${rounded(vert.z)}`;\n\n      // loop through each vertex and add uniqueVertices\n      for (let i = 0; i < vertices.length; i++) {\n        const vertex = vertices[i];\n        const key = getKey(vertex);\n        if (vertexIndices[key] === undefined) {\n          vertexIndices[key] = uniqueVertices.length;\n          uniqueVertices.push(vertex);\n        }\n      }\n\n      // update face indices to use the deduplicated vertex indices\n      faces.forEach(face => {\n        for (let fv = 0; fv < 3; ++fv) {\n          const originalVertexIndex = face[fv];\n          const originalVertex = vertices[originalVertexIndex];\n          const key = getKey(originalVertex);\n          face[fv] = vertexIndices[key];\n        }\n      });\n\n      // update edge indices to use the deduplicated vertex indices\n      this.edges.forEach(edge => {\n        for (let ev = 0; ev < 2; ++ev) {\n          const originalVertexIndex = edge[ev];\n          const originalVertex = vertices[originalVertexIndex];\n          const key = getKey(originalVertex);\n          edge[ev] = vertexIndices[key];\n        }\n      });\n\n      // update the deduplicated vertices\n      this.vertices = vertices = uniqueVertices;\n    }\n\n    // initialize the vertexNormals array with empty vectors\n    vertexNormals.length = 0;\n    for (iv = 0; iv < vertices.length; ++iv) {\n      vertexNormals.push(new Vector());\n    }\n\n    // loop through all the faces adding its normal to the normal\n    // of each of its vertices\n    faces.forEach((face, f) => {\n      const faceNormal = this._getFaceNormal(f);\n\n      // all three vertices get the normal added\n      for (let fv = 0; fv < 3; ++fv) {\n        const vertexIndex = face[fv];\n        vertexNormals[vertexIndex].add(faceNormal);\n      }\n    });\n\n    // normalize the normals\n    for (iv = 0; iv < vertices.length; ++iv) {\n      vertexNormals[iv].normalize();\n    }\n\n    return this;\n  }\n\n  /**\n   * Averages the vertex normals. Used in curved\n   * surfaces\n   * @private\n   * @chainable\n   */\n  averageNormals() {\n    for (let i = 0; i <= this.detailY; i++) {\n      const offset = this.detailX + 1;\n      let temp = Vector.add(\n        this.vertexNormals[i * offset],\n        this.vertexNormals[i * offset + this.detailX]\n      );\n\n      temp = Vector.div(temp, 2);\n      this.vertexNormals[i * offset] = temp;\n      this.vertexNormals[i * offset + this.detailX] = temp;\n    }\n    return this;\n  }\n\n  /**\n   * Averages pole normals.  Used in spherical primitives\n   * @private\n   * @chainable\n   */\n  averagePoleNormals() {\n    //average the north pole\n    let sum = new Vector(0, 0, 0);\n    for (let i = 0; i < this.detailX; i++) {\n      sum.add(this.vertexNormals[i]);\n    }\n    sum = Vector.div(sum, this.detailX);\n\n    for (let i = 0; i < this.detailX; i++) {\n      this.vertexNormals[i] = sum;\n    }\n\n    //average the south pole\n    sum = new Vector(0, 0, 0);\n    for (\n      let i = this.vertices.length - 1;\n      i > this.vertices.length - 1 - this.detailX;\n      i--\n    ) {\n      sum.add(this.vertexNormals[i]);\n    }\n    sum = Vector.div(sum, this.detailX);\n\n    for (\n      let i = this.vertices.length - 1;\n      i > this.vertices.length - 1 - this.detailX;\n      i--\n    ) {\n      this.vertexNormals[i] = sum;\n    }\n    return this;\n  }\n\n  /**\n   * Create a 2D array for establishing stroke connections\n   * @private\n   * @chainable\n   */\n  _makeTriangleEdges() {\n    this.edges.length = 0;\n\n    for (let j = 0; j < this.faces.length; j++) {\n      this.edges.push([this.faces[j][0], this.faces[j][1]]);\n      this.edges.push([this.faces[j][1], this.faces[j][2]]);\n      this.edges.push([this.faces[j][2], this.faces[j][0]]);\n    }\n\n    return this;\n  }\n\n  /**\n   * @example\n   * <div>\n   * <code>\n   * let tetrahedron;\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   describe('A rotating tetrahedron');\n   *\n   *   tetrahedron = new p5.Geometry();\n   *\n   *   // Give each geometry a unique gid\n   *   tetrahedron.gid = 'tetrahedron';\n   *\n   *   // Add four points of the tetrahedron\n   *\n   *   let radius = 50;\n   *   // A 2D triangle:\n   *   tetrahedron.vertices.push(createVector(radius, 0, 0));\n   *   tetrahedron.vertices.push(createVector(radius, 0, 0).rotate(TWO_PI / 3));\n   *   tetrahedron.vertices.push(createVector(radius, 0, 0).rotate(TWO_PI * 2 / 3));\n   *   // Add a tip in the z axis:\n   *   tetrahedron.vertices.push(createVector(0, 0, radius));\n   *\n   *   // Create the four faces by connecting the sets of three points\n   *   tetrahedron.faces.push([0, 1, 2]);\n   *   tetrahedron.faces.push([0, 1, 3]);\n   *   tetrahedron.faces.push([0, 2, 3]);\n   *   tetrahedron.faces.push([1, 2, 3]);\n   *   tetrahedron.makeEdgesFromFaces();\n   * }\n   * function draw() {\n   *   background(200);\n   *   strokeWeight(2);\n   *   orbitControl();\n   *   rotateY(millis() * 0.001);\n   *   model(tetrahedron);\n   * }\n   * </code>\n   * </div>\n   */\n  makeEdgesFromFaces() {\n    this._makeTriangleEdges();\n  }\n\n  /**\n   * Converts each line segment into the vertices and vertex attributes needed\n   * to turn the line into a polygon on screen. This will include:\n   * - Two triangles line segment to create a rectangle\n   * - Two triangles per endpoint to create a stroke cap rectangle. A fragment\n   *   shader is responsible for displaying the appropriate cap style within\n   *   that rectangle.\n   * - Four triangles per join between adjacent line segments, creating a quad on\n   *   either side of the join, perpendicular to the lines. A vertex shader will\n   *   discard the quad in the \"elbow\" of the join, and a fragment shader will\n   *   display the appropriate join style within the remaining quad.\n   *\n   * @private\n   * @chainable\n   */\n  _edgesToVertices() {\n    this.lineVertices.clear();\n    this.lineTangentsIn.clear();\n    this.lineTangentsOut.clear();\n    this.lineSides.clear();\n\n    const potentialCaps = new Map();\n    const connected = new Set();\n    let lastValidDir;\n    for (let i = 0; i < this.edges.length; i++) {\n      const prevEdge = this.edges[i - 1];\n      const currEdge = this.edges[i];\n      const begin = this.vertices[currEdge[0]];\n      const end = this.vertices[currEdge[1]];\n      const prevColor = (this.vertexStrokeColors.length > 0 && prevEdge)\n        ? this.vertexStrokeColors.slice(\n          prevEdge[1] * 4,\n          (prevEdge[1] + 1) * 4\n        )\n        : [0, 0, 0, 0];\n      const fromColor = this.vertexStrokeColors.length > 0\n        ? this.vertexStrokeColors.slice(\n          currEdge[0] * 4,\n          (currEdge[0] + 1) * 4\n        )\n        : [0, 0, 0, 0];\n      const toColor = this.vertexStrokeColors.length > 0\n        ? this.vertexStrokeColors.slice(\n          currEdge[1] * 4,\n          (currEdge[1] + 1) * 4\n        )\n        : [0, 0, 0, 0];\n      const dir = end\n        .copy()\n        .sub(begin)\n        .normalize();\n      const dirOK = dir.magSq() > 0;\n      if (dirOK) {\n        this._addSegment(begin, end, fromColor, toColor, dir);\n      }\n      if (!this.renderer?._simpleLines) {\n        if (i > 0 && prevEdge[1] === currEdge[0]) {\n          if (!connected.has(currEdge[0])) {\n            connected.add(currEdge[0]);\n            potentialCaps.delete(currEdge[0]);\n            // Add a join if this segment shares a vertex with the previous. Skip\n            // actually adding join vertices if either the previous segment or this\n            // one has a length of 0.\n            //\n            // Don't add a join if the tangents point in the same direction, which\n            // would mean the edges line up exactly, and there is no need for a join.\n            if (lastValidDir && dirOK && dir.dot(lastValidDir) < 1 - 1e-8) {\n              this._addJoin(begin, lastValidDir, dir, fromColor);\n            }\n          }\n        } else {\n          // Start a new line\n          if (dirOK && !connected.has(currEdge[0])) {\n            const existingCap = potentialCaps.get(currEdge[0]);\n            if (existingCap) {\n              this._addJoin(\n                begin,\n                existingCap.dir,\n                dir,\n                fromColor\n              );\n              potentialCaps.delete(currEdge[0]);\n              connected.add(currEdge[0]);\n            } else {\n              potentialCaps.set(currEdge[0], {\n                point: begin,\n                dir: dir.copy().mult(-1),\n                color: fromColor\n              });\n            }\n          }\n          if (lastValidDir && !connected.has(prevEdge[1])) {\n            const existingCap = potentialCaps.get(prevEdge[1]);\n            if (existingCap) {\n              this._addJoin(\n                this.vertices[prevEdge[1]],\n                lastValidDir,\n                existingCap.dir.copy().mult(-1),\n                prevColor\n              );\n              potentialCaps.delete(prevEdge[1]);\n              connected.add(prevEdge[1]);\n            } else {\n              // Close off the last segment with a cap\n              potentialCaps.set(prevEdge[1], {\n                point: this.vertices[prevEdge[1]],\n                dir: lastValidDir,\n                color: prevColor\n              });\n            }\n            lastValidDir = undefined;\n          }\n        }\n\n        if (i === this.edges.length - 1 && !connected.has(currEdge[1])) {\n          const existingCap = potentialCaps.get(currEdge[1]);\n          if (existingCap) {\n            this._addJoin(\n              end,\n              dir,\n              existingCap.dir.copy().mult(-1),\n              toColor\n            );\n            potentialCaps.delete(currEdge[1]);\n            connected.add(currEdge[1]);\n          } else {\n            potentialCaps.set(currEdge[1], {\n              point: end,\n              dir,\n              color: toColor\n            });\n          }\n        }\n\n        if (dirOK) {\n          lastValidDir = dir;\n        }\n      }\n    }\n    for (const { point, dir, color } of potentialCaps.values()) {\n      this._addCap(point, dir, color);\n    }\n    return this;\n  }\n\n  /**\n   * Adds the vertices and vertex attributes for two triangles making a rectangle\n   * for a straight line segment. A vertex shader is responsible for picking\n   * proper coordinates on the screen given the centerline positions, the tangent,\n   * and the side of the centerline each vertex belongs to. Sides follow the\n   * following scheme:\n   *\n   *  -1            -1\n   *   o-------------o\n   *   |             |\n   *   o-------------o\n   *   1             1\n   *\n   * @private\n   * @chainable\n   */\n  _addSegment(\n    begin,\n    end,\n    fromColor,\n    toColor,\n    dir\n  ) {\n    const a = begin.array();\n    const b = end.array();\n    const dirArr = dir.array();\n    this.lineSides.push(1, 1, -1, 1, -1, -1);\n    for (const tangents of [this.lineTangentsIn, this.lineTangentsOut]) {\n      for (let i = 0; i < 6; i++) {\n        tangents.push(...dirArr);\n      }\n    }\n    this.lineVertices.push(...a, ...b, ...a, ...b, ...b, ...a);\n    if (!this.renderer?._simpleLines) {\n      this.lineVertexColors.push(\n        ...fromColor,\n        ...toColor,\n        ...fromColor,\n        ...toColor,\n        ...toColor,\n        ...fromColor\n      );\n    }\n    return this;\n  }\n\n  /**\n   * Adds the vertices and vertex attributes for two triangles representing the\n   * stroke cap of a line. A fragment shader is responsible for displaying the\n   * appropriate cap style within the rectangle they make.\n   *\n   * The lineSides buffer will include the following values for the points on\n   * the cap rectangle:\n   *\n   *           -1  -2\n   * -----------o---o\n   *            |   |\n   * -----------o---o\n   *            1   2\n   * @private\n   * @chainable\n   */\n  _addCap(point, tangent, color) {\n    const ptArray = point.array();\n    const tanInArray = tangent.array();\n    const tanOutArray = [0, 0, 0];\n    for (let i = 0; i < 6; i++) {\n      this.lineVertices.push(...ptArray);\n      this.lineTangentsIn.push(...tanInArray);\n      this.lineTangentsOut.push(...tanOutArray);\n      this.lineVertexColors.push(...color);\n    }\n    this.lineSides.push(-1, 2, -2, 1, 2, -1);\n    return this;\n  }\n\n  /**\n   * Adds the vertices and vertex attributes for four triangles representing a\n   * join between two adjacent line segments. This creates a quad on either side\n   * of the shared vertex of the two line segments, with each quad perpendicular\n   * to the lines. A vertex shader will discard all but the quad in the \"elbow\" of\n   * the join, and a fragment shader will display the appropriate join style\n   * within the remaining quad.\n   *\n   * The lineSides buffer will include the following values for the points on\n   * the join rectangles:\n   *\n   *            -1     -2\n   * -------------o----o\n   *              |    |\n   *       1 o----o----o -3\n   *         |    | 0  |\n   * --------o----o    |\n   *        2|    3    |\n   *         |         |\n   *         |         |\n   * @private\n   * @chainable\n   */\n  _addJoin(\n    point,\n    fromTangent,\n    toTangent,\n    color\n  ) {\n    const ptArray = point.array();\n    const tanInArray = fromTangent.array();\n    const tanOutArray = toTangent.array();\n    for (let i = 0; i < 12; i++) {\n      this.lineVertices.push(...ptArray);\n      this.lineTangentsIn.push(...tanInArray);\n      this.lineTangentsOut.push(...tanOutArray);\n      this.lineVertexColors.push(...color);\n    }\n    this.lineSides.push(-1, -3, -2, -1, 0, -3);\n    this.lineSides.push(3, 1, 2, 3, 0, 1);\n    return this;\n  }\n\n  /**\n   * Transforms the geometry's vertices to fit snugly within a 100100100 box\n   * centered at the origin.\n   *\n   * Calling `myGeometry.normalize()` translates the geometry's vertices so that\n   * they're centered at the origin `(0, 0, 0)`. Then it scales the vertices so\n   * that they fill a 100100100 box. As a result, small geometries will grow\n   * and large geometries will shrink.\n   *\n   * Note: `myGeometry.normalize()` only works when called in the\n   * <a href=\"#/p5/setup\">setup()</a> function.\n   *\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a very small torus.\n   *   myGeometry = buildGeometry(function() {;\n   *     torus(1, 0.25);\n   *   });\n   *\n   *   // Normalize the torus so its vertices fill\n   *   // the range [-100, 100].\n   *   myGeometry.normalize();\n   *\n   *   describe('A white torus rotates slowly against a dark gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Style the torus.\n   *   noStroke();\n   *\n   *   // Draw the torus.\n   *   model(myGeometry);\n   * }\n   * </code>\n   * </div>\n   */\n  normalize() {\n    if (this.vertices.length > 0) {\n      // Find the corners of our bounding box\n      const maxPosition = this.vertices[0].copy();\n      const minPosition = this.vertices[0].copy();\n\n      for (let i = 0; i < this.vertices.length; i++) {\n        maxPosition.x = Math.max(maxPosition.x, this.vertices[i].x);\n        minPosition.x = Math.min(minPosition.x, this.vertices[i].x);\n        maxPosition.y = Math.max(maxPosition.y, this.vertices[i].y);\n        minPosition.y = Math.min(minPosition.y, this.vertices[i].y);\n        maxPosition.z = Math.max(maxPosition.z, this.vertices[i].z);\n        minPosition.z = Math.min(minPosition.z, this.vertices[i].z);\n      }\n\n      const center = Vector.lerp(maxPosition, minPosition, 0.5);\n      const dist = Vector.sub(maxPosition, minPosition);\n      const longestDist = Math.max(Math.max(dist.x, dist.y), dist.z);\n      const scale = 200 / longestDist;\n\n      for (let i = 0; i < this.vertices.length; i++) {\n        this.vertices[i].sub(center);\n        this.vertices[i].mult(scale);\n      }\n    }\n    return this;\n  }\n\n  /** Sets the shader's vertex property or attribute variables.\n   *\n   * A vertex property, or vertex attribute, is a variable belonging to a vertex in a shader. p5.js provides some\n   * default properties, such as `aPosition`, `aNormal`, `aVertexColor`, etc. These are\n   * set using <a href=\"#/p5/vertex\">vertex()</a>, <a href=\"#/p5/normal\">normal()</a>\n   * and <a href=\"#/p5/fill\">fill()</a> respectively. Custom properties can also\n   * be defined within <a href=\"#/p5/beginShape\">beginShape()</a> and\n   * <a href=\"#/p5/endShape\">endShape()</a>.\n   *\n   * The first parameter, `propertyName`, is a string with the property's name.\n   * This is the same variable name which should be declared in the shader, as in\n   * `in vec3 aProperty`, similar to .`setUniform()`.\n   *\n   * The second parameter, `data`, is the value assigned to the shader variable. This value\n   * will be pushed directly onto the Geometry object. There should be the same number\n   * of custom property values as vertices, this method should be invoked once for each\n   * vertex.\n   *\n   * The `data` can be a Number or an array of numbers. Tn the shader program the type\n   * can be declared according to the WebGL specification. Common types include `float`,\n   * `vec2`, `vec3`, `vec4` or matrices.\n   *\n   * See also the global <a href=\"#/p5/vertexProperty\">vertexProperty()</a> function.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let geo;\n   *\n   * function cartesianToSpherical(x, y, z) {\n   *   let r = sqrt(pow(x, 2) + pow(y, 2) + pow(z, 2));\n   *   let theta = acos(z / r);\n   *   let phi = atan2(y, x);\n   *   return { theta, phi };\n   * }\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Modify the material shader to display roughness.\n   *   const myShader = baseMaterialShader().modify({\n   *     vertexDeclarations:`in float aRoughness;\n   *                         out float vRoughness;`,\n   *     fragmentDeclarations: 'in float vRoughness;',\n   *     'void afterVertex': `() {\n   *         vRoughness = aRoughness;\n   *     }`,\n   *     'vec4 combineColors': `(ColorComponents components) {\n   *             vec4 color = vec4(0.);\n   *             color.rgb += components.diffuse * components.baseColor * (1.0-vRoughness);\n   *             color.rgb += components.ambient * components.ambientColor;\n   *             color.rgb += components.specular * components.specularColor * (1.0-vRoughness);\n   *             color.a = components.opacity;\n   *             return color;\n   *     }`\n   *   });\n   *\n   *   // Create the Geometry object.\n   *   geo = buildGeometry(function() {\n   *     fill('hotpink');\n   *     sphere(45, 50, 50);\n   *   });\n   *\n   *   // Set the roughness value for every vertex.\n   *   for (let v of geo.vertices){\n   *\n   *     // convert coordinates to spherical coordinates\n   *     let spherical = cartesianToSpherical(v.x, v.y, v.z);\n   *\n   *     // Set the custom roughness vertex property.\n   *     let roughness = noise(spherical.theta*5, spherical.phi*5);\n   *     geo.vertexProperty('aRoughness', roughness);\n   *   }\n   *\n   *   // Use the custom shader.\n   *   shader(myShader);\n   *\n   *   describe('A rough pink sphere rotating on a blue background.');\n   * }\n   *\n   * function draw() {\n   *   // Set some styles and lighting\n   *   background('lightblue');\n   *   noStroke();\n   *\n   *   specularMaterial(255,125,100);\n   *   shininess(2);\n   *\n   *   directionalLight('white', -1, 1, -1);\n   *   ambientLight(320);\n   *\n   *   rotateY(millis()*0.001);\n   *\n   *   // Draw the geometry\n   *   model(geo);\n   * }\n   * </code>\n   * </div>\n   *\n   * @param {String} propertyName the name of the vertex property.\n   * @param {Number|Number[]} data the data tied to the vertex property.\n   * @param {Number} [size] optional size of each unit of data.\n   */\n  vertexProperty(propertyName, data, size){\n    let prop;\n    if (!this.userVertexProperties[propertyName]){\n      prop = this.userVertexProperties[propertyName] =\n        this._userVertexPropertyHelper(propertyName, data, size);\n    }\n    prop = this.userVertexProperties[propertyName];\n    if (size){\n      prop.pushDirect(data);\n    } else {\n      prop.setCurrentData(data);\n      prop.pushCurrentData();\n    }\n  }\n\n  _userVertexPropertyHelper(propertyName, data, size){\n    const geometryInstance = this;\n    const prop = this.userVertexProperties[propertyName] = {\n      name: propertyName,\n      dataSize: size ? size : data.length ? data.length : 1,\n      geometry: geometryInstance,\n      // Getters\n      getName(){\n        return this.name;\n      },\n      getCurrentData(){\n        if (this.currentData === undefined) {\n          this.currentData = new Array(this.getDataSize()).fill(0);\n        }\n        return this.currentData;\n      },\n      getDataSize() {\n        return this.dataSize;\n      },\n      getSrcName() {\n        const src = this.name.concat('Src');\n        return src;\n      },\n      getDstName() {\n        const dst = this.name.concat('Buffer');\n        return dst;\n      },\n      getSrcArray() {\n        const srcName = this.getSrcName();\n        return this.geometry[srcName];\n      },\n      //Setters\n      setCurrentData(data) {\n        data.length ? data.length : 1;\n        // if (size != this.getDataSize()){\n        //   p5._friendlyError(`Custom vertex property '${this.name}' has been set with various data sizes. You can change it's name, or if it was an accident, set '${this.name}' to have the same number of inputs each time!`, 'vertexProperty()');\n        // }\n        this.currentData = data;\n      },\n      // Utilities\n      pushCurrentData(){\n        const data = this.getCurrentData();\n        this.pushDirect(data);\n      },\n      pushDirect(data) {\n        if (data.length){\n          this.getSrcArray().push(...data);\n        } else {\n          this.getSrcArray().push(data);\n        }\n      },\n      resetSrcArray(){\n        this.geometry[this.getSrcName()] = [];\n      },\n      delete() {\n        const srcName = this.getSrcName();\n        delete this.geometry[srcName];\n        delete this;\n      }\n    };\n    this[prop.getSrcName()] = [];\n    return this.userVertexProperties[propertyName];\n  }\n}\n/**\n * Keeps track of how many custom geometry objects have been made so that each\n * can be assigned a unique ID.\n */\nGeometry.nextId = 0;\n\nfunction geometry(p5, fn){\n  /**\n   * A class to describe a 3D shape.\n   *\n   * Each `p5.Geometry` object represents a 3D shape as a set of connected\n   * points called *vertices*. All 3D shapes are made by connecting vertices to\n   * form triangles that are stitched together. Each triangular patch on the\n   * geometry's surface is called a *face*. The geometry stores information\n   * about its vertices and faces for use with effects such as lighting and\n   * texture mapping.\n   *\n   * The first parameter, `detailX`, is optional. If a number is passed, as in\n   * `new p5.Geometry(24)`, it sets the number of triangle subdivisions to use\n   * along the geometry's x-axis. By default, `detailX` is 1.\n   *\n   * The second parameter, `detailY`, is also optional. If a number is passed,\n   * as in `new p5.Geometry(24, 16)`, it sets the number of triangle\n   * subdivisions to use along the geometry's y-axis. By default, `detailX` is\n   * 1.\n   *\n   * The third parameter, `callback`, is also optional. If a function is passed,\n   * as in `new p5.Geometry(24, 16, createShape)`, it will be called once to add\n   * vertices to the new 3D shape.\n   *\n   * @class p5.Geometry\n   * @param  {Integer} [detailX] number of vertices along the x-axis.\n   * @param  {Integer} [detailY] number of vertices along the y-axis.\n   * @param {function} [callback] function to call once the geometry is created.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object.\n   *   myGeometry = new p5.Geometry();\n   *\n   *   // Create p5.Vector objects to position the vertices.\n   *   let v0 = createVector(-40, 0, 0);\n   *   let v1 = createVector(0, -40, 0);\n   *   let v2 = createVector(40, 0, 0);\n   *\n   *   // Add the vertices to the p5.Geometry object's vertices array.\n   *   myGeometry.vertices.push(v0, v1, v2);\n   *\n   *   describe('A white triangle drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(myGeometry);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object using a callback function.\n   *   myGeometry = new p5.Geometry(1, 1, createShape);\n   *\n   *   describe('A white triangle drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(myGeometry);\n   * }\n   *\n   * function createShape() {\n   *   // Create p5.Vector objects to position the vertices.\n   *   let v0 = createVector(-40, 0, 0);\n   *   let v1 = createVector(0, -40, 0);\n   *   let v2 = createVector(40, 0, 0);\n   *\n   *   // \"this\" refers to the p5.Geometry object being created.\n   *\n   *   // Add the vertices to the p5.Geometry object's vertices array.\n   *   this.vertices.push(v0, v1, v2);\n   *\n   *   // Add an array to list which vertices belong to the face.\n   *   // Vertices are listed in clockwise \"winding\" order from\n   *   // left to top to right.\n   *   this.faces.push([0, 1, 2]);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object using a callback function.\n   *   myGeometry = new p5.Geometry(1, 1, createShape);\n   *\n   *   describe('A white triangle drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(myGeometry);\n   * }\n   *\n   * function createShape() {\n   *   // Create p5.Vector objects to position the vertices.\n   *   let v0 = createVector(-40, 0, 0);\n   *   let v1 = createVector(0, -40, 0);\n   *   let v2 = createVector(40, 0, 0);\n   *\n   *   // \"this\" refers to the p5.Geometry object being created.\n   *\n   *   // Add the vertices to the p5.Geometry object's vertices array.\n   *   this.vertices.push(v0, v1, v2);\n   *\n   *   // Add an array to list which vertices belong to the face.\n   *   // Vertices are listed in clockwise \"winding\" order from\n   *   // left to top to right.\n   *   this.faces.push([0, 1, 2]);\n   *\n   *   // Compute the surface normals to help with lighting.\n   *   this.computeNormals();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * // Adapted from Paul Wheeler's wonderful p5.Geometry tutorial.\n   * // https://www.paulwheeler.us/articles/custom-3d-geometry-in-p5js/\n   * // CC-BY-SA 4.0\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the p5.Geometry object.\n   *   // Set detailX to 48 and detailY to 2.\n   *   // >>> try changing them.\n   *   myGeometry = new p5.Geometry(48, 2, createShape);\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the p5.Geometry object.\n   *   strokeWeight(0.2);\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(myGeometry);\n   * }\n   *\n   * function createShape() {\n   *   // \"this\" refers to the p5.Geometry object being created.\n   *\n   *   // Define the Mbius strip with a few parameters.\n   *   let spread = 0.1;\n   *   let radius = 30;\n   *   let stripWidth = 15;\n   *   let xInterval = 4 * PI / this.detailX;\n   *   let yOffset = -stripWidth / 2;\n   *   let yInterval = stripWidth / this.detailY;\n   *\n   *   for (let j = 0; j <= this.detailY; j += 1) {\n   *     // Calculate the \"vertical\" point along the strip.\n   *     let v = yOffset + yInterval * j;\n   *\n   *     for (let i = 0; i <= this.detailX; i += 1) {\n   *       // Calculate the angle of rotation around the strip.\n   *       let u = i * xInterval;\n   *\n   *       // Calculate the coordinates of the vertex.\n   *       let x = (radius + v * cos(u / 2)) * cos(u) - sin(u / 2) * 2 * spread;\n   *       let y = (radius + v * cos(u / 2)) * sin(u);\n   *       if (u < TWO_PI) {\n   *         y += sin(u) * spread;\n   *       } else {\n   *         y -= sin(u) * spread;\n   *       }\n   *       let z = v * sin(u / 2) + sin(u / 4) * 4 * spread;\n   *\n   *       // Create a p5.Vector object to position the vertex.\n   *       let vert = createVector(x, y, z);\n   *\n   *       // Add the vertex to the p5.Geometry object's vertices array.\n   *       this.vertices.push(vert);\n   *     }\n   *   }\n   *\n   *   // Compute the faces array.\n   *   this.computeFaces();\n   *\n   *   // Compute the surface normals to help with lighting.\n   *   this.computeNormals();\n   * }\n   * </code>\n   * </div>\n   */\n  p5.Geometry = Geometry;\n\n  /**\n   * An array with the geometry's vertices.\n   *\n   * The geometry's vertices are stored as\n   * <a href=\"#/p5.Vector\">p5.Vector</a> objects in the `myGeometry.vertices`\n   * array. The geometry's first vertex is the\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object at `myGeometry.vertices[0]`,\n   * its second vertex is `myGeometry.vertices[1]`, its third vertex is\n   * `myGeometry.vertices[2]`, and so on.\n   *\n   * @property vertices\n   * @for p5.Geometry\n   * @name vertices\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object.\n   *   myGeometry = new p5.Geometry();\n   *\n   *   // Create p5.Vector objects to position the vertices.\n   *   let v0 = createVector(-40, 0, 0);\n   *   let v1 = createVector(0, -40, 0);\n   *   let v2 = createVector(40, 0, 0);\n   *\n   *   // Add the vertices to the p5.Geometry object's vertices array.\n   *   myGeometry.vertices.push(v0, v1, v2);\n   *\n   *   describe('A white triangle drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(myGeometry);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object.\n   *   myGeometry = buildGeometry(function() {\n   *     torus(30, 15, 10, 8);\n   *   });\n   *\n   *   describe('A white torus rotates slowly against a dark gray background. Red spheres mark its vertices.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Style the p5.Geometry object.\n   *   fill(255);\n   *   stroke(0);\n   *\n   *   // Display the p5.Geometry object.\n   *   model(myGeometry);\n   *\n   *   // Style the vertices.\n   *   fill(255, 0, 0);\n   *   noStroke();\n   *\n   *   // Iterate over the vertices array.\n   *   for (let v of myGeometry.vertices) {\n   *     // Draw a sphere to mark the vertex.\n   *     push();\n   *     translate(v);\n   *     sphere(2.5);\n   *     pop();\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * An array with the vectors that are normal to the geometry's vertices.\n   *\n   * A face's orientation is defined by its *normal vector* which points out\n   * of the face and is normal (perpendicular) to the surface. Calling\n   * `myGeometry.computeNormals()` first calculates each face's normal\n   * vector. Then it calculates the normal vector for each vertex by\n   * averaging the normal vectors of the faces surrounding the vertex. The\n   * vertex normals are stored as <a href=\"#/p5.Vector\">p5.Vector</a>\n   * objects in the `myGeometry.vertexNormals` array.\n   *\n   * @property vertexNormals\n   * @name vertexNormals\n   * @for p5.Geometry\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object.\n   *   myGeometry = buildGeometry(function() {\n   *     torus(30, 15, 10, 8);\n   *   });\n   *\n   *   // Compute the vertex normals.\n   *   myGeometry.computeNormals();\n   *\n   *   describe(\n   *     'A white torus rotates against a dark gray background. Red lines extend outward from its vertices.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Style the p5.Geometry object.\n   *   stroke(0);\n   *\n   *   // Display the p5.Geometry object.\n   *   model(myGeometry);\n   *\n   *   // Style the normal vectors.\n   *   stroke(255, 0, 0);\n   *\n   *   // Iterate over the vertices and vertexNormals arrays.\n   *   for (let i = 0; i < myGeometry.vertices.length; i += 1) {\n   *\n   *     // Get the vertex p5.Vector object.\n   *     let v = myGeometry.vertices[i];\n   *\n   *     // Get the vertex normal p5.Vector object.\n   *     let n = myGeometry.vertexNormals[i];\n   *\n   *     // Calculate a point along the vertex normal.\n   *     let p = p5.Vector.mult(n, 8);\n   *\n   *     // Draw the vertex normal as a red line.\n   *     push();\n   *     translate(v);\n   *     line(0, 0, 0, p.x, p.y, p.z);\n   *     pop();\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object.\n   *   myGeometry = new p5.Geometry();\n   *\n   *   // Create p5.Vector objects to position the vertices.\n   *   let v0 = createVector(-40, 0, 0);\n   *   let v1 = createVector(0, -40, 0);\n   *   let v2 = createVector(0, 40, 0);\n   *   let v3 = createVector(40, 0, 0);\n   *\n   *   // Add the vertices to the p5.Geometry object's vertices array.\n   *   myGeometry.vertices.push(v0, v1, v2, v3);\n   *\n   *   // Compute the faces array.\n   *   myGeometry.computeFaces();\n   *\n   *   // Compute the surface normals.\n   *   myGeometry.computeNormals();\n   *\n   *   describe('A red square drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Add a white point light.\n   *   pointLight(255, 255, 255, 0, 0, 10);\n   *\n   *   // Style the p5.Geometry object.\n   *   noStroke();\n   *   fill(255, 0, 0);\n   *\n   *   // Display the p5.Geometry object.\n   *   model(myGeometry);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * An array that lists which of the geometry's vertices form each of its\n   * faces.\n   *\n   * All 3D shapes are made by connecting sets of points called *vertices*. A\n   * geometry's surface is formed by connecting vertices to form triangles\n   * that are stitched together. Each triangular patch on the geometry's\n   * surface is called a *face*.\n   *\n   * The geometry's vertices are stored as\n   * <a href=\"#/p5.Vector\">p5.Vector</a> objects in the\n   * <a href=\"#/p5.Geometry/vertices\">myGeometry.vertices</a> array. The\n   * geometry's first vertex is the <a href=\"#/p5.Vector\">p5.Vector</a>\n   * object at `myGeometry.vertices[0]`, its second vertex is\n   * `myGeometry.vertices[1]`, its third vertex is `myGeometry.vertices[2]`,\n   * and so on.\n   *\n   * For example, a geometry made from a rectangle has two faces because a\n   * rectangle is made by joining two triangles. `myGeometry.faces` for a\n   * rectangle would be the two-dimensional array `[[0, 1, 2], [2, 1, 3]]`.\n   * The first face, `myGeometry.faces[0]`, is the array `[0, 1, 2]` because\n   * it's formed by connecting `myGeometry.vertices[0]`,\n   * `myGeometry.vertices[1]`,and `myGeometry.vertices[2]`. The second face,\n   * `myGeometry.faces[1]`, is the array `[2, 1, 3]` because it's formed by\n   * connecting `myGeometry.vertices[2]`, `myGeometry.vertices[1]`,and\n   * `myGeometry.vertices[3]`.\n   *\n   * @property faces\n   * @name faces\n   * @for p5.Geometry\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let myGeometry;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Geometry object.\n   *   myGeometry = buildGeometry(function() {\n   *     sphere();\n   *   });\n   *\n   *   describe(\"A sphere drawn on a gray background. The sphere's surface is a grayscale patchwork of triangles.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the p5.Geometry object.\n   *   noStroke();\n   *\n   *   // Set a random seed.\n   *   randomSeed(1234);\n   *\n   *   // Iterate over the faces array.\n   *   for (let face of myGeometry.faces) {\n   *\n   *     // Style the face.\n   *     let g = random(0, 255);\n   *     fill(g);\n   *\n   *     // Draw the face.\n   *     beginShape();\n   *     // Iterate over the vertices that form the face.\n   *     for (let f of face) {\n   *       // Get the vertex's p5.Vector object.\n   *       let v = myGeometry.vertices[f];\n   *       vertex(v.x, v.y, v.z);\n   *     }\n   *     endShape();\n   *\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * An array that lists the texture coordinates for each of the geometry's\n   * vertices.\n   *\n   * In order for <a href=\"#/p5/texture\">texture()</a> to work, the geometry\n   * needs a way to map the points on its surface to the pixels in a\n   * rectangular image that's used as a texture. The geometry's vertex at\n   * coordinates `(x, y, z)` maps to the texture image's pixel at coordinates\n   * `(u, v)`.\n   *\n   * The `myGeometry.uvs` array stores the `(u, v)` coordinates for each\n   * vertex in the order it was added to the geometry. For example, the\n   * first vertex, `myGeometry.vertices[0]`, has its `(u, v)` coordinates\n   * stored at `myGeometry.uvs[0]` and `myGeometry.uvs[1]`.\n   *\n   * @property uvs\n   * @name uvs\n   * @for p5.Geometry\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   img = await loadImage('assets/laDefense.jpg');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Create p5.Geometry objects.\n   *   let geom1 = buildGeometry(createShape);\n   *   let geom2 = buildGeometry(createShape);\n   *\n   *   // Left (original).\n   *   push();\n   *   translate(-25, 0, 0);\n   *   texture(img);\n   *   noStroke();\n   *   model(geom1);\n   *   pop();\n   *\n   *   // Set geom2's texture coordinates.\n   *   geom2.uvs = [0.25, 0.25, 0.75, 0.25, 0.25, 0.75, 0.75, 0.75];\n   *\n   *   // Right (zoomed in).\n   *   push();\n   *   translate(25, 0, 0);\n   *   texture(img);\n   *   noStroke();\n   *   model(geom2);\n   *   pop();\n   *\n   *   describe(\n   *     'Two photos of a ceiling on a gray background. The photo on the right zooms in to the center of the photo.'\n   *   );\n   * }\n   *\n   * function createShape() {\n   *   plane(40);\n   * }\n   * </code>\n   * </div>\n   */\n}\n\nif(typeof p5 !== 'undefined'){\n  geometry(p5, p5.prototype);\n}\n\nexport { Geometry, geometry as default };\n","import { r as TRIANGLE_STRIP, s as QUAD_STRIP, q as TRIANGLE_FAN } from '../constants-8IpwyBct.js';\nimport '../math/p5.Matrix.js';\nimport { Geometry } from './p5.Geometry.js';\nimport { Matrix } from '../math/Matrices/Matrix.js';\nimport '../math/p5.Vector.js';\nimport '../math/Matrices/MatrixInterface.js';\nimport './p5.DataArray.js';\nimport '../io/utilities.js';\nimport 'file-saver';\n\n/**\n * @private\n * A class responsible for converting successive WebGL draw calls into a single\n * `p5.Geometry` that can be reused and drawn with `model()`.\n */\nclass GeometryBuilder {\n  constructor(renderer) {\n    this.renderer = renderer;\n    renderer._pInst.push();\n    this.identityMatrix = new Matrix(4);\n    renderer.states.setValue('uModelMatrix', new Matrix(4));\n    this.geometry = new Geometry(undefined, undefined, undefined, this.renderer);\n    this.geometry.gid = `_p5_GeometryBuilder_${GeometryBuilder.nextGeometryId}`;\n    GeometryBuilder.nextGeometryId++;\n    this.hasTransform = false;\n  }\n\n  /**\n   * @private\n   * Applies the current transformation matrix to each vertex.\n   */\n  transformVertices(vertices) {\n    if (!this.hasTransform) return vertices;\n\n    return vertices.map(v => this.renderer.states.uModelMatrix.multiplyPoint(v));\n  }\n\n  /**\n   * @private\n   * Applies the current normal matrix to each normal.\n   */\n  transformNormals(normals) {\n    if (!this.hasTransform) return normals;\n\n    return normals.map(\n      v => this.renderer.scratchMat3.multiplyVec(v) // this is a vec3\n    );\n  }\n\n  /**\n   * @private\n   * Adds a p5.Geometry to the builder's combined geometry, flattening\n   * transformations.\n   */\n  addGeometry(input) {\n    this.hasTransform = !this.renderer.states.uModelMatrix.mat4\n      .every((v, i) => v === this.identityMatrix.mat4[i]);\n\n    if (this.hasTransform) {\n      this.renderer.scratchMat3.inverseTranspose4x4(this.renderer.states.uModelMatrix);\n    }\n\n    let startIdx = this.geometry.vertices.length;\n    this.geometry.vertices.push(...this.transformVertices(input.vertices));\n    this.geometry.vertexNormals.push(\n      ...this.transformNormals(input.vertexNormals)\n    );\n    this.geometry.uvs.push(...input.uvs);\n\n    const inputUserVertexProps = input.userVertexProperties;\n    const builtUserVertexProps = this.geometry.userVertexProperties;\n    const numPreviousVertices = this.geometry.vertices.length - input.vertices.length;\n\n    for (const propName in builtUserVertexProps){\n      if (propName in inputUserVertexProps){\n        continue;\n      }\n      const prop = builtUserVertexProps[propName];\n      const size = prop.getDataSize();\n      const numMissingValues = size * input.vertices.length;\n      const missingValues = Array(numMissingValues).fill(0);\n      prop.pushDirect(missingValues);\n    }\n    for (const propName in inputUserVertexProps){\n      const prop = inputUserVertexProps[propName];\n      const data = prop.getSrcArray();\n      const size = prop.getDataSize();\n      if (numPreviousVertices > 0 && !(propName in builtUserVertexProps)){\n        const numMissingValues = size * numPreviousVertices;\n        const missingValues = Array(numMissingValues).fill(0);\n        this.geometry.vertexProperty(propName, missingValues, size);\n      }\n      this.geometry.vertexProperty(propName, data, size);\n    }\n\n    if (this.renderer.states.fillColor) {\n      this.geometry.faces.push(\n        ...input.faces.map(f => f.map(idx => idx + startIdx))\n      );\n    }\n    if (this.renderer.states.strokeColor) {\n      this.geometry.edges.push(\n        ...input.edges.map(edge => edge.map(idx => idx + startIdx))\n      );\n    }\n    const vertexColors = [...input.vertexColors];\n    while (vertexColors.length < input.vertices.length * 4) {\n      vertexColors.push(...this.renderer.states.curFillColor);\n    }\n    this.geometry.vertexColors.push(...vertexColors);\n  }\n\n  /**\n   * Adds geometry from the renderer's immediate mode into the builder's\n   * combined geometry.\n   */\n  addImmediate(geometry, shapeMode, { validateFaces = false } = {}) {\n    const faces = [];\n\n    if (this.renderer.states.fillColor) {\n      if (\n        shapeMode === TRIANGLE_STRIP ||\n        shapeMode === QUAD_STRIP\n      ) {\n        for (let i = 2; i < geometry.vertices.length; i++) {\n          if (i % 2 === 0) {\n            faces.push([i, i - 1, i - 2]);\n          } else {\n            faces.push([i, i - 2, i - 1]);\n          }\n        }\n      } else if (shapeMode === TRIANGLE_FAN) {\n        for (let i = 2; i < geometry.vertices.length; i++) {\n          faces.push([0, i - 1, i]);\n        }\n      } else {\n        for (let i = 0; i < geometry.vertices.length; i += 3) {\n          if (\n            !validateFaces ||\n            geometry.vertices[i].copy().sub(geometry.vertices[i+1])\n              .cross(geometry.vertices[i].copy().sub(geometry.vertices[i+2]))\n              .magSq() > 0\n          ) {\n            faces.push([i, i + 1, i + 2]);\n          }\n        }\n      }\n    }\n    this.addGeometry(Object.assign({}, geometry, { faces }));\n  }\n\n  /**\n   * Adds geometry from the renderer's retained mode into the builder's\n   * combined geometry.\n   */\n  addRetained(geometry) {\n    this.addGeometry(geometry);\n  }\n\n  /**\n   * Cleans up the state of the renderer and returns the combined geometry that\n   * was built.\n   * @returns p5.Geometry The flattened, combined geometry\n   */\n  finish() {\n    this.renderer._pInst.pop();\n    return this.geometry;\n  }\n}\n\n/**\n * Keeps track of how many custom geometry objects have been made so that each\n * can be assigned a unique ID.\n */\nGeometryBuilder.nextGeometryId = 0;\n\nexport { GeometryBuilder as default };\n","import { Vector } from '../math/p5.Vector.js';\nimport '../constants-8IpwyBct.js';\n\n/**\n * @module Math\n * @submodule Quaternion\n */\n\n\nclass Quat {\n  constructor(w, x, y, z) {\n    this.w = w;\n    this.vec = new Vector(x, y, z);\n  }\n\n  /**\n     * Returns a Quaternion for the\n     * axis angle representation of the rotation\n     *\n     * @method fromAxisAngle\n     * @param {Number} [angle] Angle with which the points needs to be rotated\n     * @param {Number} [x] x component of the axis vector\n     * @param {Number} [y] y component of the axis vector\n     * @param {Number} [z] z component of the axis vector\n     * @chainable\n    */\n  static fromAxisAngle(angle, x, y, z) {\n    const w = Math.cos(angle/2);\n    const vec = new Vector(x, y, z).normalize().mult(Math.sin(angle/2));\n    return new Quat(w, vec.x, vec.y, vec.z);\n  }\n\n  conjugate() {\n    return new Quat(this.w, -this.vec.x, -this.vec.y, -this.vec.z);\n  }\n\n  /**\n     * Multiplies a quaternion with other quaternion.\n     * @method mult\n     * @param  {p5.Quat} [quat] quaternion to multiply with the quaternion calling the method.\n     * @chainable\n     */\n  multiply(quat) {\n    /* eslint-disable max-len */\n    return new Quat(\n      this.w * quat.w - this.vec.x * quat.vec.x - this.vec.y * quat.vec.y - this.vec.z - quat.vec.z,\n      this.w * quat.vec.x + this.vec.x * quat.w + this.vec.y * quat.vec.z - this.vec.z * quat.vec.y,\n      this.w * quat.vec.y - this.vec.x * quat.vec.z + this.vec.y * quat.w + this.vec.z * quat.vec.x,\n      this.w * quat.vec.z + this.vec.x * quat.vec.y - this.vec.y * quat.vec.x + this.vec.z * quat.w\n    );\n    /* eslint-enable max-len */\n  }\n\n  /**\n   * This is similar to quaternion multiplication\n   * but when multipying vector with quaternion\n   * the multiplication can be simplified to the below formula.\n   * This was taken from the below stackexchange link\n   * https://gamedev.stackexchange.com/questions/28395/rotating-vector3-by-a-quaternion/50545#50545\n   * @param {p5.Vector} [p] vector to rotate on the axis quaternion\n   */\n  rotateVector(p) {\n    return Vector.mult( p, this.w*this.w - this.vec.dot(this.vec) )\n      .add( Vector.mult( this.vec, 2 * p.dot(this.vec) ) )\n      .add( Vector.mult( this.vec, 2 * this.w ).cross( p ) )\n      .clampToZero();\n  }\n\n  /**\n     * Rotates the Quaternion by the quaternion passed\n     * which contains the axis of roation and angle of rotation\n     *\n     * @method rotateBy\n     * @param {p5.Quat} [axesQuat] axis quaternion which contains\n     *  the axis of rotation and angle of rotation\n     * @chainable\n     */\n  rotateBy(axesQuat) {\n    return axesQuat.multiply(this).multiply(axesQuat.conjugate()).\n      vec.clampToZero();\n  }\n}\n\nfunction quat(p5, fn){\n  /**\n   * A class to describe a Quaternion\n   * for vector rotations in the p5js webgl renderer.\n   * Please refer the following link for details on the implementation\n   * https://danceswithcode.net/engineeringnotes/quaternions/quaternions.html\n   * @class p5.Quat\n   * @constructor\n   * @param {Number} [w] Scalar part of the quaternion\n   * @param {Number} [x] x component of imaginary part of quaternion\n   * @param {Number} [y] y component of imaginary part of quaternion\n   * @param {Number} [z] z component of imaginary part of quaternion\n   * @private\n   */\n  p5.Quat = Quat;\n}\n\nif(typeof p5 !== 'undefined'){\n  quat(p5, p5.prototype);\n}\n\nexport { Quat, quat as default };\n","class RenderBuffer {\n  constructor(size, src, dst, attr, renderer, map) {\n    this.size = size; // the number of FLOATs in each vertex\n    this.src = src; // the name of the model's source array\n    this.dst = dst; // the name of the geometry's buffer\n    this.attr = attr; // the name of the vertex attribute\n    this._renderer = renderer;\n    this.map = map; // optional, a transformation function to apply to src\n  }\n\n  /**\n   * Enables and binds the buffers used by shader when the appropriate data exists in geometry.\n   * Must always be done prior to drawing geometry in WebGL.\n   * @param {p5.Geometry} geometry Geometry that is going to be drawn\n   * @param {p5.Shader} shader Active shader\n   * @private\n   */\n  _prepareBuffer(geometry, shader) {\n    const attributes = shader.attributes;\n    const gl = this._renderer.GL;\n    const glBuffers = this._renderer._getOrMakeCachedBuffers(geometry);\n\n    // loop through each of the buffer definitions\n    const attr = attributes[this.attr];\n    if (!attr) {\n      return;\n    }\n    // check if the geometry has the appropriate source array\n    let buffer = glBuffers[this.dst];\n    const src = geometry[this.src];\n    if (src && src.length > 0) {\n      // check if we need to create the GL buffer\n      const createBuffer = !buffer;\n      if (createBuffer) {\n        // create and remember the buffer\n        glBuffers[this.dst] = buffer = gl.createBuffer();\n      }\n      // bind the buffer\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n\n      // check if we need to fill the buffer with data\n      if (createBuffer || geometry.dirtyFlags[this.src] !== false) {\n        const map = this.map;\n        // get the values from the geometry, possibly transformed\n        const values = map ? map(src) : src;\n        // fill the buffer with the values\n        this._renderer._bindBuffer(buffer, gl.ARRAY_BUFFER, values);\n        // mark the geometry's source array as clean\n        geometry.dirtyFlags[this.src] = false;\n      }\n      // enable the attribute\n      shader.enableAttrib(attr, this.size);\n    } else {\n      const loc = attr.location;\n      if (loc === -1 || !this._renderer.registerEnabled.has(loc)) {\n        return;\n      }\n      // Disable register corresponding to unused attribute\n      gl.disableVertexAttribArray(loc);\n      // Record register availability\n      this._renderer.registerEnabled.delete(loc);\n    }\n  }\n}\n\nfunction renderBuffer(p5, fn) {\n  p5.RenderBuffer = RenderBuffer;\n}\n\nif (typeof p5 !== \"undefined\") {\n  renderBuffer(p5, p5.prototype);\n}\n\nexport { RenderBuffer, renderBuffer as default };\n","import { m as PATH, Q as QUADS, s as QUAD_STRIP, r as TRIANGLE_STRIP, p as TRIANGLES, a1 as IMAGE, L as LINES, q as TRIANGLE_FAN } from '../constants-8IpwyBct.js';\nimport { Geometry } from './p5.Geometry.js';\nimport libtess from 'libtess';\nimport { Vector } from '../math/p5.Vector.js';\nimport { RenderBuffer } from './p5.RenderBuffer.js';\nimport './p5.DataArray.js';\nimport '../io/utilities.js';\nimport 'file-saver';\n\nconst INITIAL_BUFFER_STRIDES = {\n  vertices: 1,\n  vertexNormals: 1,\n  vertexColors: 4,\n  vertexStrokeColors: 4,\n  uvs: 2\n};\n\n// The total number of properties per vertex, before additional\n// user attributes are added.\nconst INITIAL_VERTEX_SIZE =\n  Object.values(INITIAL_BUFFER_STRIDES).reduce((acc, next) => acc + next);\n\nclass ShapeBuilder {\n  constructor(renderer) {\n    this.renderer = renderer;\n    this.shapeMode = PATH;\n    this.geometry = new Geometry(undefined, undefined, undefined, this.renderer);\n    this.geometry.gid = '__IMMEDIATE_MODE_GEOMETRY__';\n\n    this.contourIndices = [];\n    this._useUserVertexProperties = undefined;\n\n    this._bezierVertex = [];\n    this._quadraticVertex = [];\n    this._curveVertex = [];\n\n    // Used to distinguish between user calls to vertex() and internal calls\n    this.isProcessingVertices = false;\n\n    // Used for converting shape outlines into triangles for rendering\n    this._tessy = this._initTessy();\n    this.tessyVertexSize = INITIAL_VERTEX_SIZE;\n    this.bufferStrides = { ...INITIAL_BUFFER_STRIDES };\n  }\n\n  constructFromContours(shape, contours) {\n    if (this._useUserVertexProperties){\n      this._resetUserVertexProperties();\n    }\n    this.geometry.reset();\n    this.contourIndices = [];\n    // TODO: handle just some contours having non-PATH mode\n    this.shapeMode = shape.contours[0].kind;\n    const shouldProcessEdges = !!this.renderer.states.strokeColor;\n\n    const userVertexPropertyHelpers = {};\n    if (shape.userVertexProperties) {\n      this._useUserVertexProperties = true;\n      for (const key in shape.userVertexProperties) {\n        const name = shape.vertexPropertyName(key);\n        const prop = this.geometry._userVertexPropertyHelper(name, [], shape.userVertexProperties[key]);\n        userVertexPropertyHelpers[key] = prop;\n        this.tessyVertexSize += prop.getDataSize();\n        this.bufferStrides[prop.getSrcName()] = prop.getDataSize();\n        this.renderer.buffers.user.push(\n          new RenderBuffer(prop.getDataSize(), prop.getSrcName(), prop.getDstName(), name, this.renderer)\n        );\n      }\n    } else {\n      this._useUserVertexProperties = false;\n    }\n\n    for (const contour of contours) {\n      this.contourIndices.push(this.geometry.vertices.length);\n      for (const vertex of contour) {\n        // WebGL doesn't support QUADS or QUAD_STRIP, so we duplicate data to turn\n        // QUADS into TRIANGLES and QUAD_STRIP into TRIANGLE_STRIP. (There is no extra\n        // work to convert QUAD_STRIP here, since the only difference is in how edges\n        // are rendered.)\n        if (this.shapeMode === QUADS) {\n          // A finished quad turned into triangles should leave 6 vertices in the\n          // buffer:\n          // 0--3     0   3--5\n          // |  | --> | \\  \\ |\n          // 1--2     1--2   4\n          // When vertex index 3 is being added, add the necessary duplicates.\n          if (this.geometry.vertices.length % 6 === 3) {\n            for (const key in this.bufferStrides) {\n              const stride = this.bufferStrides[key];\n              const buffer = this.geometry[key];\n              buffer.push(\n                ...buffer.slice(\n                  buffer.length - 3 * stride,\n                  buffer.length - 2 * stride\n                ),\n                ...buffer.slice(buffer.length - stride, buffer.length),\n              );\n            }\n          }\n        }\n\n        this.geometry.vertices.push(vertex.position);\n        this.geometry.vertexNormals.push(vertex.normal || new Vector(0, 0, 0));\n        this.geometry.uvs.push(vertex.textureCoordinates.x, vertex.textureCoordinates.y);\n        if (this.renderer.states.fillColor) {\n          this.geometry.vertexColors.push(...vertex.fill.array());\n        } else {\n          this.geometry.vertexColors.push(0, 0, 0, 0);\n        }\n        if (this.renderer.states.strokeColor) {\n          this.geometry.vertexStrokeColors.push(...vertex.stroke.array());\n        } else {\n          this.geometry.vertexStrokeColors.push(0, 0, 0, 0);\n        }\n        for (const key in userVertexPropertyHelpers) {\n          const prop = userVertexPropertyHelpers[key];\n          if (key in vertex) {\n            prop.setCurrentData(vertex[key]);\n          }\n          prop.pushCurrentData();\n        }\n      }\n    }\n\n    if (shouldProcessEdges) {\n      this.geometry.edges = this._calculateEdges(this.shapeMode, this.geometry.vertices);\n    }\n    if (shouldProcessEdges && !this.renderer.geometryBuilder) {\n      this.geometry._edgesToVertices();\n    }\n\n    if (this.shapeMode === PATH) {\n      this.isProcessingVertices = true;\n      this._tesselateShape();\n      this.isProcessingVertices = false;\n    } else if (this.shapeMode === QUAD_STRIP) {\n      // The only difference between these two modes is which edges are\n      // displayed, so after we've updated the edges, we switch the mode\n      // to one that native WebGL knows how to render.\n      this.shapeMode = TRIANGLE_STRIP;\n    } else if (this.shapeMode === QUADS) {\n      // We translate QUADS to TRIANGLES when vertices are being added,\n      // since QUADS is just a p5 mode, whereas TRIANGLES is also a mode\n      // that native WebGL knows how to render. Once we've processed edges,\n      // everything should be set up for TRIANGLES mode.\n      this.shapeMode = TRIANGLES;\n    }\n\n    if (\n      this.renderer.states.textureMode === IMAGE &&\n      this.renderer.states._tex !== null &&\n      this.renderer.states._tex.width > 0 &&\n      this.renderer.states._tex.height > 0\n    ) {\n      this.geometry.uvs = this.geometry.uvs.map((val, i) => {\n        if (i % 2 === 0) {\n          return val / this.renderer.states._tex.width;\n        } else {\n          return val / this.renderer.states._tex.height;\n        }\n      });\n    }\n  }\n\n  _resetUserVertexProperties() {\n    const properties = this.geometry.userVertexProperties;\n    for (const propName in properties){\n      const prop = properties[propName];\n      delete this.bufferStrides[propName];\n      prop.delete();\n    }\n    this._useUserVertexProperties = false;\n    this.tessyVertexSize = INITIAL_VERTEX_SIZE;\n    this.geometry.userVertexProperties = {};\n  }\n\n  /**\n   * Called from _processVertices(). This function calculates the stroke vertices for custom shapes and\n   * tesselates shapes when applicable.\n   * @private\n   * @returns  {Number[]} indices for custom shape vertices indicating edges.\n   */\n  _calculateEdges(\n    shapeMode,\n    verts,\n  ) {\n    const res = [];\n    let i = 0;\n    const contourIndices = this.contourIndices.slice();\n    let contourStart = -1;\n    switch (shapeMode) {\n      case TRIANGLE_STRIP:\n        for (i = 0; i < verts.length - 2; i++) {\n          res.push([i, i + 1]);\n          res.push([i, i + 2]);\n        }\n        res.push([i, i + 1]);\n        break;\n      case TRIANGLE_FAN:\n        for (i = 1; i < verts.length - 1; i++) {\n          res.push([0, i]);\n          res.push([i, i + 1]);\n        }\n        res.push([0, verts.length - 1]);\n        break;\n      case TRIANGLES:\n        for (i = 0; i < verts.length - 2; i = i + 3) {\n          res.push([i, i + 1]);\n          res.push([i + 1, i + 2]);\n          res.push([i + 2, i]);\n        }\n        break;\n      case LINES:\n        for (i = 0; i < verts.length - 1; i = i + 2) {\n          res.push([i, i + 1]);\n        }\n        break;\n      case QUADS:\n        // Quads have been broken up into two triangles by `vertex()`:\n        // 0   3--5\n        // | \\  \\ |\n        // 1--2   4\n        for (i = 0; i < verts.length - 5; i += 6) {\n          res.push([i, i + 1]);\n          res.push([i + 1, i + 2]);\n          res.push([i + 2, i + 5]);\n          res.push([i + 5, i]);\n        }\n        break;\n      case QUAD_STRIP:\n        // 0---2---4\n        // |   |   |\n        // 1---3---5\n        for (i = 0; i < verts.length - 2; i += 2) {\n          res.push([i, i + 1]);\n          res.push([i + 1, i + 3]);\n          res.push([i, i + 2]);\n        }\n        res.push([i, i + 1]);\n        break;\n      default:\n        // TODO: handle contours in other modes too\n        for (i = 0; i < verts.length; i++) {\n          if (i === contourIndices[0]) {\n            contourStart = contourIndices.shift();\n          } else if (\n            verts[contourStart] &&\n            verts[i].equals(verts[contourStart])\n          ) {\n            res.push([i - 1, contourStart]);\n          } else {\n            res.push([i - 1, i]);\n          }\n        }\n        break;\n    }\n    return res;\n  }\n\n  /**\n   * Called from _processVertices() when applicable. This function tesselates immediateMode.geometry.\n   * @private\n   */\n  _tesselateShape() {\n    // TODO: handle non-PATH shape modes that have contours\n    this.shapeMode = TRIANGLES;\n    // const contours = [[]];\n    const contours = [];\n    for (let i = 0; i < this.geometry.vertices.length; i++) {\n      if (\n        this.contourIndices.length > 0 &&\n        this.contourIndices[0] === i\n      ) {\n        this.contourIndices.shift();\n        contours.push([]);\n      }\n      contours[contours.length-1].push(\n        this.geometry.vertices[i].x,\n        this.geometry.vertices[i].y,\n        this.geometry.vertices[i].z,\n        this.geometry.uvs[i * 2],\n        this.geometry.uvs[i * 2 + 1],\n        this.geometry.vertexColors[i * 4],\n        this.geometry.vertexColors[i * 4 + 1],\n        this.geometry.vertexColors[i * 4 + 2],\n        this.geometry.vertexColors[i * 4 + 3],\n        this.geometry.vertexNormals[i].x,\n        this.geometry.vertexNormals[i].y,\n        this.geometry.vertexNormals[i].z\n      );\n      for (const propName in this.geometry.userVertexProperties) {\n        const prop = this.geometry.userVertexProperties[propName];\n        const start = i * prop.getDataSize();\n        const end = start + prop.getDataSize();\n        const vals = prop.getSrcArray().slice(start, end);\n        contours[contours.length-1].push(...vals);\n      }\n    }\n\n    const polyTriangles = this._triangulate(contours);\n    const originalVertices = this.geometry.vertices;\n    this.geometry.vertices = [];\n    this.geometry.vertexNormals = [];\n    this.geometry.uvs = [];\n    for (const propName in this.geometry.userVertexProperties){\n      const prop = this.geometry.userVertexProperties[propName];\n      prop.resetSrcArray();\n    }\n    const colors = [];\n    for (\n      let j = 0, polyTriLength = polyTriangles.length;\n      j < polyTriLength;\n      j = j + this.tessyVertexSize\n    ) {\n      colors.push(...polyTriangles.slice(j + 5, j + 9));\n      this.geometry.vertexNormals.push(new Vector(...polyTriangles.slice(j + 9, j + 12)));\n      {\n        let offset = 12;\n        for (const propName in this.geometry.userVertexProperties){\n          const prop = this.geometry.userVertexProperties[propName];\n          const size = prop.getDataSize();\n          const start = j + offset;\n          const end = start + size;\n          prop.setCurrentData(polyTriangles.slice(start, end));\n          prop.pushCurrentData();\n          offset += size;\n        }\n      }\n      this.geometry.vertices.push(new Vector(...polyTriangles.slice(j, j + 3)));\n      this.geometry.uvs.push(...polyTriangles.slice(j + 3, j + 5));\n    }\n    if (this.renderer.geometryBuilder) {\n      // Tesselating the face causes the indices of edge vertices to stop being\n      // correct. When rendering, this is not a problem, since _edgesToVertices\n      // will have been called before this, and edge vertex indices are no longer\n      // needed. However, the geometry builder still needs this information, so\n      // when one is active, we need to update the indices.\n      //\n      // We record index mappings in a Map so that once we have found a\n      // corresponding vertex, we don't need to loop to find it again.\n      const newIndex = new Map();\n      this.geometry.edges =\n        this.geometry.edges.map(edge => edge.map(origIdx => {\n          if (!newIndex.has(origIdx)) {\n            const orig = originalVertices[origIdx];\n            let newVertIndex = this.geometry.vertices.findIndex(\n              v =>\n                orig.x === v.x &&\n                orig.y === v.y &&\n                orig.z === v.z\n            );\n            if (newVertIndex === -1) {\n              // The tesselation process didn't output a vertex with the exact\n              // coordinate as before, potentially due to numerical issues. This\n              // doesn't happen often, but in this case, pick the closest point\n              let closestDist = Infinity;\n              let closestIndex = 0;\n              for (\n                let i = 0;\n                i < this.geometry.vertices.length;\n                i++\n              ) {\n                const vert = this.geometry.vertices[i];\n                const dX = orig.x - vert.x;\n                const dY = orig.y - vert.y;\n                const dZ = orig.z - vert.z;\n                const dist = dX*dX + dY*dY + dZ*dZ;\n                if (dist < closestDist) {\n                  closestDist = dist;\n                  closestIndex = i;\n                }\n              }\n              newVertIndex = closestIndex;\n            }\n            newIndex.set(origIdx, newVertIndex);\n          }\n          return newIndex.get(origIdx);\n        }));\n    }\n    this.geometry.vertexColors = colors;\n  }\n\n  _initTessy() {\n    // function called for each vertex of tesselator output\n    function vertexCallback(data, polyVertArray) {\n      for (const element of data) {\n        polyVertArray.push(element);\n      }\n    }\n\n    function begincallback(type) {\n      if (type !== libtess.primitiveType.GL_TRIANGLES) {\n        console.log(`expected TRIANGLES but got type: ${type}`);\n      }\n    }\n\n    function errorcallback(errno) {\n      console.log('error callback');\n      console.log(`error number: ${errno}`);\n    }\n\n    // callback for when segments intersect and must be split\n    const combinecallback = (coords, data, weight) => {\n      const result = new Array(this.tessyVertexSize).fill(0);\n      for (let i = 0; i < weight.length; i++) {\n        for (let j = 0; j < result.length; j++) {\n          if (weight[i] === 0 || !data[i]) continue;\n          result[j] += data[i][j] * weight[i];\n        }\n      }\n      return result;\n    };\n\n    function edgeCallback(flag) {\n      // don't really care about the flag, but need no-strip/no-fan behavior\n    }\n\n    const tessy = new libtess.GluTesselator();\n    tessy.gluTessCallback(libtess.gluEnum.GLU_TESS_VERTEX_DATA, vertexCallback);\n    tessy.gluTessCallback(libtess.gluEnum.GLU_TESS_BEGIN, begincallback);\n    tessy.gluTessCallback(libtess.gluEnum.GLU_TESS_ERROR, errorcallback);\n    tessy.gluTessCallback(libtess.gluEnum.GLU_TESS_COMBINE, combinecallback);\n    tessy.gluTessCallback(libtess.gluEnum.GLU_TESS_EDGE_FLAG, edgeCallback);\n    tessy.gluTessProperty(\n      libtess.gluEnum.GLU_TESS_WINDING_RULE,\n      libtess.windingRule.GLU_TESS_WINDING_NONZERO\n    );\n\n    return tessy;\n  }\n\n  /**\n   * Runs vertices through libtess to convert them into triangles\n   * @private\n   */\n  _triangulate(contours) {\n    // libtess will take 3d verts and flatten to a plane for tesselation.\n    // libtess is capable of calculating a plane to tesselate on, but\n    // if all of the vertices have the same z values, we'll just\n    // assume the face is facing the camera, letting us skip any performance\n    // issues or bugs in libtess's automatic calculation.\n    const z = contours[0] ? contours[0][2] : undefined;\n    let allSameZ = true;\n    for (const contour of contours) {\n      for (\n        let j = 0;\n        j < contour.length;\n        j += this.tessyVertexSize\n      ) {\n        if (contour[j + 2] !== z) {\n          allSameZ = false;\n          break;\n        }\n      }\n    }\n    if (allSameZ) {\n      this._tessy.gluTessNormal(0, 0, 1);\n    } else {\n      // Let libtess pick a plane for us\n      this._tessy.gluTessNormal(0, 0, 0);\n    }\n\n    const triangleVerts = [];\n    this._tessy.gluTessBeginPolygon(triangleVerts);\n\n    for (const contour of contours) {\n      this._tessy.gluTessBeginContour();\n      for (\n        let j = 0;\n        j < contour.length;\n        j += this.tessyVertexSize\n      ) {\n        const coords = contour.slice(\n          j,\n          j + this.tessyVertexSize\n        );\n        this._tessy.gluTessVertex(coords, coords);\n      }\n      this._tessy.gluTessEndContour();\n    }\n\n    // finish polygon\n    this._tessy.gluTessEndPolygon();\n\n    return triangleVerts;\n  }\n}\n\nexport { ShapeBuilder };\n","class GeometryBufferCache {\n  constructor(renderer) {\n    this.renderer = renderer;\n    this.cache = {};\n  }\n\n  numCached() {\n    return Object.keys(this.cache).length;\n  }\n\n  isCached(gid) {\n    return this.cache[gid] !== undefined;\n  }\n\n  getGeometryByID(gid) {\n    return this.cache[gid]?.geometry;\n  }\n\n  getCached(model) {\n    return this.getCachedID(model.gid);\n  }\n\n  getCachedID(gid) {\n    return this.cache[gid];\n  }\n\n  ensureCached(geometry) {\n    const gid = geometry.gid;\n    if (!gid) {\n      throw new Error('The p5.Geometry you passed in has no gid property!');\n    }\n\n    if (this.isCached(geometry.gid)) return this.getCached(geometry);\n\n    const gl = this.renderer.GL;\n\n    //initialize the gl buffers for our geom groups\n    this.freeBuffers(gid);\n\n    if (Object.keys(this.cache).length > 1000) {\n      const key = Object.keys(this.cache)[0];\n      this.freeBuffers(key);\n    }\n\n    //create a new entry in our cache\n    const buffers = {};\n    this.cache[gid] = buffers;\n\n    buffers.geometry = geometry;\n\n    let indexBuffer = buffers.indexBuffer;\n\n    if (geometry.faces.length) {\n      // allocate space for faces\n      if (!indexBuffer) indexBuffer = buffers.indexBuffer = gl.createBuffer();\n      const vals = geometry.faces.flat();\n\n      // If any face references a vertex with an index greater than the maximum\n      // un-singed 16 bit integer, then we need to use a Uint32Array instead of a\n      // Uint16Array\n      const hasVertexIndicesOverMaxUInt16 = vals.some(v => v > 65535);\n      let type = hasVertexIndicesOverMaxUInt16 ? Uint32Array : Uint16Array;\n      this.renderer._bindBuffer(indexBuffer, gl.ELEMENT_ARRAY_BUFFER, vals, type);\n\n      // If we're using a Uint32Array for our indexBuffer we will need to pass a\n      // different enum value to WebGL draw triangles. This happens in\n      // the _drawElements function.\n      buffers.indexBufferType = hasVertexIndicesOverMaxUInt16\n        ? gl.UNSIGNED_INT\n        : gl.UNSIGNED_SHORT;\n    } else {\n      // the index buffer is unused, remove it\n      if (indexBuffer) {\n        gl.deleteBuffer(indexBuffer);\n        buffers.indexBuffer = null;\n      }\n    }\n\n    return buffers;\n  }\n\n  freeBuffers(gid) {\n    const buffers = this.cache[gid];\n    if (!buffers) {\n      return;\n    }\n\n    delete this.cache[gid];\n\n    const gl = this.renderer.GL;\n    if (buffers.indexBuffer) {\n      gl.deleteBuffer(buffers.indexBuffer);\n    }\n\n    function freeBuffers(defs) {\n      for (const def of defs) {\n        if (buffers[def.dst]) {\n          gl.deleteBuffer(buffers[def.dst]);\n          buffers[def.dst] = null;\n        }\n      }\n    }\n\n    // free all the buffers\n    freeBuffers(this.renderer.buffers.stroke);\n    freeBuffers(this.renderer.buffers.fill);\n    freeBuffers(this.renderer.buffers.user);\n  }\n}\n\nexport { GeometryBufferCache };\n","import { Z as THRESHOLD, U as POSTERIZE, $ as BLUR } from '../constants-8IpwyBct.js';\n\nconst filterParamDefaults = {\n  [BLUR]: 3,\n  [POSTERIZE]: 4,\n  [THRESHOLD]: 0.5,\n};\n\nexport { filterParamDefaults };\n","import { x as RAD_TO_DEG, D as DEG_TO_RAD } from '../constants-8IpwyBct.js';\n\n/**\n * @module Math\n * @submodule Trigonometry\n * @for p5\n * @requires core\n * @requires constants\n */\n\n\nfunction trigonometry(p5, fn){\n  const DEGREES = fn.DEGREES = 'degrees';\n  const RADIANS = fn.RADIANS = 'radians';\n\n  /*\n   * all DEGREES/RADIANS conversion should be done in the p5 instance\n   * if possible, using the p5._toRadians(), p5._fromRadians() methods.\n   */\n  fn._angleMode = RADIANS;\n\n  /**\n   * Calculates the arc cosine of a number.\n   *\n   * `acos()` is the inverse of <a href=\"#/p5/cos\">cos()</a>. It expects\n   * arguments in the range -1 to 1. By default, `acos()` returns values in the\n   * range 0 to &pi; (about 3.14). If the\n   * <a href=\"#/p5/angleMode\">angleMode()</a> is `DEGREES`, then values are\n   * returned in the range 0 to 180.\n   *\n   * @method acos\n   * @param  {Number} value value whose arc cosine is to be returned.\n   * @return {Number}       arc cosine of the given value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Calculate cos() and acos() values.\n   *   let a = PI;\n   *   let c = cos(a);\n   *   let ac = acos(c);\n   *\n   *   // Display the values.\n   *   text(`${round(a, 3)}`, 35, 25);\n   *   text(`${round(c, 3)}`, 35, 50);\n   *   text(`${round(ac, 3)}`, 35, 75);\n   *\n   *   describe('The numbers 3.142, -1, and 3.142 written on separate rows.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Calculate cos() and acos() values.\n   *   let a = PI + QUARTER_PI;\n   *   let c = cos(a);\n   *   let ac = acos(c);\n   *\n   *   // Display the values.\n   *   text(`${round(a, 3)}`, 35, 25);\n   *   text(`${round(c, 3)}`, 35, 50);\n   *   text(`${round(ac, 3)}`, 35, 75);\n   *\n   *   describe('The numbers 3.927, -0.707, and 2.356 written on separate rows.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.acos = function(ratio) {\n    return this._fromRadians(Math.acos(ratio));\n  };\n\n  /**\n   * Calculates the arc sine of a number.\n   *\n   * `asin()` is the inverse of <a href=\"#/p5/sin\">sin()</a>. It expects input\n   * values in the range of -1 to 1. By default, `asin()` returns values in the\n   * range -&pi; &divide; 2 (about -1.57) to &pi; &divide; 2 (about 1.57). If\n   * the <a href=\"#/p5/angleMode\">angleMode()</a> is `DEGREES` then values are\n   * returned in the range -90 to 90.\n   *\n   * @method asin\n   * @param  {Number} value value whose arc sine is to be returned.\n   * @return {Number}       arc sine of the given value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Calculate sin() and asin() values.\n   *   let a = PI / 3;\n   *   let s = sin(a);\n   *   let as = asin(s);\n   *\n   *   // Display the values.\n   *   text(`${round(a, 3)}`, 35, 25);\n   *   text(`${round(s, 3)}`, 35, 50);\n   *   text(`${round(as, 3)}`, 35, 75);\n   *\n   *   describe('The numbers 1.047, 0.866, and 1.047 written on separate rows.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Calculate sin() and asin() values.\n   *   let a = PI + PI / 3;\n   *   let s = sin(a);\n   *   let as = asin(s);\n   *\n   *   // Display the values.\n   *   text(`${round(a, 3)}`, 35, 25);\n   *   text(`${round(s, 3)}`, 35, 50);\n   *   text(`${round(as, 3)}`, 35, 75);\n   *\n   *   describe('The numbers 4.189, -0.866, and -1.047 written on separate rows.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.asin = function(ratio) {\n    return this._fromRadians(Math.asin(ratio));\n  };\n\n  /**\n   * Calculates the arc tangent of a number.\n   *\n   * `atan()` is the inverse of <a href=\"#/p5/tan\">tan()</a>. It expects input\n   * values in the range of -Infinity to Infinity. By default, `atan()` returns\n   * values in the range -&pi; &divide; 2 (about -1.57) to &pi; &divide; 2\n   * (about 1.57). If the <a href=\"#/p5/angleMode\">angleMode()</a> is `DEGREES`\n   * then values are returned in the range -90 to 90.\n   *\n   * @method atan\n   * @param  {Number} value value whose arc tangent is to be returned.\n   * @return {Number}       arc tangent of the given value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Calculate tan() and atan() values.\n   *   let a = PI / 3;\n   *   let t = tan(a);\n   *   let at = atan(t);\n   *\n   *   // Display the values.\n   *   text(`${round(a, 3)}`, 35, 25);\n   *   text(`${round(t, 3)}`, 35, 50);\n   *   text(`${round(at, 3)}`, 35, 75);\n   *\n   *   describe('The numbers 1.047, 1.732, and 1.047 written on separate rows.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Calculate tan() and atan() values.\n   *   let a = PI + PI / 3;\n   *   let t = tan(a);\n   *   let at = atan(t);\n   *\n   *   // Display the values.\n   *   text(`${round(a, 3)}`, 35, 25);\n   *   text(`${round(t, 3)}`, 35, 50);\n   *   text(`${round(at, 3)}`, 35, 75);\n   *\n   *   describe('The numbers 4.189, 1.732, and 1.047 written on separate rows.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.atan = function(ratio) {\n    return this._fromRadians(Math.atan(ratio));\n  };\n\n  /**\n   * Calculates the angle formed by a point, the origin, and the positive\n   * x-axis.\n   *\n   * `atan2()` is most often used for orienting geometry to the mouse's\n   * position, as in `atan2(mouseY, mouseX)`. The first parameter is the point's\n   * y-coordinate and the second parameter is its x-coordinate.\n   *\n   * By default, `atan2()` returns values in the range\n   * -&pi; (about -3.14) to &pi; (3.14). If the\n   * <a href=\"#/p5/angleMode\">angleMode()</a> is `DEGREES`, then values are\n   * returned in the range -180 to 180.\n   *\n   * @method atan2\n   * @param  {Number} y y-coordinate of the point.\n   * @param  {Number} x x-coordinate of the point.\n   * @return {Number}   arc tangent of the given point.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A rectangle at the top-left of the canvas rotates with mouse movements.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the angle between the mouse\n   *   // and the origin.\n   *   let a = atan2(mouseY, mouseX);\n   *\n   *   // Rotate.\n   *   rotate(a);\n   *\n   *   // Draw the shape.\n   *   rect(0, 0, 60, 10);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A rectangle at the center of the canvas rotates with mouse movements.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin to the center.\n   *   translate(50, 50);\n   *\n   *   // Get the mouse's coordinates relative to the origin.\n   *   let x = mouseX - 50;\n   *   let y = mouseY - 50;\n   *\n   *   // Calculate the angle between the mouse and the origin.\n   *   let a = atan2(y, x);\n   *\n   *   // Rotate.\n   *   rotate(a);\n   *\n   *   // Draw the shape.\n   *   rect(-30, -5, 60, 10);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.atan2 = function(y, x) {\n    return this._fromRadians(Math.atan2(y, x));\n  };\n\n  /**\n   * Calculates the cosine of an angle.\n   *\n   * `cos()` is useful for many geometric tasks in creative coding. The values\n   * returned oscillate between -1 and 1 as the input angle increases. `cos()`\n   * calculates the cosine of an angle, using radians by default, or according\n   * to if <a href=\"#/p5/angleMode\">angleMode()</a> setting (RADIANS or DEGREES).\n   *\n   * @method cos\n   * @param  {Number} angle the angle, in radians by default, or according to if <a href=\"/reference/p5/angleMode/\">angleMode()</a> setting (RADIANS or DEGREES).\n   * @return {Number}       cosine of the angle.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white ball on a string oscillates left and right.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the coordinates.\n   *   let x = 30 * cos(frameCount * 0.05) + 50;\n   *   let y = 50;\n   *\n   *   // Draw the oscillator.\n   *   line(50, y, x, y);\n   *   circle(x, y, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A series of black dots form a wave pattern.');\n   * }\n   *\n   * function draw() {\n   *   // Calculate the coordinates.\n   *   let x = frameCount;\n   *   let y = 30 * cos(x * 0.1) + 50;\n   *\n   *   // Draw the point.\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A series of black dots form an infinity symbol.');\n   * }\n   *\n   * function draw() {\n   *   // Calculate the coordinates.\n   *   let x = 30 * cos(frameCount * 0.1) + 50;\n   *   let y = 10 * sin(frameCount * 0.2) + 50;\n   *\n   *   // Draw the point.\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.cos = function(angle) {\n    return Math.cos(this._toRadians(angle));\n  };\n\n  /**\n   * Calculates the sine of an angle.\n   *\n   * `sin()` is useful for many geometric tasks in creative coding. The values\n   * returned oscillate between -1 and 1 as the input angle increases. `sin()`\n   * calculates the sine of an angle, using radians by default, or according to\n   * if <a href=\"#/p5/angleMode\">angleMode()</a> setting (RADIANS or DEGREES).\n   *\n   * @method sin\n   * @param  {Number} angle the angle, in radians by default, or according to if <a href=\"/reference/p5/angleMode/\">angleMode()</a> setting (RADIANS or DEGREES).\n   * @return {Number}       sine of the angle.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white ball on a string oscillates up and down.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the coordinates.\n   *   let x = 50;\n   *   let y = 30 * sin(frameCount * 0.05) + 50;\n   *\n   *   // Draw the oscillator.\n   *   line(50, y, x, y);\n   *   circle(x, y, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A series of black dots form a wave pattern.');\n   * }\n   *\n   * function draw() {\n   *   // Calculate the coordinates.\n   *   let x = frameCount;\n   *   let y = 30 * sin(x * 0.1) + 50;\n   *\n   *   // Draw the point.\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A series of black dots form an infinity symbol.');\n   * }\n   *\n   * function draw() {\n   *   // Calculate the coordinates.\n   *   let x = 30 * cos(frameCount * 0.1) + 50;\n   *   let y = 10 * sin(frameCount * 0.2) + 50;\n   *\n   *   // Draw the point.\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.sin = function(angle) {\n    return Math.sin(this._toRadians(angle));\n  };\n\n  /**\n   * Calculates the tangent of an angle.\n   *\n   * `tan()` is useful for many geometric tasks in creative coding. The values\n   * returned range from -Infinity to Infinity and repeat periodically as the\n   * input angle increases. `tan()` calculates the tan of an angle, using radians\n   * by default, or according to\n   * if <a href=\"#/p5/angleMode\">angleMode()</a> setting (RADIANS or DEGREES).\n   *\n   * @method tan\n   * @param  {Number} angle the angle, in radians by default, or according to if <a href=\"/reference/p5/angleMode/\">angleMode()</a> setting (RADIANS or DEGREES).\n   * @return {Number}       tangent of the angle.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A series of identical curves drawn with black dots. Each curve starts from the top of the canvas, continues down at a slight angle, flattens out at the middle of the canvas, then continues to the bottom.');\n   * }\n   *\n   * function draw() {\n   *   // Calculate the coordinates.\n   *   let x = frameCount;\n   *   let y = 5 * tan(x * 0.1) + 50;\n   *\n   *   // Draw the point.\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.tan = function(angle) {\n    return Math.tan(this._toRadians(angle));\n  };\n\n  /**\n   * Converts an angle measured in radians to its value in degrees.\n   *\n   * Degrees and radians are both units for measuring angles. There are 360 in\n   * one full rotation. A full rotation is 2 &times; &pi; (about 6.28) radians.\n   *\n   * The same angle can be expressed in with either unit. For example, 90 is a\n   * quarter of a full rotation. The same angle is 2 &times; &pi; &divide; 4\n   * (about 1.57) radians.\n   *\n   * @method degrees\n   * @param  {Number} radians radians value to convert to degrees.\n   * @return {Number}         converted angle.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Calculate the angle conversion.\n   *   let rad = QUARTER_PI;\n   *   let deg = degrees(rad);\n   *\n   *   // Display the conversion.\n   *   text(`${round(rad, 2)} rad = ${deg}`, 10, 50);\n   *\n   *   describe('The text \"0.79 rad = 45\".');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.degrees = angle => angle * RAD_TO_DEG;\n\n  /**\n   * Converts an angle measured in degrees to its value in radians.\n   *\n   * Degrees and radians are both units for measuring angles. There are 360 in\n   * one full rotation. A full rotation is 2 &times; &pi; (about 6.28) radians.\n   *\n   * The same angle can be expressed in with either unit. For example, 90 is a\n   * quarter of a full rotation. The same angle is 2 &times; &pi; &divide; 4\n   * (about 1.57) radians.\n   *\n   * @method radians\n   * @param  {Number} degrees degree value to convert to radians.\n   * @return {Number}         converted angle.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Caclulate the angle conversion.\n   *   let deg = 45;\n   *   let rad = radians(deg);\n   *\n   *   // Display the angle conversion.\n   *   text(`${deg} = ${round(rad, 3)} rad`, 10, 50);\n   *\n   *   describe('The text \"45 = 0.785 rad\".');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.radians = angle => angle * DEG_TO_RAD;\n\n  /**\n   * Changes the unit system used to measure angles.\n   *\n   * Degrees and radians are both units for measuring angles. There are 360 in\n   * one full rotation. A full rotation is 2 &times; &pi; (about 6.28) radians.\n   *\n   * Functions such as <a href=\"#/p5/rotate\">rotate()</a> and\n   * <a href=\"#/p5/sin\">sin()</a> expect angles measured radians by default.\n   * Calling `angleMode(DEGREES)` switches to degrees. Calling\n   * `angleMode(RADIANS)` switches back to radians.\n   *\n   * Calling `angleMode()` with no arguments returns current angle mode, which\n   * is either `RADIANS` or `DEGREES`.\n   *\n   * @method angleMode\n   * @param {(RADIANS|DEGREES)} mode either RADIANS or DEGREES.\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Rotate 1/8 turn.\n   *   rotate(QUARTER_PI);\n   *\n   *   // Draw a line.\n   *   line(0, 0, 80, 0);\n   *\n   *   describe('A diagonal line radiating from the top-left corner of a square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   // Rotate 1/8 turn.\n   *   rotate(45);\n   *\n   *   // Draw a line.\n   *   line(0, 0, 80, 0);\n   *\n   *   describe('A diagonal line radiating from the top-left corner of a square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Calculate the angle to rotate.\n   *   let angle = TWO_PI / 7;\n   *\n   *   // Move the origin to the center.\n   *   translate(50, 50);\n   *\n   *   // Style the flower.\n   *   noStroke();\n   *   fill(255, 50);\n   *\n   *   // Draw the flower.\n   *   for (let i = 0; i < 7; i += 1) {\n   *     ellipse(0, 0, 80, 20);\n   *     rotate(angle);\n   *   }\n   *\n   *   describe('A translucent white flower on a dark background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   // Calculate the angle to rotate.\n   *   let angle = 360 / 7;\n   *\n   *   // Move the origin to the center.\n   *   translate(50, 50);\n   *\n   *   // Style the flower.\n   *   noStroke();\n   *   fill(255, 50);\n   *\n   *   // Draw the flower.\n   *   for (let i = 0; i < 7; i += 1) {\n   *     ellipse(0, 0, 80, 20);\n   *     rotate(angle);\n   *   }\n   *\n   *   describe('A translucent white flower on a dark background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white ball on a string oscillates left and right.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the coordinates.\n   *   let x = 30 * cos(frameCount * 0.05) + 50;\n   *   let y = 50;\n   *\n   *   // Draw the oscillator.\n   *   line(50, y, x, y);\n   *   circle(x, y, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   describe('A white ball on a string oscillates left and right.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the coordinates.\n   *   let x = 30 * cos(frameCount * 2.86) + 50;\n   *   let y = 50;\n   *\n   *   // Draw the oscillator.\n   *   line(50, y, x, y);\n   *   circle(x, y, 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Draw the upper line.\n   *   rotate(PI / 6);\n   *   line(0, 0, 80, 0);\n   *\n   *   // Use degrees.\n   *   angleMode(DEGREES);\n   *\n   *   // Draw the lower line.\n   *   rotate(30);\n   *   line(0, 0, 80, 0);\n   *\n   *   describe('Two diagonal lines radiating from the top-left corner of a square. The lines are oriented 30 degrees from the edges of the square and 30 degrees apart from each other.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method angleMode\n   * @return {(RADIANS|DEGREES)} mode either RADIANS or DEGREES\n   */\n  fn.angleMode = function(mode) {\n    // p5._validateParameters('angleMode', arguments);\n    if (typeof mode === 'undefined') {\n      return this._angleMode;\n    } else if (mode === DEGREES || mode === RADIANS) {\n      const prevMode = this._angleMode;\n\n      // No change\n      if(mode === prevMode) return;\n\n      // Otherwise adjust pRotation according to new mode\n      // This is necessary for acceleration events to work properly\n      if(mode === RADIANS) {\n        // Change pRotation to radians\n        this.pRotationX = this.pRotationX * DEG_TO_RAD;\n        this.pRotationY = this.pRotationY * DEG_TO_RAD;\n        this.pRotationZ = this.pRotationZ * DEG_TO_RAD;\n      } else {\n        // Change pRotation to degrees\n        this.pRotationX = this.pRotationX * RAD_TO_DEG;\n        this.pRotationY = this.pRotationY * RAD_TO_DEG;\n        this.pRotationZ = this.pRotationZ * RAD_TO_DEG;\n      }\n\n      this._angleMode = mode;\n    }\n  };\n\n  /**\n   * converts angles from the current angleMode to RADIANS\n   *\n   * @method _toRadians\n   * @private\n   * @param {Number} angle\n   * @returns {Number}\n   */\n  fn._toRadians = function(angle) {\n    if (this._angleMode === DEGREES) {\n      return angle * DEG_TO_RAD;\n    }\n    return angle;\n  };\n\n  /**\n   * converts angles from the current angleMode to DEGREES\n   *\n   * @method _toDegrees\n   * @private\n   * @param {Number} angle\n   * @returns {Number}\n   */\n  fn._toDegrees = function(angle) {\n    if (this._angleMode === RADIANS) {\n      return angle * RAD_TO_DEG;\n    }\n    return angle;\n  };\n\n  /**\n   * converts angles from RADIANS into the current angleMode\n   *\n   * @method _fromRadians\n   * @private\n   * @param {Number} angle\n   * @returns {Number}\n   */\n  fn._fromRadians = function(angle) {\n    if (this._angleMode === DEGREES) {\n      return angle * RAD_TO_DEG;\n    }\n    return angle;\n  };\n\n  /**\n   * converts angles from DEGREES into the current angleMode\n   *\n   * @method _fromDegrees\n   * @private\n   * @param {Number} angle\n   * @returns {Number}\n   */\n  fn._fromDegrees = function(angle) {\n    if (this._angleMode === RADIANS) {\n      return angle * DEG_TO_RAD;\n    }\n    return angle;\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  trigonometry(p5, p5.prototype);\n}\n\nexport { trigonometry as default };\n","import { e as CORNER, i as CORNERS, C as CENTER, ap as COVER, aq as CONTAIN, R as RIGHT, ar as BOTTOM, u as BLEND, as as FILL, a1 as IMAGE, at as CLAMP, z as WEBGL2, j as ROUND, o as POINTS, L as LINES, p as TRIANGLES, a0 as WEBGL, $ as BLUR, a6 as DARKEST, a7 as LIGHTEST, ai as ADD, a5 as SUBTRACT, ab as SCREEN, aa as EXCLUSION, ac as REPLACE, a9 as MULTIPLY, a4 as REMOVE, ah as BURN, ad as OVERLAY, ae as HARD_LIGHT, af as SOFT_LIGHT, ag as DODGE, au as UNSIGNED_INT, av as UNSIGNED_BYTE, Z as THRESHOLD, _ as INVERT, K as OPAQUE, U as POSTERIZE, V as DILATE, Y as ERODE, X as GRAY, v as constants, aw as SIMPLE, ax as FULL, f as TWO_PI, O as OPEN, N as NORMAL, n as CLOSE, aj as PIE, ak as CHORD, T as TEXTURE, P as P2D, ay as NEAREST, az as REPEAT, aA as MIRROR, aB as FLOAT, aC as LINEAR, aD as HALF_FLOAT } from './constants-8IpwyBct.js';\nimport { C as Color, c as creatingReading, h as RGBA, R as RGB } from './creating_reading-BdolPjuO.js';\nimport { Element } from './dom/p5.Element.js';\nimport { R as Renderer, I as Image } from './p5.Renderer-DoDzbpcT.js';\nimport './dom/p5.MediaElement.js';\nimport primitives from './shape/2d_primitives.js';\nimport attributes from './shape/attributes.js';\nimport curves from './shape/curves.js';\nimport vertex from './shape/vertex.js';\nimport setting from './color/setting.js';\nimport * as omggif from 'omggif';\nimport canvas from './core/helpers.js';\nimport { parse } from './io/csv.js';\nimport { _checkFileExtension, downloadFile } from './io/utilities.js';\nimport { GIFEncoder, quantize, nearestColorIndex } from 'gifenc';\nimport pixels from './image/pixels.js';\nimport transform from './core/transform.js';\nimport GeometryBuilder from './webgl/GeometryBuilder.js';\nimport './math/p5.Matrix.js';\nimport { Vector } from './math/p5.Vector.js';\nimport { Quat } from './webgl/p5.Quat.js';\nimport { Matrix } from './math/Matrices/Matrix.js';\nimport { RenderBuffer } from './webgl/p5.RenderBuffer.js';\nimport { DataArray } from './webgl/p5.DataArray.js';\nimport { ShapeBuilder } from './webgl/ShapeBuilder.js';\nimport { GeometryBufferCache } from './webgl/GeometryBufferCache.js';\nimport { filterParamDefaults } from './image/const.js';\nimport customShapes, { PrimitiveToVerticesConverter } from './shape/custom_shapes.js';\nimport { Geometry } from './webgl/p5.Geometry.js';\nimport trigonometry from './math/trigonometry.js';\n\n/**\n * @module Image\n * @submodule Image\n * @for p5\n * @requires core\n */\n\n\nfunction image(p5, fn){\n  /**\n   * Creates a new <a href=\"#/p5.Image\">p5.Image</a> object.\n   *\n   * `createImage()` uses the `width` and `height` parameters to set the new\n   * <a href=\"#/p5.Image\">p5.Image</a> object's dimensions in pixels. The new\n   * <a href=\"#/p5.Image\">p5.Image</a> can be modified by updating its\n   * <a href=\"#/p5.Image/pixels\">pixels</a> array or by calling its\n   * <a href=\"#/p5.Image/get\">get()</a> and\n   * <a href=\"#/p5.Image/set\">set()</a> methods. The\n   * <a href=\"#/p5.Image/loadPixels\">loadPixels()</a> method must be called\n   * before reading or modifying pixel values. The\n   * <a href=\"#/p5.Image/updatePixels\">updatePixels()</a> method must be called\n   * for updates to take effect.\n   *\n   * Note: The new <a href=\"#/p5.Image\">p5.Image</a> object is transparent by\n   * default.\n   *\n   * @method createImage\n   * @param  {Integer} width  width in pixels.\n   * @param  {Integer} height height in pixels.\n   * @return {p5.Image}       new <a href=\"#/p5.Image\">p5.Image</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(66, 66);\n   *\n   *   // Load the image's pixels into memory.\n   *   img.loadPixels();\n   *\n   *   // Set all the image's pixels to black.\n   *   for (let x = 0; x < img.width; x += 1) {\n   *     for (let y = 0; y < img.height; y += 1) {\n   *       img.set(x, y, 0);\n   *     }\n   *   }\n   *\n   *   // Update the image's pixel values.\n   *   img.updatePixels();\n   *\n   *   // Draw the image.\n   *   image(img, 17, 17);\n   *\n   *   describe('A black square drawn in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(66, 66);\n   *\n   *   // Load the image's pixels into memory.\n   *   img.loadPixels();\n   *\n   *   // Create a color gradient.\n   *   for (let x = 0; x < img.width; x += 1) {\n   *     for (let y = 0; y < img.height; y += 1) {\n   *       // Calculate the transparency.\n   *       let a = map(x, 0, img.width, 0, 255);\n   *\n   *       // Create a p5.Color object.\n   *       let c = color(0, a);\n   *\n   *       // Set the pixel's color.\n   *       img.set(x, y, c);\n   *     }\n   *   }\n   *\n   *   // Update the image's pixels.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 17, 17);\n   *\n   *   describe('A square with a horizontal color gradient that transitions from gray to black.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Image object.\n   *   let img = createImage(66, 66);\n   *\n   *   // Load the pixels into memory.\n   *   img.loadPixels();\n   *   // Get the current pixel density.\n   *   let d = pixelDensity();\n   *\n   *   // Calculate the pixel that is halfway through the image's pixel array.\n   *   let halfImage = 4 * (d * img.width) * (d * img.height / 2);\n   *\n   *   // Set half of the image's pixels to black.\n   *   for (let i = 0; i < halfImage; i += 4) {\n   *     // Red.\n   *     img.pixels[i] = 0;\n   *     // Green.\n   *     img.pixels[i + 1] = 0;\n   *     // Blue.\n   *     img.pixels[i + 2] = 0;\n   *     // Alpha.\n   *     img.pixels[i + 3] = 255;\n   *   }\n   *\n   *   // Update the image's pixels.\n   *   img.updatePixels();\n   *\n   *   // Display the image.\n   *   image(img, 17, 17);\n   *\n   *   describe('A black square drawn in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createImage = function(width, height) {\n    // p5._validateParameters('createImage', arguments);\n    return new p5.Image(width, height);\n  };\n\n  /**\n   * Saves the current canvas as an image.\n   *\n   * By default, `saveCanvas()` saves the canvas as a PNG image called\n   * `untitled.png`.\n   *\n   * The first parameter, `filename`, is optional. It's a string that sets the\n   * file's name. If a file extension is included, as in\n   * `saveCanvas('drawing.png')`, then the image will be saved using that\n   * format.\n   *\n   * The second parameter, `extension`, is also optional. It sets the files format.\n   * Either `'png'`, `'webp'`, or `'jpg'` can be used. For example, `saveCanvas('drawing', 'jpg')`\n   * saves the canvas to a file called `drawing.jpg`.\n   *\n   * Note: The browser will either save the file immediately or prompt the user\n   * with a dialogue window.\n   *\n   *  @method saveCanvas\n   *  @param  {p5.Framebuffer|p5.Element|HTMLCanvasElement} selectedCanvas   reference to a\n   *                                                          specific HTML5 canvas element.\n   *  @param  {String} [filename]  file name. Defaults to 'untitled'.\n   *  @param  {String} [extension] file extension, either 'png', 'webp', or 'jpg'. Defaults to 'png'.\n   *\n   *  @example\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(255);\n   *\n   *   // Save the canvas to 'untitled.png'.\n   *   saveCanvas();\n   *\n   *   describe('A white square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(255);\n   *\n   *   // Save the canvas to 'myCanvas.jpg'.\n   *   saveCanvas('myCanvas.jpg');\n   *\n   *   describe('A white square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(255);\n   *\n   *   // Save the canvas to 'myCanvas.jpg'.\n   *   saveCanvas('myCanvas', 'jpg');\n   *\n   *   describe('A white square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(255);\n   *\n   *   // Save the canvas to 'untitled.png'.\n   *   saveCanvas(cnv);\n   *\n   *   describe('A white square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(255);\n   *\n   *   // Save the canvas to 'myCanvas.jpg'.\n   *   saveCanvas(cnv, 'myCanvas.jpg');\n   *\n   *   describe('A white square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='norender'>\n   * <code>\n   * function setup() {\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   background(255);\n   *\n   *   // Save the canvas to 'myCanvas.jpg'.\n   *   saveCanvas(cnv, 'myCanvas', 'jpg');\n   *\n   *   describe('A white square.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   *  @method saveCanvas\n   *  @param  {String} [filename]\n   *  @param  {String} [extension]\n   */\n  fn.saveCanvas = function(...args) {\n    // copy arguments to array\n    let htmlCanvas, filename, extension, temporaryGraphics;\n\n    if (args[0] instanceof HTMLCanvasElement) {\n      htmlCanvas = args[0];\n      args.shift();\n    } else if (args[0] instanceof Element) {\n      htmlCanvas = args[0].elt;\n      args.shift();\n    } else if (args[0] instanceof Framebuffer) {\n      const framebuffer = args[0];\n      temporaryGraphics = this.createGraphics(framebuffer.width,\n        framebuffer.height);\n      temporaryGraphics.pixelDensity(framebuffer.pixelDensity());\n      framebuffer.loadPixels();\n      temporaryGraphics.loadPixels();\n      temporaryGraphics.pixels.set(framebuffer.pixels);\n      temporaryGraphics.updatePixels();\n\n      htmlCanvas = temporaryGraphics._renderer.canvas;\n      args.shift();\n    } else {\n      htmlCanvas = this._curElement && this._curElement.elt;\n    }\n\n    if (args.length >= 1) {\n      filename = args[0];\n    }\n    if (args.length >= 2) {\n      extension = args[1];\n    }\n\n    extension =\n      extension ||\n      fn._checkFileExtension(filename, extension)[1] ||\n      'png';\n\n    let mimeType;\n    switch (extension) {\n      default:\n        //case 'png':\n        mimeType = 'image/png';\n        break;\n      case 'webp':\n        mimeType = 'image/webp';\n        break;\n      case 'jpeg':\n      case 'jpg':\n        mimeType = 'image/jpeg';\n        break;\n    }\n\n    htmlCanvas.toBlob(blob => {\n      fn.downloadFile(blob, filename, extension);\n      if(temporaryGraphics) temporaryGraphics.remove();\n    }, mimeType);\n  };\n\n  // this is the old saveGif, left here for compatibility purposes\n  // the only place I found it being used was on image/p5.Image.js, on the\n  // save function. that has been changed to use this function.\n  fn.encodeAndDownloadGif = function(pImg, filename) {\n    const props = pImg.gifProperties;\n\n    //convert loopLimit back into Netscape Block formatting\n    let loopLimit = props.loopLimit;\n    if (loopLimit === 1) {\n      loopLimit = null;\n    } else if (loopLimit === null) {\n      loopLimit = 0;\n    }\n    const buffer = new Uint8Array(pImg.width * pImg.height * props.numFrames);\n\n    const allFramesPixelColors = [];\n\n    // Used to determine the occurrence of unique palettes and the frames\n    // which use them\n    const paletteFreqsAndFrames = {};\n\n    // Pass 1:\n    //loop over frames and get the frequency of each palette\n    for (let i = 0; i < props.numFrames; i++) {\n      const paletteSet = new Set();\n      const data = props.frames[i].image.data;\n      const dataLength = data.length;\n      // The color for each pixel in this frame ( for easier lookup later )\n      const pixelColors = new Uint32Array(pImg.width * pImg.height);\n      for (let j = 0, k = 0; j < dataLength; j += 4, k++) {\n        const r = data[j + 0];\n        const g = data[j + 1];\n        const b = data[j + 2];\n        const color = (r << 16) | (g << 8) | (b << 0);\n        paletteSet.add(color);\n\n        // What color does this pixel have in this frame ?\n        pixelColors[k] = color;\n      }\n\n      // A way to put use the entire palette as an object key\n      const paletteStr = [...paletteSet].sort().toString();\n      if (paletteFreqsAndFrames[paletteStr] === undefined) {\n        paletteFreqsAndFrames[paletteStr] = { freq: 1, frames: [i] };\n      } else {\n        paletteFreqsAndFrames[paletteStr].freq += 1;\n        paletteFreqsAndFrames[paletteStr].frames.push(i);\n      }\n\n      allFramesPixelColors.push(pixelColors);\n    }\n\n    let framesUsingGlobalPalette = [];\n\n    // Now to build the global palette\n    // Sort all the unique palettes in descending order of their occurrence\n    const palettesSortedByFreq = Object.keys(paletteFreqsAndFrames).sort(function(\n      a,\n      b\n    ) {\n      return paletteFreqsAndFrames[b].freq - paletteFreqsAndFrames[a].freq;\n    });\n\n    // The initial global palette is the one with the most occurrence\n    const globalPalette = palettesSortedByFreq[0]\n      .split(',')\n      .map(a => parseInt(a));\n\n    framesUsingGlobalPalette = framesUsingGlobalPalette.concat(\n      paletteFreqsAndFrames[globalPalette].frames\n    );\n\n    const globalPaletteSet = new Set(globalPalette);\n\n    // Build a more complete global palette\n    // Iterate over the remaining palettes in the order of\n    // their occurrence and see if the colors in this palette which are\n    // not in the global palette can be added there, while keeping the length\n    // of the global palette <= 256\n    for (let i = 1; i < palettesSortedByFreq.length; i++) {\n      const palette = palettesSortedByFreq[i].split(',').map(a => parseInt(a));\n\n      const difference = palette.filter(x => !globalPaletteSet.has(x));\n      if (globalPalette.length + difference.length <= 256) {\n        for (let j = 0; j < difference.length; j++) {\n          globalPalette.push(difference[j]);\n          globalPaletteSet.add(difference[j]);\n        }\n\n        // All frames using this palette now use the global palette\n        framesUsingGlobalPalette = framesUsingGlobalPalette.concat(\n          paletteFreqsAndFrames[palettesSortedByFreq[i]].frames\n        );\n      }\n    }\n\n    framesUsingGlobalPalette = new Set(framesUsingGlobalPalette);\n\n    // Build a lookup table of the index of each color in the global palette\n    // Maps a color to its index\n    const globalIndicesLookup = {};\n    for (let i = 0; i < globalPalette.length; i++) {\n      if (!globalIndicesLookup[globalPalette[i]]) {\n        globalIndicesLookup[globalPalette[i]] = i;\n      }\n    }\n\n    // force palette to be power of 2\n    let powof2 = 1;\n    while (powof2 < globalPalette.length) {\n      powof2 <<= 1;\n    }\n    globalPalette.length = powof2;\n\n    // global opts\n    const opts = {\n      loop: loopLimit,\n      palette: new Uint32Array(globalPalette)\n    };\n    const gifWriter = new omggif.GifWriter(buffer, pImg.width, pImg.height, opts);\n    let previousFrame = {};\n\n    // Pass 2\n    // Determine if the frame needs a local palette\n    // Also apply transparency optimization. This function will often blow up\n    // the size of a GIF if not for transparency. If a pixel in one frame has\n    // the same color in the previous frame, that pixel can be marked as\n    // transparent. We decide one particular color as transparent and make all\n    // transparent pixels take this color. This helps in later in compression.\n    for (let i = 0; i < props.numFrames; i++) {\n      const localPaletteRequired = !framesUsingGlobalPalette.has(i);\n      const palette = localPaletteRequired ? [] : globalPalette;\n      const pixelPaletteIndex = new Uint8Array(pImg.width * pImg.height);\n\n      // Lookup table mapping color to its indices\n      const colorIndicesLookup = {};\n\n      // All the colors that cannot be marked transparent in this frame\n      const cannotBeTransparent = new Set();\n\n      allFramesPixelColors[i].forEach((color, k) => {\n        if (localPaletteRequired) {\n          if (colorIndicesLookup[color] === undefined) {\n            colorIndicesLookup[color] = palette.length;\n            palette.push(color);\n          }\n          pixelPaletteIndex[k] = colorIndicesLookup[color];\n        } else {\n          pixelPaletteIndex[k] = globalIndicesLookup[color];\n        }\n\n        if (i > 0) {\n          // If even one pixel of this color has changed in this frame\n          // from the previous frame, we cannot mark it as transparent\n          if (allFramesPixelColors[i - 1][k] !== color) {\n            cannotBeTransparent.add(color);\n          }\n        }\n      });\n\n      const frameOpts = {};\n\n      // Transparency optimization\n      const canBeTransparent = palette.filter(a => !cannotBeTransparent.has(a));\n      if (canBeTransparent.length > 0) {\n        // Select a color to mark as transparent\n        const transparent = canBeTransparent[0];\n        const transparentIndex = localPaletteRequired\n          ? colorIndicesLookup[transparent]\n          : globalIndicesLookup[transparent];\n        if (i > 0) {\n          for (let k = 0; k < allFramesPixelColors[i].length; k++) {\n            // If this pixel in this frame has the same color in previous frame\n            if (allFramesPixelColors[i - 1][k] === allFramesPixelColors[i][k]) {\n              pixelPaletteIndex[k] = transparentIndex;\n            }\n          }\n          frameOpts.transparent = transparentIndex;\n          // If this frame has any transparency, do not dispose the previous frame\n          previousFrame.frameOpts.disposal = 1;\n        }\n      }\n      frameOpts.delay = props.frames[i].delay / 10; // Move timing back into GIF formatting\n      if (localPaletteRequired) {\n        // force palette to be power of 2\n        let powof2 = 1;\n        while (powof2 < palette.length) {\n          powof2 <<= 1;\n        }\n        palette.length = powof2;\n        frameOpts.palette = new Uint32Array(palette);\n      }\n      if (i > 0) {\n        // add the frame that came before the current one\n        gifWriter.addFrame(\n          0,\n          0,\n          pImg.width,\n          pImg.height,\n          previousFrame.pixelPaletteIndex,\n          previousFrame.frameOpts\n        );\n      }\n      // previous frame object should now have details of this frame\n      previousFrame = {\n        pixelPaletteIndex,\n        frameOpts\n      };\n    }\n\n    previousFrame.frameOpts.disposal = 1;\n    // add the last frame\n    gifWriter.addFrame(\n      0,\n      0,\n      pImg.width,\n      pImg.height,\n      previousFrame.pixelPaletteIndex,\n      previousFrame.frameOpts\n    );\n\n    const extension = 'gif';\n    const blob = new Blob([buffer.slice(0, gifWriter.end())], {\n      type: 'image/gif'\n    });\n    fn.downloadFile(blob, filename, extension);\n  };\n\n  /**\n   * Captures a sequence of frames from the canvas that can be saved as images.\n   *\n   * `saveFrames()` creates an array of frame objects. Each frame is stored as\n   * an object with its file type, file name, and image data as a string. For\n   * example, the first saved frame might have the following properties:\n   *\n   * `{ ext: 'png', filenmame: 'frame0', imageData: 'data:image/octet-stream;base64, abc123' }`.\n   *\n   * The first parameter, `filename`, sets the prefix for the file names. For\n   * example, setting the prefix to `'frame'` would generate the image files\n   * `frame0.png`, `frame1.png`, and so on.\n   *\n   * The second parameter, `extension`, sets the file type to either `'png'` or\n   * `'jpg'`.\n   *\n   * The third parameter, `duration`, sets the duration to record in seconds.\n   * The maximum duration is 15 seconds.\n   *\n   * The fourth parameter, `framerate`, sets the number of frames to record per\n   * second. The maximum frame rate value is 22. Limits are placed on `duration`\n   * and `framerate` to avoid using too much memory. Recording large canvases\n   * can easily crash sketches or even web browsers.\n   *\n   * The fifth parameter, `callback`, is optional. If a function is passed,\n   * image files won't be saved by default. The callback function can be used\n   * to process an array containing the data for each captured frame. The array\n   * of image data contains a sequence of objects with three properties for each\n   * frame: `imageData`, `filename`, and `extension`.\n   *\n   * Note: Frames are downloaded as individual image files by default.\n   *\n   * @method saveFrames\n   * @param  {String}   filename  prefix of file name.\n   * @param  {String}   extension file extension, either 'jpg' or 'png'.\n   * @param  {Number}   duration  duration in seconds to record. This parameter will be constrained to be less or equal to 15.\n   * @param  {Number}   framerate number of frames to save per second. This parameter will be constrained to be less or equal to 22.\n   * @param  {function(Array)} [callback] callback function that will be executed\n                                    to handle the image data. This function\n                                    should accept an array as argument. The\n                                    array will contain the specified number of\n                                    frames of objects. Each object has three\n                                    properties: `imageData`, `filename`, and `extension`.\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A square repeatedly changes color from blue to pink.');\n   * }\n   *\n   * function draw() {\n   *   let r = frameCount % 255;\n   *   let g = 50;\n   *   let b = 100;\n   *   background(r, g, b);\n   * }\n   *\n   * // Save the frames when the user presses the 's' key.\n   * function keyPressed() {\n   *   if (key === 's') {\n   *     saveFrames('frame', 'png', 1, 5);\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A square repeatedly changes color from blue to pink.');\n   * }\n   *\n   * function draw() {\n   *   let r = frameCount % 255;\n   *   let g = 50;\n   *   let b = 100;\n   *   background(r, g, b);\n   * }\n   *\n   * // Print 5 frames when the user presses the mouse.\n   * function mousePressed() {\n   *   saveFrames('frame', 'png', 1, 5, printFrames);\n   * }\n   *\n   * // Prints an array of objects containing raw image data, filenames, and extensions.\n   * function printFrames(frames) {\n   *   for (let frame of frames) {\n   *     print(frame);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.saveFrames = function(fName, ext, _duration, _fps, callback) {\n    // p5._validateParameters('saveFrames', arguments);\n    let duration = _duration || 3;\n    duration = Math.max(Math.min(duration, 15), 0);\n    duration = duration * 1000;\n    let fps = _fps || 15;\n    fps = Math.max(Math.min(fps, 22), 0);\n    let count = 0;\n\n    const makeFrame = fn._makeFrame;\n    const cnv = this._curElement.elt;\n    let frames = [];\n    const frameFactory = setInterval(() => {\n      frames.push(makeFrame(fName + count, ext, cnv));\n      count++;\n    }, 1000 / fps);\n\n    setTimeout(() => {\n      clearInterval(frameFactory);\n      if (callback) {\n        callback(frames);\n      } else {\n        for (const f of frames) {\n          fn.downloadFile(f.imageData, f.filename, f.ext);\n        }\n      }\n      frames = []; // clear frames\n    }, duration + 0.01);\n  };\n\n  fn._makeFrame = function(filename, extension, _cnv) {\n    let cnv;\n    if (this) {\n      cnv = this._curElement.elt;\n    } else {\n      cnv = _cnv;\n    }\n    let mimeType;\n    if (!extension) {\n      extension = 'png';\n      mimeType = 'image/png';\n    } else {\n      switch (extension.toLowerCase()) {\n        case 'png':\n          mimeType = 'image/png';\n          break;\n        case 'jpeg':\n          mimeType = 'image/jpeg';\n          break;\n        case 'jpg':\n          mimeType = 'image/jpeg';\n          break;\n        default:\n          mimeType = 'image/png';\n          break;\n      }\n    }\n    const downloadMime = 'image/octet-stream';\n    let imageData = cnv.toDataURL(mimeType);\n    imageData = imageData.replace(mimeType, downloadMime);\n\n    const thisFrame = {};\n    thisFrame.imageData = imageData;\n    thisFrame.filename = filename;\n    thisFrame.ext = extension;\n    return thisFrame;\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  image(p5, p5.prototype);\n}\n\n/**\n * @module IO\n * @submodule Input\n * @for p5\n * @requires core\n */\n\n\nclass HTTPError extends Error {\n  status;\n  response;\n  ok;\n}\n\nasync function request(path, type){\n  try {\n    const res = await fetch(path);\n\n    if (res.ok) {\n      let data;\n      switch(type) {\n        case 'json':\n          data = await res.json();\n          break;\n        case 'text':\n          data = await res.text();\n          break;\n        case 'arrayBuffer':\n          data = await res.arrayBuffer();\n          break;\n        case 'blob':\n          data = await res.blob();\n          break;\n        case 'bytes':\n          // TODO: Chrome does not implement res.bytes() yet\n          if(res.bytes){\n            data = await res.bytes();\n          }else {\n            const d = await res.arrayBuffer();\n            data = new Uint8Array(d);\n          }\n          break;\n        default:\n          throw new Error('Unsupported response type');\n      }\n\n      return { data, headers: res.headers };\n\n    } else {\n      const err = new HTTPError(res.statusText);\n      err.status = res.status;\n      err.response = res;\n      err.ok = false;\n\n      throw err;\n    }\n\n  } catch(err) {\n    // Handle both fetch error and HTTP error\n    if (err instanceof TypeError) {\n      console.log('You may have encountered a CORS error');\n    } else if (err instanceof HTTPError) {\n      console.log('You have encountered a HTTP error');\n    } else if (err instanceof SyntaxError) {\n      console.log('There is an error parsing the response to requested data structure');\n    }\n\n    throw err;\n  }\n}\n\nfunction files(p5, fn){\n  /**\n   * Loads a JSON file to create an `Object`.\n   *\n   * JavaScript Object Notation\n   * (<a href=\"https://developer.mozilla.org/en-US/docs/Glossary/JSON\" target=\"_blank\">JSON</a>)\n   * is a standard format for sending data between applications. The format is\n   * based on JavaScript objects which have keys and values. JSON files store\n   * data in an object with strings as keys. Values can be strings, numbers,\n   * Booleans, arrays, `null`, or other objects.\n   *\n   * The first parameter, `path`, is a string with the path to the file.\n   * Paths to local files should be relative, as in\n   * `loadJSON('assets/data.json')`. URLs such as\n   * `'https://example.com/data.json'` may be blocked due to browser security.\n   * The `path` parameter can also be defined as a [`Request`](https://developer.mozilla.org/en-US/docs/Web/API/Request)\n   * object for more advanced usage.\n   *\n   * The second parameter, `successCallback`, is optional. If a function is\n   * passed, as in `loadJSON('assets/data.json', handleData)`, then the\n   * `handleData()` function will be called once the data loads. The object\n   * created from the JSON data will be passed to `handleData()` as its only argument.\n   * The return value of the `handleData()` function will be used as the final return\n   * value of `loadJSON('assets/data.json', handleData)`.\n   *\n   * The third parameter, `failureCallback`, is also optional. If a function is\n   * passed, as in `loadJSON('assets/data.json', handleData, handleFailure)`,\n   * then the `handleFailure()` function will be called if an error occurs while\n   * loading. The `Error` object will be passed to `handleFailure()` as its only\n   * argument. The return value of the `handleFailure()` function will be used as the\n   * final return value of `loadJSON('assets/data.json', handleData, handleFailure)`.\n   *\n   * This function returns a `Promise` and should be used in an `async` setup with\n   * `await`. See the examples for the usage syntax.\n   *\n   * @method loadJSON\n   * @param  {String|Request} path path of the JSON file to be loaded.\n   * @param  {Function} [successCallback] function to call once the data is loaded. Will be passed the object.\n   * @param  {Function} [errorCallback] function to call if the data fails to load. Will be passed an `Error` event object.\n   * @return {Promise<Object>} object containing the loaded data.\n   *\n   * @example\n   *\n   * <div>\n   * <code>\n   * let myData;\n   *\n   * async function setup() {\n   *   myData = await loadJSON('assets/data.json');\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the circle.\n   *   fill(myData.color);\n   *   noStroke();\n   *\n   *   // Draw the circle.\n   *   circle(myData.x, myData.y, myData.d);\n   *\n   *   describe('A pink circle on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myData;\n   *\n   * async function setup() {\n   *   myData = await loadJSON('assets/data.json');\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Color object and make it transparent.\n   *   let c = color(myData.color);\n   *   c.setAlpha(80);\n   *\n   *   // Style the circles.\n   *   fill(c);\n   *   noStroke();\n   *\n   *   // Iterate over the myData.bubbles array.\n   *   for (let b of myData.bubbles) {\n   *     // Draw a circle for each bubble.\n   *     circle(b.x, b.y, b.d);\n   *   }\n   *\n   *   describe('Several pink bubbles floating in a blue sky.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myData;\n   *\n   * async function setup() {\n   *   myData = await loadJSON('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson');\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get data about the most recent earthquake.\n   *   let quake = myData.features[0].properties;\n   *\n   *   // Draw a circle based on the earthquake's magnitude.\n   *   circle(50, 50, quake.mag * 10);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(11);\n   *\n   *   // Display the earthquake's location.\n   *   text(quake.place, 5, 80, 100);\n   *\n   *   describe(`A white circle on a gray background. The text \"${quake.place}\" is written beneath the circle.`);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let bigQuake;\n   *\n   * // Load the GeoJSON and preprocess it.\n   * async function setup() {\n   *   await loadJSON(\n   *     'https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson',\n   *     handleData\n   *   );\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Draw a circle based on the earthquake's magnitude.\n   *   circle(50, 50, bigQuake.mag * 10);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(11);\n   *\n   *   // Display the earthquake's location.\n   *   text(bigQuake.place, 5, 80, 100);\n   *\n   *   describe(`A white circle on a gray background. The text \"${bigQuake.place}\" is written beneath the circle.`);\n   * }\n   *\n   * // Find the biggest recent earthquake.\n   * function handleData(data) {\n   *   let maxMag = 0;\n   *   // Iterate over the earthquakes array.\n   *   for (let quake of data.features) {\n   *     // Reassign bigQuake if a larger\n   *     // magnitude quake is found.\n   *     if (quake.properties.mag > maxMag) {\n   *       bigQuake = quake.properties;\n   *     }\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let bigQuake;\n   *\n   * // Load the GeoJSON and preprocess it.\n   * async function setup() {\n   *   await loadJSON(\n   *     'https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson',\n   *     handleData,\n   *     handleError\n   *   );\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Draw a circle based on the earthquake's magnitude.\n   *   circle(50, 50, bigQuake.mag * 10);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(11);\n   *\n   *   // Display the earthquake's location.\n   *   text(bigQuake.place, 5, 80, 100);\n   *\n   *   describe(`A white circle on a gray background. The text \"${bigQuake.place}\" is written beneath the circle.`);\n   * }\n   *\n   * // Find the biggest recent earthquake.\n   * function handleData(data) {\n   *   let maxMag = 0;\n   *   // Iterate over the earthquakes array.\n   *   for (let quake of data.features) {\n   *     // Reassign bigQuake if a larger\n   *     // magnitude quake is found.\n   *     if (quake.properties.mag > maxMag) {\n   *       bigQuake = quake.properties;\n   *     }\n   *   }\n   * }\n   *\n   * // Log any errors to the console.\n   * function handleError(error) {\n   *   console.log('Oops!', error);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.loadJSON = async function (path, successCallback, errorCallback) {\n    // p5._validateParameters('loadJSON', arguments);\n\n    try{\n      const { data } = await request(path, 'json');\n      if (successCallback) return successCallback(data);\n      return data;\n    } catch(err) {\n      p5._friendlyFileLoadError(5, path);\n      if(errorCallback) {\n        return errorCallback(err);\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  /**\n   * Loads a text file to create an `Array`.\n   *\n   * The first parameter, `path`, is always a string with the path to the file.\n   * Paths to local files should be relative, as in\n   * `loadStrings('assets/data.txt')`. URLs such as\n   * `'https://example.com/data.txt'` may be blocked due to browser security.\n   * The `path` parameter can also be defined as a [`Request`](https://developer.mozilla.org/en-US/docs/Web/API/Request)\n   * object for more advanced usage.\n   *\n   * The second parameter, `successCallback`, is optional. If a function is\n   * passed, as in `loadStrings('assets/data.txt', handleData)`, then the\n   * `handleData()` function will be called once the data loads. The array\n   * created from the text data will be passed to `handleData()` as its only\n   * argument. The return value of the `handleData()` function will be used as\n   * the final return value of `loadStrings('assets/data.txt', handleData)`.\n   *\n   * The third parameter, `failureCallback`, is also optional. If a function is\n   * passed, as in `loadStrings('assets/data.txt', handleData, handleFailure)`,\n   * then the `handleFailure()` function will be called if an error occurs while\n   * loading. The `Error` object will be passed to `handleFailure()` as its only\n   * argument. The return value of the `handleFailure()` function will be used as\n   * the final return value of `loadStrings('assets/data.txt', handleData, handleFailure)`.\n   *\n   * This function returns a `Promise` and should be used in an `async` setup with\n   * `await`. See the examples for the usage syntax.\n   *\n   * @method loadStrings\n   * @param  {String|Request} path path of the text file to be loaded.\n   * @param  {Function} [successCallback] function to call once the data is\n   *                                      loaded. Will be passed the array.\n   * @param  {Function} [errorCallback] function to call if the data fails to\n   *                                    load. Will be passed an `Error` event\n   *                                    object.\n   * @return {Promise<String[]>} new array containing the loaded text.\n   *\n   * @example\n   *\n   * <div>\n   * <code>\n   * let myData;\n   *\n   * async function setup() {\n   *   myData = await loadStrings('assets/test.txt');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Select a random line from the text.\n   *   let phrase = random(myData);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display the text.\n   *   text(phrase, 10, 50, 90);\n   *\n   *   describe(`The text \"${phrase}\" written in black on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let lastLine;\n   *\n   * // Load the text and preprocess it.\n   * async function setup() {\n   *   await loadStrings('assets/test.txt', handleData);\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display the text.\n   *   text(lastLine, 10, 50, 90);\n   *\n   *   describe('The text \"I talk like an orange\" written in black on a gray background.');\n   * }\n   *\n   * // Select the last line from the text.\n   * function handleData(data) {\n   *   lastLine = data[data.length - 1];\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let lastLine;\n   *\n   * // Load the text and preprocess it.\n   * async function setup() {\n   *   await loadStrings('assets/test.txt', handleData, handleError);\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display the text.\n   *   text(lastLine, 10, 50, 90);\n   *\n   *   describe('The text \"I talk like an orange\" written in black on a gray background.');\n   * }\n   *\n   * // Select the last line from the text.\n   * function handleData(data) {\n   *   lastLine = data[data.length - 1];\n   * }\n   *\n   * // Log any errors to the console.\n   * function handleError(error) {\n   *   console.error('Oops!', error);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.loadStrings = async function (path, successCallback, errorCallback) {\n    // p5._validateParameters('loadStrings', arguments);\n\n    try{\n      let { data } = await request(path, 'text');\n      data = data.split(/\\r?\\n/);\n\n      if (successCallback) return successCallback(data);\n      return data;\n    } catch(err) {\n      p5._friendlyFileLoadError(3, path);\n      if(errorCallback) {\n        return errorCallback(err);\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  /**\n   * Reads the contents of a file or URL and creates a <a href=\"#/p5.Table\">p5.Table</a> object with\n   * its values. If a file is specified, it must be located in the sketch's\n   * \"data\" folder. The filename parameter can also be a URL to a file found\n   * online. By default, the file is assumed to be comma-separated (in CSV\n   * format). Table only looks for a header row if the 'header' option is\n   * included.\n   *\n   * This function returns a `Promise` and should be used in an `async` setup with\n   * `await`. See the examples for the usage syntax.\n   *\n   * All files loaded and saved use UTF-8 encoding. This method is suitable for fetching files up to size of 64MB.\n   *\n   * @method loadTable\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param  {String|Request} filename    name of the file or URL to load\n   * @param  {String}         [separator] the separator character used by the file, defaults to `','`\n   * @param  {String}         [header]    \"header\" to indicate table has header row\n   * @param  {Function}       [callback]  function to be executed after\n   *                                      <a href=\"#/p5/loadTable\">loadTable()</a> completes. On success, the\n   *                                      <a href=\"#/p5.Table\">Table</a> object is passed in as the\n   *                                      first argument.\n   * @param  {Function}  [errorCallback]  function to be executed if\n   *                                      there is an error, response is passed\n   *                                      in as first argument\n   * @return {Promise<Object>}            <a href=\"#/p5.Table\">Table</a> object containing data\n   *\n   * @example\n   * <div class='norender'>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas\n   *   createCanvas(200, 200);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Get the second row (index 1)\n   *   let row = table.getRow(1);\n   *\n   *   // Set text properties\n   *   fill(0);       // Set text color to black\n   *   textSize(16);  // Adjust text size as needed\n   *\n   *   // Display each column value in the row on the canvas.\n   *   // Using an offset for y-position so each value appears on a new line.\n   *   for (let c = 0; c < table.getColumnCount(); c++) {\n   *     text(row.getString(c), 10, 30 + c * 20);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.loadTable = async function (path, separator, header, successCallback, errorCallback) {\n    if(typeof arguments[arguments.length-1] === 'function'){\n      if(typeof arguments[arguments.length-2] === 'function'){\n        successCallback = arguments[arguments.length-2];\n        errorCallback = arguments[arguments.length-1];\n      }else {\n        successCallback = arguments[arguments.length-1];\n      }\n    }\n\n    if(typeof separator !== 'string') separator = ',';\n    if(typeof header === 'function') header = false;\n\n    try{\n      let { data } = await request(path, 'text');\n\n      let ret = new p5.Table();\n      data = parse(data, {\n        separator\n      });\n\n      if(header){\n        ret.columns = data.shift();\n      }else {\n        ret.columns = Array(data[0].length).fill(null);\n      }\n\n      data.forEach((line) => {\n        const row = new p5.TableRow(line);\n        ret.addRow(row);\n      });\n\n      if (successCallback) {\n        return successCallback(ret);\n      } else {\n        return ret;\n      }\n    } catch(err) {\n      p5._friendlyFileLoadError(2, path);\n      if(errorCallback) {\n        return errorCallback(err);\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  /**\n   * Loads an XML file to create a <a href=\"#/p5.XML\">p5.XML</a> object.\n   *\n   * Extensible Markup Language\n   * (<a href=\"https://developer.mozilla.org/en-US/docs/Web/XML/XML_introduction\" target=\"_blank\">XML</a>)\n   * is a standard format for sending data between applications. Like HTML, the\n   * XML format is based on tags and attributes, as in\n   * `&lt;time units=\"s\"&gt;1234&lt;/time&gt;`.\n   *\n   * The first parameter, `path`, is always a string with the path to the file.\n   * Paths to local files should be relative, as in\n   * `loadXML('assets/data.xml')`. URLs such as `'https://example.com/data.xml'`\n   * may be blocked due to browser security. The `path` parameter can also be defined\n   * as a [`Request`](https://developer.mozilla.org/en-US/docs/Web/API/Request)\n   * object for more advanced usage.\n   *\n   * The second parameter, `successCallback`, is optional. If a function is\n   * passed, as in `loadXML('assets/data.xml', handleData)`, then the\n   * `handleData()` function will be called once the data loads. The\n   * <a href=\"#/p5.XML\">p5.XML</a> object created from the data will be passed\n   * to `handleData()` as its only argument. The return value of the `handleData()`\n   * function will be used as the final return value of `loadXML('assets/data.xml', handleData)`.\n   *\n   * The third parameter, `failureCallback`, is also optional. If a function is\n   * passed, as in `loadXML('assets/data.xml', handleData, handleFailure)`, then\n   * the `handleFailure()` function will be called if an error occurs while\n   * loading. The `Error` object will be passed to `handleFailure()` as its only\n   * argument. The return value of the `handleFailure()` function will be used as the\n   * final return value of `loadXML('assets/data.xml', handleData, handleFailure)`.\n   *\n   * This function returns a `Promise` and should be used in an `async` setup with\n   * `await`. See the examples for the usage syntax.\n   *\n   * @method loadXML\n   * @param  {String|Request} path        path of the XML file to be loaded.\n   * @param  {Function} [successCallback] function to call once the data is\n   *                                      loaded. Will be passed the\n   *                                      <a href=\"#/p5.XML\">p5.XML</a> object.\n   * @param  {Function} [errorCallback] function to call if the data fails to\n   *                                    load. Will be passed an `Error` event\n   *                                    object.\n   * @return {Promise<p5.XML>} XML data loaded into a <a href=\"#/p5.XML\">p5.XML</a>\n   *                  object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myXML;\n   *\n   * // Load the XML and create a p5.XML object.\n   * async function setup() {\n   *   myXML = await loadXML('assets/animals.xml');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get an array with all mammal tags.\n   *   let mammals = myXML.getChildren('mammal');\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(14);\n   *\n   *   // Iterate over the mammals array.\n   *   for (let i = 0; i < mammals.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 25;\n   *\n   *     // Get the mammal's common name.\n   *     let name = mammals[i].getContent();\n   *\n   *     // Display the mammal's name.\n   *     text(name, 20, y);\n   *   }\n   *\n   *   describe(\n   *     'The words \"Goat\", \"Leopard\", and \"Zebra\" written on three separate lines. The text is black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let lastMammal;\n   *\n   * // Load the XML and create a p5.XML object.\n   * async function setup() {\n   *   await loadXML('assets/animals.xml', handleData);\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(16);\n   *\n   *   // Display the content of the last mammal element.\n   *   text(lastMammal, 50, 50);\n   *\n   *   describe('The word \"Zebra\" written in black on a gray background.');\n   * }\n   *\n   * // Get the content of the last mammal element.\n   * function handleData(data) {\n   *   // Get an array with all mammal elements.\n   *   let mammals = data.getChildren('mammal');\n   *\n   *   // Get the content of the last mammal.\n   *   lastMammal = mammals[mammals.length - 1].getContent();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let lastMammal;\n   *\n   * // Load the XML and preprocess it.\n   * async function setup() {\n   *   await loadXML('assets/animals.xml', handleData, handleError);\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(16);\n   *\n   *   // Display the content of the last mammal element.\n   *   text(lastMammal, 50, 50);\n   *\n   *   describe('The word \"Zebra\" written in black on a gray background.');\n   * }\n   *\n   * // Get the content of the last mammal element.\n   * function handleData(data) {\n   *   // Get an array with all mammal elements.\n   *   let mammals = data.getChildren('mammal');\n   *\n   *   // Get the content of the last mammal.\n   *   lastMammal = mammals[mammals.length - 1].getContent();\n   * }\n   *\n   * // Log any errors to the console.\n   * function handleError(error) {\n   *   console.error('Oops!', error);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.loadXML = async function (path, successCallback, errorCallback) {\n    try{\n      const parser = new DOMParser();\n\n      let { data } = await request(path, 'text');\n      const parsedDOM = parser.parseFromString(data, 'application/xml');\n      data = new p5.XML(parsedDOM);\n\n      if (successCallback) return successCallback(data);\n      return data;\n    } catch(err) {\n      p5._friendlyFileLoadError(1, path);\n      if(errorCallback) {\n        return errorCallback(err);\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  /**\n   * This method is suitable for fetching files up to size of 64MB.\n   *\n   * @method loadBytes\n   * @param {String|Request}   file            name of the file or URL to load\n   * @param {Function} [callback]      function to be executed after <a href=\"#/p5/loadBytes\">loadBytes()</a>\n   *                                    completes\n   * @param {Function} [errorCallback] function to be executed if there\n   *                                    is an error\n   * @returns {Promise<Uint8Array>} a Uint8Array containing the loaded buffer\n   *\n   * @example\n   *\n   * <div>\n   * <code>\n   * let data;\n   *\n   * async function setup() {\n   * createCanvas(100, 100); // Create a canvas\n   * data = await loadBytes('assets/mammals.xml'); // Load the bytes from the XML file\n   *\n   * background(255); // Set a white background\n   * fill(0);       // Set text color to black\n   *\n   * // Display the first 5 byte values on the canvas in hexadecimal format\n   * for (let i = 0; i < 5; i++) {\n   * let byteHex = data[i].toString(16);\n   * text(byteHex, 10, 18 * (i + 1)); // Adjust spacing as needed\n   * }\n   *\n   * describe('no image displayed, displays first 5 bytes of mammals.xml in hexadecimal format');\n   * }\n   * </code>\n   * </div>\n   */\n\n  fn.loadBytes = async function (path, successCallback, errorCallback) {\n    try{\n      let { data } = await request(path, 'arrayBuffer');\n      data = new Uint8Array(data);\n      if (successCallback) return successCallback(data);\n      return data;\n    } catch(err) {\n      p5._friendlyFileLoadError(6, path);\n      if(errorCallback) {\n        return errorCallback(err);\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  /**\n   * Loads a file at the given path as a Blob, then returns the resulting data or\n   * passes it to a success callback function, if provided. On load, this function\n   * returns a `Promise` that resolves to a Blob containing the file data.\n   *\n   * @method loadBlob\n   * @param {String|Request} path - The path or Request object pointing to the file\n   *                                you want to load.\n   * @param {Function} [successCallback] - Optional. A function to be called if the\n   *                                       file successfully loads, receiving the\n   *                                       resulting Blob as its only argument.\n   * @param {Function} [errorCallback] - Optional. A function to be called if an\n   *                                     error occurs during loading; receives the\n   *                                     error object as its only argument.\n   * @returns {Promise<Blob>} A promise that resolves with the loaded Blob.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myBlob;\n   *\n   * async function setup() {\n   *   createCanvas(200, 200);\n   *   background(220);\n   *   try {\n   *     // 1. Load an image file as a Blob.\n   *     myBlob = await loadBlob('assets/flower-1.png');\n   *\n   *     // 2. Convert the Blob into an object URL.\n   *     const objectUrl = URL.createObjectURL(myBlob);\n   *\n   *     // 3. Load that object URL into a p5.Image.\n   *     loadImage(objectUrl, (img) => {\n   *       // 4. Display the loaded image.\n   *       image(img, 0, 0, width, height);\n   *     });\n   *   } catch (err) {\n   *     console.error('Error loading blob:', err);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.loadBlob = async function(path, successCallback, errorCallback) {\n    try{\n      const { data } = await request(path, 'blob');\n      if (successCallback) return successCallback(data);\n      return data;\n    } catch(err) {\n      if(errorCallback) {\n        return errorCallback(err);\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  /**\n   * Method for executing an HTTP GET request. If data type is not specified,\n   * it will default to `'text'`. This is equivalent to\n   * calling <code>httpDo(path, 'GET')</code>. The 'binary' datatype will return\n   * a Blob object, and the 'arrayBuffer' datatype will return an ArrayBuffer\n   * which can be used to initialize typed arrays (such as Uint8Array).\n   *\n   * @method httpGet\n   * @param  {String|Request}        path       name of the file or url to load\n   * @param  {String}        [datatype] \"json\", \"jsonp\", \"binary\", \"arrayBuffer\",\n   *                                    \"xml\", or \"text\"\n   * @param  {Function}      [callback] function to be executed after\n   *                                    <a href=\"#/p5/httpGet\">httpGet()</a> completes, data is passed in\n   *                                    as first argument\n   * @param  {Function}      [errorCallback] function to be executed if\n   *                                    there is an error, response is passed\n   *                                    in as first argument\n   * @return {Promise} A promise that resolves with the data when the operation\n   *                   completes successfully or rejects with the error after\n   *                   one occurs.\n   * @example\n   * <div class='norender'><code>\n   * // Examples use USGS Earthquake API:\n   * //   https://earthquake.usgs.gov/fdsnws/event/1/#methods\n   * let earthquakes;\n   * async function setup() {\n   *   // Get the most recent earthquake in the database\n   *   let url =\n      'https://earthquake.usgs.gov/fdsnws/event/1/query?' +\n   *     'format=geojson&limit=1&orderby=time';\n   *   earthquakes = await httpGet(url, 'json');\n   * }\n   *\n   * function draw() {\n   *   if (!earthquakes) {\n   *     // Wait until the earthquake data has loaded before drawing.\n   *     return;\n   *   }\n   *   background(200);\n   *   // Get the magnitude and name of the earthquake out of the loaded JSON\n   *   let earthquakeMag = earthquakes.features[0].properties.mag;\n   *   let earthquakeName = earthquakes.features[0].properties.place;\n   *   ellipse(width / 2, height / 2, earthquakeMag * 10, earthquakeMag * 10);\n   *   textAlign(CENTER);\n   *   text(earthquakeName, 0, height - 30, width, 30);\n   *   noLoop();\n   * }\n   * </code></div>\n   */\n  /**\n   * @method httpGet\n   * @param  {String|Request}  path\n   * @param  {Function}        callback\n   * @param  {Function}        [errorCallback]\n   * @return {Promise}\n   */\n  fn.httpGet = async function (path, datatype='text', successCallback, errorCallback) {\n    // p5._validateParameters('httpGet', arguments);\n\n    if (typeof datatype === 'function') {\n      errorCallback = successCallback;\n      successCallback = datatype;\n      datatype = 'text';\n    }\n\n    // This is like a more primitive version of the other load functions.\n    // If the user wanted to customize more behavior, pass in Request to path.\n\n    return this.httpDo(path, 'GET', datatype, successCallback, errorCallback);\n  };\n\n  /**\n   * Method for executing an HTTP POST request. If data type is not specified,\n   * it will default to `'text'`. This is equivalent to\n   * calling <code>httpDo(path, 'POST')</code>.\n   *\n   * @method httpPost\n   * @param  {String|Request} path       name of the file or url to load\n   * @param  {Object|Boolean} [data]     param data passed sent with request\n   * @param  {String}         [datatype] \"json\", \"jsonp\", \"xml\", or \"text\".\n   *                                    If omitted, <a href=\"#/p5/httpPost\">httpPost()</a> will guess.\n   * @param  {Function}       [callback] function to be executed after\n   *                                     <a href=\"#/p5/httpPost\">httpPost()</a> completes, data is passed in\n   *                                     as first argument\n   * @param  {Function}       [errorCallback] function to be executed if\n   *                                          there is an error, response is passed\n   *                                          in as first argument\n   * @return {Promise} A promise that resolves with the data when the operation\n   *                   completes successfully or rejects with the error after\n   *                   one occurs.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Examples use jsonplaceholder.typicode.com for a Mock Data API\n   *\n   * let url = 'https://jsonplaceholder.typicode.com/posts';\n   * let postData = { userId: 1, title: 'p5 Clicked!', body: 'p5.js is very cool.' };\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(200);\n   * }\n   *\n   * function mousePressed() {\n   *   httpPost(url, postData, 'json', function(result) {\n   *     strokeWeight(2);\n   *     text(result.body, mouseX, mouseY);\n   *   });\n   * }\n   * </code>\n   * </div>\n   *\n   * <div><code>\n   * let url = 'ttps://invalidURL'; // A bad URL that will cause errors\n   * let postData = { title: 'p5 Clicked!', body: 'p5.js is very cool.' };\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(200);\n   * }\n   *\n   * function mousePressed() {\n   *   httpPost(\n   *     url,\n   *     postData,\n   *     'json',\n   *     function(result) {\n   *       // ... won't be called\n   *     },\n   *     function(error) {\n   *       strokeWeight(2);\n   *       text(error.toString(), mouseX, mouseY);\n   *     }\n   *   );\n   * }\n   * </code></div>\n   */\n  /**\n   * @method httpPost\n   * @param  {String|Request}    path\n   * @param  {Object|Boolean}    data\n   * @param  {Function}         [callback]\n   * @param  {Function}         [errorCallback]\n   * @return {Promise}\n   */\n  /**\n   * @method httpPost\n   * @param  {String|Request}    path\n   * @param  {Function}         [callback]\n   * @param  {Function}         [errorCallback]\n   * @return {Promise}\n   */\n  fn.httpPost = async function (path, data, datatype='text', successCallback, errorCallback) {\n    // p5._validateParameters('httpPost', arguments);\n\n    // This behave similarly to httpGet and additional options should be passed\n    // as a `Request`` to path. Both method and body will be overridden.\n    // Will try to infer correct Content-Type for given data.\n\n    if (typeof data === 'function') {\n      // Assume both data and datatype are functions as data should not be function\n      successCallback = data;\n      errorCallback = datatype;\n      data = undefined;\n      datatype = 'text';\n\n    } else if (typeof datatype === 'function') {\n      // Data is provided but not datatype\\\n      errorCallback = successCallback;\n      successCallback = datatype;\n      datatype = 'text';\n    }\n\n    let reqData = data;\n    let contentType = 'text/plain';\n    // Normalize data\n    if(data instanceof p5.XML) {\n      reqData = data.serialize();\n      contentType = 'application/xml';\n\n    } else if(data instanceof p5.Image) {\n      reqData = await data.toBlob();\n      contentType = 'image/png';\n\n    } else if (typeof data === 'object') {\n      reqData = JSON.stringify(data);\n      contentType = 'application/json';\n    }\n\n    const requestOptions = {\n      method: 'POST',\n      body: reqData,\n      headers: {\n        'Content-Type': contentType\n      }\n    };\n\n    if (reqData) {\n      requestOptions.body = reqData;\n    }\n\n    const req = new Request(path, requestOptions);\n\n    return this.httpDo(req, 'POST', datatype, successCallback, errorCallback);\n  };\n\n  /**\n   * Method for executing an HTTP request. If data type is not specified,\n   * it will default to `'text'`.\n   *\n   * This function is meant for more advanced usage of HTTP requests in p5.js. It is\n   * best used when a [`Request`](https://developer.mozilla.org/en-US/docs/Web/API/Request)\n   * object is passed to the `path` parameter.\n   *\n   * This method is suitable for fetching files up to size of 64MB when \"GET\" is used.\n   *\n   * @method httpDo\n   * @param  {String|Request}   path      name of the file or url to load\n   * @param  {String}           [method]    either \"GET\", \"POST\", \"PUT\", \"DELETE\",\n   *                                      or other HTTP request methods\n   * @param  {String}          [datatype] \"json\", \"jsonp\", \"xml\", or \"text\"\n   * @param  {Object}          [data]     param data passed sent with request\n   * @param  {Function}        [callback] function to be executed after\n   *                                      <a href=\"#/p5/httpGet\">httpGet()</a> completes, data is passed in\n   *                                      as first argument\n   * @param  {Function}        [errorCallback] function to be executed if\n   *                                      there is an error, response is passed\n   *                                      in as first argument\n   * @return {Promise} A promise that resolves with the data when the operation\n   *                   completes successfully or rejects with the error after\n   *                   one occurs.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Examples use USGS Earthquake API:\n   * // https://earthquake.usgs.gov/fdsnws/event/1/#methods\n   *\n   * // displays an animation of all USGS earthquakes\n   * let earthquakes;\n   * let eqFeatureIndex = 0;\n   *\n   * function setup() {\n   *  createCanvas(100,100);\n   * \n   *   let url = 'https://earthquake.usgs.gov/fdsnws/event/1/query?format=geojson';\n   * \n   *   const req = new Request(url, {\n   *    method: 'GET',\n   *    headers: {authorization: 'Bearer secretKey'}\n   *  });\n   *  // httpDo(path, method, datatype, success, error) \n   * \n   *   httpDo(\n   *     req,\n   *     'GET',\n   *    'json',\n   *     res => {\n   *      earthquakes = res;\n   *     },\n   *    err => {\n   *      console.error('Error loading data:', err);\n   *    }\n   *  );\n   * }\n   * \n   * function draw() {\n   *   // wait until the data is loaded\n   *   if (!earthquakes || !earthquakes.features[eqFeatureIndex]) {\n   *     return;\n   *   }\n   *   clear();\n   *\n   *   let feature = earthquakes.features[eqFeatureIndex];\n   *   let mag = feature.properties.mag;\n   *   let rad = mag / 11 * ((width + height) / 2);\n   *   fill(255, 0, 0, 100);\n   *   ellipse(width / 2 + random(-2, 2), height / 2 + random(-2, 2), rad, rad);\n   *\n   *   if (eqFeatureIndex >= earthquakes.features.length) {\n   *     eqFeatureIndex = 0;\n   *   } else {\n   *     eqFeatureIndex += 1;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method httpDo\n   * @param  {String|Request}    path\n   * @param  {Function}         [callback]\n   * @param  {Function}         [errorCallback]\n   * @return {Promise}\n   */\n  fn.httpDo = async function (path, method, datatype, successCallback, errorCallback) {\n    // This behave similarly to httpGet but even more primitive. The user\n    // will most likely want to pass in a Request to path, the only convenience\n    // is that datatype will be taken into account to parse the response.\n\n    if(typeof datatype === 'function'){\n      errorCallback = successCallback;\n      successCallback = datatype;\n      datatype = undefined;\n    }\n\n    // Try to infer data type if it is defined\n    if(!datatype){\n      const extension = typeof path === 'string' ?\n        path.split(\".\").pop() :\n        path.url.split(\".\").pop();\n      switch(extension) {\n        case 'json':\n          datatype = 'json';\n          break;\n\n        case 'jpg':\n        case 'jpeg':\n        case 'png':\n        case 'webp':\n        case 'gif':\n          datatype = 'blob';\n          break;\n\n        case 'xml':\n          // NOTE: still need to normalize type handling/mapping\n          // datatype = 'xml';\n        case 'txt':\n        default:\n          datatype = 'text';\n      }\n    }\n\n    const req = new Request(path, {\n      method\n    });\n\n    try{\n      const { data } = await request(req, datatype);\n      if (successCallback) {\n        return successCallback(data);\n      } else {\n        return data;\n      }\n    } catch(err) {\n      if(errorCallback) {\n        return errorCallback(err);\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  /**\n   * @module IO\n   * @submodule Output\n   * @for p5\n   */\n  // private array of p5.PrintWriter objects\n  fn._pWriters = [];\n\n  /**\n   * Creates a new <a href=\"#/p5.PrintWriter\">p5.PrintWriter</a> object.\n   *\n   * <a href=\"#/p5.PrintWriter\">p5.PrintWriter</a> objects provide a way to\n   * save a sequence of text data, called the *print stream*, to the user's\n   * computer. They're low-level objects that enable precise control of text\n   * output. Functions such as\n   * <a href=\"#/p5/saveStrings\">saveStrings()</a> and\n   * <a href=\"#/p5/saveJSON\">saveJSON()</a> are easier to use for simple file\n   * saving.\n   *\n   * The first parameter, `filename`, is the name of the file to be written. If\n   * a string is passed, as in `createWriter('words.txt')`, a new\n   * <a href=\"#/p5.PrintWriter\">p5.PrintWriter</a> object will be created that\n   * writes to a file named `words.txt`.\n   *\n   * The second parameter, `extension`, is optional. If a string is passed, as\n   * in `createWriter('words', 'csv')`, the first parameter will be interpreted\n   * as the file name and the second parameter as the extension.\n   *\n   * @method createWriter\n   * @param {String} name name of the file to create.\n   * @param {String} [extension] format to use for the file.\n   * @return {p5.PrintWriter} stream for writing data.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display instructions.\n   *   text('Double-click to save', 5, 50, 90);\n   *\n   *   describe('The text \"Double-click to save\" written in black on a gray background.');\n   * }\n   *\n   * // Save the file when the user double-clicks.\n   * function doubleClicked() {\n   *   if (mouseX > 0 && mouseX < 100 && mouseY > 0 && mouseY < 100) {\n   *     // Create a p5.PrintWriter object.\n   *     let myWriter = createWriter('xo.txt');\n   *\n   *     // Add some lines to the print stream.\n   *     myWriter.print('XOO');\n   *     myWriter.print('OXO');\n   *     myWriter.print('OOX');\n   *\n   *     // Save the file and close the print stream.\n   *     myWriter.close();\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display instructions.\n   *   text('Double-click to save', 5, 50, 90);\n   *\n   *   describe('The text \"Double-click to save\" written in black on a gray background.');\n   * }\n   *\n   * // Save the file when the user double-clicks.\n   * function doubleClicked() {\n   *   if (mouseX > 0 && mouseX < 100 && mouseY > 0 && mouseY < 100) {\n   *     // Create a p5.PrintWriter object.\n   *     // Use the file format .csv.\n   *     let myWriter = createWriter('mauna_loa_co2', 'csv');\n   *\n   *     // Add some lines to the print stream.\n   *     myWriter.print('date,ppm_co2');\n   *     myWriter.print('1960-01-01,316.43');\n   *     myWriter.print('1970-01-01,325.06');\n   *     myWriter.print('1980-01-01,337.9');\n   *     myWriter.print('1990-01-01,353.86');\n   *     myWriter.print('2000-01-01,369.45');\n   *     myWriter.print('2020-01-01,413.61');\n   *\n   *     // Save the file and close the print stream.\n   *     myWriter.close();\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createWriter = function (name, extension) {\n    let newPW;\n    // check that it doesn't already exist\n    for (const i in fn._pWriters) {\n      if (fn._pWriters[i].name === name) {\n        // if a p5.PrintWriter w/ this name already exists...\n        // return fn._pWriters[i]; // return it w/ contents intact.\n        // or, could return a new, empty one with a unique name:\n        newPW = new p5.PrintWriter(name + this.millis(), extension);\n        fn._pWriters.push(newPW);\n        return newPW;\n      }\n    }\n    newPW = new p5.PrintWriter(name, extension);\n    fn._pWriters.push(newPW);\n    return newPW;\n  };\n\n  /**\n   * A class to describe a print stream.\n   *\n   * Each `p5.PrintWriter` object provides a way to save a sequence of text\n   * data, called the *print stream*, to the user's computer. It's a low-level\n   * object that enables precise control of text output. Functions such as\n   * <a href=\"#/p5/saveStrings\">saveStrings()</a> and\n   * <a href=\"#/p5/saveJSON\">saveJSON()</a> are easier to use for simple file\n   * saving.\n   *\n   * Note: <a href=\"#/p5/createWriter\">createWriter()</a> is the recommended way\n   * to make an instance of this class.\n   *\n   * @class p5.PrintWriter\n   * @param  {String} filename name of the file to create.\n   * @param  {String} [extension] format to use for the file.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display instructions.\n   *   text('Double-click to save', 5, 50, 90);\n   *\n   *   describe('The text \"Double-click to save\" written in black on a gray background.');\n   * }\n   *\n   * // Save the file when the user double-clicks.\n   * function doubleClicked() {\n   *   // Create a p5.PrintWriter object.\n   *   let myWriter = createWriter('xo.txt');\n   *\n   *   // Add some lines to the print stream.\n   *   myWriter.print('XOO');\n   *   myWriter.print('OXO');\n   *   myWriter.print('OOX');\n   *\n   *   // Save the file and close the print stream.\n   *   myWriter.close();\n   * }\n   * </code>\n   * </div>\n   */\n  p5.PrintWriter = function (filename, extension) {\n    let self = this;\n    this.name = filename;\n    this.content = '';\n\n    /**\n     * Writes data to the print stream without adding new lines.\n     *\n     * The parameter, `data`, is the data to write. `data` can be a number or\n     * string, as in `myWriter.write('hi')`, or an array of numbers and strings,\n     * as in `myWriter.write([1, 2, 3])`. A comma will be inserted between array\n     * array elements when they're added to the print stream.\n     *\n     * @method write\n     * @param {String|Number|Array} data data to be written as a string, number,\n     *                                   or array of strings and numbers.\n     *\n     * @example\n     * <div>\n     * <code>\n     * function setup() {\n     *   createCanvas(100, 100);\n     *\n     *   background(200);\n     *\n     *   // Style the text.\n     *   textAlign(LEFT, CENTER);\n     *   textFont('Courier New');\n     *   textSize(12);\n     *\n     *   // Display instructions.\n     *   text('Double-click to save', 5, 50, 90);\n     *\n     *   describe('The text \"Double-click to save\" written in black on a gray background.');\n     * }\n     *\n     * // Save the file when the user double-clicks.\n     * function doubleClicked() {\n     *   // Create a p5.PrintWriter object.\n     *   let myWriter = createWriter('numbers.txt');\n     *\n     *   // Add some data to the print stream.\n     *   myWriter.write('1,2,3,');\n     *   myWriter.write(['4', '5', '6']);\n     *\n     *   // Save the file and close the print stream.\n     *   myWriter.close();\n     * }\n     * </code>\n     * </div>\n     */\n    this.write = function (data) {\n      this.content += data;\n    };\n\n    /**\n     * Writes data to the print stream with new lines added.\n     *\n     * The parameter, `data`, is the data to write. `data` can be a number or\n     * string, as in `myWriter.print('hi')`, or an array of numbers and strings,\n     * as in `myWriter.print([1, 2, 3])`. A comma will be inserted between array\n     * array elements when they're added to the print stream.\n     *\n     * @method print\n     * @param {String|Number|Array} data data to be written as a string, number,\n     *                                   or array of strings and numbers.\n     *\n     * @example\n     * <div>\n     * <code>\n     * function setup() {\n     *   createCanvas(100, 100);\n     *\n     *   background(200);\n     *\n     *   // Style the text.\n     *   textAlign(LEFT, CENTER);\n     *   textFont('Courier New');\n     *   textSize(12);\n     *\n     *   // Display instructions.\n     *   text('Double-click to save', 5, 50, 90);\n     *\n     *   describe('The text \"Double-click to save\" written in black on a gray background.');\n     * }\n     *\n     * // Save the file when the user double-clicks.\n     * function doubleClicked() {\n     *   // Create a p5.PrintWriter object.\n     *   let myWriter = createWriter('numbers.txt');\n     *\n     *   // Add some data to the print stream.\n     *   myWriter.print('1,2,3,');\n     *   myWriter.print(['4', '5', '6']);\n     *\n     *   // Save the file and close the print stream.\n     *   myWriter.close();\n     * }\n     * </code>\n     * </div>\n     */\n    this.print = function (data) {\n      this.content += `${data}\\n`;\n    };\n\n    /**\n     * Clears all data from the print stream.\n     *\n     * @method clear\n     *\n     * @example\n     * <div>\n     * <code>\n     * function setup() {\n     *   createCanvas(100, 100);\n     *\n     *   background(200);\n     *\n     *   // Style the text.\n     *   textAlign(LEFT, CENTER);\n     *   textFont('Courier New');\n     *   textSize(12);\n     *\n     *   // Display instructions.\n     *   text('Double-click to save', 5, 50, 90);\n     *\n     *   describe('The text \"Double-click to save\" written in black on a gray background.');\n     * }\n     *\n     * // Save the file when the user double-clicks.\n     * function doubleClicked() {\n     *   // Create a p5.PrintWriter object.\n     *   let myWriter = createWriter('numbers.txt');\n     *\n     *   // Add some data to the print stream.\n     *   myWriter.print('Hello p5*js!');\n     *\n     *   // Clear the print stream.\n     *   myWriter.clear();\n     *\n     *   // Save the file and close the print stream.\n     *   myWriter.close();\n     * }\n     * </code>\n     * </div>\n     */\n    this.clear = function () {\n      this.content = '';\n    };\n\n    /**\n     * Saves the file and closes the print stream.\n     *\n     * @method close\n     *\n     * @example\n     * <div>\n     * <code>\n     * function setup() {\n     *   createCanvas(100, 100);\n     *\n     *   background(200);\n     *\n     *   // Style the text.\n     *   textAlign(LEFT, CENTER);\n     *   textFont('Courier New');\n     *   textSize(12);\n     *\n     *   // Display instructions.\n     *   text('Double-click to save', 5, 50, 90);\n     *\n     *   describe('The text \"Double-click to save\" written in black on a gray background.');\n     * }\n     *\n     * // Save the file when the user double-clicks.\n     * function doubleClicked() {\n     *   // Create a p5.PrintWriter object.\n     *   let myWriter = createWriter('cat.txt');\n     *\n     *   // Add some data to the print stream.\n     *   // ASCII art courtesy Wikipedia:\n     *   // https://en.wikipedia.org/wiki/ASCII_art\n     *   myWriter.print(' (\\\\_/) ');\n     *   myWriter.print(\"(='.'=)\");\n     *   myWriter.print('(\")_(\")');\n     *\n     *   // Save the file and close the print stream.\n     *   myWriter.close();\n     * }\n     * </code>\n     * </div>\n     */\n    this.close = function () {\n      // convert String to Array for the writeFile Blob\n      const arr = [];\n      arr.push(this.content);\n      fn.writeFile(arr, filename, extension);\n      // remove from _pWriters array and delete self\n      for (const i in fn._pWriters) {\n        if (fn._pWriters[i].name === this.name) {\n          // remove from _pWriters array\n          fn._pWriters.splice(i, 1);\n        }\n      }\n      self.clear();\n      self = {};\n    };\n  };\n\n  /**\n   * @module IO\n   * @submodule Output\n   * @for p5\n   */\n\n  // object, filename, options --> saveJSON, saveStrings,\n  // filename, [extension] [canvas] --> saveImage\n\n  /**\n   *  Saves a given element(image, text, json, csv, wav, or html) to the client's\n   *  computer. The first parameter can be a pointer to element we want to save.\n   *  The element can be one of <a href=\"#/p5.Element\">p5.Element</a>,an Array of\n   *  Strings, an Array of JSON, a JSON object, a <a href=\"#/p5.Table\">p5.Table\n   *  </a>, a <a href=\"#/p5.Image\">p5.Image</a>, or a p5.SoundFile (requires\n   *  p5.sound). The second parameter is a filename (including extension).The\n   *  third parameter is for options specific to this type of object. This method\n   *  will save a file that fits the given parameters.\n   *  If it is called without specifying an element, by default it will save the\n   *  whole canvas as an image file. You can optionally specify a filename as\n   *  the first parameter in such a case.\n   *  **Note that it is not recommended to\n   *  call this method within draw, as it will open a new save dialog on every\n   *  render.**\n   *\n   * @method save\n   * @param  {Object|String} [objectOrFilename]  If filename is provided, will\n   *                                             save canvas as an image with\n   *                                             either png or jpg extension\n   *                                             depending on the filename.\n   *                                             If object is provided, will\n   *                                             save depending on the object\n   *                                             and filename (see examples\n   *                                             above).\n   * @param  {String} [filename] If an object is provided as the first\n   *                               parameter, then the second parameter\n   *                               indicates the filename,\n   *                               and should include an appropriate\n   *                               file extension (see examples above).\n   * @param  {Boolean|String} [options]  Additional options depend on\n   *                            filetype. For example, when saving JSON,\n   *                            <code>true</code> indicates that the\n   *                            output will be optimized for filesize,\n   *                            rather than readability.\n   *\n   * @example\n   * <div class=\"norender\"><code>\n   * // Saves the canvas as an image\n   * cnv = createCanvas(300, 300);\n   * save(cnv, 'myCanvas.jpg');\n   *\n   * // Saves the canvas as an image by default\n   * save('myCanvas.jpg');\n   * describe('An example for saving a canvas as an image.');\n   * </code></div>\n   *\n   * <div class=\"norender\"><code>\n   * // Saves p5.Image as an image\n   * img = createImage(10, 10);\n   * save(img, 'myImage.png');\n   * describe('An example for saving a p5.Image element as an image.');\n   * </code></div>\n   *\n   * <div class=\"norender\"><code>\n   * // Saves p5.Renderer object as an image\n   * obj = createGraphics(100, 100);\n   * save(obj, 'myObject.png');\n   * describe('An example for saving a p5.Renderer element.');\n   * </code></div>\n   *\n   * <div class=\"norender\"><code>\n   * let myTable = new p5.Table();\n   * // Saves table as html file\n   * save(myTable, 'myTable.html');\n   *\n   * // Comma Separated Values\n   * save(myTable, 'myTable.csv');\n   *\n   * // Tab Separated Values\n   * save(myTable, 'myTable.tsv');\n   *\n   * describe(`An example showing how to save a table in formats of\n   *   HTML, CSV and TSV.`);\n   * </code></div>\n   *\n   * <div class=\"norender\"><code>\n   * let myJSON = { a: 1, b: true };\n   *\n   * // Saves pretty JSON\n   * save(myJSON, 'my.json');\n   *\n   * // Optimizes JSON filesize\n   * save(myJSON, 'my.json', true);\n   *\n   * describe('An example for saving JSON to a txt file with some extra arguments.');\n   * </code></div>\n   *\n   * <div class=\"norender\"><code>\n   * // Saves array of strings to text file with line breaks after each item\n   * let arrayOfStrings = ['a', 'b'];\n   * save(arrayOfStrings, 'my.txt');\n   * describe(`An example for saving an array of strings to text file\n   *   with line breaks.`);\n   * </code></div>\n   */\n  fn.save = function (object, _filename, _options) {\n    // TODO: parameters is not used correctly\n    // parse the arguments and figure out which things we are saving\n    const args = arguments;\n    // =================================================\n    // OPTION 1: saveCanvas...\n\n    // if no arguments are provided, save canvas\n    const cnv = this._curElement ? this._curElement.elt : this.elt;\n    if (args.length === 0) {\n      fn.saveCanvas(cnv);\n      return;\n\n    } else if (args[0] instanceof Renderer || args[0] instanceof Graphics) {\n      // otherwise, parse the arguments\n      // if first param is a p5Graphics, then saveCanvas\n      fn.saveCanvas(args[0].canvas, args[1], args[2]);\n      return;\n\n    } else if (args.length === 1 && typeof args[0] === 'string') {\n      // if 1st param is String and only one arg, assume it is canvas filename\n      fn.saveCanvas(cnv, args[0]);\n\n    } else {\n      // =================================================\n      // OPTION 2: extension clarifies saveStrings vs. saveJSON\n      const extension = _checkFileExtension(args[1], args[2])[1];\n      switch (extension) {\n        case 'json':\n          fn.saveJSON(args[0], args[1], args[2]);\n          return;\n        case 'txt':\n          fn.saveStrings(args[0], args[1], args[2]);\n          return;\n        // =================================================\n        // OPTION 3: decide based on object...\n        default:\n          if (args[0] instanceof Array) {\n            fn.saveStrings(args[0], args[1], args[2]);\n          } else if (args[0] instanceof p5.Table) {\n            fn.saveTable(args[0], args[1], args[2]);\n          } else if (args[0] instanceof p5.Image) {\n            fn.saveCanvas(args[0].canvas, args[1]);\n          } else if (args[0] instanceof p5.SoundFile) {\n            fn.saveSound(args[0], args[1], args[2], args[3]);\n          }\n      }\n    }\n  };\n\n  /**\n   * Saves an `Object` or `Array` to a JSON file.\n   *\n   * JavaScript Object Notation\n   * (<a href=\"https://developer.mozilla.org/en-US/docs/Glossary/JSON\" target=\"_blank\">JSON</a>)\n   * is a standard format for sending data between applications. The format is\n   * based on JavaScript objects which have keys and values. JSON files store\n   * data in an object with strings as keys. Values can be strings, numbers,\n   * Booleans, arrays, `null`, or other objects.\n   *\n   * The first parameter, `json`, is the data to save. The data can be an array,\n   * as in `[1, 2, 3]`, or an object, as in\n   * `{ x: 50, y: 50, color: 'deeppink' }`.\n   *\n   * The second parameter, `filename`, is a string that sets the file's name.\n   * For example, calling `saveJSON([1, 2, 3], 'data.json')` saves the array\n   * `[1, 2, 3]` to a file called `data.json` on the user's computer.\n   *\n   * The third parameter, `optimize`, is optional. If `true` is passed, as in\n   * `saveJSON([1, 2, 3], 'data.json', true)`, then all unneeded whitespace will\n   * be removed to reduce the file size.\n   *\n   * Note: The browser will either save the file immediately or prompt the user\n   * with a dialogue window.\n   *\n   * @method saveJSON\n   * @param  {Array|Object} json data to save.\n   * @param  {String} filename name of the file to be saved.\n   * @param  {Boolean} [optimize] whether to trim unneeded whitespace. Defaults\n   *                              to `true`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display instructions.\n   *   text('Double-click to save', 5, 50, 90);\n   *\n   *   describe('The text \"Double-click to save\" written in black on a gray background.');\n   * }\n   *\n   * // Save the file when the user double-clicks.\n   * function doubleClicked() {\n   *   if (mouseX > 0 && mouseX < 100 && mouseY > 0 && mouseY < 100) {\n   *     // Create an array.\n   *     let data = [1, 2, 3];\n   *\n   *     // Save the JSON file.\n   *     saveJSON(data, 'numbers.json');\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display instructions.\n   *   text('Double-click to save', 5, 50, 90);\n   *\n   *   describe('The text \"Double-click to save\" written in black on a gray background.');\n   * }\n   *\n   * // Save the file when the user double-clicks.\n   * function doubleClicked() {\n   *   if (mouseX > 0 && mouseX < 100 && mouseY > 0 && mouseY < 100) {\n   *     // Create an object.\n   *     let data = { x: mouseX, y: mouseY };\n   *\n   *     // Save the JSON file.\n   *     saveJSON(data, 'state.json');\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display instructions.\n   *   text('Double-click to save', 5, 50, 90);\n   *\n   *   describe('The text \"Double-click to save\" written in black on a gray background.');\n   * }\n   *\n   * // Save the file when the user double-clicks.\n   * function doubleClicked() {\n   *   if (mouseX > 0 && mouseX < 100 && mouseY > 0 && mouseY < 100) {\n   *     // Create an object.\n   *     let data = { x: mouseX, y: mouseY };\n   *\n   *     // Save the JSON file and reduce its size.\n   *     saveJSON(data, 'state.json', true);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.saveJSON = function (json, filename, optimize) {\n    // p5._validateParameters('saveJSON', arguments);\n    let stringify;\n    if (optimize) {\n      stringify = JSON.stringify(json);\n    } else {\n      stringify = JSON.stringify(json, undefined, 2);\n    }\n    this.saveStrings(stringify.split('\\n'), filename, 'json');\n  };\n\n  /**\n   * Saves an `Array` of `String`s to a file, one per line.\n   *\n   * The first parameter, `list`, is an array with the strings to save.\n   *\n   * The second parameter, `filename`, is a string that sets the file's name.\n   * For example, calling `saveStrings(['0', '01', '011'], 'data.txt')` saves\n   * the array `['0', '01', '011']` to a file called `data.txt` on the user's\n   * computer.\n   *\n   * The third parameter, `extension`, is optional. If a string is passed, as in\n   * `saveStrings(['0', '01', '0`1'], 'data', 'txt')`, the second parameter will\n   * be interpreted as the file name and the third parameter as the extension.\n   *\n   * The fourth parameter, `isCRLF`, is also optional, If `true` is passed, as\n   * in `saveStrings(['0', '01', '011'], 'data', 'txt', true)`, then two\n   * characters, `\\r\\n` , will be added to the end of each string to create new\n   * lines in the saved file. `\\r` is a carriage return (CR) and `\\n` is a line\n   * feed (LF). By default, only `\\n` (line feed) is added to each string in\n   * order to create new lines.\n   *\n   * Note: The browser will either save the file immediately or prompt the user\n   * with a dialogue window.\n   *\n   *  @method saveStrings\n   *  @param  {String[]} list data to save.\n   *  @param  {String} filename name of file to be saved.\n   *  @param  {String} [extension] format to use for the file.\n   *  @param  {Boolean} [isCRLF] whether to add `\\r\\n` to the end of each\n   *                             string. Defaults to `false`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display instructions.\n   *   text('Double-click to save', 5, 50, 90);\n   *\n   *   describe('The text \"Double-click to save\" written in black on a gray background.');\n   * }\n   *\n   * // Save the file when the user double-clicks.\n   * function doubleClicked() {\n   *   if (mouseX > 0 && mouseX < 100 && mouseY > 0 && mouseY < 100) {\n   *     // Create an array.\n   *     let data = ['0', '01', '011'];\n   *\n   *     // Save the text file.\n   *     saveStrings(data, 'data.txt');\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display instructions.\n   *   text('Double-click to save', 5, 50, 90);\n   *\n   *   describe('The text \"Double-click to save\" written in black on a gray background.');\n   * }\n   *\n   * // Save the file when the user double-clicks.\n   * function doubleClicked() {\n   *   if (mouseX > 0 && mouseX < 100 && mouseY > 0 && mouseY < 100) {\n   *     // Create an array.\n   *     // ASCII art courtesy Wikipedia:\n   *     // https://en.wikipedia.org/wiki/ASCII_art\n   *     let data = [' (\\\\_/) ', \"(='.'=)\", '(\")_(\")'];\n   *\n   *     // Save the text file.\n   *     saveStrings(data, 'cat', 'txt');\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Display instructions.\n   *   text('Double-click to save', 5, 50, 90);\n   *\n   *   describe('The text \"Double-click to save\" written in black on a gray background.');\n   * }\n   *\n   * // Save the file when the user double-clicks.\n   * function doubleClicked() {\n   *   if (mouseX > 0 && mouseX < 100 && mouseY > 0 && mouseY < 100) {\n   *     // Create an array.\n   *     //   +--+\n   *     //  /  /|\n   *     // +--+ +\n   *     // |  |/\n   *     // +--+\n   *     let data = ['  +--+', ' /  /|', '+--+ +', '|  |/', '+--+'];\n   *\n   *     // Save the text file.\n   *     // Use CRLF for line endings.\n   *     saveStrings(data, 'box', 'txt', true);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.saveStrings = function (list, filename, extension, isCRLF) {\n    // p5._validateParameters('saveStrings', arguments);\n    const ext = extension || 'txt';\n    const pWriter = new p5.PrintWriter(filename, ext);\n    for (let item of list) {\n      isCRLF ? pWriter.write(item + '\\r\\n') : pWriter.write(item + '\\n');\n    }\n    pWriter.close();\n    pWriter.clear();\n  };\n\n  // =======\n  // HELPERS\n  // =======\n\n  function escapeHelper(content) {\n    return content\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#039;');\n  }\n\n  /**\n   *  Writes the contents of a <a href=\"#/p5.Table\">Table</a> object to a file. Defaults to a\n   *  text file with comma-separated-values ('csv') but can also\n   *  use tab separation ('tsv'), or generate an HTML table ('html').\n   *  The file saving process and location of the saved file will\n   *  vary between web browsers.\n   *\n   *  @method saveTable\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param  {p5.Table} Table  the <a href=\"#/p5.Table\">Table</a> object to save to a file\n   *  @param  {String} filename the filename to which the Table should be saved\n   *  @param  {String} [options]  can be one of \"tsv\", \"csv\", or \"html\"\n   *  @example\n   *  <div><code>\n   * let table;\n   *\n   * function setup() {\n   *   table = new p5.Table();\n   *\n   *   table.addColumn('id');\n   *   table.addColumn('species');\n   *   table.addColumn('name');\n   *\n   *   let newRow = table.addRow();\n   *   newRow.setNum('id', table.getRowCount() - 1);\n   *   newRow.setString('species', 'Panthera leo');\n   *   newRow.setString('name', 'Lion');\n   *\n   *   // To save, un-comment next line then click 'run'\n   *   // saveTable(table, 'new.csv');\n   *\n   *   describe('no image displayed');\n   * }\n   *\n   * // Saves the following to a file called 'new.csv':\n   * // id,species,name\n   * // 0,Panthera leo,Lion\n   * </code></div>\n   */\n  fn.saveTable = function (table, filename, options) {\n    // p5._validateParameters('saveTable', arguments);\n    let ext;\n    if (options === undefined) {\n      ext = filename.substring(filename.lastIndexOf('.') + 1, filename.length);\n      if(ext === filename) ext = 'csv';\n    } else {\n      ext = options;\n    }\n    const pWriter = this.createWriter(filename, ext);\n\n    const header = table.columns;\n\n    let sep = ','; // default to CSV\n    if (ext === 'tsv') {\n      sep = '\\t';\n    }\n    if (ext !== 'html') {\n      const output = table.toString(sep);\n      pWriter.write(output);\n    } else {\n      // otherwise, make HTML\n      pWriter.print('<html>');\n      pWriter.print('<head>');\n      let str = '  <meta http-equiv=\"content-type\" content';\n      str += '=\"text/html;charset=utf-8\" />';\n      pWriter.print(str);\n      pWriter.print('</head>');\n\n      pWriter.print('<body>');\n      pWriter.print('  <table>');\n\n      // make header if it has values\n      if (header[0] !== '0') {\n        pWriter.print('    <tr>');\n        for (let k = 0; k < header.length; k++) {\n          const e = escapeHelper(header[k]);\n          pWriter.print(`      <td>${e}`);\n          pWriter.print('      </td>');\n        }\n        pWriter.print('    </tr>');\n      }\n\n      // make rows\n      for (let row = 0; row < table.rows.length; row++) {\n        pWriter.print('    <tr>');\n        for (let col = 0; col < table.columns.length; col++) {\n          const entry = table.rows[row].getString(col);\n          const htmlEntry = escapeHelper(entry);\n          pWriter.print(`      <td>${htmlEntry}`);\n          pWriter.print('      </td>');\n        }\n        pWriter.print('    </tr>');\n      }\n      pWriter.print('  </table>');\n      pWriter.print('</body>');\n      pWriter.print('</html>');\n    }\n    // close and clear the pWriter\n    pWriter.close();\n    pWriter.clear();\n  }; // end saveTable()\n\n  /**\n   *  Generate a blob of file data as a url to prepare for download.\n   *  Accepts an array of data, a filename, and an extension (optional).\n   *  This is a private function because it does not do any formatting,\n   *  but it is used by <a href=\"#/p5/saveStrings\">saveStrings</a>, <a href=\"#/p5/saveJSON\">saveJSON</a>, <a href=\"#/p5/saveTable\">saveTable</a> etc.\n   *\n   *  @param  {Array} dataToDownload\n   *  @param  {String} filename\n   *  @param  {String} [extension]\n   *  @private\n   */\n  fn.writeFile = function (dataToDownload, filename, extension) {\n    let type = 'application/octet-stream';\n    if (fn._isSafari()) {\n      type = 'text/plain';\n    }\n    const blob = new Blob(dataToDownload, {\n      type\n    });\n    fn.downloadFile(blob, filename, extension);\n  };\n\n  /**\n   *  Forces download. Accepts a url to filedata/blob, a filename,\n   *  and an extension (optional).\n   *  This is a private function because it does not do any formatting,\n   *  but it is used by <a href=\"#/p5/saveStrings\">saveStrings</a>, <a href=\"#/p5/saveJSON\">saveJSON</a>, <a href=\"#/p5/saveTable\">saveTable</a> etc.\n   *\n   *  @method downloadFile\n   *  @private\n   *  @param  {String|Blob} data    either an href generated by createObjectURL,\n   *                                or a Blob object containing the data\n   *  @param  {String} [filename]\n   *  @param  {String} [extension]\n   */\n  fn.downloadFile = downloadFile;\n\n  /**\n   *  Returns a file extension, or another string\n   *  if the provided parameter has no extension.\n   *\n   *  @param   {String} filename\n   *  @param   {String} [extension]\n   *  @return  {String[]} [fileName, fileExtension]\n   *\n   *  @private\n   */\n  fn._checkFileExtension = _checkFileExtension;\n\n  /**\n   *  Returns true if the browser is Safari, false if not.\n   *  Safari makes trouble for downloading files.\n   *\n   *  @return  {Boolean} [description]\n   *  @private\n   */\n  fn._isSafari = function () {\n    // The following line is CC BY SA 3 by user Fregante https://stackoverflow.com/a/23522755\n    return /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  files(p5, p5.prototype);\n}\n\n/**\n * @module Image\n * @submodule Loading & Displaying\n * @for p5\n * @requires core\n */\n\n\nfunction loadingDisplaying(p5, fn){\n  /**\n   * Loads an image to create a <a href=\"#/p5.Image\">p5.Image</a> object.\n   *\n   * `loadImage()` interprets the first parameter one of three ways. If the path\n   * to an image file is provided, `loadImage()` will load it. Paths to local\n   * files should be relative, such as `'assets/thundercat.jpg'`. URLs such as\n   * `'https://example.com/thundercat.jpg'` may be blocked due to browser\n   * security. Raw image data can also be passed as a base64 encoded image in\n   * the form `'data:image/png;base64,arandomsequenceofcharacters'`. The `path`\n   * parameter can also be defined as a [`Request`](https://developer.mozilla.org/en-US/docs/Web/API/Request)\n   * object for more advanced usage.\n   *\n   * The second parameter is optional. If a function is passed, it will be\n   * called once the image has loaded. The callback function can optionally use\n   * the new <a href=\"#/p5.Image\">p5.Image</a> object. The return value of the\n   * function will be used as the final return value of `loadImage()`.\n   *\n   * The third parameter is also optional. If a function is passed, it will be\n   * called if the image fails to load. The callback function can optionally use\n   * the event error. The return value of the function will be used as the final\n   * return value of `loadImage()`.\n   *\n   * This function returns a `Promise` and should be used in an `async` setup with\n   * `await`. See the examples for the usage syntax.\n   *\n   * @method loadImage\n   * @param  {String|Request}      path  path of the image to be loaded or base64 encoded image.\n   * @param  {function(p5.Image)} [successCallback] function called with\n   *                               <a href=\"#/p5.Image\">p5.Image</a> once it\n   *                               loads.\n   * @param  {function(Event)}    [failureCallback] function called with event\n   *                               error if the image fails to load.\n   * @return {Promise<p5.Image>}   the <a href=\"#/p5.Image\">p5.Image</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * // Load the image and create a p5.Image object.\n   * async function setup() {\n   *   img = await loadImage('assets/laDefense.jpg');\n   *   createCanvas(100, 100);\n   *\n   *   // Draw the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('Image of the underside of a white umbrella and a gridded ceiling.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * async function setup() {\n   *   // Call handleImage() once the image loads.\n   *   await loadImage('assets/laDefense.jpg', handleImage);\n   *\n   *   describe('Image of the underside of a white umbrella and a gridded ceiling.');\n   * }\n   *\n   * // Display the image.\n   * function handleImage(img) {\n   *   image(img, 0, 0);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * async function setup() {\n   *   // Call handleImage() once the image loads or\n   *   // call handleError() if an error occurs.\n   *   await loadImage('assets/laDefense.jpg', handleImage, handleError);\n   * }\n   *\n   * // Display the image.\n   * function handleImage(img) {\n   *   image(img, 0, 0);\n   *\n   *   describe('Image of the underside of a white umbrella and a gridded ceiling.');\n   * }\n   *\n   * // Log the error.\n   * function handleError(event) {\n   *   console.error('Oops!', event);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.loadImage = async function(\n    path,\n    successCallback,\n    failureCallback\n  ) {\n    // p5._validateParameters('loadImage', arguments);\n\n    try{\n      let pImg = new p5.Image(1, 1, this);\n\n      const req = new Request(path, {\n        method: 'GET',\n        mode: 'cors'\n      });\n\n      const { data, headers } = await request(req, 'bytes');\n\n      // GIF section\n      const contentType = headers.get('content-type');\n\n      if (contentType === null) {\n        console.warn(\n          'The image you loaded does not have a Content-Type header. If you are using the online editor consider reuploading the asset.'\n        );\n      }\n\n      if (contentType && contentType.includes('image/gif')) {\n        await _createGif(\n          data,\n          pImg\n        );\n\n      } else {\n        // Non-GIF Section\n        const blob = new Blob([data]);\n        const img = await createImageBitmap(blob);\n\n        pImg.width = pImg.canvas.width = img.width;\n        pImg.height = pImg.canvas.height = img.height;\n\n        // Draw the image into the backing canvas of the p5.Image\n        pImg.drawingContext.drawImage(img, 0, 0);\n      }\n\n      pImg.modified = true;\n\n      if(successCallback){\n        return successCallback(pImg);\n      }else {\n        return pImg;\n      }\n\n    } catch(err) {\n      p5._friendlyFileLoadError(0, path);\n      if (typeof failureCallback === 'function') {\n        return failureCallback(err);\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  /**\n   * Generates a gif from a sketch and saves it to a file.\n   *\n   * `saveGif()` may be called in <a href=\"#/p5/setup\">setup()</a> or at any\n   * point while a sketch is running.\n   *\n   * The first parameter, `fileName`, sets the gif's file name.\n   *\n   * The second parameter, `duration`, sets the gif's duration in seconds.\n   *\n   * The third parameter, `options`, is optional. If an object is passed,\n   * `saveGif()` will use its properties to customize the gif. `saveGif()`\n   * recognizes the properties `delay`, `units`, `silent`,\n   * `notificationDuration`, and `notificationID`.\n   *\n   * @method saveGif\n   * @param  {String} filename file name of gif.\n   * @param  {Number} duration duration in seconds to capture from the sketch.\n   * @param  {Object} [options] an object that can contain five more properties:\n   *                  `delay`, a Number specifying how much time to wait before recording;\n   *                  `units`, a String that can be either 'seconds' or 'frames'. By default it's 'seconds;\n   *                  `silent`, a Boolean that defines presence of progress notifications. By default its `false`;\n   *                  `notificationDuration`, a Number that defines how long in seconds the final notification\n   *                  will live. By default it's `0`, meaning the notification will never be removed;\n   *                  `notificationID`, a String that specifies the id of the notification's DOM element. By default its `'progressBar`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A circle drawn in the middle of a gray square. The circle changes color from black to white, then repeats.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the circle.\n   *   let c = frameCount % 255;\n   *   fill(c);\n   *\n   *   // Display the circle.\n   *   circle(50, 50, 25);\n   * }\n   *\n   * // Save a 5-second gif when the user presses the 's' key.\n   * function keyPressed() {\n   *   if (key === 's') {\n   *     saveGif('mySketch', 5);\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A circle drawn in the middle of a gray square. The circle changes color from black to white, then repeats.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the circle.\n   *   let c = frameCount % 255;\n   *   fill(c);\n   *\n   *   // Display the circle.\n   *   circle(50, 50, 25);\n   * }\n   *\n   * // Save a 5-second gif when the user presses the 's' key.\n   * // Wait 1 second after the key press before recording.\n   * function keyPressed() {\n   *   if (key === 's') {\n   *     saveGif('mySketch', 5, { delay: 1 });\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.saveGif = async function(\n    fileName,\n    duration,\n    options = {\n      delay: 0,\n      units: 'seconds',\n      silent: false,\n      notificationDuration: 0,\n      notificationID: 'progressBar'\n    }\n  ) {\n    // validate parameters\n    if (typeof fileName !== 'string') {\n      throw TypeError('fileName parameter must be a string');\n    }\n    if (typeof duration !== 'number') {\n      throw TypeError('Duration parameter must be a number');\n    }\n\n    // extract variables for more comfortable use\n    const delay = (options && options.delay) || 0;  // in seconds\n    const units = (options && options.units) || 'seconds';  // either 'seconds' or 'frames'\n    const silent = (options && options.silent) || false;\n    const notificationDuration = (options && options.notificationDuration) || 0;\n    const notificationID = (options && options.notificationID) || 'progressBar';\n\n    // if arguments in the options object are not correct, cancel operation\n    if (typeof delay !== 'number') {\n      throw TypeError('Delay parameter must be a number');\n    }\n    // if units is not seconds nor frames, throw error\n    if (units !== 'seconds' && units !== 'frames') {\n      throw TypeError('Units parameter must be either \"frames\" or \"seconds\"');\n    }\n\n    if (typeof silent !== 'boolean') {\n      throw TypeError('Silent parameter must be a boolean');\n    }\n\n    if (typeof notificationDuration !== 'number') {\n      throw TypeError('Notification duration parameter must be a number');\n    }\n\n    if (typeof notificationID !== 'string') {\n      throw TypeError('Notification ID parameter must be a string');\n    }\n\n    this._recording = true;\n\n    // get the project's framerate\n    let _frameRate = this._targetFrameRate;\n    // if it is undefined or some non useful value, assume it's 60\n    if (_frameRate === Infinity || _frameRate === undefined || _frameRate === 0) {\n      _frameRate = 60;\n    }\n\n    // calculate frame delay based on frameRate\n\n    // this delay has nothing to do with the\n    // delay in options, but rather is the delay\n    // we have to specify to the gif encoder between frames.\n    let gifFrameDelay = 1 / _frameRate * 1000;\n\n    // constrain it to be always greater than 20,\n    // otherwise it won't work in some browsers and systems\n    // reference: https://stackoverflow.com/questions/64473278/gif-frame-duration-seems-slower-than-expected\n    gifFrameDelay = gifFrameDelay < 20 ? 20 : gifFrameDelay;\n\n    // check the mode we are in and how many frames\n    // that duration translates to\n    const nFrames = units === 'seconds' ? duration * _frameRate : duration;\n    const nFramesDelay = units === 'seconds' ? delay * _frameRate : delay;\n    const totalNumberOfFrames = nFrames + nFramesDelay;\n\n    // initialize variables for the frames processing\n    let frameIterator = nFramesDelay;\n    this.frameCount = frameIterator;\n\n    const lastPixelDensity = this._renderer._pixelDensity;\n    this.pixelDensity(1);\n\n    // We first take every frame that we are going to use for the animation\n    let frames = [];\n\n    if (document.getElementById(notificationID) !== null)\n      document.getElementById(notificationID).remove();\n\n    let p;\n    if (!silent){\n      p = this.createP('');\n      p.id(notificationID);\n      p.style('font-size', '16px');\n      p.style('font-family', 'Montserrat');\n      p.style('background-color', '#ffffffa0');\n      p.style('padding', '8px');\n      p.style('border-radius', '10px');\n      p.position(0, 0);\n    }\n\n    let pixels;\n    let gl;\n    if (this._renderer instanceof p5.RendererGL) {\n      // if we have a WEBGL context, initialize the pixels array\n      // and the gl context to use them inside the loop\n      gl = this.drawingContext;\n      pixels = new Uint8Array(gl.drawingBufferWidth * gl.drawingBufferHeight * 4);\n    }\n\n    // stop the loop since we are going to manually redraw\n    this.noLoop();\n\n    // Defer execution until the rest of the call stack finishes, allowing the\n    // rest of `setup` to be called (and, importantly, canvases hidden in setup\n    // to be unhidden.)\n    //\n    // Waiting on this empty promise means we'll continue as soon as setup\n    // finishes without waiting for another frame.\n    await Promise.resolve();\n\n    while (frameIterator < totalNumberOfFrames) {\n      /*\n        we draw the next frame. this is important, since\n        busy sketches or low end devices might take longer\n        to render some frames. So we just wait for the frame\n        to be drawn and immediately save it to a buffer and continue\n      */\n      this.redraw();\n\n      // depending on the context we'll extract the pixels one way\n      // or another\n      let data = undefined;\n\n      if (this._renderer instanceof p5.RendererGL) {\n        pixels = new Uint8Array(\n          gl.drawingBufferWidth * gl.drawingBufferHeight * 4\n        );\n        gl.readPixels(\n          0,\n          0,\n          gl.drawingBufferWidth,\n          gl.drawingBufferHeight,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          pixels\n        );\n\n        data = _flipPixels(pixels, this.width, this.height);\n      } else {\n        data = this.drawingContext.getImageData(0, 0, this.width, this.height)\n          .data;\n      }\n\n      frames.push(data);\n      frameIterator++;\n\n      if (!silent) {\n        p.html(\n          'Saved frame <b>' +\n          frames.length.toString() +\n          '</b> out of ' +\n          nFrames.toString()\n        );\n      }\n      await new Promise(resolve => setTimeout(resolve, 0));\n    }\n    if (!silent) p.html('Frames processed, generating color palette...');\n\n    this.loop();\n    this.pixelDensity(lastPixelDensity);\n\n    // create the gif encoder and the colorspace format\n    const gif = GIFEncoder();\n\n    // calculate the global palette for this set of frames\n    const globalPalette = _generateGlobalPalette(frames);\n\n    // Rather than using applyPalette() from the gifenc library, we use our\n    // own function to map frame pixels to a palette color. This way, we can\n    // cache palette color mappings between frames for extra performance, and\n    // use our own caching mechanism to avoid flickering colors from cache\n    // key collisions.\n    const paletteCache = {};\n    const getIndexedFrame = frame => {\n      const length = frame.length / 4;\n      const index = new Uint8Array(length);\n      for (let i = 0; i < length; i++) {\n        const key =\n          (frame[i * 4] << 24) |\n          (frame[i * 4 + 1] << 16) |\n          (frame[i * 4 + 2] << 8) |\n          frame[i * 4 + 3];\n        if (paletteCache[key] === undefined) {\n          paletteCache[key] = nearestColorIndex(\n            globalPalette,\n            frame.slice(i * 4, (i + 1) * 4)\n          );\n        }\n        index[i] = paletteCache[key];\n      }\n      return index;\n    };\n\n    // the way we designed the palette means we always take the last index for transparency\n    const transparentIndex = globalPalette.length - 1;\n\n    // we are going to iterate the frames in pairs, n-1 and n\n    let prevIndexedFrame = [];\n    for (let i = 0; i < frames.length; i++) {\n      //const indexedFrame = applyPalette(frames[i], globalPaletteWithoutAlpha, 'rgba565');\n      const indexedFrame = getIndexedFrame(frames[i]);\n\n      // Make a copy of the palette-applied frame before editing the original\n      // to use transparent pixels\n      const originalIndexedFrame = indexedFrame.slice();\n\n      if (i === 0) {\n        gif.writeFrame(indexedFrame, this.width, this.height, {\n          palette: globalPalette,\n          delay: gifFrameDelay,\n          dispose: 1\n        });\n      } else {\n        // Matching pixels between frames can be set to full transparency,\n        // allowing the previous frame's pixels to show through. We only do\n        // this for pixels that get mapped to the same quantized color so that\n        // the resulting image would be the same.\n        for (let i = 0; i < indexedFrame.length; i++) {\n          if (indexedFrame[i] === prevIndexedFrame[i]) {\n            indexedFrame[i] = transparentIndex;\n          }\n        }\n\n        // Write frame into the encoder\n        gif.writeFrame(indexedFrame, this.width, this.height, {\n          delay: gifFrameDelay,\n          transparent: true,\n          transparentIndex,\n          dispose: 1\n        });\n      }\n\n      prevIndexedFrame = originalIndexedFrame;\n\n      if (!silent) {\n        p.html(\n          'Rendered frame <b>' + i.toString() + '</b> out of ' + nFrames.toString()\n        );\n      }\n\n\n      // this just makes the process asynchronous, preventing\n      // that the encoding locks up the browser\n      await new Promise(resolve => setTimeout(resolve, 0));\n    }\n\n    gif.finish();\n\n    // Get a direct typed array view into the buffer to avoid copying it\n    const buffer = gif.bytesView();\n    const extension = 'gif';\n\n    const blob = new Blob([buffer], {\n      type: 'image/gif'\n    });\n\n    frames = [];\n    this._recording = false;\n    this.loop();\n\n    if (!silent){\n      p.html('Done. Downloading your gif!');\n      if(notificationDuration > 0)\n        setTimeout(() => p.remove(), notificationDuration * 1000);\n    }\n\n    fn.downloadFile(blob, fileName, extension);\n  };\n\n  function _flipPixels(pixels, width, height) {\n    // extracting the pixels using readPixels returns\n    // an upside down image. we have to flip it back\n    // first. this solution is proposed by gman on\n    // this stack overflow answer:\n    // https://stackoverflow.com/questions/41969562/how-can-i-flip-the-result-of-webglrenderingcontext-readpixels\n\n    const halfHeight = parseInt(height / 2);\n    const bytesPerRow = width * 4;\n\n    // make a temp buffer to hold one row\n    const temp = new Uint8Array(width * 4);\n    for (let y = 0; y < halfHeight; ++y) {\n      const topOffset = y * bytesPerRow;\n      const bottomOffset = (height - y - 1) * bytesPerRow;\n\n      // make copy of a row on the top half\n      temp.set(pixels.subarray(topOffset, topOffset + bytesPerRow));\n\n      // copy a row from the bottom half to the top\n      pixels.copyWithin(topOffset, bottomOffset, bottomOffset + bytesPerRow);\n\n      // copy the copy of the top half row to the bottom half\n      pixels.set(temp, bottomOffset);\n    }\n    return pixels;\n  }\n\n  function _generateGlobalPalette(frames) {\n    // make an array the size of every possible color in every possible frame\n    // that is: width * height * frames.\n    let allColors = new Uint8Array(frames.length * frames[0].length);\n\n    // put every frame one after the other in sequence.\n    // this array will hold absolutely every pixel from the animation.\n    // the set function on the Uint8Array works super fast tho!\n    for (let f = 0; f < frames.length; f++) {\n      allColors.set(frames[f], f * frames[0].length);\n    }\n\n    // quantize this massive array into 256 colors and return it!\n    let colorPalette = quantize(allColors, 256, {\n      format: 'rgba4444',\n      oneBitAlpha: true\n    });\n\n    // when generating the palette, we have to leave space for 1 of the\n    // indices to be a random color that does not appear anywhere in our\n    // animation to use for transparency purposes. So, if the palette is full\n    // (has 256 colors), we overwrite the last one with a random, fully transparent\n    // color. Otherwise, we just push a new color into the palette the same way.\n\n    // this guarantees that when using the transparency index, there are no matches\n    // between some colors of the animation and the \"holes\" we want to dig on them,\n    // which would cause pieces of some frames to be transparent and thus look glitchy.\n    if (colorPalette.length === 256) {\n      colorPalette[colorPalette.length - 1] = [\n        Math.random() * 255,\n        Math.random() * 255,\n        Math.random() * 255,\n        0\n      ];\n    } else {\n      colorPalette.push([\n        Math.random() * 255,\n        Math.random() * 255,\n        Math.random() * 255,\n        0\n      ]);\n    }\n    return colorPalette;\n  }\n\n  /**\n   * Helper function for loading GIF-based images\n   */\n  async function _createGif(arrayBuffer, pImg) {\n    // TODO: Replace with ImageDecoder once it is widely available\n    // https://developer.mozilla.org/en-US/docs/Web/API/ImageDecoder\n    const gifReader = new omggif.GifReader(arrayBuffer);\n    pImg.width = pImg.canvas.width = gifReader.width;\n    pImg.height = pImg.canvas.height = gifReader.height;\n    const frames = [];\n    const numFrames = gifReader.numFrames();\n    let framePixels = new Uint8ClampedArray(pImg.width * pImg.height * 4);\n\n    const loadGIFFrameIntoImage = (frameNum, gifReader) => {\n      try {\n        gifReader.decodeAndBlitFrameRGBA(frameNum, framePixels);\n      } catch (e) {\n        p5._friendlyFileLoadError(8, pImg.src);\n        throw e;\n      }\n    };\n\n    for (let j = 0; j < numFrames; j++) {\n      const frameInfo = gifReader.frameInfo(j);\n      const prevFrameData = pImg.drawingContext.getImageData(\n        0,\n        0,\n        pImg.width,\n        pImg.height\n      );\n      framePixels = prevFrameData.data.slice();\n      loadGIFFrameIntoImage(j, gifReader);\n      const imageData = new ImageData(framePixels, pImg.width, pImg.height);\n      pImg.drawingContext.putImageData(imageData, 0, 0);\n      let frameDelay = frameInfo.delay;\n      // To maintain the default of 10FPS when frameInfo.delay equals to 0\n      if (frameDelay === 0) {\n        frameDelay = 10;\n      }\n      frames.push({\n        image: pImg.drawingContext.getImageData(0, 0, pImg.width, pImg.height),\n        delay: frameDelay * 10 //GIF stores delay in one-hundredth of a second, shift to ms\n      });\n\n      // Some GIFs are encoded so that they expect the previous frame\n      // to be under the current frame. This can occur at a sub-frame level\n      //\n      // Values :    0 -   No disposal specified. The decoder is\n      //                   not required to take any action.\n      //             1 -   Do not dispose. The graphic is to be left\n      //                   in place.\n      //             2 -   Restore to background color. The area used by the\n      //                   graphic must be restored to the background color.\n      //             3 -   Restore to previous. The decoder is required to\n      //                   restore the area overwritten by the graphic with\n      //                   what was there prior to rendering the graphic.\n      //          4-7 -    To be defined.\n      if (frameInfo.disposal === 2) {\n        // Restore background color\n        pImg.drawingContext.clearRect(\n          frameInfo.x,\n          frameInfo.y,\n          frameInfo.width,\n          frameInfo.height\n        );\n      } else if (frameInfo.disposal === 3) {\n        // Restore previous\n        pImg.drawingContext.putImageData(\n          prevFrameData,\n          0,\n          0,\n          frameInfo.x,\n          frameInfo.y,\n          frameInfo.width,\n          frameInfo.height\n        );\n      }\n    }\n\n    //Uses Netscape block encoding\n    //to repeat forever, this will be 0\n    //to repeat just once, this will be null\n    //to repeat N times (1<N), should contain integer for loop number\n    //this is changed to more usable values for us\n    //to repeat forever, loopCount = null\n    //everything else is just the number of loops\n    let loopLimit = gifReader.loopCount();\n    if (loopLimit === null) {\n      loopLimit = 1;\n    } else if (loopLimit === 0) {\n      loopLimit = null;\n    }\n\n    // we used the pImg for painting and saving during load\n    // so we have to reset it to the first frame\n    pImg.drawingContext.putImageData(frames[0].image, 0, 0);\n\n    if (frames.length > 1) {\n      pImg.gifProperties = {\n        displayIndex: 0,\n        loopLimit,\n        loopCount: 0,\n        frames,\n        numFrames,\n        playing: true,\n        timeDisplayed: 0,\n        lastChangeTime: 0\n      };\n    }\n\n    return pImg;\n  }\n\n  /**\n   * @private\n   * @param {(LEFT|RIGHT|CENTER)} xAlign either LEFT, RIGHT or CENTER\n   * @param {(TOP|BOTTOM|CENTER)} yAlign either TOP, BOTTOM or CENTER\n   * @param {Number} dx\n   * @param {Number} dy\n   * @param {Number} dw\n   * @param {Number} dh\n   * @param {Number} sw\n   * @param {Number} sh\n   * @returns {Object}\n   */\n\n  function _imageContain(xAlign, yAlign, dx, dy, dw, dh, sw, sh) {\n    const r = Math.max(sw / dw, sh / dh);\n    const [adjusted_dw, adjusted_dh] = [sw / r, sh / r];\n    let x = dx;\n    let y = dy;\n\n    if (xAlign === CENTER) {\n      x += (dw - adjusted_dw) / 2;\n    } else if (xAlign === RIGHT) {\n      x += dw - adjusted_dw;\n    }\n\n    if (yAlign === CENTER) {\n      y += (dh - adjusted_dh) / 2;\n    } else if (yAlign === BOTTOM) {\n      y += dh - adjusted_dh;\n    }\n    return { x, y, w: adjusted_dw, h: adjusted_dh };\n  }\n\n  /**\n   * @private\n   * @param {(LEFT|RIGHT|CENTER)} xAlign either LEFT, RIGHT or CENTER\n   * @param {(TOP|BOTTOM|CENTER)} yAlign either TOP, BOTTOM or CENTER\n   * @param {Number} dw\n   * @param {Number} dh\n   * @param {Number} sx\n   * @param {Number} sy\n   * @param {Number} sw\n   * @param {Number} sh\n   * @returns {Object}\n   */\n  function _imageCover(xAlign, yAlign, dw, dh, sx, sy, sw, sh) {\n    const r = Math.max(dw / sw, dh / sh);\n    const [adjusted_sw, adjusted_sh] = [dw / r, dh / r];\n\n    let x = sx;\n    let y = sy;\n\n    if (xAlign === CENTER) {\n      x += (sw - adjusted_sw) / 2;\n    } else if (xAlign === RIGHT) {\n      x += sw - adjusted_sw;\n    }\n\n    if (yAlign === CENTER) {\n      y += (sh - adjusted_sh) / 2;\n    } else if (yAlign === BOTTOM) {\n      y += sh - adjusted_sh;\n    }\n\n    return { x, y, w: adjusted_sw, h: adjusted_sh };\n  }\n\n  /**\n   * @private\n   * @param {(CONTAIN|COVER)} [fit] either CONTAIN or COVER\n   * @param {(LEFT|RIGHT|CENTER)} xAlign either LEFT, RIGHT or CENTER\n   * @param {(TOP|BOTTOM|CENTER)} yAlign either TOP, BOTTOM or CENTER\n   * @param {Number} dx\n   * @param {Number} dy\n   * @param {Number} dw\n   * @param {Number} dh\n   * @param {Number} sx\n   * @param {Number} sy\n   * @param {Number} sw\n   * @param {Number} sh\n   * @returns {Object}\n   */\n  function _imageFit(fit, xAlign, yAlign, dx, dy, dw, dh, sx, sy, sw, sh) {\n    if (fit === COVER) {\n      const { x, y, w, h } = _imageCover(xAlign, yAlign, dw, dh, sx, sy, sw, sh);\n      sx = x;\n      sy = y;\n      sw = w;\n      sh = h;\n    }\n\n    if (fit === CONTAIN) {\n      const { x, y, w, h } = _imageContain(\n        xAlign,\n        yAlign,\n        dx,\n        dy,\n        dw,\n        dh,\n        sw,\n        sh\n      );\n      dx = x;\n      dy = y;\n      dw = w;\n      dh = h;\n    }\n    return { sx, sy, sw, sh, dx, dy, dw, dh };\n  }\n\n  /**\n   * Validates clipping params. Per drawImage spec sWidth and sHight cannot be\n   * negative or greater than image intrinsic width and height\n   * @private\n   * @param {Number} sVal\n   * @param {Number} iVal\n   * @returns {Number}\n   * @private\n   */\n  function _sAssign(sVal, iVal) {\n    if (sVal > 0 && sVal < iVal) {\n      return sVal;\n    } else {\n      return iVal;\n    }\n  }\n\n  /**\n   * Draws an image to the canvas.\n   *\n   * The first parameter, `img`, is the source image to be drawn. `img` can be\n   * any of the following objects:\n   * - <a href=\"#/p5.Image\">p5.Image</a>\n   * - <a href=\"#/p5.Element\">p5.Element</a>\n   * - <a href=\"#/p5.Texture\">p5.Texture</a>\n   * - <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a>\n   * - <a href=\"#/p5.FramebufferTexture\">p5.FramebufferTexture</a>\n   *\n   * The second and third parameters, `dx` and `dy`, set the coordinates of the\n   * destination image's top left corner. See\n   * <a href=\"#/p5/imageMode\">imageMode()</a> for other ways to position images.\n   *\n   * ```js example\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Draw the image.\n   *   image(img, 0, 0);\n   *\n   *   describe('An image of the underside of a white umbrella with a gridded ceiling above.');\n   * }\n   * ```\n   *\n   * Here's a diagram that explains how optional parameters work in `image()`:\n   *\n   * <img src=\"assets/drawImage.png\"></img>\n   *\n   * The fourth and fifth parameters, `dw` and `dh`, are optional. They set the\n   * the width and height to draw the destination image. By default, `image()`\n   * draws the full source image at its original size.\n   *\n   * The sixth and seventh parameters, `sx` and `sy`, are also optional.\n   * These coordinates define the top left corner of a subsection to draw from\n   * the source image.\n   *\n   * The eighth and ninth parameters, `sw` and `sh`, are also optional.\n   * They define the width and height of a subsection to draw from the source\n   * image. By default, `image()` draws the full subsection that begins at\n   * `(sx, sy)` and extends to the edges of the source image.\n   *\n   * The ninth parameter, `fit`, is also optional. It enables a subsection of\n   * the source image to be drawn without affecting its aspect ratio. If\n   * `CONTAIN` is passed, the full subsection will appear within the destination\n   * rectangle. If `COVER` is passed, the subsection will completely cover the\n   * destination rectangle. This may have the effect of zooming into the\n   * subsection.\n   *\n   * The tenth and eleventh paremeters, `xAlign` and `yAlign`, are also\n   * optional. They determine how to align the fitted subsection. `xAlign` can\n   * be set to either `LEFT`, `RIGHT`, or `CENTER`. `yAlign` can be set to\n   * either `TOP`, `BOTTOM`, or `CENTER`. By default, both `xAlign` and `yAlign`\n   * are set to `CENTER`.\n   *\n   * @method image\n   * @param  {p5.Image|p5.Element|p5.Texture|p5.Framebuffer|p5.FramebufferTexture|p5.Renderer|p5.Graphics} img image to display.\n   * @param  {Number}   x x-coordinate of the top-left corner of the image.\n   * @param  {Number}   y y-coordinate of the top-left corner of the image.\n   * @param  {Number}   [width]  width to draw the image.\n   * @param  {Number}   [height] height to draw the image.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Draw the image.\n   *   image(img, 10, 10);\n   *\n   *   describe('An image of the underside of a white umbrella with a gridded ceiling above. The image has dark gray borders on its left and top.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Draw the image 50x50.\n   *   image(img, 0, 0, 50, 50);\n   *\n   *   describe('An image of the underside of a white umbrella with a gridded ceiling above. The image is drawn in the top left corner of a dark gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Draw the center of the image.\n   *   image(img, 25, 25, 50, 50, 25, 25, 50, 50);\n   *\n   *   describe('An image of a gridded ceiling drawn in the center of a dark gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/moonwalk.jpg');\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Draw the image and scale it to fit within the canvas.\n   *   image(img, 0, 0, width, height, 0, 0, img.width, img.height, CONTAIN);\n   *\n   *   describe('An image of an astronaut on the moon. The top and bottom borders of the image are dark gray.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/laDefense50.png');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(50);\n   *\n   *   // Draw the image and scale it to cover the canvas.\n   *   image(img, 0, 0, width, height, 0, 0, img.width, img.height, COVER);\n   *\n   *   describe('A pixelated image of the underside of a white umbrella with a gridded ceiling above.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method image\n   * @param  {p5.Image|p5.Element|p5.Texture|p5.Framebuffer|p5.FramebufferTexture} img\n   * @param  {Number}   dx     the x-coordinate of the destination\n   *                           rectangle in which to draw the source image\n   * @param  {Number}   dy     the y-coordinate of the destination\n   *                           rectangle in which to draw the source image\n   * @param  {Number}   dWidth  the width of the destination rectangle\n   * @param  {Number}   dHeight the height of the destination rectangle\n   * @param  {Number}   sx     the x-coordinate of the subsection of the source\n   * image to draw into the destination rectangle\n   * @param  {Number}   sy     the y-coordinate of the subsection of the source\n   * image to draw into the destination rectangle\n   * @param {Number}    [sWidth] the width of the subsection of the\n   *                           source image to draw into the destination\n   *                           rectangle\n   * @param {Number}    [sHeight] the height of the subsection of the\n   *                            source image to draw into the destination rectangle\n   * @param {(CONTAIN|COVER)} [fit] either CONTAIN or COVER\n   * @param {(LEFT|RIGHT|CENTER)} [xAlign=CENTER] either LEFT, RIGHT or CENTER default is CENTER\n   * @param {(TOP|BOTTOM|CENTER)} [yAlign=CENTER] either TOP, BOTTOM or CENTER default is CENTER\n   */\n  fn.image = function(\n    img,\n    dx,\n    dy,\n    dWidth,\n    dHeight,\n    sx,\n    sy,\n    sWidth,\n    sHeight,\n    fit,\n    xAlign,\n    yAlign\n  ) {\n    // set defaults per spec: https://goo.gl/3ykfOq\n\n    // p5._validateParameters('image', arguments);\n\n    let defW = img.width;\n    let defH = img.height;\n    yAlign = yAlign || CENTER;\n    xAlign = xAlign || CENTER;\n\n    if (img.elt) {\n      defW = defW !== undefined ? defW : img.elt.width;\n      defH = defH !== undefined ? defH : img.elt.height;\n    }\n    if (img.elt && img.elt.videoWidth && !img.canvas) {\n      // video no canvas\n      defW = defW !== undefined ? defW : img.elt.videoWidth;\n      defH = defH !== undefined ? defH : img.elt.videoHeight;\n    }\n\n    let _dx = dx;\n    let _dy = dy;\n    let _dw = dWidth || defW;\n    let _dh = dHeight || defH;\n    let _sx = sx || 0;\n    let _sy = sy || 0;\n    let _sw = sWidth !== undefined ? sWidth : defW;\n    let _sh = sHeight !== undefined ? sHeight : defH;\n\n    _sw = _sAssign(_sw, defW);\n    _sh = _sAssign(_sh, defH);\n\n    // This part needs cleanup and unit tests\n    // see issues https://github.com/processing/p5.js/issues/1741\n    // and https://github.com/processing/p5.js/issues/1673\n    let pd = 1;\n\n    if (img.elt && !img.canvas && img.elt.style.width) {\n      //if img is video and img.elt.size() has been used and\n      //no width passed to image()\n      if (img.elt.videoWidth && !dWidth) {\n        pd = img.elt.videoWidth;\n      } else {\n        //all other cases\n        pd = img.elt.width;\n      }\n      pd /= parseInt(img.elt.style.width, 10);\n    }\n\n    _sx *= pd;\n    _sy *= pd;\n    _sh *= pd;\n    _sw *= pd;\n\n    let vals = canvas.modeAdjust(_dx, _dy, _dw, _dh, this._renderer.states.imageMode);\n    vals = _imageFit(\n      fit,\n      xAlign,\n      yAlign,\n      vals.x,\n      vals.y,\n      vals.w,\n      vals.h,\n      _sx,\n      _sy,\n      _sw,\n      _sh\n    );\n\n    // tint the image if there is a tint\n    this._renderer.image(\n      img,\n      vals.sx,\n      vals.sy,\n      vals.sw,\n      vals.sh,\n      vals.dx,\n      vals.dy,\n      vals.dw,\n      vals.dh\n    );\n  };\n\n  /**\n   * Tints images using a color.\n   *\n   * The version of `tint()` with one parameter interprets it one of four ways.\n   * If the parameter is a number, it's interpreted as a grayscale value. If the\n   * parameter is a string, it's interpreted as a CSS color string. An array of\n   * `[R, G, B, A]` values or a <a href=\"#/p5.Color\">p5.Color</a> object can\n   * also be used to set the tint color.\n   *\n   * The version of `tint()` with two parameters uses the first one as a\n   * grayscale value and the second as an alpha value. For example, calling\n   * `tint(255, 128)` will make an image 50% transparent.\n   *\n   * The version of `tint()` with three parameters interprets them as RGB or\n   * HSB values, depending on the current\n   * <a href=\"#/p5/colorMode\">colorMode()</a>. The optional fourth parameter\n   * sets the alpha value. For example, `tint(255, 0, 0, 100)` will give images\n   * a red tint and make them transparent.\n   *\n   * @method tint\n   * @param  {Number}        v1      red or hue value.\n   * @param  {Number}        v2      green or saturation value.\n   * @param  {Number}        v3      blue or brightness.\n   * @param  {Number}        [alpha]\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Left image.\n   *   image(img, 0, 0);\n   *\n   *   // Right image.\n   *   // Tint with a CSS color string.\n   *   tint('red');\n   *   image(img, 50, 0);\n   *\n   *   describe('Two images of an umbrella and a ceiling side-by-side. The image on the right has a red tint.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Left image.\n   *   image(img, 0, 0);\n   *\n   *   // Right image.\n   *   // Tint with RGB values.\n   *   tint(255, 0, 0);\n   *   image(img, 50, 0);\n   *\n   *   describe('Two images of an umbrella and a ceiling side-by-side. The image on the right has a red tint.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   **\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Left.\n   *   image(img, 0, 0);\n   *\n   *   // Right.\n   *   // Tint with RGBA values.\n   *   tint(255, 0, 0, 100);\n   *   image(img, 50, 0);\n   *\n   *   describe('Two images of an umbrella and a ceiling side-by-side. The image on the right has a transparent red tint.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Left.\n   *   image(img, 0, 0);\n   *\n   *   // Right.\n   *   // Tint with grayscale and alpha values.\n   *   tint(255, 180);\n   *   image(img, 50, 0);\n   *\n   *   describe('Two images of an umbrella and a ceiling side-by-side. The image on the right is transparent.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method tint\n   * @param  {String}        value   CSS color string.\n   */\n\n  /**\n   * @method tint\n   * @param  {Number}        gray   grayscale value.\n   * @param  {Number}        [alpha]\n   */\n\n  /**\n   * @method tint\n   * @param  {Number[]}      values  array containing the red, green, blue &\n   *                                 alpha components of the color.\n   */\n\n  /**\n   * @method tint\n   * @param  {p5.Color}      color   the tint color\n   */\n  fn.tint = function(...args) {\n    // p5._validateParameters('tint', args);\n    const c = this.color(...args);\n    this._renderer.states.setValue('tint', c._getRGBA([255, 255, 255, 255]));\n  };\n\n  /**\n   * Removes the current tint set by <a href=\"#/p5/tint\">tint()</a>.\n   *\n   * `noTint()` restores images to their original colors.\n   *\n   * @method noTint\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   // Left.\n   *   // Tint with a CSS color string.\n   *   tint('red');\n   *   image(img, 0, 0);\n   *\n   *   // Right.\n   *   // Remove the tint.\n   *   noTint();\n   *   image(img, 50, 0);\n   *\n   *   describe('Two images of an umbrella and a ceiling side-by-side. The image on the left has a red tint.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noTint = function() {\n    this._renderer.states.setValue('tint', null);\n  };\n\n  /**\n   * Apply the current tint color to the input image, return the resulting\n   * canvas.\n   *\n   * @private\n   * @param {p5.Image} The image to be tinted\n   * @return {canvas} The resulting tinted canvas\n   */\n  // fn._getTintedImageCanvas =\n  //   p5.Renderer2D.prototype._getTintedImageCanvas;\n\n  /**\n   * Changes the location from which images are drawn when\n   * <a href=\"#/p5/image\">image()</a> is called.\n   *\n   * By default, the first\n   * two parameters of <a href=\"#/p5/image\">image()</a> are the x- and\n   * y-coordinates of the image's upper-left corner. The next parameters are\n   * its width and height. This is the same as calling `imageMode(CORNER)`.\n   *\n   * `imageMode(CORNERS)` also uses the first two parameters of\n   * <a href=\"#/p5/image\">image()</a> as the x- and y-coordinates of the image's\n   * top-left corner. The third and fourth parameters are the coordinates of its\n   * bottom-right corner.\n   *\n   * `imageMode(CENTER)` uses the first two parameters of\n   * <a href=\"#/p5/image\">image()</a> as the x- and y-coordinates of the image's\n   * center. The next parameters are its width and height.\n   *\n   * @method imageMode\n   * @param {(CORNER|CORNERS|CENTER)} mode either CORNER, CORNERS, or CENTER.\n   *\n   * @example\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use CORNER mode.\n   *   imageMode(CORNER);\n   *\n   *   // Display the image.\n   *   image(img, 10, 10, 50, 50);\n   *\n   *   describe('A square image of a brick wall is drawn at the top left of a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use CORNERS mode.\n   *   imageMode(CORNERS);\n   *\n   *   // Display the image.\n   *   image(img, 10, 10, 90, 40);\n   *\n   *   describe('An image of a brick wall is drawn on a gray square. The image is squeezed into a small rectangular area.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load the image.\n   *   img = await loadImage('assets/bricks.jpg');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use CENTER mode.\n   *   imageMode(CENTER);\n   *\n   *   // Display the image.\n   *   image(img, 50, 50, 80, 80);\n   *\n   *   describe('A square image of a brick wall is drawn on a gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.imageMode = function(m) {\n    // p5._validateParameters('imageMode', arguments);\n    if (\n      m === CORNER ||\n      m === CORNERS ||\n      m === CENTER\n    ) {\n      this._renderer.states.setValue('imageMode', m);\n    }\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  loadingDisplaying(p5, p5.prototype);\n}\n\n/**\n * @module 3D\n * @submodule Camera\n * @requires core\n */\n\n\nclass Camera {\n  constructor(renderer) {\n    this._renderer = renderer;\n\n    this.cameraType = 'default';\n    this.useLinePerspective = true;\n    this.cameraMatrix = new Matrix(4);\n    this.projMatrix = new Matrix(4);\n    this.yScale = 1;\n  }\n  /**\n   * The cameras x-coordinate.\n   *\n   * By default, the cameras x-coordinate is set to 0 in \"world\" space.\n   *\n   * @property {Number} eyeX\n   * @readonly\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at the origin.\n   *   cam.lookAt(0, 0, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The text \"eyeX: 0\" is written in black beneath it.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Display the value of eyeX, rounded to the nearest integer.\n   *   text(`eyeX: ${round(cam.eyeX)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at the origin.\n   *   cam.lookAt(0, 0, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube appears to move left and right as the camera moves. The text \"eyeX: X\" is written in black beneath the cube. X oscillates between -25 and 25.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Calculate the new x-coordinate.\n   *   let x = 25 * sin(frameCount * 0.01);\n   *\n   *   // Set the camera's position.\n   *   cam.setPosition(x, -400, 800);\n   *\n   *   // Display the value of eyeX, rounded to the nearest integer.\n   *   text(`eyeX: ${round(cam.eyeX)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The cameras y-coordinate.\n   *\n   * By default, the cameras y-coordinate is set to 0 in \"world\" space.\n   *\n   * @property {Number} eyeY\n   * @readonly\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at the origin.\n   *   cam.lookAt(0, 0, 0);\n   *\n   *   // Set the camera.\n   *   setCamera(cam);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The text \"eyeY: -400\" is written in black beneath it.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Display the value of eyeY, rounded to the nearest integer.\n   *   text(`eyeY: ${round(cam.eyeY)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at the origin.\n   *   cam.lookAt(0, 0, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube appears to move up and down as the camera moves. The text \"eyeY: Y\" is written in black beneath the cube. Y oscillates between -374 and -425.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Calculate the new y-coordinate.\n   *   let y = 25 * sin(frameCount * 0.01) - 400;\n   *\n   *   // Set the camera's position.\n   *   cam.setPosition(0, y, 800);\n   *\n   *   // Display the value of eyeY, rounded to the nearest integer.\n   *   text(`eyeY: ${round(cam.eyeY)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The cameras z-coordinate.\n   *\n   * By default, the cameras z-coordinate is set to 800 in \"world\" space.\n   *\n   * @property {Number} eyeZ\n   * @readonly\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at the origin.\n   *   cam.lookAt(0, 0, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The text \"eyeZ: 800\" is written in black beneath it.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Display the value of eyeZ, rounded to the nearest integer.\n   *   text(`eyeZ: ${round(cam.eyeZ)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at the origin.\n   *   cam.lookAt(0, 0, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube appears to move forward and back as the camera moves. The text \"eyeZ: Z\" is written in black beneath the cube. Z oscillates between 700 and 900.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Calculate the new z-coordinate.\n   *   let z = 100 * sin(frameCount * 0.01) + 800;\n   *\n   *   // Set the camera's position.\n   *   cam.setPosition(0, -400, z);\n   *\n   *   // Display the value of eyeZ, rounded to the nearest integer.\n   *   text(`eyeZ: ${round(cam.eyeZ)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The x-coordinate of the place where the camera looks.\n   *\n   * By default, the camera looks at the origin `(0, 0, 0)` in \"world\" space, so\n   * `myCamera.centerX` is 0.\n   *\n   * @property {Number} centerX\n   * @readonly\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at (10, 20, -30).\n   *   cam.lookAt(10, 20, -30);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The text \"centerX: 10\" is written in black beneath it.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Display the value of centerX, rounded to the nearest integer.\n   *   text(`centerX: ${round(cam.centerX)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-right.\n   *   cam.setPosition(100, -400, 800);\n   *\n   *   // Point the camera at (10, 20, -30).\n   *   cam.lookAt(10, 20, -30);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube appears to move left and right as the camera shifts its focus. The text \"centerX: X\" is written in black beneath the cube. X oscillates between -15 and 35.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Calculate the new x-coordinate.\n   *   let x = 25 * sin(frameCount * 0.01) + 10;\n   *\n   *   // Point the camera.\n   *   cam.lookAt(x, 20, -30);\n   *\n   *   // Display the value of centerX, rounded to the nearest integer.\n   *   text(`centerX: ${round(cam.centerX)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The y-coordinate of the place where the camera looks.\n   *\n   * By default, the camera looks at the origin `(0, 0, 0)` in \"world\" space, so\n   * `myCamera.centerY` is 0.\n   *\n   * @property {Number} centerY\n   * @readonly\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at (10, 20, -30).\n   *   cam.lookAt(10, 20, -30);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The text \"centerY: 20\" is written in black beneath it.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Display the value of centerY, rounded to the nearest integer.\n   *   text(`centerY: ${round(cam.centerY)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-right.\n   *   cam.setPosition(100, -400, 800);\n   *\n   *   // Point the camera at (10, 20, -30).\n   *   cam.lookAt(10, 20, -30);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube appears to move up and down as the camera shifts its focus. The text \"centerY: Y\" is written in black beneath the cube. Y oscillates between -5 and 45.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Calculate the new y-coordinate.\n   *   let y = 25 * sin(frameCount * 0.01) + 20;\n   *\n   *   // Point the camera.\n   *   cam.lookAt(10, y, -30);\n   *\n   *   // Display the value of centerY, rounded to the nearest integer.\n   *   text(`centerY: ${round(cam.centerY)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The y-coordinate of the place where the camera looks.\n   *\n   * By default, the camera looks at the origin `(0, 0, 0)` in \"world\" space, so\n   * `myCamera.centerZ` is 0.\n   *\n   * @property {Number} centerZ\n   * @readonly\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at (10, 20, -30).\n   *   cam.lookAt(10, 20, -30);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The text \"centerZ: -30\" is written in black beneath it.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Display the value of centerZ, rounded to the nearest integer.\n   *   text(`centerZ: ${round(cam.centerZ)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Place the camera at the top-right.\n   *   cam.setPosition(100, -400, 800);\n   *\n   *   // Point the camera at (10, 20, -30).\n   *   cam.lookAt(10, 20, -30);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube appears to move forward and back as the camera shifts its focus. The text \"centerZ: Z\" is written in black beneath the cube. Z oscillates between -55 and -25.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Calculate the new z-coordinate.\n   *   let z = 25 * sin(frameCount * 0.01) - 30;\n   *\n   *   // Point the camera.\n   *   cam.lookAt(10, 20, z);\n   *\n   *   // Display the value of centerZ, rounded to the nearest integer.\n   *   text(`centerZ: ${round(cam.centerZ)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The x-component of the camera's \"up\" vector.\n   *\n   * The camera's \"up\" vector orients its y-axis. By default, the \"up\" vector is\n   * `(0, 1, 0)`, so its x-component is 0 in \"local\" space.\n   *\n   * @property {Number} upX\n   * @readonly\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-right: (100, -400, 800)\n   *   // Point it at the origin: (0, 0, 0)\n   *   // Set its \"up\" vector: (0, 1, 0).\n   *   cam.camera(100, -400, 800, 0, 0, 0, 0, 1, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The text \"upX: 0\" is written in black beneath it.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Display the value of upX, rounded to the nearest tenth.\n   *   text(`upX: ${round(cam.upX, 1)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-right: (100, -400, 800)\n   *   // Point it at the origin: (0, 0, 0)\n   *   // Set its \"up\" vector: (0, 1, 0).\n   *   cam.camera(100, -400, 800, 0, 0, 0, 0, 1, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube appears to rock back and forth. The text \"upX: X\" is written in black beneath it. X oscillates between -1 and 1.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Calculate the x-component.\n   *   let x = sin(frameCount * 0.01);\n   *\n   *   // Update the camera's \"up\" vector.\n   *   cam.camera(100, -400, 800, 0, 0, 0, x, 1, 0);\n   *\n   *   // Display the value of upX, rounded to the nearest tenth.\n   *   text(`upX: ${round(cam.upX, 1)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The y-component of the camera's \"up\" vector.\n   *\n   * The camera's \"up\" vector orients its y-axis. By default, the \"up\" vector is\n   * `(0, 1, 0)`, so its y-component is 1 in \"local\" space.\n   *\n   * @property {Number} upY\n   * @readonly\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-right: (100, -400, 800)\n   *   // Point it at the origin: (0, 0, 0)\n   *   // Set its \"up\" vector: (0, 1, 0).\n   *   cam.camera(100, -400, 800, 0, 0, 0, 0, 1, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The text \"upY: 1\" is written in black beneath it.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Display the value of upY, rounded to the nearest tenth.\n   *   text(`upY: ${round(cam.upY, 1)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-right: (100, -400, 800)\n   *   // Point it at the origin: (0, 0, 0)\n   *   // Set its \"up\" vector: (0, 1, 0).\n   *   cam.camera(100, -400, 800, 0, 0, 0, 0, 1, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube flips upside-down periodically. The text \"upY: Y\" is written in black beneath it. Y oscillates between -1 and 1.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Calculate the y-component.\n   *   let y = sin(frameCount * 0.01);\n   *\n   *   // Update the camera's \"up\" vector.\n   *   cam.camera(100, -400, 800, 0, 0, 0, 0, y, 0);\n   *\n   *   // Display the value of upY, rounded to the nearest tenth.\n   *   text(`upY: ${round(cam.upY, 1)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The z-component of the camera's \"up\" vector.\n   *\n   * The camera's \"up\" vector orients its y-axis. By default, the \"up\" vector is\n   * `(0, 1, 0)`, so its z-component is 0 in \"local\" space.\n   *\n   * @property {Number} upZ\n   * @readonly\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-right: (100, -400, 800)\n   *   // Point it at the origin: (0, 0, 0)\n   *   // Set its \"up\" vector: (0, 1, 0).\n   *   cam.camera(100, -400, 800, 0, 0, 0, 0, 1, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The text \"upZ: 0\" is written in black beneath it.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Display the value of upZ, rounded to the nearest tenth.\n   *   text(`upZ: ${round(cam.upZ, 1)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let cam;\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-right: (100, -400, 800)\n   *   // Point it at the origin: (0, 0, 0)\n   *   // Set its \"up\" vector: (0, 1, 0).\n   *   cam.camera(100, -400, 800, 0, 0, 0, 0, 1, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube appears to rock back and forth. The text \"upZ: Z\" is written in black beneath it. Z oscillates between -1 and 1.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the box.\n   *   fill(255);\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Calculate the z-component.\n   *   let z = sin(frameCount * 0.01);\n   *\n   *   // Update the camera's \"up\" vector.\n   *   cam.camera(100, -400, 800, 0, 0, 0, 0, 1, z);\n   *\n   *   // Display the value of upZ, rounded to the nearest tenth.\n   *   text(`upZ: ${round(cam.upZ, 1)}`, 0, 45);\n   * }\n   * </code>\n   * </div>\n   */\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Camera Projection Methods\n  ////////////////////////////////////////////////////////////////////////////////\n\n  /**\n   * Sets a perspective projection for the camera.\n   *\n   * In a perspective projection, shapes that are further from the camera appear\n   * smaller than shapes that are near the camera. This technique, called\n   * foreshortening, creates realistic 3D scenes. Its applied by default in new\n   * `p5.Camera` objects.\n   *\n   * `myCamera.perspective()` changes the cameras perspective by changing its\n   * viewing frustum. The frustum is the volume of space thats visible to the\n   * camera. The frustums shape is a pyramid with its top cut off. The camera\n   * is placed where the top of the pyramid should be and points towards the\n   * base of the pyramid. It views everything within the frustum.\n   *\n   * The first parameter, `fovy`, is the cameras vertical field of view. Its\n   * an angle that describes how tall or narrow a view the camera has. For\n   * example, calling `myCamera.perspective(0.5)` sets the cameras vertical\n   * field of view to 0.5 radians. By default, `fovy` is calculated based on the\n   * sketchs height and the cameras default z-coordinate, which is 800. The\n   * formula for the default `fovy` is `2 * atan(height / 2 / 800)`.\n   *\n   * The second parameter, `aspect`, is the cameras aspect ratio. Its a number\n   * that describes the ratio of the top planes width to its height. For\n   * example, calling `myCamera.perspective(0.5, 1.5)` sets the cameras field\n   * of view to 0.5 radians and aspect ratio to 1.5, which would make shapes\n   * appear thinner on a square canvas. By default, `aspect` is set to\n   * `width / height`.\n   *\n   * The third parameter, `near`, is the distance from the camera to the near\n   * plane. For example, calling `myCamera.perspective(0.5, 1.5, 100)` sets the\n   * cameras field of view to 0.5 radians, its aspect ratio to 1.5, and places\n   * the near plane 100 pixels from the camera. Any shapes drawn less than 100\n   * pixels from the camera wont be visible. By default, `near` is set to\n   * `0.1 * 800`, which is 1/10th the default distance between the camera and\n   * the origin.\n   *\n   * The fourth parameter, `far`, is the distance from the camera to the far\n   * plane. For example, calling `myCamera.perspective(0.5, 1.5, 100, 10000)`\n   * sets the cameras field of view to 0.5 radians, its aspect ratio to 1.5,\n   * places the near plane 100 pixels from the camera, and places the far plane\n   * 10,000 pixels from the camera. Any shapes drawn more than 10,000 pixels\n   * from the camera wont be visible. By default, `far` is set to `10 * 800`,\n   * which is 10 times the default distance between the camera and the origin.\n   *\n   * @for p5.Camera\n   * @param  {Number} [fovy]   camera frustum vertical field of view. Defaults to\n   *                           `2 * atan(height / 2 / 800)`.\n   * @param  {Number} [aspect] camera frustum aspect ratio. Defaults to\n   *                           `width / height`.\n   * @param  {Number} [near]   distance from the camera to the near clipping plane.\n   *                           Defaults to `0.1 * 800`.\n   * @param  {Number} [far]    distance from the camera to the far clipping plane.\n   *                           Defaults to `10 * 800`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let isDefaultCamera = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   cam2 = createCamera();\n   *\n   *   // Place it at the top-right.\n   *   cam2.camera(400, -400, 800);\n   *\n   *   // Set its fovy to 0.2.\n   *   // Set its aspect to 1.5.\n   *   // Set its near to 600.\n   *   // Set its far to 1200.\n   *   cam2.perspective(0.2, 1.5, 600, 1200);\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe('A white cube on a gray background. The camera toggles between a frontal view and a skewed aerial view when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isDefaultCamera === true) {\n   *     setCamera(cam2);\n   *     isDefaultCamera = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     isDefaultCamera = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let isDefaultCamera = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   cam2 = createCamera();\n   *\n   *   // Place it at the top-right.\n   *   cam2.camera(400, -400, 800);\n   *\n   *   // Set its fovy to 0.2.\n   *   // Set its aspect to 1.5.\n   *   // Set its near to 600.\n   *   // Set its far to 1200.\n   *   cam2.perspective(0.2, 1.5, 600, 1200);\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe('A white cube moves left and right on a gray background. The camera toggles between a frontal and a skewed aerial view when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin left and right.\n   *   let x = 100 * sin(frameCount * 0.01);\n   *   translate(x, 0, 0);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isDefaultCamera === true) {\n   *     setCamera(cam2);\n   *     isDefaultCamera = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     isDefaultCamera = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  perspective(fovy, aspect, near, far) {\n    this.cameraType = arguments.length > 0 ? 'custom' : 'default';\n    if (typeof fovy === 'undefined') {\n      fovy = this.defaultCameraFOV;\n      // this avoids issue where setting angleMode(DEGREES) before calling\n      // perspective leads to a smaller than expected FOV (because\n      // _computeCameraDefaultSettings computes in radians)\n      this.cameraFOV = fovy;\n    } else {\n      this.cameraFOV = this._renderer._pInst._toRadians(fovy);\n    }\n    if (typeof aspect === 'undefined') {\n      aspect = this.defaultAspectRatio;\n    }\n    if (typeof near === 'undefined') {\n      near = this.defaultCameraNear;\n    }\n    if (typeof far === 'undefined') {\n      far = this.defaultCameraFar;\n    }\n\n    if (near <= 0.0001) {\n      near = 0.01;\n      console.log(\n        'Avoid perspective near plane values close to or below 0. ' +\n        'Setting value to 0.01.'\n      );\n    }\n\n    if (far < near) {\n      console.log(\n        'Perspective far plane value is less than near plane value. ' +\n        'Nothing will be shown.'\n      );\n    }\n\n    this.aspectRatio = aspect;\n    this.cameraNear = near;\n    this.cameraFar = far;\n\n    this.projMatrix = new Matrix(4);\n\n    const f = 1.0 / Math.tan(this.cameraFOV / 2);\n    const nf = 1.0 / (this.cameraNear - this.cameraFar);\n\n    /* eslint-disable indent */\n    this.projMatrix.set(f / aspect, 0, 0, 0,\n      0, -f * this.yScale, 0, 0,\n      0, 0, (far + near) * nf, -1,\n      0, 0, (2 * far * near) * nf, 0);\n    /* eslint-enable indent */\n\n    if (this._isActive()) {\n      this._renderer.states.setValue('uPMatrix', this._renderer.states.uPMatrix.clone());\n      this._renderer.states.uPMatrix.set(this.projMatrix);\n    }\n  }\n\n  /**\n   * Sets an orthographic projection for the camera.\n   *\n   * In an orthographic projection, shapes with the same size always appear the\n   * same size, regardless of whether they are near or far from the camera.\n   *\n   * `myCamera.ortho()` changes the cameras perspective by changing its viewing\n   * frustum from a truncated pyramid to a rectangular prism. The frustum is the\n   * volume of space thats visible to the camera. The camera is placed in front\n   * of the frustum and views everything within the frustum. `myCamera.ortho()`\n   * has six optional parameters to define the viewing frustum.\n   *\n   * The first four parameters, `left`, `right`, `bottom`, and `top`, set the\n   * coordinates of the frustums sides, bottom, and top. For example, calling\n   * `myCamera.ortho(-100, 100, 200, -200)` creates a frustum thats 200 pixels\n   * wide and 400 pixels tall. By default, these dimensions are set based on\n   * the sketchs width and height, as in\n   * `myCamera.ortho(-width / 2, width / 2, -height / 2, height / 2)`.\n   *\n   * The last two parameters, `near` and `far`, set the distance of the\n   * frustums near and far plane from the camera. For example, calling\n   * `myCamera.ortho(-100, 100, 200, -200, 50, 1000)` creates a frustum thats\n   * 200 pixels wide, 400 pixels tall, starts 50 pixels from the camera, and\n   * ends 1,000 pixels from the camera. By default, `near` and `far` are set to\n   * 0 and `max(width, height) + 800`, respectively.\n   *\n   * @for p5.Camera\n   * @param  {Number} [left]   x-coordinate of the frustums left plane. Defaults to `-width / 2`.\n   * @param  {Number} [right]  x-coordinate of the frustums right plane. Defaults to `width / 2`.\n   * @param  {Number} [bottom] y-coordinate of the frustums bottom plane. Defaults to `height / 2`.\n   * @param  {Number} [top]    y-coordinate of the frustums top plane. Defaults to `-height / 2`.\n   * @param  {Number} [near]   z-coordinate of the frustums near plane. Defaults to 0.\n   * @param  {Number} [far]    z-coordinate of the frustums far plane. Defaults to `max(width, height) + 800`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let isDefaultCamera = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   cam2 = createCamera();\n   *\n   *   // Apply an orthographic projection.\n   *   cam2.ortho();\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe('A row of white cubes against a gray background. The camera toggles between a perspective and an orthographic projection when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 500);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -40);\n   *     box(10);\n   *   }\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isDefaultCamera === true) {\n   *     setCamera(cam2);\n   *     isDefaultCamera = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     isDefaultCamera = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let isDefaultCamera = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   cam2 = createCamera();\n   *\n   *   // Apply an orthographic projection.\n   *   cam2.ortho();\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe('A row of white cubes slither like a snake against a gray background. The camera toggles between a perspective and an orthographic projection when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 500);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     push();\n   *     // Calculate the box's coordinates.\n   *     let x = 10 * sin(frameCount * 0.02 + i * 0.6);\n   *     let z = -40 * i;\n   *     // Translate the origin.\n   *     translate(x, 0, z);\n   *     // Draw the box.\n   *     box(10);\n   *     pop();\n   *   }\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isDefaultCamera === true) {\n   *     setCamera(cam2);\n   *     isDefaultCamera = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     isDefaultCamera = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  ortho(left, right, bottom, top, near, far) {\n    const source = this.fbo || this._renderer;\n    if (left === undefined) left = -source.width / 2;\n    if (right === undefined) right = +source.width / 2;\n    if (bottom === undefined) bottom = -source.height / 2;\n    if (top === undefined) top = +source.height / 2;\n    if (near === undefined) near = 0;\n    if (far === undefined) far = Math.max(source.width, source.height) + 800;\n    this.cameraNear = near;\n    this.cameraFar = far;\n    const w = right - left;\n    const h = top - bottom;\n    const d = far - near;\n    const x = 2 / w;\n    const y = 2 / h * this.yScale;\n    const z = -2 / d;\n    const tx = -(right + left) / w;\n    const ty = -(top + bottom) / h;\n    const tz = -(far + near) / d;\n    this.projMatrix = new Matrix(4);\n    /* eslint-disable indent */\n    this.projMatrix.set(x, 0, 0, 0,\n      0, -y, 0, 0,\n      0, 0, z, 0,\n      tx, ty, tz, 1);\n    /* eslint-enable indent */\n    if (this._isActive()) {\n      this._renderer.states.setValue('uPMatrix', this._renderer.states.uPMatrix.clone());\n      this._renderer.states.uPMatrix.set(this.projMatrix);\n    }\n    this.cameraType = 'custom';\n  }\n  /**\n   * Sets the camera's frustum.\n   *\n   * In a frustum projection, shapes that are further from the camera appear\n   * smaller than shapes that are near the camera. This technique, called\n   * foreshortening, creates realistic 3D scenes.\n   *\n   * `myCamera.frustum()` changes the cameras perspective by changing its\n   * viewing frustum. The frustum is the volume of space thats visible to the\n   * camera. The frustums shape is a pyramid with its top cut off. The camera\n   * is placed where the top of the pyramid should be and points towards the\n   * base of the pyramid. It views everything within the frustum.\n   *\n   * The first four parameters, `left`, `right`, `bottom`, and `top`, set the\n   * coordinates of the frustums sides, bottom, and top. For example, calling\n   * `myCamera.frustum(-100, 100, 200, -200)` creates a frustum thats 200\n   * pixels wide and 400 pixels tall. By default, these coordinates are set\n   * based on the sketchs width and height, as in\n   * `myCamera.frustum(-width / 20, width / 20, height / 20, -height / 20)`.\n   *\n   * The last two parameters, `near` and `far`, set the distance of the\n   * frustums near and far plane from the camera. For example, calling\n   * `myCamera.frustum(-100, 100, 200, -200, 50, 1000)` creates a frustum thats\n   * 200 pixels wide, 400 pixels tall, starts 50 pixels from the camera, and ends\n   * 1,000 pixels from the camera. By default, near is set to `0.1 * 800`, which\n   * is 1/10th the default distance between the camera and the origin. `far` is\n   * set to `10 * 800`, which is 10 times the default distance between the\n   * camera and the origin.\n   *\n   * @for p5.Camera\n   * @param  {Number} [left]   x-coordinate of the frustums left plane. Defaults to `-width / 20`.\n   * @param  {Number} [right]  x-coordinate of the frustums right plane. Defaults to `width / 20`.\n   * @param  {Number} [bottom] y-coordinate of the frustums bottom plane. Defaults to `height / 20`.\n   * @param  {Number} [top]    y-coordinate of the frustums top plane. Defaults to `-height / 20`.\n   * @param  {Number} [near]   z-coordinate of the frustums near plane. Defaults to `0.1 * 800`.\n   * @param  {Number} [far]    z-coordinate of the frustums far plane. Defaults to `10 * 800`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let isDefaultCamera = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   cam2 = createCamera();\n   *\n   *   // Adjust the frustum.\n   *   // Center it.\n   *   // Set its width and height to 20 pixels.\n   *   // Place its near plane 300 pixels from the camera.\n   *   // Place its far plane 350 pixels from the camera.\n   *   cam2.frustum(-10, 10, -10, 10, 300, 350);\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe(\n   *     'A row of white cubes against a gray background. The camera zooms in on one cube when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 600);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -40);\n   *     box(10);\n   *   }\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isDefaultCamera === true) {\n   *     setCamera(cam2);\n   *     isDefaultCamera = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     isDefaultCamera = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  frustum(left, right, bottom, top, near, far) {\n    if (left === undefined) left = -this._renderer.width * 0.05;\n    if (right === undefined) right = +this._renderer.width * 0.05;\n    if (bottom === undefined) bottom = +this._renderer.height * 0.05;\n    if (top === undefined) top = -this._renderer.height * 0.05;\n    if (near === undefined) near = this.defaultCameraNear;\n    if (far === undefined) far = this.defaultCameraFar;\n\n    this.cameraNear = near;\n    this.cameraFar = far;\n\n    const w = right - left;\n    const h = top - bottom;\n    const d = far - near;\n\n    const x = +(2.0 * near) / w;\n    const y = +(2.0 * near) / h * this.yScale;\n    const z = -(2.0 * far * near) / d;\n\n    const tx = (right + left) / w;\n    const ty = (top + bottom) / h;\n    const tz = -(far + near) / d;\n\n    this.projMatrix = new Matrix(4);\n\n    /* eslint-disable indent */\n    this.projMatrix.set(x, 0, 0, 0,\n      0, -y, 0, 0,\n      tx, ty, tz, -1,\n      0, 0, z, 0);\n    /* eslint-enable indent */\n\n    if (this._isActive()) {\n      this._renderer.states.setValue('uPMatrix', this._renderer.states.uPMatrix.clone());\n      this._renderer.states.uPMatrix.set(this.projMatrix);\n    }\n\n    this.cameraType = 'custom';\n  }\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Camera Orientation Methods\n  ////////////////////////////////////////////////////////////////////////////////\n\n  /**\n   * Rotate camera view about arbitrary axis defined by x,y,z\n   * based on http://learnwebgl.brown37.net/07_cameras/camera_rotating_motion.html\n   * @private\n   */\n  _rotateView(a, x, y, z) {\n    let centerX = this.centerX;\n    let centerY = this.centerY;\n    let centerZ = this.centerZ;\n\n    // move center by eye position such that rotation happens around eye position\n    centerX -= this.eyeX;\n    centerY -= this.eyeY;\n    centerZ -= this.eyeZ;\n\n    const rotation = new Matrix(4); // TODO Maybe pass p5\n    rotation.rotate4x4(this._renderer._pInst._toRadians(a), x, y, z);\n\n    /* eslint-disable max-len */\n    const rotatedCenter = [\n      centerX * rotation.mat4[0] + centerY * rotation.mat4[4] + centerZ * rotation.mat4[8],\n      centerX * rotation.mat4[1] + centerY * rotation.mat4[5] + centerZ * rotation.mat4[9],\n      centerX * rotation.mat4[2] + centerY * rotation.mat4[6] + centerZ * rotation.mat4[10]\n    ];\n    /* eslint-enable max-len */\n\n    // add eye position back into center\n    rotatedCenter[0] += this.eyeX;\n    rotatedCenter[1] += this.eyeY;\n    rotatedCenter[2] += this.eyeZ;\n\n    this.camera(\n      this.eyeX,\n      this.eyeY,\n      this.eyeZ,\n      rotatedCenter[0],\n      rotatedCenter[1],\n      rotatedCenter[2],\n      this.upX,\n      this.upY,\n      this.upZ\n    );\n  }\n\n  /**\n   * Rotates the camera in a clockwise/counter-clockwise direction.\n   *\n   * Rolling rotates the camera without changing its orientation. The rotation\n   * happens in the cameras \"local\" space.\n   *\n   * The parameter, `angle`, is the angle the camera should rotate. Passing a\n   * positive angle, as in `myCamera.roll(0.001)`, rotates the camera in counter-clockwise direction.\n   * Passing a negative angle, as in `myCamera.roll(-0.001)`, rotates the\n   * camera in clockwise direction.\n   *\n   * Note: Angles are interpreted based on the current\n   * <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * @method roll\n   * @param {Number} angle amount to rotate camera in current\n   * <a href=\"#/p5/angleMode\">angleMode</a> units.\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let delta = 0.01;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *   normalMaterial();\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Roll camera according to angle 'delta'\n   *   cam.roll(delta);\n   *\n   *   translate(0, 0, 0);\n   *   box(20);\n   *   translate(0, 25, 0);\n   *   box(20);\n   *   translate(0, 26, 0);\n   *   box(20);\n   *   translate(0, 27, 0);\n   *   box(20);\n   *   translate(0, 28, 0);\n   *   box(20);\n   *   translate(0,29, 0);\n   *   box(20);\n   *   translate(0, 30, 0);\n   *   box(20);\n   * }\n   * </code>\n   * </div>\n   *\n   * @alt\n   * camera view rotates in counter clockwise direction with vertically stacked boxes in front of it.\n   */\n  roll(amount) {\n    const local = this._getLocalAxes();\n    const axisQuaternion = Quat.fromAxisAngle(\n      this._renderer._pInst._toRadians(amount),\n      local.z[0], local.z[1], local.z[2]);\n    // const upQuat = new p5.Quat(0, this.upX, this.upY, this.upZ);\n    const newUpVector = axisQuaternion.rotateVector(\n      new Vector(this.upX, this.upY, this.upZ));\n    this.camera(\n      this.eyeX,\n      this.eyeY,\n      this.eyeZ,\n      this.centerX,\n      this.centerY,\n      this.centerZ,\n      newUpVector.x,\n      newUpVector.y,\n      newUpVector.z\n    );\n  }\n\n  /**\n   * Rotates the camera left and right.\n   *\n   * Panning rotates the camera without changing its position. The rotation\n   * happens in the cameras \"local\" space.\n   *\n   * The parameter, `angle`, is the angle the camera should rotate. Passing a\n   * positive angle, as in `myCamera.pan(0.001)`, rotates the camera to the\n   * right. Passing a negative angle, as in `myCamera.pan(-0.001)`, rotates the\n   * camera to the left.\n   *\n   * Note: Angles are interpreted based on the current\n   * <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * @param {Number} angle amount to rotate in the current\n   *                       <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let delta = 0.001;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at the origin.\n   *   cam.lookAt(0, 0, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube goes in and out of view as the camera pans left and right.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Pan with the camera.\n   *   cam.pan(delta);\n   *\n   *   // Switch directions every 120 frames.\n   *   if (frameCount % 120 === 0) {\n   *     delta *= -1;\n   *   }\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  pan(amount) {\n    const local = this._getLocalAxes();\n    this._rotateView(amount, local.y[0], local.y[1], local.y[2]);\n  }\n\n  /**\n   * Rotates the camera up and down.\n   *\n   * Tilting rotates the camera without changing its position. The rotation\n   * happens in the cameras \"local\" space.\n   *\n   * The parameter, `angle`, is the angle the camera should rotate. Passing a\n   * positive angle, as in `myCamera.tilt(0.001)`, rotates the camera down.\n   * Passing a negative angle, as in `myCamera.tilt(-0.001)`, rotates the camera\n   * up.\n   *\n   * Note: Angles are interpreted based on the current\n   * <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * @param {Number} angle amount to rotate in the current\n   *                       <a href=\"#/p5/angleMode\">angleMode()</a>.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let delta = 0.001;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at the origin.\n   *   cam.lookAt(0, 0, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube goes in and out of view as the camera tilts up and down.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Pan with the camera.\n   *   cam.tilt(delta);\n   *\n   *   // Switch directions every 120 frames.\n   *   if (frameCount % 120 === 0) {\n   *     delta *= -1;\n   *   }\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  tilt(amount) {\n    const local = this._getLocalAxes();\n    this._rotateView(amount, local.x[0], local.x[1], local.x[2]);\n  }\n\n  /**\n   * Points the camera at a location.\n   *\n   * `myCamera.lookAt()` changes the cameras orientation without changing its\n   * position.\n   *\n   * The parameters, `x`, `y`, and `z`, are the coordinates in \"world\" space\n   * where the camera should point. For example, calling\n   * `myCamera.lookAt(10, 20, 30)` points the camera at the coordinates\n   * `(10, 20, 30)`.\n   *\n   * @for p5.Camera\n   * @param {Number} x x-coordinate of the position where the camera should look in \"world\" space.\n   * @param {Number} y y-coordinate of the position where the camera should look in \"world\" space.\n   * @param {Number} z z-coordinate of the position where the camera should look in \"world\" space.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to look at a different cube.\n   *\n   * let cam;\n   * let isLookingLeft = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at the origin.\n   *   cam.lookAt(-30, 0, 0);\n   *\n   *   describe(\n   *     'A red cube and a blue cube on a gray background. The camera switches focus between the cubes when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the box on the left.\n   *   push();\n   *   // Translate the origin to the left.\n   *   translate(-30, 0, 0);\n   *   // Style the box.\n   *   fill(255, 0, 0);\n   *   // Draw the box.\n   *   box(20);\n   *   pop();\n   *\n   *   // Draw the box on the right.\n   *   push();\n   *   // Translate the origin to the right.\n   *   translate(30, 0, 0);\n   *   // Style the box.\n   *   fill(0, 0, 255);\n   *   // Draw the box.\n   *   box(20);\n   *   pop();\n   * }\n   *\n   * // Change the camera's focus when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isLookingLeft === true) {\n   *     cam.lookAt(30, 0, 0);\n   *     isLookingLeft = false;\n   *   } else {\n   *     cam.lookAt(-30, 0, 0);\n   *     isLookingLeft = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  lookAt(x, y, z) {\n    this.camera(\n      this.eyeX,\n      this.eyeY,\n      this.eyeZ,\n      x,\n      y,\n      z,\n      this.upX,\n      this.upY,\n      this.upZ\n    );\n  }\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Camera Position Methods\n  ////////////////////////////////////////////////////////////////////////////////\n\n  /**\n   * Sets the position and orientation of the camera.\n   *\n   * `myCamera.camera()` allows objects to be viewed from different angles. It\n   * has nine parameters that are all optional.\n   *\n   * The first three parameters, `x`, `y`, and `z`, are the coordinates of the\n   * cameras position in \"world\" space. For example, calling\n   * `myCamera.camera(0, 0, 0)` places the camera at the origin `(0, 0, 0)`. By\n   * default, the camera is placed at `(0, 0, 800)`.\n   *\n   * The next three parameters, `centerX`, `centerY`, and `centerZ` are the\n   * coordinates of the point where the camera faces in \"world\" space. For\n   * example, calling `myCamera.camera(0, 0, 0, 10, 20, 30)` places the camera\n   * at the origin `(0, 0, 0)` and points it at `(10, 20, 30)`. By default, the\n   * camera points at the origin `(0, 0, 0)`.\n   *\n   * The last three parameters, `upX`, `upY`, and `upZ` are the components of\n   * the \"up\" vector in \"local\" space. The \"up\" vector orients the cameras\n   * y-axis. For example, calling\n   * `myCamera.camera(0, 0, 0, 10, 20, 30, 0, -1, 0)` places the camera at the\n   * origin `(0, 0, 0)`, points it at `(10, 20, 30)`, and sets the \"up\" vector\n   * to `(0, -1, 0)` which is like holding it upside-down. By default, the \"up\"\n   * vector is `(0, 1, 0)`.\n   *\n   * @for p5.Camera\n   * @param  {Number} [x]        x-coordinate of the camera. Defaults to 0.\n   * @param  {Number} [y]        y-coordinate of the camera. Defaults to 0.\n   * @param  {Number} [z]        z-coordinate of the camera. Defaults to 800.\n   * @param  {Number} [centerX]  x-coordinate of the point the camera faces. Defaults to 0.\n   * @param  {Number} [centerY]  y-coordinate of the point the camera faces. Defaults to 0.\n   * @param  {Number} [centerZ]  z-coordinate of the point the camera faces. Defaults to 0.\n   * @param  {Number} [upX]      x-component of the cameras \"up\" vector. Defaults to 0.\n   * @param  {Number} [upY]      x-component of the cameras \"up\" vector. Defaults to 1.\n   * @param  {Number} [upZ]      z-component of the cameras \"up\" vector. Defaults to 0.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let isDefaultCamera = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   cam2 = createCamera();\n   *\n   *   // Place it at the top-right: (1200, -600, 100)\n   *   // Point it at the row of boxes: (-10, -10, 400)\n   *   // Set its \"up\" vector to the default: (0, 1, 0)\n   *   cam2.camera(1200, -600, 100, -10, -10, 400, 0, 1, 0);\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe(\n   *     'A row of white cubes against a gray background. The camera toggles between a frontal and an aerial view when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 500);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -30);\n   *     box(10);\n   *   }\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isDefaultCamera === true) {\n   *     setCamera(cam2);\n   *     isDefaultCamera = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     isDefaultCamera = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let isDefaultCamera = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   cam2 = createCamera();\n   *\n   *   // Place it at the right: (1200, 0, 100)\n   *   // Point it at the row of boxes: (-10, -10, 400)\n   *   // Set its \"up\" vector to the default: (0, 1, 0)\n   *   cam2.camera(1200, 0, 100, -10, -10, 400, 0, 1, 0);\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe(\n   *     'A row of white cubes against a gray background. The camera toggles between a static frontal view and an orbiting view when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Update cam2's position.\n   *   let x = 1200 * cos(frameCount * 0.01);\n   *   let y = -600 * sin(frameCount * 0.01);\n   *   cam2.camera(x, y, 100, -10, -10, 400, 0, 1, 0);\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 500);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -30);\n   *     box(10);\n   *   }\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isDefaultCamera === true) {\n   *     setCamera(cam2);\n   *     isDefaultCamera = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     isDefaultCamera = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  camera(\n    eyeX,\n    eyeY,\n    eyeZ,\n    centerX,\n    centerY,\n    centerZ,\n    upX,\n    upY,\n    upZ\n  ) {\n    if (typeof eyeX === 'undefined') {\n      eyeX = this.defaultEyeX;\n      eyeY = this.defaultEyeY;\n      eyeZ = this.defaultEyeZ;\n      centerX = eyeX;\n      centerY = eyeY;\n      centerZ = 0;\n      upX = 0;\n      upY = 1;\n      upZ = 0;\n    }\n\n    this.eyeX = eyeX;\n    this.eyeY = eyeY;\n    this.eyeZ = eyeZ;\n\n    if (typeof centerX !== 'undefined') {\n      this.centerX = centerX;\n      this.centerY = centerY;\n      this.centerZ = centerZ;\n    }\n\n    if (typeof upX !== 'undefined') {\n      this.upX = upX;\n      this.upY = upY;\n      this.upZ = upZ;\n    }\n\n    const local = this._getLocalAxes();\n\n    // the camera affects the model view matrix, insofar as it\n    // inverse translates the world to the eye position of the camera\n    // and rotates it.\n    /* eslint-disable indent */\n    this.cameraMatrix.set(local.x[0], local.y[0], local.z[0], 0,\n      local.x[1], local.y[1], local.z[1], 0,\n      local.x[2], local.y[2], local.z[2], 0,\n      0, 0, 0, 1);\n    /* eslint-enable indent */\n\n    const tx = -eyeX;\n    const ty = -eyeY;\n    const tz = -eyeZ;\n\n    this.cameraMatrix.translate([tx, ty, tz]);\n\n    if (this._isActive()) {\n      this._renderer.states.setValue('uViewMatrix', this._renderer.states.uViewMatrix.clone());\n      this._renderer.states.uViewMatrix.set(this.cameraMatrix);\n    }\n    return this;\n  }\n\n  /**\n   * Moves the camera along its \"local\" axes without changing its orientation.\n   *\n   * The parameters, `x`, `y`, and `z`, are the distances the camera should\n   * move. For example, calling `myCamera.move(10, 20, 30)` moves the camera 10\n   * pixels to the right, 20 pixels down, and 30 pixels backward in its \"local\"\n   * space.\n   *\n   * @param {Number} x distance to move along the cameras \"local\" x-axis.\n   * @param {Number} y distance to move along the cameras \"local\" y-axis.\n   * @param {Number} z distance to move along the cameras \"local\" z-axis.\n   * @example\n   * <div>\n   * <code>\n   * // Click the canvas to begin detecting key presses.\n   *\n   * let cam;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam = createCamera();\n   *\n   *   // Place the camera at the top-right.\n   *   cam.setPosition(400, -400, 800);\n   *\n   *   // Point it at the origin.\n   *   cam.lookAt(0, 0, 0);\n   *\n   *   // Set the camera.\n   *   setCamera(cam);\n   *\n   *   describe(\n   *     'A white cube drawn against a gray background. The cube appears to move when the user presses certain keys.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Move the camera along its \"local\" axes\n   *   // when the user presses certain keys.\n   *\n   *   // Move horizontally.\n   *   if (keyIsDown(LEFT_ARROW)) {\n   *     cam.move(-1, 0, 0);\n   *   }\n   *   if (keyIsDown(RIGHT_ARROW)) {\n   *     cam.move(1, 0, 0);\n   *   }\n   *\n   *   // Move vertically.\n   *   if (keyIsDown(UP_ARROW)) {\n   *     cam.move(0, -1, 0);\n   *   }\n   *   if (keyIsDown(DOWN_ARROW)) {\n   *     cam.move(0, 1, 0);\n   *   }\n   *\n   *   // Move in/out of the screen.\n   *   if (keyIsDown('i')) {\n   *     cam.move(0, 0, -1);\n   *   }\n   *   if (keyIsDown('o')) {\n   *     cam.move(0, 0, 1);\n   *   }\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  move(x, y, z) {\n    const local = this._getLocalAxes();\n\n    // scale local axes by movement amounts\n    // based on http://learnwebgl.brown37.net/07_cameras/camera_linear_motion.html\n    const dx = [local.x[0] * x, local.x[1] * x, local.x[2] * x];\n    const dy = [local.y[0] * y, local.y[1] * y, local.y[2] * y];\n    const dz = [local.z[0] * z, local.z[1] * z, local.z[2] * z];\n\n    this.camera(\n      this.eyeX + dx[0] + dy[0] + dz[0],\n      this.eyeY + dx[1] + dy[1] + dz[1],\n      this.eyeZ + dx[2] + dy[2] + dz[2],\n      this.centerX + dx[0] + dy[0] + dz[0],\n      this.centerY + dx[1] + dy[1] + dz[1],\n      this.centerZ + dx[2] + dy[2] + dz[2],\n      this.upX,\n      this.upY,\n      this.upZ\n    );\n  }\n\n  /**\n   * Sets the cameras position in \"world\" space without changing its\n   * orientation.\n   *\n   * The parameters, `x`, `y`, and `z`, are the coordinates where the camera\n   * should be placed. For example, calling `myCamera.setPosition(10, 20, 30)`\n   * places the camera at coordinates `(10, 20, 30)` in \"world\" space.\n   *\n   * @param {Number} x x-coordinate in \"world\" space.\n   * @param {Number} y y-coordinate in \"world\" space.\n   * @param {Number} z z-coordinate in \"world\" space.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let isDefaultCamera = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   cam2 = createCamera();\n   *\n   *   // Place it closer to the origin.\n   *   cam2.setPosition(0, 0, 600);\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe(\n   *     'A row of white cubes against a gray background. The camera toggles the amount of zoom when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 500);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -30);\n   *     box(10);\n   *   }\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isDefaultCamera === true) {\n   *     setCamera(cam2);\n   *     isDefaultCamera = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     isDefaultCamera = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let isDefaultCamera = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   cam2 = createCamera();\n   *\n   *   // Place it closer to the origin.\n   *   cam2.setPosition(0, 0, 600);\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe(\n   *     'A row of white cubes against a gray background. The camera toggles between a static view and a view that zooms in and out when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Update cam2's z-coordinate.\n   *   let z = 100 * sin(frameCount * 0.01) + 700;\n   *   cam2.setPosition(0, 0, z);\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 500);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -30);\n   *     box(10);\n   *   }\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isDefaultCamera === true) {\n   *     setCamera(cam2);\n   *     isDefaultCamera = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     isDefaultCamera = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  setPosition(x, y, z) {\n    const diffX = x - this.eyeX;\n    const diffY = y - this.eyeY;\n    const diffZ = z - this.eyeZ;\n\n    this.camera(\n      x,\n      y,\n      z,\n      this.centerX + diffX,\n      this.centerY + diffY,\n      this.centerZ + diffZ,\n      this.upX,\n      this.upY,\n      this.upZ\n    );\n  }\n\n  /**\n   * Sets the cameras position, orientation, and projection by copying another\n   * camera.\n   *\n   * The parameter, `cam`, is the `p5.Camera` object to copy. For example, calling\n   * `cam2.set(cam1)` will set `cam2` using `cam1`s configuration.\n   *\n   * @param {p5.Camera} cam camera to copy.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to \"reset\" the camera zoom.\n   *\n   * let cam1;\n   * let cam2;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   cam1 = createCamera();\n   *\n   *   // Place the camera at the top-right.\n   *   cam1.setPosition(400, -400, 800);\n   *\n   *   // Point it at the origin.\n   *   cam1.lookAt(0, 0, 0);\n   *\n   *   // Create the second camera.\n   *   cam2 = createCamera();\n   *\n   *   // Copy cam1's configuration.\n   *   cam2.set(cam1);\n   *\n   *   // Set the camera.\n   *   setCamera(cam2);\n   *\n   *   describe(\n   *     'A white cube drawn against a gray background. The camera slowly moves forward. The camera resets when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Update cam2's position.\n   *   cam2.move(0, 0, -1);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   *\n   * // \"Reset\" the camera when the user double-clicks.\n   * function doubleClicked() {\n   *   cam2.set(cam1);\n   * }\n   */\n  set(cam) {\n    const keyNamesOfThePropToCopy = [\n      'eyeX', 'eyeY', 'eyeZ',\n      'centerX', 'centerY', 'centerZ',\n      'upX', 'upY', 'upZ',\n      'cameraFOV', 'aspectRatio', 'cameraNear', 'cameraFar', 'cameraType',\n      'yScale', 'useLinePerspective'\n    ];\n    for (const keyName of keyNamesOfThePropToCopy) {\n      this[keyName] = cam[keyName];\n    }\n\n    this.cameraMatrix = cam.cameraMatrix.copy();\n    this.projMatrix = cam.projMatrix.copy();\n\n    if (this._isActive()) {\n      this._renderer.states.setValue('uModelMatrix', this._renderer.states.uModelMatrix.clone());\n      this._renderer.states.setValue('uViewMatrix', this._renderer.states.uViewMatrix.clone());\n      this._renderer.states.setValue('uPMatrix', this._renderer.states.uPMatrix.clone());\n      this._renderer.states.uModelMatrix.reset();\n      this._renderer.states.uViewMatrix.set(this.cameraMatrix);\n      this._renderer.states.uPMatrix.set(this.projMatrix);\n    }\n  }\n  /**\n   * Sets the cameras position and orientation to values that are in-between\n   * those of two other cameras.\n   *\n   * `myCamera.slerp()` uses spherical linear interpolation to calculate a\n   * position and orientation thats in-between two other cameras. Doing so is\n   * helpful for transitioning smoothly between two perspectives.\n   *\n   * The first two parameters, `cam0` and `cam1`, are the `p5.Camera` objects\n   * that should be used to set the current camera.\n   *\n   * The third parameter, `amt`, is the amount to interpolate between `cam0` and\n   * `cam1`. 0.0 keeps the cameras position and orientation equal to `cam0`s,\n   * 0.5 sets them halfway between `cam0`s and `cam1`s , and 1.0 sets the\n   * position and orientation equal to `cam1`s.\n   *\n   * For example, calling `myCamera.slerp(cam0, cam1, 0.1)` sets cams position\n   * and orientation very close to `cam0`s. Calling\n   * `myCamera.slerp(cam0, cam1, 0.9)` sets cams position and orientation very\n   * close to `cam1`s.\n   *\n   * Note: All of the cameras must use the same projection.\n   *\n   * @param {p5.Camera} cam0 first camera.\n   * @param {p5.Camera} cam1 second camera.\n   * @param {Number} amt amount of interpolation between 0.0 (`cam0`) and 1.0 (`cam1`).\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let cam0;\n   * let cam1;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the main camera.\n   *   // Keep its default settings.\n   *   cam = createCamera();\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam0 = createCamera();\n   *\n   *   // Create the second camera.\n   *   cam1 = createCamera();\n   *\n   *   // Place it at the top-right.\n   *   cam1.setPosition(400, -400, 800);\n   *\n   *   // Point it at the origin.\n   *   cam1.lookAt(0, 0, 0);\n   *\n   *   // Set the current camera to cam.\n   *   setCamera(cam);\n   *\n   *   describe('A white cube drawn against a gray background. The camera slowly oscillates between a frontal view and an aerial view.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the amount to interpolate between cam0 and cam1.\n   *   let amt = 0.5 * sin(frameCount * 0.01) + 0.5;\n   *\n   *   // Update the main camera's position and orientation.\n   *   cam.slerp(cam0, cam1, amt);\n   *\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  slerp(cam0, cam1, amt) {\n    // If t is 0 or 1, do not interpolate and set the argument camera.\n    if (amt === 0) {\n      this.set(cam0);\n      return;\n    } else if (amt === 1) {\n      this.set(cam1);\n      return;\n    }\n\n    // For this cameras is ortho, assume that cam0 and cam1 are also ortho\n    // and interpolate the elements of the projection matrix.\n    // Use logarithmic interpolation for interpolation.\n    if (this.projMatrix.mat4[15] !== 0) {\n        this.projMatrix.setElement(\n          0,\n          cam0.projMatrix.mat4[0] *\n            Math.pow(cam1.projMatrix.mat4[0] / cam0.projMatrix.mat4[0], amt)\n        );\n        this.projMatrix.setElement(\n          5,\n          cam0.projMatrix.mat4[5] *\n            Math.pow(cam1.projMatrix.mat4[5] / cam0.projMatrix.mat4[5], amt)\n        );\n      // If the camera is active, make uPMatrix reflect changes in projMatrix.\n      if (this._isActive()) {\n        this._renderer.states.setValue('uPMatrix', this._renderer.states.uPMatrix.clone());\n        this._renderer.states.uPMatrix.mat4 = this.projMatrix.mat4.slice();\n      }\n    }\n\n    // prepare eye vector and center vector of argument cameras.\n    const eye0 = new Vector(cam0.eyeX, cam0.eyeY, cam0.eyeZ);\n    const eye1 = new Vector(cam1.eyeX, cam1.eyeY, cam1.eyeZ);\n    const center0 = new Vector(cam0.centerX, cam0.centerY, cam0.centerZ);\n    const center1 = new Vector(cam1.centerX, cam1.centerY, cam1.centerZ);\n\n    // Calculate the distance between eye and center for each camera.\n    // Logarithmically interpolate these with amt.\n    const dist0 = Vector.dist(eye0, center0);\n    const dist1 = Vector.dist(eye1, center1);\n    const lerpedDist = dist0 * Math.pow(dist1 / dist0, amt);\n\n    // Next, calculate the ratio to interpolate the eye and center by a constant\n    // ratio for each camera. This ratio is the same for both. Also, with this ratio\n    // of points, the distance is the minimum distance of the two points of\n    // the same ratio.\n    // With this method, if the viewpoint is fixed, linear interpolation is performed\n    // at the viewpoint, and if the center is fixed, linear interpolation is performed\n    // at the center, resulting in reasonable interpolation. If both move, the point\n    // halfway between them is taken.\n    const eyeDiff = Vector.sub(eye0, eye1);\n    const diffDiff = eye0.copy().sub(eye1).sub(center0).add(center1);\n    // Suppose there are two line segments. Consider the distance between the points\n    // above them as if they were taken in the same ratio. This calculation figures out\n    // a ratio that minimizes this.\n    // Each line segment is, a line segment connecting the viewpoint and the center\n    // for each camera.\n    const divider = diffDiff.magSq();\n    let ratio = 1; // default.\n    if (divider > 0.000001) {\n      ratio = Vector.dot(eyeDiff, diffDiff) / divider;\n      ratio = Math.max(0, Math.min(ratio, 1));\n    }\n\n    // Take the appropriate proportions and work out the points\n    // that are between the new viewpoint and the new center position.\n    const lerpedMedium = Vector.lerp(\n      Vector.lerp(eye0, center0, ratio),\n      Vector.lerp(eye1, center1, ratio),\n      amt\n    );\n\n    // Prepare each of rotation matrix from their camera matrix\n    const rotMat0 = cam0.cameraMatrix.createSubMatrix3x3();\n    const rotMat1 = cam1.cameraMatrix.createSubMatrix3x3();\n\n    // get front and up vector from local-coordinate-system.\n    const front0 = rotMat0.row(2);\n    const front1 = rotMat1.row(2);\n    const up0 = rotMat0.row(1);\n    const up1 = rotMat1.row(1);\n\n    // prepare new vectors.\n    const newFront = new Vector();\n    const newUp = new Vector();\n    const newEye = new Vector();\n    const newCenter = new Vector();\n\n    // Create the inverse matrix of mat0 by transposing mat0,\n    // and multiply it to mat1 from the right.\n    // This matrix represents the difference between the two.\n    // 'deltaRot' means 'difference of rotation matrices'.\n    const deltaRot = rotMat1.mult(rotMat0.copy().transpose()); // mat1 is 3x3\n\n    // Calculate the trace and from it the cos value of the angle.\n    // An orthogonal matrix is just an orthonormal basis. If this is not the identity\n    // matrix, it is a centered orthonormal basis plus some angle of rotation about\n    // some axis. That's the angle. Letting this be theta, trace becomes 1+2cos(theta).\n    // reference: https://en.wikipedia.org/wiki/Rotation_matrix#Determining_the_angle\n    const diag = deltaRot.diagonal();\n    let cosTheta = 0.5 * (diag[0] + diag[1] + diag[2] - 1);\n\n    // If the angle is close to 0, the two matrices are very close,\n    // so in that case we execute linearly interpolate.\n    if (1 - cosTheta < 0.0000001) {\n      // Obtain the front vector and up vector by linear interpolation\n      // and normalize them.\n      // calculate newEye, newCenter with newFront vector.\n      newFront.set(Vector.lerp(front0, front1, amt)).normalize();\n\n      newEye.set(newFront).mult(ratio * lerpedDist).add(lerpedMedium);\n      newCenter.set(newFront).mult((ratio - 1) * lerpedDist).add(lerpedMedium);\n\n      newUp.set(Vector.lerp(up0, up1, amt)).normalize();\n\n      // set the camera\n      this.camera(\n        newEye.x, newEye.y, newEye.z,\n        newCenter.x, newCenter.y, newCenter.z,\n        newUp.x, newUp.y, newUp.z\n      );\n      return;\n    }\n\n    // Calculates the axis vector and the angle of the difference orthogonal matrix.\n    // The axis vector is what I explained earlier in the comments.\n    // similar calculation is here:\n    // https://github.com/mrdoob/three.js/blob/883249620049d1632e8791732808fefd1a98c871/src/math/Quaternion.js#L294\n    let a, b, c, sinTheta;\n    let invOneMinusCosTheta = 1 / (1 - cosTheta);\n    const maxDiag = Math.max(diag[0], diag[1], diag[2]);\n    const offDiagSum13 = deltaRot.mat3[1] + deltaRot.mat3[3];\n    const offDiagSum26 = deltaRot.mat3[2] + deltaRot.mat3[6];\n    const offDiagSum57 = deltaRot.mat3[5] + deltaRot.mat3[7];\n\n    if (maxDiag === diag[0]) {\n      a = Math.sqrt((diag[0] - cosTheta) * invOneMinusCosTheta); // not zero.\n      invOneMinusCosTheta /= a;\n      b = 0.5 * offDiagSum13 * invOneMinusCosTheta;\n      c = 0.5 * offDiagSum26 * invOneMinusCosTheta;\n      sinTheta = 0.5 * (deltaRot.mat3[7] - deltaRot.mat3[5]) / a;\n\n    } else if (maxDiag === diag[1]) {\n      b = Math.sqrt((diag[1] - cosTheta) * invOneMinusCosTheta); // not zero.\n      invOneMinusCosTheta /= b;\n      c = 0.5 * offDiagSum57 * invOneMinusCosTheta;\n      a = 0.5 * offDiagSum13 * invOneMinusCosTheta;\n      sinTheta = 0.5 * (deltaRot.mat3[2] - deltaRot.mat3[6]) / b;\n\n    } else {\n      c = Math.sqrt((diag[2] - cosTheta) * invOneMinusCosTheta); // not zero.\n      invOneMinusCosTheta /= c;\n      a = 0.5 * offDiagSum26 * invOneMinusCosTheta;\n      b = 0.5 * offDiagSum57 * invOneMinusCosTheta;\n      sinTheta = 0.5 * (deltaRot.mat3[3] - deltaRot.mat3[1]) / c;\n    }\n\n    // Constructs a new matrix after interpolating the angles.\n    // Multiplying mat0 by the first matrix yields mat1, but by creating a state\n    // in the middle of that matrix, you can obtain a matrix that is\n    // an intermediate state between mat0 and mat1.\n    const angle = amt * Math.atan2(sinTheta, cosTheta);\n    const cosAngle = Math.cos(angle);\n    const sinAngle = Math.sin(angle);\n    const oneMinusCosAngle = 1 - cosAngle;\n    const ab = a * b;\n    const bc = b * c;\n    const ca = c * a;\n    // 3x3\n    const lerpedRotMat = new Matrix( [\n      cosAngle + oneMinusCosAngle * a * a,\n      oneMinusCosAngle * ab + sinAngle * c,\n      oneMinusCosAngle * ca - sinAngle * b,\n      oneMinusCosAngle * ab - sinAngle * c,\n      cosAngle + oneMinusCosAngle * b * b,\n      oneMinusCosAngle * bc + sinAngle * a,\n      oneMinusCosAngle * ca + sinAngle * b,\n      oneMinusCosAngle * bc - sinAngle * a,\n      cosAngle + oneMinusCosAngle * c * c\n    ]);\n\n    // Multiply this to mat0 from left to get the interpolated front vector.\n    // calculate newEye, newCenter with newFront vector.\n    lerpedRotMat.multiplyVec(front0, newFront); // this is vec3\n\n    newEye.set(newFront).mult(ratio * lerpedDist).add(lerpedMedium);\n    newCenter.set(newFront).mult((ratio - 1) * lerpedDist).add(lerpedMedium);\n\n    lerpedRotMat.multiplyVec(up0, newUp); // this is vec3\n\n    // We also get the up vector in the same way and set the camera.\n    // The eye position and center position are calculated based on the front vector.\n    this.camera(\n      newEye.x, newEye.y, newEye.z,\n      newCenter.x, newCenter.y, newCenter.z,\n      newUp.x, newUp.y, newUp.z\n    );\n  }\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Camera Helper Methods\n  ////////////////////////////////////////////////////////////////////////////////\n\n  // @TODO: combine this function with _setDefaultCamera to compute these values\n  // as-needed\n  _computeCameraDefaultSettings() {\n    this.defaultAspectRatio = this._renderer.width / this._renderer.height;\n    this.defaultEyeX = 0;\n    this.defaultEyeY = 0;\n    this.defaultEyeZ = 800;\n    this.defaultCameraFOV =\n      2 * Math.atan(this._renderer.height / 2 / this.defaultEyeZ);\n    this.defaultCenterX = 0;\n    this.defaultCenterY = 0;\n    this.defaultCenterZ = 0;\n    this.defaultCameraNear = this.defaultEyeZ * 0.1;\n    this.defaultCameraFar = this.defaultEyeZ * 10;\n  }\n\n  //detect if user didn't set the camera\n  //then call this function below\n  _setDefaultCamera() {\n    this.cameraFOV = this.defaultCameraFOV;\n    this.aspectRatio = this.defaultAspectRatio;\n    this.eyeX = this.defaultEyeX;\n    this.eyeY = this.defaultEyeY;\n    this.eyeZ = this.defaultEyeZ;\n    this.centerX = this.defaultCenterX;\n    this.centerY = this.defaultCenterY;\n    this.centerZ = this.defaultCenterZ;\n    this.upX = 0;\n    this.upY = 1;\n    this.upZ = 0;\n    this.cameraNear = this.defaultCameraNear;\n    this.cameraFar = this.defaultCameraFar;\n\n    this.perspective();\n    this.camera();\n\n    this.cameraType = 'default';\n  }\n\n  _resize() {\n    // If we're using the default camera, update the aspect ratio\n    if (this.cameraType === 'default') {\n      this._computeCameraDefaultSettings();\n      this.cameraFOV = this.defaultCameraFOV;\n      this.aspectRatio = this.defaultAspectRatio;\n      this.perspective();\n    }\n  }\n\n  /**\n   * Returns a copy of a camera.\n   * @private\n   */\n  copy() {\n    const _cam = new Camera(this._renderer);\n    _cam.cameraFOV = this.cameraFOV;\n    _cam.aspectRatio = this.aspectRatio;\n    _cam.eyeX = this.eyeX;\n    _cam.eyeY = this.eyeY;\n    _cam.eyeZ = this.eyeZ;\n    _cam.centerX = this.centerX;\n    _cam.centerY = this.centerY;\n    _cam.centerZ = this.centerZ;\n    _cam.upX = this.upX;\n    _cam.upY = this.upY;\n    _cam.upZ = this.upZ;\n    _cam.cameraNear = this.cameraNear;\n    _cam.cameraFar = this.cameraFar;\n\n    _cam.cameraType = this.cameraType;\n    _cam.useLinePerspective = this.useLinePerspective;\n\n    _cam.cameraMatrix = this.cameraMatrix.copy();\n    _cam.projMatrix = this.projMatrix.copy();\n    _cam.yScale = this.yScale;\n\n    return _cam;\n  }\n\n  clone() {\n    return this.copy();\n  }\n\n  /**\n   * Returns a camera's local axes: left-right, up-down, and forward-backward,\n   * as defined by vectors in world-space.\n   * @private\n   */\n  _getLocalAxes() {\n    // calculate camera local Z vector\n    let z0 = this.eyeX - this.centerX;\n    let z1 = this.eyeY - this.centerY;\n    let z2 = this.eyeZ - this.centerZ;\n\n    // normalize camera local Z vector\n    const eyeDist = Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n    if (eyeDist !== 0) {\n      z0 /= eyeDist;\n      z1 /= eyeDist;\n      z2 /= eyeDist;\n    }\n\n    // calculate camera Y vector\n    let y0 = this.upX;\n    let y1 = this.upY;\n    let y2 = this.upZ;\n\n    // compute camera local X vector as up vector (local Y) cross local Z\n    let x0 = y1 * z2 - y2 * z1;\n    let x1 = -y0 * z2 + y2 * z0;\n    let x2 = y0 * z1 - y1 * z0;\n\n    // recompute y = z cross x\n    y0 = z1 * x2 - z2 * x1;\n    y1 = -z0 * x2 + z2 * x0;\n    y2 = z0 * x1 - z1 * x0;\n\n    // cross product gives area of parallelogram, which is < 1.0 for\n    // non-perpendicular unit-length vectors; so normalize x, y here:\n    const xmag = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n    if (xmag !== 0) {\n      x0 /= xmag;\n      x1 /= xmag;\n      x2 /= xmag;\n    }\n\n    const ymag = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n    if (ymag !== 0) {\n      y0 /= ymag;\n      y1 /= ymag;\n      y2 /= ymag;\n    }\n\n    return {\n      x: [x0, x1, x2],\n      y: [y0, y1, y2],\n      z: [z0, z1, z2]\n    };\n  }\n\n  /**\n   * Orbits the camera about center point. For use with orbitControl().\n   * @private\n   * @param {Number} dTheta change in spherical coordinate theta\n   * @param {Number} dPhi change in spherical coordinate phi\n   * @param {Number} dRadius change in radius\n   */\n  _orbit(dTheta, dPhi, dRadius) {\n    // Calculate the vector and its magnitude from the center to the viewpoint\n    const diffX = this.eyeX - this.centerX;\n    const diffY = this.eyeY - this.centerY;\n    const diffZ = this.eyeZ - this.centerZ;\n    let camRadius = Math.hypot(diffX, diffY, diffZ);\n    // front vector. unit vector from center to eye.\n    const front = new Vector(diffX, diffY, diffZ).normalize();\n    // up vector. normalized camera's up vector.\n    const up = new Vector(this.upX, this.upY, this.upZ).normalize(); // y-axis\n    // side vector. Right when viewed from the front\n    const side = Vector.cross(up, front).normalize(); // x-axis\n    // vertical vector. normalized vector of projection of front vector.\n    const vertical = Vector.cross(side, up); // z-axis\n\n    // update camRadius\n    camRadius *= Math.pow(10, dRadius);\n    // prevent zooming through the center:\n    if (camRadius < this.cameraNear) {\n      camRadius = this.cameraNear;\n    }\n    if (camRadius > this.cameraFar) {\n      camRadius = this.cameraFar;\n    }\n\n    // calculate updated camera angle\n    // Find the angle between the \"up\" and the \"front\", add dPhi to that.\n    // angleBetween() may return negative value. Since this specification is subject to change\n    // due to version updates, it cannot be adopted, so here we calculate using a method\n    // that directly obtains the absolute value.\n    const camPhi =\n      Math.acos(Math.max(-1, Math.min(1, Vector.dot(front, up)))) + dPhi;\n    // Rotate by dTheta in the shortest direction from \"vertical\" to \"side\"\n    const camTheta = dTheta;\n\n    // Invert camera's upX, upY, upZ if dPhi is below 0 or above PI\n    if (camPhi <= 0 || camPhi >= Math.PI) {\n      this.upX *= -1;\n      this.upY *= -1;\n      this.upZ *= -1;\n    }\n\n    // update eye vector by calculate new front vector\n    up.mult(Math.cos(camPhi));\n    vertical.mult(Math.cos(camTheta) * Math.sin(camPhi));\n    side.mult(Math.sin(camTheta) * Math.sin(camPhi));\n\n    front.set(up).add(vertical).add(side);\n\n    this.eyeX = camRadius * front.x + this.centerX;\n    this.eyeY = camRadius * front.y + this.centerY;\n    this.eyeZ = camRadius * front.z + this.centerZ;\n\n    // update camera\n    this.camera(\n      this.eyeX, this.eyeY, this.eyeZ,\n      this.centerX, this.centerY, this.centerZ,\n      this.upX, this.upY, this.upZ\n    );\n  }\n\n  /**\n   * Orbits the camera about center point. For use with orbitControl().\n   * Unlike _orbit(), the direction of rotation always matches the direction of pointer movement.\n   * @private\n   * @param {Number} dx the x component of the rotation vector.\n   * @param {Number} dy the y component of the rotation vector.\n   * @param {Number} dRadius change in radius\n   */\n  _orbitFree(dx, dy, dRadius) {\n    // Calculate the vector and its magnitude from the center to the viewpoint\n    const diffX = this.eyeX - this.centerX;\n    const diffY = this.eyeY - this.centerY;\n    const diffZ = this.eyeZ - this.centerZ;\n    let camRadius = Math.hypot(diffX, diffY, diffZ);\n    // front vector. unit vector from center to eye.\n    const front = new Vector(diffX, diffY, diffZ).normalize();\n    // up vector. camera's up vector.\n    const up = new Vector(this.upX, this.upY, this.upZ);\n    // side vector. Right when viewed from the front. (like x-axis)\n    const side = Vector.cross(up, front).normalize();\n    // down vector. Bottom when viewed from the front. (like y-axis)\n    const down = Vector.cross(front, side);\n\n    // side vector and down vector are no longer used as-is.\n    // Create a vector representing the direction of rotation\n    // in the form cos(direction)*side + sin(direction)*down.\n    // Make the current side vector into this.\n    const directionAngle = Math.atan2(dy, dx);\n    down.mult(Math.sin(directionAngle));\n    side.mult(Math.cos(directionAngle)).add(down);\n    // The amount of rotation is the size of the vector (dx, dy).\n    const rotAngle = Math.sqrt(dx * dx + dy * dy);\n    // The vector that is orthogonal to both the front vector and\n    // the rotation direction vector is the rotation axis vector.\n    const axis = Vector.cross(front, side);\n\n    // update camRadius\n    camRadius *= Math.pow(10, dRadius);\n    // prevent zooming through the center:\n    if (camRadius < this.cameraNear) {\n      camRadius = this.cameraNear;\n    }\n    if (camRadius > this.cameraFar) {\n      camRadius = this.cameraFar;\n    }\n\n    // If the axis vector is likened to the z-axis, the front vector is\n    // the x-axis and the side vector is the y-axis. Rotate the up and front\n    // vectors respectively by thinking of them as rotations around the z-axis.\n\n    // Calculate the components by taking the dot product and\n    // calculate a rotation based on that.\n    const c = Math.cos(rotAngle);\n    const s = Math.sin(rotAngle);\n    const dotFront = up.dot(front);\n    const dotSide = up.dot(side);\n    const ux = dotFront * c + dotSide * s;\n    const uy = -dotFront * s + dotSide * c;\n    const uz = up.dot(axis);\n    up.x = ux * front.x + uy * side.x + uz * axis.x;\n    up.y = ux * front.y + uy * side.y + uz * axis.y;\n    up.z = ux * front.z + uy * side.z + uz * axis.z;\n    // We won't be using the side vector and the front vector anymore,\n    // so let's make the front vector into the vector from the center to the new eye.\n    side.mult(-s);\n    front.mult(c).add(side).mult(camRadius);\n\n    // it's complete. let's update camera.\n    this.camera(\n      front.x + this.centerX,\n      front.y + this.centerY,\n      front.z + this.centerZ,\n      this.centerX, this.centerY, this.centerZ,\n      up.x, up.y, up.z\n    );\n  }\n\n  /**\n   * Returns true if camera is currently attached to renderer.\n   * @private\n   */\n  _isActive() {\n    return this === this._renderer.states.curCamera;\n  }\n}\nfunction camera(p5, fn){\n  ////////////////////////////////////////////////////////////////////////////////\n  // p5.Prototype Methods\n  ////////////////////////////////////////////////////////////////////////////////\n\n  /**\n   * Sets the position and orientation of the current camera in a 3D sketch.\n   *\n   * `camera()` allows objects to be viewed from different angles. It has nine\n   * parameters that are all optional.\n   *\n   * The first three parameters, `x`, `y`, and `z`, are the coordinates of the\n   * cameras position. For example, calling `camera(0, 0, 0)` places the camera\n   * at the origin `(0, 0, 0)`. By default, the camera is placed at\n   * `(0, 0, 800)`.\n   *\n   * The next three parameters, `centerX`, `centerY`, and `centerZ` are the\n   * coordinates of the point where the camera faces. For example, calling\n   * `camera(0, 0, 0, 10, 20, 30)` places the camera at the origin `(0, 0, 0)`\n   * and points it at `(10, 20, 30)`. By default, the camera points at the\n   * origin `(0, 0, 0)`.\n   *\n   * The last three parameters, `upX`, `upY`, and `upZ` are the components of\n   * the \"up\" vector. The \"up\" vector orients the cameras y-axis. For example,\n   * calling `camera(0, 0, 0, 10, 20, 30, 0, -1, 0)` places the camera at the\n   * origin `(0, 0, 0)`, points it at `(10, 20, 30)`, and sets the \"up\" vector\n   * to `(0, -1, 0)` which is like holding it upside-down. By default, the \"up\"\n   * vector is `(0, 1, 0)`.\n   *\n   * Note: `camera()` can only be used in WebGL mode.\n   *\n   * @method camera\n   * @for p5\n   * @param  {Number} [x]        x-coordinate of the camera. Defaults to 0.\n   * @param  {Number} [y]        y-coordinate of the camera. Defaults to 0.\n   * @param  {Number} [z]        z-coordinate of the camera. Defaults to 800.\n   * @param  {Number} [centerX]  x-coordinate of the point the camera faces. Defaults to 0.\n   * @param  {Number} [centerY]  y-coordinate of the point the camera faces. Defaults to 0.\n   * @param  {Number} [centerZ]  z-coordinate of the point the camera faces. Defaults to 0.\n   * @param  {Number} [upX]      x-component of the cameras \"up\" vector. Defaults to 0.\n   * @param  {Number} [upY]      y-component of the cameras \"up\" vector. Defaults to 1.\n   * @param  {Number} [upZ]      z-component of the cameras \"up\" vector. Defaults to 0.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Move the camera to the top-right.\n   *   camera(200, -400, 800);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube apperas to sway left and right on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the camera's x-coordinate.\n   *   let x = 400 * cos(frameCount * 0.01);\n   *\n   *   // Orbit the camera around the box.\n   *   camera(x, -400, 800);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Adjust the range sliders to change the camera's position.\n   *\n   * let xSlider;\n   * let ySlider;\n   * let zSlider;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create slider objects to set the camera's coordinates.\n   *   xSlider = createSlider(-400, 400, 400);\n   *   xSlider.position(0, 100);\n   *   xSlider.size(100);\n   *   ySlider = createSlider(-400, 400, -200);\n   *   ySlider.position(0, 120);\n   *   ySlider.size(100);\n   *   zSlider = createSlider(0, 1600, 800);\n   *   zSlider.position(0, 140);\n   *   zSlider.size(100);\n   *\n   *   describe(\n   *     'A white cube drawn against a gray background. Three range sliders appear beneath the image. The camera position changes when the user moves the sliders.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Get the camera's coordinates from the sliders.\n   *   let x = xSlider.value();\n   *   let y = ySlider.value();\n   *   let z = zSlider.value();\n   *\n   *   // Move the camera.\n   *   camera(x, y, z);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.camera = function (...args) {\n    this._assert3d('camera');\n    // p5._validateParameters('camera', args);\n    this._renderer.camera(...args);\n    return this;\n  };\n\n  /**\n   * Sets a perspective projection for the current camera in a 3D sketch.\n   *\n   * In a perspective projection, shapes that are further from the camera appear\n   * smaller than shapes that are near the camera. This technique, called\n   * foreshortening, creates realistic 3D scenes. Its applied by default in\n   * WebGL mode.\n   *\n   * `perspective()` changes the cameras perspective by changing its viewing\n   * frustum. The frustum is the volume of space thats visible to the camera.\n   * Its shape is a pyramid with its top cut off. The camera is placed where\n   * the top of the pyramid should be and views everything between the frustums\n   * top (near) plane and its bottom (far) plane.\n   *\n   * The first parameter, `fovy`, is the cameras vertical field of view. Its\n   * an angle that describes how tall or narrow a view the camera has. For\n   * example, calling `perspective(0.5)` sets the cameras vertical field of\n   * view to 0.5 radians. By default, `fovy` is calculated based on the sketchs\n   * height and the cameras default z-coordinate, which is 800. The formula for\n   * the default `fovy` is `2 * atan(height / 2 / 800)`.\n   *\n   * The second parameter, `aspect`, is the cameras aspect ratio. Its a number\n   * that describes the ratio of the top planes width to its height. For\n   * example, calling `perspective(0.5, 1.5)` sets the cameras field of view to\n   * 0.5 radians and aspect ratio to 1.5, which would make shapes appear thinner\n   * on a square canvas. By default, aspect is set to `width / height`.\n   *\n   * The third parameter, `near`, is the distance from the camera to the near\n   * plane. For example, calling `perspective(0.5, 1.5, 100)` sets the cameras\n   * field of view to 0.5 radians, its aspect ratio to 1.5, and places the near\n   * plane 100 pixels from the camera. Any shapes drawn less than 100 pixels\n   * from the camera wont be visible. By default, near is set to `0.1 * 800`,\n   * which is 1/10th the default distance between the camera and the origin.\n   *\n   * The fourth parameter, `far`, is the distance from the camera to the far\n   * plane. For example, calling `perspective(0.5, 1.5, 100, 10000)` sets the\n   * cameras field of view to 0.5 radians, its aspect ratio to 1.5, places the\n   * near plane 100 pixels from the camera, and places the far plane 10,000\n   * pixels from the camera. Any shapes drawn more than 10,000 pixels from the\n   * camera wont be visible. By default, far is set to `10 * 800`, which is 10\n   * times the default distance between the camera and the origin.\n   *\n   * Note: `perspective()` can only be used in WebGL mode.\n   *\n   * @method  perspective\n   * @for p5\n   * @param  {Number} [fovy]   camera frustum vertical field of view. Defaults to\n   *                           `2 * atan(height / 2 / 800)`.\n   * @param  {Number} [aspect] camera frustum aspect ratio. Defaults to\n   *                           `width / height`.\n   * @param  {Number} [near]   distance from the camera to the near clipping plane.\n   *                           Defaults to `0.1 * 800`.\n   * @param  {Number} [far]    distance from the camera to the far clipping plane.\n   *                           Defaults to `10 * 800`.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to squeeze the box.\n   *\n   * let isSqueezed = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white rectangular prism on a gray background. The box appears to become thinner when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Place the camera at the top-right.\n   *   camera(400, -400, 800);\n   *\n   *   if (isSqueezed === true) {\n   *     // Set fovy to 0.2.\n   *     // Set aspect to 1.5.\n   *     perspective(0.2, 1.5);\n   *   }\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   *\n   * // Change the camera's perspective when the user double-clicks.\n   * function doubleClicked() {\n   *   isSqueezed = true;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white rectangular prism on a gray background. The prism moves away from the camera until it disappears.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Place the camera at the top-right.\n   *   camera(400, -400, 800);\n   *\n   *   // Set fovy to 0.2.\n   *   // Set aspect to 1.5.\n   *   // Set near to 600.\n   *   // Set far to 1200.\n   *   perspective(0.2, 1.5, 600, 1200);\n   *\n   *   // Move the origin away from the camera.\n   *   let x = -frameCount;\n   *   let y = frameCount;\n   *   let z = -2 * frameCount;\n   *   translate(x, y, z);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.perspective = function (...args) {\n    this._assert3d('perspective');\n    // p5._validateParameters('perspective', args);\n    this._renderer.perspective(...args);\n    return this;\n  };\n\n\n  /**\n   * Enables or disables perspective for lines in 3D sketches.\n   *\n   * In WebGL mode, lines can be drawn with a thinner stroke when theyre\n   * further from the camera. Doing so gives them a more realistic appearance.\n   *\n   * By default, lines are drawn differently based on the type of perspective\n   * being used:\n   * - `perspective()` and `frustum()` simulate a realistic perspective. In\n   * these modes, stroke weight is affected by the lines distance from the\n   * camera. Doing so results in a more natural appearance. `perspective()` is\n   * the default mode for 3D sketches.\n   * - `ortho()` doesnt simulate a realistic perspective. In this mode, stroke\n   * weights are consistent regardless of the lines distance from the camera.\n   * Doing so results in a more predictable and consistent appearance.\n   *\n   * `linePerspective()` can override the default line drawing mode.\n   *\n   * The parameter, `enable`, is optional. Its a `Boolean` value that sets the\n   * way lines are drawn. If `true` is passed, as in `linePerspective(true)`,\n   * then lines will appear thinner when they are further from the camera. If\n   * `false` is passed, as in `linePerspective(false)`, then lines will have\n   * consistent stroke weights regardless of their distance from the camera. By\n   * default, `linePerspective()` is enabled.\n   *\n   * Calling `linePerspective()` without passing an argument returns `true` if\n   * it's enabled and `false` if not.\n   *\n   * Note: `linePerspective()` can only be used in WebGL mode.\n   *\n   * @method linePerspective\n   * @for p5\n   * @param {Boolean} enable whether to enable line perspective.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click the canvas to toggle the line perspective.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'A white cube with black edges on a gray background. Its edges toggle between thick and thin when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 600);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -40);\n   *     box(10);\n   *   }\n   * }\n   *\n   * // Toggle the line perspective when the user double-clicks.\n   * function doubleClicked() {\n   *   let isEnabled = linePerspective();\n   *   linePerspective(!isEnabled);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Double-click the canvas to toggle the line perspective.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'A row of cubes with black edges on a gray background. Their edges toggle between thick and thin when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Use an orthographic projection.\n   *   ortho();\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 600);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -40);\n   *     box(10);\n   *   }\n   * }\n   *\n   * // Toggle the line perspective when the user double-clicks.\n   * function doubleClicked() {\n   *   let isEnabled = linePerspective();\n   *   linePerspective(!isEnabled);\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method linePerspective\n   * @return {boolean} whether line perspective is enabled.\n   */\n  fn.linePerspective = function (enable) {\n    // p5._validateParameters('linePerspective', arguments);\n    if (!(this._renderer instanceof RendererGL)) {\n      throw new Error('linePerspective() must be called in WebGL mode.');\n    }\n    return this._renderer.linePerspective(enable);\n  };\n\n\n  /**\n   * Sets an orthographic projection for the current camera in a 3D sketch.\n   *\n   * In an orthographic projection, shapes with the same size always appear the\n   * same size, regardless of whether they are near or far from the camera.\n   *\n   * `ortho()` changes the cameras perspective by changing its viewing frustum\n   * from a truncated pyramid to a rectangular prism. The camera is placed in\n   * front of the frustum and views everything between the frustums near plane\n   * and its far plane. `ortho()` has six optional parameters to define the\n   * frustum.\n   *\n   * The first four parameters, `left`, `right`, `bottom`, and `top`, set the\n   * coordinates of the frustums sides, bottom, and top. For example, calling\n   * `ortho(-100, 100, 200, -200)` creates a frustum thats 200 pixels wide and\n   * 400 pixels tall. By default, these coordinates are set based on the\n   * sketchs width and height, as in\n   * `ortho(-width / 2, width / 2, -height / 2, height / 2)`.\n   *\n   * The last two parameters, `near` and `far`, set the distance of the\n   * frustums near and far plane from the camera. For example, calling\n   * `ortho(-100, 100, 200, 200, 50, 1000)` creates a frustum thats 200 pixels\n   * wide, 400 pixels tall, starts 50 pixels from the camera, and ends 1,000\n   * pixels from the camera. By default, `near` and `far` are set to 0 and\n   * `max(width, height) + 800`, respectively.\n   *\n   * Note: `ortho()` can only be used in WebGL mode.\n   *\n   * @method  ortho\n   * @for p5\n   * @param  {Number} [left]   x-coordinate of the frustums left plane. Defaults to `-width / 2`.\n   * @param  {Number} [right]  x-coordinate of the frustums right plane. Defaults to `width / 2`.\n   * @param  {Number} [bottom] y-coordinate of the frustums bottom plane. Defaults to `height / 2`.\n   * @param  {Number} [top]    y-coordinate of the frustums top plane. Defaults to `-height / 2`.\n   * @param  {Number} [near]   z-coordinate of the frustums near plane. Defaults to 0.\n   * @param  {Number} [far]    z-coordinate of the frustums far plane. Defaults to `max(width, height) + 800`.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A row of tiny, white cubes on a gray background. All the cubes appear the same size.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Apply an orthographic projection.\n   *   ortho();\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 600);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -40);\n   *     box(10);\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Apply an orthographic projection.\n   *   // Center the frustum.\n   *   // Set its width and height to 20.\n   *   // Place its near plane 300 pixels from the camera.\n   *   // Place its far plane 350 pixels from the camera.\n   *   ortho(-10, 10, -10, 10, 300, 350);\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 600);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -40);\n   *     box(10);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.ortho = function (...args) {\n    this._assert3d('ortho');\n    // p5._validateParameters('ortho', args);\n    this._renderer.ortho(...args);\n    return this;\n  };\n\n  /**\n   * Sets the frustum of the current camera in a 3D sketch.\n   *\n   * In a frustum projection, shapes that are further from the camera appear\n   * smaller than shapes that are near the camera. This technique, called\n   * foreshortening, creates realistic 3D scenes.\n   *\n   * `frustum()` changes the default cameras perspective by changing its\n   * viewing frustum. The frustum is the volume of space thats visible to the\n   * camera. The frustums shape is a pyramid with its top cut off. The camera\n   * is placed where the top of the pyramid should be and points towards the\n   * base of the pyramid. It views everything within the frustum.\n   *\n   * The first four parameters, `left`, `right`, `bottom`, and `top`, set the\n   * coordinates of the frustums sides, bottom, and top. For example, calling\n   * `frustum(-100, 100, 200, -200)` creates a frustum thats 200 pixels wide\n   * and 400 pixels tall. By default, these coordinates are set based on the\n   * sketchs width and height, as in\n   * `ortho(-width / 20, width / 20, height / 20, -height / 20)`.\n   *\n   * The last two parameters, `near` and `far`, set the distance of the\n   * frustums near and far plane from the camera. For example, calling\n   * `ortho(-100, 100, 200, -200, 50, 1000)` creates a frustum thats 200 pixels\n   * wide, 400 pixels tall, starts 50 pixels from the camera, and ends 1,000\n   * pixels from the camera. By default, near is set to `0.1 * 800`, which is\n   * 1/10th the default distance between the camera and the origin. `far` is set\n   * to `10 * 800`, which is 10 times the default distance between the camera\n   * and the origin.\n   *\n   * Note: `frustum()` can only be used in WebGL mode.\n   *\n   * @method frustum\n   * @for p5\n   * @param  {Number} [left]   x-coordinate of the frustums left plane. Defaults to `-width / 20`.\n   * @param  {Number} [right]  x-coordinate of the frustums right plane. Defaults to `width / 20`.\n   * @param  {Number} [bottom] y-coordinate of the frustums bottom plane. Defaults to `height / 20`.\n   * @param  {Number} [top]    y-coordinate of the frustums top plane. Defaults to `-height / 20`.\n   * @param  {Number} [near]   z-coordinate of the frustums near plane. Defaults to `0.1 * 800`.\n   * @param  {Number} [far]    z-coordinate of the frustums far plane. Defaults to `10 * 800`.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A row of white cubes on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Apply the default frustum projection.\n   *   frustum();\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 600);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -40);\n   *     box(10);\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *   describe('A white cube on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Adjust the frustum.\n   *   // Center it.\n   *   // Set its width and height to 20 pixels.\n   *   // Place its near plane 300 pixels from the camera.\n   *   // Place its far plane 350 pixels from the camera.\n   *   frustum(-10, 10, -10, 10, 300, 350);\n   *\n   *   // Translate the origin toward the camera.\n   *   translate(-10, 10, 600);\n   *\n   *   // Rotate the coordinate system.\n   *   rotateY(-0.1);\n   *   rotateX(-0.1);\n   *\n   *   // Draw the row of boxes.\n   *   for (let i = 0; i < 6; i += 1) {\n   *     translate(0, 0, -40);\n   *     box(10);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.frustum = function (...args) {\n    this._assert3d('frustum');\n    // p5._validateParameters('frustum', args);\n    this._renderer.frustum(...args);\n    return this;\n  };\n\n  /**\n   * Creates a new <a href=\"#/p5.Camera\">p5.Camera</a> object and sets it\n   * as the current (active) camera.\n   *\n   * The new camera is initialized with a default position `(0, 0, 800)` and a\n   * default perspective projection. Its properties can be controlled with\n   * <a href=\"#/p5.Camera\">p5.Camera</a> methods such as\n   * `myCamera.lookAt(0, 0, 0)`.\n   *\n   * Note: Every 3D sketch starts with a default camera initialized.\n   * This camera can be controlled with the functions\n   * <a href=\"#/p5/camera\">camera()</a>,\n   * <a href=\"#/p5/perspective\">perspective()</a>,\n   * <a href=\"#/p5/ortho\">ortho()</a>, and\n   * <a href=\"#/p5/frustum\">frustum()</a> if it's the only camera in the scene.\n   *\n   * Note: `createCamera()` can only be used in WebGL mode.\n   *\n   * @method createCamera\n   * @return {p5.Camera} the new camera.\n   * @for p5\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let usingCam1 = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   // Place it at the top-left.\n   *   // Point it at the origin.\n   *   cam2 = createCamera();\n   *   cam2.setPosition(400, -400, 800);\n   *   cam2.lookAt(0, 0, 0);\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe('A white cube on a gray background. The camera toggles between frontal and aerial views when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (usingCam1 === true) {\n   *     setCamera(cam2);\n   *     usingCam1 = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     usingCam1 = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createCamera = function () {\n    this._assert3d('createCamera');\n\n    return this._renderer.createCamera();\n  };\n\n  /**\n   * Sets the current (active) camera of a 3D sketch.\n   *\n   * `setCamera()` allows for switching between multiple cameras created with\n   * <a href=\"#/p5/createCamera\">createCamera()</a>.\n   *\n   * Note: `setCamera()` can only be used in WebGL mode.\n   *\n   * @method setCamera\n   * @param  {p5.Camera} cam camera that should be made active.\n   * @for p5\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let usingCam1 = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   // Place it at the top-left.\n   *   // Point it at the origin.\n   *   cam2 = createCamera();\n   *   cam2.setPosition(400, -400, 800);\n   *   cam2.lookAt(0, 0, 0);\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe('A white cube on a gray background. The camera toggles between frontal and aerial views when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (usingCam1 === true) {\n   *     setCamera(cam2);\n   *     usingCam1 = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     usingCam1 = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.setCamera = function (cam) {\n    this._renderer.setCamera(cam);\n  };\n\n  /**\n   * A class to describe a camera for viewing a 3D sketch.\n   *\n   * Each `p5.Camera` object represents a camera that views a section of 3D\n   * space. It stores information about the cameras position, orientation, and\n   * projection.\n   *\n   * In WebGL mode, the default camera is a `p5.Camera` object that can be\n   * controlled with the <a href=\"#/p5/camera\">camera()</a>,\n   * <a href=\"#/p5/perspective\">perspective()</a>,\n   * <a href=\"#/p5/ortho\">ortho()</a>, and\n   * <a href=\"#/p5/frustum\">frustum()</a> functions. Additional cameras can be\n   * created with <a href=\"#/p5/createCamera\">createCamera()</a> and activated\n   * with <a href=\"#/p5/setCamera\">setCamera()</a>.\n   *\n   * Note: `p5.Camera`s methods operate in two coordinate systems:\n   * - The world coordinate system describes positions in terms of their\n   * relationship to the origin along the x-, y-, and z-axes. For example,\n   * calling `myCamera.setPosition()` places the camera in 3D space using\n   * \"world\" coordinates.\n   * - The \"local\" coordinate system describes positions from the camera's point\n   * of view: left-right, up-down, and forward-backward. For example, calling\n   * `myCamera.move()` moves the camera along its own axes.\n   *\n   * @class p5.Camera\n   * @constructor\n   * @param {rendererGL} rendererGL instance of WebGL renderer\n   *\n   * @example\n   * <div>\n   * <code>\n   * let cam;\n   * let delta = 0.001;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Camera object.\n   *   cam = createCamera();\n   *\n   *   // Set the camera\n   *   setCamera(cam);\n   *\n   *   // Place the camera at the top-center.\n   *   cam.setPosition(0, -400, 800);\n   *\n   *   // Point the camera at the origin.\n   *   cam.lookAt(0, 0, 0);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The cube goes in and out of view as the camera pans left and right.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Turn the camera left and right, called \"panning\".\n   *   cam.pan(delta);\n   *\n   *   // Switch directions every 120 frames.\n   *   if (frameCount % 120 === 0) {\n   *     delta *= -1;\n   *   }\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let cam1;\n   * let cam2;\n   * let isDefaultCamera = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = createCamera();\n   *\n   *   // Create the second camera.\n   *   // Place it at the top-left.\n   *   // Point it at the origin.\n   *   cam2 = createCamera();\n   *   cam2.setPosition(400, -400, 800);\n   *   cam2.lookAt(0, 0, 0);\n   *\n   *   // Set the current camera to cam1.\n   *   setCamera(cam1);\n   *\n   *   describe(\n   *     'A white cube on a gray background. The camera toggles between frontal and aerial views when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isDefaultCamera === true) {\n   *     setCamera(cam2);\n   *     isDefaultCamera = false;\n   *   } else {\n   *     setCamera(cam1);\n   *     isDefaultCamera = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  p5.Camera = Camera;\n\n  RendererGL.prototype.camera = function(...args) {\n    this.states.curCamera.camera(...args);\n  };\n\n  RendererGL.prototype.perspective = function(...args) {\n    this.states.curCamera.perspective(...args);\n  };\n\n  RendererGL.prototype.linePerspective = function(enable) {\n    if (enable !== undefined) {\n      // Set the line perspective if enable is provided\n      this.states.curCamera.useLinePerspective = enable;\n    } else {\n      // If no argument is provided, return the current value\n      return this.states.curCamera.useLinePerspective;\n    }\n  };\n\n  RendererGL.prototype.ortho = function(...args) {\n    this.states.curCamera.ortho(...args);\n  };\n\n  RendererGL.prototype.frustum = function(...args) {\n    this.states.curCamera.frustum(...args);\n  };\n\n  RendererGL.prototype.createCamera = function() {\n    // compute default camera settings, then set a default camera\n    const _cam = new Camera(this);\n    _cam._computeCameraDefaultSettings();\n    _cam._setDefaultCamera();\n\n    return _cam;\n  };\n\n  RendererGL.prototype.setCamera = function(cam) {\n    this.states.setValue('curCamera', cam);\n\n    // set the projection matrix (which is not normally updated each frame)\n    this.states.setValue('uPMatrix', this.states.uPMatrix.clone());\n    this.states.uPMatrix.set(cam.projMatrix);\n    this.states.setValue('uViewMatrix', this.states.uViewMatrix.clone());\n    this.states.uViewMatrix.set(cam.cameraMatrix);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  camera(p5, p5.prototype);\n}\n\n/**\n * This module defines the p5.Shader class\n * @module 3D\n * @submodule Material\n * @for p5\n * @requires core\n */\n\n\nclass Shader {\n  constructor(renderer, vertSrc, fragSrc, options = {}) {\n    // TODO: adapt this to not take ids, but rather,\n    // to take the source for a vertex and fragment shader\n    // to enable custom shaders at some later date\n    this._renderer = renderer;\n    this._vertSrc = vertSrc;\n    this._fragSrc = fragSrc;\n    this._vertShader = -1;\n    this._fragShader = -1;\n    this._glProgram = 0;\n    this._loadedAttributes = false;\n    this.attributes = {};\n    this._loadedUniforms = false;\n    this.uniforms = {};\n    this._bound = false;\n    this.samplers = [];\n    this.hooks = {\n      // These should be passed in by `.modify()` instead of being manually\n      // passed in.\n\n      // Stores uniforms + default values.\n      uniforms: options.uniforms || {},\n\n      // Stores custom uniform + helper declarations as a string.\n      declarations: options.declarations,\n\n      // Stores helper functions to prepend to shaders.\n      helpers: options.helpers || {},\n\n      // Stores the hook implementations\n      vertex: options.vertex || {},\n      fragment: options.fragment || {},\n\n      // Stores whether or not the hook implementation has been modified\n      // from the default. This is supplied automatically by calling\n      // yourShader.modify(...).\n      modified: {\n        vertex: (options.modified && options.modified.vertex) || {},\n        fragment: (options.modified && options.modified.fragment) || {}\n      }\n    };\n  }\n\n  hookTypes(hookName) {\n    let fullSrc = this._vertSrc;\n    let body = this.hooks.vertex[hookName];\n    if (!body) {\n      body = this.hooks.fragment[hookName];\n      fullSrc = this._fragSrc;\n    }\n    if (!body) {\n      throw new Error(`Can't find hook ${hookName}!`);\n    }\n    const nameParts = hookName.split(/\\s+/g);\n    const functionName = nameParts.pop();\n    const returnType = nameParts.pop();\n    const returnQualifiers = [...nameParts];\n\n    const parameterMatch = /\\(([^\\)]*)\\)/.exec(body);\n    if (!parameterMatch) {\n      throw new Error(`Couldn't find function parameters in hook body:\\n${body}`);\n    }\n\n    const structProperties = structName => {\n      const structDefMatch = new RegExp(`struct\\\\s+${structName}\\\\s*\\{([^\\}]*)\\}`).exec(fullSrc);\n      if (!structDefMatch) return undefined;\n\n      const properties = [];\n      for (const defSrc of structDefMatch[1].split(';')) {\n        // E.g. `int var1, var2;` or `MyStruct prop;`\n        const parts = defSrc.trim().split(/\\s+|,/g);\n        const typeName = parts.shift();\n        const names = [...parts];\n        const typeProperties = structProperties(typeName);\n        for (const name of names) {\n          properties.push({\n            name,\n            type: {\n              typeName,\n              qualifiers: [],\n              properties: typeProperties,\n            },\n          });\n        }\n      }\n      return properties;\n    };\n\n    const parameters = parameterMatch[1].split(',').map(paramString => {\n      // e.g. `int prop` or `in sampler2D prop` or `const float prop`\n      const parts = paramString.trim().split(/\\s+/g);\n      const name = parts.pop();\n      const typeName = parts.pop();\n      const qualifiers = [...parts];\n      const properties = structProperties(typeName);\n      return {\n        name,\n        type: {\n          typeName,\n          qualifiers,\n          properties,\n        }\n      }\n    });\n\n    return {\n      name: functionName,\n      returnType: {\n        typeName: returnType,\n        qualifiers: returnQualifiers,\n        properties: structProperties(returnType)\n      },\n      parameters\n    };\n  }\n\n  shaderSrc(src, shaderType) {\n    const main = 'void main';\n    let [preMain, postMain] = src.split(main);\n\n    let hooks = '';\n    let defines = '';\n    for (const key in this.hooks.uniforms) {\n      hooks += `uniform ${key};\\n`;\n    }\n    if (this.hooks.declarations) {\n      hooks += this.hooks.declarations + '\\n';\n    }\n    if (this.hooks[shaderType].declarations) {\n      hooks += this.hooks[shaderType].declarations + '\\n';\n    }\n    for (const hookDef in this.hooks.helpers) {\n      hooks += `${hookDef}${this.hooks.helpers[hookDef]}\\n`;\n    }\n    for (const hookDef in this.hooks[shaderType]) {\n      if (hookDef === 'declarations') continue;\n      const [hookType, hookName] = hookDef.split(' ');\n\n      // Add a #define so that if the shader wants to use preprocessor directives to\n      // optimize away the extra function calls in main, it can do so\n      if (this.hooks.modified[shaderType][hookDef]) {\n        defines += '#define AUGMENTED_HOOK_' + hookName + '\\n';\n      }\n\n      hooks +=\n        hookType + ' HOOK_' + hookName + this.hooks[shaderType][hookDef] + '\\n';\n    }\n\n    // Allow shaders to specify the location of hook #define statements. Normally these\n    // go after function definitions, but one might want to have them defined earlier\n    // in order to only conditionally make uniforms.\n    if (preMain.indexOf('#define HOOK_DEFINES') !== -1) {\n      preMain = preMain.replace('#define HOOK_DEFINES', '\\n' + defines + '\\n');\n      defines = '';\n    }\n\n    return preMain + '\\n' + defines + hooks + main + postMain;\n  }\n\n  /**\n   * Shaders are written in <a href=\"https://developer.mozilla.org/en-US/docs/Games/Techniques/3D_on_the_web/GLSL_Shaders\">GLSL</a>, but\n   * there are different versions of GLSL that it might be written in.\n   *\n   * Calling this method on a `p5.Shader` will return the GLSL version it uses, either `100 es` or `300 es`.\n   * WebGL 1 shaders will only use `100 es`, and WebGL 2 shaders may use either.\n   *\n   * @returns {String} The GLSL version used by the shader.\n   */\n  version() {\n    const match = /#version (.+)$/.exec(this.vertSrc());\n    if (match) {\n      return match[1];\n    } else {\n      return '100 es';\n    }\n  }\n\n  vertSrc() {\n    return this.shaderSrc(this._vertSrc, 'vertex');\n  }\n\n  fragSrc() {\n    return this.shaderSrc(this._fragSrc, 'fragment');\n  }\n\n  /**\n   * Logs the hooks available in this shader, and their current implementation.\n   *\n   * Each shader may let you override bits of its behavior. Each bit is called\n   * a *hook.* A hook is either for the *vertex* shader, if it affects the\n   * position of vertices, or in the *fragment* shader, if it affects the pixel\n   * color. This method logs those values to the console, letting you know what\n   * you are able to use in a call to\n   * <a href=\"#/p5.Shader/modify\">`modify()`</a>.\n   *\n   * For example, this shader will produce the following output:\n   *\n   * ```js\n   * myShader = baseMaterialShader().modify({\n   *   declarations: 'uniform float time;',\n   *   'vec3 getWorldPosition': `(vec3 pos) {\n   *     pos.y += 20. * sin(time * 0.001 + pos.x * 0.05);\n   *     return pos;\n   *   }`\n   * });\n   * myShader.inspectHooks();\n   * ```\n   *\n   * ```\n   * ==== Vertex shader hooks: ====\n   * void beforeVertex() {}\n   * vec3 getLocalPosition(vec3 position) { return position; }\n   * [MODIFIED] vec3 getWorldPosition(vec3 pos) {\n   *       pos.y += 20. * sin(time * 0.001 + pos.x * 0.05);\n   *       return pos;\n   *     }\n   * vec3 getLocalNormal(vec3 normal) { return normal; }\n   * vec3 getWorldNormal(vec3 normal) { return normal; }\n   * vec2 getUV(vec2 uv) { return uv; }\n   * vec4 getVertexColor(vec4 color) { return color; }\n   * void afterVertex() {}\n   *\n   * ==== Fragment shader hooks: ====\n   * void beforeFragment() {}\n   * Inputs getPixelInputs(Inputs inputs) { return inputs; }\n   * vec4 combineColors(ColorComponents components) {\n   *                 vec4 color = vec4(0.);\n   *                 color.rgb += components.diffuse * components.baseColor;\n   *                 color.rgb += components.ambient * components.ambientColor;\n   *                 color.rgb += components.specular * components.specularColor;\n   *                 color.rgb += components.emissive;\n   *                 color.a = components.opacity;\n   *                 return color;\n   *               }\n   * vec4 getFinalColor(vec4 color) { return color; }\n   * void afterFragment() {}\n   * ```\n   *\n   * @beta\n   */\n  inspectHooks() {\n    console.log('==== Vertex shader hooks: ====');\n    for (const key in this.hooks.vertex) {\n      console.log(\n        (this.hooks.modified.vertex[key] ? '[MODIFIED] ' : '') +\n          key +\n          this.hooks.vertex[key]\n      );\n    }\n    console.log('');\n    console.log('==== Fragment shader hooks: ====');\n    for (const key in this.hooks.fragment) {\n      console.log(\n        (this.hooks.modified.fragment[key] ? '[MODIFIED] ' : '') +\n          key +\n          this.hooks.fragment[key]\n      );\n    }\n    console.log('');\n    console.log('==== Helper functions: ====');\n    for (const key in this.hooks.helpers) {\n      console.log(key + this.hooks.helpers[key]);\n    }\n  }\n\n  /**\n   * Returns a new shader, based on the original, but with custom snippets\n   * of shader code replacing default behaviour.\n   *\n   * Each shader may let you override bits of its behavior. Each bit is called\n   * a *hook.* For example, a hook can let you adjust positions of vertices, or\n   * the color of a pixel. You can inspect the different hooks available by calling\n   * <a href=\"#/p5.Shader/inspectHooks\">`yourShader.inspectHooks()`</a>. You can\n   * also read the reference for the default material, normal material, color, line, and point shaders to\n   * see what hooks they have available.\n   *\n   * `modify()` can be passed a function as a parameter. Inside, you can override hooks\n   * by calling them as functions. Each hook will take in a callback that takes in inputs\n   * and is expected to return an output. For example, here is a function that changes the\n   * material color to red:\n   *\n   * ```js example\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseMaterialShader().modify(() => {\n   *     getPixelInputs((inputs) => {\n   *       inputs.color = [inputs.texCoord, 0, 1];\n   *       return inputs;\n   *     });\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   noStroke();\n   *   shader(myShader); // Apply the custom shader\n   *   plane(width, height); // Draw a plane with the shader applied\n   * }\n   * ```\n   *\n   * In addition to calling hooks, you can create uniforms, which are special variables\n   * used to pass data from p5.js into the shader. They can be created by calling `uniform` + the\n   * type of the data, such as `uniformFloat` for a number of `uniformVector2` for a two-component vector.\n   * They take in a function that returns the data for the variable. You can then reference these\n   * variables in your hooks, and their values will update every time you apply\n   * the shader with the result of your function.\n   *\n   * ```js example\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseMaterialShader().modify(() => {\n   *     // Get the current time from p5.js\n   *     let t = uniformFloat(() => millis());\n   *\n   *     getPixelInputs((inputs) => {\n   *       inputs.color = [\n   *         inputs.texCoord,\n   *         sin(t * 0.01) / 2 + 0.5,\n   *         1,\n   *       ];\n   *       return inputs;\n   *     });\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   noStroke(255);\n   *   shader(myShader); // Apply the custom shader\n   *   plane(width, height); // Draw a plane with the shader applied\n   * }\n   * ```\n   *\n   * p5.strands functions are special, since they get turned into a shader instead of being\n   * run like the rest of your code. They only have access to p5.js functions, and variables\n   * you declare inside the `modify` callback. If you need access to local variables, you\n   * can pass them into `modify` with an optional second parameter, `variables`. If you are\n   * using instance mode, you will need to pass your sketch object in this way.\n   *\n   * ```js example\n   * new p5((sketch) => {\n   *   let myShader;\n   *\n   *   sketch.setup = function() {\n   *     sketch.createCanvas(200, 200, sketch.WEBGL);\n   *     myShader = sketch.baseMaterialShader().modify(() => {\n   *       sketch.getPixelInputs((inputs) => {\n   *         inputs.color = [inputs.texCoord, 0, 1];\n   *         return inputs;\n   *       });\n   *     }, { sketch });\n   *   }\n   *\n   *   sketch.draw = function() {\n   *     sketch.background(255);\n   *     sketch.noStroke();\n   *     sketch.shader(myShader); // Apply the custom shader\n   *     sketch.plane(sketch.width, sketch.height); // Draw a plane with the shader applied\n   *   }\n   * });\n   * ```\n   *\n   * You can also write GLSL directly in `modify` if you need direct access. To do so,\n   * `modify()` takes one parameter, `hooks`, an object with the hooks you want\n   * to override. Each key of the `hooks` object is the name\n   * of a hook, and the value is a string with the GLSL code for your hook.\n   *\n   * If you supply functions that aren't existing hooks, they will get added at the start of\n   * the shader as helper functions so that you can use them in your hooks.\n   *\n   * To add new <a href=\"#/p5.Shader/setUniform\">uniforms</a> to your shader, you can pass in a `uniforms` object containing\n   * the type and name of the uniform as the key, and a default value or function returning\n   * a default value as its value. These will be automatically set when the shader is set\n   * with `shader(yourShader)`.\n   *\n   * ```js example\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseMaterialShader().modify({\n   *     uniforms: {\n   *       'float time': () => millis() // Uniform for time\n   *     },\n   *     'Vertex getWorldInputs': `(Vertex inputs) {\n   *       inputs.position.y +=\n   *         20. * sin(time * 0.001 + inputs.position.x * 0.05);\n   *       return inputs;\n   *     }`\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   shader(myShader); // Apply the custom shader\n   *   lights();         // Enable lighting\n   *   noStroke();       // Disable stroke\n   *   fill('red');      // Set fill color to red\n   *   sphere(50);       // Draw a sphere with the shader applied\n   * }\n   * ```\n   *\n   * You can also add a `declarations` key, where the value is a GLSL string declaring\n   * custom uniform variables, globals, and functions shared\n   * between hooks. To add declarations just in a vertex or fragment shader, add\n   * `vertexDeclarations` and `fragmentDeclarations` keys.\n   *\n   * ```js example\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseMaterialShader().modify({\n   *     // Manually specifying a uniform\n   *     declarations: 'uniform float time;',\n   *     'Vertex getWorldInputs': `(Vertex inputs) {\n   *       inputs.position.y +=\n   *         20. * sin(time * 0.001 + inputs.position.x * 0.05);\n   *       return inputs;\n   *     }`\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   shader(myShader);\n   *   myShader.setUniform('time', millis());\n   *   lights();\n   *   noStroke();\n   *   fill('red');\n   *   sphere(50);\n   * }\n   * ```\n   *\n   * @beta\n   * @param {Function} callback A function with p5.strands code to modify the shader.\n   * @param {Object} [variables] An optional object with local variables p5.strands\n   * should have access to.\n   * @returns {p5.Shader}\n   */\n  /**\n   * @param {Object} [hooks] The hooks in the shader to replace.\n   * @returns {p5.Shader}\n   */\n  modify(hooks) {\n    // p5._validateParameters('p5.Shader.modify', arguments);\n    const newHooks = {\n      vertex: {},\n      fragment: {},\n      helpers: {}\n    };\n    for (const key in hooks) {\n      if (key === 'declarations') continue;\n      if (key === 'uniforms') continue;\n      if (key === 'vertexDeclarations') {\n        newHooks.vertex.declarations =\n          (newHooks.vertex.declarations || '') + '\\n' + hooks[key];\n      } else if (key === 'fragmentDeclarations') {\n        newHooks.fragment.declarations =\n          (newHooks.fragment.declarations || '') + '\\n' + hooks[key];\n      } else if (this.hooks.vertex[key]) {\n        newHooks.vertex[key] = hooks[key];\n      } else if (this.hooks.fragment[key]) {\n        newHooks.fragment[key] = hooks[key];\n      } else {\n        newHooks.helpers[key] = hooks[key];\n      }\n    }\n    const modifiedVertex = Object.assign({}, this.hooks.modified.vertex);\n    const modifiedFragment = Object.assign({}, this.hooks.modified.fragment);\n    for (const key in newHooks.vertex || {}) {\n      if (key === 'declarations') continue;\n      modifiedVertex[key] = true;\n    }\n    for (const key in newHooks.fragment || {}) {\n      if (key === 'declarations') continue;\n      modifiedFragment[key] = true;\n    }\n\n    return new Shader(this._renderer, this._vertSrc, this._fragSrc, {\n      declarations:\n        (this.hooks.declarations || '') + '\\n' + (hooks.declarations || ''),\n      uniforms: Object.assign({}, this.hooks.uniforms, hooks.uniforms || {}),\n      fragment: Object.assign({}, this.hooks.fragment, newHooks.fragment || {}),\n      vertex: Object.assign({}, this.hooks.vertex, newHooks.vertex || {}),\n      helpers: Object.assign({}, this.hooks.helpers, newHooks.helpers || {}),\n      modified: {\n        vertex: modifiedVertex,\n        fragment: modifiedFragment\n      }\n    });\n  }\n\n  /**\n   * Creates, compiles, and links the shader based on its\n   * sources for the vertex and fragment shaders (provided\n   * to the constructor). Populates known attributes and\n   * uniforms from the shader.\n   * @chainable\n   * @private\n   */\n  init() {\n    if (this._glProgram === 0 /* or context is stale? */) {\n      const gl = this._renderer.GL;\n\n      // @todo: once custom shading is allowed,\n      // friendly error messages should be used here to share\n      // compiler and linker errors.\n\n      //set up the shader by\n      // 1. creating and getting a gl id for the shader program,\n      // 2. compliling its vertex & fragment sources,\n      // 3. linking the vertex and fragment shaders\n      this._vertShader = gl.createShader(gl.VERTEX_SHADER);\n      //load in our default vertex shader\n      gl.shaderSource(this._vertShader, this.vertSrc());\n      gl.compileShader(this._vertShader);\n      // if our vertex shader failed compilation?\n      if (!gl.getShaderParameter(this._vertShader, gl.COMPILE_STATUS)) {\n        const glError = gl.getShaderInfoLog(this._vertShader);\n        if (typeof IS_MINIFIED !== 'undefined') {\n          console.error(glError);\n        } else {\n          throw glError;\n        }\n        return null;\n      }\n\n      this._fragShader = gl.createShader(gl.FRAGMENT_SHADER);\n      //load in our material frag shader\n      gl.shaderSource(this._fragShader, this.fragSrc());\n      gl.compileShader(this._fragShader);\n      // if our frag shader failed compilation?\n      if (!gl.getShaderParameter(this._fragShader, gl.COMPILE_STATUS)) {\n        const glError = gl.getShaderInfoLog(this._fragShader);\n        if (typeof IS_MINIFIED !== 'undefined') {\n          console.error(glError);\n        } else {\n          throw glError;\n        }\n        return null;\n      }\n\n      this._glProgram = gl.createProgram();\n      gl.attachShader(this._glProgram, this._vertShader);\n      gl.attachShader(this._glProgram, this._fragShader);\n      gl.linkProgram(this._glProgram);\n      if (!gl.getProgramParameter(this._glProgram, gl.LINK_STATUS)) {\n        p5._friendlyError(\n          `Snap! Error linking shader program: ${gl.getProgramInfoLog(\n            this._glProgram\n          )}`\n        );\n      }\n\n      this._loadAttributes();\n      this._loadUniforms();\n    }\n    return this;\n  }\n\n  /**\n   * @private\n   */\n  setDefaultUniforms() {\n    for (const key in this.hooks.uniforms) {\n      const [, name] = key.split(' ');\n      const initializer = this.hooks.uniforms[key];\n      let value;\n      if (initializer instanceof Function) {\n        value = initializer();\n      } else {\n        value = initializer;\n      }\n\n      if (value !== undefined && value !== null) {\n        this.setUniform(name, value);\n      }\n    }\n  }\n\n  /**\n   * Copies the shader from one drawing context to another.\n   *\n   * Each `p5.Shader` object must be compiled by calling\n   * <a href=\"#/p5/shader\">shader()</a> before it can run. Compilation happens\n   * in a drawing context which is usually the main canvas or an instance of\n   * <a href=\"#/p5.Graphics\">p5.Graphics</a>. A shader can only be used in the\n   * context where it was compiled. The `copyToContext()` method compiles the\n   * shader again and copies it to another drawing context where it can be\n   * reused.\n   *\n   * The parameter, `context`, is the drawing context where the shader will be\n   * used. The shader can be copied to an instance of\n   * <a href=\"#/p5.Graphics\">p5.Graphics</a>, as in\n   * `myShader.copyToContext(pg)`. The shader can also be copied from a\n   * <a href=\"#/p5.Graphics\">p5.Graphics</a> object to the main canvas using\n   * the `p5.instance` variable, as in `myShader.copyToContext(p5.instance)`.\n   *\n   * Note: A <a href=\"#/p5.Shader\">p5.Shader</a> object created with\n   * <a href=\"#/p5/createShader\">createShader()</a>,\n   * <a href=\"#/p5/createFilterShader\">createFilterShader()</a>, or\n   * <a href=\"#/p5/loadShader\">loadShader()</a>\n   * can be used directly with a <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a>\n   * object created with\n   * <a href=\"#/p5/createFramebuffer\">createFramebuffer()</a>. Both objects\n   * have the same context as the main canvas.\n   *\n   * @param {p5|p5.Graphics} context WebGL context for the copied shader.\n   * @returns {p5.Shader} new shader compiled for the target context.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * precision highp float;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   *\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vTexCoord = aTexCoord;\n   *   vec4 positionVec4 = vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `\n   * precision mediump float;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vec2 uv = vTexCoord;\n   *   vec3 color = vec3(uv.x, uv.y, min(uv.x + uv.y, 1.0));\n   *   gl_FragColor = vec4(color, 1.0);\\\n   * }\n   * `;\n   *\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Shader object.\n   *   let original = createShader(vertSrc, fragSrc);\n   *\n   *   // Compile the p5.Shader object.\n   *   shader(original);\n   *\n   *   // Create a p5.Graphics object.\n   *   pg = createGraphics(50, 50, WEBGL);\n   *\n   *   // Copy the original shader to the p5.Graphics object.\n   *   let copied = original.copyToContext(pg);\n   *\n   *   // Apply the copied shader to the p5.Graphics object.\n   *   pg.shader(copied);\n   *\n   *   // Style the display surface.\n   *   pg.noStroke();\n   *\n   *   // Add a display surface for the shader.\n   *   pg.plane(50, 50);\n   *\n   *   describe('A square with purple-blue gradient on its surface drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the p5.Graphics object to the main canvas.\n   *   image(pg, -25, -25);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='notest'>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * precision highp float;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   *\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vTexCoord = aTexCoord;\n   *   vec4 positionVec4 = vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `\n   * precision mediump float;\n   *\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vec2 uv = vTexCoord;\n   *   vec3 color = vec3(uv.x, uv.y, min(uv.x + uv.y, 1.0));\n   *   gl_FragColor = vec4(color, 1.0);\n   * }\n   * `;\n   *\n   * let copied;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Graphics object.\n   *   let pg = createGraphics(25, 25, WEBGL);\n   *\n   *   // Create a p5.Shader object.\n   *   let original = pg.createShader(vertSrc, fragSrc);\n   *\n   *   // Compile the p5.Shader object.\n   *   pg.shader(original);\n   *\n   *   // Copy the original shader to the main canvas.\n   *   copied = original.copyToContext(p5.instance);\n   *\n   *   // Apply the copied shader to the main canvas.\n   *   shader(copied);\n   *\n   *   describe('A rotating cube with a purple-blue gradient on its surface drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Rotate around the x-, y-, and z-axes.\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   rotateZ(frameCount * 0.01);\n   *\n   *   // Draw the box.\n   *   box(50);\n   * }\n   * </code>\n   * </div>\n   */\n  copyToContext(context) {\n    const shader = new Shader(\n      context._renderer,\n      this._vertSrc,\n      this._fragSrc\n    );\n    shader.ensureCompiledOnContext(context._renderer);\n    return shader;\n  }\n\n  /**\n   * @private\n   */\n  ensureCompiledOnContext(context) {\n    if (this._glProgram !== 0 && this._renderer !== context) {\n      throw new Error(\n        'The shader being run is attached to a different context. Do you need to copy it to this context first with .copyToContext()?'\n      );\n    } else if (this._glProgram === 0) {\n      this._renderer = context?._renderer?.filterRenderer?._renderer || context;\n      this.init();\n    }\n  }\n\n\n  /**\n   * Queries the active attributes for this shader and loads\n   * their names and locations into the attributes array.\n   * @private\n   */\n  _loadAttributes() {\n    if (this._loadedAttributes) {\n      return;\n    }\n\n    this.attributes = {};\n\n    const gl = this._renderer.GL;\n\n    const numAttributes = gl.getProgramParameter(\n      this._glProgram,\n      gl.ACTIVE_ATTRIBUTES\n    );\n    for (let i = 0; i < numAttributes; ++i) {\n      const attributeInfo = gl.getActiveAttrib(this._glProgram, i);\n      const name = attributeInfo.name;\n      const location = gl.getAttribLocation(this._glProgram, name);\n      const attribute = {};\n      attribute.name = name;\n      attribute.location = location;\n      attribute.index = i;\n      attribute.type = attributeInfo.type;\n      attribute.size = attributeInfo.size;\n      this.attributes[name] = attribute;\n    }\n\n    this._loadedAttributes = true;\n  }\n\n  /**\n   * Queries the active uniforms for this shader and loads\n   * their names and locations into the uniforms array.\n   * @private\n   */\n  _loadUniforms() {\n    if (this._loadedUniforms) {\n      return;\n    }\n\n    const gl = this._renderer.GL;\n\n    // Inspect shader and cache uniform info\n    const numUniforms = gl.getProgramParameter(\n      this._glProgram,\n      gl.ACTIVE_UNIFORMS\n    );\n\n    let samplerIndex = 0;\n    for (let i = 0; i < numUniforms; ++i) {\n      const uniformInfo = gl.getActiveUniform(this._glProgram, i);\n      const uniform = {};\n      uniform.location = gl.getUniformLocation(\n        this._glProgram,\n        uniformInfo.name\n      );\n      uniform.size = uniformInfo.size;\n      let uniformName = uniformInfo.name;\n      //uniforms that are arrays have their name returned as\n      //someUniform[0] which is a bit silly so we trim it\n      //off here. The size property tells us that its an array\n      //so we dont lose any information by doing this\n      if (uniformInfo.size > 1) {\n        uniformName = uniformName.substring(0, uniformName.indexOf('[0]'));\n      }\n      uniform.name = uniformName;\n      uniform.type = uniformInfo.type;\n      uniform._cachedData = undefined;\n      if (uniform.type === gl.SAMPLER_2D) {\n        uniform.samplerIndex = samplerIndex;\n        samplerIndex++;\n        this.samplers.push(uniform);\n      }\n\n      uniform.isArray =\n        uniformInfo.size > 1 ||\n        uniform.type === gl.FLOAT_MAT3 ||\n        uniform.type === gl.FLOAT_MAT4 ||\n        uniform.type === gl.FLOAT_VEC2 ||\n        uniform.type === gl.FLOAT_VEC3 ||\n        uniform.type === gl.FLOAT_VEC4 ||\n        uniform.type === gl.INT_VEC2 ||\n        uniform.type === gl.INT_VEC4 ||\n        uniform.type === gl.INT_VEC3;\n\n      this.uniforms[uniformName] = uniform;\n    }\n    this._loadedUniforms = true;\n  }\n\n  compile() {\n    // TODO\n  }\n\n  /**\n   * initializes (if needed) and binds the shader program.\n   * @private\n   */\n  bindShader() {\n    this.init();\n    if (!this._bound) {\n      this.useProgram();\n      this._bound = true;\n    }\n  }\n\n  /**\n   * @chainable\n   * @private\n   */\n  unbindShader() {\n    if (this._bound) {\n      this.unbindTextures();\n      this._bound = false;\n    }\n    return this;\n  }\n\n  bindTextures() {\n    const gl = this._renderer.GL;\n\n    const empty = this._renderer._getEmptyTexture();\n\n    for (const uniform of this.samplers) {\n      let tex = uniform.texture;\n      if (\n        tex === undefined ||\n        (\n          false\n        )\n      ) {\n        // user hasn't yet supplied a texture for this slot.\n        // (or there may not be one--maybe just lighting),\n        // so we supply a default texture instead.\n        uniform.texture = tex = empty;\n      }\n      gl.activeTexture(gl.TEXTURE0 + uniform.samplerIndex);\n      tex.bindTexture();\n      tex.update();\n      gl.uniform1i(uniform.location, uniform.samplerIndex);\n    }\n  }\n\n  updateTextures() {\n    for (const uniform of this.samplers) {\n      const tex = uniform.texture;\n      if (tex) {\n        tex.update();\n      }\n    }\n  }\n\n  unbindTextures() {\n    const gl = this._renderer.GL;\n    const empty = this._renderer._getEmptyTexture();\n    for (const uniform of this.samplers) {\n      if (uniform.texture?.isFramebufferTexture) {\n        gl.activeTexture(gl.TEXTURE0 + uniform.samplerIndex);\n        empty.bindTexture();\n        gl.uniform1i(uniform.location, uniform.samplerIndex);\n      }\n    }\n  }\n\n  /**\n   * @chainable\n   * @private\n   */\n  useProgram() {\n    const gl = this._renderer.GL;\n    if (this._renderer._curShader !== this) {\n      gl.useProgram(this._glProgram);\n      this._renderer._curShader = this;\n    }\n    return this;\n  }\n\n  /**\n   * Sets the shaders uniform (global) variables.\n   *\n   * Shader programs run on the computers graphics processing unit (GPU).\n   * They live in part of the computers memory thats completely separate\n   * from the sketch that runs them. Uniforms are global variables within a\n   * shader program. They provide a way to pass values from a sketch running\n   * on the CPU to a shader program running on the GPU.\n   *\n   * The first parameter, `uniformName`, is a string with the uniforms name.\n   * For the shader above, `uniformName` would be `'r'`.\n   *\n   * The second parameter, `data`, is the value that should be used to set the\n   * uniform. For example, calling `myShader.setUniform('r', 0.5)` would set\n   * the `r` uniform in the shader above to `0.5`. data should match the\n   * uniforms type. Numbers, strings, booleans, arrays, and many types of\n   * images can all be passed to a shader with `setUniform()`.\n   *\n   * @chainable\n   * @param {String} uniformName name of the uniform. Must match the name\n   *                             used in the vertex and fragment shaders.\n   * @param {Boolean|Number|Number[]|p5.Image|p5.Graphics|p5.MediaElement|p5.Texture}\n   * data value to assign to the uniform. Must match the uniforms data type.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * precision highp float;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   *\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vTexCoord = aTexCoord;\n   *   vec4 positionVec4 = vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `\n   * precision mediump float;\n   *\n   * uniform float r;\n   *\n   * void main() {\n   *   gl_FragColor = vec4(r, 1.0, 1.0, 1.0);\n   * }\n   * `;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Shader object.\n   *   let myShader = createShader(vertSrc, fragSrc);\n   *\n   *   // Apply the p5.Shader object.\n   *   shader(myShader);\n   *\n   *   // Set the r uniform to 0.5.\n   *   myShader.setUniform('r', 0.5);\n   *\n   *   // Style the drawing surface.\n   *   noStroke();\n   *\n   *   // Add a plane as a drawing surface for the shader.\n   *   plane(100, 100);\n   *\n   *   describe('A cyan square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * precision highp float;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   *\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vTexCoord = aTexCoord;\n   *   vec4 positionVec4 = vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `\n   * precision mediump float;\n   *\n   * uniform float r;\n   *\n   * void main() {\n   *   gl_FragColor = vec4(r, 1.0, 1.0, 1.0);\n   * }\n   * `;\n   *\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Shader object.\n   *   myShader = createShader(vertSrc, fragSrc);\n   *\n   *   // Compile and apply the p5.Shader object.\n   *   shader(myShader);\n   *\n   *   describe('A square oscillates color between cyan and white.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the drawing surface.\n   *   noStroke();\n   *\n   *   // Update the r uniform.\n   *   let nextR = 0.5 * (sin(frameCount * 0.01) + 1);\n   *   myShader.setUniform('r', nextR);\n   *\n   *   // Add a plane as a drawing surface.\n   *   plane(100, 100);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * precision highp float;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   *\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vTexCoord = aTexCoord;\n   *   vec4 positionVec4 = vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `\n   * precision highp float;\n   * uniform vec2 p;\n   * uniform float r;\n   * const int numIterations = 500;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vec2 c = p + gl_FragCoord.xy * r;\n   *   vec2 z = c;\n   *   float n = 0.0;\n   *\n   *   for (int i = numIterations; i > 0; i--) {\n   *     if (z.x * z.x + z.y * z.y > 4.0) {\n   *       n = float(i) / float(numIterations);\n   *       break;\n   *     }\n   *\n   *     z = vec2(z.x * z.x - z.y * z.y, 2.0 * z.x * z.y) + c;\n   *   }\n   *\n   *   gl_FragColor = vec4(\n   *     0.5 - cos(n * 17.0) / 2.0,\n   *     0.5 - cos(n * 13.0) / 2.0,\n   *     0.5 - cos(n * 23.0) / 2.0,\n   *     1.0\n   *   );\n   * }\n   * `;\n   *\n   * let mandelbrot;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Shader object.\n   *   mandelbrot = createShader(vertSrc, fragSrc);\n   *\n   *   // Compile and apply the p5.Shader object.\n   *   shader(mandelbrot);\n   *\n   *   // Set the shader uniform p to an array.\n   *   // p is the center point of the Mandelbrot image.\n   *   mandelbrot.setUniform('p', [-0.74364388703, 0.13182590421]);\n   *\n   *   describe('A fractal image zooms in and out of focus.');\n   * }\n   *\n   * function draw() {\n   *   // Set the shader uniform r to a value that oscillates\n   *   // between 0 and 0.005.\n   *   // r is the size of the image in Mandelbrot-space.\n   *   let radius = 0.005 * (sin(frameCount * 0.01) + 1);\n   *   mandelbrot.setUniform('r', radius);\n   *\n   *   // Style the drawing surface.\n   *   noStroke();\n   *\n   *   // Add a plane as a drawing surface.\n   *   plane(100, 100);\n   * }\n   * </code>\n   * </div>\n   */\n  setUniform(uniformName, data) {\n    this.init();\n\n    const uniform = this.uniforms[uniformName];\n    if (!uniform) {\n      return;\n    }\n    const gl = this._renderer.GL;\n\n    if (uniform.isArray) {\n      if (\n        uniform._cachedData &&\n        this._renderer._arraysEqual(uniform._cachedData, data)\n      ) {\n        return;\n      } else {\n        uniform._cachedData = data.slice(0);\n      }\n    } else if (uniform._cachedData && uniform._cachedData === data) {\n      return;\n    } else {\n      if (Array.isArray(data)) {\n        uniform._cachedData = data.slice(0);\n      } else {\n        uniform._cachedData = data;\n      }\n    }\n\n    const location = uniform.location;\n\n    this.useProgram();\n\n    switch (uniform.type) {\n      case gl.BOOL:\n        if (data === true) {\n          gl.uniform1i(location, 1);\n        } else {\n          gl.uniform1i(location, 0);\n        }\n        break;\n      case gl.INT:\n        if (uniform.size > 1) {\n          data.length && gl.uniform1iv(location, data);\n        } else {\n          gl.uniform1i(location, data);\n        }\n        break;\n      case gl.FLOAT:\n        if (uniform.size > 1) {\n          data.length && gl.uniform1fv(location, data);\n        } else {\n          gl.uniform1f(location, data);\n        }\n        break;\n      case gl.FLOAT_MAT3:\n        gl.uniformMatrix3fv(location, false, data);\n        break;\n      case gl.FLOAT_MAT4:\n        gl.uniformMatrix4fv(location, false, data);\n        break;\n      case gl.FLOAT_VEC2:\n        if (uniform.size > 1) {\n          data.length && gl.uniform2fv(location, data);\n        } else {\n          gl.uniform2f(location, data[0], data[1]);\n        }\n        break;\n      case gl.FLOAT_VEC3:\n        if (uniform.size > 1) {\n          data.length && gl.uniform3fv(location, data);\n        } else {\n          gl.uniform3f(location, data[0], data[1], data[2]);\n        }\n        break;\n      case gl.FLOAT_VEC4:\n        if (uniform.size > 1) {\n          data.length && gl.uniform4fv(location, data);\n        } else {\n          gl.uniform4f(location, data[0], data[1], data[2], data[3]);\n        }\n        break;\n      case gl.INT_VEC2:\n        if (uniform.size > 1) {\n          data.length && gl.uniform2iv(location, data);\n        } else {\n          gl.uniform2i(location, data[0], data[1]);\n        }\n        break;\n      case gl.INT_VEC3:\n        if (uniform.size > 1) {\n          data.length && gl.uniform3iv(location, data);\n        } else {\n          gl.uniform3i(location, data[0], data[1], data[2]);\n        }\n        break;\n      case gl.INT_VEC4:\n        if (uniform.size > 1) {\n          data.length && gl.uniform4iv(location, data);\n        } else {\n          gl.uniform4i(location, data[0], data[1], data[2], data[3]);\n        }\n        break;\n      case gl.SAMPLER_2D:\n        if (typeof data == 'number') {\n          if (\n            data < gl.TEXTURE0 ||\n            data > gl.TEXTURE31 ||\n            data !== Math.ceil(data)\n          ) {\n            console.log(\n              ' p5.js says: ' +\n                \"You're trying to use a number as the data for a texture.\" +\n                'Please use a texture.'\n            );\n            return this;\n          }\n          gl.activeTexture(data);\n          gl.uniform1i(location, data);\n        } else {\n          gl.activeTexture(gl.TEXTURE0 + uniform.samplerIndex);\n          uniform.texture =\n            data instanceof Texture ? data : this._renderer.getTexture(data);\n          gl.uniform1i(location, uniform.samplerIndex);\n          if (uniform.texture.src.gifProperties) {\n            uniform.texture.src._animateGif(this._renderer._pInst);\n          }\n        }\n        break;\n      case gl.SAMPLER_CUBE:\n      case gl.SAMPLER_3D:\n      case gl.SAMPLER_2D_SHADOW:\n      case gl.SAMPLER_2D_ARRAY:\n      case gl.SAMPLER_2D_ARRAY_SHADOW:\n      case gl.SAMPLER_CUBE_SHADOW:\n      case gl.INT_SAMPLER_2D:\n      case gl.INT_SAMPLER_3D:\n      case gl.INT_SAMPLER_CUBE:\n      case gl.INT_SAMPLER_2D_ARRAY:\n      case gl.UNSIGNED_INT_SAMPLER_2D:\n      case gl.UNSIGNED_INT_SAMPLER_3D:\n      case gl.UNSIGNED_INT_SAMPLER_CUBE:\n      case gl.UNSIGNED_INT_SAMPLER_2D_ARRAY:\n        if (typeof data !== 'number') {\n          break;\n        }\n        if (\n          data < gl.TEXTURE0 ||\n          data > gl.TEXTURE31 ||\n          data !== Math.ceil(data)\n        ) {\n          console.log(\n            ' p5.js says: ' +\n              \"You're trying to use a number as the data for a texture.\" +\n              'Please use a texture.'\n          );\n          break;\n        }\n        gl.activeTexture(data);\n        gl.uniform1i(location, data);\n        break;\n      //@todo complete all types\n    }\n    return this;\n  }\n\n  /**\n   * @chainable\n   * @private\n   */\n  enableAttrib(attr, size, type, normalized, stride, offset) {\n    if (attr) {\n      if (\n        typeof IS_MINIFIED === 'undefined' &&\n        this.attributes[attr.name] !== attr\n      ) {\n        console.warn(\n          `The attribute \"${attr.name}\"passed to enableAttrib does not belong to this shader.`\n        );\n      }\n      const loc = attr.location;\n      if (loc !== -1) {\n        const gl = this._renderer.GL;\n        // Enable register even if it is disabled\n        if (!this._renderer.registerEnabled.has(loc)) {\n          gl.enableVertexAttribArray(loc);\n          // Record register availability\n          this._renderer.registerEnabled.add(loc);\n        }\n        this._renderer.GL.vertexAttribPointer(\n          loc,\n          size,\n          type || gl.FLOAT,\n          normalized || false,\n          stride || 0,\n          offset || 0\n        );\n      }\n    }\n    return this;\n  }\n\n  /**\n   * Once all buffers have been bound, this checks to see if there are any\n   * remaining active attributes, likely left over from previous renders,\n   * and disables them so that they don't affect rendering.\n   * @private\n   */\n  disableRemainingAttributes() {\n    for (const location of this._renderer.registerEnabled.values()) {\n      if (\n        !Object.keys(this.attributes).some(\n          key => this.attributes[key].location === location\n        )\n      ) {\n        this._renderer.GL.disableVertexAttribArray(location);\n        this._renderer.registerEnabled.delete(location);\n      }\n    }\n  }\n}\nfunction shader(p5, fn){\n  /**\n   * A class to describe a shader program.\n   *\n   * Each `p5.Shader` object contains a shader program that runs on the graphics\n   * processing unit (GPU). Shaders can process many pixels or vertices at the\n   * same time, making them fast for many graphics tasks. Theyre written in a\n   * language called\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Games/Techniques/3D_on_the_web/GLSL_Shaders\" target=\"_blank\">GLSL</a>\n   * and run along with the rest of the code in a sketch.\n   *\n   * A shader program consists of two files, a vertex shader and a fragment\n   * shader. The vertex shader affects where 3D geometry is drawn on the screen\n   * and the fragment shader affects color. Once the `p5.Shader` object is\n   * created, it can be used with the <a href=\"#/p5/shader\">shader()</a>\n   * function, as in `shader(myShader)`.\n   *\n   * A shader can optionally describe *hooks,* which are functions in GLSL that\n   * users may choose to provide to customize the behavior of the shader. For the\n   * vertex or the fragment shader, users can pass in an object where each key is\n   * the type and name of a hook function, and each value is a string with the\n   * parameter list and default implementation of the hook. For example, to let users\n   * optionally run code at the start of the vertex shader, the options object could\n   * include:\n   *\n   * ```js\n   * {\n   *   vertex: {\n   *     'void beforeVertex': '() {}'\n   *   }\n   * }\n   * ```\n   *\n   * Then, in your vertex shader source, you can run a hook by calling a function\n   * with the same name prefixed by `HOOK_`:\n   *\n   * ```glsl\n   * void main() {\n   *   HOOK_beforeVertex();\n   *   // Add the rest ofy our shader code here!\n   * }\n   * ```\n   *\n   * Note: <a href=\"#/p5/createShader\">createShader()</a>,\n   * <a href=\"#/p5/createFilterShader\">createFilterShader()</a>, and\n   * <a href=\"#/p5/loadShader\">loadShader()</a> are the recommended ways to\n   * create an instance of this class.\n   *\n   * @class p5.Shader\n   * @constructor\n   * @param {p5.RendererGL} renderer WebGL context for this shader.\n   * @param {String} vertSrc source code for the vertex shader program.\n   * @param {String} fragSrc source code for the fragment shader program.\n   * @param {Object} [options] An optional object describing how this shader can\n   * be augmented with hooks. It can include:\n   *  - `vertex`: An object describing the available vertex shader hooks.\n   *  - `fragment`: An object describing the available frament shader hooks.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * precision highp float;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   *\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vTexCoord = aTexCoord;\n   *   vec4 positionVec4 = vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `\n   * precision highp float;\n   *\n   * void main() {\n   *   // Set each pixel's RGBA value to yellow.\n   *   gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n   * }\n   * `;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Shader object.\n   *   let myShader = createShader(vertSrc, fragSrc);\n   *\n   *   // Apply the p5.Shader object.\n   *   shader(myShader);\n   *\n   *   // Style the drawing surface.\n   *   noStroke();\n   *\n   *   // Add a plane as a drawing surface.\n   *   plane(100, 100);\n   *\n   *   describe('A yellow square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * let mandelbrot;\n   *\n   * async function setup() {\n   *   mandelbrot = await loadShader('assets/shader.vert', 'assets/shader.frag');\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Use the p5.Shader object.\n   *   shader(mandelbrot);\n   *\n   *   // Set the shader uniform p to an array.\n   *   mandelbrot.setUniform('p', [-0.74364388703, 0.13182590421]);\n   *\n   *   describe('A fractal image zooms in and out of focus.');\n   * }\n   *\n   * function draw() {\n   *   // Set the shader uniform r to a value that oscillates between 0 and 2.\n   *   mandelbrot.setUniform('r', sin(frameCount * 0.01) + 1);\n   *\n   *   // Add a quad as a display surface for the shader.\n   *   quad(-1, -1, 1, -1, 1, 1, -1, 1);\n   * }\n   * </code>\n   * </div>\n   */\n  p5.Shader = Shader;\n}\n\nif(typeof p5 !== 'undefined'){\n  shader(p5, p5.prototype);\n}\n\nvar filterBaseVert = \"precision highp int;\\n\\nuniform mat4 uModelViewMatrix;\\nuniform mat4 uProjectionMatrix;\\n\\nIN vec3 aPosition;\\nIN vec2 aTexCoord;\\nOUT vec2 vTexCoord;\\n\\nvoid main() {\\n  // transferring texcoords for the frag shader\\n  vTexCoord = aTexCoord;\\n\\n  // copy position with a fourth coordinate for projection (1.0 is normal)\\n  vec4 positionVec4 = vec4(aPosition, 1.0);\\n\\n  // project to 3D space\\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\\n}\\n\";\n\nvar lightingShader = \"#define PI 3.141592\\n\\nprecision highp float;\\nprecision highp int;\\n\\nuniform mat4 uViewMatrix;\\n\\nuniform bool uUseLighting;\\n\\nuniform int uAmbientLightCount;\\nuniform vec3 uAmbientColor[5];\\nuniform mat3 uCameraRotation;\\nuniform int uDirectionalLightCount;\\nuniform vec3 uLightingDirection[5];\\nuniform vec3 uDirectionalDiffuseColors[5];\\nuniform vec3 uDirectionalSpecularColors[5];\\n\\nuniform int uPointLightCount;\\nuniform vec3 uPointLightLocation[5];\\nuniform vec3 uPointLightDiffuseColors[5];\\t\\nuniform vec3 uPointLightSpecularColors[5];\\n\\nuniform int uSpotLightCount;\\nuniform float uSpotLightAngle[5];\\nuniform float uSpotLightConc[5];\\nuniform vec3 uSpotLightDiffuseColors[5];\\nuniform vec3 uSpotLightSpecularColors[5];\\nuniform vec3 uSpotLightLocation[5];\\nuniform vec3 uSpotLightDirection[5];\\n\\nuniform bool uSpecular;\\nuniform float uShininess;\\nuniform float uMetallic;\\n\\nuniform float uConstantAttenuation;\\nuniform float uLinearAttenuation;\\nuniform float uQuadraticAttenuation;\\n\\n// setting from  _setImageLightUniforms()\\n// boolean to initiate the calculateImageDiffuse and calculateImageSpecular\\nuniform bool uUseImageLight;\\n// texture for use in calculateImageDiffuse\\nuniform sampler2D environmentMapDiffused;\\n// texture for use in calculateImageSpecular\\nuniform sampler2D environmentMapSpecular;\\n\\nconst float specularFactor = 2.0;\\nconst float diffuseFactor = 0.73;\\n\\nstruct LightResult {\\n  float specular;\\n  float diffuse;\\n};\\n\\nfloat _phongSpecular(\\n  vec3 lightDirection,\\n  vec3 viewDirection,\\n  vec3 surfaceNormal,\\n  float shininess) {\\n\\n  vec3 R = reflect(lightDirection, surfaceNormal);\\n  return pow(max(0.0, dot(R, viewDirection)), shininess);\\n}\\n\\nfloat _lambertDiffuse(vec3 lightDirection, vec3 surfaceNormal) {\\n  return max(0.0, dot(-lightDirection, surfaceNormal));\\n}\\n\\nLightResult _light(vec3 viewDirection, vec3 normal, vec3 lightVector, float shininess, float metallic) {\\n\\n  vec3 lightDir = normalize(lightVector);\\n\\n  //compute our diffuse & specular terms\\n  LightResult lr;\\n  float specularIntensity = mix(1.0, 0.4, metallic);\\n  float diffuseIntensity = mix(1.0, 0.1, metallic);\\n  if (uSpecular)\\n    lr.specular = (_phongSpecular(lightDir, viewDirection, normal, shininess)) * specularIntensity;\\n    lr.diffuse = _lambertDiffuse(lightDir, normal) * diffuseIntensity;\\n  return lr;\\n}\\n\\n// converts the range of \\\"value\\\" from [min1 to max1] to [min2 to max2]\\nfloat map(float value, float min1, float max1, float min2, float max2) {\\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\\n}\\n\\nvec2 mapTextureToNormal( vec3 v ){\\n  // x = r sin(phi) cos(theta)   \\n  // y = r cos(phi)  \\n  // z = r sin(phi) sin(theta)\\n  float phi = acos( v.y );\\n  // if phi is 0, then there are no x, z components\\n  float theta = 0.0;\\n  // else \\n  theta = acos(v.x / sin(phi));\\n  float sinTheta = v.z / sin(phi);\\n  if (sinTheta < 0.0) {\\n    // Turn it into -theta, but in the 0-2PI range\\n    theta = 2.0 * PI - theta;\\n  }\\n  theta = theta / (2.0 * 3.14159);\\n  phi = phi / 3.14159 ;\\n  \\n  vec2 angles = vec2( fract(theta + 0.25), 1.0 - phi );\\n  return angles;\\n}\\n\\n\\nvec3 calculateImageDiffuse(vec3 vNormal, vec3 vViewPosition, float metallic){\\n  // make 2 seperate builds \\n  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);  // hardcoded world camera position\\n  vec3 worldNormal = normalize(vNormal * uCameraRotation);\\n  vec2 newTexCoor = mapTextureToNormal( worldNormal );\\n  vec4 texture = TEXTURE( environmentMapDiffused, newTexCoor );\\n  // this is to make the darker sections more dark\\n  // png and jpg usually flatten the brightness so it is to reverse that\\n  return mix(smoothstep(vec3(0.0), vec3(1.0), texture.xyz), vec3(0.0), metallic);\\n}\\n\\nvec3 calculateImageSpecular(vec3 vNormal, vec3 vViewPosition, float shininess, float metallic){\\n  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);\\n  vec3 worldNormal = normalize(vNormal);\\n  vec3 lightDirection = normalize( vViewPosition - worldCameraPosition );\\n  vec3 R = reflect(lightDirection, worldNormal) * uCameraRotation;\\n  vec2 newTexCoor = mapTextureToNormal( R );\\n#ifdef WEBGL2\\n  // In p5js the range of shininess is >= 1,\\n  // Therefore roughness range will be ([0,1]*8)*20 or [0, 160]\\n  // The factor of 8 is because currently the getSpecularTexture\\n  // only calculated 8 different levels of roughness\\n  // The factor of 20 is just to spread up this range so that,\\n  // [1, max] of shininess is converted to [0,160] of roughness\\n  float roughness = 20. / shininess;\\n  vec4 outColor = textureLod(environmentMapSpecular, newTexCoor, roughness * 8.);\\n#else\\n  vec4 outColor = TEXTURE(environmentMapSpecular, newTexCoor);\\n#endif\\n  // this is to make the darker sections more dark\\n  // png and jpg usually flatten the brightness so it is to reverse that\\n  return mix(\\n    pow(outColor.xyz, vec3(10)),\\n    pow(outColor.xyz, vec3(1.2)),\\n    metallic \\n  );\\n}\\n\\nvoid totalLight(\\n  vec3 modelPosition,\\n  vec3 normal,\\n  float shininess,\\n  float metallic,\\n  out vec3 totalDiffuse,\\n  out vec3 totalSpecular\\n) {\\n\\n  totalSpecular = vec3(0.0);\\n\\n  if (!uUseLighting) {\\n    totalDiffuse = vec3(1.0);\\n    return;\\n  }\\n\\n  totalDiffuse = vec3(0.0);\\n\\n  vec3 viewDirection = normalize(-modelPosition);\\n\\n  for (int j = 0; j < 5; j++) {\\n    if (j < uDirectionalLightCount) {\\n      vec3 lightVector = (uViewMatrix * vec4(uLightingDirection[j], 0.0)).xyz;\\n      vec3 lightColor = uDirectionalDiffuseColors[j];\\n      vec3 specularColor = uDirectionalSpecularColors[j];\\n      LightResult result = _light(viewDirection, normal, lightVector, shininess, metallic);\\n      totalDiffuse += result.diffuse * lightColor;\\n      totalSpecular += result.specular * lightColor * specularColor;\\n    }\\n\\n    if (j < uPointLightCount) {\\n      vec3 lightPosition = (uViewMatrix * vec4(uPointLightLocation[j], 1.0)).xyz;\\n      vec3 lightVector = modelPosition - lightPosition;\\n      //calculate attenuation\\n      float lightDistance = length(lightVector);\\n      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);\\n      vec3 lightColor = lightFalloff * uPointLightDiffuseColors[j];\\n      vec3 specularColor = lightFalloff * uPointLightSpecularColors[j];\\n\\n      LightResult result = _light(viewDirection, normal, lightVector, shininess, metallic);\\n      totalDiffuse += result.diffuse * lightColor;\\n      totalSpecular += result.specular * lightColor * specularColor;\\n    }\\n\\n    if(j < uSpotLightCount) {\\n      vec3 lightPosition = (uViewMatrix * vec4(uSpotLightLocation[j], 1.0)).xyz;\\n      vec3 lightVector = modelPosition - lightPosition;\\n    \\n      float lightDistance = length(lightVector);\\n      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);\\n\\n      vec3 lightDirection = (uViewMatrix * vec4(uSpotLightDirection[j], 0.0)).xyz;\\n      float spotDot = dot(normalize(lightVector), normalize(lightDirection));\\n      float spotFalloff;\\n      if(spotDot < uSpotLightAngle[j]) {\\n        spotFalloff = 0.0;\\n      }\\n      else {\\n        spotFalloff = pow(spotDot, uSpotLightConc[j]);\\n      }\\n      lightFalloff *= spotFalloff;\\n\\n      vec3 lightColor = uSpotLightDiffuseColors[j];\\n      vec3 specularColor = uSpotLightSpecularColors[j];\\n     \\n      LightResult result = _light(viewDirection, normal, lightVector, shininess, metallic);\\n      \\n      totalDiffuse += result.diffuse * lightColor * lightFalloff;\\n      totalSpecular += result.specular * lightColor * specularColor * lightFalloff;\\n    }\\n  }\\n\\n  if( uUseImageLight ){\\n    totalDiffuse += calculateImageDiffuse(normal, modelPosition, metallic);\\n    totalSpecular += calculateImageSpecular(normal, modelPosition, shininess, metallic);\\n  }\\n\\n  totalDiffuse *= diffuseFactor;\\n  totalSpecular *= specularFactor;\\n}\\n\";\n\nvar webgl2CompatibilityShader = \"#ifdef WEBGL2\\n\\n#define IN in\\n#define OUT out\\n\\n#ifdef FRAGMENT_SHADER\\nout vec4 outColor;\\n#define OUT_COLOR outColor\\n#endif\\n#define TEXTURE texture\\n\\n#else\\n\\n#ifdef FRAGMENT_SHADER\\n#define IN varying\\n#else\\n#define IN attribute\\n#endif\\n#define OUT varying\\n#define TEXTURE texture2D\\n\\n#ifdef FRAGMENT_SHADER\\n#define OUT_COLOR gl_FragColor\\n#endif\\n\\n#endif\\n\\n#ifdef FRAGMENT_SHADER\\nvec4 getTexture(in sampler2D content, vec2 coord) {\\n  vec4 color = TEXTURE(content, coord);\\n  color.rgb /= color.a;\\n  return color;\\n}\\n#endif\\n\";\n\nvar normalVert = \"IN vec3 aPosition;\\nIN vec3 aNormal;\\nIN vec2 aTexCoord;\\nIN vec4 aVertexColor;\\n\\n#define HOOK_DEFINES\\n\\n#ifdef AUGMENTED_HOOK_getWorldInputs\\nuniform mat4 uModelMatrix;\\nuniform mat4 uViewMatrix;\\nuniform mat3 uModelNormalMatrix;\\nuniform mat3 uCameraNormalMatrix;\\n#else\\nuniform mat4 uModelViewMatrix;\\nuniform mat3 uNormalMatrix;\\n#endif\\nuniform mat4 uProjectionMatrix;\\n\\nuniform vec4 uMaterialColor;\\nuniform bool uUseVertexColor;\\n\\nOUT vec3 vVertexNormal;\\nOUT highp vec2 vVertTexCoord;\\nOUT vec4 vColor;\\n\\nstruct Vertex {\\n  vec3 position;\\n  vec3 normal;\\n  vec2 texCoord;\\n  vec4 color;\\n};\\n\\nvoid main(void) {\\n  HOOK_beforeVertex();\\n\\n  Vertex inputs;\\n  inputs.position = aPosition;\\n  inputs.normal = aNormal;\\n  inputs.texCoord = aTexCoord;\\n  inputs.color = (uUseVertexColor && aVertexColor.x >= 0.0) ? aVertexColor : uMaterialColor;\\n#ifdef AUGMENTED_HOOK_getObjectInputs\\n  inputs = HOOK_getObjectInputs(inputs);\\n#endif\\n\\n#ifdef AUGMENTED_HOOK_getWorldInputs\\n  inputs.position = (uModelMatrix * vec4(inputs.position, 1.)).xyz;\\n  inputs.normal = uModelNormalMatrix * inputs.normal;\\n  inputs = HOOK_getWorldInputs(inputs);\\n#endif\\n\\n#ifdef AUGMENTED_HOOK_getWorldInputs\\n  // Already multiplied by the model matrix, just apply view\\n  inputs.position = (uViewMatrix * vec4(inputs.position, 1.)).xyz;\\n  inputs.normal = uCameraNormalMatrix * inputs.normal;\\n#else\\n  // Apply both at once\\n  inputs.position = (uModelViewMatrix * vec4(inputs.position, 1.)).xyz;\\n  inputs.normal = uNormalMatrix * inputs.normal;\\n#endif\\n#ifdef AUGMENTED_HOOK_getCameraInputs\\n  inputs = HOOK_getCameraInputs(inputs);\\n#endif\\n\\n  // Pass varyings to fragment shader\\n  vVertTexCoord = inputs.texCoord;\\n  vVertexNormal = normalize(inputs.normal);\\n  vColor = inputs.color;\\n\\n  gl_Position = uProjectionMatrix * vec4(inputs.position, 1.);\\n\\n  HOOK_afterVertex();\\n}\\n\";\n\nvar normalFrag = \"IN vec3 vVertexNormal;\\nvoid main(void) {\\n  HOOK_beforeFragment();\\n  OUT_COLOR = HOOK_getFinalColor(vec4(vVertexNormal, 1.0));\\n  HOOK_afterFragment();\\n}\\n\";\n\nvar basicFrag = \"IN vec4 vColor;\\nvoid main(void) {\\n  HOOK_beforeFragment();\\n  OUT_COLOR = HOOK_getFinalColor(vec4(vColor.rgb, 1.) * vColor.a);\\n  HOOK_afterFragment();\\n}\\n\";\n\nvar sphereMappingFrag = \"#define PI 3.141592\\n\\nprecision highp float;\\n  \\nuniform sampler2D uEnvMap;\\nuniform mat3 uNewNormalMatrix;\\nuniform float uFovY;\\nuniform float uAspect;\\n\\nvarying vec2 vTexCoord;\\n  \\nvoid main() {\\n    float uFovX = uFovY * uAspect; \\n    float angleY = mix(uFovY/2.0,  -uFovY/2.0, vTexCoord.y);\\n    float angleX = mix(uFovX/2.0, -uFovX/2.0, vTexCoord.x);\\n    vec3 rotatedNormal = vec3( angleX, angleY, 1.0 );\\n    rotatedNormal = uNewNormalMatrix * normalize(rotatedNormal);\\n    float temp = rotatedNormal.z;\\n    rotatedNormal.z = rotatedNormal.x;\\n    rotatedNormal.x = -temp;\\n    vec2 suv;\\n    suv.y = 0.5 + 0.5 * (-rotatedNormal.y);\\n    suv.x = atan(rotatedNormal.z, rotatedNormal.x) / (2.0 * PI) + 0.5;\\n    vec4 newTexColor = texture2D(uEnvMap, suv.xy);\\n    gl_FragColor = newTexColor;\\n}\\n\";\n\nvar lightVert = \"// include lighting.glgl\\n\\nIN vec3 aPosition;\\nIN vec3 aNormal;\\nIN vec2 aTexCoord;\\nIN vec4 aVertexColor;\\n\\nuniform mat4 uModelViewMatrix;\\nuniform mat4 uProjectionMatrix;\\nuniform mat3 uNormalMatrix;\\n\\nuniform bool uUseVertexColor;\\nuniform vec4 uMaterialColor;\\n\\nOUT highp vec2 vVertTexCoord;\\nOUT vec3 vDiffuseColor;\\nOUT vec3 vSpecularColor;\\nOUT vec4 vColor;\\n\\nvoid main(void) {\\n\\n  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);\\n  gl_Position = uProjectionMatrix * viewModelPosition;\\n\\n  vec3 vertexNormal = normalize(uNormalMatrix * aNormal);\\n  vVertTexCoord = aTexCoord;\\n\\n  totalLight(viewModelPosition.xyz, vertexNormal, vDiffuseColor, vSpecularColor);\\n\\n  for (int i = 0; i < 8; i++) {\\n    if (i < uAmbientLightCount) {\\n      vDiffuseColor += uAmbientColor[i];\\n    }\\n  }\\n  \\n  vColor = ((uUseVertexColor && aVertexColor.x >= 0.0) ? aVertexColor : uMaterialColor);\\n}\\n\";\n\nvar lightTextureFrag = \"uniform vec4 uTint;\\nuniform sampler2D uSampler;\\nuniform bool isTexture;\\nuniform bool uEmissive;\\n\\nIN highp vec2 vVertTexCoord;\\nIN vec3 vDiffuseColor;\\nIN vec3 vSpecularColor;\\nIN vec4 vColor;\\n\\nvoid main(void) {\\n  if(uEmissive && !isTexture) {\\n    OUT_COLOR = vColor;\\n  }\\n  else {\\n    vec4 baseColor = isTexture\\n      // Textures come in with premultiplied alpha. To apply tint and still have\\n      // premultiplied alpha output, we need to multiply the RGB channels by the\\n      // tint RGB, and all channels by the tint alpha.\\n      ? TEXTURE(uSampler, vVertTexCoord) * vec4(uTint.rgb/255., 1.) * (uTint.a/255.)\\n      // Colors come in with unmultiplied alpha, so we need to multiply the RGB\\n      // channels by alpha to convert it to premultiplied alpha.\\n      : vec4(vColor.rgb * vColor.a, vColor.a);\\n    OUT_COLOR = vec4(baseColor.rgb * vDiffuseColor + vSpecularColor, baseColor.a);\\n  }\\n}\\n\";\n\nvar phongVert = \"precision highp int;\\n\\n#define HOOK_DEFINES\\n\\nIN vec3 aPosition;\\nIN vec3 aNormal;\\nIN vec2 aTexCoord;\\nIN vec4 aVertexColor;\\n\\nuniform vec3 uAmbientColor[5];\\n\\n#ifdef AUGMENTED_HOOK_getWorldInputs\\nuniform mat4 uModelMatrix;\\nuniform mat4 uViewMatrix;\\nuniform mat3 uModelNormalMatrix;\\nuniform mat3 uCameraNormalMatrix;\\n#else\\nuniform mat4 uModelViewMatrix;\\nuniform mat3 uNormalMatrix;\\n#endif\\nuniform mat4 uProjectionMatrix;\\nuniform int uAmbientLightCount;\\n\\nuniform bool uUseVertexColor;\\nuniform vec4 uMaterialColor;\\n\\nOUT vec3 vNormal;\\nOUT vec2 vTexCoord;\\nOUT vec3 vViewPosition;\\nOUT vec3 vAmbientColor;\\nOUT vec4 vColor;\\n\\nstruct Vertex {\\n  vec3 position;\\n  vec3 normal;\\n  vec2 texCoord;\\n  vec4 color;\\n};\\n\\nvoid main(void) {\\n  HOOK_beforeVertex();\\n\\n  Vertex inputs;\\n  inputs.position = aPosition;\\n  inputs.normal = aNormal;\\n  inputs.texCoord = aTexCoord;\\n  inputs.color = (uUseVertexColor && aVertexColor.x >= 0.0) ? aVertexColor : uMaterialColor;\\n#ifdef AUGMENTED_HOOK_getObjectInputs\\n  inputs = HOOK_getObjectInputs(inputs);\\n#endif\\n\\n#ifdef AUGMENTED_HOOK_getWorldInputs\\n  inputs.position = (uModelMatrix * vec4(inputs.position, 1.)).xyz;\\n  inputs.normal = uModelNormalMatrix * inputs.normal;\\n  inputs = HOOK_getWorldInputs(inputs);\\n#endif\\n\\n#ifdef AUGMENTED_HOOK_getWorldInputs\\n  // Already multiplied by the model matrix, just apply view\\n  inputs.position = (uViewMatrix * vec4(inputs.position, 1.)).xyz;\\n  inputs.normal = uCameraNormalMatrix * inputs.normal;\\n#else\\n  // Apply both at once\\n  inputs.position = (uModelViewMatrix * vec4(inputs.position, 1.)).xyz;\\n  inputs.normal = uNormalMatrix * inputs.normal;\\n#endif\\n#ifdef AUGMENTED_HOOK_getCameraInputs\\n  inputs = HOOK_getCameraInputs(inputs);\\n#endif\\n\\n  // Pass varyings to fragment shader\\n  vViewPosition = inputs.position;\\n  vTexCoord = inputs.texCoord;\\n  vNormal = inputs.normal;\\n  vColor = inputs.color;\\n\\n  // TODO: this should be a uniform\\n  vAmbientColor = vec3(0.0);\\n  for (int i = 0; i < 5; i++) {\\n    if (i < uAmbientLightCount) {\\n      vAmbientColor += uAmbientColor[i];\\n    }\\n  }\\n\\n  gl_Position = uProjectionMatrix * vec4(inputs.position, 1.);\\n  HOOK_afterVertex();\\n}\\n\";\n\nvar phongFrag = \"// include lighting.glsl\\nprecision highp int;\\n\\nuniform bool uHasSetAmbient;\\nuniform vec4 uSpecularMatColor;\\nuniform vec4 uAmbientMatColor;\\nuniform vec4 uEmissiveMatColor;\\n\\nuniform vec4 uTint;\\nuniform sampler2D uSampler;\\nuniform bool isTexture;\\n\\nIN vec3 vNormal;\\nIN vec2 vTexCoord;\\nIN vec3 vViewPosition;\\nIN vec3 vAmbientColor;\\nIN vec4 vColor;\\n\\nstruct ColorComponents {\\n  vec3 baseColor;\\n  float opacity;\\n  vec3 ambientColor;\\n  vec3 specularColor;\\n  vec3 diffuse;\\n  vec3 ambient;\\n  vec3 specular;\\n  vec3 emissive;\\n};\\n\\nstruct Inputs {\\n  vec3 normal;\\n  vec2 texCoord;\\n  vec3 ambientLight;\\n  vec3 ambientMaterial;\\n  vec3 specularMaterial;\\n  vec3 emissiveMaterial;\\n  vec4 color;\\n  float shininess;\\n  float metalness;\\n};\\n\\nvoid main(void) {\\n  HOOK_beforeFragment();\\n\\n  Inputs inputs;\\n  inputs.normal = normalize(vNormal);\\n  inputs.texCoord = vTexCoord;\\n  inputs.ambientLight = vAmbientColor;\\n  inputs.color = isTexture\\n      ? TEXTURE(uSampler, vTexCoord) * (vec4(uTint.rgb/255., 1.) * uTint.a/255.)\\n      : vColor;\\n  if (isTexture && inputs.color.a > 0.0) {\\n    // Textures come in with premultiplied alpha. Temporarily unpremultiply it\\n    // so hooks users don't have to think about premultiplied alpha.\\n    inputs.color.rgb /= inputs.color.a;\\n  }\\n  inputs.shininess = uShininess;\\n  inputs.metalness = uMetallic;\\n  inputs.ambientMaterial = uHasSetAmbient ? uAmbientMatColor.rgb : inputs.color.rgb;\\n  inputs.specularMaterial = uSpecularMatColor.rgb;\\n  inputs.emissiveMaterial = uEmissiveMatColor.rgb;\\n  inputs = HOOK_getPixelInputs(inputs);\\n\\n  vec3 diffuse;\\n  vec3 specular;\\n  totalLight(vViewPosition, inputs.normal, inputs.shininess, inputs.metalness, diffuse, specular);\\n\\n  // Calculating final color as result of all lights (plus emissive term).\\n\\n  vec2 texCoord = inputs.texCoord;\\n  vec4 baseColor = inputs.color;\\n  ColorComponents c;\\n  c.opacity = baseColor.a;\\n  c.baseColor = baseColor.rgb;\\n  c.ambientColor = inputs.ambientMaterial;\\n  c.specularColor = inputs.specularMaterial;\\n  c.diffuse = diffuse;\\n  c.ambient = inputs.ambientLight;\\n  c.specular = specular;\\n  c.emissive = inputs.emissiveMaterial;\\n  OUT_COLOR = HOOK_getFinalColor(HOOK_combineColors(c));\\n  OUT_COLOR.rgb *= OUT_COLOR.a; // Premultiply alpha before rendering\\n  HOOK_afterFragment();\\n}\\n\";\n\nvar fontVert = \"IN vec3 aPosition;\\nIN vec2 aTexCoord;\\nuniform mat4 uModelViewMatrix;\\nuniform mat4 uProjectionMatrix;\\n\\nuniform vec4 uGlyphRect;\\nuniform float uGlyphOffset;\\n\\nOUT vec2 vTexCoord;\\nOUT float w;\\n\\nvoid main() {\\n  vec4 positionVec4 = vec4(aPosition, 1.0);\\n\\n  // scale by the size of the glyph's rectangle\\n  positionVec4.xy *= uGlyphRect.zw - uGlyphRect.xy;\\n\\n  // Expand glyph bounding boxes by 1px on each side to give a bit of room\\n  // for antialiasing\\n  vec3 newOrigin = (uModelViewMatrix * vec4(0., 0., 0., 1.)).xyz;\\n  vec3 newDX = (uModelViewMatrix * vec4(1., 0., 0., 1.)).xyz;\\n  vec3 newDY = (uModelViewMatrix * vec4(0., 1., 0., 1.)).xyz;\\n  vec2 pixelScale = vec2(\\n    1. / length(newOrigin - newDX),\\n    1. / length(newOrigin - newDY)\\n  );\\n  vec2 offset = pixelScale * normalize(aTexCoord - vec2(0.5, 0.5));\\n  vec2 textureOffset = offset * (1. / vec2(\\n    uGlyphRect.z - uGlyphRect.x,\\n    uGlyphRect.w - uGlyphRect.y\\n  ));\\n\\n  // move to the corner of the glyph\\n  positionVec4.xy += uGlyphRect.xy;\\n\\n  // move to the letter's line offset\\n  positionVec4.x += uGlyphOffset;\\n\\n  positionVec4.xy += offset;\\n  \\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\\n  vTexCoord = aTexCoord + textureOffset;\\n  w = gl_Position.w;\\n}\\n\";\n\nvar fontFrag = \"#ifndef WEBGL2\\n#extension GL_OES_standard_derivatives : enable\\n#endif\\n\\n#if 0\\n  // simulate integer math using floats\\n\\t#define int float\\n\\t#define ivec2 vec2\\n\\t#define INT(x) float(x)\\n\\n\\tint ifloor(float v) { return floor(v); }\\n\\tivec2 ifloor(vec2 v) { return floor(v); }\\n\\n#else\\n  // use native integer math\\n\\tprecision highp int;\\n\\t#define INT(x) x\\n\\n\\tint ifloor(float v) { return int(v); }\\n\\tint ifloor(int v) { return v; }\\n\\tivec2 ifloor(vec2 v) { return ivec2(v); }\\n\\n#endif\\n\\nuniform sampler2D uSamplerStrokes;\\nuniform sampler2D uSamplerRowStrokes;\\nuniform sampler2D uSamplerRows;\\nuniform sampler2D uSamplerColStrokes;\\nuniform sampler2D uSamplerCols;\\n\\nuniform ivec2 uStrokeImageSize;\\nuniform ivec2 uCellsImageSize;\\nuniform ivec2 uGridImageSize;\\n\\nuniform ivec2 uGridOffset;\\nuniform ivec2 uGridSize;\\nuniform vec4 uMaterialColor;\\n\\nIN vec2 vTexCoord;\\n\\n// some helper functions\\nint ROUND(float v) { return ifloor(v + 0.5); }\\nivec2 ROUND(vec2 v) { return ifloor(v + 0.5); }\\nfloat saturate(float v) { return clamp(v, 0.0, 1.0); }\\nvec2 saturate(vec2 v) { return clamp(v, 0.0, 1.0); }\\n\\nint mul(float v1, int v2) {\\n  return ifloor(v1 * float(v2));\\n}\\n\\nivec2 mul(vec2 v1, ivec2 v2) {\\n  return ifloor(v1 * vec2(v2) + 0.5);\\n}\\n\\n// unpack a 16-bit integer from a float vec2\\nint getInt16(vec2 v) {\\n  ivec2 iv = ROUND(v * 255.0);\\n  return iv.x * INT(128) + iv.y;\\n}\\n\\nvec2 pixelScale;\\nvec2 coverage = vec2(0.0);\\nvec2 weight = vec2(0.5);\\nconst float minDistance = 1.0/8192.0;\\nconst float hardness = 1.05; // amount of antialias\\n\\n// the maximum number of curves in a glyph\\nconst int N = INT(250);\\n\\n// retrieves an indexed pixel from a sampler\\nvec4 getTexel(sampler2D sampler, int pos, ivec2 size) {\\n  int width = size.x;\\n  int y = ifloor(pos / width);\\n  int x = pos - y * width;  // pos % width\\n\\n  return TEXTURE(sampler, (vec2(x, y) + 0.5) / vec2(size));\\n}\\n\\nvoid calulateCrossings(vec2 p0, vec2 p1, vec2 p2, out vec2 C1, out vec2 C2) {\\n\\n  // get the coefficients of the quadratic in t\\n  vec2 a = p0 - p1 * 2.0 + p2;\\n  vec2 b = p0 - p1;\\n  vec2 c = p0 - vTexCoord;\\n\\n  // found out which values of 't' it crosses the axes\\n  vec2 surd = sqrt(max(vec2(0.0), b * b - a * c));\\n  vec2 t1 = ((b - surd) / a).yx;\\n  vec2 t2 = ((b + surd) / a).yx;\\n\\n  // approximate straight lines to avoid rounding errors\\n  if (abs(a.y) < 0.001)\\n    t1.x = t2.x = c.y / (2.0 * b.y);\\n\\n  if (abs(a.x) < 0.001)\\n    t1.y = t2.y = c.x / (2.0 * b.x);\\n\\n  // plug into quadratic formula to find the corrdinates of the crossings\\n  C1 = ((a * t1 - b * 2.0) * t1 + c) * pixelScale;\\n  C2 = ((a * t2 - b * 2.0) * t2 + c) * pixelScale;\\n}\\n\\nvoid coverageX(vec2 p0, vec2 p1, vec2 p2) {\\n\\n  vec2 C1, C2;\\n  calulateCrossings(p0, p1, p2, C1, C2);\\n\\n  // determine on which side of the x-axis the points lie\\n  bool y0 = p0.y > vTexCoord.y;\\n  bool y1 = p1.y > vTexCoord.y;\\n  bool y2 = p2.y > vTexCoord.y;\\n\\n  // could web be under the curve (after t1)?\\n  if (y1 ? !y2 : y0) {\\n    // add the coverage for t1\\n    coverage.x += saturate(C1.x + 0.5);\\n    // calculate the anti-aliasing for t1\\n    weight.x = min(weight.x, abs(C1.x));\\n  }\\n\\n  // are we outside the curve (after t2)?\\n  if (y1 ? !y0 : y2) {\\n    // subtract the coverage for t2\\n    coverage.x -= saturate(C2.x + 0.5);\\n    // calculate the anti-aliasing for t2\\n    weight.x = min(weight.x, abs(C2.x));\\n  }\\n}\\n\\n// this is essentially the same as coverageX, but with the axes swapped\\nvoid coverageY(vec2 p0, vec2 p1, vec2 p2) {\\n\\n  vec2 C1, C2;\\n  calulateCrossings(p0, p1, p2, C1, C2);\\n\\n  bool x0 = p0.x > vTexCoord.x;\\n  bool x1 = p1.x > vTexCoord.x;\\n  bool x2 = p2.x > vTexCoord.x;\\n\\n  if (x1 ? !x2 : x0) {\\n    coverage.y -= saturate(C1.y + 0.5);\\n    weight.y = min(weight.y, abs(C1.y));\\n  }\\n\\n  if (x1 ? !x0 : x2) {\\n    coverage.y += saturate(C2.y + 0.5);\\n    weight.y = min(weight.y, abs(C2.y));\\n  }\\n}\\n\\nvoid main() {\\n\\n  // calculate the pixel scale based on screen-coordinates\\n  pixelScale = hardness / fwidth(vTexCoord);\\n\\n  // which grid cell is this pixel in?\\n  ivec2 gridCoord = ifloor(vTexCoord * vec2(uGridSize));\\n\\n  // intersect curves in this row\\n  {\\n    // the index into the row info bitmap\\n    int rowIndex = gridCoord.y + uGridOffset.y;\\n    // fetch the info texel\\n    vec4 rowInfo = getTexel(uSamplerRows, rowIndex, uGridImageSize);\\n    // unpack the rowInfo\\n    int rowStrokeIndex = getInt16(rowInfo.xy);\\n    int rowStrokeCount = getInt16(rowInfo.zw);\\n\\n    for (int iRowStroke = INT(0); iRowStroke < N; iRowStroke++) {\\n      if (iRowStroke >= rowStrokeCount)\\n        break;\\n\\n      // each stroke is made up of 3 points: the start and control point\\n      // and the start of the next curve.\\n      // fetch the indices of this pair of strokes:\\n      vec4 strokeIndices = getTexel(uSamplerRowStrokes, rowStrokeIndex++, uCellsImageSize);\\n\\n      // unpack the stroke index\\n      int strokePos = getInt16(strokeIndices.xy);\\n\\n      // fetch the two strokes\\n      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);\\n      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);\\n\\n      // calculate the coverage\\n      coverageX(stroke0.xy, stroke0.zw, stroke1.xy);\\n    }\\n  }\\n\\n  // intersect curves in this column\\n  {\\n    int colIndex = gridCoord.x + uGridOffset.x;\\n    vec4 colInfo = getTexel(uSamplerCols, colIndex, uGridImageSize);\\n    int colStrokeIndex = getInt16(colInfo.xy);\\n    int colStrokeCount = getInt16(colInfo.zw);\\n    \\n    for (int iColStroke = INT(0); iColStroke < N; iColStroke++) {\\n      if (iColStroke >= colStrokeCount)\\n        break;\\n\\n      vec4 strokeIndices = getTexel(uSamplerColStrokes, colStrokeIndex++, uCellsImageSize);\\n\\n      int strokePos = getInt16(strokeIndices.xy);\\n      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);\\n      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);\\n      coverageY(stroke0.xy, stroke0.zw, stroke1.xy);\\n    }\\n  }\\n\\n  weight = saturate(1.0 - weight * 2.0);\\n  float distance = max(weight.x + weight.y, minDistance); // manhattan approx.\\n  float antialias = abs(dot(coverage, weight) / distance);\\n  float cover = min(abs(coverage.x), abs(coverage.y));\\n  OUT_COLOR = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;\\n  OUT_COLOR *= saturate(max(antialias, cover));\\n}\\n\";\n\nvar lineVert = \"/*\\n  Part of the Processing project - http://processing.org\\n  Copyright (c) 2012-15 The Processing Foundation\\n  Copyright (c) 2004-12 Ben Fry and Casey Reas\\n  Copyright (c) 2001-04 Massachusetts Institute of Technology\\n  This library is free software; you can redistribute it and/or\\n  modify it under the terms of the GNU Lesser General Public\\n  License as published by the Free Software Foundation, version 2.1.\\n  This library is distributed in the hope that it will be useful,\\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\\n  Lesser General Public License for more details.\\n  You should have received a copy of the GNU Lesser General\\n  Public License along with this library; if not, write to the\\n  Free Software Foundation, Inc., 59 Temple Place, Suite 330,\\n  Boston, MA  02111-1307  USA\\n*/\\n\\n#define PROCESSING_LINE_SHADER\\n\\n#define HOOK_DEFINES\\n\\nprecision highp int;\\nprecision highp float;\\n\\n#ifdef AUGMENTED_HOOK_getWorldInputs\\nuniform mat4 uModelMatrix;\\nuniform mat4 uViewMatrix;\\n#else\\nuniform mat4 uModelViewMatrix;\\n#endif\\n\\nuniform mat4 uProjectionMatrix;\\nuniform float uStrokeWeight;\\n\\nuniform bool uUseLineColor;\\nuniform bool uSimpleLines;\\nuniform vec4 uMaterialColor;\\n\\nuniform vec4 uViewport;\\nuniform int uPerspective;\\nuniform int uStrokeJoin;\\n\\nIN vec3 aPosition;\\nIN vec3 aTangentIn;\\nIN vec3 aTangentOut;\\nIN float aSide;\\nIN vec4 aVertexColor;\\n\\nOUT vec4 vColor;\\nOUT vec2 vTangent;\\nOUT vec2 vCenter;\\nOUT vec2 vPosition;\\nOUT float vMaxDist;\\nOUT float vCap;\\nOUT float vJoin;\\nOUT float vStrokeWeight;\\n\\nvec2 lineIntersection(vec2 aPoint, vec2 aDir, vec2 bPoint, vec2 bDir) {\\n  // Rotate and translate so a starts at the origin and goes out to the right\\n  bPoint -= aPoint;\\n  vec2 rotatedBFrom = vec2(\\n    bPoint.x*aDir.x + bPoint.y*aDir.y,\\n    bPoint.y*aDir.x - bPoint.x*aDir.y\\n  );\\n  vec2 bTo = bPoint + bDir;\\n  vec2 rotatedBTo = vec2(\\n    bTo.x*aDir.x + bTo.y*aDir.y,\\n    bTo.y*aDir.x - bTo.x*aDir.y\\n  );\\n  float intersectionDistance =\\n    rotatedBTo.x + (rotatedBFrom.x - rotatedBTo.x) * rotatedBTo.y /\\n    (rotatedBTo.y - rotatedBFrom.y);\\n  return aPoint + aDir * intersectionDistance;\\n}\\n\\nstruct StrokeVertex {\\n  vec3 position;\\n  vec3 tangentIn;\\n  vec3 tangentOut;\\n  vec4 color;\\n  float weight;\\n};\\n\\nvoid main() {\\n  HOOK_beforeVertex();\\n\\n  if (!uSimpleLines) {\\n      // Caps have one of either the in or out tangent set to 0\\n      vCap = (aTangentIn == vec3(0.)) != (aTangentOut == vec3(0.)) ? 1. : 0.;\\n\\n      // Joins have two unique, defined tangents\\n      vJoin = (\\n          aTangentIn != vec3(0.) &&\\n          aTangentOut != vec3(0.) &&\\n          aTangentIn != aTangentOut\\n      ) ? 1. : 0.;\\n  }\\n\\n  StrokeVertex inputs;\\n  inputs.position = aPosition.xyz;\\n  inputs.color = uUseLineColor ? aVertexColor : uMaterialColor;\\n  inputs.weight = uStrokeWeight;\\n  inputs.tangentIn = aTangentIn;\\n  inputs.tangentOut = aTangentOut;\\n\\n#ifdef AUGMENTED_HOOK_getObjectInputs\\n  inputs = HOOK_getObjectInputs(inputs);\\n#endif\\n\\n#ifdef AUGMENTED_HOOK_getWorldInputs\\n  inputs.position = (uModelMatrix * vec4(inputs.position, 1.)).xyz;\\n  inputs.tangentIn = (uModelMatrix * vec4(aTangentIn, 0.)).xyz;\\n  inputs.tangentOut = (uModelMatrix * vec4(aTangentOut, 0.)).xyz;\\n  inputs = HOOK_getWorldInputs(inputs);\\n#endif\\n\\n#ifdef AUGMENTED_HOOK_getWorldInputs\\n  // Already multiplied by the model matrix, just apply view\\n  inputs.position = (uViewMatrix * vec4(inputs.position, 1.)).xyz;\\n  inputs.tangentIn = (uViewMatrix * vec4(aTangentIn, 0.)).xyz;\\n  inputs.tangentOut = (uViewMatrix * vec4(aTangentOut, 0.)).xyz;\\n#else\\n  // Apply both at once\\n  inputs.position = (uModelViewMatrix * vec4(inputs.position, 1.)).xyz;\\n  inputs.tangentIn = (uModelViewMatrix * vec4(aTangentIn, 0.)).xyz;\\n  inputs.tangentOut = (uModelViewMatrix * vec4(aTangentOut, 0.)).xyz;\\n#endif\\n#ifdef AUGMENTED_HOOK_getCameraInputs\\n  inputs = hook_getCameraInputs(inputs);\\n#endif\\n\\n  vec4 posp = vec4(inputs.position, 1.);\\n  vec4 posqIn = vec4(inputs.position + inputs.tangentIn, 1.);\\n  vec4 posqOut = vec4(inputs.position + inputs.tangentOut, 1.);\\n  vStrokeWeight = inputs.weight;\\n\\n  float facingCamera = pow(\\n    // The word space tangent's z value is 0 if it's facing the camera\\n    abs(normalize(posqIn-posp).z),\\n\\n    // Using pow() here to ramp `facingCamera` up from 0 to 1 really quickly\\n    // so most lines get scaled and don't get clipped\\n    0.25\\n  );\\n\\n  // Moving vertices slightly toward the camera\\n  // to avoid depth-fighting with the fill triangles.\\n  // A mix of scaling and offsetting is used based on distance\\n  // Discussion here:\\n  // https://github.com/processing/p5.js/issues/7200 \\n\\n  // using a scale <1 moves the lines towards nearby camera\\n  // in order to prevent popping effects due to half of\\n  // the line disappearing behind the geometry faces.\\n  float zDistance = -posp.z; \\n  float distanceFactor = smoothstep(0.0, 800.0, zDistance); \\n  \\n  // Discussed here:\\n  // http://www.opengl.org/discussion_boards/ubbthreads.php?ubb=showflat&Number=252848  \\n  float scale = mix(1., 0.995, facingCamera);\\n  float dynamicScale = mix(scale, 1.0, distanceFactor); // Closer = more scale, farther = less\\n\\n  posp.xyz = posp.xyz * dynamicScale;\\n  posqIn.xyz = posqIn.xyz * dynamicScale;\\n  posqOut.xyz = posqOut.xyz * dynamicScale;\\n\\n  // Moving vertices slightly toward camera when far away \\n  // https://github.com/processing/p5.js/issues/6956 \\n  float zOffset = mix(0., -1., facingCamera);\\n  float dynamicZAdjustment = mix(0.0, zOffset, distanceFactor); // Closer = less zAdjustment, farther = more\\n\\n  posp.z -= dynamicZAdjustment;\\n  posqIn.z -= dynamicZAdjustment;\\n  posqOut.z -= dynamicZAdjustment;\\n  \\n  vec4 p = uProjectionMatrix * posp;\\n  vec4 qIn = uProjectionMatrix * posqIn;\\n  vec4 qOut = uProjectionMatrix * posqOut;\\n\\n  // formula to convert from clip space (range -1..1) to screen space (range 0..[width or height])\\n  // screen_p = (p.xy/p.w + <1,1>) * 0.5 * uViewport.zw\\n\\n  // prevent division by W by transforming the tangent formula (div by 0 causes\\n  // the line to disappear, see https://github.com/processing/processing/issues/5183)\\n  // t = screen_q - screen_p\\n  //\\n  // tangent is normalized and we don't care which aDirection it points to (+-)\\n  // t = +- normalize( screen_q - screen_p )\\n  // t = +- normalize( (q.xy/q.w+<1,1>)*0.5*uViewport.zw - (p.xy/p.w+<1,1>)*0.5*uViewport.zw )\\n  //\\n  // extract common factor, <1,1> - <1,1> cancels out\\n  // t = +- normalize( (q.xy/q.w - p.xy/p.w) * 0.5 * uViewport.zw )\\n  //\\n  // convert to common divisor\\n  // t = +- normalize( ((q.xy*p.w - p.xy*q.w) / (p.w*q.w)) * 0.5 * uViewport.zw )\\n  //\\n  // remove the common scalar divisor/factor, not needed due to normalize and +-\\n  // (keep uViewport - can't remove because it has different components for x and y\\n  //  and corrects for aspect ratio, see https://github.com/processing/processing/issues/5181)\\n  // t = +- normalize( (q.xy*p.w - p.xy*q.w) * uViewport.zw )\\n\\n  vec2 tangentIn = normalize((qIn.xy*p.w - p.xy*qIn.w) * uViewport.zw);\\n  vec2 tangentOut = normalize((qOut.xy*p.w - p.xy*qOut.w) * uViewport.zw);\\n\\n  vec2 curPerspScale;\\n  if(uPerspective == 1) {\\n    // Perspective ---\\n    // convert from world to clip by multiplying with projection scaling factor\\n    // to get the right thickness (see https://github.com/processing/processing/issues/5182)\\n\\n    // The y value of the projection matrix may be flipped if rendering to a Framebuffer.\\n    // Multiplying again by its sign here negates the flip to get just the scale.\\n    curPerspScale = (uProjectionMatrix * vec4(1, sign(uProjectionMatrix[1][1]), 0, 0)).xy;\\n  } else {\\n    // No Perspective ---\\n    // multiply by W (to cancel out division by W later in the pipeline) and\\n    // convert from screen to clip (derived from clip to screen above)\\n    curPerspScale = p.w / (0.5 * uViewport.zw);\\n  }\\n\\n  vec2 offset;\\n  if (vJoin == 1. && !uSimpleLines) {\\n    vTangent = normalize(tangentIn + tangentOut);\\n    vec2 normalIn = vec2(-tangentIn.y, tangentIn.x);\\n    vec2 normalOut = vec2(-tangentOut.y, tangentOut.x);\\n    float side = sign(aSide);\\n    float sideEnum = abs(aSide);\\n\\n    // We generate vertices for joins on either side of the centerline, but\\n    // the \\\"elbow\\\" side is the only one needing a join. By not setting the\\n    // offset for the other side, all its vertices will end up in the same\\n    // spot and not render, effectively discarding it.\\n    if (sign(dot(tangentOut, vec2(-tangentIn.y, tangentIn.x))) != side) {\\n      // Side enums:\\n      //   1: the side going into the join\\n      //   2: the middle of the join\\n      //   3: the side going out of the join\\n      if (sideEnum == 2.) {\\n        // Calculate the position + tangent on either side of the join, and\\n        // find where the lines intersect to find the elbow of the join\\n        vec2 c = (posp.xy/posp.w + vec2(1.,1.)) * 0.5 * uViewport.zw;\\n        vec2 intersection = lineIntersection(\\n          c + (side * normalIn * inputs.weight / 2.),\\n          tangentIn,\\n          c + (side * normalOut * inputs.weight / 2.),\\n          tangentOut\\n        );\\n        offset = (intersection - c);\\n\\n        // When lines are thick and the angle of the join approaches 180, the\\n        // elbow might be really far from the center. We'll apply a limit to\\n        // the magnitude to avoid lines going across the whole screen when this\\n        // happens.\\n        float mag = length(offset);\\n        float maxMag = 3. * inputs.weight;\\n        if (mag > maxMag) {\\n          offset *= maxMag / mag;\\n        }\\n      } else if (sideEnum == 1.) {\\n        offset = side * normalIn * inputs.weight / 2.;\\n      } else if (sideEnum == 3.) {\\n        offset = side * normalOut * inputs.weight / 2.;\\n      }\\n    }\\n    if (uStrokeJoin == STROKE_JOIN_BEVEL) {\\n      vec2 avgNormal = vec2(-vTangent.y, vTangent.x);\\n      vMaxDist = abs(dot(avgNormal, normalIn * inputs.weight / 2.));\\n    } else {\\n      vMaxDist = inputs.weight / 2.;\\n    }\\n  } else {\\n    vec2 tangent = aTangentIn == vec3(0.) ? tangentOut : tangentIn;\\n    vTangent = tangent;\\n    vec2 normal = vec2(-tangent.y, tangent.x);\\n\\n    float normalOffset = sign(aSide);\\n    // Caps will have side values of -2 or 2 on the edge of the cap that\\n    // extends out from the line\\n    float tangentOffset = abs(aSide) - 1.;\\n    offset = (normal * normalOffset + tangent * tangentOffset) *\\n      inputs.weight * 0.5;\\n    vMaxDist = inputs.weight / 2.;\\n  }\\n\\n  vCenter = p.xy;\\n  vPosition = vCenter + offset;\\n  vColor = inputs.color;\\n\\n  gl_Position.xy = p.xy + offset.xy * curPerspScale;\\n  gl_Position.zw = p.zw;\\n  \\n  HOOK_afterVertex();\\n}\\n\";\n\nvar lineFrag = \"precision highp int;\\nprecision highp float;\\n\\nuniform vec4 uMaterialColor;\\nuniform int uStrokeCap;\\nuniform int uStrokeJoin;\\n\\nIN vec4 vColor;\\nIN vec2 vTangent;\\nIN vec2 vCenter;\\nIN vec2 vPosition;\\nIN float vStrokeWeight;\\nIN float vMaxDist;\\nIN float vCap;\\nIN float vJoin;\\n\\nfloat distSquared(vec2 a, vec2 b) {\\n  vec2 aToB = b - a;\\n  return dot(aToB, aToB);\\n}\\n\\nstruct Inputs {\\n  vec4 color;\\n  vec2 tangent;\\n  vec2 center;\\n  vec2 position;\\n  float strokeWeight;\\n};\\n\\nvoid main() {\\n  HOOK_beforeFragment();\\n\\n  Inputs inputs;\\n  inputs.color = vColor;\\n  inputs.tangent = vTangent;\\n  inputs.center = vCenter;\\n  inputs.position = vPosition;\\n  inputs.strokeWeight = vStrokeWeight;\\n  inputs = HOOK_getPixelInputs(inputs);\\n\\n  if (vCap > 0.) {\\n    if (\\n      uStrokeCap == STROKE_CAP_ROUND &&\\n      HOOK_shouldDiscard(distSquared(inputs.position, inputs.center) > inputs.strokeWeight * inputs.strokeWeight * 0.25)\\n    ) {\\n      discard;\\n    } else if (\\n      uStrokeCap == STROKE_CAP_SQUARE &&\\n      HOOK_shouldDiscard(dot(inputs.position - inputs.center, inputs.tangent) > 0.)\\n    ) {\\n      discard;\\n    // Use full area for PROJECT\\n    } else if (HOOK_shouldDiscard(false)) {\\n      discard;\\n    }\\n  } else if (vJoin > 0.) {\\n    if (\\n      uStrokeJoin == STROKE_JOIN_ROUND &&\\n      HOOK_shouldDiscard(distSquared(inputs.position, inputs.center) > inputs.strokeWeight * inputs.strokeWeight * 0.25)\\n    ) {\\n      discard;\\n    } else if (uStrokeJoin == STROKE_JOIN_BEVEL) {\\n      vec2 normal = vec2(-inputs.tangent.y, inputs.tangent.x);\\n      if (HOOK_shouldDiscard(abs(dot(inputs.position - inputs.center, normal)) > vMaxDist)) {\\n        discard;\\n      }\\n    // Use full area for MITER\\n    } else if (HOOK_shouldDiscard(false)) {\\n      discard;\\n    }\\n  }\\n  OUT_COLOR = HOOK_getFinalColor(vec4(inputs.color.rgb, 1.) * inputs.color.a);\\n  HOOK_afterFragment();\\n}\\n\";\n\nvar pointVert = \"IN vec3 aPosition;\\nuniform float uPointSize;\\nOUT float vStrokeWeight;\\nuniform mat4 uModelViewMatrix;\\nuniform mat4 uProjectionMatrix;\\n\\nvoid main() {\\n  HOOK_beforeVertex();\\n  vec4 viewModelPosition = vec4(HOOK_getWorldPosition(\\n    (uModelViewMatrix * vec4(HOOK_getLocalPosition(aPosition), 1.0)).xyz\\n  ), 1.);\\n  gl_Position = uProjectionMatrix * viewModelPosition;  \\n\\n  float pointSize = HOOK_getPointSize(uPointSize);\\n\\n\\tgl_PointSize = pointSize;\\n\\tvStrokeWeight = pointSize;\\n  HOOK_afterVertex();\\n}\\n\";\n\nvar pointFrag = \"precision mediump int;\\nuniform vec4 uMaterialColor;\\nIN float vStrokeWeight;\\n\\nvoid main(){\\n  HOOK_beforeFragment();\\n  float mask = 0.0;\\n\\n  // make a circular mask using the gl_PointCoord (goes from 0 - 1 on a point)\\n  // might be able to get a nicer edge on big strokeweights with smoothstep but slightly less performant\\n\\n  mask = step(0.98, length(gl_PointCoord * 2.0 - 1.0));\\n\\n  // if strokeWeight is 1 or less lets just draw a square\\n  // this prevents weird artifacting from carving circles when our points are really small\\n  // if strokeWeight is larger than 1, we just use it as is\\n\\n  mask = mix(0.0, mask, clamp(floor(vStrokeWeight - 0.5),0.0,1.0));\\n\\n  // throw away the borders of the mask\\n  // otherwise we get weird alpha blending issues\\n\\n  if(HOOK_shouldDiscard(mask > 0.98)){\\n    discard;\\n  }\\n\\n  OUT_COLOR = HOOK_getFinalColor(vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a);\\n  HOOK_afterFragment();\\n}\\n\";\n\nvar imageLightVert = \"precision highp float;\\nattribute vec3 aPosition;\\nattribute vec3 aNormal;\\nattribute vec2 aTexCoord;\\n\\nvarying vec3 localPos;\\nvarying vec3 vWorldNormal;\\nvarying vec3 vWorldPosition;\\nvarying vec2 vTexCoord;\\n\\nuniform mat4 uModelViewMatrix;\\nuniform mat4 uProjectionMatrix;\\nuniform mat3 uNormalMatrix;\\n\\nvoid main() {\\n  // Multiply the position by the matrix.\\n  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);\\n  gl_Position = uProjectionMatrix * viewModelPosition;  \\n  \\n  // orient the normals and pass to the fragment shader\\n  vWorldNormal = uNormalMatrix * aNormal;\\n  \\n  // send the view position to the fragment shader\\n  vWorldPosition = (uModelViewMatrix * vec4(aPosition, 1.0)).xyz;\\n  \\n  localPos = vWorldPosition;\\n  vTexCoord = aTexCoord;\\n}\\n\\n\\n/*\\nin the vertex shader we'll compute the world position and world oriented normal of the vertices and pass those to the fragment shader as varyings.\\n*/\\n\";\n\nvar imageLightDiffusedFrag = \"precision highp float;\\nvarying vec3 localPos;\\n\\n// the HDR cubemap converted (can be from an equirectangular environment map.)\\nuniform sampler2D environmentMap;\\nvarying vec2 vTexCoord;\\n\\nconst float PI = 3.14159265359;\\n\\nvec2 nTOE( vec3 v ){\\n  // x = r sin(phi) cos(theta)   \\n  // y = r cos(phi)  \\n  // z = r sin(phi) sin(theta)\\n  float phi = acos( v.y );\\n  // if phi is 0, then there are no x, z components\\n  float theta = 0.0;\\n  // else \\n  theta = acos(v.x / sin(phi));\\n  float sinTheta = v.z / sin(phi);\\n  if (sinTheta < 0.0) {\\n    // Turn it into -theta, but in the 0-2PI range\\n    theta = 2.0 * PI - theta;\\n  }\\n  theta = theta / (2.0 * 3.14159);\\n  phi = phi / 3.14159 ;\\n  \\n  vec2 angles = vec2( phi, theta );\\n  return angles;\\n}\\n\\nfloat random(vec2 p) {\\n  vec3 p3  = fract(vec3(p.xyx) * .1031);\\n  p3 += dot(p3, p3.yzx + 33.33);\\n  return fract((p3.x + p3.y) * p3.z);\\n}\\n\\nvoid main()\\n{   \\t \\n\\t// the sample direction equals the hemisphere's orientation\\n  float phi = vTexCoord.x * 2.0 * PI;\\n  float theta = vTexCoord.y * PI;\\n  float x = sin(theta) * cos(phi);\\n  float y = sin(theta) * sin(phi);\\n  float z = cos(theta);\\n  vec3 normal = vec3( x, y, z);\\n\\n\\t// Discretely sampling the hemisphere given the integral's\\n  // spherical coordinates translates to the following fragment code:\\n\\tvec3 irradiance = vec3(0.0);  \\n\\tvec3 up\\t= vec3(0.0, 1.0, 0.0);\\n\\tvec3 right = normalize(cross(up, normal));\\n\\tup = normalize(cross(normal, right));\\n\\n\\t//  We specify a fixed sampleDelta delta value to traverse\\n  // the hemisphere; decreasing or increasing the sample delta\\n  // will increase or decrease the accuracy respectively.\\n\\tconst float sampleDelta = 0.100;\\n\\tfloat nrSamples = 0.0;\\n  float randomOffset = random(gl_FragCoord.xy) * sampleDelta;\\n\\tfor(float rawPhi = 0.0; rawPhi < 2.0 * PI; rawPhi += sampleDelta)\\n\\t{\\n    float phi = rawPhi + randomOffset;\\n    for(float rawTheta = 0.0; rawTheta < ( 0.5 ) * PI; rawTheta += sampleDelta)\\n    {\\n      float theta = rawTheta + randomOffset;\\n      // spherical to cartesian (in tangent space) // tangent space to world // add each sample result to irradiance\\n      float x = sin(theta) * cos(phi);\\n      float y = sin(theta) * sin(phi);\\n      float z = cos(theta);\\n      vec3 tangentSample = vec3( x, y, z);\\n      \\n      vec3 sampleVec = tangentSample.x * right + tangentSample.y * up + tangentSample.z * normal;\\n        irradiance += (texture2D(environmentMap, nTOE(sampleVec)).xyz) * cos(theta) * sin(theta);\\n      nrSamples++;\\n    }\\n\\t}\\n\\t// divide by the total number of samples taken, giving us the average sampled irradiance.\\n\\tirradiance = PI * irradiance * (1.0 / float(nrSamples )) ;\\n  \\n \\n\\tgl_FragColor = vec4(irradiance, 1.0);\\n}\";\n\nvar imageLightSpecularFrag = \"precision highp float;\\r\\nvarying vec3 localPos;\\r\\nvarying vec2 vTexCoord;\\r\\n\\r\\n// our texture\\r\\nuniform sampler2D environmentMap;\\r\\nuniform float roughness;\\r\\n\\r\\nconst float PI = 3.14159265359;\\r\\n\\r\\nfloat VanDerCorput(int bits);\\r\\nvec2 HammersleyNoBitOps(int i, int N);\\r\\nvec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness);\\r\\n\\r\\n\\r\\nvec2 nTOE( vec3 v ){\\r\\n  // x = r sin(phi) cos(theta)   \\r\\n  // y = r cos(phi)  \\r\\n  // z = r sin(phi) sin(theta)\\r\\n  float phi = acos( v.y );\\r\\n  // if phi is 0, then there are no x, z components\\r\\n  float theta = 0.0;\\r\\n  // else \\r\\n  theta = acos(v.x / sin(phi));\\r\\n  float sinTheta = v.z / sin(phi);\\r\\n  if (sinTheta < 0.0) {\\r\\n    // Turn it into -theta, but in the 0-2PI range\\r\\n    theta = 2.0 * PI - theta;\\r\\n  }\\r\\n  theta = theta / (2.0 * 3.14159);\\r\\n  phi = phi / 3.14159 ;\\r\\n  \\r\\n  vec2 angles = vec2( phi, theta );\\r\\n  return angles;\\r\\n}\\r\\n\\r\\n\\r\\nvoid main(){\\r\\n  const int SAMPLE_COUNT = 400; // 4096\\r\\n  int lowRoughnessLimit = int(pow(2.0,(roughness+0.1)*20.0));\\r\\n  float totalWeight = 0.0;\\r\\n  vec3 prefilteredColor = vec3(0.0);\\r\\n  float phi = vTexCoord.x * 2.0 * PI;\\r\\n  float theta = vTexCoord.y * PI;\\r\\n  float x = sin(theta) * cos(phi);\\r\\n  float y = sin(theta) * sin(phi);\\r\\n  float z = cos(theta);\\r\\n  vec3 N = vec3(x,y,z);\\r\\n  vec3 V = N;\\r\\n  for (int i = 0; i < SAMPLE_COUNT; ++i)\\r\\n  {\\r\\n    // break at smaller sample numbers for low roughness levels\\r\\n    if(i == lowRoughnessLimit)\\r\\n    {\\r\\n      break;\\r\\n    }\\r\\n    vec2 Xi = HammersleyNoBitOps(i, SAMPLE_COUNT);\\r\\n    vec3 H = ImportanceSampleGGX(Xi, N, roughness);\\r\\n    vec3 L = normalize(2.0 * dot(V, H) * H - V);\\r\\n\\r\\n    float NdotL = max(dot(N, L), 0.0);\\r\\n    if (NdotL > 0.0)\\r\\n    {\\r\\n      prefilteredColor += texture2D(environmentMap, nTOE(L)).xyz * NdotL;\\r\\n      totalWeight += NdotL;\\r\\n    }\\r\\n  }\\r\\n  prefilteredColor = prefilteredColor / totalWeight;\\r\\n\\r\\n  gl_FragColor = vec4(prefilteredColor, 1.0);\\r\\n}\\r\\n\\r\\nvec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness){\\r\\n  float a = roughness * roughness;\\r\\n\\r\\n  float phi = 2.0 * PI * Xi.x;\\r\\n  float cosTheta = sqrt((1.0 - Xi.y) / (1.0 + (a * a - 1.0) * Xi.y));\\r\\n  float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\\r\\n  // from spherical coordinates to cartesian coordinates\\r\\n  vec3 H;\\r\\n  H.x = cos(phi) * sinTheta;\\r\\n  H.y = sin(phi) * sinTheta;\\r\\n  H.z = cosTheta;\\r\\n\\r\\n  // from tangent-space vector to world-space sample vector\\r\\n  vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\\r\\n  vec3 tangent = normalize(cross(up, N));\\r\\n  vec3 bitangent = cross(N, tangent);\\r\\n\\r\\n  vec3 sampleVec = tangent * H.x + bitangent * H.y + N * H.z;\\r\\n  return normalize(sampleVec);\\r\\n}\\r\\n\\r\\n\\r\\nfloat VanDerCorput(int n, int base)\\r\\n{\\r\\n#ifdef WEBGL2\\r\\n\\r\\n    uint bits = uint(n);\\r\\n    bits = (bits << 16u) | (bits >> 16u);\\r\\n    bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\\r\\n    bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\\r\\n    bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\\r\\n    bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\\r\\n    return float(bits) * 2.3283064365386963e-10; // / 0x100000000\\r\\n\\r\\n#else\\r\\n\\r\\n  float invBase = 1.0 / float(base);\\r\\n  float denom = 1.0;\\r\\n  float result = 0.0;\\r\\n\\r\\n\\r\\n  for (int i = 0; i < 32; ++i)\\r\\n  {\\r\\n        if (n > 0)\\r\\n        {\\r\\n        denom = mod(float(n), 2.0);\\r\\n        result += denom * invBase;\\r\\n        invBase = invBase / 2.0;\\r\\n        n = int(float(n) / 2.0);\\r\\n        }\\r\\n  }\\r\\n\\r\\n\\r\\n  return result;\\r\\n\\r\\n#endif\\r\\n}\\r\\n\\r\\nvec2 HammersleyNoBitOps(int i, int N)\\r\\n{\\r\\n  return vec2(float(i) / float(N), VanDerCorput(i, 2));\\r\\n}\\r\\n\";\n\nvar filterBaseFrag = \"precision highp float;\\n\\nuniform sampler2D tex0;\\nuniform vec2 canvasSize;\\nuniform vec2 texelSize;\\n\\nIN vec2 vTexCoord;\\n\\nstruct FilterInputs {\\n  vec2 texCoord;\\n  vec2 canvasSize;\\n  vec2 texelSize;\\n};\\n\\nvoid main(void) {\\n  FilterInputs inputs;\\n  inputs.texCoord = vTexCoord;\\n  inputs.canvasSize = canvasSize;\\n  inputs.texelSize = texelSize;\\n  OUT_COLOR = HOOK_getColor(inputs, tex0);\\n  OUT_COLOR.rgb *= outColor.a;\\n}\\n\";\n\nvar filterGrayFrag = \"precision highp float;\\n\\nvarying vec2 vTexCoord;\\n\\nuniform sampler2D tex0;\\n\\nfloat luma(vec3 color) {\\n  // weighted grayscale with luminance values\\n  return dot(color, vec3(0.2126, 0.7152, 0.0722));\\n}\\n\\nvoid main() {\\n  vec4 tex = texture2D(tex0, vTexCoord);\\n  float gray = luma(tex.rgb);\\n  gl_FragColor = vec4(gray, gray, gray, tex.a);\\n}\\n\";\n\nvar filterErodeFrag = \"// Reduces the bright areas in an image\\n\\nprecision highp float;\\n\\nvarying vec2 vTexCoord;\\n\\nuniform sampler2D tex0;\\nuniform vec2 texelSize;\\n\\nfloat luma(vec3 color) {\\n  // weighted grayscale with luminance values\\n  // weights 77, 151, 28 taken from src/image/filters.js\\n  return dot(color, vec3(0.300781, 0.589844, 0.109375));\\n}\\n\\nvoid main() {\\n  vec4 color = texture2D(tex0, vTexCoord);\\n  float lum = luma(color.rgb);\\n\\n  // set current color as the darkest neighbor color\\n\\n  vec4 neighbors[4];\\n  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));\\n  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));\\n  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));\\n  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));\\n\\n  for (int i = 0; i < 4; i++) {\\n    vec4 neighborColor = neighbors[i];\\n    float neighborLum = luma(neighborColor.rgb);\\n\\n    if (neighborLum < lum) {\\n      color = neighborColor;\\n      lum = neighborLum;\\n    }\\n  }\\n\\n  gl_FragColor = color;\\n}\\n\";\n\nvar filterDilateFrag = \"// Increase the bright areas in an image\\n\\nprecision highp float;\\n\\nvarying vec2 vTexCoord;\\n\\nuniform sampler2D tex0;\\nuniform vec2 texelSize;\\n\\nfloat luma(vec3 color) {\\n  // weighted grayscale with luminance values\\n  // weights 77, 151, 28 taken from src/image/filters.js\\n  return dot(color, vec3(0.300781, 0.589844, 0.109375));\\n}\\n\\nvoid main() {\\n  vec4 color = texture2D(tex0, vTexCoord);\\n  float lum = luma(color.rgb);\\n\\n  // set current color as the brightest neighbor color\\n\\n  vec4 neighbors[4];\\n  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));\\n  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));\\n  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));\\n  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));\\n\\n  for (int i = 0; i < 4; i++) {\\n    vec4 neighborColor = neighbors[i];\\n    float neighborLum = luma(neighborColor.rgb);\\n\\n    if (neighborLum > lum) {\\n      color = neighborColor;\\n      lum = neighborLum;\\n    }\\n  }\\n\\n  gl_FragColor = color;\\n}\\n\";\n\nvar filterBlurFrag = \"precision highp float;\\n\\n// Two-pass blur filter, unweighted kernel.\\n// See also a similar blur at Adam Ferriss' repo of shader examples:\\n// https://github.com/aferriss/p5jsShaderExamples/blob/gh-pages/4_image-effects/4-9_single-pass-blur/effect.frag\\n\\n\\nuniform sampler2D tex0;\\nvarying vec2 vTexCoord;\\nuniform vec2 direction;\\nuniform vec2 canvasSize;\\nuniform float radius;\\n\\nfloat random(vec2 p) {\\n  vec3 p3  = fract(vec3(p.xyx) * .1031);\\n  p3 += dot(p3, p3.yzx + 33.33);\\n  return fract((p3.x + p3.y) * p3.z);\\n}\\n\\n// This isn't a real Gaussian weight, it's a quadratic weight. It's what the\\n// CPU mode's blur uses though, so we also use it here to match.\\nfloat quadWeight(float x, float e) {\\n  return pow(e-abs(x), 2.);\\n}\\n\\nvoid main(){\\n  vec2 uv = vTexCoord;\\n\\n  // A reasonable maximum number of samples\\n  const float maxSamples = 64.0;\\n\\n  float numSamples = floor(7. * radius);\\n  if (fract(numSamples / 2.) == 0.) {\\n    numSamples++;\\n  }\\n  vec4 avg = vec4(0.0);\\n  float total = 0.0;\\n\\n  // Calculate the spacing to avoid skewing if numSamples > maxSamples\\n  float spacing = 1.0;\\n  if (numSamples > maxSamples) {\\n    spacing = numSamples / maxSamples;\\n    numSamples = maxSamples;\\n  }\\n\\n  float randomOffset = (spacing - 1.0) * mix(-0.5, 0.5, random(gl_FragCoord.xy));\\n  for (float i = 0.0; i < maxSamples; i++) {\\n    if (i >= numSamples) break;\\n\\n    float sample = i * spacing - (numSamples - 1.0) * 0.5 * spacing + randomOffset;\\n    vec2 sampleCoord = uv + vec2(sample, sample) / canvasSize * direction;\\n    float weight = quadWeight(sample, (numSamples - 1.0) * 0.5 * spacing);\\n\\n    avg += weight * texture2D(tex0, sampleCoord);\\n    total += weight;\\n  }\\n\\n  avg /= total;\\n  gl_FragColor = avg;\\n}\\n\";\n\nvar filterPosterizeFrag = \"// Limit color space for a stylized cartoon / poster effect\\n\\nprecision highp float;\\n\\nvarying vec2 vTexCoord;\\n\\nuniform sampler2D tex0;\\nuniform float filterParameter;\\n\\nvec3 quantize(vec3 color, float n) {\\n  // restrict values to N options/bins\\n  // and floor each channel to nearest value\\n  //\\n  // eg. when N = 5, values = 0.0, 0.25, 0.50, 0.75, 1.0\\n  // then quantize (0.1, 0.7, 0.9) -> (0.0, 0.5, 1.0)\\n\\n  color = color * n;\\n  color = floor(color);\\n  color = color / (n - 1.0);\\n  return color;\\n}\\n\\nvoid main() {\\n  vec4 color = texture2D(tex0, vTexCoord);\\n\\n  vec3 restrictedColor = quantize(color.rgb / color.a, filterParameter);\\n\\n  gl_FragColor = vec4(restrictedColor.rgb * color.a, color.a);\\n}\\n\";\n\nvar filterOpaqueFrag = \"// Set alpha channel to entirely opaque\\n\\nprecision highp float;\\n\\nvarying vec2 vTexCoord;\\n\\nuniform sampler2D tex0;\\n\\nvoid main() {\\n  vec4 color = texture2D(tex0, vTexCoord);\\n  gl_FragColor = vec4(color.rgb / color.a, 1.0);\\n}\\n\";\n\nvar filterInvertFrag = \"// Set each pixel to inverse value\\n// Note that original INVERT does not change the opacity, so this follows suit\\n\\nprecision highp float;\\n\\nvarying vec2 vTexCoord;\\n\\nuniform sampler2D tex0;\\n\\nvoid main() {\\nvec4 color = texture2D(tex0, vTexCoord);\\nvec3 origColor = color.rgb / color.a;\\nvec3 invertedColor = vec3(1.0) - origColor;\\ngl_FragColor = vec4(invertedColor * color.a, color.a);\\n}\\n\";\n\nvar filterThresholdFrag = \"// Convert pixels to either white or black, \\n// depending on if their luma is above or below filterParameter\\n\\nprecision highp float;\\n\\nvarying vec2 vTexCoord;\\n\\nuniform sampler2D tex0;\\nuniform float filterParameter;\\n\\nfloat luma(vec3 color) {\\n  // weighted grayscale with luminance values\\n  return dot(color, vec3(0.2126, 0.7152, 0.0722));\\n}\\n\\nvoid main() {\\n  vec4 color = texture2D(tex0, vTexCoord);\\n  float gray = luma(color.rgb / color.a);\\n  // floor() used to match src/image/filters.js\\n  float threshold = floor(filterParameter * 255.0) / 255.0;\\n  float blackOrWhite = step(threshold, gray);\\n  gl_FragColor = vec4(vec3(blackOrWhite) * color.a, color.a);\\n}\\n\";\n\nvar filterShaderVert = \"uniform mat4 uModelViewMatrix;\\nuniform mat4 uProjectionMatrix;\\n\\nattribute vec3 aPosition;\\n// texcoords only come from p5 to vertex shader\\n// so pass texcoords on to the fragment shader in a varying variable\\nattribute vec2 aTexCoord;\\nvarying vec2 vTexCoord;\\n\\nvoid main() {\\n  // transferring texcoords for the frag shader\\n  vTexCoord = aTexCoord;\\n\\n  // copy position with a fourth coordinate for projection (1.0 is normal)\\n  vec4 positionVec4 = vec4(aPosition, 1.0);\\n\\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\\n}\\n\";\n\nconst STROKE_CAP_ENUM = {};\nconst STROKE_JOIN_ENUM = {};\nlet lineDefs = \"\";\nconst defineStrokeCapEnum = function (key, val) {\n  lineDefs += `#define STROKE_CAP_${key} ${val}\\n`;\n  STROKE_CAP_ENUM[constants[key]] = val;\n};\nconst defineStrokeJoinEnum = function (key, val) {\n  lineDefs += `#define STROKE_JOIN_${key} ${val}\\n`;\n  STROKE_JOIN_ENUM[constants[key]] = val;\n};\n\n// Define constants in line shaders for each type of cap/join, and also record\n// the values in JS objects\ndefineStrokeCapEnum(\"ROUND\", 0);\ndefineStrokeCapEnum(\"PROJECT\", 1);\ndefineStrokeCapEnum(\"SQUARE\", 2);\ndefineStrokeJoinEnum(\"ROUND\", 0);\ndefineStrokeJoinEnum(\"MITER\", 1);\ndefineStrokeJoinEnum(\"BEVEL\", 2);\n\nconst defaultShaders = {\n  normalVert,\n  normalFrag,\n  basicFrag,\n  sphereMappingFrag,\n  lightVert: lightingShader + lightVert,\n  lightTextureFrag,\n  phongVert,\n  phongFrag: lightingShader + phongFrag,\n  fontVert,\n  fontFrag,\n  lineVert: lineDefs + lineVert,\n  lineFrag: lineDefs + lineFrag,\n  pointVert,\n  pointFrag,\n  imageLightVert,\n  imageLightDiffusedFrag,\n  imageLightSpecularFrag,\n  filterBaseVert,\n  filterBaseFrag,\n};\nlet sphereMapping = defaultShaders.sphereMappingFrag;\nfor (const key in defaultShaders) {\n  defaultShaders[key] = webgl2CompatibilityShader + defaultShaders[key];\n}\n\nconst filterShaderFrags = {\n  [GRAY]: filterGrayFrag,\n  [ERODE]: filterErodeFrag,\n  [DILATE]: filterDilateFrag,\n  [BLUR]: filterBlurFrag,\n  [POSTERIZE]: filterPosterizeFrag,\n  [OPAQUE]: filterOpaqueFrag,\n  [INVERT]: filterInvertFrag,\n  [THRESHOLD]: filterThresholdFrag,\n};\n\n/**\n * 3D graphics class\n * @private\n * @class p5.RendererGL\n * @extends p5.Renderer\n * @todo extend class to include public method for offscreen\n * rendering (FBO).\n */\nclass RendererGL extends Renderer {\n  constructor(pInst, w, h, isMainCanvas, elt, attr) {\n    super(pInst, w, h, isMainCanvas);\n\n    // Create new canvas\n    this.canvas = this.elt = elt || document.createElement(\"canvas\");\n    this._setAttributeDefaults(pInst);\n    this._initContext();\n    // This redundant property is useful in reminding you that you are\n    // interacting with WebGLRenderingContext, still worth considering future removal\n    this.GL = this.drawingContext;\n\n    if (this._isMainCanvas) {\n      // for pixel method sharing with pimage\n      this._pInst._curElement = this;\n      this._pInst.canvas = this.canvas;\n    } else {\n      // hide if offscreen buffer by default\n      this.canvas.style.display = \"none\";\n    }\n    this.elt.id = \"defaultCanvas0\";\n    this.elt.classList.add(\"p5Canvas\");\n\n    // Set and return p5.Element\n    this.wrappedElt = new Element(this.elt, this._pInst);\n\n    // Extend renderer with methods of p5.Element with getters\n    for (const p of Object.getOwnPropertyNames(Element.prototype)) {\n      if (p !== 'constructor' && p[0] !== '_') {\n        Object.defineProperty(this, p, {\n          get() {\n            return this.wrappedElt[p];\n          }\n        });\n      }\n    }\n\n    const dimensions = this._adjustDimensions(w, h);\n    w = dimensions.adjustedWidth;\n    h = dimensions.adjustedHeight;\n\n    this.width = w;\n    this.height = h;\n\n    // Set canvas size\n    this.elt.width = w * this._pixelDensity;\n    this.elt.height = h * this._pixelDensity;\n    this.elt.style.width = `${w}px`;\n    this.elt.style.height = `${h}px`;\n    this._origViewport = {\n      width: this.GL.drawingBufferWidth,\n      height: this.GL.drawingBufferHeight,\n    };\n    this.viewport(this._origViewport.width, this._origViewport.height);\n\n    // Attach canvas element to DOM\n    if (this._pInst._userNode) {\n      // user input node case\n      this._pInst._userNode.appendChild(this.elt);\n    } else {\n      //create main element\n      if (document.getElementsByTagName(\"main\").length === 0) {\n        let m = document.createElement(\"main\");\n        document.body.appendChild(m);\n      }\n      //append canvas to main\n      document.getElementsByTagName(\"main\")[0].appendChild(this.elt);\n    }\n\n    this.isP3D = true; //lets us know we're in 3d mode\n\n    // When constructing a new Geometry, this will represent the builder\n    this.geometryBuilder = undefined;\n\n    // Push/pop state\n    this.states.uModelMatrix = new Matrix(4);\n    this.states.uViewMatrix = new Matrix(4);\n    this.states.uPMatrix = new Matrix(4);\n\n    this.states.curCamera = new Camera(this);\n    this.states.uPMatrix.set(this.states.curCamera.projMatrix);\n    this.states.uViewMatrix.set(this.states.curCamera.cameraMatrix);\n\n    this.states.enableLighting = false;\n    this.states.ambientLightColors = [];\n    this.states.specularColors = [1, 1, 1];\n    this.states.directionalLightDirections = [];\n    this.states.directionalLightDiffuseColors = [];\n    this.states.directionalLightSpecularColors = [];\n    this.states.pointLightPositions = [];\n    this.states.pointLightDiffuseColors = [];\n    this.states.pointLightSpecularColors = [];\n    this.states.spotLightPositions = [];\n    this.states.spotLightDirections = [];\n    this.states.spotLightDiffuseColors = [];\n    this.states.spotLightSpecularColors = [];\n    this.states.spotLightAngle = [];\n    this.states.spotLightConc = [];\n    this.states.activeImageLight = null;\n\n    this.states.curFillColor = [1, 1, 1, 1];\n    this.states.curAmbientColor = [1, 1, 1, 1];\n    this.states.curSpecularColor = [0, 0, 0, 0];\n    this.states.curEmissiveColor = [0, 0, 0, 0];\n    this.states.curStrokeColor = [0, 0, 0, 1];\n\n    this.states.curBlendMode = BLEND;\n\n    this.states._hasSetAmbient = false;\n    this.states._useSpecularMaterial = false;\n    this.states._useEmissiveMaterial = false;\n    this.states._useNormalMaterial = false;\n    this.states._useShininess = 1;\n    this.states._useMetalness = 0;\n\n    this.states.tint = [255, 255, 255, 255];\n\n    this.states.constantAttenuation = 1;\n    this.states.linearAttenuation = 0;\n    this.states.quadraticAttenuation = 0;\n\n    this.states._currentNormal = new Vector(0, 0, 1);\n\n    this.states.drawMode = FILL;\n\n    this.states._tex = null;\n    this.states.textureMode = IMAGE;\n    this.states.textureWrapX = CLAMP;\n    this.states.textureWrapY = CLAMP;\n\n    // erasing\n    this._isErasing = false;\n\n    // simple lines\n    this._simpleLines = false;\n\n    // clipping\n    this._clipDepths = [];\n    this._isClipApplied = false;\n    this._stencilTestOn = false;\n\n    this.mixedAmbientLight = [];\n    this.mixedSpecularColor = [];\n\n    // p5.framebuffer for this are calculated in getDiffusedTexture function\n    this.diffusedTextures = new Map();\n    // p5.framebuffer for this are calculated in getSpecularTexture function\n    this.specularTextures = new Map();\n\n    this.preEraseBlend = undefined;\n    this._cachedBlendMode = undefined;\n    this._cachedFillStyle = [1, 1, 1, 1];\n    this._cachedStrokeStyle = [0, 0, 0, 1];\n    if (this.webglVersion === WEBGL2) {\n      this.blendExt = this.GL;\n    } else {\n      this.blendExt = this.GL.getExtension(\"EXT_blend_minmax\");\n    }\n    this._isBlending = false;\n\n    this._useLineColor = false;\n    this._useVertexColor = false;\n\n    this.registerEnabled = new Set();\n\n    // Camera\n    this.states.curCamera._computeCameraDefaultSettings();\n    this.states.curCamera._setDefaultCamera();\n\n    // FilterCamera\n    this.filterCamera = new Camera(this);\n    this.filterCamera._computeCameraDefaultSettings();\n    this.filterCamera._setDefaultCamera();\n    // Information about the previous frame's touch object\n    // for executing orbitControl()\n    this.prevTouches = [];\n    // Velocity variable for use with orbitControl()\n    this.zoomVelocity = 0;\n    this.rotateVelocity = new Vector(0, 0);\n    this.moveVelocity = new Vector(0, 0);\n    // Flags for recording the state of zooming, rotation and moving\n    this.executeZoom = false;\n    this.executeRotateAndMove = false;\n\n    this._drawingFilter = false;\n    this._drawingImage = false;\n\n    this.specularShader = undefined;\n    this.sphereMapping = undefined;\n    this.diffusedShader = undefined;\n    this._baseFilterShader = undefined;\n    this._defaultLightShader = undefined;\n    this._defaultImmediateModeShader = undefined;\n    this._defaultNormalShader = undefined;\n    this._defaultColorShader = undefined;\n    this._defaultPointShader = undefined;\n\n    this.states.userFillShader = undefined;\n    this.states.userStrokeShader = undefined;\n    this.states.userPointShader = undefined;\n    this.states.userImageShader = undefined;\n\n    this.states.curveDetail = 1 / 4;\n\n    // Used by beginShape/endShape functions to construct a p5.Geometry\n    this.shapeBuilder = new ShapeBuilder(this);\n\n    this.buffers = {\n      fill: [\n        new RenderBuffer(\n          3,\n          \"vertices\",\n          \"vertexBuffer\",\n          \"aPosition\",\n          this,\n          this._vToNArray\n        ),\n        new RenderBuffer(\n          3,\n          \"vertexNormals\",\n          \"normalBuffer\",\n          \"aNormal\",\n          this,\n          this._vToNArray\n        ),\n        new RenderBuffer(\n          4,\n          \"vertexColors\",\n          \"colorBuffer\",\n          \"aVertexColor\",\n          this\n        ),\n        new RenderBuffer(\n          3,\n          \"vertexAmbients\",\n          \"ambientBuffer\",\n          \"aAmbientColor\",\n          this\n        ),\n        new RenderBuffer(2, \"uvs\", \"uvBuffer\", \"aTexCoord\", this, (arr) =>\n          arr.flat()\n        ),\n      ],\n      stroke: [\n        new RenderBuffer(\n          4,\n          \"lineVertexColors\",\n          \"lineColorBuffer\",\n          \"aVertexColor\",\n          this\n        ),\n        new RenderBuffer(\n          3,\n          \"lineVertices\",\n          \"lineVerticesBuffer\",\n          \"aPosition\",\n          this\n        ),\n        new RenderBuffer(\n          3,\n          \"lineTangentsIn\",\n          \"lineTangentsInBuffer\",\n          \"aTangentIn\",\n          this\n        ),\n        new RenderBuffer(\n          3,\n          \"lineTangentsOut\",\n          \"lineTangentsOutBuffer\",\n          \"aTangentOut\",\n          this\n        ),\n        new RenderBuffer(1, \"lineSides\", \"lineSidesBuffer\", \"aSide\", this),\n      ],\n      text: [\n        new RenderBuffer(\n          3,\n          \"vertices\",\n          \"vertexBuffer\",\n          \"aPosition\",\n          this,\n          this._vToNArray\n        ),\n        new RenderBuffer(2, \"uvs\", \"uvBuffer\", \"aTexCoord\", this, (arr) =>\n          arr.flat()\n        ),\n      ],\n      point: this.GL.createBuffer(),\n      user: [],\n    };\n\n    this.geometryBufferCache = new GeometryBufferCache(this);\n\n    this.curStrokeCap = ROUND;\n    this.curStrokeJoin = ROUND;\n\n    // map of texture sources to textures created in this gl context via this.getTexture(src)\n    this.textures = new Map();\n\n    // set of framebuffers in use\n    this.framebuffers = new Set();\n    // stack of active framebuffers\n    this.activeFramebuffers = [];\n\n    // for post processing step\n    this.states.filterShader = undefined;\n    this.filterLayer = undefined;\n    this.filterLayerTemp = undefined;\n    this.defaultFilterShaders = {};\n\n    this.fontInfos = {};\n\n    this._curShader = undefined;\n    this.drawShapeCount = 1;\n\n    this.scratchMat3 = new Matrix(3);\n\n    this._userEnabledStencil = false;\n    // Store original methods for internal use\n    this._internalEnable = this.drawingContext.enable;\n    this._internalDisable = this.drawingContext.disable;\n\n    // Override WebGL enable function\n    this.drawingContext.enable = (key) => {\n      if (key === this.drawingContext.STENCIL_TEST) {\n        if (!this._clipping) {\n          this._userEnabledStencil = true;\n        }\n      }\n      return this._internalEnable.call(this.drawingContext, key);\n    };\n\n    // Override WebGL disable function\n    this.drawingContext.disable = (key) => {\n      if (key === this.drawingContext.STENCIL_TEST) {\n          this._userEnabledStencil = false;\n      }\n      return this._internalDisable.call(this.drawingContext, key);\n    };\n\n    // Whether or not to remove degenerate faces from geometry. This is usually\n    // set to false for performance.\n    this._validateFaces = false;\n  }\n\n  remove() {\n    this.wrappedElt.remove();\n    this.wrappedElt = null;\n    this.canvas = null;\n    this.elt = null;\n  }\n\n  //////////////////////////////////////////////\n  // Geometry Building\n  //////////////////////////////////////////////\n\n  /**\n   * Starts creating a new p5.Geometry. Subsequent shapes drawn will be added\n   * to the geometry and then returned when\n   * <a href=\"#/p5/endGeometry\">endGeometry()</a> is called. One can also use\n   * <a href=\"#/p5/buildGeometry\">buildGeometry()</a> to pass a function that\n   * draws shapes.\n   *\n   * If you need to draw complex shapes every frame which don't change over time,\n   * combining them upfront with `beginGeometry()` and `endGeometry()` and then\n   * drawing that will run faster than repeatedly drawing the individual pieces.\n   * @private\n   */\n  beginGeometry() {\n    if (this.geometryBuilder) {\n      throw new Error(\n        \"It looks like `beginGeometry()` is being called while another p5.Geometry is already being build.\"\n      );\n    }\n    this.geometryBuilder = new GeometryBuilder(this);\n    this.geometryBuilder.prevFillColor = this.states.fillColor;\n    this.fill(new Color([-1, -1, -1, -1]));\n  }\n\n  /**\n   * Finishes creating a new <a href=\"#/p5.Geometry\">p5.Geometry</a> that was\n   * started using <a href=\"#/p5/beginGeometry\">beginGeometry()</a>. One can also\n   * use <a href=\"#/p5/buildGeometry\">buildGeometry()</a> to pass a function that\n   * draws shapes.\n   * @private\n   *\n   * @returns {p5.Geometry} The model that was built.\n   */\n  endGeometry() {\n    if (!this.geometryBuilder) {\n      throw new Error(\n        \"Make sure you call beginGeometry() before endGeometry()!\"\n      );\n    }\n    const geometry = this.geometryBuilder.finish();\n    this.fill(this.geometryBuilder.prevFillColor);\n    this.geometryBuilder = undefined;\n    return geometry;\n  }\n\n  /**\n   * Creates a new <a href=\"#/p5.Geometry\">p5.Geometry</a> that contains all\n   * the shapes drawn in a provided callback function. The returned combined shape\n   * can then be drawn all at once using <a href=\"#/p5/model\">model()</a>.\n   *\n   * If you need to draw complex shapes every frame which don't change over time,\n   * combining them with `buildGeometry()` once and then drawing that will run\n   * faster than repeatedly drawing the individual pieces.\n   *\n   * One can also draw shapes directly between\n   * <a href=\"#/p5/beginGeometry\">beginGeometry()</a> and\n   * <a href=\"#/p5/endGeometry\">endGeometry()</a> instead of using a callback\n   * function.\n   * @param {Function} callback A function that draws shapes.\n   * @returns {p5.Geometry} The model that was built from the callback function.\n   */\n  buildGeometry(callback) {\n    this.beginGeometry();\n    callback();\n    return this.endGeometry();\n  }\n\n  //////////////////////////////////////////////\n  // Shape drawing\n  //////////////////////////////////////////////\n\n  beginShape(...args) {\n    super.beginShape(...args);\n    // TODO remove when shape refactor is complete\n    // this.shapeBuilder.beginShape(...args);\n  }\n\n  curveDetail(d) {\n    if (d === undefined) {\n      return this.states.curveDetail;\n    } else {\n      this.states.setValue(\"curveDetail\", d);\n    }\n  }\n\n  drawShape(shape) {\n    const visitor = new PrimitiveToVerticesConverter({\n      curveDetail: this.states.curveDetail,\n    });\n    shape.accept(visitor);\n    this.shapeBuilder.constructFromContours(shape, visitor.contours);\n\n    if (this.geometryBuilder) {\n      this.geometryBuilder.addImmediate(\n        this.shapeBuilder.geometry,\n        this.shapeBuilder.shapeMode,\n        { validateFaces: this._validateFaces }\n      );\n    } else if (this.states.fillColor || this.states.strokeColor) {\n      if (this.shapeBuilder.shapeMode === POINTS) {\n        this._drawPoints(\n          this.shapeBuilder.geometry.vertices,\n          this.buffers.point\n        );\n      } else {\n        this._drawGeometry(this.shapeBuilder.geometry, {\n          mode: this.shapeBuilder.shapeMode,\n          count: this.drawShapeCount,\n        });\n      }\n    }\n    this.drawShapeCount = 1;\n  }\n\n  endShape(mode, count) {\n    this.drawShapeCount = count;\n    super.endShape(mode, count);\n  }\n\n  vertexProperty(...args) {\n    this.currentShape.vertexProperty(...args);\n  }\n\n  normal(xorv, y, z) {\n    if (xorv instanceof Vector) {\n      this.states.setValue(\"_currentNormal\", xorv);\n    } else {\n      this.states.setValue(\"_currentNormal\", new Vector(xorv, y, z));\n    }\n    this.updateShapeVertexProperties();\n  }\n\n  model(model, count = 1) {\n    if (model.vertices.length > 0) {\n      if (this.geometryBuilder) {\n        this.geometryBuilder.addRetained(model);\n      } else {\n        if (!this.geometryInHash(model.gid)) {\n          model._edgesToVertices();\n          this._getOrMakeCachedBuffers(model);\n        }\n\n        this._drawGeometry(model, { count });\n      }\n    }\n  }\n\n  //////////////////////////////////////////////\n  // Rendering\n  //////////////////////////////////////////////\n\n  _drawGeometry(geometry, { mode = TRIANGLES, count = 1 } = {}) {\n    for (const propName in geometry.userVertexProperties) {\n      const prop = geometry.userVertexProperties[propName];\n      this.buffers.user.push(\n        new RenderBuffer(\n          prop.getDataSize(),\n          prop.getSrcName(),\n          prop.getDstName(),\n          prop.getName(),\n          this\n        )\n      );\n    }\n\n    if (\n      this.states.fillColor &&\n      geometry.vertices.length >= 3 &&\n      ![LINES, POINTS].includes(mode)\n    ) {\n      this._drawFills(geometry, { mode, count });\n    }\n\n    if (this.states.strokeColor && geometry.lineVertices.length >= 1) {\n      this._drawStrokes(geometry, { count });\n    }\n\n    this.buffers.user = [];\n  }\n\n  _drawGeometryScaled(model, scaleX, scaleY, scaleZ) {\n    let originalModelMatrix = this.states.uModelMatrix;\n    this.states.setValue(\"uModelMatrix\", this.states.uModelMatrix.clone());\n    try {\n      this.states.uModelMatrix.scale(scaleX, scaleY, scaleZ);\n\n      if (this.geometryBuilder) {\n        this.geometryBuilder.addRetained(model);\n      } else {\n        this._drawGeometry(model);\n      }\n    } finally {\n      this.states.setValue(\"uModelMatrix\", originalModelMatrix);\n    }\n  }\n\n  _drawFills(geometry, { count, mode } = {}) {\n    this._useVertexColor = geometry.vertexColors.length > 0;\n\n    const shader =\n      !this._drawingFilter && this.states.userFillShader\n        ? this.states.userFillShader\n        : this._getFillShader();\n    shader.bindShader();\n    this._setGlobalUniforms(shader);\n    this._setFillUniforms(shader);\n    shader.bindTextures();\n\n    for (const buff of this.buffers.fill) {\n      buff._prepareBuffer(geometry, shader);\n    }\n    this._prepareUserAttributes(geometry, shader);\n    shader.disableRemainingAttributes();\n\n    this._applyColorBlend(\n      this.states.curFillColor,\n      geometry.hasFillTransparency()\n    );\n\n    this._drawBuffers(geometry, { mode, count });\n\n    shader.unbindShader();\n  }\n\n  _drawStrokes(geometry, { count } = {}) {\n    const gl = this.GL;\n\n    this._useLineColor = geometry.vertexStrokeColors.length > 0;\n\n    const shader = this._getStrokeShader();\n    shader.bindShader();\n    this._setGlobalUniforms(shader);\n    this._setStrokeUniforms(shader);\n    shader.bindTextures();\n\n    for (const buff of this.buffers.stroke) {\n      buff._prepareBuffer(geometry, shader);\n    }\n    this._prepareUserAttributes(geometry, shader);\n    shader.disableRemainingAttributes();\n\n    this._applyColorBlend(\n      this.states.curStrokeColor,\n      geometry.hasStrokeTransparency()\n    );\n\n    if (count === 1) {\n      gl.drawArrays(gl.TRIANGLES, 0, geometry.lineVertices.length / 3);\n    } else {\n      try {\n        gl.drawArraysInstanced(\n          gl.TRIANGLES,\n          0,\n          geometry.lineVertices.length / 3,\n          count\n        );\n      } catch (e) {\n        console.log(\n          \" p5.js says: Instancing is only supported in WebGL2 mode\"\n        );\n      }\n    }\n\n    shader.unbindShader();\n  }\n\n  _drawPoints(vertices, vertexBuffer) {\n    const gl = this.GL;\n    const pointShader = this._getPointShader();\n    pointShader.bindShader();\n    this._setGlobalUniforms(pointShader);\n    this._setPointUniforms(pointShader);\n    pointShader.bindTextures();\n\n    this._bindBuffer(\n      vertexBuffer,\n      gl.ARRAY_BUFFER,\n      this._vToNArray(vertices),\n      Float32Array,\n      gl.STATIC_DRAW\n    );\n\n    pointShader.enableAttrib(pointShader.attributes.aPosition, 3);\n\n    this._applyColorBlend(this.states.curStrokeColor);\n\n    gl.drawArrays(gl.Points, 0, vertices.length);\n\n    pointShader.unbindShader();\n  }\n\n  _prepareUserAttributes(geometry, shader) {\n    for (const buff of this.buffers.user) {\n      if (!this._pInst.constructor.disableFriendlyErrors) {\n        // Check for the right data size\n        const prop = geometry.userVertexProperties[buff.attr];\n        if (prop) {\n          const adjustedLength = prop.getSrcArray().length / prop.getDataSize();\n          if (adjustedLength > geometry.vertices.length) {\n            this._pInst.constructor._friendlyError(\n              `One of the geometries has a custom vertex property '${prop.getName()}' with more values than vertices. This is probably caused by directly using the Geometry.vertexProperty() method.`,\n              \"vertexProperty()\"\n            );\n          } else if (adjustedLength < geometry.vertices.length) {\n            this._pInst.constructor._friendlyError(\n              `One of the geometries has a custom vertex property '${prop.getName()}' with fewer values than vertices. This is probably caused by directly using the Geometry.vertexProperty() method.`,\n              \"vertexProperty()\"\n            );\n          }\n        }\n      }\n      buff._prepareBuffer(geometry, shader);\n    }\n  }\n\n  _drawBuffers(geometry, { mode = this.GL.TRIANGLES, count }) {\n    const gl = this.GL;\n    const glBuffers = this.geometryBufferCache.getCached(geometry);\n\n    if (!glBuffers) return;\n\n    if (glBuffers.indexBuffer) {\n      this._bindBuffer(glBuffers.indexBuffer, gl.ELEMENT_ARRAY_BUFFER);\n\n      // If this model is using a Uint32Array we need to ensure the\n      // OES_element_index_uint WebGL extension is enabled.\n      if (\n        this._pInst.webglVersion !== WEBGL2 &&\n        glBuffers.indexBufferType === gl.UNSIGNED_INT\n      ) {\n        if (!gl.getExtension(\"OES_element_index_uint\")) {\n          throw new Error(\n            \"Unable to render a 3d model with > 65535 triangles. Your web browser does not support the WebGL Extension OES_element_index_uint.\"\n          );\n        }\n      }\n\n      if (count === 1) {\n        gl.drawElements(\n          gl.TRIANGLES,\n          geometry.faces.length * 3,\n          glBuffers.indexBufferType,\n          0\n        );\n      } else {\n        try {\n          gl.drawElementsInstanced(\n            gl.TRIANGLES,\n            geometry.faces.length * 3,\n            glBuffers.indexBufferType,\n            0,\n            count\n          );\n        } catch (e) {\n          console.log(\n            \" p5.js says: Instancing is only supported in WebGL2 mode\"\n          );\n        }\n      }\n    } else {\n      if (count === 1) {\n        gl.drawArrays(mode, 0, geometry.vertices.length);\n      } else {\n        try {\n          gl.drawArraysInstanced(mode, 0, geometry.vertices.length, count);\n        } catch (e) {\n          console.log(\n            \" p5.js says: Instancing is only supported in WebGL2 mode\"\n          );\n        }\n      }\n    }\n  }\n\n  _getOrMakeCachedBuffers(geometry) {\n    return this.geometryBufferCache.ensureCached(geometry);\n  }\n\n  //////////////////////////////////////////////\n  // Setting\n  //////////////////////////////////////////////\n\n  _setAttributeDefaults(pInst) {\n    // See issue #3850, safer to enable AA in Safari\n    const applyAA = navigator.userAgent.toLowerCase().includes(\"safari\");\n    const defaults = {\n      alpha: true,\n      depth: true,\n      stencil: true,\n      antialias: applyAA,\n      premultipliedAlpha: true,\n      preserveDrawingBuffer: true,\n      perPixelLighting: true,\n      version: 2,\n    };\n    if (pInst._glAttributes === null) {\n      pInst._glAttributes = defaults;\n    } else {\n      pInst._glAttributes = Object.assign(defaults, pInst._glAttributes);\n    }\n    return;\n  }\n\n  _initContext() {\n    if (this._pInst._glAttributes?.version !== 1) {\n      // Unless WebGL1 is explicitly asked for, try to create a WebGL2 context\n      this.drawingContext = this.canvas.getContext(\n        \"webgl2\",\n        this._pInst._glAttributes\n      );\n    }\n    this.webglVersion = this.drawingContext\n      ? WEBGL2\n      : WEBGL;\n    // If this is the main canvas, make sure the global `webglVersion` is set\n    this._pInst.webglVersion = this.webglVersion;\n    if (!this.drawingContext) {\n      // If we were unable to create a WebGL2 context (either because it was\n      // disabled via `setAttributes({ version: 1 })` or because the device\n      // doesn't support it), fall back to a WebGL1 context\n      this.drawingContext =\n        this.canvas.getContext(\"webgl\", this._pInst._glAttributes) ||\n        this.canvas.getContext(\"experimental-webgl\", this._pInst._glAttributes);\n    }\n    if (this.drawingContext === null) {\n      throw new Error(\"Error creating webgl context\");\n    } else {\n      const gl = this.drawingContext;\n      gl.enable(gl.DEPTH_TEST);\n      gl.depthFunc(gl.LEQUAL);\n      gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n      // Make sure all images are loaded into the canvas premultiplied so that\n      // they match the way we render colors. This will make framebuffer textures\n      // be encoded the same way as textures from everything else.\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n      this._viewport = this.drawingContext.getParameter(\n        this.drawingContext.VIEWPORT\n      );\n    }\n  }\n\n  _getMaxTextureSize() {\n    const gl = this.drawingContext;\n    return gl.getParameter(gl.MAX_TEXTURE_SIZE);\n  }\n\n  _adjustDimensions(width, height) {\n    if (!this._maxTextureSize) {\n      this._maxTextureSize = this._getMaxTextureSize();\n    }\n    let maxTextureSize = this._maxTextureSize;\n\n    let maxAllowedPixelDimensions = Math.floor(\n      maxTextureSize / this._pixelDensity\n    );\n    let adjustedWidth = Math.min(width, maxAllowedPixelDimensions);\n    let adjustedHeight = Math.min(height, maxAllowedPixelDimensions);\n\n    if (adjustedWidth !== width || adjustedHeight !== height) {\n      console.warn(\n        \"Warning: The requested width/height exceeds hardware limits. \" +\n          `Adjusting dimensions to width: ${adjustedWidth}, height: ${adjustedHeight}.`\n      );\n    }\n\n    return { adjustedWidth, adjustedHeight };\n  }\n\n  //This is helper function to reset the context anytime the attributes\n  //are changed with setAttributes()\n\n  _resetContext(options, callback) {\n    const w = this.width;\n    const h = this.height;\n    const defaultId = this.canvas.id;\n    const isPGraphics = this._pInst instanceof Graphics;\n\n    // Preserve existing position and styles before recreation\n    const prevStyle = {\n      position: this.canvas.style.position,\n      top: this.canvas.style.top,\n      left: this.canvas.style.left,\n    };\n\n    if (isPGraphics) {\n      // Handle PGraphics: remove and recreate the canvas\n      const pg = this._pInst;\n      pg.canvas.parentNode.removeChild(pg.canvas);\n      pg.canvas = document.createElement(\"canvas\");\n      const node = pg._pInst._userNode || document.body;\n      node.appendChild(pg.canvas);\n      Element.call(pg, pg.canvas, pg._pInst);\n      // Restore previous width and height\n      pg.width = w;\n      pg.height = h;\n    } else {\n      // Handle main canvas: remove and recreate it\n      let c = this.canvas;\n      if (c) {\n        c.parentNode.removeChild(c);\n      }\n      c = document.createElement(\"canvas\");\n      c.id = defaultId;\n      // Attach the new canvas to the correct parent node\n      if (this._pInst._userNode) {\n        this._pInst._userNode.appendChild(c);\n      } else {\n        document.body.appendChild(c);\n      }\n      this._pInst.canvas = c;\n      this.canvas = c;\n\n      // Restore the saved position\n      this.canvas.style.position = prevStyle.position;\n      this.canvas.style.top = prevStyle.top;\n      this.canvas.style.left = prevStyle.left;\n    }\n\n    const renderer = new RendererGL(\n      this._pInst,\n      w,\n      h,\n      !isPGraphics,\n      this._pInst.canvas\n    );\n    this._pInst._renderer = renderer;\n\n    renderer._applyDefaults();\n\n    if (typeof callback === \"function\") {\n      //setTimeout with 0 forces the task to the back of the queue, this ensures that\n      //we finish switching out the renderer\n      setTimeout(() => {\n        callback.apply(window._renderer, options);\n      }, 0);\n    }\n  }\n\n  _update() {\n    // reset model view and apply initial camera transform\n    // (containing only look at info; no projection).\n    this.states.setValue(\"uModelMatrix\", this.states.uModelMatrix.clone());\n    this.states.uModelMatrix.reset();\n    this.states.setValue(\"uViewMatrix\", this.states.uViewMatrix.clone());\n    this.states.uViewMatrix.set(this.states.curCamera.cameraMatrix);\n\n    // reset light data for new frame.\n\n    this.states.setValue(\"ambientLightColors\", []);\n    this.states.setValue(\"specularColors\", [1, 1, 1]);\n\n    this.states.setValue(\"directionalLightDirections\", []);\n    this.states.setValue(\"directionalLightDiffuseColors\", []);\n    this.states.setValue(\"directionalLightSpecularColors\", []);\n\n    this.states.setValue(\"pointLightPositions\", []);\n    this.states.setValue(\"pointLightDiffuseColors\", []);\n    this.states.setValue(\"pointLightSpecularColors\", []);\n\n    this.states.setValue(\"spotLightPositions\", []);\n    this.states.setValue(\"spotLightDirections\", []);\n    this.states.setValue(\"spotLightDiffuseColors\", []);\n    this.states.setValue(\"spotLightSpecularColors\", []);\n    this.states.setValue(\"spotLightAngle\", []);\n    this.states.setValue(\"spotLightConc\", []);\n\n    this.states.setValue(\"enableLighting\", false);\n\n    //reset tint value for new frame\n    this.states.setValue(\"tint\", [255, 255, 255, 255]);\n\n    //Clear depth every frame\n    this.GL.clearStencil(0);\n    this.GL.clear(this.GL.DEPTH_BUFFER_BIT | this.GL.STENCIL_BUFFER_BIT);\n    if (!this._userEnabledStencil) {\n      this._internalDisable.call(this.GL, this.GL.STENCIL_TEST);\n    }\n\n  }\n\n  /**\n   * [background description]\n   */\n  background(...args) {\n    const _col = this._pInst.color(...args);\n    this.clear(..._col._getRGBA());\n  }\n\n  //////////////////////////////////////////////\n  // Positioning\n  //////////////////////////////////////////////\n\n  get uModelMatrix() {\n    return this.states.uModelMatrix;\n  }\n\n  get uViewMatrix() {\n    return this.states.uViewMatrix;\n  }\n\n  get uPMatrix() {\n    return this.states.uPMatrix;\n  }\n\n  get uMVMatrix() {\n    const m = this.uModelMatrix.copy();\n    m.mult(this.uViewMatrix);\n    return m;\n  }\n\n  /**\n   * Get a matrix from world-space to screen-space\n   */\n  getWorldToScreenMatrix() {\n    const modelMatrix = this.states.uModelMatrix;\n    const viewMatrix = this.states.uViewMatrix;\n    const projectionMatrix = this.states.uPMatrix;\n    const projectedToScreenMatrix = new Matrix(4);\n    projectedToScreenMatrix.scale(this.width, this.height, 1);\n    projectedToScreenMatrix.translate([0.5, 0.5, 0.5]);\n    projectedToScreenMatrix.scale(0.5, -0.5, 0.5);\n\n    const modelViewMatrix = modelMatrix.copy().mult(viewMatrix);\n    const modelViewProjectionMatrix = modelViewMatrix.mult(projectionMatrix);\n    const worldToScreenMatrix = modelViewProjectionMatrix.mult(projectedToScreenMatrix);\n    return worldToScreenMatrix;\n  }\n\n  //////////////////////////////////////////////\n  // COLOR\n  //////////////////////////////////////////////\n  /**\n   * Basic fill material for geometry with a given color\n   * @param  {Number|Number[]|String|p5.Color} v1  gray value,\n   * red or hue value (depending on the current color mode),\n   * or color Array, or CSS color string\n   * @param  {Number}            [v2] green or saturation value\n   * @param  {Number}            [v3] blue or brightness value\n   * @param  {Number}            [a]  opacity\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *   noStroke();\n   *   fill(100, 100, 240);\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   box(75, 75, 75);\n   * }\n   * </code>\n   * </div>\n   *\n   * @alt\n   * black canvas with purple cube spinning\n   */\n  fill(...args) {\n    super.fill(...args);\n    //see material.js for more info on color blending in webgl\n    // const color = fn.color.apply(this._pInst, arguments);\n    const color = this.states.fillColor;\n    this.states.setValue(\"curFillColor\", color._array);\n    this.states.setValue(\"drawMode\", FILL);\n    this.states.setValue(\"_useNormalMaterial\", false);\n    this.states.setValue(\"_tex\", null);\n  }\n\n  /**\n   * Basic stroke material for geometry with a given color\n   * @param  {Number|Number[]|String|p5.Color} v1  gray value,\n   * red or hue value (depending on the current color mode),\n   * or color Array, or CSS color string\n   * @param  {Number}            [v2] green or saturation value\n   * @param  {Number}            [v3] blue or brightness value\n   * @param  {Number}            [a]  opacity\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *   stroke(240, 150, 150);\n   *   fill(100, 100, 240);\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   box(75, 75, 75);\n   * }\n   * </code>\n   * </div>\n   *\n   * @alt\n   * black canvas with purple cube with pink outline spinning\n   */\n  stroke(...args) {\n    super.stroke(...args);\n    // const color = fn.color.apply(this._pInst, arguments);\n    this.states.setValue(\"curStrokeColor\", this.states.strokeColor._array);\n  }\n\n  getCommonVertexProperties() {\n    return {\n      ...super.getCommonVertexProperties(),\n      stroke: this.states.strokeColor,\n      fill: this.states.fillColor,\n      normal: this.states._currentNormal,\n    };\n  }\n\n  getSupportedIndividualVertexProperties() {\n    return {\n      textureCoordinates: true,\n    };\n  }\n\n  strokeCap(cap) {\n    this.curStrokeCap = cap;\n  }\n\n  strokeJoin(join) {\n    this.curStrokeJoin = join;\n  }\n  getFilterLayer() {\n    if (!this.filterLayer) {\n      this.filterLayer = new Framebuffer(this);\n    }\n    return this.filterLayer;\n  }\n  getFilterLayerTemp() {\n    if (!this.filterLayerTemp) {\n      this.filterLayerTemp = new Framebuffer(this);\n    }\n    return this.filterLayerTemp;\n  }\n  matchSize(fboToMatch, target) {\n    if (\n      fboToMatch.width !== target.width ||\n      fboToMatch.height !== target.height\n    ) {\n      fboToMatch.resize(target.width, target.height);\n    }\n\n    if (fboToMatch.pixelDensity() !== target.pixelDensity()) {\n      fboToMatch.pixelDensity(target.pixelDensity());\n    }\n  }\n  filter(...args) {\n    let fbo = this.getFilterLayer();\n\n    // use internal shader for filter constants BLUR, INVERT, etc\n    let filterParameter = undefined;\n    let operation = undefined;\n    if (typeof args[0] === \"string\") {\n      operation = args[0];\n      let useDefaultParam =\n        operation in filterParamDefaults && args[1] === undefined;\n      filterParameter = useDefaultParam\n        ? filterParamDefaults[operation]\n        : args[1];\n\n      // Create and store shader for constants once on initial filter call.\n      // Need to store multiple in case user calls different filters,\n      // eg. filter(BLUR) then filter(GRAY)\n      if (!(operation in this.defaultFilterShaders)) {\n        this.defaultFilterShaders[operation] = new Shader(\n          fbo.renderer,\n          filterShaderVert,\n          filterShaderFrags[operation]\n        );\n      }\n      this.states.setValue(\n        \"filterShader\",\n        this.defaultFilterShaders[operation]\n      );\n    }\n    // use custom user-supplied shader\n    else {\n      this.states.setValue(\"filterShader\", args[0]);\n    }\n\n    // Setting the target to the framebuffer when applying a filter to a framebuffer.\n\n    const target = this.activeFramebuffer() || this;\n\n    // Resize the framebuffer 'fbo' and adjust its pixel density if it doesn't match the target.\n    this.matchSize(fbo, target);\n\n    fbo.draw(() => this.clear()); // prevent undesirable feedback effects accumulating secretly.\n\n    let texelSize = [\n      1 / (target.width * target.pixelDensity()),\n      1 / (target.height * target.pixelDensity()),\n    ];\n\n    // apply blur shader with multiple passes.\n    if (operation === BLUR) {\n      // Treating 'tmp' as a framebuffer.\n      const tmp = this.getFilterLayerTemp();\n      // Resize the framebuffer 'tmp' and adjust its pixel density if it doesn't match the target.\n      this.matchSize(tmp, target);\n      // setup\n      this.push();\n      this.states.setValue(\"strokeColor\", null);\n      this.blendMode(BLEND);\n\n      // draw main to temp buffer\n      this.shader(this.states.filterShader);\n      this.states.filterShader.setUniform(\"texelSize\", texelSize);\n      this.states.filterShader.setUniform(\"canvasSize\", [\n        target.width,\n        target.height,\n      ]);\n      this.states.filterShader.setUniform(\n        \"radius\",\n        Math.max(1, filterParameter)\n      );\n\n      // Horiz pass: draw `target` to `tmp`\n      tmp.draw(() => {\n        this.states.filterShader.setUniform(\"direction\", [1, 0]);\n        this.states.filterShader.setUniform(\"tex0\", target);\n        this.clear();\n        this.shader(this.states.filterShader);\n        this.noLights();\n        this.plane(target.width, target.height);\n      });\n\n      // Vert pass: draw `tmp` to `fbo`\n      fbo.draw(() => {\n        this.states.filterShader.setUniform(\"direction\", [0, 1]);\n        this.states.filterShader.setUniform(\"tex0\", tmp);\n        this.clear();\n        this.shader(this.states.filterShader);\n        this.noLights();\n        this.plane(target.width, target.height);\n      });\n\n      this.pop();\n    }\n    // every other non-blur shader uses single pass\n    else {\n      fbo.draw(() => {\n        this.states.setValue(\"strokeColor\", null);\n        this.blendMode(BLEND);\n        this.shader(this.states.filterShader);\n        this.states.filterShader.setUniform(\"tex0\", target);\n        this.states.filterShader.setUniform(\"texelSize\", texelSize);\n        this.states.filterShader.setUniform(\"canvasSize\", [\n          target.width,\n          target.height,\n        ]);\n        // filterParameter uniform only used for POSTERIZE, and THRESHOLD\n        // but shouldn't hurt to always set\n        this.states.filterShader.setUniform(\"filterParameter\", filterParameter);\n        this.noLights();\n        this.plane(target.width, target.height);\n      });\n    }\n    // draw fbo contents onto main renderer.\n    this.push();\n    this.states.setValue(\"strokeColor\", null);\n    this.clear();\n    this.push();\n    this.states.setValue(\"imageMode\", CORNER);\n    this.blendMode(BLEND);\n    target.filterCamera._resize();\n    this.setCamera(target.filterCamera);\n    this.resetMatrix();\n    this._drawingFilter = true;\n    this.image(\n      fbo,\n      0,\n      0,\n      this.width,\n      this.height,\n      -target.width / 2,\n      -target.height / 2,\n      target.width,\n      target.height\n    );\n    this._drawingFilter = false;\n    this.clearDepth();\n    this.pop();\n    this.pop();\n  }\n\n  // Pass this off to the host instance so that we can treat a renderer and a\n  // framebuffer the same in filter()\n\n  pixelDensity(newDensity) {\n    if (newDensity) {\n      return this._pInst.pixelDensity(newDensity);\n    }\n    return this._pInst.pixelDensity();\n  }\n\n  blendMode(mode) {\n    if (\n      mode === DARKEST ||\n      mode === LIGHTEST ||\n      mode === ADD ||\n      mode === BLEND ||\n      mode === SUBTRACT ||\n      mode === SCREEN ||\n      mode === EXCLUSION ||\n      mode === REPLACE ||\n      mode === MULTIPLY ||\n      mode === REMOVE\n    )\n      this.states.setValue(\"curBlendMode\", mode);\n    else if (\n      mode === BURN ||\n      mode === OVERLAY ||\n      mode === HARD_LIGHT ||\n      mode === SOFT_LIGHT ||\n      mode === DODGE\n    ) {\n      console.warn(\n        \"BURN, OVERLAY, HARD_LIGHT, SOFT_LIGHT, and DODGE only work for blendMode in 2D mode.\"\n      );\n    }\n  }\n\n  erase(opacityFill, opacityStroke) {\n    if (!this._isErasing) {\n      this.preEraseBlend = this.states.curBlendMode;\n      this._isErasing = true;\n      this.blendMode(REMOVE);\n      this._cachedFillStyle = this.states.curFillColor.slice();\n      this.states.setValue(\"curFillColor\", [1, 1, 1, opacityFill / 255]);\n      this._cachedStrokeStyle = this.states.curStrokeColor.slice();\n      this.states.setValue(\"curStrokeColor\", [1, 1, 1, opacityStroke / 255]);\n    }\n  }\n\n  noErase() {\n    if (this._isErasing) {\n      // Restore colors\n      this.states.setValue(\"curFillColor\", this._cachedFillStyle.slice());\n      this.states.setValue(\"curStrokeColor\", this._cachedStrokeStyle.slice());\n      // Restore blend mode\n      this.states.setValue(\"curBlendMode\", this.preEraseBlend);\n      this.blendMode(this.preEraseBlend);\n      // Ensure that _applyBlendMode() sets preEraseBlend back to the original blend mode\n      this._isErasing = false;\n      this._applyBlendMode();\n    }\n  }\n\n  drawTarget() {\n    return this.activeFramebuffers[this.activeFramebuffers.length - 1] || this;\n  }\n\n  beginClip(options = {}) {\n    super.beginClip(options);\n\n    this.drawTarget()._isClipApplied = true;\n\n    const gl = this.GL;\n    gl.clearStencil(0);\n    gl.clear(gl.STENCIL_BUFFER_BIT);\n    this._internalEnable.call(gl, gl.STENCIL_TEST);\n    this._stencilTestOn = true;\n    gl.stencilFunc(\n      gl.ALWAYS, // the test\n      1, // reference value\n      0xff // mask\n    );\n    gl.stencilOp(\n      gl.KEEP, // what to do if the stencil test fails\n      gl.KEEP, // what to do if the depth test fails\n      gl.REPLACE // what to do if both tests pass\n    );\n    gl.disable(gl.DEPTH_TEST);\n\n    this.push();\n    this.resetShader();\n    if (this.states.fillColor) this.fill(0, 0);\n    if (this.states.strokeColor) this.stroke(0, 0);\n  }\n\n  endClip() {\n    this.pop();\n\n    const gl = this.GL;\n    gl.stencilOp(\n      gl.KEEP, // what to do if the stencil test fails\n      gl.KEEP, // what to do if the depth test fails\n      gl.KEEP // what to do if both tests pass\n    );\n    gl.stencilFunc(\n      this._clipInvert ? gl.EQUAL : gl.NOTEQUAL, // the test\n      0, // reference value\n      0xff // mask\n    );\n    gl.enable(gl.DEPTH_TEST);\n\n    // Mark the depth at which the clip has been applied so that we can clear it\n    // when we pop past this depth\n    this._clipDepths.push(this._pushPopDepth);\n\n    super.endClip();\n  }\n\n  _clearClip() {\n    this.GL.clearStencil(1);\n    this.GL.clear(this.GL.STENCIL_BUFFER_BIT);\n    if (this._clipDepths.length > 0) {\n      this._clipDepths.pop();\n    }\n    this.drawTarget()._isClipApplied = false;\n  }\n\n  // x,y are canvas-relative (pre-scaled by _pixelDensity)\n  _getPixel(x, y) {\n    const gl = this.GL;\n    return readPixelWebGL(\n      gl,\n      null,\n      x,\n      y,\n      gl.RGBA,\n      gl.UNSIGNED_BYTE,\n      this._pInst.height * this._pInst.pixelDensity()\n    );\n  }\n\n  /**\n   * Loads the pixels data for this canvas into the pixels[] attribute.\n   * Note that updatePixels() and set() do not work.\n   * Any pixel manipulation must be done directly to the pixels[] array.\n   *\n   * @private\n   */\n  loadPixels() {\n    //@todo_FES\n    if (this._pInst._glAttributes.preserveDrawingBuffer !== true) {\n      console.log(\n        \"loadPixels only works in WebGL when preserveDrawingBuffer \" +\n          \"is true.\"\n      );\n      return;\n    }\n\n    const pd = this._pixelDensity;\n    const gl = this.GL;\n\n    this.pixels = readPixelsWebGL(\n      this.pixels,\n      gl,\n      null,\n      0,\n      0,\n      this.width * pd,\n      this.height * pd,\n      gl.RGBA,\n      gl.UNSIGNED_BYTE,\n      this.height * pd\n    );\n  }\n\n  updatePixels() {\n    const fbo = this._getTempFramebuffer();\n    fbo.pixels = this.pixels;\n    fbo.updatePixels();\n    this.push();\n    this.resetMatrix();\n    this.clear();\n    this.states.setValue(\"imageMode\", CORNER);\n    this.image(\n      fbo,\n      0,\n      0,\n      fbo.width,\n      fbo.height,\n      -fbo.width / 2,\n      -fbo.height / 2,\n      fbo.width,\n      fbo.height\n    );\n    this.pop();\n    this.GL.clearDepth(1);\n    this.GL.clear(this.GL.DEPTH_BUFFER_BIT);\n  }\n\n  /**\n   * @private\n   * @returns {p5.Framebuffer} A p5.Framebuffer set to match the size and settings\n   * of the renderer's canvas. It will be created if it does not yet exist, and\n   * reused if it does.\n   */\n  _getTempFramebuffer() {\n    if (!this._tempFramebuffer) {\n      this._tempFramebuffer = new Framebuffer(this, {\n        format: UNSIGNED_BYTE,\n        useDepth: this._pInst._glAttributes.depth,\n        depthFormat: UNSIGNED_INT,\n        antialias: this._pInst._glAttributes.antialias,\n      });\n    }\n    return this._tempFramebuffer;\n  }\n\n  //////////////////////////////////////////////\n  // HASH | for geometry\n  //////////////////////////////////////////////\n\n  geometryInHash(gid) {\n    return this.geometryBufferCache.isCached(gid);\n  }\n\n  viewport(w, h) {\n    this._viewport = [0, 0, w, h];\n    this.GL.viewport(0, 0, w, h);\n  }\n\n  /**\n   * [resize description]\n   * @private\n   * @param  {Number} w [description]\n   * @param  {Number} h [description]\n   */\n  resize(w, h) {\n    super.resize(w, h);\n\n    // save canvas properties\n    const props = {};\n    for (const key in this.drawingContext) {\n      const val = this.drawingContext[key];\n      if (typeof val !== \"object\" && typeof val !== \"function\") {\n        props[key] = val;\n      }\n    }\n\n    const dimensions = this._adjustDimensions(w, h);\n    w = dimensions.adjustedWidth;\n    h = dimensions.adjustedHeight;\n\n    this.width = w;\n    this.height = h;\n\n    this.canvas.width = w * this._pixelDensity;\n    this.canvas.height = h * this._pixelDensity;\n    this.canvas.style.width = `${w}px`;\n    this.canvas.style.height = `${h}px`;\n    this._origViewport = {\n      width: this.GL.drawingBufferWidth,\n      height: this.GL.drawingBufferHeight,\n    };\n    this.viewport(this._origViewport.width, this._origViewport.height);\n\n    this.states.curCamera._resize();\n\n    //resize pixels buffer\n    if (typeof this.pixels !== \"undefined\") {\n      this.pixels = new Uint8Array(\n        this.GL.drawingBufferWidth * this.GL.drawingBufferHeight * 4\n      );\n    }\n\n    for (const framebuffer of this.framebuffers) {\n      // Notify framebuffers of the resize so that any auto-sized framebuffers\n      // can also update their size\n      framebuffer._canvasSizeChanged();\n    }\n\n    // reset canvas properties\n    for (const savedKey in props) {\n      try {\n        this.drawingContext[savedKey] = props[savedKey];\n      } catch (err) {\n        // ignore read-only property errors\n      }\n    }\n  }\n\n  /**\n   * clears color and depth buffers\n   * with r,g,b,a\n   * @private\n   * @param {Number} r normalized red val.\n   * @param {Number} g normalized green val.\n   * @param {Number} b normalized blue val.\n   * @param {Number} a normalized alpha val.\n   */\n  clear(...args) {\n    const _r = args[0] || 0;\n    const _g = args[1] || 0;\n    const _b = args[2] || 0;\n    let _a = args[3] || 0;\n\n    const activeFramebuffer = this.activeFramebuffer();\n    if (\n      activeFramebuffer &&\n      activeFramebuffer.format === UNSIGNED_BYTE &&\n      !activeFramebuffer.antialias &&\n      _a === 0\n    ) {\n      // Drivers on Intel Macs check for 0,0,0,0 exactly when drawing to a\n      // framebuffer and ignore the command if it's the only drawing command to\n      // the framebuffer. To work around it, we can set the alpha to a value so\n      // low that it still rounds down to 0, but that circumvents the buggy\n      // check in the driver.\n      _a = 1e-10;\n    }\n\n    this.GL.clearColor(_r * _a, _g * _a, _b * _a, _a);\n    this.GL.clearDepth(1);\n    this.GL.clear(this.GL.COLOR_BUFFER_BIT | this.GL.DEPTH_BUFFER_BIT);\n  }\n\n  /**\n   * Resets all depth information so that nothing previously drawn will\n   * occlude anything subsequently drawn.\n   */\n  clearDepth(depth = 1) {\n    this.GL.clearDepth(depth);\n    this.GL.clear(this.GL.DEPTH_BUFFER_BIT);\n  }\n\n  applyMatrix(a, b, c, d, e, f) {\n    this.states.setValue(\"uModelMatrix\", this.states.uModelMatrix.clone());\n    if (arguments.length === 16) {\n      // this.states.uModelMatrix.apply(arguments);\n      Matrix.prototype.apply.apply(this.states.uModelMatrix, arguments);\n    } else {\n      this.states.uModelMatrix.apply([\n        a,\n        b,\n        0,\n        0,\n        c,\n        d,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n        e,\n        f,\n        0,\n        1,\n      ]);\n    }\n  }\n\n  /**\n   * [translate description]\n   * @private\n   * @param  {Number} x [description]\n   * @param  {Number} y [description]\n   * @param  {Number} z [description]\n   * @chainable\n   * @todo implement handle for components or vector as args\n   */\n  translate(x, y, z) {\n    if (x instanceof Vector) {\n      z = x.z;\n      y = x.y;\n      x = x.x;\n    }\n    this.states.setValue(\"uModelMatrix\", this.states.uModelMatrix.clone());\n    this.states.uModelMatrix.translate([x, y, z]);\n    return this;\n  }\n\n  /**\n   * Scales the Model View Matrix by a vector\n   * @private\n   * @param  {Number | p5.Vector | Array} x [description]\n   * @param  {Number} [y] y-axis scalar\n   * @param  {Number} [z] z-axis scalar\n   * @chainable\n   */\n  scale(x, y, z) {\n    this.states.setValue(\"uModelMatrix\", this.states.uModelMatrix.clone());\n    this.states.uModelMatrix.scale(x, y, z);\n    return this;\n  }\n\n  rotate(rad, axis) {\n    if (typeof axis === \"undefined\") {\n      return this.rotateZ(rad);\n    }\n    this.states.setValue(\"uModelMatrix\", this.states.uModelMatrix.clone());\n    Matrix.prototype.rotate4x4.apply(this.states.uModelMatrix, arguments);\n    return this;\n  }\n\n  rotateX(rad) {\n    this.rotate(rad, 1, 0, 0);\n    return this;\n  }\n\n  rotateY(rad) {\n    this.rotate(rad, 0, 1, 0);\n    return this;\n  }\n\n  rotateZ(rad) {\n    this.rotate(rad, 0, 0, 1);\n    return this;\n  }\n\n  pop(...args) {\n    if (\n      this._clipDepths.length > 0 &&\n      this._pushPopDepth === this._clipDepths[this._clipDepths.length - 1]\n    ) {\n      this._clearClip();\n      if (!this._userEnabledStencil) {\n        this._internalDisable.call(this.GL, this.GL.STENCIL_TEST);\n      }\n\n    // Reset saved state\n    // this._userEnabledStencil = this._savedStencilTestState;\n    }\n    super.pop(...args);\n    this._applyStencilTestIfClipping();\n  }\n  _applyStencilTestIfClipping() {\n    const drawTarget = this.drawTarget();\n    if (drawTarget._isClipApplied !== this._stencilTestOn) {\n      if (drawTarget._isClipApplied) {\n        this._internalEnable.call(this.GL, this.GL.STENCIL_TEST);\n        this._stencilTestOn = true;\n      } else {\n        if (!this._userEnabledStencil) {\n          this._internalDisable.call(this.GL, this.GL.STENCIL_TEST);\n        }\n        this._stencilTestOn = false;\n      }\n    }\n  }\n  resetMatrix() {\n    this.states.setValue(\"uModelMatrix\", this.states.uModelMatrix.clone());\n    this.states.uModelMatrix.reset();\n    this.states.setValue(\"uViewMatrix\", this.states.uViewMatrix.clone());\n    this.states.uViewMatrix.set(this.states.curCamera.cameraMatrix);\n    return this;\n  }\n\n  //////////////////////////////////////////////\n  // SHADER\n  //////////////////////////////////////////////\n\n  /*\n   * shaders are created and cached on a per-renderer basis,\n   * on the grounds that each renderer will have its own gl context\n   * and the shader must be valid in that context.\n   */\n\n  _getStrokeShader() {\n    // select the stroke shader to use\n    const stroke = this.states.userStrokeShader;\n    if (stroke) {\n      return stroke;\n    }\n    return this._getLineShader();\n  }\n\n  _getSphereMapping(img) {\n    if (!this.sphereMapping) {\n      this.sphereMapping = this._pInst.createFilterShader(sphereMapping);\n    }\n    this.scratchMat3.inverseTranspose4x4(this.states.uViewMatrix);\n    this.scratchMat3.invert(this.scratchMat3); // uNMMatrix is 3x3\n    this.sphereMapping.setUniform(\"uFovY\", this.states.curCamera.cameraFOV);\n    this.sphereMapping.setUniform(\"uAspect\", this.states.curCamera.aspectRatio);\n    this.sphereMapping.setUniform(\"uNewNormalMatrix\", this.scratchMat3.mat3);\n    this.sphereMapping.setUniform(\"uEnvMap\", img);\n    return this.sphereMapping;\n  }\n\n  /*\n   * This method will handle both image shaders and\n   * fill shaders, returning the appropriate shader\n   * depending on the current context (image or shape).\n   */\n  _getFillShader() {\n    // If drawing an image, check for user-defined image shader and filters\n    if (this._drawingImage) {\n      // Use user-defined image shader if available and no filter is applied\n      if (this.states.userImageShader && !this._drawingFilter) {\n        return this.states.userImageShader;\n      } else {\n        return this._getLightShader(); // Fallback to light shader\n      }\n    }\n    // If user has defined a fill shader, return that\n    else if (this.states.userFillShader) {\n      return this.states.userFillShader;\n    }\n    // Use normal shader if normal material is active\n    else if (this.states._useNormalMaterial) {\n      return this._getNormalShader();\n    }\n    // Use light shader if lighting or textures are enabled\n    else if (this.states.enableLighting || this.states._tex) {\n      return this._getLightShader();\n    }\n    // Default to color shader if no other conditions are met\n    return this._getColorShader();\n  }\n\n  _getPointShader() {\n    // select the point shader to use\n    const point = this.states.userPointShader;\n    if (!point || !point.isPointShader()) {\n      return this._getPointShader();\n    }\n    return point;\n  }\n\n  baseMaterialShader() {\n    if (!this._pInst._glAttributes.perPixelLighting) {\n      throw new Error(\n        \"The material shader does not support hooks without perPixelLighting. Try turning it back on.\"\n      );\n    }\n    return this._getLightShader();\n  }\n\n  _getLightShader() {\n    if (!this._defaultLightShader) {\n      if (this._pInst._glAttributes.perPixelLighting) {\n        this._defaultLightShader = new Shader(\n          this,\n          this._webGL2CompatibilityPrefix(\"vert\", \"highp\") +\n            defaultShaders.phongVert,\n          this._webGL2CompatibilityPrefix(\"frag\", \"highp\") +\n            defaultShaders.phongFrag,\n          {\n            vertex: {\n              \"void beforeVertex\": \"() {}\",\n              \"Vertex getObjectInputs\": \"(Vertex inputs) { return inputs; }\",\n              \"Vertex getWorldInputs\": \"(Vertex inputs) { return inputs; }\",\n              \"Vertex getCameraInputs\": \"(Vertex inputs) { return inputs; }\",\n              \"void afterVertex\": \"() {}\",\n            },\n            fragment: {\n              \"void beforeFragment\": \"() {}\",\n              \"Inputs getPixelInputs\": \"(Inputs inputs) { return inputs; }\",\n              \"vec4 combineColors\": `(ColorComponents components) {\n                vec4 color = vec4(0.);\n                color.rgb += components.diffuse * components.baseColor;\n                color.rgb += components.ambient * components.ambientColor;\n                color.rgb += components.specular * components.specularColor;\n                color.rgb += components.emissive;\n                color.a = components.opacity;\n                return color;\n              }`,\n              \"vec4 getFinalColor\": \"(vec4 color) { return color; }\",\n              \"void afterFragment\": \"() {}\",\n            },\n          }\n        );\n      } else {\n        this._defaultLightShader = new Shader(\n          this,\n          this._webGL2CompatibilityPrefix(\"vert\", \"highp\") +\n            defaultShaders.lightVert,\n          this._webGL2CompatibilityPrefix(\"frag\", \"highp\") +\n            defaultShaders.lightTextureFrag\n        );\n      }\n    }\n\n    return this._defaultLightShader;\n  }\n\n  baseNormalShader() {\n    return this._getNormalShader();\n  }\n\n  _getNormalShader() {\n    if (!this._defaultNormalShader) {\n      this._defaultNormalShader = new Shader(\n        this,\n        this._webGL2CompatibilityPrefix(\"vert\", \"mediump\") +\n          defaultShaders.normalVert,\n        this._webGL2CompatibilityPrefix(\"frag\", \"mediump\") +\n          defaultShaders.normalFrag,\n        {\n          vertex: {\n            \"void beforeVertex\": \"() {}\",\n            \"Vertex getObjectInputs\": \"(Vertex inputs) { return inputs; }\",\n            \"Vertex getWorldInputs\": \"(Vertex inputs) { return inputs; }\",\n            \"Vertex getCameraInputs\": \"(Vertex inputs) { return inputs; }\",\n            \"void afterVertex\": \"() {}\",\n          },\n          fragment: {\n            \"void beforeFragment\": \"() {}\",\n            \"vec4 getFinalColor\": \"(vec4 color) { return color; }\",\n            \"void afterFragment\": \"() {}\",\n          },\n        }\n      );\n    }\n\n    return this._defaultNormalShader;\n  }\n\n  baseColorShader() {\n    return this._getColorShader();\n  }\n\n  _getColorShader() {\n    if (!this._defaultColorShader) {\n      this._defaultColorShader = new Shader(\n        this,\n        this._webGL2CompatibilityPrefix(\"vert\", \"mediump\") +\n          defaultShaders.normalVert,\n        this._webGL2CompatibilityPrefix(\"frag\", \"mediump\") +\n          defaultShaders.basicFrag,\n        {\n          vertex: {\n            \"void beforeVertex\": \"() {}\",\n            \"Vertex getObjectInputs\": \"(Vertex inputs) { return inputs; }\",\n            \"Vertex getWorldInputs\": \"(Vertex inputs) { return inputs; }\",\n            \"Vertex getCameraInputs\": \"(Vertex inputs) { return inputs; }\",\n            \"void afterVertex\": \"() {}\",\n          },\n          fragment: {\n            \"void beforeFragment\": \"() {}\",\n            \"vec4 getFinalColor\": \"(vec4 color) { return color; }\",\n            \"void afterFragment\": \"() {}\",\n          },\n        }\n      );\n    }\n\n    return this._defaultColorShader;\n  }\n\n  /**\n   * TODO(dave): un-private this when there is a way to actually override the\n   * shader used for points\n   *\n   * Get the shader used when drawing points with <a href=\"#/p5/point\">`point()`</a>.\n   *\n   * You can call <a href=\"#/p5.Shader/modify\">`pointShader().modify()`</a>\n   * and change any of the following hooks:\n   * - `void beforeVertex`: Called at the start of the vertex shader.\n   * - `vec3 getLocalPosition`: Update the position of vertices before transforms are applied. It takes in `vec3 position` and must return a modified version.\n   * - `vec3 getWorldPosition`: Update the position of vertices after transforms are applied. It takes in `vec3 position` and pust return a modified version.\n   * - `float getPointSize`: Update the size of the point. It takes in `float size` and must return a modified version.\n   * - `void afterVertex`: Called at the end of the vertex shader.\n   * - `void beforeFragment`: Called at the start of the fragment shader.\n   * - `bool shouldDiscard`: Points are drawn inside a square, with the corners discarded in the fragment shader to create a circle. Use this to change this logic. It takes in a `bool willDiscard` and must return a modified version.\n   * - `vec4 getFinalColor`: Update the final color after mixing. It takes in a `vec4 color` and must return a modified version.\n   * - `void afterFragment`: Called at the end of the fragment shader.\n   *\n   * Call `pointShader().inspectHooks()` to see all the possible hooks and\n   * their default implementations.\n   *\n   * @returns {p5.Shader} The `point()` shader\n   * @private()\n   */\n  pointShader() {\n    return this._getPointShader();\n  }\n\n  _getPointShader() {\n    if (!this._defaultPointShader) {\n      this._defaultPointShader = new Shader(\n        this,\n        this._webGL2CompatibilityPrefix(\"vert\", \"mediump\") +\n          defaultShaders.pointVert,\n        this._webGL2CompatibilityPrefix(\"frag\", \"mediump\") +\n          defaultShaders.pointFrag,\n        {\n          vertex: {\n            \"void beforeVertex\": \"() {}\",\n            \"vec3 getLocalPosition\": \"(vec3 position) { return position; }\",\n            \"vec3 getWorldPosition\": \"(vec3 position) { return position; }\",\n            \"float getPointSize\": \"(float size) { return size; }\",\n            \"void afterVertex\": \"() {}\",\n          },\n          fragment: {\n            \"void beforeFragment\": \"() {}\",\n            \"vec4 getFinalColor\": \"(vec4 color) { return color; }\",\n            \"bool shouldDiscard\": \"(bool outside) { return outside; }\",\n            \"void afterFragment\": \"() {}\",\n          },\n        }\n      );\n    }\n    return this._defaultPointShader;\n  }\n\n  baseStrokeShader() {\n    return this._getLineShader();\n  }\n\n  _getLineShader() {\n    if (!this._defaultLineShader) {\n      this._defaultLineShader = new Shader(\n        this,\n        this._webGL2CompatibilityPrefix(\"vert\", \"mediump\") +\n          defaultShaders.lineVert,\n        this._webGL2CompatibilityPrefix(\"frag\", \"mediump\") +\n          defaultShaders.lineFrag,\n        {\n          vertex: {\n            \"void beforeVertex\": \"() {}\",\n            \"StrokeVertex getObjectInputs\":\n              \"(StrokeVertex inputs) { return inputs; }\",\n            \"StrokeVertex getWorldInputs\":\n              \"(StrokeVertex inputs) { return inputs; }\",\n            \"StrokeVertex getCameraInputs\":\n              \"(StrokeVertex inputs) { return inputs; }\",\n            \"void afterVertex\": \"() {}\",\n          },\n          fragment: {\n            \"void beforeFragment\": \"() {}\",\n            \"Inputs getPixelInputs\": \"(Inputs inputs) { return inputs; }\",\n            \"vec4 getFinalColor\": \"(vec4 color) { return color; }\",\n            \"bool shouldDiscard\": \"(bool outside) { return outside; }\",\n            \"void afterFragment\": \"() {}\",\n          },\n        }\n      );\n    }\n\n    return this._defaultLineShader;\n  }\n\n  _getFontShader() {\n    if (!this._defaultFontShader) {\n      if (this.webglVersion === WEBGL) {\n        this.GL.getExtension(\"OES_standard_derivatives\");\n      }\n      this._defaultFontShader = new Shader(\n        this,\n        this._webGL2CompatibilityPrefix(\"vert\", \"highp\") +\n          defaultShaders.fontVert,\n        this._webGL2CompatibilityPrefix(\"frag\", \"highp\") +\n          defaultShaders.fontFrag\n      );\n    }\n    return this._defaultFontShader;\n  }\n\n  baseFilterShader() {\n    if (!this._baseFilterShader) {\n      this._baseFilterShader = new Shader(\n        this,\n        this._webGL2CompatibilityPrefix(\"vert\", \"highp\") +\n          defaultShaders.filterBaseVert,\n        this._webGL2CompatibilityPrefix(\"frag\", \"highp\") +\n          defaultShaders.filterBaseFrag,\n        {\n            vertex: {},\n            fragment: {\n              \"vec4 getColor\": `(FilterInputs inputs, in sampler2D canvasContent) {\n                return getTexture(canvasContent, inputs.texCoord);\n              }`,\n            },\n          }\n      );\n    }\n    return this._baseFilterShader;\n  }\n\n  _webGL2CompatibilityPrefix(shaderType, floatPrecision) {\n    let code = \"\";\n    if (this.webglVersion === WEBGL2) {\n      code += \"#version 300 es\\n#define WEBGL2\\n\";\n    }\n    if (shaderType === \"vert\") {\n      code += \"#define VERTEX_SHADER\\n\";\n    } else if (shaderType === \"frag\") {\n      code += \"#define FRAGMENT_SHADER\\n\";\n    }\n    if (floatPrecision) {\n      code += `precision ${floatPrecision} float;\\n`;\n    }\n    return code;\n  }\n\n  /**\n   * @private\n   * Note: DO NOT CALL THIS while in the middle of binding another texture,\n   * since it will change the texture binding in order to allocate the empty\n   * texture! Grab its value beforehand!\n   */\n  _getEmptyTexture() {\n    if (!this._emptyTexture) {\n      // a plain white texture RGBA, full alpha, single pixel.\n      const im = new Image(1, 1);\n      im.set(0, 0, 255);\n      this._emptyTexture = new Texture(this, im);\n    }\n    return this._emptyTexture;\n  }\n\n  getTexture(input) {\n    let src = input;\n    if (src instanceof Framebuffer) {\n      src = src.color;\n    }\n\n    const texture = this.textures.get(src);\n    if (texture) {\n      return texture;\n    }\n\n    const tex = new Texture(this, src);\n    this.textures.set(src, tex);\n    return tex;\n  }\n  /*\n   *  used in imageLight,\n   *  To create a blurry image from the input non blurry img, if it doesn't already exist\n   *  Add it to the diffusedTexture map,\n   *  Returns the blurry image\n   *  maps a Image used by imageLight() to a p5.Framebuffer\n   */\n  getDiffusedTexture(input) {\n    // if one already exists for a given input image\n    if (this.diffusedTextures.get(input) != null) {\n      return this.diffusedTextures.get(input);\n    }\n    // if not, only then create one\n    let newFramebuffer;\n    // hardcoded to 200px, because it's going to be blurry and smooth\n    let smallWidth = 200;\n    let width = smallWidth;\n    let height = Math.floor(smallWidth * (input.height / input.width));\n    newFramebuffer = new Framebuffer(this, {\n      width,\n      height,\n      density: 1,\n    });\n    // create framebuffer is like making a new sketch, all functions on main\n    // sketch it would be available on framebuffer\n    if (!this.diffusedShader) {\n      this.diffusedShader = this._pInst.createShader(\n        defaultShaders.imageLightVert,\n        defaultShaders.imageLightDiffusedFrag\n      );\n    }\n    newFramebuffer.draw(() => {\n      this.shader(this.diffusedShader);\n      this.diffusedShader.setUniform(\"environmentMap\", input);\n      this.states.setValue(\"strokeColor\", null);\n      this.noLights();\n      this.plane(width, height);\n    });\n    this.diffusedTextures.set(input, newFramebuffer);\n    return newFramebuffer;\n  }\n\n  /*\n   *  used in imageLight,\n   *  To create a texture from the input non blurry image, if it doesn't already exist\n   *  Creating 8 different levels of textures according to different\n   *  sizes and atoring them in `levels` array\n   *  Creating a new Mipmap texture with that `levels` array\n   *  Storing the texture for input image in map called `specularTextures`\n   *  maps the input Image to a p5.MipmapTexture\n   */\n  getSpecularTexture(input) {\n    // check if already exits (there are tex of diff resolution so which one to check)\n    // currently doing the whole array\n    if (this.specularTextures.get(input) != null) {\n      return this.specularTextures.get(input);\n    }\n    // Hardcoded size\n    const size = 512;\n    let tex;\n    const levels = [];\n    const framebuffer = new Framebuffer(this, {\n      width: size,\n      height: size,\n      density: 1,\n    });\n    let count = Math.log(size) / Math.log(2);\n    if (!this.specularShader) {\n      this.specularShader = this._pInst.createShader(\n        defaultShaders.imageLightVert,\n        defaultShaders.imageLightSpecularFrag\n      );\n    }\n    // currently only 8 levels\n    // This loop calculates 8 framebuffers of varying size of canvas\n    // and corresponding different roughness levels.\n    // Roughness increases with the decrease in canvas size,\n    // because rougher surfaces have less detailed/more blurry reflections.\n    for (let w = size; w >= 1; w /= 2) {\n      framebuffer.resize(w, w);\n      let currCount = Math.log(w) / Math.log(2);\n      let roughness = 1 - currCount / count;\n      framebuffer.draw(() => {\n        this.shader(this.specularShader);\n        this.clear();\n        this.specularShader.setUniform(\"environmentMap\", input);\n        this.specularShader.setUniform(\"roughness\", roughness);\n        this.states.setValue(\"strokeColor\", null);\n        this.noLights();\n        this.plane(w, w);\n      });\n      levels.push(framebuffer.get().drawingContext.getImageData(0, 0, w, w));\n    }\n    // Free the Framebuffer\n    framebuffer.remove();\n    tex = new MipmapTexture(this, levels, {});\n    this.specularTextures.set(input, tex);\n    return tex;\n  }\n\n  /**\n   * @private\n   * @returns {p5.Framebuffer|null} The currently active framebuffer, or null if\n   * the main canvas is the current draw target.\n   */\n  activeFramebuffer() {\n    return this.activeFramebuffers[this.activeFramebuffers.length - 1] || null;\n  }\n\n  createFramebuffer(options) {\n    return new Framebuffer(this, options);\n  }\n\n  _setGlobalUniforms(shader) {\n    const modelMatrix = this.states.uModelMatrix;\n    const viewMatrix = this.states.uViewMatrix;\n    const projectionMatrix = this.states.uPMatrix;\n    const modelViewMatrix = modelMatrix.copy().mult(viewMatrix);\n\n    shader.setUniform(\n      \"uPerspective\",\n      this.states.curCamera.useLinePerspective ? 1 : 0\n    );\n    shader.setUniform(\"uViewMatrix\", viewMatrix.mat4);\n    shader.setUniform(\"uProjectionMatrix\", projectionMatrix.mat4);\n    shader.setUniform(\"uModelMatrix\", modelMatrix.mat4);\n    shader.setUniform(\"uModelViewMatrix\", modelViewMatrix.mat4);\n    if (shader.uniforms.uModelViewProjectionMatrix) {\n      const modelViewProjectionMatrix = modelViewMatrix.copy();\n      modelViewProjectionMatrix.mult(projectionMatrix);\n      shader.setUniform(\n        \"uModelViewProjectionMatrix\",\n        modelViewProjectionMatrix.mat4\n      );\n    }\n    if (shader.uniforms.uNormalMatrix) {\n      this.scratchMat3.inverseTranspose4x4(modelViewMatrix);\n      shader.setUniform(\"uNormalMatrix\", this.scratchMat3.mat3);\n    }\n    if (shader.uniforms.uModelNormalMatrix) {\n      this.scratchMat3.inverseTranspose4x4(this.states.uModelMatrix);\n      shader.setUniform(\"uModelNormalMatrix\", this.scratchMat3.mat3);\n    }\n    if (shader.uniforms.uCameraNormalMatrix) {\n      this.scratchMat3.inverseTranspose4x4(this.states.uViewMatrix);\n      shader.setUniform(\"uCameraNormalMatrix\", this.scratchMat3.mat3);\n    }\n    if (shader.uniforms.uCameraRotation) {\n      this.scratchMat3.inverseTranspose4x4(this.states.uViewMatrix);\n      shader.setUniform(\"uCameraRotation\", this.scratchMat3.mat3);\n    }\n    shader.setUniform(\"uViewport\", this._viewport);\n  }\n\n  _setStrokeUniforms(strokeShader) {\n    // set the uniform values\n    strokeShader.setUniform(\"uSimpleLines\", this._simpleLines);\n    strokeShader.setUniform(\"uUseLineColor\", this._useLineColor);\n    strokeShader.setUniform(\"uMaterialColor\", this.states.curStrokeColor);\n    strokeShader.setUniform(\"uStrokeWeight\", this.states.strokeWeight);\n    strokeShader.setUniform(\"uStrokeCap\", STROKE_CAP_ENUM[this.curStrokeCap]);\n    strokeShader.setUniform(\n      \"uStrokeJoin\",\n      STROKE_JOIN_ENUM[this.curStrokeJoin]\n    );\n  }\n\n  _setFillUniforms(fillShader) {\n    this.mixedSpecularColor = [...this.states.curSpecularColor];\n    const empty = this._getEmptyTexture();\n\n    if (this.states._useMetalness > 0) {\n      this.mixedSpecularColor = this.mixedSpecularColor.map(\n        (mixedSpecularColor, index) =>\n          this.states.curFillColor[index] * this.states._useMetalness +\n          mixedSpecularColor * (1 - this.states._useMetalness)\n      );\n    }\n\n    // TODO: optimize\n    fillShader.setUniform(\"uUseVertexColor\", this._useVertexColor);\n    fillShader.setUniform(\"uMaterialColor\", this.states.curFillColor);\n    fillShader.setUniform(\"isTexture\", !!this.states._tex);\n    // We need to explicitly set uSampler back to an empty texture here.\n    // In general, we record the last set texture so we can re-apply it\n    // the next time a shader is used. However, the texture() function\n    // works differently and is global p5 state. If the p5 state has\n    // been cleared, we also need to clear the value in uSampler to match.\n    fillShader.setUniform(\"uSampler\", this.states._tex || empty);\n    fillShader.setUniform(\"uTint\", this.states.tint);\n\n    fillShader.setUniform(\"uHasSetAmbient\", this.states._hasSetAmbient);\n    fillShader.setUniform(\"uAmbientMatColor\", this.states.curAmbientColor);\n    fillShader.setUniform(\"uSpecularMatColor\", this.mixedSpecularColor);\n    fillShader.setUniform(\"uEmissiveMatColor\", this.states.curEmissiveColor);\n    fillShader.setUniform(\"uSpecular\", this.states._useSpecularMaterial);\n    fillShader.setUniform(\"uEmissive\", this.states._useEmissiveMaterial);\n    fillShader.setUniform(\"uShininess\", this.states._useShininess);\n    fillShader.setUniform(\"uMetallic\", this.states._useMetalness);\n\n    this._setImageLightUniforms(fillShader);\n\n    fillShader.setUniform(\"uUseLighting\", this.states.enableLighting);\n\n    const pointLightCount = this.states.pointLightDiffuseColors.length / 3;\n    fillShader.setUniform(\"uPointLightCount\", pointLightCount);\n    fillShader.setUniform(\n      \"uPointLightLocation\",\n      this.states.pointLightPositions\n    );\n    fillShader.setUniform(\n      \"uPointLightDiffuseColors\",\n      this.states.pointLightDiffuseColors\n    );\n    fillShader.setUniform(\n      \"uPointLightSpecularColors\",\n      this.states.pointLightSpecularColors\n    );\n\n    const directionalLightCount =\n      this.states.directionalLightDiffuseColors.length / 3;\n    fillShader.setUniform(\"uDirectionalLightCount\", directionalLightCount);\n    fillShader.setUniform(\n      \"uLightingDirection\",\n      this.states.directionalLightDirections\n    );\n    fillShader.setUniform(\n      \"uDirectionalDiffuseColors\",\n      this.states.directionalLightDiffuseColors\n    );\n    fillShader.setUniform(\n      \"uDirectionalSpecularColors\",\n      this.states.directionalLightSpecularColors\n    );\n\n    // TODO: sum these here...\n    const ambientLightCount = this.states.ambientLightColors.length / 3;\n    this.mixedAmbientLight = [...this.states.ambientLightColors];\n\n    if (this.states._useMetalness > 0) {\n      this.mixedAmbientLight = this.mixedAmbientLight.map((ambientColors) => {\n        let mixing = ambientColors - this.states._useMetalness;\n        return Math.max(0, mixing);\n      });\n    }\n    fillShader.setUniform(\"uAmbientLightCount\", ambientLightCount);\n    fillShader.setUniform(\"uAmbientColor\", this.mixedAmbientLight);\n\n    const spotLightCount = this.states.spotLightDiffuseColors.length / 3;\n    fillShader.setUniform(\"uSpotLightCount\", spotLightCount);\n    fillShader.setUniform(\"uSpotLightAngle\", this.states.spotLightAngle);\n    fillShader.setUniform(\"uSpotLightConc\", this.states.spotLightConc);\n    fillShader.setUniform(\n      \"uSpotLightDiffuseColors\",\n      this.states.spotLightDiffuseColors\n    );\n    fillShader.setUniform(\n      \"uSpotLightSpecularColors\",\n      this.states.spotLightSpecularColors\n    );\n    fillShader.setUniform(\"uSpotLightLocation\", this.states.spotLightPositions);\n    fillShader.setUniform(\n      \"uSpotLightDirection\",\n      this.states.spotLightDirections\n    );\n\n    fillShader.setUniform(\n      \"uConstantAttenuation\",\n      this.states.constantAttenuation\n    );\n    fillShader.setUniform(\"uLinearAttenuation\", this.states.linearAttenuation);\n    fillShader.setUniform(\n      \"uQuadraticAttenuation\",\n      this.states.quadraticAttenuation\n    );\n  }\n\n  // getting called from _setFillUniforms\n  _setImageLightUniforms(shader) {\n    //set uniform values\n    shader.setUniform(\"uUseImageLight\", this.states.activeImageLight != null);\n    // true\n    if (this.states.activeImageLight) {\n      // this.states.activeImageLight has image as a key\n      // look up the texture from the diffusedTexture map\n      let diffusedLight = this.getDiffusedTexture(this.states.activeImageLight);\n      shader.setUniform(\"environmentMapDiffused\", diffusedLight);\n      let specularLight = this.getSpecularTexture(this.states.activeImageLight);\n\n      shader.setUniform(\"environmentMapSpecular\", specularLight);\n    }\n  }\n\n  _setPointUniforms(pointShader) {\n    // set the uniform values\n    pointShader.setUniform(\"uMaterialColor\", this.states.curStrokeColor);\n    // @todo is there an instance where this isn't stroke weight?\n    // should be they be same var?\n    pointShader.setUniform(\n      \"uPointSize\",\n      this.states.strokeWeight * this._pixelDensity\n    );\n  }\n\n  /* Binds a buffer to the drawing context\n   * when passed more than two arguments it also updates or initializes\n   * the data associated with the buffer\n   */\n  _bindBuffer(buffer, target, values, type, usage) {\n    if (!target) target = this.GL.ARRAY_BUFFER;\n    this.GL.bindBuffer(target, buffer);\n    if (values !== undefined) {\n      let data = values;\n      if (values instanceof DataArray) {\n        data = values.dataArray();\n      } else if (!(data instanceof (type || Float32Array))) {\n        data = new (type || Float32Array)(data);\n      }\n      this.GL.bufferData(target, data, usage || this.GL.STATIC_DRAW);\n    }\n  }\n\n  ///////////////////////////////\n  //// UTILITY FUNCTIONS\n  //////////////////////////////\n  _arraysEqual(a, b) {\n    const aLength = a.length;\n    if (aLength !== b.length) return false;\n    return a.every((ai, i) => ai === b[i]);\n  }\n\n  _isTypedArray(arr) {\n    return [\n      Float32Array,\n      Float64Array,\n      Int16Array,\n      Uint16Array,\n      Uint32Array,\n    ].some((x) => arr instanceof x);\n  }\n\n  /**\n   * turn a p5.Vector Array into a one dimensional number array\n   * @private\n   * @param  {p5.Vector[]} arr  an array of p5.Vector\n   * @return {Number[]}     a one dimensional array of numbers\n   * [p5.Vector(1, 2, 3), p5.Vector(4, 5, 6)] ->\n   * [1, 2, 3, 4, 5, 6]\n   */\n  _vToNArray(arr) {\n    return arr.flatMap((item) => [item.x, item.y, item.z]);\n  }\n}\n\nfunction rendererGL(p5, fn) {\n  p5.RendererGL = RendererGL;\n\n  /**\n   * @module Rendering\n   * @submodule Rendering\n   * @for p5\n   */\n  /**\n   * Set attributes for the WebGL Drawing context.\n   * This is a way of adjusting how the WebGL\n   * renderer works to fine-tune the display and performance.\n   *\n   * Note that this will reinitialize the drawing context\n   * if called after the WebGL canvas is made.\n   *\n   * If an object is passed as the parameter, all attributes\n   * not declared in the object will be set to defaults.\n   *\n   * The available attributes are:\n   * <br>\n   * alpha - indicates if the canvas contains an alpha buffer\n   * default is true\n   *\n   * depth - indicates whether the drawing buffer has a depth buffer\n   * of at least 16 bits - default is true\n   *\n   * stencil - indicates whether the drawing buffer has a stencil buffer\n   * of at least 8 bits\n   *\n   * antialias - indicates whether or not to perform anti-aliasing\n   * default is false (true in Safari)\n   *\n   * premultipliedAlpha - indicates that the page compositor will assume\n   * the drawing buffer contains colors with pre-multiplied alpha\n   * default is true\n   *\n   * preserveDrawingBuffer - if true the buffers will not be cleared and\n   * and will preserve their values until cleared or overwritten by author\n   * (note that p5 clears automatically on draw loop)\n   * default is true\n   *\n   * perPixelLighting - if true, per-pixel lighting will be used in the\n   * lighting shader otherwise per-vertex lighting is used.\n   * default is true.\n   *\n   * version - either 1 or 2, to specify which WebGL version to ask for. By\n   * default, WebGL 2 will be requested. If WebGL2 is not available, it will\n   * fall back to WebGL 1. You can check what version is used with by looking at\n   * the global `webglVersion` property.\n   *\n   * @method setAttributes\n   * @for p5\n   * @param  {String}  key Name of attribute\n   * @param  {Boolean}        value New value of named attribute\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   push();\n   *   rotateZ(frameCount * 0.02);\n   *   rotateX(frameCount * 0.02);\n   *   rotateY(frameCount * 0.02);\n   *   fill(0, 0, 0);\n   *   box(50);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   *  // Now with the antialias attribute set to true.\n   * function setup() {\n   *   setAttributes('antialias', true);\n   *   createCanvas(100, 100, WEBGL);\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   push();\n   *   rotateZ(frameCount * 0.02);\n   *   rotateX(frameCount * 0.02);\n   *   rotateY(frameCount * 0.02);\n   *   fill(0, 0, 0);\n   *   box(50);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // press the mouse button to disable perPixelLighting\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *   noStroke();\n   *   fill(255);\n   * }\n   *\n   * let lights = [\n   *   { c: '#f00', t: 1.12, p: 1.91, r: 0.2 },\n   *   { c: '#0f0', t: 1.21, p: 1.31, r: 0.2 },\n   *   { c: '#00f', t: 1.37, p: 1.57, r: 0.2 },\n   *   { c: '#ff0', t: 1.12, p: 1.91, r: 0.7 },\n   *   { c: '#0ff', t: 1.21, p: 1.31, r: 0.7 },\n   *   { c: '#f0f', t: 1.37, p: 1.57, r: 0.7 }\n   * ];\n   *\n   * function draw() {\n   *   let t = millis() / 1000 + 1000;\n   *   background(0);\n   *   directionalLight(color('#222'), 1, 1, 1);\n   *\n   *   for (let i = 0; i < lights.length; i++) {\n   *     let light = lights[i];\n   *     pointLight(\n   *       color(light.c),\n   *       p5.Vector.fromAngles(t * light.t, t * light.p, width * light.r)\n   *     );\n   *   }\n   *\n   *   specularMaterial(255);\n   *   sphere(width * 0.1);\n   *\n   *   rotateX(t * 0.77);\n   *   rotateY(t * 0.83);\n   *   rotateZ(t * 0.91);\n   *   torus(width * 0.3, width * 0.07, 24, 10);\n   * }\n   *\n   * function mousePressed() {\n   *   setAttributes('perPixelLighting', false);\n   *   noStroke();\n   *   fill(255);\n   * }\n   * function mouseReleased() {\n   *   setAttributes('perPixelLighting', true);\n   *   noStroke();\n   *   fill(255);\n   * }\n   * </code>\n   * </div>\n   *\n   * @alt a rotating cube with smoother edges\n   */\n  /**\n   * @method setAttributes\n   * @for p5\n   * @param  {Object}  obj object with key-value pairs\n   */\n  fn.setAttributes = function (key, value) {\n    if (typeof this._glAttributes === \"undefined\") {\n      console.log(\n        \"You are trying to use setAttributes on a p5.Graphics object \" +\n          \"that does not use a WEBGL renderer.\"\n      );\n      return;\n    }\n    let unchanged = true;\n    if (typeof value !== \"undefined\") {\n      //first time modifying the attributes\n      if (this._glAttributes === null) {\n        this._glAttributes = {};\n      }\n      if (this._glAttributes[key] !== value) {\n        //changing value of previously altered attribute\n        this._glAttributes[key] = value;\n        unchanged = false;\n      }\n      //setting all attributes with some change\n    } else if (key instanceof Object) {\n      if (this._glAttributes !== key) {\n        this._glAttributes = key;\n        unchanged = false;\n      }\n    }\n    //@todo_FES\n    if (!this._renderer.isP3D || unchanged) {\n      return;\n    }\n\n    if (!this._setupDone) {\n      if (this._renderer.geometryBufferCache.numCached() > 0) {\n        p5._friendlyError(\n          \"Sorry, Could not set the attributes, you need to call setAttributes() \" +\n            \"before calling the other drawing methods in setup()\"\n        );\n        return;\n      }\n    }\n\n    this._renderer._resetContext();\n\n    if (this._renderer.states.curCamera) {\n      this._renderer.states.curCamera._renderer = this._renderer;\n    }\n  };\n\n  /**\n   * ensures that p5 is using a 3d renderer. throws an error if not.\n   */\n  fn._assert3d = function (name) {\n    if (!this._renderer.isP3D)\n      throw new Error(\n        `${name}() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information.`\n      );\n  };\n\n  p5.renderers[WEBGL] = p5.RendererGL;\n  p5.renderers[WEBGL2] = p5.RendererGL;\n}\n\n/**\n * @private\n * @param {Uint8Array|Float32Array|undefined} pixels An existing pixels array to reuse if the size is the same\n * @param {WebGLRenderingContext} gl The WebGL context\n * @param {WebGLFramebuffer|null} framebuffer The Framebuffer to read\n * @param {Number} x The x coordiante to read, premultiplied by pixel density\n * @param {Number} y The y coordiante to read, premultiplied by pixel density\n * @param {Number} width The width in pixels to be read (factoring in pixel density)\n * @param {Number} height The height in pixels to be read (factoring in pixel density)\n * @param {GLEnum} format Either RGB or RGBA depending on how many channels to read\n * @param {GLEnum} type The datatype of each channel, e.g. UNSIGNED_BYTE or FLOAT\n * @param {Number|undefined} flipY If provided, the total height with which to flip the y axis about\n * @returns {Uint8Array|Float32Array} pixels A pixels array with the current state of the\n * WebGL context read into it\n */\nfunction readPixelsWebGL(\n  pixels,\n  gl,\n  framebuffer,\n  x,\n  y,\n  width,\n  height,\n  format,\n  type,\n  flipY\n) {\n  // Record the currently bound framebuffer so we can go back to it after, and\n  // bind the framebuffer we want to read from\n  const prevFramebuffer = gl.getParameter(gl.FRAMEBUFFER_BINDING);\n  gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n\n  const channels = format === gl.RGBA ? 4 : 3;\n\n  // Make a pixels buffer if it doesn't already exist\n  const len = width * height * channels;\n  const TypedArrayClass = type === gl.UNSIGNED_BYTE ? Uint8Array : Float32Array;\n  if (!(pixels instanceof TypedArrayClass) || pixels.length !== len) {\n    pixels = new TypedArrayClass(len);\n  }\n\n  gl.readPixels(\n    x,\n    flipY ? flipY - y - height : y,\n    width,\n    height,\n    format,\n    type,\n    pixels\n  );\n\n  // Re-bind whatever was previously bound\n  gl.bindFramebuffer(gl.FRAMEBUFFER, prevFramebuffer);\n\n  if (flipY) {\n    // WebGL pixels are inverted compared to 2D pixels, so we have to flip\n    // the resulting rows. Adapted from https://stackoverflow.com/a/41973289\n    const halfHeight = Math.floor(height / 2);\n    const tmpRow = new TypedArrayClass(width * channels);\n    for (let y = 0; y < halfHeight; y++) {\n      const topOffset = y * width * 4;\n      const bottomOffset = (height - y - 1) * width * 4;\n      tmpRow.set(pixels.subarray(topOffset, topOffset + width * 4));\n      pixels.copyWithin(topOffset, bottomOffset, bottomOffset + width * 4);\n      pixels.set(tmpRow, bottomOffset);\n    }\n  }\n\n  return pixels;\n}\n\n/**\n * @private\n * @param {WebGLRenderingContext} gl The WebGL context\n * @param {WebGLFramebuffer|null} framebuffer The Framebuffer to read\n * @param {Number} x The x coordinate to read, premultiplied by pixel density\n * @param {Number} y The y coordinate to read, premultiplied by pixel density\n * @param {GLEnum} format Either RGB or RGBA depending on how many channels to read\n * @param {GLEnum} type The datatype of each channel, e.g. UNSIGNED_BYTE or FLOAT\n * @param {Number|undefined} flipY If provided, the total height with which to flip the y axis about\n * @returns {Number[]} pixels The channel data for the pixel at that location\n */\nfunction readPixelWebGL(gl, framebuffer, x, y, format, type, flipY) {\n  // Record the currently bound framebuffer so we can go back to it after, and\n  // bind the framebuffer we want to read from\n  const prevFramebuffer = gl.getParameter(gl.FRAMEBUFFER_BINDING);\n  gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n\n  const channels = format === gl.RGBA ? 4 : 3;\n  const TypedArrayClass = type === gl.UNSIGNED_BYTE ? Uint8Array : Float32Array;\n  const pixels = new TypedArrayClass(channels);\n\n  gl.readPixels(x, flipY ? flipY - y - 1 : y, 1, 1, format, type, pixels);\n\n  // Re-bind whatever was previously bound\n  gl.bindFramebuffer(gl.FRAMEBUFFER, prevFramebuffer);\n\n  return Array.from(pixels);\n}\n\nif (typeof p5 !== \"undefined\") {\n  rendererGL(p5, p5.prototype);\n}\n\n/**\n * @module Shape\n * @submodule 3D Primitives\n * @for p5\n * @requires core\n * @requires p5.Geometry\n */\n\n\nfunction primitives3D(p5, fn){\n/**\n * Sets the stroke rendering mode to balance performance and visual features when drawing lines.\n *\n * `strokeMode()` offers two modes:\n *\n * - `SIMPLE`: Optimizes for speed by disabling caps, joins, and stroke color features.\n *   Use this mode for faster line rendering when these visual details are unnecessary.\n * - `FULL`: Enables caps, joins, and stroke color for lines.\n *   This mode provides enhanced visuals but may reduce performance due to additional processing.\n *\n * Choose the mode that best suits your application's needs to either improve rendering speed or enhance visual quality.\n *\n * @method strokeMode\n * @param {String} mode - The stroke mode to set. Possible values are:\n *   - `'SIMPLE'`: Fast rendering without caps, joins, or stroke color.\n *   - `'FULL'`: Detailed rendering with caps, joins, and stroke color.\n *\n * @example\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(300, 300, WEBGL);\n *   describe('A sphere with red stroke and a red, wavy line on a gray background. The wavy line have caps, joins and colors.');\n * }\n *\n * function draw() {\n *   background(128);\n *   strokeMode(FULL); // Enables detailed rendering with caps, joins, and stroke color.\n *   push();\n *   strokeWeight(1);\n *   translate(0, -50, 0);\n *   sphere(50);\n *   pop();\n *   orbitControl();\n *\n *   noFill();\n *   strokeWeight(15);\n *   stroke('red');\n *   beginShape();\n *   bezierOrder(2); // Sets the order of the Bezier curve.\n *   bezierVertex(80, 80);\n *   bezierVertex(50, -40);\n *   bezierVertex(-80, 80);\n *   endShape();\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(300, 300, WEBGL);\n *   describe('A sphere with red stroke and a  wavy line without full curve decorations without caps and color on a gray background.');\n * }\n *\n * function draw() {\n *   background(128);\n *   strokeMode(SIMPLE); // Simplifies stroke rendering for better performance.\n *   \n *   // Draw sphere\n *   push();\n *   strokeWeight(1);\n *   translate(0, -50, 0);\n *   sphere(50);\n *   pop();\n *   orbitControl();\n *\n *   // Draw modified wavy red line\n *   noFill();\n *   strokeWeight(15);\n *   stroke('red');\n *   beginShape();\n *   bezierOrder(2); // Sets the order of the Bezier curve.\n *   bezierVertex(80, 80);\n *   bezierVertex(50, -40);\n *   bezierVertex(-80, 80);\n *   endShape();\n * }\n * </code>\n * </div>\n */\n\n  fn.strokeMode = function (mode) {\n    if (mode === undefined) {\n      return this._renderer._simpleLines ? SIMPLE : FULL;\n    } else if (mode === SIMPLE) {\n      this._renderer._simpleLines = true;\n    } else if (mode === FULL) {\n      this._renderer._simpleLines = false;\n    } else {\n      throw Error('no such parameter');\n    }\n  };\n  /**\n   * Creates a custom <a href=\"#/p5.Geometry\">p5.Geometry</a> object from\n   * simpler 3D shapes.\n   *\n   * `buildGeometry()` helps with creating complex 3D shapes from simpler ones\n   * such as <a href=\"#/p5/sphere\">sphere()</a>. It can help to make sketches\n   * more performant. For example, if a complex 3D shape doesnt change while a\n   * sketch runs, then it can be created with `buildGeometry()`. Creating a\n   * <a href=\"#/p5.Geometry\">p5.Geometry</a> object once and then drawing it\n   * will run faster than repeatedly drawing the individual pieces.\n   *\n   * The parameter, `callback`, is a function with the drawing instructions for\n   * the new <a href=\"#/p5.Geometry\">p5.Geometry</a> object. It will be called\n   * once to create the new 3D shape.\n   *\n   * See <a href=\"#/p5/beginGeometry\">beginGeometry()</a> and\n   * <a href=\"#/p5/endGeometry\">endGeometry()</a> for another way to build 3D\n   * shapes.\n   *\n   * Note: `buildGeometry()` can only be used in WebGL mode.\n   *\n   * @method buildGeometry\n   * @param {Function} callback function that draws the shape.\n   * @returns {p5.Geometry} new 3D shape.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the p5.Geometry object.\n   *   shape = buildGeometry(createShape);\n   *\n   *   describe('A white cone drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the p5.Geometry object.\n   *   noStroke();\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(shape);\n   * }\n   *\n   * // Create p5.Geometry object from a single cone.\n   * function createShape() {\n   *   cone();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the arrow.\n   *   shape = buildGeometry(createArrow);\n   *\n   *   describe('A white arrow drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the arrow.\n   *   noStroke();\n   *\n   *   // Draw the arrow.\n   *   model(shape);\n   * }\n   *\n   * function createArrow() {\n   *   // Add shapes to the p5.Geometry object.\n   *   push();\n   *   rotateX(PI);\n   *   cone(10);\n   *   translate(0, -10, 0);\n   *   cylinder(3, 20);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the p5.Geometry object.\n   *   shape = buildGeometry(createArrow);\n   *\n   *   describe('Two white arrows drawn on a gray background. The arrow on the right rotates slowly.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the arrows.\n   *   noStroke();\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(shape);\n   *\n   *   // Translate and rotate the coordinate system.\n   *   translate(30, 0, 0);\n   *   rotateZ(frameCount * 0.01);\n   *\n   *   // Draw the p5.Geometry object again.\n   *   model(shape);\n   * }\n   *\n   * function createArrow() {\n   *   // Add shapes to the p5.Geometry object.\n   *   push();\n   *   rotateX(PI);\n   *   cone(10);\n   *   translate(0, -10, 0);\n   *   cylinder(3, 20);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let button;\n   * let particles;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a button to reset the particle system.\n   *   button = createButton('Reset');\n   *\n   *   // Call resetModel() when the user presses the button.\n   *   button.mousePressed(resetModel);\n   *\n   *   // Add the original set of particles.\n   *   resetModel();\n   *\n   *   describe('A set of white spheres on a gray background. The spheres are positioned randomly. Their positions reset when the user presses the Reset button.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the particles.\n   *   noStroke();\n   *\n   *   // Draw the particles.\n   *   model(particles);\n   * }\n   *\n   * function resetModel() {\n   *   // If the p5.Geometry object has already been created,\n   *   // free those resources.\n   *   if (particles) {\n   *     freeGeometry(particles);\n   *   }\n   *\n   *   // Create a new p5.Geometry object with random spheres.\n   *   particles = buildGeometry(createParticles);\n   * }\n   *\n   * function createParticles() {\n   *   for (let i = 0; i < 60; i += 1) {\n   *     // Calculate random coordinates.\n   *     let x = randomGaussian(0, 20);\n   *     let y = randomGaussian(0, 20);\n   *     let z = randomGaussian(0, 20);\n   *\n   *     push();\n   *     // Translate to the particle's coordinates.\n   *     translate(x, y, z);\n   *     // Draw the particle.\n   *     sphere(5);\n   *     pop();\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.buildGeometry = function(callback) {\n    return this._renderer.buildGeometry(callback);\n  };\n\n  /**\n   * Clears a <a href=\"#/p5.Geometry\">p5.Geometry</a> object from the graphics\n   * processing unit (GPU) memory.\n   *\n   * <a href=\"#/p5.Geometry\">p5.Geometry</a> objects can contain lots of data\n   * about their vertices, surface normals, colors, and so on. Complex 3D shapes\n   * can use lots of memory which is a limited resource in many GPUs. Calling\n   * `freeGeometry()` can improve performance by freeing a\n   * <a href=\"#/p5.Geometry\">p5.Geometry</a> objects resources from GPU memory.\n   * `freeGeometry()` works with <a href=\"#/p5.Geometry\">p5.Geometry</a> objects\n   * created with <a href=\"#/p5/beginGeometry\">beginGeometry()</a> and\n   * <a href=\"#/p5/endGeometry\">endGeometry()</a>,\n   * <a href=\"#/p5/buildGeometry\">buildGeometry()</a>, and\n   * <a href=\"#/p5/loadModel\">loadModel()</a>.\n   *\n   * The parameter, `geometry`, is the <a href=\"#/p5.Geometry\">p5.Geometry</a>\n   * object to be freed.\n   *\n   * Note: A <a href=\"#/p5.Geometry\">p5.Geometry</a> object can still be drawn\n   * after its resources are cleared from GPU memory. It may take longer to draw\n   * the first time its redrawn.\n   *\n   * Note: `freeGeometry()` can only be used in WebGL mode.\n   *\n   * @method freeGeometry\n   * @param {p5.Geometry} geometry 3D shape whose resources should be freed.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Geometry object.\n   *   beginGeometry();\n   *   cone();\n   *   let shape = endGeometry();\n   *\n   *   // Draw the shape.\n   *   model(shape);\n   *\n   *   // Free the shape's resources.\n   *   freeGeometry(shape);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let button;\n   * let particles;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a button to reset the particle system.\n   *   button = createButton('Reset');\n   *\n   *   // Call resetModel() when the user presses the button.\n   *   button.mousePressed(resetModel);\n   *\n   *   // Add the original set of particles.\n   *   resetModel();\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the particles.\n   *   noStroke();\n   *\n   *   // Draw the particles.\n   *   model(particles);\n   * }\n   *\n   * function resetModel() {\n   *   // If the p5.Geometry object has already been created,\n   *   // free those resources.\n   *   if (particles) {\n   *     freeGeometry(particles);\n   *   }\n   *\n   *   // Create a new p5.Geometry object with random spheres.\n   *   particles = buildGeometry(createParticles);\n   * }\n   *\n   * function createParticles() {\n   *   for (let i = 0; i < 60; i += 1) {\n   *     // Calculate random coordinates.\n   *     let x = randomGaussian(0, 20);\n   *     let y = randomGaussian(0, 20);\n   *     let z = randomGaussian(0, 20);\n   *\n   *     push();\n   *     // Translate to the particle's coordinates.\n   *     translate(x, y, z);\n   *     // Draw the particle.\n   *     sphere(5);\n   *     pop();\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.freeGeometry = function(geometry) {\n    this._renderer.geometryBufferCache.freeBuffers(geometry.gid);\n  };\n\n  /**\n   * Draws a plane.\n   *\n   * A plane is a four-sided, flat shape with every angle measuring 90. Its\n   * similar to a rectangle and offers advanced drawing features in WebGL mode.\n   *\n   * The first parameter, `width`, is optional. If a `Number` is passed, as in\n   * `plane(20)`, it sets the planes width and height. By default, `width` is\n   * 50.\n   *\n   * The second parameter, `height`, is also optional. If a `Number` is passed,\n   * as in `plane(20, 30)`, it sets the planes height. By default, `height` is\n   * set to the planes `width`.\n   *\n   * The third parameter, `detailX`, is also optional. If a `Number` is passed,\n   * as in `plane(20, 30, 5)` it sets the number of triangle subdivisions to use\n   * along the x-axis. All 3D shapes are made by connecting triangles to form\n   * their surfaces. By default, `detailX` is 1.\n   *\n   * The fourth parameter, `detailY`, is also optional. If a `Number` is passed,\n   * as in `plane(20, 30, 5, 7)` it sets the number of triangle subdivisions to\n   * use along the y-axis. All 3D shapes are made by connecting triangles to\n   * form their surfaces. By default, `detailY` is 1.\n   *\n   * Note: `plane()` can only be used in WebGL mode.\n   *\n   * @method plane\n   * @param  {Number} [width]    width of the plane.\n   * @param  {Number} [height]   height of the plane.\n   * @param  {Integer} [detailX] number of triangle subdivisions along the x-axis.\n   * @param {Integer} [detailY]  number of triangle subdivisions along the y-axis.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white plane on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the plane.\n   *   plane();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white plane on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the plane.\n   *   // Set its width and height to 30.\n   *   plane(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white plane on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the plane.\n   *   // Set its width to 30 and height to 50.\n   *   plane(30, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.plane = function(\n    width = 50,\n    height = width,\n    detailX = 1,\n    detailY = 1\n  ) {\n    this._assert3d('plane');\n    // p5._validateParameters('plane', arguments);\n\n    this._renderer.plane(width, height, detailX, detailY);\n    return this;\n  };\n\n  /**\n   * Draws a box (rectangular prism).\n   *\n   * A box is a 3D shape with six faces. Each face makes a 90 with four\n   * neighboring faces.\n   *\n   * The first parameter, `width`, is optional. If a `Number` is passed, as in\n   * `box(20)`, it sets the boxs width and height. By default, `width` is 50.\n   *\n   * The second parameter, `height`, is also optional. If a `Number` is passed,\n   * as in `box(20, 30)`, it sets the boxs height. By default, `height` is set\n   * to the boxs `width`.\n   *\n   * The third parameter, `depth`, is also optional. If a `Number` is passed, as\n   * in `box(20, 30, 40)`, it sets the boxs depth. By default, `depth` is set\n   * to the boxs `height`.\n   *\n   * The fourth parameter, `detailX`, is also optional. If a `Number` is passed,\n   * as in `box(20, 30, 40, 5)`, it sets the number of triangle subdivisions to\n   * use along the x-axis. All 3D shapes are made by connecting triangles to\n   * form their surfaces. By default, `detailX` is 1.\n   *\n   * The fifth parameter, `detailY`, is also optional. If a number is passed, as\n   * in `box(20, 30, 40, 5, 7)`, it sets the number of triangle subdivisions to\n   * use along the y-axis. All 3D shapes are made by connecting triangles to\n   * form their surfaces. By default, `detailY` is 1.\n   *\n   * Note: `box()` can only be used in WebGL mode.\n   *\n   * @method  box\n   * @param  {Number} [width]     width of the box.\n   * @param  {Number} [height]    height of the box.\n   * @param  {Number} [depth]     depth of the box.\n   * @param {Integer} [detailX]   number of triangle subdivisions along the x-axis.\n   * @param {Integer} [detailY]   number of triangle subdivisions along the y-axis.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white box on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white box on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the box.\n   *   // Set its width and height to 30.\n   *   box(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white box on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the box.\n   *   // Set its width to 30 and height to 50.\n   *   box(30, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white box on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the box.\n   *   // Set its width to 30, height to 50, and depth to 10.\n   *   box(30, 50, 10);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.box = function(width, height, depth, detailX, detailY) {\n    this._assert3d('box');\n    // p5._validateParameters('box', arguments);\n\n    this._renderer.box(width, height, depth, detailX, detailY);\n\n    return this;\n  };\n\n  /**\n   * Draws a sphere.\n   *\n   * A sphere is a 3D shape with triangular faces that connect to form a round\n   * surface. Spheres with few faces look like crystals. Spheres with many faces\n   * have smooth surfaces and look like balls.\n   *\n   * The first parameter, `radius`, is optional. If a `Number` is passed, as in\n   * `sphere(20)`, it sets the radius of the sphere. By default, `radius` is 50.\n   *\n   * The second parameter, `detailX`, is also optional. If a `Number` is passed,\n   * as in `sphere(20, 5)`, it sets the number of triangle subdivisions to use\n   * along the x-axis. All 3D shapes are made by connecting triangles to form\n   * their surfaces. By default, `detailX` is 24.\n   *\n   * The third parameter, `detailY`, is also optional. If a `Number` is passed,\n   * as in `sphere(20, 5, 2)`, it sets the number of triangle subdivisions to\n   * use along the y-axis. All 3D shapes are made by connecting triangles to\n   * form their surfaces. By default, `detailY` is 16.\n   *\n   * Note: `sphere()` can only be used in WebGL mode.\n   *\n   * @method sphere\n   * @param  {Number} [radius]   radius of the sphere. Defaults to 50.\n   * @param  {Integer} [detailX] number of triangle subdivisions along the x-axis. Defaults to 24.\n   * @param  {Integer} [detailY] number of triangle subdivisions along the y-axis. Defaults to 16.\n   *\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white sphere on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the sphere.\n   *   sphere();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white sphere on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the sphere.\n   *   // Set its radius to 30.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white sphere on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the sphere.\n   *   // Set its radius to 30.\n   *   // Set its detailX to 6.\n   *   sphere(30, 6);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white sphere on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the sphere.\n   *   // Set its radius to 30.\n   *   // Set its detailX to 24.\n   *   // Set its detailY to 4.\n   *   sphere(30, 24, 4);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.sphere = function(radius = 50, detailX = 24, detailY = 16) {\n    this._assert3d('sphere');\n    // p5._validateParameters('sphere', arguments);\n\n    this._renderer.sphere(radius, detailX, detailY);\n\n    return this;\n  };\n\n  /**\n   * Draws a cylinder.\n   *\n   * A cylinder is a 3D shape with triangular faces that connect a flat bottom\n   * to a flat top. Cylinders with few faces look like boxes. Cylinders with\n   * many faces have smooth surfaces.\n   *\n   * The first parameter, `radius`, is optional. If a `Number` is passed, as in\n   * `cylinder(20)`, it sets the radius of the cylinders base. By default,\n   * `radius` is 50.\n   *\n   * The second parameter, `height`, is also optional. If a `Number` is passed,\n   * as in `cylinder(20, 30)`, it sets the cylinders height. By default,\n   * `height` is set to the cylinders `radius`.\n   *\n   * The third parameter, `detailX`, is also optional. If a `Number` is passed,\n   * as in `cylinder(20, 30, 5)`, it sets the number of edges used to form the\n   * cylinder's top and bottom. Using more edges makes the top and bottom look\n   * more like circles. By default, `detailX` is 24.\n   *\n   * The fourth parameter, `detailY`, is also optional. If a `Number` is passed,\n   * as in `cylinder(20, 30, 5, 2)`, it sets the number of triangle subdivisions\n   * to use along the y-axis, between cylinder's the top and bottom. All 3D\n   * shapes are made by connecting triangles to form their surfaces. By default,\n   * `detailY` is 1.\n   *\n   * The fifth parameter, `bottomCap`, is also optional. If a `false` is passed,\n   * as in `cylinder(20, 30, 5, 2, false)` the cylinders bottom wont be drawn.\n   * By default, `bottomCap` is `true`.\n   *\n   * The sixth parameter, `topCap`, is also optional. If a `false` is passed, as\n   * in `cylinder(20, 30, 5, 2, false, false)` the cylinders top wont be\n   * drawn. By default, `topCap` is `true`.\n   *\n   * Note: `cylinder()` can only be used in WebGL mode.\n   *\n   * @method cylinder\n   * @param  {Number}  [radius]    radius of the cylinder. Defaults to 50.\n   * @param  {Number}  [height]    height of the cylinder. Defaults to the value of `radius`.\n   * @param  {Integer} [detailX]   number of edges along the top and bottom. Defaults to 24.\n   * @param  {Integer} [detailY]   number of triangle subdivisions along the y-axis. Defaults to 1.\n   * @param  {Boolean} [bottomCap] whether to draw the cylinder's bottom. Defaults to `true`.\n   * @param  {Boolean} [topCap]    whether to draw the cylinder's top. Defaults to `true`.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cylinder on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cylinder.\n   *   cylinder();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cylinder on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cylinder.\n   *   // Set its radius and height to 30.\n   *   cylinder(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cylinder on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cylinder.\n   *   // Set its radius to 30 and height to 50.\n   *   cylinder(30, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white box on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cylinder.\n   *   // Set its radius to 30 and height to 50.\n   *   // Set its detailX to 5.\n   *   cylinder(30, 50, 5);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cylinder on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cylinder.\n   *   // Set its radius to 30 and height to 50.\n   *   // Set its detailX to 24 and detailY to 2.\n   *   cylinder(30, 50, 24, 2);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cylinder on a gray background. Its top is missing.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cylinder.\n   *   // Set its radius to 30 and height to 50.\n   *   // Set its detailX to 24 and detailY to 1.\n   *   // Don't draw its bottom.\n   *   cylinder(30, 50, 24, 1, false);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cylinder on a gray background. Its top and bottom are missing.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cylinder.\n   *   // Set its radius to 30 and height to 50.\n   *   // Set its detailX to 24 and detailY to 1.\n   *   // Don't draw its bottom or top.\n   *   cylinder(30, 50, 24, 1, false, false);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.cylinder = function(\n    radius = 50,\n    height = radius,\n    detailX = 24,\n    detailY = 1,\n    bottomCap = true,\n    topCap = true\n  ) {\n    this._assert3d('cylinder');\n    // p5._validateParameters('cylinder', arguments);\n\n    this._renderer.cylinder(radius, height, detailX, detailY, bottomCap, topCap);\n\n    return this;\n  };\n\n  /**\n   * Draws a cone.\n   *\n   * A cone is a 3D shape with triangular faces that connect a flat bottom to a\n   * single point. Cones with few faces look like pyramids. Cones with many\n   * faces have smooth surfaces.\n   *\n   * The first parameter, `radius`, is optional. If a `Number` is passed, as in\n   * `cone(20)`, it sets the radius of the cones base. By default, `radius` is\n   * 50.\n   *\n   * The second parameter, `height`, is also optional. If a `Number` is passed,\n   * as in `cone(20, 30)`, it sets the cones height. By default, `height` is\n   * set to the cones `radius`.\n   *\n   * The third parameter, `detailX`, is also optional. If a `Number` is passed,\n   * as in `cone(20, 30, 5)`, it sets the number of edges used to form the\n   * cone's base. Using more edges makes the base look more like a circle. By\n   * default, `detailX` is 24.\n   *\n   * The fourth parameter, `detailY`, is also optional. If a `Number` is passed,\n   * as in `cone(20, 30, 5, 7)`, it sets the number of triangle subdivisions to\n   * use along the y-axis connecting the base to the tip. All 3D shapes are made\n   * by connecting triangles to form their surfaces. By default, `detailY` is 1.\n   *\n   * The fifth parameter, `cap`, is also optional. If a `false` is passed, as\n   * in `cone(20, 30, 5, 7, false)` the cones base wont be drawn. By default,\n   * `cap` is `true`.\n   *\n   * Note: `cone()` can only be used in WebGL mode.\n   *\n   * @method cone\n   * @param  {Number}  [radius]  radius of the cone's base. Defaults to 50.\n   * @param  {Number}  [height]  height of the cone. Defaults to the value of `radius`.\n   * @param  {Integer} [detailX] number of edges used to draw the base. Defaults to 24.\n   * @param  {Integer} [detailY] number of triangle subdivisions along the y-axis. Defaults to 1.\n   * @param  {Boolean} [cap]     whether to draw the cone's base.  Defaults to `true`.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cone on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cone.\n   *   cone();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cone on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cone.\n   *   // Set its radius and height to 30.\n   *   cone(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cone on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cone.\n   *   // Set its radius to 30 and height to 50.\n   *   cone(30, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cone on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cone.\n   *   // Set its radius to 30 and height to 50.\n   *   // Set its detailX to 5.\n   *   cone(30, 50, 5);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white pyramid on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cone.\n   *   // Set its radius to 30 and height to 50.\n   *   // Set its detailX to 5.\n   *   cone(30, 50, 5);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cone on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cone.\n   *   // Set its radius to 30 and height to 50.\n   *   // Set its detailX to 24 and detailY to 2.\n   *   cone(30, 50, 24, 2);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white cone on a gray background. Its base is missing.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the cone.\n   *   // Set its radius to 30 and height to 50.\n   *   // Set its detailX to 24 and detailY to 1.\n   *   // Don't draw its base.\n   *   cone(30, 50, 24, 1, false);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.cone = function(\n    radius = 50,\n    height = radius,\n    detailX = 24,\n    detailY = 1,\n    cap = true\n  ) {\n    this._assert3d('cone');\n    // p5._validateParameters('cone', arguments);\n\n    this._renderer.cone(radius, height, detailX, detailY, cap);\n\n    return this;\n  };\n\n  /**\n   * Draws an ellipsoid.\n   *\n   * An ellipsoid is a 3D shape with triangular faces that connect to form a\n   * round surface. Ellipsoids with few faces look like crystals. Ellipsoids\n   * with many faces have smooth surfaces and look like eggs. `ellipsoid()`\n   * defines a shape by its radii. This is different from\n   * <a href=\"#/p5/ellipse\">ellipse()</a> which uses diameters\n   * (width and height).\n   *\n   * The first parameter, `radiusX`, is optional. If a `Number` is passed, as in\n   * `ellipsoid(20)`, it sets the radius of the ellipsoid along the x-axis. By\n   * default, `radiusX` is 50.\n   *\n   * The second parameter, `radiusY`, is also optional. If a `Number` is passed,\n   * as in `ellipsoid(20, 30)`, it sets the ellipsoids radius along the y-axis.\n   * By default, `radiusY` is set to the ellipsoids `radiusX`.\n   *\n   * The third parameter, `radiusZ`, is also optional. If a `Number` is passed,\n   * as in `ellipsoid(20, 30, 40)`, it sets the ellipsoids radius along the\n   * z-axis. By default, `radiusZ` is set to the ellipsoids `radiusY`.\n   *\n   * The fourth parameter, `detailX`, is also optional. If a `Number` is passed,\n   * as in `ellipsoid(20, 30, 40, 5)`, it sets the number of triangle\n   * subdivisions to use along the x-axis. All 3D shapes are made by connecting\n   * triangles to form their surfaces. By default, `detailX` is 24.\n   *\n   * The fifth parameter, `detailY`, is also optional. If a `Number` is passed,\n   * as in `ellipsoid(20, 30, 40, 5, 7)`, it sets the number of triangle\n   * subdivisions to use along the y-axis. All 3D shapes are made by connecting\n   * triangles to form their surfaces. By default, `detailY` is 16.\n   *\n   * Note: `ellipsoid()` can only be used in WebGL mode.\n   *\n   * @method ellipsoid\n   * @param  {Number} [radiusX]  radius of the ellipsoid along the x-axis. Defaults to 50.\n   * @param  {Number} [radiusY]  radius of the ellipsoid along the y-axis. Defaults to `radiusX`.\n   * @param  {Number} [radiusZ]  radius of the ellipsoid along the z-axis. Defaults to `radiusY`.\n   * @param  {Integer} [detailX] number of triangle subdivisions along the x-axis. Defaults to 24.\n   * @param  {Integer} [detailY] number of triangle subdivisions along the y-axis. Defaults to 16.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white sphere on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the ellipsoid.\n   *   // Set its radiusX to 30.\n   *   ellipsoid(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white ellipsoid on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the ellipsoid.\n   *   // Set its radiusX to 30.\n   *   // Set its radiusY to 40.\n   *   ellipsoid(30, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white ellipsoid on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the ellipsoid.\n   *   // Set its radiusX to 30.\n   *   // Set its radiusY to 40.\n   *   // Set its radiusZ to 50.\n   *   ellipsoid(30, 40, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white ellipsoid on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the ellipsoid.\n   *   // Set its radiusX to 30.\n   *   // Set its radiusY to 40.\n   *   // Set its radiusZ to 50.\n   *   // Set its detailX to 4.\n   *   ellipsoid(30, 40, 50, 4);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white ellipsoid on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the ellipsoid.\n   *   // Set its radiusX to 30.\n   *   // Set its radiusY to 40.\n   *   // Set its radiusZ to 50.\n   *   // Set its detailX to 4.\n   *   // Set its detailY to 3.\n   *   ellipsoid(30, 40, 50, 4, 3);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.ellipsoid = function(\n    radiusX = 50,\n    radiusY = radiusX,\n    radiusZ = radiusX,\n    detailX = 24,\n    detailY = 16\n  ) {\n    this._assert3d('ellipsoid');\n    // p5._validateParameters('ellipsoid', arguments);\n\n    this._renderer.ellipsoid(radiusX, radiusY, radiusZ, detailX, detailY);\n\n    return this;\n  };\n\n  /**\n   * Draws a torus.\n   *\n   * A torus is a 3D shape with triangular faces that connect to form a ring.\n   * Toruses with few faces look flattened. Toruses with many faces have smooth\n   * surfaces.\n   *\n   * The first parameter, `radius`, is optional. If a `Number` is passed, as in\n   * `torus(30)`, it sets the radius of the ring. By default, `radius` is 50.\n   *\n   * The second parameter, `tubeRadius`, is also optional. If a `Number` is\n   * passed, as in `torus(30, 15)`, it sets the radius of the tube. By default,\n   * `tubeRadius` is 10.\n   *\n   * The third parameter, `detailX`, is also optional. If a `Number` is passed,\n   * as in `torus(30, 15, 5)`, it sets the number of edges used to draw the hole\n   * of the torus. Using more edges makes the hole look more like a circle. By\n   * default, `detailX` is 24.\n   *\n   * The fourth parameter, `detailY`, is also optional. If a `Number` is passed,\n   * as in `torus(30, 15, 5, 7)`, it sets the number of triangle subdivisions to\n   * use while filling in the torus height. By default, `detailY` is 16.\n   *\n   * Note: `torus()` can only be used in WebGL mode.\n   *\n   * @method torus\n   * @param  {Number} [radius]      radius of the torus. Defaults to 50.\n   * @param  {Number} [tubeRadius]  radius of the tube. Defaults to 10.\n   * @param  {Integer} [detailX]    number of edges that form the hole. Defaults to 24.\n   * @param  {Integer} [detailY]    number of triangle subdivisions along the y-axis. Defaults to 16.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white torus on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the torus.\n   *   torus();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white torus on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the torus.\n   *   // Set its radius to 30.\n   *   torus(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white torus on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the torus.\n   *   // Set its radius to 30 and tubeRadius to 15.\n   *   torus(30, 15);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white torus on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the torus.\n   *   // Set its radius to 30 and tubeRadius to 15.\n   *   // Set its detailX to 5.\n   *   torus(30, 15, 5);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white torus on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the torus.\n   *   // Set its radius to 30 and tubeRadius to 15.\n   *   // Set its detailX to 5.\n   *   // Set its detailY to 3.\n   *   torus(30, 15, 5, 3);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.torus = function(radius, tubeRadius, detailX, detailY) {\n    this._assert3d('torus');\n    // p5._validateParameters('torus', arguments);\n\n    this._renderer.torus(radius, tubeRadius, detailX, detailY);\n\n    return this;\n  };\n\n  ///////////////////////\n  ///  2D primitives  ///\n  ///////////////////////\n  //\n  // Note: Documentation is not generated on the p5.js website for functions on\n  // the p5.RendererGL prototype.\n\n  /**\n   * Draws a point, a coordinate in space at the dimension of one pixel,\n   * given x, y and z coordinates. The color of the point is determined\n   * by the current stroke, while the point size is determined by current\n   * stroke weight.\n   * @private\n   * @param {Number} x x-coordinate of point\n   * @param {Number} y y-coordinate of point\n   * @param {Number} z z-coordinate of point\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *   stroke(255);\n   *   strokeWeight(4);\n   *   point(25, 0);\n   *   strokeWeight(3);\n   *   point(-25, 0);\n   *   strokeWeight(2);\n   *   point(0, 25);\n   *   strokeWeight(1);\n   *   point(0, -25);\n   * }\n   * </code>\n   * </div>\n   */\n  RendererGL.prototype.point = function(x, y, z = 0) {\n\n    const _vertex = [];\n    _vertex.push(new Vector(x, y, z));\n    this._drawPoints(_vertex, this.buffers.point);\n\n    return this;\n  };\n\n  RendererGL.prototype.triangle = function(args) {\n    const x1 = args[0],\n      y1 = args[1];\n    const x2 = args[2],\n      y2 = args[3];\n    const x3 = args[4],\n      y3 = args[5];\n\n    const gid = 'tri';\n    if (!this.geometryInHash(gid)) {\n      const _triangle = function() {\n        const vertices = [];\n        vertices.push(new Vector(0, 0, 0));\n        vertices.push(new Vector(1, 0, 0));\n        vertices.push(new Vector(0, 1, 0));\n        this.edges = [[0, 1], [1, 2], [2, 0]];\n        this.vertices = vertices;\n        this.faces = [[0, 1, 2]];\n        this.uvs = [0, 0, 1, 0, 1, 1];\n      };\n      const triGeom = new Geometry(1, 1, _triangle, this);\n      triGeom._edgesToVertices();\n      triGeom.computeNormals();\n      triGeom.gid = gid;\n      this.geometryBufferCache.ensureCached(triGeom);\n    }\n\n    // only one triangle is cached, one point is at the origin, and the\n    // two adjacent sides are tne unit vectors along the X & Y axes.\n    //\n    // this matrix multiplication transforms those two unit vectors\n    // onto the required vector prior to rendering, and moves the\n    // origin appropriately.\n    const uModelMatrix = this.states.uModelMatrix.copy();\n    try {\n      // triangle orientation.\n      const orientation = Math.sign(x1*y2-x2*y1 + x2*y3-x3*y2 + x3*y1-x1*y3);\n      const mult = new Matrix([\n        x2 - x1, y2 - y1, 0, 0, // the resulting unit X-axis\n        x3 - x1, y3 - y1, 0, 0, // the resulting unit Y-axis\n        0, 0, orientation, 0,   // the resulting unit Z-axis (Reflect the specified order of vertices)\n        x1, y1, 0, 1            // the resulting origin\n      ]).mult(this.states.uModelMatrix);\n\n      this.states.setValue('uModelMatrix', mult);\n\n      this._drawGeometry(this.geometryBufferCache.getGeometryByID(gid));\n    } finally {\n      this.states.setValue('uModelMatrix', uModelMatrix);\n    }\n\n    return this;\n  };\n\n  RendererGL.prototype.ellipse = function(args) {\n    this.arc(\n      args[0],\n      args[1],\n      args[2],\n      args[3],\n      0,\n      TWO_PI,\n      OPEN,\n      args[4]\n    );\n  };\n\n  RendererGL.prototype.arc = function(...args) {\n    const x = args[0];\n    const y = args[1];\n    const width = args[2];\n    const height = args[3];\n    const start = args[4];\n    const stop = args[5];\n    const mode = args[6];\n    const detail = args[7] || 25;\n\n    let shape;\n    let gid;\n\n    // check if it is an ellipse or an arc\n    if (Math.abs(stop - start) >= TWO_PI) {\n      shape = 'ellipse';\n      gid = `${shape}|${detail}|`;\n    } else {\n      shape = 'arc';\n      gid = `${shape}|${start}|${stop}|${mode}|${detail}|`;\n    }\n\n    if (!this.geometryInHash(gid)) {\n      const _arc = function() {\n\n        // if the start and stop angles are not the same, push vertices to the array\n        if (start.toFixed(10) !== stop.toFixed(10)) {\n          // if the mode specified is PIE or null, push the mid point of the arc in vertices\n          if (mode === PIE || typeof mode === 'undefined') {\n            this.vertices.push(new Vector(0.5, 0.5, 0));\n            this.uvs.push([0.5, 0.5]);\n          }\n\n          // vertices for the perimeter of the circle\n          for (let i = 0; i <= detail; i++) {\n            const u = i / detail;\n            const theta = (stop - start) * u + start;\n\n            const _x = 0.5 + Math.cos(theta) / 2;\n            const _y = 0.5 + Math.sin(theta) / 2;\n\n            this.vertices.push(new Vector(_x, _y, 0));\n            this.uvs.push([_x, _y]);\n\n            if (i < detail - 1) {\n              this.faces.push([0, i + 1, i + 2]);\n              this.edges.push([i + 1, i + 2]);\n            }\n          }\n\n          // check the mode specified in order to push vertices and faces, different for each mode\n          switch (mode) {\n            case PIE:\n              this.faces.push([\n                0,\n                this.vertices.length - 2,\n                this.vertices.length - 1\n              ]);\n              this.edges.push([0, 1]);\n              this.edges.push([\n                this.vertices.length - 2,\n                this.vertices.length - 1\n              ]);\n              this.edges.push([0, this.vertices.length - 1]);\n              break;\n\n            case CHORD:\n              this.edges.push([0, 1]);\n              this.edges.push([0, this.vertices.length - 1]);\n              break;\n\n            case OPEN:\n              this.edges.push([0, 1]);\n              break;\n\n            default:\n              this.faces.push([\n                0,\n                this.vertices.length - 2,\n                this.vertices.length - 1\n              ]);\n              this.edges.push([\n                this.vertices.length - 2,\n                this.vertices.length - 1\n              ]);\n          }\n        }\n      };\n\n      const arcGeom = new Geometry(detail, 1, _arc, this);\n      arcGeom.computeNormals();\n\n      if (detail <= 50) {\n        arcGeom._edgesToVertices(arcGeom);\n      } else if (this.states.strokeColor) {\n        console.log(\n          `Cannot apply a stroke to an ${shape} with more than 50 detail`\n        );\n      }\n\n      arcGeom.gid = gid;\n      this.geometryBufferCache.ensureCached(arcGeom);\n    }\n\n    const uModelMatrix = this.states.uModelMatrix;\n    this.states.setValue('uModelMatrix', this.states.uModelMatrix.clone());\n\n    try {\n      this.states.uModelMatrix.translate([x, y, 0]);\n      this.states.uModelMatrix.scale(width, height, 1);\n\n      this._drawGeometry(this.geometryBufferCache.getGeometryByID(gid));\n    } finally {\n      this.states.setValue('uModelMatrix', uModelMatrix);\n    }\n\n    return this;\n  };\n\n  RendererGL.prototype.rect = function(args) {\n    const x = args[0];\n    const y = args[1];\n    const width = args[2];\n    const height = args[3];\n\n    if (typeof args[4] === 'undefined') {\n      // Use the retained mode for drawing rectangle,\n      // if args for rounding rectangle is not provided by user.\n      const perPixelLighting = this._pInst._glAttributes.perPixelLighting;\n      const detailX = args[4] || (perPixelLighting ? 1 : 24);\n      const detailY = args[5] || (perPixelLighting ? 1 : 16);\n      const gid = `rect|${detailX}|${detailY}`;\n      if (!this.geometryInHash(gid)) {\n        const _rect = function() {\n          for (let i = 0; i <= this.detailY; i++) {\n            const v = i / this.detailY;\n            for (let j = 0; j <= this.detailX; j++) {\n              const u = j / this.detailX;\n              const p = new Vector(u, v, 0);\n              this.vertices.push(p);\n              this.uvs.push(u, v);\n            }\n          }\n          // using stroke indices to avoid stroke over face(s) of rectangle\n          if (detailX > 0 && detailY > 0) {\n            this.edges = [\n              [0, detailX],\n              [detailX, (detailX + 1) * (detailY + 1) - 1],\n              [(detailX + 1) * (detailY + 1) - 1, (detailX + 1) * detailY],\n              [(detailX + 1) * detailY, 0]\n            ];\n          }\n        };\n        const rectGeom = new Geometry(detailX, detailY, _rect, this);\n        rectGeom\n          .computeFaces()\n          .computeNormals()\n          ._edgesToVertices();\n        rectGeom.gid = gid;\n        this.geometryBufferCache.ensureCached(rectGeom);\n      }\n\n      // only a single rectangle (of a given detail) is cached: a square with\n      // opposite corners at (0,0) & (1,1).\n      //\n      // before rendering, this square is scaled & moved to the required location.\n      const uModelMatrix = this.states.uModelMatrix;\n      this.states.setValue('uModelMatrix', this.states.uModelMatrix.copy());\n      try {\n        this.states.uModelMatrix.translate([x, y, 0]);\n        this.states.uModelMatrix.scale(width, height, 1);\n\n        this._drawGeometry(this.geometryBufferCache.getGeometryByID(gid));\n      } finally {\n        this.states.setValue('uModelMatrix', uModelMatrix);\n      }\n    } else {\n      // Use Immediate mode to round the rectangle corner,\n      // if args for rounding corners is provided by user\n      let tl = args[4];\n      let tr = typeof args[5] === 'undefined' ? tl : args[5];\n      let br = typeof args[6] === 'undefined' ? tr : args[6];\n      let bl = typeof args[7] === 'undefined' ? br : args[7];\n\n      let a = x;\n      let b = y;\n      let c = width;\n      let d = height;\n\n      c += a;\n      d += b;\n\n      if (a > c) {\n        const temp = a;\n        a = c;\n        c = temp;\n      }\n\n      if (b > d) {\n        const temp = b;\n        b = d;\n        d = temp;\n      }\n\n      const maxRounding = Math.min((c - a) / 2, (d - b) / 2);\n      if (tl > maxRounding) tl = maxRounding;\n      if (tr > maxRounding) tr = maxRounding;\n      if (br > maxRounding) br = maxRounding;\n      if (bl > maxRounding) bl = maxRounding;\n\n      let x1 = a;\n      let y1 = b;\n      let x2 = c;\n      let y2 = d;\n\n      const prevMode = this.states.textureMode;\n      this.states.setValue('textureMode', NORMAL);\n      const prevOrder = this.bezierOrder();\n      this.bezierOrder(2);\n      this.beginShape();\n      const addUVs = (x, y) => [x, y, (x - x1)/width, (y - y1)/height];\n      if (tr !== 0) {\n        this.vertex(...addUVs(x2 - tr, y1));\n        this.bezierVertex(...addUVs(x2, y1));\n        this.bezierVertex(...addUVs(x2, y1 + tr));\n      } else {\n        this.vertex(...addUVs(x2, y1));\n      }\n      if (br !== 0) {\n        this.vertex(...addUVs(x2, y2 - br));\n        this.bezierVertex(...addUVs(x2, y2));\n        this.bezierVertex(...addUVs(x2 - br, y2));\n      } else {\n        this.vertex(...addUVs(x2, y2));\n      }\n      if (bl !== 0) {\n        this.vertex(...addUVs(x1 + bl, y2));\n        this.bezierVertex(...addUVs(x1, y2));\n        this.bezierVertex(...addUVs(x1, y2 - bl));\n      } else {\n        this.vertex(...addUVs(x1, y2));\n      }\n      if (tl !== 0) {\n        this.vertex(...addUVs(x1, y1 + tl));\n        this.bezierVertex(...addUVs(x1, y1));\n        this.bezierVertex(...addUVs(x1 + tl, y1));\n      } else {\n        this.vertex(...addUVs(x1, y1));\n      }\n\n      this.endShape(CLOSE);\n      this.states.setValue('textureMode', prevMode);\n      this.bezierOrder(prevOrder);\n    }\n    return this;\n  };\n\n  /* eslint-disable max-len */\n  RendererGL.prototype.quad = function(x1, y1, z1, x2, y2, z2, x3, y3, z3, x4, y4, z4, detailX=2, detailY=2) {\n    /* eslint-enable max-len */\n\n    const gid =\n      `quad|${x1}|${y1}|${z1}|${x2}|${y2}|${z2}|${x3}|${y3}|${z3}|${x4}|${y4}|${z4}|${detailX}|${detailY}`;\n\n    if (!this.geometryInHash(gid)) {\n      const quadGeom = new Geometry(detailX, detailY, function() {\n        //algorithm adapted from c++ to js\n        //https://stackoverflow.com/questions/16989181/whats-the-correct-way-to-draw-a-distorted-plane-in-opengl/16993202#16993202\n        let xRes = 1.0 / (this.detailX - 1);\n        let yRes = 1.0 / (this.detailY - 1);\n        for (let y = 0; y < this.detailY; y++) {\n          for (let x = 0; x < this.detailX; x++) {\n            let pctx = x * xRes;\n            let pcty = y * yRes;\n\n            let linePt0x = (1 - pcty) * x1 + pcty * x4;\n            let linePt0y = (1 - pcty) * y1 + pcty * y4;\n            let linePt0z = (1 - pcty) * z1 + pcty * z4;\n            let linePt1x = (1 - pcty) * x2 + pcty * x3;\n            let linePt1y = (1 - pcty) * y2 + pcty * y3;\n            let linePt1z = (1 - pcty) * z2 + pcty * z3;\n\n            let ptx = (1 - pctx) * linePt0x + pctx * linePt1x;\n            let pty = (1 - pctx) * linePt0y + pctx * linePt1y;\n            let ptz = (1 - pctx) * linePt0z + pctx * linePt1z;\n\n            this.vertices.push(new Vector(ptx, pty, ptz));\n            this.uvs.push([pctx, pcty]);\n          }\n        }\n      }, this);\n\n      quadGeom.faces = [];\n      for(let y = 0; y < detailY-1; y++){\n        for(let x = 0; x < detailX-1; x++){\n          let pt0 = x + y * detailX;\n          let pt1 = (x + 1) + y * detailX;\n          let pt2 = (x + 1) + (y + 1) * detailX;\n          let pt3 = x + (y + 1) * detailX;\n          quadGeom.faces.push([pt0, pt1, pt2]);\n          quadGeom.faces.push([pt0, pt2, pt3]);\n        }\n      }\n      quadGeom.computeNormals();\n      quadGeom.edges.length = 0;\n      const vertexOrder = [0, 2, 3, 1];\n      for (let i = 0; i < vertexOrder.length; i++) {\n        const startVertex = vertexOrder[i];\n        const endVertex = vertexOrder[(i + 1) % vertexOrder.length];\n        quadGeom.edges.push([startVertex, endVertex]);\n      }\n      quadGeom._edgesToVertices();\n      quadGeom.gid = gid;\n      this.geometryBufferCache.ensureCached(quadGeom);\n    }\n    this._drawGeometry(this.geometryBufferCache.getGeometryByID(gid));\n    return this;\n  };\n\n  //this implementation of bezier curve\n  //is based on Bernstein polynomial\n  // pretier-ignore\n  RendererGL.prototype.bezier = function(\n    x1,\n    y1,\n    z1, // x2\n    x2, // y2\n    y2, // x3\n    z2, // y3\n    x3, // x4\n    y3, // y4\n    z3,\n    x4,\n    y4,\n    z4\n  ) {\n    if (arguments.length === 8) {\n      y4 = y3;\n      x4 = x3;\n      y3 = z2;\n      x3 = y2;\n      y2 = x2;\n      x2 = z1;\n      z1 = z2 = z3 = z4 = 0;\n    }\n    // TODO: handle quadratic?\n    this.bezierOrder();\n    this.bezierOrder(3);\n    this.beginShape();\n    this.vertex(x1, y1, z1);\n    this.bezierVertex(x2, y2, z2);\n    this.bezierVertex(x3, y3, z3);\n    this.bezierVertex(x4, y4, z4);\n    this.endShape();\n  };\n\n  // pretier-ignore\n  RendererGL.prototype.curve = function(\n    x1,\n    y1,\n    z1, // x2\n    x2, // y2\n    y2, // x3\n    z2, // y3\n    x3, // x4\n    y3, // y4\n    z3,\n    x4,\n    y4,\n    z4\n  ) {\n    if (arguments.length === 8) {\n      x4 = x3;\n      y4 = y3;\n      x3 = y2;\n      y3 = x2;\n      x2 = z1;\n      y2 = x2;\n      z1 = z2 = z3 = z4 = 0;\n    }\n    this.beginShape();\n    this.splineVertex(x1, y1, z1);\n    this.splineVertex(x2, y2, z2);\n    this.splineVertex(x3, y3, z3);\n    this.splineVertex(x4, y4, z4);\n    this.endShape();\n  };\n\n  /**\n   * Draw a line given two points\n   * @private\n   * @param {Number} x0 x-coordinate of first vertex\n   * @param {Number} y0 y-coordinate of first vertex\n   * @param {Number} z0 z-coordinate of first vertex\n   * @param {Number} x1 x-coordinate of second vertex\n   * @param {Number} y1 y-coordinate of second vertex\n   * @param {Number} z1 z-coordinate of second vertex\n   * @chainable\n   * @example\n   * <div>\n   * <code>\n   * //draw a line\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   // Use fill instead of stroke to change the color of shape.\n   *   fill(255, 0, 0);\n   *   line(10, 10, 0, 60, 60, 20);\n   * }\n   * </code>\n   * </div>\n   */\n  RendererGL.prototype.line = function(...args) {\n    if (args.length === 6) {\n      // TODO shapes refactor\n      this.beginShape(LINES);\n      this.vertex(args[0], args[1], args[2]);\n      this.vertex(args[3], args[4], args[5]);\n      this.endShape();\n    } else if (args.length === 4) {\n      this.beginShape(LINES);\n      this.vertex(args[0], args[1], 0);\n      this.vertex(args[2], args[3], 0);\n      this.endShape();\n    }\n    return this;\n  };\n\n  RendererGL.prototype.image = function(\n    img,\n    sx,\n    sy,\n    sWidth,\n    sHeight,\n    dx,\n    dy,\n    dWidth,\n    dHeight\n  ) {\n    // console.log(arguments);\n    if (this._isErasing) {\n      this.blendMode(this._cachedBlendMode);\n    }\n\n    this.push();\n    this.noLights();\n    this.states.setValue('strokeColor', null);\n\n    this.texture(img);\n    this.states.setValue('textureMode', NORMAL);\n\n    let u0 = 0;\n    if (sx <= img.width) {\n      u0 = sx / img.width;\n    }\n\n    let u1 = 1;\n    if (sx + sWidth <= img.width) {\n      u1 = (sx + sWidth) / img.width;\n    }\n\n    let v0 = 0;\n    if (sy <= img.height) {\n      v0 = sy / img.height;\n    }\n\n    let v1 = 1;\n    if (sy + sHeight <= img.height) {\n      v1 = (sy + sHeight) / img.height;\n    }\n\n    this._drawingImage = true;\n    this.beginShape();\n    this.vertex(dx, dy, 0, u0, v0);\n    this.vertex(dx + dWidth, dy, 0, u1, v0);\n    this.vertex(dx + dWidth, dy + dHeight, 0, u1, v1);\n    this.vertex(dx, dy + dHeight, 0, u0, v1);\n    this.endShape(CLOSE);\n    this._drawingImage = false;\n\n    this.pop();\n\n    if (this._isErasing) {\n      this.blendMode(REMOVE);\n    }\n  };\n\n  ///////////////////////\n  ///  3D primitives  ///\n  ///////////////////////\n  /**\n   * @private\n   * Helper function for creating both cones and cylinders\n   * Will only generate well-defined geometry when bottomRadius, height > 0\n   * and topRadius >= 0\n   * If topRadius == 0, topCap should be false\n   */\n  const _truncatedCone = function(\n    bottomRadius,\n    topRadius,\n    height,\n    detailX,\n    detailY,\n    bottomCap,\n    topCap\n  ) {\n    bottomRadius = bottomRadius <= 0 ? 1 : bottomRadius;\n    topRadius = topRadius < 0 ? 0 : topRadius;\n    height = height <= 0 ? bottomRadius : height;\n    detailX = detailX < 3 ? 3 : detailX;\n    detailY = detailY < 1 ? 1 : detailY;\n    bottomCap = bottomCap === undefined ? true : bottomCap;\n    topCap = topCap === undefined ? topRadius !== 0 : topCap;\n    const start = bottomCap ? -2 : 0;\n    const end = detailY + (topCap ? 2 : 0);\n    //ensure constant slant for interior vertex normals\n    const slant = Math.atan2(bottomRadius - topRadius, height);\n    const sinSlant = Math.sin(slant);\n    const cosSlant = Math.cos(slant);\n    let yy, ii, jj;\n    for (yy = start; yy <= end; ++yy) {\n      let v = yy / detailY;\n      let y = height * v;\n      let ringRadius;\n      if (yy < 0) {\n        //for the bottomCap edge\n        y = 0;\n        v = 0;\n        ringRadius = bottomRadius;\n      } else if (yy > detailY) {\n        //for the topCap edge\n        y = height;\n        v = 1;\n        ringRadius = topRadius;\n      } else {\n        //for the middle\n        ringRadius = bottomRadius + (topRadius - bottomRadius) * v;\n      }\n      if (yy === -2 || yy === detailY + 2) {\n        //center of bottom or top caps\n        ringRadius = 0;\n      }\n\n      y -= height / 2; //shift coordiate origin to the center of object\n      for (ii = 0; ii < detailX; ++ii) {\n        const u = ii / (detailX - 1);\n        const ur = 2 * Math.PI * u;\n        const sur = Math.sin(ur);\n        const cur = Math.cos(ur);\n\n        //VERTICES\n        this.vertices.push(new Vector(sur * ringRadius, y, cur * ringRadius));\n\n        //VERTEX NORMALS\n        let vertexNormal;\n        if (yy < 0) {\n          vertexNormal = new Vector(0, -1, 0);\n        } else if (yy > detailY && topRadius) {\n          vertexNormal = new Vector(0, 1, 0);\n        } else {\n          vertexNormal = new Vector(sur * cosSlant, sinSlant, cur * cosSlant);\n        }\n        this.vertexNormals.push(vertexNormal);\n        //UVs\n        this.uvs.push(u, v);\n      }\n    }\n\n    let startIndex = 0;\n    if (bottomCap) {\n      for (jj = 0; jj < detailX; ++jj) {\n        const nextjj = (jj + 1) % detailX;\n        this.faces.push([\n          startIndex + jj,\n          startIndex + detailX + nextjj,\n          startIndex + detailX + jj\n        ]);\n      }\n      startIndex += detailX * 2;\n    }\n    for (yy = 0; yy < detailY; ++yy) {\n      for (ii = 0; ii < detailX; ++ii) {\n        const nextii = (ii + 1) % detailX;\n        this.faces.push([\n          startIndex + ii,\n          startIndex + nextii,\n          startIndex + detailX + nextii\n        ]);\n        this.faces.push([\n          startIndex + ii,\n          startIndex + detailX + nextii,\n          startIndex + detailX + ii\n        ]);\n      }\n      startIndex += detailX;\n    }\n    if (topCap) {\n      startIndex += detailX;\n      for (ii = 0; ii < detailX; ++ii) {\n        this.faces.push([\n          startIndex + ii,\n          startIndex + (ii + 1) % detailX,\n          startIndex + detailX\n        ]);\n      }\n    }\n  };\n\n  RendererGL.prototype.plane = function(\n    width = 50,\n    height = width,\n    detailX = 1,\n    detailY = 1\n  ) {\n    const gid = `plane|${detailX}|${detailY}`;\n\n    if (!this.geometryInHash(gid)) {\n      const _plane = function() {\n        let u, v, p;\n        for (let i = 0; i <= this.detailY; i++) {\n          v = i / this.detailY;\n          for (let j = 0; j <= this.detailX; j++) {\n            u = j / this.detailX;\n            p = new Vector(u - 0.5, v - 0.5, 0);\n            this.vertices.push(p);\n            this.uvs.push(u, v);\n          }\n        }\n      };\n      const planeGeom = new Geometry(detailX, detailY, _plane, this);\n      planeGeom.computeFaces().computeNormals();\n      if (detailX <= 1 && detailY <= 1) {\n        planeGeom._makeTriangleEdges()._edgesToVertices();\n      } else if (this.states.strokeColor) {\n        console.log(\n          'Cannot draw stroke on plane objects with more' +\n          ' than 1 detailX or 1 detailY'\n        );\n      }\n      planeGeom.gid = gid;\n      this.geometryBufferCache.ensureCached(planeGeom);\n    }\n\n    this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(gid), width, height, 1);\n  };\n\n  RendererGL.prototype.box = function(\n    width = 50,\n    height = width,\n    depth = height,\n    detailX,\n    detailY\n  ){\n    const perPixelLighting =\n      this.attributes && this.attributes.perPixelLighting;\n    if (typeof detailX === 'undefined') {\n      detailX = perPixelLighting ? 1 : 4;\n    }\n    if (typeof detailY === 'undefined') {\n      detailY = perPixelLighting ? 1 : 4;\n    }\n\n    const gid = `box|${detailX}|${detailY}`;\n    if (!this.geometryInHash(gid)) {\n      const _box = function() {\n        const cubeIndices = [\n          [0, 4, 2, 6], // -1, 0, 0],// -x\n          [1, 3, 5, 7], // +1, 0, 0],// +x\n          [0, 1, 4, 5], // 0, -1, 0],// -y\n          [2, 6, 3, 7], // 0, +1, 0],// +y\n          [0, 2, 1, 3], // 0, 0, -1],// -z\n          [4, 5, 6, 7] // 0, 0, +1] // +z\n        ];\n        //using custom edges\n        //to avoid diagonal stroke lines across face of box\n        this.edges = [\n          [0, 1],\n          [1, 3],\n          [3, 2],\n          [6, 7],\n          [8, 9],\n          [9, 11],\n          [14, 15],\n          [16, 17],\n          [17, 19],\n          [18, 19],\n          [20, 21],\n          [22, 23]\n        ];\n\n        cubeIndices.forEach((cubeIndex, i) => {\n          const v = i * 4;\n          for (let j = 0; j < 4; j++) {\n            const d = cubeIndex[j];\n            //inspired by lightgl:\n            //https://github.com/evanw/lightgl.js\n            //octants:https://en.wikipedia.org/wiki/Octant_(solid_geometry)\n            const octant = new Vector(\n              ((d & 1) * 2 - 1) / 2,\n              ((d & 2) - 1) / 2,\n              ((d & 4) / 2 - 1) / 2\n            );\n            this.vertices.push(octant);\n            this.uvs.push(j & 1, (j & 2) / 2);\n          }\n          this.faces.push([v, v + 1, v + 2]);\n          this.faces.push([v + 2, v + 1, v + 3]);\n        });\n      };\n      const boxGeom = new Geometry(detailX, detailY, _box, this);\n      boxGeom.computeNormals();\n      if (detailX <= 4 && detailY <= 4) {\n        boxGeom._edgesToVertices();\n      } else if (this.states.strokeColor) {\n        console.log(\n          'Cannot draw stroke on box objects with more' +\n          ' than 4 detailX or 4 detailY'\n        );\n      }\n      //initialize our geometry buffer with\n      //the key val pair:\n      //geometry Id, Geom object\n      boxGeom.gid = gid;\n      this.geometryBufferCache.ensureCached(boxGeom);\n    }\n    this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(gid), width, height, depth);\n  };\n\n  RendererGL.prototype.sphere = function(\n    radius = 50,\n    detailX = 24,\n    detailY = 16\n  ) {\n    this.ellipsoid(radius, radius, radius, detailX, detailY);\n  };\n\n  RendererGL.prototype.ellipsoid = function(\n    radiusX = 50,\n    radiusY = radiusX,\n    radiusZ = radiusX,\n    detailX = 24,\n    detailY = 16\n  ) {\n    const gid = `ellipsoid|${detailX}|${detailY}`;\n\n    if (!this.geometryInHash(gid)) {\n      const _ellipsoid = function() {\n        for (let i = 0; i <= this.detailY; i++) {\n          const v = i / this.detailY;\n          const phi = Math.PI * v - Math.PI / 2;\n          const cosPhi = Math.cos(phi);\n          const sinPhi = Math.sin(phi);\n\n          for (let j = 0; j <= this.detailX; j++) {\n            const u = j / this.detailX;\n            const theta = 2 * Math.PI * u;\n            const cosTheta = Math.cos(theta);\n            const sinTheta = Math.sin(theta);\n            const p = new p5.Vector(cosPhi * sinTheta, sinPhi, cosPhi * cosTheta);\n            this.vertices.push(p);\n            this.vertexNormals.push(p);\n            this.uvs.push(u, v);\n          }\n        }\n      };\n      const ellipsoidGeom = new Geometry(detailX, detailY, _ellipsoid, this);\n      ellipsoidGeom.computeFaces();\n      if (detailX <= 24 && detailY <= 24) {\n        ellipsoidGeom._makeTriangleEdges()._edgesToVertices();\n      } else if (this.states.strokeColor) {\n        console.log(\n          'Cannot draw stroke on ellipsoids with more' +\n          ' than 24 detailX or 24 detailY'\n        );\n      }\n      ellipsoidGeom.gid = gid;\n      this.geometryBufferCache.ensureCached(ellipsoidGeom);\n    }\n\n    this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(gid), radiusX, radiusY, radiusZ);\n  };\n\n  RendererGL.prototype.cylinder = function(\n    radius = 50,\n    height = radius,\n    detailX = 24,\n    detailY = 1,\n    bottomCap = true,\n    topCap = true\n  ) {\n    const gid = `cylinder|${detailX}|${detailY}|${bottomCap}|${topCap}`;\n    if (!this.geometryInHash(gid)) {\n      const cylinderGeom = new p5.Geometry(detailX, detailY, function() {\n        _truncatedCone.call(\n          this,\n          1,\n          1,\n          1,\n          detailX,\n          detailY,\n          bottomCap,\n          topCap\n        );\n      }, this);\n      // normals are computed in call to _truncatedCone\n      if (detailX <= 24 && detailY <= 16) {\n        cylinderGeom._makeTriangleEdges()._edgesToVertices();\n      } else if (this.states.strokeColor) {\n        console.log(\n          'Cannot draw stroke on cylinder objects with more' +\n          ' than 24 detailX or 16 detailY'\n        );\n      }\n      cylinderGeom.gid = gid;\n      this.geometryBufferCache.ensureCached(cylinderGeom);\n    }\n\n    this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(gid), radius, height, radius);\n  };\n\n  RendererGL.prototype.cone = function(\n    radius = 50,\n    height = radius,\n    detailX = 24,\n    detailY = 1,\n    cap = true\n  ) {\n    const gid = `cone|${detailX}|${detailY}|${cap}`;\n    if (!this.geometryInHash(gid)) {\n      const coneGeom = new Geometry(detailX, detailY, function() {\n        _truncatedCone.call(\n          this,\n          1,\n          0,\n          1,\n          detailX,\n          detailY,\n          cap,\n          false\n        );\n      }, this);\n      if (detailX <= 24 && detailY <= 16) {\n        coneGeom._makeTriangleEdges()._edgesToVertices();\n      } else if (this.states.strokeColor) {\n        console.log(\n          'Cannot draw stroke on cone objects with more' +\n          ' than 24 detailX or 16 detailY'\n        );\n      }\n      coneGeom.gid = gid;\n      this.geometryBufferCache.ensureCached(coneGeom);\n    }\n\n    this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(gid), radius, height, radius);\n  };\n\n  RendererGL.prototype.torus = function(\n    radius = 50,\n    tubeRadius = 10,\n    detailX = 24,\n    detailY = 16\n  ) {\n    if (radius === 0) {\n      return; // nothing to draw\n    }\n\n    if (tubeRadius === 0) {\n      return; // nothing to draw\n    }\n\n    const tubeRatio = (tubeRadius / radius).toPrecision(4);\n    const gid = `torus|${tubeRatio}|${detailX}|${detailY}`;\n\n    if (!this.geometryInHash(gid)) {\n      const _torus = function() {\n        for (let i = 0; i <= this.detailY; i++) {\n          const v = i / this.detailY;\n          const phi = 2 * Math.PI * v;\n          const cosPhi = Math.cos(phi);\n          const sinPhi = Math.sin(phi);\n          const r = 1 + tubeRatio * cosPhi;\n\n          for (let j = 0; j <= this.detailX; j++) {\n            const u = j / this.detailX;\n            const theta = 2 * Math.PI * u;\n            const cosTheta = Math.cos(theta);\n            const sinTheta = Math.sin(theta);\n\n            const p = new Vector(\n              r * cosTheta,\n              r * sinTheta,\n              tubeRatio * sinPhi\n            );\n\n            const n = new Vector(cosPhi * cosTheta, cosPhi * sinTheta, sinPhi);\n\n            this.vertices.push(p);\n            this.vertexNormals.push(n);\n            this.uvs.push(u, v);\n          }\n        }\n      };\n      const torusGeom = new Geometry(detailX, detailY, _torus, this);\n      torusGeom.computeFaces();\n      if (detailX <= 24 && detailY <= 16) {\n        torusGeom._makeTriangleEdges()._edgesToVertices();\n      } else if (this.states.strokeColor) {\n        console.log(\n          'Cannot draw strokes on torus object with more' +\n          ' than 24 detailX or 16 detailY'\n        );\n      }\n      torusGeom.gid = gid;\n      this.geometryBufferCache.ensureCached(torusGeom);\n    }\n    this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(gid), radius, radius, radius);\n  };\n\n  /**\n   * Sets the number of segments used to draw spline curves in WebGL mode.\n   *\n   * In WebGL mode, smooth shapes are drawn using many flat segments. Adding\n   * more flat segments makes shapes appear smoother.\n   *\n   * The parameter, `detail`, is the density of segments to use while drawing a\n   * spline curve.\n   *\n   * Note: `curveDetail()` has no effect in 2D mode.\n   *\n   * @method curveDetail\n   * @param {Number} resolution number of segments to use. Default is 1/4\n   * @chainable\n   *\n   * @example\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Set the curveDetail() to 0.5\n   *   curveDetail(0.5);\n   * \n   *   // Do not show all the vertices\n   *   splineProperty('ends', EXCLUDE)\n   *\n   *   // Draw a black spline curve.\n   *   noFill();\n   *   strokeWeight(1);\n   *   stroke(0);\n   *   spline(-45, -24, 0, 23, -26, 0, 23, 11, 0, -35, 15, 0);\n   *\n   *   // Draw red spline curves from the anchor points to the control points.\n   *   spline(255, 0, 0);\n   *   spline(-45, -24, 0, -45, -24, 0, 23, -26, 0, 23, 11, 0);\n   *   spline(23, -26, 0, 23, 11, 0, -35, 15, 0, -35, 15, 0);\n   *\n   *   // Draw the anchor points in black.\n   *   strokeWeight(5);\n   *   stroke(0);\n   *   point(23, -26);\n   *   point(23, 11);\n   *\n   *   // Draw the control points in red.\n   *   stroke(255, 0, 0);\n   *   point(-45, -24);\n   *   point(-35, 15);\n   *\n   *   describe(\n   *     'A gray square with a jagged curve drawn in three segments. The curve is a sideways U shape with red segments on top and bottom, and a black segment on the right. The endpoints of all the segments are marked with dots.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  fn.curveDetail = function(d) {\n    if (!(this._renderer instanceof RendererGL)) {\n      throw new Error(\n        'curveDetail() only works in WebGL mode. Did you mean to call createCanvas(width, height, WEBGL)?'\n      );\n    }\n    return this._renderer.curveDetail(d);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  primitives3D(p5, p5.prototype);\n}\n\n/**\n * @module 3D\n * @submodule Lights\n * @for p5\n * @requires core\n */\n\n\nfunction light(p5, fn){\n  /**\n   * Creates a light that shines from all directions.\n   *\n   * Ambient light does not come from one direction. Instead, 3D shapes are\n   * lit evenly from all sides. Ambient lights are almost always used in\n   * combination with other types of lights.\n   *\n   * There are three ways to call `ambientLight()` with optional parameters to\n   * set the lights color.\n   *\n   * The first way to call `ambientLight()` has two parameters, `gray` and\n   * `alpha`. `alpha` is optional. Grayscale and alpha values between 0 and 255\n   * can be passed to set the ambient lights color, as in `ambientLight(50)` or\n   * `ambientLight(50, 30)`.\n   *\n   * The second way to call `ambientLight()` has one parameter, color. A\n   * <a href=\"#/p5.Color\">p5.Color</a> object, an array of color values, or a\n   * CSS color string, as in `ambientLight('magenta')`, can be passed to set the\n   * ambient lights color.\n   *\n   * The third way to call `ambientLight()` has four parameters, `v1`, `v2`,\n   * `v3`, and `alpha`. `alpha` is optional. RGBA, HSBA, or HSLA values can be\n   * passed to set the ambient lights colors, as in `ambientLight(255, 0, 0)`\n   * or `ambientLight(255, 0, 0, 30)`. Color values will be interpreted using\n   * the current <a href=\"#/p5/colorMode\">colorMode()</a>.\n   *\n   * @method ambientLight\n   * @param  {Number}        v1 red or hue value in the current\n   *                            <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}        v2 green or saturation value in the current\n   *                            <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}        v3 blue, brightness, or lightness value in the current\n   *                            <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}        [alpha] alpha (transparency) value in the current\n   *                                 <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click the canvas to turn on the light.\n   *\n   * let isLit = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A sphere drawn against a gray background. The sphere appears to change color when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Control the light.\n   *   if (isLit === true) {\n   *     // Use a grayscale value of 80.\n   *     ambientLight(80);\n   *   }\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   *\n   * // Turn on the ambient light when the user double-clicks.\n   * function doubleClicked() {\n   *   isLit = true;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A faded magenta sphere drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   // Use a p5.Color object.\n   *   let c = color('orchid');\n   *   ambientLight(c);\n   *\n   *   // Draw the sphere.\n   *   sphere();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A faded magenta sphere drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   // Use a CSS color string.\n   *   ambientLight('#DA70D6');\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A faded magenta sphere drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   // Use RGB values\n   *   ambientLight(218, 112, 214);\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method ambientLight\n   * @param  {Number}        gray  grayscale value between 0 and 255.\n   * @param  {Number}        [alpha]\n   * @chainable\n   */\n\n  /**\n   * @method ambientLight\n   * @param  {String}        value color as a CSS string.\n   * @chainable\n   */\n\n  /**\n   * @method ambientLight\n   * @param  {Number[]}      values color as an array of RGBA, HSBA, or HSLA\n   *                                 values.\n   * @chainable\n   */\n\n  /**\n   * @method ambientLight\n   * @param  {p5.Color}      color color as a <a href=\"#/p5.Color\">p5.Color</a> object.\n   * @chainable\n   */\n  fn.ambientLight = function (v1, v2, v3, a) {\n    this._assert3d('ambientLight');\n    // p5._validateParameters('ambientLight', arguments);\n\n    this._renderer.ambientLight(...arguments);\n\n    return this;\n  };\n\n  /**\n   * Sets the specular color for lights.\n   *\n   * `specularColor()` affects lights that bounce off a surface in a preferred\n   * direction. These lights include\n   * <a href=\"#/p5/directionalLight\">directionalLight()</a>,\n   * <a href=\"#/p5/pointLight\">pointLight()</a>, and\n   * <a href=\"#/p5/spotLight\">spotLight()</a>. The function helps to create\n   * highlights on <a href=\"#/p5.Geometry\">p5.Geometry</a> objects that are\n   * styled with <a href=\"#/p5/specularMaterial\">specularMaterial()</a>. If a\n   * geometry does not use\n   * <a href=\"#/p5/specularMaterial\">specularMaterial()</a>, then\n   * `specularColor()` will have no effect.\n   *\n   * Note: `specularColor()` doesnt affect lights that bounce in all\n   * directions, including <a href=\"#/p5/ambientLight\">ambientLight()</a> and\n   * <a href=\"#/p5/imageLight\">imageLight()</a>.\n   *\n   * There are three ways to call `specularColor()` with optional parameters to\n   * set the specular highlight color.\n   *\n   * The first way to call `specularColor()` has two optional parameters, `gray`\n   * and `alpha`. Grayscale and alpha values between 0 and 255, as in\n   * `specularColor(50)` or `specularColor(50, 80)`, can be passed to set the\n   * specular highlight color.\n   *\n   * The second way to call `specularColor()` has one optional parameter,\n   * `color`. A <a href=\"#/p5.Color\">p5.Color</a> object, an array of color\n   * values, or a CSS color string can be passed to set the specular highlight\n   * color.\n   *\n   * The third way to call `specularColor()` has four optional parameters, `v1`,\n   * `v2`, `v3`, and `alpha`. RGBA, HSBA, or HSLA values, as in\n   * `specularColor(255, 0, 0, 80)`, can be passed to set the specular highlight\n   * color. Color values will be interpreted using the current\n   * <a href=\"#/p5/colorMode\">colorMode()</a>.\n   *\n   * @method specularColor\n   * @param  {Number}        v1 red or hue value in the current\n   *                            <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}        v2 green or saturation value in the current\n   *                            <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}        v3 blue, brightness, or lightness value in the current\n   *                            <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white sphere drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // No specular color.\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click the canvas to add a point light.\n   *\n   * let isLit = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A sphere drawn on a gray background. A spotlight starts shining when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *   specularColor(100);\n   *   specularMaterial(255, 255, 255);\n   *\n   *   // Control the light.\n   *   if (isLit === true) {\n   *     // Add a white point light from the top-right.\n   *     pointLight(255, 255, 255, 30, -20, 40);\n   *   }\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   *\n   * // Turn on the point light when the user double-clicks.\n   * function doubleClicked() {\n   *   isLit = true;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A black sphere drawn on a gray background. An area on the surface of the sphere is highlighted in blue.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Add a specular highlight.\n   *   // Use a p5.Color object.\n   *   let c = color('dodgerblue');\n   *   specularColor(c);\n   *\n   *   // Add a white point light from the top-right.\n   *   pointLight(255, 255, 255, 30, -20, 40);\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *\n   *   // Add a white specular material.\n   *   specularMaterial(255, 255, 255);\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A black sphere drawn on a gray background. An area on the surface of the sphere is highlighted in blue.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Add a specular highlight.\n   *   // Use a CSS color string.\n   *   specularColor('#1E90FF');\n   *\n   *   // Add a white point light from the top-right.\n   *   pointLight(255, 255, 255, 30, -20, 40);\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *\n   *   // Add a white specular material.\n   *   specularMaterial(255, 255, 255);\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A black sphere drawn on a gray background. An area on the surface of the sphere is highlighted in blue.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Add a specular highlight.\n   *   // Use RGB values.\n   *   specularColor(30, 144, 255);\n   *\n   *   // Add a white point light from the top-right.\n   *   pointLight(255, 255, 255, 30, -20, 40);\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *\n   *   // Add a white specular material.\n   *   specularMaterial(255, 255, 255);\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method specularColor\n   * @param  {Number}        gray grayscale value between 0 and 255.\n   * @chainable\n   */\n\n  /**\n   * @method specularColor\n   * @param  {String}        value color as a CSS string.\n   * @chainable\n   */\n\n  /**\n   * @method specularColor\n   * @param  {Number[]}      values color as an array of RGBA, HSBA, or HSLA\n   *                                 values.\n   * @chainable\n   */\n\n  /**\n   * @method specularColor\n   * @param  {p5.Color}      color color as a <a href=\"#/p5.Color\">p5.Color</a> object.\n   * @chainable\n   */\n  fn.specularColor = function (v1, v2, v3) {\n    this._assert3d('specularColor');\n    // p5._validateParameters('specularColor', arguments);\n\n    this._renderer.specularColor(...arguments);\n\n    return this;\n  };\n\n  /**\n   * Creates a light that shines in one direction.\n   *\n   * Directional lights dont shine from a specific point. Theyre like a sun\n   * that shines from somewhere offscreen. The lights direction is set using\n   * three `(x, y, z)` values between -1 and 1. For example, setting a lights\n   * direction as `(1, 0, 0)` will light <a href=\"#/p5.Geometry\">p5.Geometry</a>\n   * objects from the left since the light faces directly to the right. A\n   * maximum of 5 directional lights can be active at once.\n   *\n   * There are four ways to call `directionalLight()` with parameters to set the\n   * lights color and direction.\n   *\n   * The first way to call `directionalLight()` has six parameters. The first\n   * three parameters, `v1`, `v2`, and `v3`, set the lights color using the\n   * current <a href=\"#/p5/colorMode\">colorMode()</a>. The last three\n   * parameters, `x`, `y`, and `z`, set the lights direction. For example,\n   * `directionalLight(255, 0, 0, 1, 0, 0)` creates a red `(255, 0, 0)` light\n   * that shines to the right `(1, 0, 0)`.\n   *\n   * The second way to call `directionalLight()` has four parameters. The first\n   * three parameters, `v1`, `v2`, and `v3`, set the lights color using the\n   * current <a href=\"#/p5/colorMode\">colorMode()</a>. The last parameter,\n   * `direction` sets the lights direction using a\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object. For example,\n   * `directionalLight(255, 0, 0, lightDir)` creates a red `(255, 0, 0)` light\n   * that shines in the direction the `lightDir` vector points.\n   *\n   * The third way to call `directionalLight()` has four parameters. The first\n   * parameter, `color`, sets the lights color using a\n   * <a href=\"#/p5.Color\">p5.Color</a> object or an array of color values. The\n   * last three parameters, `x`, `y`, and `z`, set the lights direction. For\n   * example, `directionalLight(myColor, 1, 0, 0)` creates a light that shines\n   * to the right `(1, 0, 0)` with the color value of `myColor`.\n   *\n   * The fourth way to call `directionalLight()` has two parameters. The first\n   * parameter, `color`, sets the lights color using a\n   * <a href=\"#/p5.Color\">p5.Color</a> object or an array of color values. The\n   * second parameter, `direction`, sets the lights direction using a\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object. For example,\n   * `directionalLight(myColor, lightDir)` creates a light that shines in the\n   * direction the `lightDir` vector points with the color value of `myColor`.\n   *\n   * @method directionalLight\n   * @param  {Number}    v1 red or hue value in the current\n   *                        <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}    v2 green or saturation value in the current\n   *                        <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}    v3 blue, brightness, or lightness value in the current\n   *                        <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}    x  x-component of the light's direction between -1 and 1.\n   * @param  {Number}    y  y-component of the light's direction between -1 and 1.\n   * @param  {Number}    z  z-component of the light's direction between -1 and 1.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click to turn on the directional light.\n   *\n   * let isLit = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A sphere drawn on a gray background. A red light starts shining from above when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Control the light.\n   *   if (isLit === true) {\n   *     // Add a red directional light from above.\n   *     // Use RGB values and XYZ directions.\n   *     directionalLight(255, 0, 0, 0, 1, 0);\n   *   }\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A sphere drawn on a gray background. The top of the sphere appears bright red. The color gets darker toward the bottom.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Add a red directional light from above.\n   *   // Use a p5.Color object and XYZ directions.\n   *   let c = color(255, 0, 0);\n   *   directionalLight(c, 0, 1, 0);\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A sphere drawn on a gray background. The top of the sphere appears bright red. The color gets darker toward the bottom.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Add a red directional light from above.\n   *   // Use a p5.Color object and a p5.Vector object.\n   *   let c = color(255, 0, 0);\n   *   let lightDir = createVector(0, 1, 0);\n   *   directionalLight(c, lightDir);\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method directionalLight\n   * @param  {Number}    v1\n   * @param  {Number}    v2\n   * @param  {Number}    v3\n   * @param  {p5.Vector} direction direction of the light as a\n   *                               <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   * @chainable\n   */\n\n  /**\n   * @method directionalLight\n   * @param  {p5.Color|Number[]|String} color color as a <a href=\"#/p5.Color\">p5.Color</a> object,\n   *                                           an array of color values, or as a CSS string.\n   * @param  {Number}                   x\n   * @param  {Number}                   y\n   * @param  {Number}                   z\n   * @chainable\n   */\n\n  /**\n   * @method directionalLight\n   * @param  {p5.Color|Number[]|String} color\n   * @param  {p5.Vector}                direction\n   * @chainable\n   */\n  fn.directionalLight = function (v1, v2, v3, x, y, z) {\n    this._assert3d('directionalLight');\n    // p5._validateParameters('directionalLight', arguments);\n\n    //@TODO: check parameters number\n    this._renderer.directionalLight(...arguments);\n\n    return this;\n  };\n\n  /**\n   * Creates a light that shines from a point in all directions.\n   *\n   * Point lights are like light bulbs that shine in all directions. They can be\n   * placed at different positions to achieve different lighting effects. A\n   * maximum of 5 point lights can be active at once.\n   *\n   * There are four ways to call `pointLight()` with parameters to set the\n   * lights color and position.\n   *\n   * The first way to call `pointLight()` has six parameters. The first three\n   * parameters, `v1`, `v2`, and `v3`, set the lights color using the current\n   * <a href=\"#/p5/colorMode\">colorMode()</a>. The last three parameters, `x`,\n   * `y`, and `z`, set the lights position. For example,\n   * `pointLight(255, 0, 0, 50, 0, 0)` creates a red `(255, 0, 0)` light that\n   * shines from the coordinates `(50, 0, 0)`.\n   *\n   * The second way to call `pointLight()` has four parameters. The first three\n   * parameters, `v1`, `v2`, and `v3`, set the lights color using the current\n   * <a href=\"#/p5/colorMode\">colorMode()</a>. The last parameter, position sets\n   * the lights position using a <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   * For example, `pointLight(255, 0, 0, lightPos)` creates a red `(255, 0, 0)`\n   * light that shines from the position set by the `lightPos` vector.\n   *\n   * The third way to call `pointLight()` has four parameters. The first\n   * parameter, `color`, sets the lights color using a\n   * <a href=\"#/p5.Color\">p5.Color</a> object or an array of color values. The\n   * last three parameters, `x`, `y`, and `z`, set the lights position. For\n   * example, `directionalLight(myColor, 50, 0, 0)` creates a light that shines\n   * from the coordinates `(50, 0, 0)` with the color value of `myColor`.\n   *\n   * The fourth way to call `pointLight()` has two parameters. The first\n   * parameter, `color`, sets the lights color using a\n   * <a href=\"#/p5.Color\">p5.Color</a> object or an array of color values. The\n   * second parameter, `position`, sets the lights position using a\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object. For example,\n   * `directionalLight(myColor, lightPos)` creates a light that shines from the\n   * position set by the `lightPos` vector with the color value of `myColor`.\n   *\n   * @method pointLight\n   * @param  {Number}    v1 red or hue value in the current\n   *                        <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}    v2 green or saturation value in the current\n   *                        <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}    v3 blue, brightness, or lightness value in the current\n   *                        <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}    x  x-coordinate of the light.\n   * @param  {Number}    y  y-coordinate of the light.\n   * @param  {Number}    z  z-coordinate of the light.\n   * @chainable\n   *\n   * @example\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click to turn on the point light.\n   *\n   * let isLit = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A sphere drawn on a gray background. A red light starts shining from above when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Control the light.\n   *   if (isLit === true) {\n   *     // Add a red point light from above.\n   *     // Use RGB values and XYZ coordinates.\n   *     pointLight(255, 0, 0, 0, -150, 0);\n   *   }\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   *\n   * // Turn on the point light when the user double-clicks.\n   * function doubleClicked() {\n   *   isLit = true;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A sphere drawn on a gray background. The top of the sphere appears bright red. The color gets darker toward the bottom.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Add a red point light from above.\n   *   // Use a p5.Color object and XYZ directions.\n   *   let c = color(255, 0, 0);\n   *   pointLight(c, 0, -150, 0);\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A sphere drawn on a gray background. The top of the sphere appears bright red. The color gets darker toward the bottom.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Add a red point light from above.\n   *   // Use a p5.Color object and a p5.Vector object.\n   *   let c = color(255, 0, 0);\n   *   let lightPos = createVector(0, -150, 0);\n   *   pointLight(c, lightPos);\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('Four spheres arranged in a square and drawn on a gray background. The spheres appear bright red toward the center of the square. The color gets darker toward the corners of the square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Add a red point light that points to the center of the scene.\n   *   // Use a p5.Color object and a p5.Vector object.\n   *   let c = color(255, 0, 0);\n   *   let lightPos = createVector(0, 0, 65);\n   *   pointLight(c, lightPos);\n   *\n   *   // Style the spheres.\n   *   noStroke();\n   *\n   *   // Draw a sphere up and to the left.\n   *   push();\n   *   translate(-25, -25, 25);\n   *   sphere(10);\n   *   pop();\n   *\n   *   // Draw a box up and to the right.\n   *   push();\n   *   translate(25, -25, 25);\n   *   sphere(10);\n   *   pop();\n   *\n   *   // Draw a sphere down and to the left.\n   *   push();\n   *   translate(-25, 25, 25);\n   *   sphere(10);\n   *   pop();\n   *\n   *   // Draw a box down and to the right.\n   *   push();\n   *   translate(25, 25, 25);\n   *   sphere(10);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method pointLight\n   * @param  {Number}     v1\n   * @param  {Number}     v2\n   * @param  {Number}     v3\n   * @param  {p5.Vector}  position position of the light as a\n   *                               <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   * @chainable\n   */\n\n  /**\n   * @method pointLight\n   * @param  {p5.Color|Number[]|String} color color as a <a href=\"#/p5.Color\">p5.Color</a> object,\n   *                                          an array of color values, or a CSS string.\n   * @param  {Number}                   x\n   * @param  {Number}                   y\n   * @param  {Number}                   z\n   * @chainable\n   */\n\n  /**\n   * @method pointLight\n   * @param  {p5.Color|Number[]|String} color\n   * @param  {p5.Vector}                position\n   * @chainable\n   */\n  fn.pointLight = function (v1, v2, v3, x, y, z) {\n    this._assert3d('pointLight');\n    // p5._validateParameters('pointLight', arguments);\n\n    //@TODO: check parameters number\n    this._renderer.pointLight(...arguments);\n\n    return this;\n  };\n\n  /**\n   * Creates an ambient light from an image.\n   *\n   * `imageLight()` simulates a light shining from all directions. The effect is\n   * like placing the sketch at the center of a giant sphere that uses the image\n   * as its texture. The image's diffuse light will be affected by\n   * <a href=\"#/p5/fill\">fill()</a> and the specular reflections will be\n   * affected by <a href=\"#/p5/specularMaterial\">specularMaterial()</a> and\n   * <a href=\"#/p5/shininess\">shininess()</a>.\n   *\n   * The parameter, `img`, is the <a href=\"#/p5.Image\">p5.Image</a> object to\n   * use as the light source.\n   *\n   * @method imageLight\n   * @param  {p5.image}    img image to use as the light source.\n   *\n   * @example\n   * <div class=\"notest\">\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let img;\n   *\n   * async function setup() {\n   *   // Load an image and create a p5.Image object.\n   *   img = await loadImage('assets/outdoor_spheremap.jpg');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A sphere floating above a landscape. The surface of the sphere reflects the landscape.');\n   * }\n   *\n   * function draw() {\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the image as a panorama (360 background).\n   *   panorama(img);\n   *\n   *   // Add a soft ambient light.\n   *   ambientLight(50);\n   *\n   *   // Add light from the image.\n   *   imageLight(img);\n   *\n   *   // Style the sphere.\n   *   specularMaterial(20);\n   *   shininess(100);\n   *   noStroke();\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.imageLight = function (img) {\n    this._renderer.imageLight(img);\n  };\n\n  /**\n   * Creates an immersive 3D background.\n   *\n   * `panorama()` transforms images containing 360 content, such as maps or\n   * HDRIs, into immersive 3D backgrounds that surround a sketch. Exploring the\n   * space requires changing the camera's perspective with functions such as\n   * <a href=\"#/p5/orbitControl\">orbitControl()</a> or\n   * <a href=\"#/p5/camera\">camera()</a>.\n   *\n   * @method panorama\n   * @param {p5.Image} img 360 image to use as the background.\n   *\n   * @example\n   * <div class=\"notest\">\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let img;\n   *\n   * async function setup() {\n   *   // Load an image and create a p5.Image object.\n   *   img = await loadImage('assets/outdoor_spheremap.jpg');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A sphere floating above a landscape. The surface of the sphere reflects the landscape. The full landscape is viewable in 3D as the user drags the mouse.');\n   * }\n   *\n   * function draw() {\n   *   // Add the panorama.\n   *   panorama(img);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Use the image as a light source.\n   *   imageLight(img);\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *   specularMaterial(50);\n   *   shininess(200);\n   *   metalness(100);\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.panorama = function (img) {\n    this.filter(this._renderer._getSphereMapping(img));\n  };\n\n  /**\n   * Places an ambient and directional light in the scene.\n   * The lights are set to ambientLight(128, 128, 128) and\n   * directionalLight(128, 128, 128, 0, 0, -1).\n   *\n   * Note: lights need to be called (whether directly or indirectly)\n   * within draw() to remain persistent in a looping program.\n   * Placing them in setup() will cause them to only have an effect\n   * the first time through the loop.\n   *\n   * @method lights\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click to turn on the lights.\n   *\n   * let isLit = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white box drawn against a gray background. The quality of the light changes when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Control the lights.\n   *   if (isLit === true) {\n   *     lights();\n   *   }\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   *\n   * // Turn on the lights when the user double-clicks.\n   * function doubleClicked() {\n   *   isLit = true;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white box drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   ambientLight(128, 128, 128);\n   *   directionalLight(128, 128, 128, 0, 0, -1);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.lights = function () {\n    this._assert3d('lights');\n    // Both specify gray by default.\n    this._renderer.lights();\n    return this;\n  };\n\n  /**\n   * Sets the falloff rate for <a href=\"#/p5/pointLight\">pointLight()</a>\n   * and <a href=\"#/p5/spotLight\">spotLight()</a>.\n   *\n   * A lights falloff describes the intensity of its beam at a distance. For\n   * example, a lantern has a slow falloff, a flashlight has a medium falloff,\n   * and a laser pointer has a sharp falloff.\n   *\n   * `lightFalloff()` has three parameters, `constant`, `linear`, and\n   * `quadratic`. Theyre numbers used to calculate falloff at a distance, `d`,\n   * as follows:\n   *\n   * `falloff = 1 / (constant + d * linear + (d * d) * quadratic)`\n   *\n   * Note: `constant`, `linear`, and `quadratic` should always be set to values\n   * greater than 0.\n   *\n   * @method lightFalloff\n   * @param {Number} constant  constant value for calculating falloff.\n   * @param {Number} linear    linear value for calculating falloff.\n   * @param {Number} quadratic quadratic value for calculating falloff.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click to change the falloff rate.\n   *\n   * let useFalloff = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A sphere drawn against a gray background. The intensity of the light changes when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Set the light falloff.\n   *   if (useFalloff === true) {\n   *     lightFalloff(2, 0, 0);\n   *   }\n   *\n   *   // Add a white point light from the front.\n   *   pointLight(255, 255, 255, 0, 0, 100);\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   *\n   * // Change the falloff value when the user double-clicks.\n   * function doubleClicked() {\n   *   useFalloff = true;\n   * }\n   * </code>\n   * </div>\n   */\n  fn.lightFalloff = function (\n    constantAttenuation,\n    linearAttenuation,\n    quadraticAttenuation\n  ) {\n    this._assert3d('lightFalloff');\n    // p5._validateParameters('lightFalloff', arguments);\n\n    this._renderer.lightFalloff(\n      constantAttenuation,\n      linearAttenuation,\n      quadraticAttenuation\n    );\n\n    return this;\n  };\n\n  /**\n   * Creates a light that shines from a point in one direction.\n   *\n   * Spot lights are like flashlights that shine in one direction creating a\n   * cone of light. The shape of the cone can be controlled using the angle and\n   * concentration parameters. A maximum of 5 spot lights can be active at once.\n   *\n   * There are eight ways to call `spotLight()` with parameters to set the\n   * lights color, position, direction. For example,\n   * `spotLight(255, 0, 0, 0, 0, 0, 1, 0, 0)` creates a red `(255, 0, 0)` light\n   * at the origin `(0, 0, 0)` that points to the right `(1, 0, 0)`.\n   *\n   * The `angle` parameter is optional. It sets the radius of the light cone.\n   * For example, `spotLight(255, 0, 0, 0, 0, 0, 1, 0, 0, PI / 16)` creates a\n   * red `(255, 0, 0)` light at the origin `(0, 0, 0)` that points to the right\n   * `(1, 0, 0)` with an angle of `PI / 16` radians. By default, `angle` is\n   * `PI / 3` radians.\n   *\n   * The `concentration` parameter is also optional. It focuses the light\n   * towards the center of the light cone. For example,\n   * `spotLight(255, 0, 0, 0, 0, 0, 1, 0, 0, PI / 16, 50)` creates a red\n   * `(255, 0, 0)` light at the origin `(0, 0, 0)` that points to the right\n   * `(1, 0, 0)` with an angle of `PI / 16` radians at concentration of 50. By\n   * default, `concentration` is 100.\n   *\n   * @method spotLight\n   * @param  {Number}    v1               red or hue value in the current\n   *                                      <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}    v2               green or saturation value in the current\n   *                                      <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}    v3               blue, brightness, or lightness value in the current\n   *                                      <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}    x                x-coordinate of the light.\n   * @param  {Number}    y                y-coordinate of the light.\n   * @param  {Number}    z                z-coordinate of the light.\n   * @param  {Number}    rx               x-component of light direction between -1 and 1.\n   * @param  {Number}    ry               y-component of light direction between -1 and 1.\n   * @param  {Number}    rz               z-component of light direction between -1 and 1.\n   * @param  {Number}    [angle]          angle of the light cone. Defaults to `PI / 3`.\n   * @param  {Number}    [concentration]  concentration of the light. Defaults to 100.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click to adjust the spotlight.\n   *\n   * let isLit = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white sphere drawn on a gray background. A red spotlight starts shining when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Control the spotlight.\n   *   if (isLit === true) {\n   *     // Add a red spot light that shines into the screen.\n   *     // Set its angle to PI / 32 radians.\n   *     spotLight(255, 0, 0, 0, 0, 100, 0, 0, -1, PI / 32);\n   *   }\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   *\n   * // Turn on the spotlight when the user double-clicks.\n   * function doubleClicked() {\n   *   isLit = true;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click to adjust the spotlight.\n   *\n   * let isLit = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white sphere drawn on a gray background. A red spotlight starts shining when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Control the spotlight.\n   *   if (isLit === true) {\n   *     // Add a red spot light that shines into the screen.\n   *     // Set its angle to PI / 3 radians (default).\n   *     // Set its concentration to 1000.\n   *     let c = color(255, 0, 0);\n   *     let position = createVector(0, 0, 100);\n   *     let direction = createVector(0, 0, -1);\n   *     spotLight(c, position, direction, PI / 3, 1000);\n   *   }\n   *\n   *   // Draw the sphere.\n   *   sphere(30);\n   * }\n   *\n   * // Turn on the spotlight when the user double-clicks.\n   * function doubleClicked() {\n   *   isLit = true;\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method spotLight\n   * @param  {p5.Color|Number[]|String} color     color as a <a href=\"#/p5.Color\">p5.Color</a> object,\n   *                                              an array of color values, or a CSS string.\n   * @param  {p5.Vector}                position  position of the light as a <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   * @param  {p5.Vector}                direction direction of light as a <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   * @param  {Number}                   [angle]\n   * @param  {Number}                   [concentration]\n   */\n  /**\n   * @method spotLight\n   * @param  {Number}     v1\n   * @param  {Number}     v2\n   * @param  {Number}     v3\n   * @param  {p5.Vector}  position\n   * @param  {p5.Vector}  direction\n   * @param  {Number}     [angle]\n   * @param  {Number}     [concentration]\n   */\n  /**\n   * @method spotLight\n   * @param  {p5.Color|Number[]|String} color\n   * @param  {Number}                   x\n   * @param  {Number}                   y\n   * @param  {Number}                   z\n   * @param  {p5.Vector}                direction\n   * @param  {Number}                   [angle]\n   * @param  {Number}                   [concentration]\n   */\n  /**\n   * @method spotLight\n   * @param  {p5.Color|Number[]|String} color\n   * @param  {p5.Vector}                position\n   * @param  {Number}                   rx\n   * @param  {Number}                   ry\n   * @param  {Number}                   rz\n   * @param  {Number}                   [angle]\n   * @param  {Number}                   [concentration]\n   */\n  /**\n   * @method spotLight\n   * @param  {Number}     v1\n   * @param  {Number}     v2\n   * @param  {Number}     v3\n   * @param  {Number}     x\n   * @param  {Number}     y\n   * @param  {Number}     z\n   * @param  {p5.Vector}  direction\n   * @param  {Number}     [angle]\n   * @param  {Number}     [concentration]\n   */\n  /**\n   * @method spotLight\n   * @param  {Number}     v1\n   * @param  {Number}     v2\n   * @param  {Number}     v3\n   * @param  {p5.Vector}  position\n   * @param  {Number}     rx\n   * @param  {Number}     ry\n   * @param  {Number}     rz\n   * @param  {Number}     [angle]\n   * @param  {Number}     [concentration]\n   */\n  /**\n   * @method spotLight\n   * @param  {p5.Color|Number[]|String} color\n   * @param  {Number}                   x\n   * @param  {Number}                   y\n   * @param  {Number}                   z\n   * @param  {Number}                   rx\n   * @param  {Number}                   ry\n   * @param  {Number}                   rz\n   * @param  {Number}                   [angle]\n   * @param  {Number}                   [concentration]\n   */\n  fn.spotLight = function (\n    v1,\n    v2,\n    v3,\n    x,\n    y,\n    z,\n    nx,\n    ny,\n    nz,\n    angle,\n    concentration\n  ) {\n    this._assert3d('spotLight');\n    // p5._validateParameters('spotLight', arguments);\n\n    this._renderer.spotLight(...arguments);\n\n    return this;\n  };\n\n  /**\n   * Removes all lights from the sketch.\n   *\n   * Calling `noLights()` removes any lights created with\n   * <a href=\"#/p5/lights\">lights()</a>,\n   * <a href=\"#/p5/ambientLight\">ambientLight()</a>,\n   * <a href=\"#/p5/directionalLight\">directionalLight()</a>,\n   * <a href=\"#/p5/pointLight\">pointLight()</a>, or\n   * <a href=\"#/p5/spotLight\">spotLight()</a>. These functions may be called\n   * after `noLights()` to create a new lighting scheme.\n   *\n   * @method noLights\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('Two spheres drawn against a gray background. The top sphere is white and the bottom sphere is red.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the spheres.\n   *   noStroke();\n   *\n   *   // Draw the top sphere.\n   *   push();\n   *   translate(0, -25, 0);\n   *   sphere(20);\n   *   pop();\n   *\n   *   // Turn off the lights.\n   *   noLights();\n   *\n   *   // Add a red directional light that points into the screen.\n   *   directionalLight(255, 0, 0, 0, 0, -1);\n   *\n   *   // Draw the bottom sphere.\n   *   push();\n   *   translate(0, 25, 0);\n   *   sphere(20);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noLights = function (...args) {\n    this._assert3d('noLights');\n    // p5._validateParameters('noLights', args);\n\n    this._renderer.noLights();\n\n    return this;\n  };\n\n\n  RendererGL.prototype.ambientLight = function(v1, v2, v3, a) {\n    const color = this._pInst.color(...arguments);\n\n    this.states.setValue('ambientLightColors', [...this.states.ambientLightColors]);\n    this.states.ambientLightColors.push(\n      color._array[0],\n      color._array[1],\n      color._array[2]\n    );\n\n    this.states.setValue('enableLighting', true);\n  };\n\n  RendererGL.prototype.specularColor = function(v1, v2, v3) {\n    const color = this._pInst.color(...arguments);\n\n    this.states.setValue('specularColors', [\n      color._array[0],\n      color._array[1],\n      color._array[2]\n    ]);\n  };\n\n  RendererGL.prototype.directionalLight = function(v1, v2, v3, x, y, z) {\n    let color;\n    if (v1 instanceof Color) {\n      color = v1;\n    } else {\n      color = this._pInst.color(v1, v2, v3);\n    }\n\n    let _x, _y, _z;\n    const v = arguments[arguments.length - 1];\n    if (typeof v === 'number') {\n      _x = arguments[arguments.length - 3];\n      _y = arguments[arguments.length - 2];\n      _z = arguments[arguments.length - 1];\n    } else {\n      _x = v.x;\n      _y = v.y;\n      _z = v.z;\n    }\n\n    // normalize direction\n    const l = Math.sqrt(_x * _x + _y * _y + _z * _z);\n    this.states.setValue('directionalLightDirections', [...this.states.directionalLightDirections]);\n    this.states.directionalLightDirections.push(_x / l, _y / l, _z / l);\n\n    this.states.setValue('directionalLightDiffuseColors', [...this.states.directionalLightDiffuseColors]);\n    this.states.directionalLightDiffuseColors.push(\n      color._array[0],\n      color._array[1],\n      color._array[2]\n    );\n\n    this.states.setValue('directionalLightSpecularColors', [...this.states.directionalLightSpecularColors]);\n    Array.prototype.push.apply(\n      this.states.directionalLightSpecularColors,\n      this.states.specularColors\n    );\n\n    this.states.setValue('enableLighting', true);\n  };\n\n  RendererGL.prototype.pointLight = function(v1, v2, v3, x, y, z) {\n    let color;\n    if (v1 instanceof Color) {\n      color = v1;\n    } else {\n      color = this._pInst.color(v1, v2, v3);\n    }\n\n    let _x, _y, _z;\n    const v = arguments[arguments.length - 1];\n    if (typeof v === 'number') {\n      _x = arguments[arguments.length - 3];\n      _y = arguments[arguments.length - 2];\n      _z = arguments[arguments.length - 1];\n    } else {\n      _x = v.x;\n      _y = v.y;\n      _z = v.z;\n    }\n\n    this.states.setValue('pointLightPositions', [...this.states.pointLightPositions]);\n    this.states.pointLightPositions.push(_x, _y, _z);\n\n    this.states.setValue('pointLightDiffuseColors', [...this.states.pointLightDiffuseColors]);\n    this.states.pointLightDiffuseColors.push(\n      color._array[0],\n      color._array[1],\n      color._array[2]\n    );\n\n    this.states.setValue('pointLightSpecularColors', [...this.states.pointLightSpecularColors]);\n    Array.prototype.push.apply(\n      this.states.pointLightSpecularColors,\n      this.states.specularColors\n    );\n\n    this.states.setValue('enableLighting', true);\n  };\n\n  RendererGL.prototype.imageLight = function(img) {\n    // activeImageLight property is checked by _setFillUniforms\n    // for sending uniforms to the fillshader\n    this.states.setValue('activeImageLight', img);\n    this.states.setValue('enableLighting', true);\n  };\n\n  RendererGL.prototype.lights = function() {\n    const grayColor = this._pInst.color('rgb(128,128,128)');\n    this.ambientLight(grayColor);\n    this.directionalLight(grayColor, 0, 0, -1);\n  };\n\n  RendererGL.prototype.lightFalloff = function(\n    constantAttenuation,\n    linearAttenuation,\n    quadraticAttenuation\n  ) {\n    if (constantAttenuation < 0) {\n      constantAttenuation = 0;\n      console.warn(\n        'Value of constant argument in lightFalloff() should be never be negative. Set to 0.'\n      );\n    }\n\n    if (linearAttenuation < 0) {\n      linearAttenuation = 0;\n      console.warn(\n        'Value of linear argument in lightFalloff() should be never be negative. Set to 0.'\n      );\n    }\n\n    if (quadraticAttenuation < 0) {\n      quadraticAttenuation = 0;\n      console.warn(\n        'Value of quadratic argument in lightFalloff() should be never be negative. Set to 0.'\n      );\n    }\n\n    if (\n      constantAttenuation === 0 &&\n      (linearAttenuation === 0 && quadraticAttenuation === 0)\n    ) {\n      constantAttenuation = 1;\n      console.warn(\n        'Either one of the three arguments in lightFalloff() should be greater than zero. Set constant argument to 1.'\n      );\n    }\n\n    this.states.setValue('constantAttenuation', constantAttenuation);\n    this.states.setValue('linearAttenuation', linearAttenuation);\n    this.states.setValue('quadraticAttenuation', quadraticAttenuation);\n  };\n\n  RendererGL.prototype.spotLight = function(\n    v1,\n    v2,\n    v3,\n    x,\n    y,\n    z,\n    nx,\n    ny,\n    nz,\n    angle,\n    concentration\n  ) {\n    let color, position, direction;\n    const length = arguments.length;\n\n    switch (length) {\n      case 11:\n      case 10:\n        color = this._pInst.color(v1, v2, v3);\n        position = new Vector(x, y, z);\n        direction = new Vector(nx, ny, nz);\n        break;\n\n      case 9:\n        if (v1 instanceof Color) {\n          color = v1;\n          position = new Vector(v2, v3, x);\n          direction = new Vector(y, z, nx);\n          angle = ny;\n          concentration = nz;\n        } else if (x instanceof Vector) {\n          color = this._pInst.color(v1, v2, v3);\n          position = x;\n          direction = new Vector(y, z, nx);\n          angle = ny;\n          concentration = nz;\n        } else if (nx instanceof Vector) {\n          color = this._pInst.color(v1, v2, v3);\n          position = new Vector(x, y, z);\n          direction = nx;\n          angle = ny;\n          concentration = nz;\n        } else {\n          color = this._pInst.color(v1, v2, v3);\n          position = new Vector(x, y, z);\n          direction = new Vector(nx, ny, nz);\n        }\n        break;\n\n      case 8:\n        if (v1 instanceof Color) {\n          color = v1;\n          position = new Vector(v2, v3, x);\n          direction = new Vector(y, z, nx);\n          angle = ny;\n        } else if (x instanceof Vector) {\n          color = this._pInst.color(v1, v2, v3);\n          position = x;\n          direction = new Vector(y, z, nx);\n          angle = ny;\n        } else {\n          color = this._pInst.color(v1, v2, v3);\n          position = new Vector(x, y, z);\n          direction = nx;\n          angle = ny;\n        }\n        break;\n\n      case 7:\n        if (v1 instanceof Color && v2 instanceof Vector) {\n          color = v1;\n          position = v2;\n          direction = new Vector(v3, x, y);\n          angle = z;\n          concentration = nx;\n        } else if (v1 instanceof Color && y instanceof Vector) {\n          color = v1;\n          position = new Vector(v2, v3, x);\n          direction = y;\n          angle = z;\n          concentration = nx;\n        } else if (x instanceof Vector && y instanceof Vector) {\n          color = this._pInst.color(v1, v2, v3);\n          position = x;\n          direction = y;\n          angle = z;\n          concentration = nx;\n        } else if (v1 instanceof Color) {\n          color = v1;\n          position = new Vector(v2, v3, x);\n          direction = new Vector(y, z, nx);\n        } else if (x instanceof Vector) {\n          color = this._pInst.color(v1, v2, v3);\n          position = x;\n          direction = new Vector(y, z, nx);\n        } else {\n          color = this._pInst.color(v1, v2, v3);\n          position = new Vector(x, y, z);\n          direction = nx;\n        }\n        break;\n\n      case 6:\n        if (x instanceof Vector && y instanceof Vector) {\n          color = this._pInst.color(v1, v2, v3);\n          position = x;\n          direction = y;\n          angle = z;\n        } else if (v1 instanceof Color && y instanceof Vector) {\n          color = v1;\n          position = new Vector(v2, v3, x);\n          direction = y;\n          angle = z;\n        } else if (v1 instanceof Color && v2 instanceof Vector) {\n          color = v1;\n          position = v2;\n          direction = new Vector(v3, x, y);\n          angle = z;\n        }\n        break;\n\n      case 5:\n        if (\n          v1 instanceof Color &&\n          v2 instanceof Vector &&\n          v3 instanceof Vector\n        ) {\n          color = v1;\n          position = v2;\n          direction = v3;\n          angle = x;\n          concentration = y;\n        } else if (x instanceof Vector && y instanceof Vector) {\n          color = this._pInst.color(v1, v2, v3);\n          position = x;\n          direction = y;\n        } else if (v1 instanceof Color && y instanceof Vector) {\n          color = v1;\n          position = new Vector(v2, v3, x);\n          direction = y;\n        } else if (v1 instanceof Color && v2 instanceof Vector) {\n          color = v1;\n          position = v2;\n          direction = new Vector(v3, x, y);\n        }\n        break;\n\n      case 4:\n        color = v1;\n        position = v2;\n        direction = v3;\n        angle = x;\n        break;\n\n      case 3:\n        color = v1;\n        position = v2;\n        direction = v3;\n        break;\n\n      default:\n        console.warn(\n          `Sorry, input for spotlight() is not in prescribed format. Too ${\n            length < 3 ? 'few' : 'many'\n          } arguments were provided`\n        );\n        return;\n    }\n    this.states.setValue('spotLightDiffuseColors', [\n      color._array[0],\n      color._array[1],\n      color._array[2]\n    ]);\n\n    this.states.setValue('spotLightSpecularColors', [\n      ...this.states.specularColors\n    ]);\n\n    this.states.setValue('spotLightPositions', [position.x, position.y, position.z]);\n    direction.normalize();\n    this.states.setValue('spotLightDirections', [\n      direction.x,\n      direction.y,\n      direction.z\n    ]);\n\n    if (angle === undefined) {\n      angle = Math.PI / 3;\n    }\n\n    if (concentration !== undefined && concentration < 1) {\n      concentration = 1;\n      console.warn(\n        'Value of concentration needs to be greater than 1. Setting it to 1'\n      );\n    } else if (concentration === undefined) {\n      concentration = 100;\n    }\n\n    angle = this._pInst._toRadians(angle);\n    this.states.setValue('spotLightAngle', [Math.cos(angle)]);\n    this.states.setValue('spotLightConc', [concentration]);\n\n    this.states.setValue('enableLighting', true);\n  };\n\n  RendererGL.prototype.noLights = function() {\n    this.states.setValue('activeImageLight', null);\n    this.states.setValue('enableLighting', false);\n\n    this.states.setValue('ambientLightColors', []);\n    this.states.setValue('specularColors', [1, 1, 1]);\n\n    this.states.setValue('directionalLightDirections', []);\n    this.states.setValue('directionalLightDiffuseColors', []);\n    this.states.setValue('directionalLightSpecularColors', []);\n\n    this.states.setValue('pointLightPositions', []);\n    this.states.setValue('pointLightDiffuseColors', []);\n    this.states.setValue('pointLightSpecularColors', []);\n\n    this.states.setValue('spotLightPositions', []);\n    this.states.setValue('spotLightDirections', []);\n    this.states.setValue('spotLightDiffuseColors', []);\n    this.states.setValue('spotLightSpecularColors', []);\n    this.states.setValue('spotLightAngle', []);\n    this.states.setValue('spotLightConc', []);\n\n    this.states.setValue('constantAttenuation', 1);\n    this.states.setValue('linearAttenuation', 0);\n    this.states.setValue('quadraticAttenuation', 0);\n    this.states.setValue('_useShininess', 1);\n    this.states.setValue('_useMetalness', 0);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  light(p5, p5.prototype);\n}\n\n/**\n * @module 3D\n * @submodule Material\n * @for p5\n * @requires core\n */\n\n\nfunction material(p5, fn){\n  /**\n   * Loads vertex and fragment shaders to create a\n   * <a href=\"#/p5.Shader\">p5.Shader</a> object.\n   *\n   * Shaders are programs that run on the graphics processing unit (GPU). They\n   * can process many pixels at the same time, making them fast for many\n   * graphics tasks. Theyre written in a language called\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Games/Techniques/3D_on_the_web/GLSL_Shaders\" target=\"_blank\">GLSL</a>\n   * and run along with the rest of the code in a sketch.\n   *\n   * Once the <a href=\"#/p5.Shader\">p5.Shader</a> object is created, it can be\n   * used with the <a href=\"#/p5/shader\">shader()</a> function, as in\n   * `shader(myShader)`. A shader program consists of two files, a vertex shader\n   * and a fragment shader. The vertex shader affects where 3D geometry is drawn\n   * on the screen and the fragment shader affects color.\n   *\n   * `loadShader()` loads the vertex and fragment shaders from their `.vert` and\n   * `.frag` files. For example, calling\n   * `loadShader('assets/shader.vert', 'assets/shader.frag')` loads both\n   * required shaders and returns a <a href=\"#/p5.Shader\">p5.Shader</a> object.\n   *\n   * The third parameter, `successCallback`, is optional. If a function is\n   * passed, it will be called once the shader has loaded. The callback function\n   * can use the new <a href=\"#/p5.Shader\">p5.Shader</a> object as its\n   * parameter. The return value of the `successCallback()` function will be used\n   * as the final return value of `loadShader()`.\n   *\n   * The fourth parameter, `failureCallback`, is also optional. If a function is\n   * passed, it will be called if the shader fails to load. The callback\n   * function can use the event error as its parameter. The return value of the `\n   * failureCallback()` function will be used as the final return value of `loadShader()`.\n   *\n   * This function returns a `Promise` and should be used in an `async` setup with\n   * `await`. See the examples for the usage syntax.\n   *\n   * Note: Shaders can only be used in WebGL mode.\n   *\n   * @method loadShader\n   * @param {String|Request} vertFilename path of the vertex shader to be loaded.\n   * @param {String|Request} fragFilename path of the fragment shader to be loaded.\n   * @param {Function} [successCallback] function to call once the shader is loaded. Can be passed the\n   *                                     <a href=\"#/p5.Shader\">p5.Shader</a> object.\n   * @param {Function} [failureCallback] function to call if the shader fails to load. Can be passed an\n   *                                     `Error` event object.\n   * @return {Promise<p5.Shader>} new shader created from the vertex and fragment shader files.\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * let mandelbrot;\n   *\n   * // Load the shader and create a p5.Shader object.\n   * async function setup() {\n   *   mandelbrot = await loadShader('assets/shader.vert', 'assets/shader.frag');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Compile and apply the p5.Shader object.\n   *   shader(mandelbrot);\n   *\n   *   // Set the shader uniform p to an array.\n   *   mandelbrot.setUniform('p', [-0.74364388703, 0.13182590421]);\n   *\n   *   // Set the shader uniform r to the value 1.5.\n   *   mandelbrot.setUniform('r', 1.5);\n   *\n   *   // Add a quad as a display surface for the shader.\n   *   quad(-1, -1, 1, -1, 1, 1, -1, 1);\n   *\n   *   describe('A black fractal image on a magenta background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * let mandelbrot;\n   *\n   * // Load the shader and create a p5.Shader object.\n   * async function setup() {\n   *   mandelbrot = await loadShader('assets/shader.vert', 'assets/shader.frag');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Use the p5.Shader object.\n   *   shader(mandelbrot);\n   *\n   *   // Set the shader uniform p to an array.\n   *   mandelbrot.setUniform('p', [-0.74364388703, 0.13182590421]);\n   *\n   *   describe('A fractal image zooms in and out of focus.');\n   * }\n   *\n   * function draw() {\n   *   // Set the shader uniform r to a value that oscillates between 0 and 2.\n   *   mandelbrot.setUniform('r', sin(frameCount * 0.01) + 1);\n   *\n   *   // Add a quad as a display surface for the shader.\n   *   quad(-1, -1, 1, -1, 1, 1, -1, 1);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.loadShader = async function (\n    vertFilename,\n    fragFilename,\n    successCallback,\n    failureCallback\n  ) {\n    // p5._validateParameters('loadShader', arguments);\n\n    const loadedShader = new Shader();\n\n    try {\n      loadedShader._vertSrc = (await request(vertFilename, 'text')).data;\n      loadedShader._fragSrc = (await request(fragFilename, 'text')).data;\n\n      if (successCallback) {\n        return successCallback(loadedShader);\n      } else {\n        return loadedShader\n      }\n    } catch(err) {\n      if (failureCallback) {\n        return failureCallback(err);\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  /**\n   * Creates a new <a href=\"#/p5.Shader\">p5.Shader</a> object.\n   *\n   * Shaders are programs that run on the graphics processing unit (GPU). They\n   * can process many pixels at the same time, making them fast for many\n   * graphics tasks. Theyre written in a language called\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Games/Techniques/3D_on_the_web/GLSL_Shaders\" target=\"_blank\">GLSL</a>\n   * and run along with the rest of the code in a sketch.\n   *\n   * Once the <a href=\"#/p5.Shader\">p5.Shader</a> object is created, it can be\n   * used with the <a href=\"#/p5/shader\">shader()</a> function, as in\n   * `shader(myShader)`. A shader program consists of two parts, a vertex shader\n   * and a fragment shader. The vertex shader affects where 3D geometry is drawn\n   * on the screen and the fragment shader affects color.\n   *\n   * The first parameter, `vertSrc`, sets the vertex shader. Its a string that\n   * contains the vertex shader program written in GLSL.\n   *\n   * The second parameter, `fragSrc`, sets the fragment shader. Its a string\n   * that contains the fragment shader program written in GLSL.\n   *\n   * A shader can optionally describe *hooks,* which are functions in GLSL that\n   * users may choose to provide to customize the behavior of the shader using the\n   * <a href=\"#/p5.Shader/modify\">`modify()`</a> method of `p5.Shader`. These are added by\n   * describing the hooks in a third parameter, `options`, and referencing the hooks in\n   * your `vertSrc` or `fragSrc`. Hooks for the vertex or fragment shader are described under\n   * the `vertex` and `fragment` keys of `options`. Each one is an object. where each key is\n   * the type and name of a hook function, and each value is a string with the\n   * parameter list and default implementation of the hook. For example, to let users\n   * optionally run code at the start of the vertex shader, the options object could\n   * include:\n   *\n   * ```js\n   * {\n   *   vertex: {\n   *     'void beforeVertex': '() {}'\n   *   }\n   * }\n   * ```\n   *\n   * Then, in your vertex shader source, you can run a hook by calling a function\n   * with the same name prefixed by `HOOK_`. If you want to check if the default\n   * hook has been replaced, maybe to avoid extra overhead, you can check if the\n   * same name prefixed by `AUGMENTED_HOOK_` has been defined:\n   *\n   * ```glsl\n   * void main() {\n   *   // In most cases, just calling the hook is fine:\n   *   HOOK_beforeVertex();\n   *\n   *   // Alternatively, for more efficiency:\n   *   #ifdef AUGMENTED_HOOK_beforeVertex\n   *   HOOK_beforeVertex();\n   *   #endif\n   *\n   *   // Add the rest of your shader code here!\n   * }\n   * ```\n   *\n   * Note: Only filter shaders can be used in 2D mode. All shaders can be used\n   * in WebGL mode.\n   *\n   * @method createShader\n   * @param {String} vertSrc source code for the vertex shader.\n   * @param {String} fragSrc source code for the fragment shader.\n   * @param {Object} [options] An optional object describing how this shader can\n   * be augmented with hooks. It can include:\n   *  - `vertex`: An object describing the available vertex shader hooks.\n   *  - `fragment`: An object describing the available frament shader hooks.\n   * @returns {p5.Shader} new shader object created from the\n   * vertex and fragment shaders.\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * precision highp float;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vTexCoord = aTexCoord;\n   *   vec4 positionVec4 = vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `\n   * precision highp float;\n   *\n   * void main() {\n   *   // Set each pixel's RGBA value to yellow.\n   *   gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n   * }\n   * `;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Shader object.\n   *   let shaderProgram = createShader(vertSrc, fragSrc);\n   *\n   *   // Compile and apply the p5.Shader object.\n   *   shader(shaderProgram);\n   *\n   *   // Style the drawing surface.\n   *   noStroke();\n   *\n   *   // Add a plane as a drawing surface.\n   *   plane(100, 100);\n   *\n   *   describe('A yellow square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * precision highp float;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vTexCoord = aTexCoord;\n   *   vec4 positionVec4 = vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `\n   * precision highp float;\n   * uniform vec2 p;\n   * uniform float r;\n   * const int numIterations = 500;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vec2 c = p + gl_FragCoord.xy * r;\n   *   vec2 z = c;\n   *   float n = 0.0;\n   *\n   *   for (int i = numIterations; i > 0; i--) {\n   *     if (z.x * z.x + z.y * z.y > 4.0) {\n   *       n = float(i) / float(numIterations);\n   *       break;\n   *     }\n   *     z = vec2(z.x * z.x - z.y * z.y, 2.0 * z.x * z.y) + c;\n   *   }\n   *\n   *   gl_FragColor = vec4(\n   *     0.5 - cos(n * 17.0) / 2.0,\n   *     0.5 - cos(n * 13.0) / 2.0,\n   *     0.5 - cos(n * 23.0) / 2.0,\n   *     1.0\n   *   );\n   * }\n   * `;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Shader object.\n   *   let mandelbrot = createShader(vertSrc, fragSrc);\n   *\n   *   // Compile and apply the p5.Shader object.\n   *   shader(mandelbrot);\n   *\n   *   // Set the shader uniform p to an array.\n   *   // p is the center point of the Mandelbrot image.\n   *   mandelbrot.setUniform('p', [-0.74364388703, 0.13182590421]);\n   *\n   *   // Set the shader uniform r to 0.005.\n   *   // r is the size of the image in Mandelbrot-space.\n   *   mandelbrot.setUniform('r', 0.005);\n   *\n   *   // Style the drawing surface.\n   *   noStroke();\n   *\n   *   // Add a plane as a drawing surface.\n   *   plane(100, 100);\n   *\n   *   describe('A black fractal image on a magenta background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * precision highp float;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   *\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vTexCoord = aTexCoord;\n   *   vec4 positionVec4 = vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `\n   * precision highp float;\n   * uniform vec2 p;\n   * uniform float r;\n   * const int numIterations = 500;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vec2 c = p + gl_FragCoord.xy * r;\n   *   vec2 z = c;\n   *   float n = 0.0;\n   *\n   *   for (int i = numIterations; i > 0; i--) {\n   *     if (z.x * z.x + z.y * z.y > 4.0) {\n   *       n = float(i) / float(numIterations);\n   *       break;\n   *     }\n   *\n   *     z = vec2(z.x * z.x - z.y * z.y, 2.0 * z.x * z.y) + c;\n   *   }\n   *\n   *   gl_FragColor = vec4(\n   *     0.5 - cos(n * 17.0) / 2.0,\n   *     0.5 - cos(n * 13.0) / 2.0,\n   *     0.5 - cos(n * 23.0) / 2.0,\n   *     1.0\n   *   );\n   * }\n   * `;\n   *\n   * let mandelbrot;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Shader object.\n   *   mandelbrot = createShader(vertSrc, fragSrc);\n   *\n   *   // Apply the p5.Shader object.\n   *   shader(mandelbrot);\n   *\n   *   // Set the shader uniform p to an array.\n   *   // p is the center point of the Mandelbrot image.\n   *   mandelbrot.setUniform('p', [-0.74364388703, 0.13182590421]);\n   *\n   *   describe('A fractal image zooms in and out of focus.');\n   * }\n   *\n   * function draw() {\n   *   // Set the shader uniform r to a value that oscillates\n   *   // between 0 and 0.005.\n   *   // r is the size of the image in Mandelbrot-space.\n   *   let radius = 0.005 * (sin(frameCount * 0.01) + 1);\n   *   mandelbrot.setUniform('r', radius);\n   *\n   *   // Style the drawing surface.\n   *   noStroke();\n   *\n   *   // Add a plane as a drawing surface.\n   *   plane(100, 100);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // A shader with hooks.\n   * let myShader;\n   *\n   * // A shader with modified hooks.\n   * let modifiedShader;\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * precision highp float;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   *\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   *\n   * void main() {\n   *   vec4 positionVec4 = vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n   * }\n   * `;\n   *\n   * // Create a fragment shader that uses a hook.\n   * let fragSrc = `\n   * precision highp float;\n   * void main() {\n   *   // Let users override the color\n   *   gl_FragColor = HOOK_getColor(vec4(1., 0., 0., 1.));\n   * }\n   * `;\n   *\n   * function setup() {\n   *   createCanvas(50, 50, WEBGL);\n   *\n   *   // Create a shader with hooks\n   *   myShader = createShader(vertSrc, fragSrc, {\n   *     fragment: {\n   *       'vec4 getColor': '(vec4 color) { return color; }'\n   *     }\n   *   });\n   *\n   *   // Make a version of the shader with a hook overridden\n   *   modifiedShader = myShader.modify({\n   *     'vec4 getColor': `(vec4 color) {\n   *       return vec4(0., 0., 1., 1.);\n   *     }`\n   *   });\n   * }\n   *\n   * function draw() {\n   *   noStroke();\n   *\n   *   push();\n   *   shader(myShader);\n   *   translate(-width/3, 0);\n   *   sphere(10);\n   *   pop();\n   *\n   *   push();\n   *   shader(modifiedShader);\n   *   translate(width/3, 0);\n   *   sphere(10);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createShader = function (vertSrc, fragSrc, options) {\n    // p5._validateParameters('createShader', arguments);\n    return new Shader(this._renderer, vertSrc, fragSrc, options);\n  };\n\n  /**\n   * Creates and loads a filter shader from an external file.\n   *\n   * @method loadFilterShader\n   * @param {String} fragFilename path to the fragment shader file\n   * @param {Function} [successCallback] callback to be called once the shader is\n   *                                     loaded. Will be passed the\n   *                                     <a href=\"#/p5.Shader\">p5.Shader</a> object.\n   * @param {Function} [failureCallback] callback to be called if there is an error\n   *                                     loading the shader. Will be passed the\n   *                                     error event.\n   * @return {Promise<p5.Shader>} a promise that resolves with a shader object\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * async function setup() {\n   *   myShader = await loadFilterShader('assets/basic.frag');\n   *   createCanvas(100, 100, WEBGL);\n   *   noStroke();\n   * }\n   *\n   * function draw() {\n   *   // shader() sets the active shader with our shader\n   *   shader(myShader);\n   *\n   *   // rect gives us some geometry on the screen\n   *   rect(-50, -50, width, height);\n   * }\n   * </code>\n   * </div>\n   * @alt\n   * A rectangle with a shader applied to it.\n   */\n  fn.loadFilterShader = async function (fragFilename, successCallback, failureCallback) {\n    // p5._validateParameters('loadFilterShader', arguments);\n    try {\n      // Load the fragment shader\n      const fragSrc = await this.loadStrings(fragFilename);\n      const fragString = await fragSrc.join('\\n');\n\n      // Create the shader using createFilterShader\n      const loadedShader = this.createFilterShader(fragString, true);\n\n      if (successCallback) {\n        successCallback(loadedShader);\n      }\n\n      return loadedShader;\n    } catch (err) {\n      if (failureCallback) {\n        failureCallback(err);\n      } else {\n        console.error(err);\n      }\n    }\n  };\n\n  /**\n   * Creates a <a href=\"#/p5.Shader\">p5.Shader</a> object to be used with the\n   * <a href=\"#/p5/filter\">filter()</a> function.\n   *\n   * `createFilterShader()` works like\n   * <a href=\"#/p5/createShader\">createShader()</a> but has a default vertex\n   * shader included. `createFilterShader()` is intended to be used along with\n   * <a href=\"#/p5/filter\">filter()</a> for filtering the contents of a canvas.\n   * A filter shader will be applied to the whole canvas instead of just\n   * <a href=\"#/p5.Geometry\">p5.Geometry</a> objects.\n   *\n   * The parameter, `fragSrc`, sets the fragment shader. Its a string that\n   * contains the fragment shader program written in\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Games/Techniques/3D_on_the_web/GLSL_Shaders\" target=\"_blank\">GLSL</a>.\n   *\n   * The <a href=\"#/p5.Shader\">p5.Shader</a> object that's created has some\n   * uniforms that can be set:\n   * - `sampler2D tex0`, which contains the canvas contents as a texture.\n   * - `vec2 canvasSize`, which is the width and height of the canvas, not including pixel density.\n   * - `vec2 texelSize`, which is the size of a physical pixel including pixel density. This is calculated as `1.0 / (width * density)` for the pixel width and `1.0 / (height * density)` for the pixel height.\n   *\n   * The <a href=\"#/p5.Shader\">p5.Shader</a> that's created also provides\n   * `varying vec2 vTexCoord`, a coordinate with values between 0 and 1.\n   * `vTexCoord` describes where on the canvas the pixel will be drawn.\n   *\n   * For more info about filters and shaders, see Adam Ferriss' <a href=\"https://github.com/aferriss/p5jsShaderExamples\">repo of shader examples</a>\n   * or the <a href=\"https://p5js.org/learn/getting-started-in-webgl-shaders.html\">Introduction to Shaders</a> tutorial.\n   *\n   * @method createFilterShader\n   * @param {String} fragSrc source code for the fragment shader.\n   * @returns {p5.Shader} new shader object created from the fragment shader.\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * function setup() {\n   *   let fragSrc = `precision highp float;\n   *   void main() {\n   *     gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n   *   }`;\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *   let s = createFilterShader(fragSrc);\n   *   filter(s);\n   *   describe('a yellow canvas');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div modernizr='webgl'>\n   * <code>\n   * let img, s;\n   * async function setup() {\n   *   img = await loadImage('assets/bricks.jpg');\n   *   let fragSrc = `precision highp float;\n   *\n   *   // x,y coordinates, given from the vertex shader\n   *   varying vec2 vTexCoord;\n   *\n   *   // the canvas contents, given from filter()\n   *   uniform sampler2D tex0;\n   *   // other useful information from the canvas\n   *   uniform vec2 texelSize;\n   *   uniform vec2 canvasSize;\n   *   // a custom variable from this sketch\n   *   uniform float darkness;\n   *\n   *   void main() {\n   *     // get the color at current pixel\n   *     vec4 color = texture2D(tex0, vTexCoord);\n   *     // set the output color\n   *     color.b = 1.0;\n   *     color *= darkness;\n   *     gl_FragColor = vec4(color.rgb, 1.0);\n   *   }`;\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *   s = createFilterShader(fragSrc);\n   * }\n   *\n   * function draw() {\n   *   image(img, -50, -50);\n   *   s.setUniform('darkness', 0.5);\n   *   filter(s);\n   *   describe('a image of bricks tinted dark blue');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createFilterShader = function (fragSrc, skipContextCheck = false) {\n    // p5._validateParameters('createFilterShader', arguments);\n    let defaultVertV1 = `\n      uniform mat4 uModelViewMatrix;\n      uniform mat4 uProjectionMatrix;\n\n      attribute vec3 aPosition;\n      // texcoords only come from p5 to vertex shader\n      // so pass texcoords on to the fragment shader in a varying variable\n      attribute vec2 aTexCoord;\n      varying vec2 vTexCoord;\n\n      void main() {\n        // transferring texcoords for the frag shader\n        vTexCoord = aTexCoord;\n\n        // copy position with a fourth coordinate for projection (1.0 is normal)\n        vec4 positionVec4 = vec4(aPosition, 1.0);\n\n        // project to 3D space\n        gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n      }\n    `;\n    let defaultVertV2 = `#version 300 es\n      uniform mat4 uModelViewMatrix;\n      uniform mat4 uProjectionMatrix;\n\n      in vec3 aPosition;\n      in vec2 aTexCoord;\n      out vec2 vTexCoord;\n\n      void main() {\n        // transferring texcoords for the frag shader\n        vTexCoord = aTexCoord;\n\n        // copy position with a fourth coordinate for projection (1.0 is normal)\n        vec4 positionVec4 = vec4(aPosition, 1.0);\n\n        // project to 3D space\n        gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n      }\n    `;\n    let vertSrc = fragSrc.includes('#version 300 es') ? defaultVertV2 : defaultVertV1;\n    const shader = new Shader(this._renderer, vertSrc, fragSrc);\n    if (!skipContextCheck) {\n      if (this._renderer.GL) {\n        shader.ensureCompiledOnContext(this._renderer);\n      } else {\n        shader.ensureCompiledOnContext(this);\n      }\n    }\n    return shader;\n  };\n\n  /**\n   * Sets the <a href=\"#/p5.Shader\">p5.Shader</a> object to apply while drawing.\n   *\n   * Shaders are programs that run on the graphics processing unit (GPU). They\n   * can process many pixels or vertices at the same time, making them fast for\n   * many graphics tasks. Theyre written in a language called\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Games/Techniques/3D_on_the_web/GLSL_Shaders\" target=\"_blank\">GLSL</a>\n   * and run along with the rest of the code in a sketch.\n   * <a href=\"#/p5.Shader\">p5.Shader</a> objects can be created using the\n   * <a href=\"#/p5/createShader\">createShader()</a> and\n   * <a href=\"#/p5/loadShader\">loadShader()</a> functions.\n   *\n   * The parameter, `s`, is the <a href=\"#/p5.Shader\">p5.Shader</a> object to\n   * apply. For example, calling `shader(myShader)` applies `myShader` to\n   * process each pixel on the canvas. This only changes the fill (the inner part of shapes),\n   * but does not affect the outlines (strokes) or any images drawn using the `image()` function.\n   * The source code from a <a href=\"#/p5.Shader\">p5.Shader</a> object's\n   * fragment and vertex shaders will be compiled the first time it's passed to\n   * `shader()`. See\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/compileShader\" target=\"_blank\">MDN</a>\n   * for more information about compiling shaders.\n   *\n   * Calling <a href=\"#/p5/resetShader\">resetShader()</a> restores a sketchs\n   * default shaders.\n   *\n   * Note: Shaders can only be used in WebGL mode.\n   *\n   * <div>\n   * <p>\n   *\n   * If you want to apply shaders to strokes or images, use the following methods:\n   * - <a href=\"#/p5/strokeShader\">strokeShader()</a> : Applies a shader to the stroke (outline) of shapes, allowing independent control over the stroke rendering using shaders.\n   * - <a href=\"#/p5/imageShader\">imageShader()</a> : Applies a shader to images or textures, controlling how the shader modifies their appearance during rendering.\n   *\n   * </p>\n   * </div>\n   *\n   *\n   * @method shader\n   * @chainable\n   * @param {p5.Shader} s <a href=\"#/p5.Shader\">p5.Shader</a> object\n   *                      to apply.\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let fillShader;\n   *\n   * let vertSrc = `\n   * precision highp float;\n   * attribute vec3 aPosition;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   * varying vec3 vPosition;\n   *\n   * void main() {\n   *   vPosition = aPosition;\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(aPosition, 1.0);\n   * }\n   * `;\n   *\n   * let fragSrc = `\n   * precision highp float;\n   * uniform vec3 uLightDir;\n   * varying vec3 vPosition;\n   *\n   * void main() {\n   *   vec3 lightDir = normalize(uLightDir);\n   *   float brightness = dot(lightDir, normalize(vPosition));\n   *   brightness = clamp(brightness, 0.4, 1.0);\n   *   vec3 color = vec3(0.3, 0.5, 1.0);\n   *   color = color * brightness * 3.0;\n   *   gl_FragColor = vec4(color, 1.0);\n   * }\n   * `;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   fillShader = createShader(vertSrc, fragSrc);\n   *   noStroke();\n   *   describe('A rotating torus with simulated directional lighting.');\n   * }\n   *\n   * function draw() {\n   *   background(20, 20, 40);\n   *   let lightDir = [0.5, 0.5, -1.0];\n   *   fillShader.setUniform('uLightDir', lightDir);\n   *   shader(fillShader);\n   *   rotateY(frameCount * 0.02);\n   *   rotateX(frameCount * 0.02);\n   *   //lights();\n   *   torus(25, 10, 30, 30);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let fillShader;\n   *\n   * let vertSrc = `\n   * precision highp float;\n   * attribute vec3 aPosition;\n   * uniform mat4 uProjectionMatrix;\n   * uniform mat4 uModelViewMatrix;\n   * varying vec3 vPosition;\n   * void main() {\n   *   vPosition = aPosition;\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(aPosition, 1.0);\n   * }\n   * `;\n   *\n   * let fragSrc = `\n   * precision highp float;\n   * uniform vec3 uLightPos;\n   * uniform vec3 uFillColor;\n   * varying vec3 vPosition;\n   * void main() {\n   *   float brightness = dot(normalize(uLightPos), normalize(vPosition));\n   *   brightness = clamp(brightness, 0.0, 1.0);\n   *   vec3 color = uFillColor * brightness;\n   *   gl_FragColor = vec4(color, 1.0);\n   * }\n   * `;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   fillShader = createShader(vertSrc, fragSrc);\n   *   shader(fillShader);\n   *   noStroke();\n   *   describe('A square affected by both fill color and lighting, with lights controlled by mouse.');\n   * }\n   *\n   * function draw() {\n   *   let lightPos = [(mouseX - width / 2) / width,\n   *     (mouseY - height / 2) / height, 1.0];\n   *   fillShader.setUniform('uLightPos', lightPos);\n   *   let fillColor = [map(mouseX, 0, width, 0, 1),\n   *     map(mouseY, 0, height, 0, 1), 0.5];\n   *   fillShader.setUniform('uFillColor', fillColor);\n   *   plane(100, 100);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *\n   *   myShader = baseMaterialShader().modify({\n   *     declarations: 'uniform float time;',\n   *     'vec4 getFinalColor': `(vec4 color) {\n   *       float r = 0.2 + 0.5 * abs(sin(time + 0.0));\n   *       float g = 0.2 + 0.5 * abs(sin(time + 1.0));\n   *       float b = 0.2 + 0.5 * abs(sin(time + 2.0));\n   *       color.rgb = vec3(r, g, b);\n   *       return color;\n   *     }`\n   *   });\n   *\n   *   noStroke();\n   *   describe('A 3D cube with dynamically changing colors on a beige background.');\n   * }\n   *\n   * function draw() {\n   *   background(245, 245, 220);\n   *   shader(myShader);\n   *   myShader.setUniform('time', millis() / 1000.0);\n   *\n   *   box(50);\n   * }\n   * </code>\n   * </div>\n   *\n   */\n  fn.shader = function (s) {\n    this._assert3d('shader');\n    // p5._validateParameters('shader', arguments);\n\n    this._renderer.shader(s);\n\n    return this;\n  };\n\n  /**\n   * Sets the <a href=\"#/p5.Shader\">p5.Shader</a> object to apply for strokes.\n   *\n   * This method applies the given shader to strokes, allowing customization of\n   * how lines and outlines are drawn in 3D space. The shader will be used for\n   * strokes until <a href=\"#/p5/resetShader\">resetShader()</a> is called or another\n   * strokeShader is applied.\n   *\n   * The shader will be used for:\n   * - Strokes only, regardless of whether the uniform `uStrokeWeight` is present.\n   *\n   * To further customize its behavior, refer to the various hooks provided by\n   * the <a href=\"#/p5/baseStrokeShader\">baseStrokeShader()</a> method, which allow\n   * control over stroke weight, vertex positions, colors, and more.\n   *\n   * @method strokeShader\n   * @chainable\n   * @param {p5.Shader} s <a href=\"#/p5.Shader\">p5.Shader</a> object\n   *                      to apply for strokes.\n   *\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let animatedStrokeShader;\n   *\n   * let vertSrc = `\n   * precision mediump int;\n   *\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   * uniform float uStrokeWeight;\n   *\n   * uniform bool uUseLineColor;\n   * uniform vec4 uMaterialColor;\n   *\n   * uniform vec4 uViewport;\n   * uniform int uPerspective;\n   * uniform int uStrokeJoin;\n   *\n   * attribute vec4 aPosition;\n   * attribute vec3 aTangentIn;\n   * attribute vec3 aTangentOut;\n   * attribute float aSide;\n   * attribute vec4 aVertexColor;\n   *\n   * void main() {\n   *   vec4 posp = uModelViewMatrix * aPosition;\n   *   vec4 posqIn = uModelViewMatrix * (aPosition + vec4(aTangentIn, 0));\n   *   vec4 posqOut = uModelViewMatrix * (aPosition + vec4(aTangentOut, 0));\n   *\n   *   float facingCamera = pow(\n   *     abs(normalize(posqIn-posp).z),\n   *     0.25\n   *   );\n   *\n   *   float scale = mix(1., 0.995, facingCamera);\n   *\n   *   posp.xyz = posp.xyz * scale;\n   *   posqIn.xyz = posqIn.xyz * scale;\n   *   posqOut.xyz = posqOut.xyz * scale;\n   *\n   *   vec4 p = uProjectionMatrix * posp;\n   *   vec4 qIn = uProjectionMatrix * posqIn;\n   *   vec4 qOut = uProjectionMatrix * posqOut;\n   *\n   *   vec2 tangentIn = normalize((qIn.xy*p.w - p.xy*qIn.w) * uViewport.zw);\n   *   vec2 tangentOut = normalize((qOut.xy*p.w - p.xy*qOut.w) * uViewport.zw);\n   *\n   *   vec2 curPerspScale;\n   *   if(uPerspective == 1) {\n   *     curPerspScale = (uProjectionMatrix * vec4(1, sign(uProjectionMatrix[1][1]), 0, 0)).xy;\n   *   } else {\n   *     curPerspScale = p.w / (0.5 * uViewport.zw);\n   *   }\n   *\n   *   vec2 offset;\n   *   vec2 tangent = aTangentIn == vec3(0.) ? tangentOut : tangentIn;\n   *   vec2 normal = vec2(-tangent.y, tangent.x);\n   *   float normalOffset = sign(aSide);\n   *   float tangentOffset = abs(aSide) - 1.;\n   *   offset = (normal * normalOffset + tangent * tangentOffset) *\n   *     uStrokeWeight * 0.5;\n   *\n   *   gl_Position.xy = p.xy + offset.xy * curPerspScale;\n   *   gl_Position.zw = p.zw;\n   * }\n   * `;\n   *\n   * let fragSrc = `\n   * precision mediump float;\n   * uniform float uTime;\n   *\n   * void main() {\n   *   float wave = sin(gl_FragCoord.x * 0.1 + uTime) * 0.5 + 0.5;\n   *   gl_FragColor = vec4(wave, 0.5, 1.0, 1.0);  // Animated color based on time\n   * }\n   * `;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   animatedStrokeShader = createShader(vertSrc, fragSrc);\n   *   strokeShader(animatedStrokeShader);\n   *   strokeWeight(4);\n   *\n   *   describe('A hollow cube rotating continuously with its stroke colors changing dynamically over time against a static gray background.');\n   * }\n   *\n   * function draw() {\n   *   animatedStrokeShader.setUniform('uTime', millis() / 1000.0);\n   *   background(250);\n   *   rotateY(frameCount * 0.02);\n   *   noFill();\n   *   orbitControl();\n   *   box(50);\n   * }\n   * </code>\n   * </div>\n   *\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseStrokeShader().modify({\n   *     'float random': `(vec2 p) {\n   *       vec3 p3  = fract(vec3(p.xyx) * .1471);\n   *       p3 += dot(p3, p3.yzx + 32.33);\n   *       return fract((p3.x + p3.y) * p3.z);\n   *     }`,\n   *     'Inputs getPixelInputs': `(Inputs inputs) {\n   *       // Modify alpha with dithering effect\n   *       float a = inputs.color.a;\n   *       inputs.color.a = 1.0;\n   *       inputs.color *= random(inputs.position.xy) > a ? 0.0 : 1.0;\n   *       return inputs;\n   *     }`\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   strokeShader(myShader);\n   *   strokeWeight(12);\n   *   beginShape();\n   *   for (let i = 0; i <= 50; i++) {\n   *     stroke(\n   *       map(i, 0, 50, 150, 255),\n   *       100 + 155 * sin(i / 5),\n   *       255 * map(i, 0, 50, 1, 0)\n   *     );\n   *     vertex(\n   *       map(i, 0, 50, 1, -1) * width / 3,\n   *       50 * cos(i / 10 + frameCount / 80)\n   *     );\n   *   }\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.strokeShader = function (s) {\n    this._assert3d('strokeShader');\n    // p5._validateParameters('strokeShader', arguments);\n\n    this._renderer.strokeShader(s);\n\n    return this;\n  };\n\n  /**\n   * Sets the <a href=\"#/p5.Shader\">p5.Shader</a> object to apply for images.\n   *\n   * This method allows the user to apply a custom shader to images, enabling\n   * advanced visual effects such as pixel manipulation, color adjustments,\n   * or dynamic behavior. The shader will be applied to the image drawn using\n   * the <a href=\"#/p5/image\">image()</a> function.\n   *\n   * The shader will be used exclusively for:\n   * - `image()` calls, applying only when drawing 2D images.\n   * - This shader will NOT apply to images used in <a href=\"#/p5/texture\">texture()</a> or other 3D contexts.\n   *   Any attempts to use the imageShader in these cases will be ignored.\n   *\n   * @method imageShader\n   * @chainable\n   * @param {p5.Shader} s <a href=\"#/p5.Shader\">p5.Shader</a> object\n   *                      to apply for images.\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let img;\n   * let imgShader;\n   *\n   * async function setup() {\n   *   img = await loadImage('assets/outdoor_image.jpg');\n   *\n   *   createCanvas(200, 200, WEBGL);\n   *   noStroke();\n   *\n   *   imgShader = createShader(`\n   *     precision mediump float;\n   *     attribute vec3 aPosition;\n   *     attribute vec2 aTexCoord;\n   *     varying vec2 vTexCoord;\n   *     uniform mat4 uModelViewMatrix;\n   *     uniform mat4 uProjectionMatrix;\n   *\n   *     void main() {\n   *       vTexCoord = aTexCoord;\n   *       gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(aPosition, 1.0);\n   *     }\n   *   `, `\n   *     precision mediump float;\n   *     varying vec2 vTexCoord;\n   *     uniform sampler2D uTexture;\n   *     uniform vec2 uMousePos;\n   *\n   *     void main() {\n   *       vec4 texColor = texture2D(uTexture, vTexCoord);\n   *       // Adjust the color based on mouse position\n   *       float r = uMousePos.x * texColor.r;\n   *       float g = uMousePos.y * texColor.g;\n   *       gl_FragColor = vec4(r, g, texColor.b, texColor.a);\n   *     }\n   *   `);\n   *\n   *   describe(\n   *     'An image on a gray background where the colors change based on the mouse position.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(220);\n   *\n   *   imageShader(imgShader);\n   *\n   *   // Map the mouse position to a range between 0 and 1\n   *   let mousePosX = map(mouseX, 0, width, 0, 1);\n   *   let mousePosY = map(mouseY, 0, height, 0, 1);\n   *\n   *   // Pass the mouse position to the shader as a uniform\n   *   imgShader.setUniform('uMousePos', [mousePosX, mousePosY]);\n   *\n   *   // Bind the image texture to the shader\n   *   imgShader.setUniform('uTexture', img);\n   *\n   *   image(img, -width / 2, -height / 2, width, height);\n   * }\n   *\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let img;\n   * let imgShader;\n   *\n   * async function setup() {\n   *   img = await loadImage('assets/outdoor_image.jpg');\n   *\n   *   createCanvas(200, 200, WEBGL);\n   *   noStroke();\n   *\n   *   imgShader = createShader(`\n   *     precision mediump float;\n   *     attribute vec3 aPosition;\n   *     attribute vec2 aTexCoord;\n   *     varying vec2 vTexCoord;\n   *     uniform mat4 uModelViewMatrix;\n   *     uniform mat4 uProjectionMatrix;\n   *\n   *     void main() {\n   *       vTexCoord = aTexCoord;\n   *       gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(aPosition, 1.0);\n   *     }\n   *   `, `\n   *     precision mediump float;\n   *     varying vec2 vTexCoord;\n   *     uniform sampler2D uTexture;\n   *     uniform vec2 uMousePos;\n   *\n   *     void main() {\n   *       // Distance from the current pixel to the mouse\n   *       float distFromMouse = distance(vTexCoord, uMousePos);\n   *\n   *       // Adjust pixelation based on distance (closer = more detail, farther = blockier)\n   *       float pixelSize = mix(0.002, 0.05, distFromMouse);\n   *       vec2 pixelatedCoord = vec2(floor(vTexCoord.x / pixelSize) * pixelSize,\n   *                                  floor(vTexCoord.y / pixelSize) * pixelSize);\n   *\n   *       vec4 texColor = texture2D(uTexture, pixelatedCoord);\n   *       gl_FragColor = texColor;\n   *     }\n   *   `);\n   *\n   *   describe('A static image with a grid-like, pixelated effect created by the shader. Each cell in the grid alternates visibility, producing a dithered visual effect.');\n   * }\n   *\n   * function draw() {\n   *   background(220);\n   *   imageShader(imgShader);\n   *\n   *   let mousePosX = map(mouseX, 0, width, 0, 1);\n   *   let mousePosY = map(mouseY, 0, height, 0, 1);\n   *\n   *   imgShader.setUniform('uMousePos', [mousePosX, mousePosY]);\n   *   imgShader.setUniform('uTexture', img);\n   *   image(img, -width / 2, -height / 2, width, height);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.imageShader = function (s) {\n    this._assert3d('imageShader');\n    // p5._validateParameters('imageShader', arguments);\n\n    this._renderer.imageShader(s);\n\n    return this;\n  };\n\n  /**\n   * Get the default shader used with lights, materials,\n   * and textures.\n   *\n   * You can call <a href=\"#/p5.Shader/modify\">`baseMaterialShader().modify()`</a>\n   * and change any of the following hooks:\n   *\n   * <table>\n   * <tr><th>Hook</th><th>Description</th></tr>\n   * <tr><td>\n   *\n   * `void beforeVertex`\n   *\n   * </td><td>\n   *\n   * Called at the start of the vertex shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `Vertex getObjectInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the model being drawn before any positioning has been applied. It takes in a `Vertex` struct, which includes:\n   * - `vec3 position`, the position of the vertex\n   * - `vec3 normal`, the direction facing out of the surface\n   * - `vec2 texCoord`, the texture coordinates associeted with the vertex\n   * - `vec4 color`, the per-vertex color\n   * The struct can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `Vertex getWorldInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the model being drawn after transformations such as `translate()` and `scale()` have been applied, but before the camera has been applied. It takes in a `Vertex` struct like, in the `getObjectInputs` hook above, that can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `Vertex getCameraInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the model being drawn as they appear relative to the camera. It takes in a `Vertex` struct like, in the `getObjectInputs` hook above, that can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void afterVertex`\n   *\n   * </td><td>\n   *\n   * Called at the end of the vertex shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void beforeFragment`\n   *\n   * </td><td>\n   *\n   * Called at the start of the fragment shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `Inputs getPixelInputs`\n   *\n   * </td><td>\n   *\n   * Update the per-pixel inputs of the material. It takes in an `Inputs` struct, which includes:\n   * - `vec3 normal`, the direction pointing out of the surface\n   * - `vec2 texCoord`, a vector where `x` and `y` are between 0 and 1 describing the spot on a texture the pixel is mapped to, as a fraction of the texture size\n   * - `vec3 ambientLight`, the ambient light color on the vertex\n   * - `vec4 color`, the base material color of the pixel\n   * - `vec3 ambientMaterial`, the color of the pixel when affected by ambient light\n   * - `vec3 specularMaterial`, the color of the pixel when reflecting specular highlights\n   * - `vec3 emissiveMaterial`, the light color emitted by the pixel\n   * - `float shininess`, a number representing how sharp specular reflections should be, from 1 to infinity\n   * - `float metalness`, a number representing how mirrorlike the material should be, between 0 and 1\n   * The struct can be modified and returned.\n   * </td></tr>\n   * <tr><td>\n   *\n   * `vec4 combineColors`\n   *\n   * </td><td>\n   *\n   * Take in a `ColorComponents` struct containing all the different components of light, and combining them into\n   * a single final color. The struct contains:\n   * - `vec3 baseColor`, the base color of the pixel\n   * - `float opacity`, the opacity between 0 and 1 that it should be drawn at\n   * - `vec3 ambientColor`, the color of the pixel when affected by ambient light\n   * - `vec3 specularColor`, the color of the pixel when affected by specular reflections\n   * - `vec3 diffuse`, the amount of diffused light hitting the pixel\n   * - `vec3 ambient`, the amount of ambient light hitting the pixel\n   * - `vec3 specular`, the amount of specular reflection hitting the pixel\n   * - `vec3 emissive`, the amount of light emitted by the pixel\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `vec4 getFinalColor`\n   *\n   * </td><td>\n   *\n   * Update the final color after mixing. It takes in a `vec4 color` and must return a modified version.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void afterFragment`\n   *\n   * </td><td>\n   *\n   * Called at the end of the fragment shader.\n   *\n   * </td></tr>\n   * </table>\n   *\n   * Most of the time, you will need to write your hooks in GLSL ES version 300. If you\n   * are using WebGL 1 instead of 2, write your hooks in GLSL ES 100 instead.\n   *\n   * Call `baseMaterialShader().inspectHooks()` to see all the possible hooks and\n   * their default implementations.\n   *\n   * @method baseMaterialShader\n   * @beta\n   * @returns {p5.Shader} The material shader\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseMaterialShader().modify(() => {\n   *     let time = uniformFloat(() => millis());\n   *     getWorldInputs((inputs) => {\n   *       inputs.position.y +=\n   *         20 * sin(time * 0.001 + inputs.position.x * 0.05);\n   *       return inputs;\n   *     });\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   shader(myShader);\n   *   lights();\n   *   noStroke();\n   *   fill('red');\n   *   sphere(50);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseMaterialShader().modify({\n   *     declarations: 'vec3 myNormal;',\n   *     'Inputs getPixelInputs': `(Inputs inputs) {\n   *       myNormal = inputs.normal;\n   *       return inputs;\n   *     }`,\n   *     'vec4 getFinalColor': `(vec4 color) {\n   *       return mix(\n   *         vec4(1.0, 1.0, 1.0, 1.0),\n   *         color,\n   *         abs(dot(myNormal, vec3(0.0, 0.0, 1.0)))\n   *       );\n   *     }`\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   rotateY(millis() * 0.001);\n   *   shader(myShader);\n   *   lights();\n   *   noStroke();\n   *   fill('red');\n   *   torus(30);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   * let environment;\n   *\n   * async function setup() {\n   *   environment = await loadImage('assets/outdoor_spheremap.jpg');\n   *\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseMaterialShader().modify(() => {\n   *     getPixelInputs((inputs) => {\n   *       let factor = sin(\n   *         TWO_PI * (inputs.texCoord.x + inputs.texCoord.y)\n   *       );\n   *       inputs.shininess = mix(1, 100, factor);\n   *       inputs.metalness = factor;\n   *       return inputs;\n   *     })\n   *   });\n   * }\n   *\n   * function draw() {\n   *   panorama(environment);\n   *   ambientLight(100);\n   *   imageLight(environment);\n   *   rotateY(millis() * 0.001);\n   *   shader(myShader);\n   *   noStroke();\n   *   fill(255);\n   *   specularMaterial(150);\n   *   sphere(50);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseMaterialShader().modify(() => {\n   *     getPixelInputs((inputs) => {\n   *       inputs.normal.x += 0.2 * sin(\n   *         sin(TWO_PI * dot(inputs.texCoord.yx, vec2(10, 25)))\n   *       );\n   *       inputs.normal.y += 0.2 * sin(\n   *         sin(TWO_PI * dot(inputs.texCoord, vec2(10, 25)))\n   *       );\n   *       inputs.normal = normalize(inputs.normal);\n   *       return inputs;\n   *     });\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   shader(myShader);\n   *   ambientLight(150);\n   *   pointLight(\n   *     255, 255, 255,\n   *     100*cos(frameCount*0.04), -50, 100*sin(frameCount*0.04)\n   *   );\n   *   noStroke();\n   *   fill('red');\n   *   shininess(200);\n   *   specularMaterial(255);\n   *   sphere(50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.baseMaterialShader = function() {\n    this._assert3d('baseMaterialShader');\n    return this._renderer.baseMaterialShader();\n  };\n\n  /**\n   * Get the base shader for filters.\n   *\n   * You can then call <a href=\"#/p5.Shader/modify\">`baseFilterShader().modify()`</a>\n   * and change the following hook:\n   *\n   * <table>\n   * <tr><th>Hook</th><th>Description</th></tr>\n   * <tr><td>\n   *\n   * `vec4 getColor`\n   *\n   * </td><td>\n   *\n   * Output the final color for the current pixel. It takes in two parameters:\n   * `FilterInputs inputs`, and `in sampler2D canvasContent`, and must return a color\n   * as a `vec4`.\n   *\n   * `FilterInputs inputs` is a scruct with the following properties:\n   * - `vec2 texCoord`, the position on the canvas, with coordinates between 0 and 1. Calling\n   *   `getTexture(canvasContent, texCoord)` returns the original color of the current pixel.\n   * - `vec2 canvasSize`, the width and height of the sketch.\n   * - `vec2 texelSize`, the size of one real pixel relative to the size of the whole canvas.\n   *   This is equivalent to `1 / (canvasSize * pixelDensity)`.\n   *\n   * `in sampler2D canvasContent` is a texture with the contents of the sketch, pre-filter. Call\n   * `getTexture(canvasContent, someCoordinate)` to retrieve the color of the sketch at that coordinate,\n   * with coordinate values between 0 and 1.\n   *\n   * </td></tr>\n   * </table>\n   *\n   * Most of the time, you will need to write your hooks in GLSL ES version 300. If you\n   * are using WebGL 1, write your hooks in GLSL ES 100 instead.\n   *\n   * @method baseFilterShader\n   * @beta\n   * @returns {p5.Shader} The filter shader\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let img;\n   * let myShader;\n   *\n   * async function setup() {\n   *   img = await loadImage('assets/bricks.jpg');\n   *   createCanvas(100, 100, WEBGL);\n   *   myShader = baseFilterShader().modify(() => {\n   *     let time = uniformFloat(() => millis());\n   *     getColor((inputs, canvasContent) => {\n   *       inputs.texCoord.y +=\n   *         0.02 * sin(time * 0.001 + inputs.texCoord.x * 5);\n   *       return texture(canvasContent, inputs.texCoord);\n   *     });\n   *   });\n   * }\n   *\n   * function draw() {\n   *   image(img, -50, -50);\n   *   filter(myShader);\n   *   describe('an image of bricks, distorting over time');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.baseFilterShader = function() {\n    return (this._renderer.filterRenderer || this._renderer)\n      .baseFilterShader();\n  };\n\n  /**\n   * Get the shader used by <a href=\"#/p5/normalMaterial\">`normalMaterial()`</a>.\n   *\n   * You can call <a href=\"#/p5.Shader/modify\">`baseNormalShader().modify()`</a>\n   * and change any of the following hooks:\n   *\n   * <table>\n   * <tr><th>Hook</th><th>Description</th></tr>\n   * <tr><td>\n   *\n   * `void beforeVertex`\n   *\n   * </td><td>\n   *\n   * Called at the start of the vertex shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `Vertex getObjectInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the model being drawn before any positioning has been applied. It takes in a `Vertex` struct, which includes:\n   * - `vec3 position`, the position of the vertex\n   * - `vec3 normal`, the direction facing out of the surface\n   * - `vec2 texCoord`, the texture coordinates associeted with the vertex\n   * - `vec4 color`, the per-vertex color\n   * The struct can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `Vertex getWorldInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the model being drawn after transformations such as `translate()` and `scale()` have been applied, but before the camera has been applied. It takes in a `Vertex` struct like, in the `getObjectInputs` hook above, that can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `Vertex getCameraInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the model being drawn as they appear relative to the camera. It takes in a `Vertex` struct like, in the `getObjectInputs` hook above, that can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void afterVertex`\n   *\n   * </td><td>\n   *\n   * Called at the end of the vertex shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void beforeFragment`\n   *\n   * </td><td>\n   *\n   * Called at the start of the fragment shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `vec4 getFinalColor`\n   *\n   * </td><td>\n   *\n   * Update the final color after mixing. It takes in a `vec4 color` and must return a modified version.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void afterFragment`\n   *\n   * </td><td>\n   *\n   * Called at the end of the fragment shader.\n   *\n   * </td></tr>\n   * </table>\n   *\n   * Most of the time, you will need to write your hooks in GLSL ES version 300. If you\n   * are using WebGL 1 instead of 2, write your hooks in GLSL ES 100 instead.\n   *\n   * Call `baseNormalShader().inspectHooks()` to see all the possible hooks and\n   * their default implementations.\n   *\n   * @method baseNormalShader\n   * @beta\n   * @returns {p5.Shader} The `normalMaterial` shader\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseNormalShader().modify({\n   *     uniforms: {\n   *       'float time': () => millis()\n   *     },\n   *     'Vertex getWorldInputs': `(Vertex inputs) {\n   *       inputs.position.y +=\n   *         20. * sin(time * 0.001 + inputs.position.x * 0.05);\n   *       return inputs;\n   *     }`\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   shader(myShader);\n   *   noStroke();\n   *   sphere(50);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseNormalShader().modify({\n   *     'Vertex getCameraInputs': `(Vertex inputs) {\n   *       inputs.normal = abs(inputs.normal);\n   *       return inputs;\n   *     }`,\n   *     'vec4 getFinalColor': `(vec4 color) {\n   *       // Map the r, g, and b values of the old normal to new colors\n   *       // instead of just red, green, and blue:\n   *       vec3 newColor =\n   *         color.r * vec3(89.0, 240.0, 232.0) / 255.0 +\n   *         color.g * vec3(240.0, 237.0, 89.0) / 255.0 +\n   *         color.b * vec3(205.0, 55.0, 222.0) / 255.0;\n   *       newColor = newColor / (color.r + color.g + color.b);\n   *       return vec4(newColor, 1.0) * color.a;\n   *     }`\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   shader(myShader);\n   *   noStroke();\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.015);\n   *   box(100);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.baseNormalShader = function() {\n    this._assert3d('baseNormalShader');\n    return this._renderer.baseNormalShader();\n  };\n\n  /**\n   * Get the shader used when no lights or materials are applied.\n   *\n   * You can call <a href=\"#/p5.Shader/modify\">`baseColorShader().modify()`</a>\n   * and change any of the following hooks:\n   *\n   * <table>\n   * <tr><th>Hook</th><th>Description</th></tr>\n   * <tr><td>\n   *\n   * `void beforeVertex`\n   *\n   * </td><td>\n   *\n   * Called at the start of the vertex shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `Vertex getObjectInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the model being drawn before any positioning has been applied. It takes in a `Vertex` struct, which includes:\n   * - `vec3 position`, the position of the vertex\n   * - `vec3 normal`, the direction facing out of the surface\n   * - `vec2 texCoord`, the texture coordinates associeted with the vertex\n   * - `vec4 color`, the per-vertex color\n   * The struct can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `Vertex getWorldInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the model being drawn after transformations such as `translate()` and `scale()` have been applied, but before the camera has been applied. It takes in a `Vertex` struct like, in the `getObjectInputs` hook above, that can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `Vertex getCameraInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the model being drawn as they appear relative to the camera. It takes in a `Vertex` struct like, in the `getObjectInputs` hook above, that can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void afterVertex`\n   *\n   * </td><td>\n   *\n   * Called at the end of the vertex shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void beforeFragment`\n   *\n   * </td><td>\n   *\n   * Called at the start of the fragment shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `vec4 getFinalColor`\n   *\n   * </td><td>\n   *\n   * Update the final color after mixing. It takes in a `vec4 color` and must return a modified version.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void afterFragment`\n   *\n   * </td><td>\n   *\n   * Called at the end of the fragment shader.\n   *\n   * </td></tr>\n   * </table>\n   *\n   * Most of the time, you will need to write your hooks in GLSL ES version 300. If you\n   * are using WebGL 1 instead of 2, write your hooks in GLSL ES 100 instead.\n   *\n   * Call `baseColorShader().inspectHooks()` to see all the possible hooks and\n   * their default implementations.\n   *\n   * @method baseColorShader\n   * @beta\n   * @returns {p5.Shader} The color shader\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseColorShader().modify({\n   *     uniforms: {\n   *       'float time': () => millis()\n   *     },\n   *     'Vertex getWorldInputs': `(Vertex inputs) {\n   *       inputs.position.y +=\n   *         20. * sin(time * 0.001 + inputs.position.x * 0.05);\n   *       return inputs;\n   *     }`\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   shader(myShader);\n   *   noStroke();\n   *   fill('red');\n   *   circle(0, 0, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.baseColorShader = function() {\n    this._assert3d('baseColorShader');\n    return this._renderer.baseColorShader();\n  };\n\n  /**\n   * Get the shader used when drawing the strokes of shapes.\n   *\n   * You can call <a href=\"#/p5.Shader/modify\">`baseStrokeShader().modify()`</a>\n   * and change any of the following hooks:\n   *\n   * <table>\n   * <tr><th>Hook</th><th>Description</th></tr>\n   * <tr><td>\n   *\n   * `void beforeVertex`\n   *\n   * </td><td>\n   *\n   * Called at the start of the vertex shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `StrokeVertex getObjectInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the stroke being drawn before any positioning has been applied. It takes in a `StrokeVertex` struct, which includes:\n   * - `vec3 position`, the position of the vertex\n   * - `vec3 tangentIn`, the tangent coming in to the vertex\n   * - `vec3 tangentOut`, the tangent coming out of the vertex. In straight segments, this will be the same as `tangentIn`. In joins, it will be different. In caps, one of the tangents will be 0.\n   * - `vec4 color`, the per-vertex color\n   * - `float weight`, the stroke weight\n   * The struct can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `StrokeVertex getWorldInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the model being drawn after transformations such as `translate()` and `scale()` have been applied, but before the camera has been applied. It takes in a `StrokeVertex` struct like, in the `getObjectInputs` hook above, that can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `StrokeVertex getCameraInputs`\n   *\n   * </td><td>\n   *\n   * Update the vertex data of the model being drawn as they appear relative to the camera. It takes in a `StrokeVertex` struct like, in the `getObjectInputs` hook above, that can be modified and returned.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void afterVertex`\n   *\n   * </td><td>\n   *\n   * Called at the end of the vertex shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void beforeFragment`\n   *\n   * </td><td>\n   *\n   * Called at the start of the fragment shader.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `Inputs getPixelInputs`\n   *\n   * </td><td>\n   *\n   * Update the inputs to the shader. It takes in a struct `Inputs inputs`, which includes:\n   * - `vec4 color`, the color of the stroke\n   * - `vec2 tangent`, the direction of the stroke in screen space\n   * - `vec2 center`, the coordinate of the center of the stroke in screen space p5.js pixels\n   * - `vec2 position`, the coordinate of the current pixel in screen space p5.js pixels\n   * - `float strokeWeight`, the thickness of the stroke in p5.js pixels\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `bool shouldDiscard`\n   *\n   * </td><td>\n   *\n   * Caps and joins are made by discarded pixels in the fragment shader to carve away unwanted areas. Use this to change this logic. It takes in a `bool willDiscard` and must return a modified version.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `vec4 getFinalColor`\n   *\n   * </td><td>\n   *\n   * Update the final color after mixing. It takes in a `vec4 color` and must return a modified version.\n   *\n   * </td></tr>\n   * <tr><td>\n   *\n   * `void afterFragment`\n   *\n   * </td><td>\n   *\n   * Called at the end of the fragment shader.\n   *\n   * </td></tr>\n   * </table>\n   *\n   * Most of the time, you will need to write your hooks in GLSL ES version 300. If you\n   * are using WebGL 1 instead of 2, write your hooks in GLSL ES 100 instead.\n   *\n   * Call `baseStrokeShader().inspectHooks()` to see all the possible hooks and\n   * their default implementations.\n   *\n   * @method baseStrokeShader\n   * @beta\n   * @returns {p5.Shader} The stroke shader\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseStrokeShader().modify({\n   *     'Inputs getPixelInputs': `(Inputs inputs) {\n   *       float opacity = 1.0 - smoothstep(\n   *         0.0,\n   *         15.0,\n   *         length(inputs.position - inputs.center)\n   *       );\n   *       inputs.color *= opacity;\n   *       return inputs;\n   *     }`\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   strokeShader(myShader);\n   *   strokeWeight(30);\n   *   line(\n   *     -width/3,\n   *     sin(millis()*0.001) * height/4,\n   *     width/3,\n   *     sin(millis()*0.001 + 1) * height/4\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseStrokeShader().modify({\n   *     uniforms: {\n   *       'float time': () => millis()\n   *     },\n   *     'StrokeVertex getWorldInputs': `(StrokeVertex inputs) {\n   *       // Add a somewhat random offset to the weight\n   *       // that varies based on position and time\n   *       float scale = 0.8 + 0.2*sin(10.0 * sin(\n   *         floor(time/250.) +\n   *         inputs.position.x*0.01 +\n   *         inputs.position.y*0.01\n   *       ));\n   *       inputs.weight *= scale;\n   *       return inputs;\n   *     }`\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   strokeShader(myShader);\n   *   myShader.setUniform('time', millis());\n   *   strokeWeight(10);\n   *   beginShape();\n   *   for (let i = 0; i <= 50; i++) {\n   *     let r = map(i, 0, 50, 0, width/3);\n   *     let x = r*cos(i*0.2);\n   *     let y = r*sin(i*0.2);\n   *     vertex(x, y);\n   *   }\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);\n   *   myShader = baseStrokeShader().modify({\n   *     'float random': `(vec2 p) {\n   *       vec3 p3  = fract(vec3(p.xyx) * .1031);\n   *       p3 += dot(p3, p3.yzx + 33.33);\n   *       return fract((p3.x + p3.y) * p3.z);\n   *     }`,\n   *     'Inputs getPixelInputs': `(Inputs inputs) {\n   *       // Replace alpha in the color with dithering by\n   *       // randomly setting pixel colors to 0 based on opacity\n   *       float a = inputs.color.a;\n   *       inputs.color.a = 1.0;\n   *       inputs.color *= random(inputs.position.xy) > a ? 0.0 : 1.0;\n   *       return inputs;\n   *     }`\n   *   });\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   strokeShader(myShader);\n   *   strokeWeight(10);\n   *   beginShape();\n   *   for (let i = 0; i <= 50; i++) {\n   *     stroke(\n   *       0,\n   *       255\n   *         * map(i, 0, 20, 0, 1, true)\n   *         * map(i, 30, 50, 1, 0, true)\n   *     );\n   *     vertex(\n   *       map(i, 0, 50, -1, 1) * width/3,\n   *       50 * sin(i/10 + frameCount/100)\n   *     );\n   *   }\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.baseStrokeShader = function() {\n    this._assert3d('baseStrokeShader');\n    return this._renderer.baseStrokeShader();\n  };\n\n  /**\n   * Restores the default shaders.\n   *\n   * `resetShader()` deactivates any shaders previously applied by\n   * <a href=\"#/p5/shader\">shader()</a>, <a href=\"#/p5/strokeShader\">strokeShader()</a>,\n   * or <a href=\"#/p5/imageShader\">imageShader()</a>.\n   *\n   * Note: Shaders can only be used in WebGL mode.\n   *\n   * @method resetShader\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   * uniform mat4 uProjectionMatrix;\n   * uniform mat4 uModelViewMatrix;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vTexCoord = aTexCoord;\n   *   vec4 position = vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * uModelViewMatrix * position;\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `\n   * precision mediump float;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vec2 uv = vTexCoord;\n   *   vec3 color = vec3(uv.x, uv.y, min(uv.x + uv.y, 1.0));\n   *   gl_FragColor = vec4(color, 1.0);\n   * }\n   * `;\n   *\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Shader object.\n   *   myShader = createShader(vertSrc, fragSrc);\n   *\n   *   describe(\n   *     'Two rotating cubes on a gray background. The left one has a blue-purple gradient on each face. The right one is red.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a box using the p5.Shader.\n   *   // shader() sets the active shader to myShader.\n   *   shader(myShader);\n   *   push();\n   *   translate(-25, 0, 0);\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   box(width / 4);\n   *   pop();\n   *\n   *   // Draw a box using the default fill shader.\n   *   // resetShader() restores the default fill shader.\n   *   resetShader();\n   *   fill(255, 0, 0);\n   *   push();\n   *   translate(25, 0, 0);\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   box(width / 4);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.resetShader = function () {\n    this._renderer.resetShader();\n    return this;\n  };\n\n  /**\n   * Sets the texture that will be used on shapes.\n   *\n   * A texture is like a skin that wraps around a shape. `texture()` works with\n   * built-in shapes, such as <a href=\"#/p5/square\">square()</a> and\n   * <a href=\"#/p5/sphere\">sphere()</a>, and custom shapes created with\n   * functions such as <a href=\"#/p5/buildGeometry\">buildGeometry()</a>. To\n   * texture a geometry created with <a href=\"#/p5/beginShape\">beginShape()</a>,\n   * uv coordinates must be passed to each\n   * <a href=\"#/p5/vertex\">vertex()</a> call.\n   *\n   * The parameter, `tex`, is the texture to apply. `texture()` can use a range\n   * of sources including images, videos, and offscreen renderers such as\n   * <a href=\"#/p5.Graphics\">p5.Graphics</a> and\n   * <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> objects.\n   *\n   * To texture a geometry created with <a href=\"#/p5/beginShape\">beginShape()</a>,\n   * you will need to specify uv coordinates in <a href=\"#/p5/vertex\">vertex()</a>.\n   *\n   * Note: `texture()` can only be used in WebGL mode.\n   *\n   * @method texture\n   * @param {p5.Image|p5.MediaElement|p5.Graphics|p5.Texture|p5.Framebuffer|p5.FramebufferTexture} tex media to use as the texture.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load an image and create a p5.Image object.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A spinning cube with an image of a ceiling on each face.');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Rotate around the x-, y-, and z-axes.\n   *   rotateZ(frameCount * 0.01);\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Apply the image as a texture.\n   *   texture(img);\n   *\n   *   // Draw the box.\n   *   box(50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Graphics object.\n   *   pg = createGraphics(100, 100);\n   *\n   *   // Draw a circle to the p5.Graphics object.\n   *   pg.background(200);\n   *   pg.circle(50, 50, 30);\n   *\n   *   describe('A spinning cube with circle at the center of each face.');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Rotate around the x-, y-, and z-axes.\n   *   rotateZ(frameCount * 0.01);\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Apply the p5.Graphics object as a texture.\n   *   texture(pg);\n   *\n   *   // Draw the box.\n   *   box(50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let vid;\n   *\n   * function setup() {\n   *   // Load a video and create a p5.MediaElement object.\n   *   vid = createVideo('assets/fingers.mov');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Hide the video.\n   *   vid.hide();\n   *\n   *   // Set the video to loop.\n   *   vid.loop();\n   *\n   *   describe('A rectangle with video as texture');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Apply the video as a texture.\n   *   texture(vid);\n   *\n   *   // Draw the rectangle.\n   *   rect(-40, -40, 80, 80);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let vid;\n   *\n   * function setup() {\n   *   // Load a video and create a p5.MediaElement object.\n   *   vid = createVideo('assets/fingers.mov');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Hide the video.\n   *   vid.hide();\n   *\n   *   // Set the video to loop.\n   *   vid.loop();\n   *\n   *   describe('A rectangle with video as texture');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Rotate around the y-axis.\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Set the texture mode.\n   *   textureMode(NORMAL);\n   *\n   *   // Apply the video as a texture.\n   *   texture(vid);\n   *\n   *   // Draw a custom shape using uv coordinates.\n   *   beginShape();\n   *   vertex(-40, -40, 0, 0);\n   *   vertex(40, -40, 1, 0);\n   *   vertex(40, 40, 1, 1);\n   *   vertex(-40, 40, 0, 1);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.texture = function (tex) {\n    this._assert3d('texture');\n    // p5._validateParameters('texture', arguments);\n\n    // NOTE: make generic or remove need for\n    if (tex.gifProperties) {\n      tex._animateGif(this);\n    }\n\n    this._renderer.texture(tex);\n\n    return this;\n  };\n\n  /**\n   * Changes the coordinate system used for textures when theyre applied to\n   * custom shapes.\n   *\n   * In order for <a href=\"#/p5/texture\">texture()</a> to work, a shape needs a\n   * way to map the points on its surface to the pixels in an image. Built-in\n   * shapes such as <a href=\"#/p5/rect\">rect()</a> and\n   * <a href=\"#/p5/box\">box()</a> already have these texture mappings based on\n   * their vertices. Custom shapes created with\n   * <a href=\"#/p5/vertex\">vertex()</a> require texture mappings to be passed as\n   * uv coordinates.\n   *\n   * Each call to <a href=\"#/p5/vertex\">vertex()</a> must include 5 arguments,\n   * as in `vertex(x, y, z, u, v)`, to map the vertex at coordinates `(x, y, z)`\n   * to the pixel at coordinates `(u, v)` within an image. For example, the\n   * corners of a rectangular image are mapped to the corners of a rectangle by default:\n   *\n   * ```js\n   * // Apply the image as a texture.\n   * texture(img);\n   *\n   * // Draw the rectangle.\n   * rect(0, 0, 30, 50);\n   * ```\n   *\n   * If the image in the code snippet above has dimensions of 300 x 500 pixels,\n   * the same result could be achieved as follows:\n   *\n   * ```js\n   * // Apply the image as a texture.\n   * texture(img);\n   *\n   * // Draw the rectangle.\n   * beginShape();\n   *\n   * // Top-left.\n   * // u: 0, v: 0\n   * vertex(0, 0, 0, 0, 0);\n   *\n   * // Top-right.\n   * // u: 300, v: 0\n   * vertex(30, 0, 0, 300, 0);\n   *\n   * // Bottom-right.\n   * // u: 300, v: 500\n   * vertex(30, 50, 0, 300, 500);\n   *\n   * // Bottom-left.\n   * // u: 0, v: 500\n   * vertex(0, 50, 0, 0, 500);\n   *\n   * endShape();\n   * ```\n   *\n   * `textureMode()` changes the coordinate system for uv coordinates.\n   *\n   * The parameter, `mode`, accepts two possible constants. If `NORMAL` is\n   * passed, as in `textureMode(NORMAL)`, then the textures uv coordinates can\n   * be provided in the range 0 to 1 instead of the images dimensions. This can\n   * be helpful for using the same code for multiple images of different sizes.\n   * For example, the code snippet above could be rewritten as follows:\n   *\n   * ```js\n   * // Set the texture mode to use normalized coordinates.\n   * textureMode(NORMAL);\n   *\n   * // Apply the image as a texture.\n   * texture(img);\n   *\n   * // Draw the rectangle.\n   * beginShape();\n   *\n   * // Top-left.\n   * // u: 0, v: 0\n   * vertex(0, 0, 0, 0, 0);\n   *\n   * // Top-right.\n   * // u: 1, v: 0\n   * vertex(30, 0, 0, 1, 0);\n   *\n   * // Bottom-right.\n   * // u: 1, v: 1\n   * vertex(30, 50, 0, 1, 1);\n   *\n   * // Bottom-left.\n   * // u: 0, v: 1\n   * vertex(0, 50, 0, 0, 1);\n   *\n   * endShape();\n   * ```\n   *\n   * By default, `mode` is `IMAGE`, which scales uv coordinates to the\n   * dimensions of the image. Calling `textureMode(IMAGE)` applies the default.\n   *\n   * Note: `textureMode()` can only be used in WebGL mode.\n   *\n   * @method  textureMode\n   * @param {(IMAGE|NORMAL)} mode either IMAGE or NORMAL.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load an image and create a p5.Image object.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('An image of a ceiling against a black background.');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Apply the image as a texture.\n   *   texture(img);\n   *\n   *   // Draw the custom shape.\n   *   // Use the image's width and height as uv coordinates.\n   *   beginShape();\n   *   vertex(-30, -30, 0, 0);\n   *   vertex(30, -30, img.width, 0);\n   *   vertex(30, 30, img.width, img.height);\n   *   vertex(-30, 30, 0, img.height);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   // Load an image and create a p5.Image object.\n   *   img = await loadImage('assets/laDefense.jpg');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('An image of a ceiling against a black background.');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Set the texture mode.\n   *   textureMode(NORMAL);\n   *\n   *   // Apply the image as a texture.\n   *   texture(img);\n   *\n   *   // Draw the custom shape.\n   *   // Use normalized uv coordinates.\n   *   beginShape();\n   *   vertex(-30, -30, 0, 0);\n   *   vertex(30, -30, 1, 0);\n   *   vertex(30, 30, 1, 1);\n   *   vertex(-30, 30, 0, 1);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.textureMode = function (mode) {\n    if (mode !== IMAGE && mode !== NORMAL) {\n      console.warn(\n        `You tried to set ${mode} textureMode only supports IMAGE & NORMAL `\n      );\n    } else {\n      this._renderer.states.setValue('textureMode', mode);\n    }\n  };\n\n  /**\n   * Changes the way textures behave when a shapes uv coordinates go beyond the\n   * texture.\n   *\n   * In order for <a href=\"#/p5/texture\">texture()</a> to work, a shape needs a\n   * way to map the points on its surface to the pixels in an image. Built-in\n   * shapes such as <a href=\"#/p5/rect\">rect()</a> and\n   * <a href=\"#/p5/box\">box()</a> already have these texture mappings based on\n   * their vertices. Custom shapes created with\n   * <a href=\"#/p5/vertex\">vertex()</a> require texture mappings to be passed as\n   * uv coordinates.\n   *\n   * Each call to <a href=\"#/p5/vertex\">vertex()</a> must include 5 arguments,\n   * as in `vertex(x, y, z, u, v)`, to map the vertex at coordinates `(x, y, z)`\n   * to the pixel at coordinates `(u, v)` within an image. For example, the\n   * corners of a rectangular image are mapped to the corners of a rectangle by default:\n   *\n   * ```js\n   * // Apply the image as a texture.\n   * texture(img);\n   *\n   * // Draw the rectangle.\n   * rect(0, 0, 30, 50);\n   * ```\n   *\n   * If the image in the code snippet above has dimensions of 300 x 500 pixels,\n   * the same result could be achieved as follows:\n   *\n   * ```js\n   * // Apply the image as a texture.\n   * texture(img);\n   *\n   * // Draw the rectangle.\n   * beginShape();\n   *\n   * // Top-left.\n   * // u: 0, v: 0\n   * vertex(0, 0, 0, 0, 0);\n   *\n   * // Top-right.\n   * // u: 300, v: 0\n   * vertex(30, 0, 0, 300, 0);\n   *\n   * // Bottom-right.\n   * // u: 300, v: 500\n   * vertex(30, 50, 0, 300, 500);\n   *\n   * // Bottom-left.\n   * // u: 0, v: 500\n   * vertex(0, 50, 0, 0, 500);\n   *\n   * endShape();\n   * ```\n   *\n   * `textureWrap()` controls how textures behave when their uv's go beyond the\n   * texture. Doing so can produce interesting visual effects such as tiling.\n   * For example, the custom shape above could have u-coordinates are greater\n   * than the images width:\n   *\n   * ```js\n   * // Apply the image as a texture.\n   * texture(img);\n   *\n   * // Draw the rectangle.\n   * beginShape();\n   * vertex(0, 0, 0, 0, 0);\n   *\n   * // Top-right.\n   * // u: 600\n   * vertex(30, 0, 0, 600, 0);\n   *\n   * // Bottom-right.\n   * // u: 600\n   * vertex(30, 50, 0, 600, 500);\n   *\n   * vertex(0, 50, 0, 0, 500);\n   * endShape();\n   * ```\n   *\n   * The u-coordinates of 600 are greater than the texture images width of 300.\n   * This creates interesting possibilities.\n   *\n   * The first parameter, `wrapX`, accepts three possible constants. If `CLAMP`\n   * is passed, as in `textureWrap(CLAMP)`, the pixels at the edge of the\n   * texture will extend to the shapes edges. If `REPEAT` is passed, as in\n   * `textureWrap(REPEAT)`, the texture will tile repeatedly until reaching the\n   * shapes edges. If `MIRROR` is passed, as in `textureWrap(MIRROR)`, the\n   * texture will tile repeatedly until reaching the shapes edges, flipping\n   * its orientation between tiles. By default, textures `CLAMP`.\n   *\n   * The second parameter, `wrapY`, is optional. It accepts the same three\n   * constants, `CLAMP`, `REPEAT`, and `MIRROR`. If one of these constants is\n   * passed, as in `textureWRAP(MIRROR, REPEAT)`, then the texture will `MIRROR`\n   * horizontally and `REPEAT` vertically. By default, `wrapY` will be set to\n   * the same value as `wrapX`.\n   *\n   * Note: `textureWrap()` can only be used in WebGL mode.\n   *\n   * @method textureWrap\n   * @param {(CLAMP|REPEAT|MIRROR)} wrapX either CLAMP, REPEAT, or MIRROR\n   * @param {(CLAMP|REPEAT|MIRROR)} [wrapY=wrapX] either CLAMP, REPEAT, or MIRROR\n   *\n   * @example\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   img = await loadImage('assets/rockies128.jpg');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'An image of a landscape occupies the top-left corner of a square. Its edge colors smear to cover the other thre quarters of the square.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Set the texture mode.\n   *   textureMode(NORMAL);\n   *\n   *   // Set the texture wrapping.\n   *   // Note: CLAMP is the default mode.\n   *   textureWrap(CLAMP);\n   *\n   *   // Apply the image as a texture.\n   *   texture(img);\n   *\n   *   // Style the shape.\n   *   noStroke();\n   *\n   *   // Draw the shape.\n   *   // Use uv coordinates > 1.\n   *   beginShape();\n   *   vertex(-30, -30, 0, 0, 0);\n   *   vertex(30, -30, 0, 2, 0);\n   *   vertex(30, 30, 0, 2, 2);\n   *   vertex(-30, 30, 0, 0, 2);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   img = await loadImage('assets/rockies128.jpg');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('Four identical images of a landscape arranged in a grid.');\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Set the texture mode.\n   *   textureMode(NORMAL);\n   *\n   *   // Set the texture wrapping.\n   *   textureWrap(REPEAT);\n   *\n   *   // Apply the image as a texture.\n   *   texture(img);\n   *\n   *   // Style the shape.\n   *   noStroke();\n   *\n   *   // Draw the shape.\n   *   // Use uv coordinates > 1.\n   *   beginShape();\n   *   vertex(-30, -30, 0, 0, 0);\n   *   vertex(30, -30, 0, 2, 0);\n   *   vertex(30, 30, 0, 2, 2);\n   *   vertex(-30, 30, 0, 0, 2);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   img = await loadImage('assets/rockies128.jpg');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'Four identical images of a landscape arranged in a grid. The images are reflected horizontally and vertically, creating a kaleidoscope effect.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Set the texture mode.\n   *   textureMode(NORMAL);\n   *\n   *   // Set the texture wrapping.\n   *   textureWrap(MIRROR);\n   *\n   *   // Apply the image as a texture.\n   *   texture(img);\n   *\n   *   // Style the shape.\n   *   noStroke();\n   *\n   *   // Draw the shape.\n   *   // Use uv coordinates > 1.\n   *   beginShape();\n   *   vertex(-30, -30, 0, 0, 0);\n   *   vertex(30, -30, 0, 2, 0);\n   *   vertex(30, 30, 0, 2, 2);\n   *   vertex(-30, 30, 0, 0, 2);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let img;\n   *\n   * async function setup() {\n   *   img = await loadImage('assets/rockies128.jpg');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'Four identical images of a landscape arranged in a grid. The top row and bottom row are reflections of each other.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(0);\n   *\n   *   // Set the texture mode.\n   *   textureMode(NORMAL);\n   *\n   *   // Set the texture wrapping.\n   *   textureWrap(REPEAT, MIRROR);\n   *\n   *   // Apply the image as a texture.\n   *   texture(img);\n   *\n   *   // Style the shape.\n   *   noStroke();\n   *\n   *   // Draw the shape.\n   *   // Use uv coordinates > 1.\n   *   beginShape();\n   *   vertex(-30, -30, 0, 0, 0);\n   *   vertex(30, -30, 0, 2, 0);\n   *   vertex(30, 30, 0, 2, 2);\n   *   vertex(-30, 30, 0, 0, 2);\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.textureWrap = function (wrapX, wrapY = wrapX) {\n    this._renderer.states.setValue('textureWrapX', wrapX);\n    this._renderer.states.setValue('textureWrapY', wrapY);\n\n    for (const texture of this._renderer.textures.values()) {\n      texture.setWrapMode(wrapX, wrapY);\n    }\n  };\n\n  /**\n   * Sets the current material as a normal material.\n   *\n   * A normal material sets surfaces facing the x-axis to red, those facing the\n   * y-axis to green, and those facing the z-axis to blue. Normal material isn't\n   * affected by light. Its often used as a placeholder material when debugging.\n   *\n   * Note: `normalMaterial()` can only be used in WebGL mode.\n   *\n   * @method normalMaterial\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A multicolor torus drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the torus.\n   *   normalMaterial();\n   *\n   *   // Draw the torus.\n   *   torus(30);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.normalMaterial = function (...args) {\n    this._assert3d('normalMaterial');\n    // p5._validateParameters('normalMaterial', args);\n\n    this._renderer.normalMaterial(...args);\n\n    return this;\n  };\n\n  /**\n   * Sets the ambient color of shapes surface material.\n   *\n   * The `ambientMaterial()` color sets the components of the\n   * <a href=\"#/p5/ambientLight\">ambientLight()</a> color that shapes will\n   * reflect. For example, calling `ambientMaterial(255, 255, 0)` would cause a\n   * shape to reflect red and green light, but not blue light.\n   *\n   * `ambientMaterial()` can be called three ways with different parameters to\n   * set the materials color.\n   *\n   * The first way to call `ambientMaterial()` has one parameter, `gray`.\n   * Grayscale values between 0 and 255, as in `ambientMaterial(50)`, can be\n   * passed to set the materials color. Higher grayscale values make shapes\n   * appear brighter.\n   *\n   * The second way to call `ambientMaterial()` has one parameter, `color`. A\n   * <a href=\"#/p5.Color\">p5.Color</a> object, an array of color values, or a\n   * CSS color string, as in `ambientMaterial('magenta')`, can be passed to set\n   * the materials color.\n   *\n   * The third way to call `ambientMaterial()` has three parameters, `v1`, `v2`,\n   * and `v3`. RGB, HSB, or HSL values, as in `ambientMaterial(255, 0, 0)`, can\n   * be passed to set the materials colors. Color values will be interpreted\n   * using the current <a href=\"#/p5/colorMode\">colorMode()</a>.\n   *\n   * Note: `ambientMaterial()` can only be used in WebGL mode.\n   *\n   * @method ambientMaterial\n   * @param  {Number} v1  red or hue value in the current\n   *                       <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number} v2  green or saturation value in the\n   *                      current <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number} v3  blue, brightness, or lightness value in the\n   *                      current <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A magenta cube drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on a magenta ambient light.\n   *   ambientLight(255, 0, 255);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A purple cube drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on a magenta ambient light.\n   *   ambientLight(255, 0, 255);\n   *\n   *   // Add a dark gray ambient material.\n   *   ambientMaterial(150);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A red cube drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on a magenta ambient light.\n   *   ambientLight(255, 0, 255);\n   *\n   *   // Add a yellow ambient material using RGB values.\n   *   ambientMaterial(255, 255, 0);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A red cube drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on a magenta ambient light.\n   *   ambientLight(255, 0, 255);\n   *\n   *   // Add a yellow ambient material using a p5.Color object.\n   *   let c = color(255, 255, 0);\n   *   ambientMaterial(c);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A red cube drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on a magenta ambient light.\n   *   ambientLight(255, 0, 255);\n   *\n   *   // Add a yellow ambient material using a color string.\n   *   ambientMaterial('yellow');\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A yellow cube drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on a white ambient light.\n   *   ambientLight(255, 255, 255);\n   *\n   *   // Add a yellow ambient material using a color string.\n   *   ambientMaterial('yellow');\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method ambientMaterial\n   * @param  {Number} gray grayscale value between 0 (black) and 255 (white).\n   * @chainable\n   */\n\n  /**\n   * @method ambientMaterial\n   * @param  {p5.Color|Number[]|String} color\n   *           color as a <a href=\"#/p5.Color\">p5.Color</a> object,\n   *            an array of color values, or a CSS string.\n   * @chainable\n   */\n  fn.ambientMaterial = function (v1, v2, v3) {\n    this._assert3d('ambientMaterial');\n    // p5._validateParameters('ambientMaterial', arguments);\n\n    const color = fn.color.apply(this, arguments);\n    this._renderer.states.setValue('_hasSetAmbient', true);\n    this._renderer.states.setValue('curAmbientColor', color._array);\n    this._renderer.states.setValue('_useNormalMaterial', false);\n    this._renderer.states.setValue('enableLighting', true);\n    if (!this._renderer.states.fillColor) {\n      this._renderer.states.setValue('fillColor', new Color([1, 1, 1]));\n    }\n    return this;\n  };\n\n  /**\n   * Sets the emissive color of shapes surface material.\n   *\n   * The `emissiveMaterial()` color sets a color shapes display at full\n   * strength, regardless of lighting. This can give the appearance that a shape\n   * is glowing. However, emissive materials dont actually emit light that\n   * can affect surrounding objects.\n   *\n   * `emissiveMaterial()` can be called three ways with different parameters to\n   * set the materials color.\n   *\n   * The first way to call `emissiveMaterial()` has one parameter, `gray`.\n   * Grayscale values between 0 and 255, as in `emissiveMaterial(50)`, can be\n   * passed to set the materials color. Higher grayscale values make shapes\n   * appear brighter.\n   *\n   * The second way to call `emissiveMaterial()` has one parameter, `color`. A\n   * <a href=\"#/p5.Color\">p5.Color</a> object, an array of color values, or a\n   * CSS color string, as in `emissiveMaterial('magenta')`, can be passed to set\n   * the materials color.\n   *\n   * The third way to call `emissiveMaterial()` has four parameters, `v1`, `v2`,\n   * `v3`, and `alpha`. `alpha` is optional. RGBA, HSBA, or HSLA values can be\n   * passed to set the materials colors, as in `emissiveMaterial(255, 0, 0)` or\n   * `emissiveMaterial(255, 0, 0, 30)`. Color values will be interpreted using\n   * the current <a href=\"#/p5/colorMode\">colorMode()</a>.\n   *\n   * Note: `emissiveMaterial()` can only be used in WebGL mode.\n   *\n   * @method emissiveMaterial\n   * @param  {Number} v1       red or hue value in the current\n   *                           <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number} v2       green or saturation value in the\n   *                           current <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number} v3       blue, brightness, or lightness value in the\n   *                           current <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number} [alpha]  alpha value in the current\n   *                           <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A red cube drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on a white ambient light.\n   *   ambientLight(255, 255, 255);\n   *\n   *   // Add a red emissive material using RGB values.\n   *   emissiveMaterial(255, 0, 0);\n   *\n   *   // Draw the box.\n   *   box();\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method emissiveMaterial\n   * @param  {Number} gray grayscale value between 0 (black) and 255 (white).\n   * @chainable\n   */\n\n  /**\n   * @method emissiveMaterial\n   * @param  {p5.Color|Number[]|String} color\n   *           color as a <a href=\"#/p5.Color\">p5.Color</a> object,\n   *            an array of color values, or a CSS string.\n   * @chainable\n   */\n  fn.emissiveMaterial = function (v1, v2, v3, a) {\n    this._assert3d('emissiveMaterial');\n    // p5._validateParameters('emissiveMaterial', arguments);\n\n    const color = fn.color.apply(this, arguments);\n    this._renderer.states.setValue('curEmissiveColor', color._array);\n    this._renderer.states.setValue('_useEmissiveMaterial', true);\n    this._renderer.states.setValue('_useNormalMaterial', false);\n    this._renderer.states.setValue('enableLighting', true);\n\n    return this;\n  };\n\n  /**\n   * Sets the specular color of shapes surface material.\n   *\n   * The `specularMaterial()` color sets the components of light color that\n   * glossy coats on shapes will reflect. For example, calling\n   * `specularMaterial(255, 255, 0)` would cause a shape to reflect red and\n   * green light, but not blue light.\n   *\n   * Unlike <a href=\"#/p5/ambientMaterial\">ambientMaterial()</a>,\n   * `specularMaterial()` will reflect the full color of light sources including\n   * <a href=\"#/p5/directionalLight\">directionalLight()</a>,\n   * <a href=\"#/p5/pointLight\">pointLight()</a>,\n   * and <a href=\"#/p5/spotLight\">spotLight()</a>. This is what gives it shapes\n   * their \"shiny\" appearance. The materials shininess can be controlled by the\n   * <a href=\"#/p5/shininess\">shininess()</a> function.\n   *\n   * `specularMaterial()` can be called three ways with different parameters to\n   * set the materials color.\n   *\n   * The first way to call `specularMaterial()` has one parameter, `gray`.\n   * Grayscale values between 0 and 255, as in `specularMaterial(50)`, can be\n   * passed to set the materials color. Higher grayscale values make shapes\n   * appear brighter.\n   *\n   * The second way to call `specularMaterial()` has one parameter, `color`. A\n   * <a href=\"#/p5.Color\">p5.Color> object, an array of color values, or a CSS\n   * color string, as in `specularMaterial('magenta')`, can be passed to set the\n   * materials color.\n   *\n   * The third way to call `specularMaterial()` has four parameters, `v1`, `v2`,\n   * `v3`, and `alpha`. `alpha` is optional. RGBA, HSBA, or HSLA values can be\n   * passed to set the materials colors, as in `specularMaterial(255, 0, 0)` or\n   * `specularMaterial(255, 0, 0, 30)`. Color values will be interpreted using\n   * the current <a href=\"#/p5/colorMode\">colorMode()</a>.\n   *\n   * @method specularMaterial\n   * @param  {Number} gray grayscale value between 0 (black) and 255 (white).\n   * @param  {Number} [alpha] alpha value in the current current\n   *                          <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click the canvas to apply a specular material.\n   *\n   * let isGlossy = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A red torus drawn on a gray background. It becomes glossy when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on a white point light at the top-right.\n   *   pointLight(255, 255, 255, 30, -40, 30);\n   *\n   *   // Add a glossy coat if the user has double-clicked.\n   *   if (isGlossy === true) {\n   *     specularMaterial(255);\n   *     shininess(50);\n   *   }\n   *\n   *   // Style the torus.\n   *   noStroke();\n   *   fill(255, 0, 0);\n   *\n   *   // Draw the torus.\n   *   torus(30);\n   * }\n   *\n   * // Make the torus glossy when the user double-clicks.\n   * function doubleClicked() {\n   *   isGlossy = true;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click the canvas to apply a specular material.\n   *\n   * let isGlossy = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'A red torus drawn on a gray background. It becomes glossy and reflects green light when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on a white point light at the top-right.\n   *   pointLight(255, 255, 255, 30, -40, 30);\n   *\n   *   // Add a glossy green coat if the user has double-clicked.\n   *   if (isGlossy === true) {\n   *     specularMaterial(0, 255, 0);\n   *     shininess(50);\n   *   }\n   *\n   *   // Style the torus.\n   *   noStroke();\n   *   fill(255, 0, 0);\n   *\n   *   // Draw the torus.\n   *   torus(30);\n   * }\n   *\n   * // Make the torus glossy when the user double-clicks.\n   * function doubleClicked() {\n   *   isGlossy = true;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click the canvas to apply a specular material.\n   *\n   * let isGlossy = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'A red torus drawn on a gray background. It becomes glossy and reflects green light when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on a white point light at the top-right.\n   *   pointLight(255, 255, 255, 30, -40, 30);\n   *\n   *   // Add a glossy green coat if the user has double-clicked.\n   *   if (isGlossy === true) {\n   *     // Create a p5.Color object.\n   *     let c = color('green');\n   *     specularMaterial(c);\n   *     shininess(50);\n   *   }\n   *\n   *   // Style the torus.\n   *   noStroke();\n   *   fill(255, 0, 0);\n   *\n   *   // Draw the torus.\n   *   torus(30);\n   * }\n   *\n   * // Make the torus glossy when the user double-clicks.\n   * function doubleClicked() {\n   *   isGlossy = true;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   * // Double-click the canvas to apply a specular material.\n   *\n   * let isGlossy = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'A red torus drawn on a gray background. It becomes glossy and reflects green light when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on a white point light at the top-right.\n   *   pointLight(255, 255, 255, 30, -40, 30);\n   *\n   *   // Add a glossy green coat if the user has double-clicked.\n   *   if (isGlossy === true) {\n   *     specularMaterial('#00FF00');\n   *     shininess(50);\n   *   }\n   *\n   *   // Style the torus.\n   *   noStroke();\n   *   fill(255, 0, 0);\n   *\n   *   // Draw the torus.\n   *   torus(30);\n   * }\n   *\n   * // Make the torus glossy when the user double-clicks.\n   * function doubleClicked() {\n   *   isGlossy = true;\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method specularMaterial\n   * @param  {Number}        v1      red or hue value in\n   *                                 the current <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}        v2      green or saturation value\n   *                                 in the current <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}        v3      blue, brightness, or lightness value\n   *                                 in the current <a href=\"#/p5/colorMode\">colorMode()</a>.\n   * @param  {Number}        [alpha]\n   * @chainable\n   */\n\n  /**\n   * @method specularMaterial\n   * @param  {p5.Color|Number[]|String} color\n   *           color as a <a href=\"#/p5.Color\">p5.Color</a> object,\n   *            an array of color values, or a CSS string.\n   * @chainable\n   */\n  fn.specularMaterial = function (v1, v2, v3, alpha) {\n    this._assert3d('specularMaterial');\n    // p5._validateParameters('specularMaterial', arguments);\n\n    const color = fn.color.apply(this, arguments);\n    this._renderer.states.setValue('curSpecularColor', color._array);\n    this._renderer.states.setValue('_useSpecularMaterial', true);\n    this._renderer.states.setValue('_useNormalMaterial', false);\n    this._renderer.states.setValue('enableLighting', true);\n\n    return this;\n  };\n\n  /**\n   * Sets the amount of gloss (\"shininess\") of a\n   * <a href=\"#/p5/specularMaterial\">specularMaterial()</a>.\n   *\n   * Shiny materials focus reflected light more than dull materials.\n   * `shininess()` affects the way materials reflect light sources including\n   * <a href=\"#/p5/directionalLight\">directionalLight()</a>,\n   * <a href=\"#/p5/pointLight\">pointLight()</a>,\n   * and <a href=\"#/p5/spotLight\">spotLight()</a>.\n   *\n   * The parameter, `shine`, is a number that sets the amount of shininess.\n   * `shine` must be greater than 1, which is its default value.\n   *\n   * @method shininess\n   * @param {Number} shine amount of shine.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'Two red spheres drawn on a gray background. White light reflects from their surfaces as the mouse moves. The right sphere is shinier than the left sphere.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Turn on a red ambient light.\n   *   ambientLight(255, 0, 0);\n   *\n   *   // Get the mouse's coordinates.\n   *   let mx = mouseX - 50;\n   *   let my = mouseY - 50;\n   *\n   *   // Turn on a white point light that follows the mouse.\n   *   pointLight(255, 255, 255, mx, my, 50);\n   *\n   *   // Style the sphere.\n   *   noStroke();\n   *\n   *   // Add a specular material with a grayscale value.\n   *   specularMaterial(255);\n   *\n   *   // Draw the left sphere with low shininess.\n   *   translate(-25, 0, 0);\n   *   shininess(10);\n   *   sphere(20);\n   *\n   *   // Draw the right sphere with high shininess.\n   *   translate(50, 0, 0);\n   *   shininess(100);\n   *   sphere(20);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.shininess = function (shine) {\n    this._assert3d('shininess');\n    // p5._validateParameters('shininess', arguments);\n\n    this._renderer.shininess(shine);\n\n    return this;\n  };\n\n  /**\n   * Sets the amount of \"metalness\" of a\n   * <a href=\"#/p5/specularMaterial\">specularMaterial()</a>.\n   *\n   * `metalness()` can make materials appear more metallic. It affects the way\n   * materials reflect light sources including\n   * affects the way materials reflect light sources including\n   * <a href=\"#/p5/directionalLight\">directionalLight()</a>,\n   * <a href=\"#/p5/pointLight\">pointLight()</a>,\n   * <a href=\"#/p5/spotLight\">spotLight()</a>, and\n   * <a href=\"#/p5/imageLight\">imageLight()</a>.\n   *\n   * The parameter, `metallic`, is a number that sets the amount of metalness.\n   * `metallic` must be greater than 1, which is its default value. Higher\n   * values, such as `metalness(100)`, make specular materials appear more\n   * metallic.\n   *\n   * @method metalness\n   * @param {Number} metallic amount of metalness.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     'Two blue spheres drawn on a gray background. White light reflects from their surfaces as the mouse moves. The right sphere is more metallic than the left sphere.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Turn on an ambient light.\n   *   ambientLight(200);\n   *\n   *   // Get the mouse's coordinates.\n   *   let mx = mouseX - 50;\n   *   let my = mouseY - 50;\n   *\n   *   // Turn on a white point light that follows the mouse.\n   *   pointLight(255, 255, 255, mx, my, 50);\n   *\n   *   // Style the spheres.\n   *   noStroke();\n   *   fill(30, 30, 255);\n   *   specularMaterial(255);\n   *   shininess(20);\n   *\n   *   // Draw the left sphere with low metalness.\n   *   translate(-25, 0, 0);\n   *   metalness(1);\n   *   sphere(20);\n   *\n   *   // Draw the right sphere with high metalness.\n   *   translate(50, 0, 0);\n   *   metalness(50);\n   *   sphere(20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let img;\n   *\n   * async function setup() {\n   *   img = await loadImage('assets/outdoor_spheremap.jpg');\n   *\n   *   createCanvas(100 ,100 ,WEBGL);\n   *\n   *   describe(\n   *     'Two spheres floating above a landscape. The surface of the spheres reflect the landscape. The right sphere is more reflective than the left sphere.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   // Add the panorama.\n   *   panorama(img);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Use the image as a light source.\n   *   imageLight(img);\n   *\n   *   // Style the spheres.\n   *   noStroke();\n   *   specularMaterial(50);\n   *   shininess(200);\n   *\n   *   // Draw the left sphere with low metalness.\n   *   translate(-25, 0, 0);\n   *   metalness(1);\n   *   sphere(20);\n   *\n   *   // Draw the right sphere with high metalness.\n   *   translate(50, 0, 0);\n   *   metalness(50);\n   *   sphere(20);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.metalness = function (metallic) {\n    this._assert3d('metalness');\n\n    this._renderer.metalness(metallic);\n\n    return this;\n  };\n\n\n  /**\n   * @private blends colors according to color components.\n   * If alpha value is less than 1, or non-standard blendMode\n   * we need to enable blending on our gl context.\n   * @param  {Number[]} color The currently set color, with values in 0-1 range\n   * @param  {Boolean} [hasTransparency] Whether the shape being drawn has other\n   * transparency internally, e.g. via vertex colors\n   * @return {Number[]}  Normalized numbers array\n   */\n  RendererGL.prototype._applyColorBlend = function (colors, hasTransparency) {\n    const gl = this.GL;\n\n    const isTexture = this.states.drawMode === TEXTURE;\n    const doBlend =\n      hasTransparency ||\n      this.states.userFillShader ||\n      this.states.userStrokeShader ||\n      this.states.userPointShader ||\n      isTexture ||\n      this.states.curBlendMode !== BLEND ||\n      colors[colors.length - 1] < 1.0 ||\n      this._isErasing;\n\n    if (doBlend !== this._isBlending) {\n      if (\n        doBlend ||\n        (this.states.curBlendMode !== BLEND &&\n          this.states.curBlendMode !== ADD)\n      ) {\n        gl.enable(gl.BLEND);\n      } else {\n        gl.disable(gl.BLEND);\n      }\n      gl.depthMask(true);\n      this._isBlending = doBlend;\n    }\n    this._applyBlendMode();\n    return colors;\n  };\n\n  /**\n   * @private sets blending in gl context to curBlendMode\n   * @param  {Number[]} color [description]\n   * @return {Number[]}  Normalized numbers array\n   */\n  RendererGL.prototype._applyBlendMode = function () {\n    if (this._cachedBlendMode === this.states.curBlendMode) {\n      return;\n    }\n    const gl = this.GL;\n    switch (this.states.curBlendMode) {\n      case BLEND:\n        gl.blendEquation(gl.FUNC_ADD);\n        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n        break;\n      case ADD:\n        gl.blendEquation(gl.FUNC_ADD);\n        gl.blendFunc(gl.ONE, gl.ONE);\n        break;\n      case REMOVE:\n        gl.blendEquation(gl.FUNC_ADD);\n        gl.blendFunc(gl.ZERO, gl.ONE_MINUS_SRC_ALPHA);\n        break;\n      case MULTIPLY:\n        gl.blendEquation(gl.FUNC_ADD);\n        gl.blendFunc(gl.DST_COLOR, gl.ONE_MINUS_SRC_ALPHA);\n        break;\n      case SCREEN:\n        gl.blendEquation(gl.FUNC_ADD);\n        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_COLOR);\n        break;\n      case EXCLUSION:\n        gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);\n        gl.blendFuncSeparate(\n          gl.ONE_MINUS_DST_COLOR,\n          gl.ONE_MINUS_SRC_COLOR,\n          gl.ONE,\n          gl.ONE\n        );\n        break;\n      case REPLACE:\n        gl.blendEquation(gl.FUNC_ADD);\n        gl.blendFunc(gl.ONE, gl.ZERO);\n        break;\n      case SUBTRACT:\n        gl.blendEquationSeparate(gl.FUNC_REVERSE_SUBTRACT, gl.FUNC_ADD);\n        gl.blendFuncSeparate(gl.ONE, gl.ONE, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n        break;\n      case DARKEST:\n        if (this.blendExt) {\n          gl.blendEquationSeparate(\n            this.blendExt.MIN || this.blendExt.MIN_EXT,\n            gl.FUNC_ADD\n          );\n          gl.blendFuncSeparate(gl.ONE, gl.ONE, gl.ONE, gl.ONE);\n        } else {\n          console.warn(\n            'blendMode(DARKEST) does not work in your browser in WEBGL mode.'\n          );\n        }\n        break;\n      case LIGHTEST:\n        if (this.blendExt) {\n          gl.blendEquationSeparate(\n            this.blendExt.MAX || this.blendExt.MAX_EXT,\n            gl.FUNC_ADD\n          );\n          gl.blendFuncSeparate(gl.ONE, gl.ONE, gl.ONE, gl.ONE);\n        } else {\n          console.warn(\n            'blendMode(LIGHTEST) does not work in your browser in WEBGL mode.'\n          );\n        }\n        break;\n      default:\n        console.error(\n          'Oops! Somehow RendererGL set curBlendMode to an unsupported mode.'\n        );\n        break;\n    }\n    this._cachedBlendMode = this.states.curBlendMode;\n  };\n\n  RendererGL.prototype.shader = function(s) {\n    // Always set the shader as a fill shader\n    this.states.setValue('userFillShader', s);\n    this.states.setValue('_useNormalMaterial', false);\n    s.ensureCompiledOnContext(this);\n    s.setDefaultUniforms();\n  };\n\n  RendererGL.prototype.strokeShader = function(s) {\n    this.states.setValue('userStrokeShader', s);\n    s.ensureCompiledOnContext(this);\n    s.setDefaultUniforms();\n  };\n\n  RendererGL.prototype.imageShader = function(s) {\n    this.states.setValue('userImageShader', s);\n    s.ensureCompiledOnContext(this);\n    s.setDefaultUniforms();\n  };\n\n  RendererGL.prototype.resetShader = function() {\n    this.states.setValue('userFillShader', null);\n    this.states.setValue('userStrokeShader', null);\n    this.states.setValue('userImageShader', null);\n  };\n\n  RendererGL.prototype.texture = function(tex) {\n    this.states.setValue('drawMode', TEXTURE);\n    this.states.setValue('_useNormalMaterial', false);\n    this.states.setValue('_tex', tex);\n    this.states.setValue('fillColor', new Color([1, 1, 1]));\n  };\n\n  RendererGL.prototype.normalMaterial = function(...args) {\n    this.states.setValue('drawMode', FILL);\n    this.states.setValue('_useSpecularMaterial', false);\n    this.states.setValue('_useEmissiveMaterial', false);\n    this.states.setValue('_useNormalMaterial', true);\n    this.states.setValue('curFillColor', [1, 1, 1, 1]);\n    this.states.setValue('fillColor', new Color([1, 1, 1]));\n    this.states.setValue('strokeColor', null);\n  };\n\n  // RendererGL.prototype.ambientMaterial = function(v1, v2, v3) {\n  // }\n\n  // RendererGL.prototype.emissiveMaterial = function(v1, v2, v3, a) {\n  // }\n\n  // RendererGL.prototype.specularMaterial = function(v1, v2, v3, alpha) {\n  // }\n\n  RendererGL.prototype.shininess = function(shine) {\n    if (shine < 1) {\n      shine = 1;\n    }\n    this.states.setValue('_useShininess', shine);\n  };\n\n  RendererGL.prototype.metalness = function(metallic) {\n    const metalMix = 1 - Math.exp(-metallic / 100);\n    this.states.setValue('_useMetalness', metalMix);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  loading(p5, p5.prototype);\n}\n\n/**\n * @module Rendering\n * @submodule Rendering\n * @for p5\n */\n\n\nclass Graphics {\n  constructor(w, h, renderer, pInst, canvas) {\n    const r = renderer || P2D;\n\n    this._pInst = pInst;\n    this._renderer = new renderers[r](this, w, h, false, canvas);\n\n    this._initializeInstanceVariables(this);\n\n    this._renderer._applyDefaults();\n    return this;\n  }\n\n  get deltaTime(){\n    return this._pInst.deltaTime;\n  }\n\n  get canvas(){\n    return this._renderer?.canvas;\n  }\n\n  get drawingContext(){\n    return this._renderer.drawingContext;\n  }\n\n  get width(){\n    return this._renderer?.width;\n  }\n\n  get height(){\n    return this._renderer?.height;\n  }\n\n  get pixels(){\n    return this._renderer?.pixels;\n  }\n\n  pixelDensity(val){\n    let returnValue;\n    if (typeof val === 'number') {\n      if (val !== this._renderer._pixelDensity) {\n        this._renderer._pixelDensity = val;\n      }\n      returnValue = this;\n      this.resizeCanvas(this.width, this.height, true); // as a side effect, it will clear the canvas\n    } else {\n      returnValue = this._renderer._pixelDensity;\n    }\n    return returnValue;\n  }\n\n  resizeCanvas(w, h){\n    this._renderer.resize(w, h);\n  }\n\n  /**\n   * Resets the graphics buffer's transformations and lighting.\n   *\n   * By default, the main canvas resets certain transformation and lighting\n   * values each time <a href=\"#/p5/draw\">draw()</a> executes. `p5.Graphics`\n   * objects must reset these values manually by calling `myGraphics.reset()`.\n   *\n   *\n   * @example\n   * <div>\n   * <code>\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Graphics object.\n   *   pg = createGraphics(60, 60);\n   *\n   *   describe('A white circle moves downward slowly within a dark square. The circle resets at the top of the dark square when the user presses the mouse.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the p5.Graphics object's coordinate system.\n   *   // The translation accumulates; the white circle moves.\n   *   pg.translate(0, 0.1);\n   *\n   *   // Draw to the p5.Graphics object.\n   *   pg.background(100);\n   *   pg.circle(30, 0, 10);\n   *\n   *   // Display the p5.Graphics object.\n   *   image(pg, 20, 20);\n   *\n   *   // Translate the main canvas' coordinate system.\n   *   // The translation doesn't accumulate; the dark\n   *   // square is always in the same place.\n   *   translate(0, 0.1);\n   *\n   *   // Reset the p5.Graphics object when the\n   *   // user presses the mouse.\n   *   if (mouseIsPressed === true) {\n   *     pg.reset();\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Graphics object.\n   *   pg = createGraphics(60, 60);\n   *\n   *   describe('A white circle at the center of a dark gray square. The image is drawn on a light gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Translate the p5.Graphics object's coordinate system.\n   *   pg.translate(30, 30);\n   *\n   *   // Draw to the p5.Graphics object.\n   *   pg.background(100);\n   *   pg.circle(0, 0, 10);\n   *\n   *   // Display the p5.Graphics object.\n   *   image(pg, 20, 20);\n   *\n   *   // Reset the p5.Graphics object automatically.\n   *   pg.reset();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Graphics object using WebGL mode.\n   *   pg = createGraphics(100, 100, WEBGL);\n   *\n   *   describe(\"A sphere lit from above with a red light. The sphere's surface becomes glossy while the user clicks and holds the mouse.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Add a red point light from the top-right.\n   *   pg.pointLight(255, 0, 0, 50, -100, 50);\n   *\n   *   // Style the sphere.\n   *   // It should appear glossy when the\n   *   // lighting values are reset.\n   *   pg.noStroke();\n   *   pg.specularMaterial(255);\n   *   pg.shininess(100);\n   *\n   *   // Draw the sphere.\n   *   pg.sphere(30);\n   *\n   *   // Display the p5.Graphics object.\n   *   image(pg, -50, -50);\n   *\n   *   // Reset the p5.Graphics object when\n   *   // the user presses the mouse.\n   *   if (mouseIsPressed === true) {\n   *     pg.reset();\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Graphics object using WebGL mode.\n   *   pg = createGraphics(100, 100, WEBGL);\n   *\n   *   describe('A sphere with a glossy surface is lit from the top-right by a red light.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Add a red point light from the top-right.\n   *   pg.pointLight(255, 0, 0, 50, -100, 50);\n   *\n   *   // Style the sphere.\n   *   pg.noStroke();\n   *   pg.specularMaterial(255);\n   *   pg.shininess(100);\n   *\n   *   // Draw the sphere.\n   *   pg.sphere(30);\n   *\n   *   // Display the p5.Graphics object.\n   *   image(pg, 0, 0);\n   *\n   *   // Reset the p5.Graphics object automatically.\n   *   pg.reset();\n   * }\n   * </code>\n   * </div>\n   */\n  reset() {\n    this._renderer.resetMatrix();\n    if (this._renderer.isP3D) {\n      this._renderer._update();\n    }\n  }\n\n  /**\n   * Removes the graphics buffer from the web page.\n   *\n   * Calling `myGraphics.remove()` removes the graphics buffer's\n   * `&lt;canvas&gt;` element from the web page. The graphics buffer also uses\n   * a bit of memory on the CPU that can be freed like so:\n   *\n   * ```js\n   * // Remove the graphics buffer from the web page.\n   * myGraphics.remove();\n   *\n   * // Delete the graphics buffer from CPU memory.\n   * myGraphics = undefined;\n   * ```\n   *\n   * Note: All variables that reference the graphics buffer must be assigned\n   * the value `undefined` to delete the graphics buffer from CPU memory. If any\n   * variable still refers to the graphics buffer, then it won't be garbage\n   * collected.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to remove the p5.Graphics object.\n   *\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Graphics object.\n   *   pg = createGraphics(60, 60);\n   *\n   *   // Draw to the p5.Graphics object.\n   *   pg.background(100);\n   *   pg.circle(30, 30, 20);\n   *\n   *   describe('A white circle at the center of a dark gray square disappears when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Display the p5.Graphics object if\n   *   // it's available.\n   *   if (pg) {\n   *     image(pg, 20, 20);\n   *   }\n   * }\n   *\n   * // Remove the p5.Graphics object when the\n   * // the user double-clicks.\n   * function doubleClicked() {\n   *   // Remove the p5.Graphics object from the web page.\n   *   pg.remove();\n   *   pg = undefined;\n   * }\n   * </code>\n   * </div>\n   */\n  remove() {\n    this._renderer.remove();\n    this._renderer = undefined;\n  }\n\n\n  /**\n   * Creates a new <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object with\n   * the same WebGL context as the graphics buffer.\n   *\n   * <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> objects are separate drawing\n   * surfaces that can be used as textures in WebGL mode. They're similar to\n   * <a href=\"#/p5.Graphics\">p5.Graphics</a> objects and generally run much\n   * faster when used as textures. Creating a\n   * <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object in the same context\n   * as the graphics buffer makes this speedup possible.\n   *\n   * The parameter, `options`, is optional. An object can be passed to configure\n   * the <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object. The available\n   * properties are:\n   *\n   * - `format`: data format of the texture, either `UNSIGNED_BYTE`, `FLOAT`, or `HALF_FLOAT`. Default is `UNSIGNED_BYTE`.\n   * - `channels`: whether to store `RGB` or `RGBA` color channels. Default is to match the graphics buffer which is `RGBA`.\n   * - `depth`: whether to include a depth buffer. Default is `true`.\n   * - `depthFormat`: data format of depth information, either `UNSIGNED_INT` or `FLOAT`. Default is `FLOAT`.\n   * - `stencil`: whether to include a stencil buffer for masking. `depth` must be `true` for this feature to work. Defaults to the value of `depth` which is `true`.\n   * - `antialias`: whether to perform anti-aliasing. If set to `true`, as in `{ antialias: true }`, 2 samples will be used by default. The number of samples can also be set, as in `{ antialias: 4 }`. Default is to match <a href=\"#/p5/setAttributes\">setAttributes()</a> which is `false` (`true` in Safari).\n   * - `width`: width of the <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object. Default is to always match the graphics buffer width.\n   * - `height`: height of the <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object. Default is to always match the graphics buffer height.\n   * - `density`: pixel density of the <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object. Default is to always match the graphics buffer pixel density.\n   * - `textureFiltering`: how to read values from the <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object. Either `LINEAR` (nearby pixels will be interpolated) or `NEAREST` (no interpolation). Generally, use `LINEAR` when using the texture as an image and `NEAREST` if reading the texture as data. Default is `LINEAR`.\n   *\n   * If the `width`, `height`, or `density` attributes are set, they won't\n   * automatically match the graphics buffer and must be changed manually.\n   *\n   * @param {Object} [options] configuration options.\n   * @return {p5.Framebuffer} new framebuffer.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and hold a mouse button to change shapes.\n   *\n   * let pg;\n   * let torusLayer;\n   * let boxLayer;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Graphics object using WebGL mode.\n   *   pg = createGraphics(100, 100, WEBGL);\n   *\n   *   // Create the p5.Framebuffer objects.\n   *   torusLayer = pg.createFramebuffer();\n   *   boxLayer = pg.createFramebuffer();\n   *\n   *   describe('A grid of white toruses rotating against a dark gray background. The shapes become boxes while the user holds a mouse button.');\n   * }\n   *\n   * function draw() {\n   *   // Update and draw the layers offscreen.\n   *   drawTorus();\n   *   drawBox();\n   *\n   *   // Choose the layer to display.\n   *   let layer;\n   *   if (mouseIsPressed === true) {\n   *     layer = boxLayer;\n   *   } else {\n   *     layer = torusLayer;\n   *   }\n   *\n   *   // Draw to the p5.Graphics object.\n   *   pg.background(50);\n   *\n   *   // Iterate from left to right.\n   *   for (let x = -50; x < 50; x += 25) {\n   *     // Iterate from top to bottom.\n   *     for (let y = -50; y < 50; y += 25) {\n   *       // Draw the layer to the p5.Graphics object\n   *       pg.image(layer, x, y, 25, 25);\n   *     }\n   *   }\n   *\n   *   // Display the p5.Graphics object.\n   *   image(pg, 0, 0);\n   * }\n   *\n   * // Update and draw the torus layer offscreen.\n   * function drawTorus() {\n   *   // Start drawing to the torus p5.Framebuffer.\n   *   torusLayer.begin();\n   *\n   *   // Clear the drawing surface.\n   *   pg.clear();\n   *\n   *   // Turn on the lights.\n   *   pg.lights();\n   *\n   *   // Rotate the coordinate system.\n   *   pg.rotateX(frameCount * 0.01);\n   *   pg.rotateY(frameCount * 0.01);\n   *\n   *   // Style the torus.\n   *   pg.noStroke();\n   *\n   *   // Draw the torus.\n   *   pg.torus(20);\n   *\n   *   // Start drawing to the torus p5.Framebuffer.\n   *   torusLayer.end();\n   * }\n   *\n   * // Update and draw the box layer offscreen.\n   * function drawBox() {\n   *   // Start drawing to the box p5.Framebuffer.\n   *   boxLayer.begin();\n   *\n   *   // Clear the drawing surface.\n   *   pg.clear();\n   *\n   *   // Turn on the lights.\n   *   pg.lights();\n   *\n   *   // Rotate the coordinate system.\n   *   pg.rotateX(frameCount * 0.01);\n   *   pg.rotateY(frameCount * 0.01);\n   *\n   *   // Style the box.\n   *   pg.noStroke();\n   *\n   *   // Draw the box.\n   *   pg.box(30);\n   *\n   *   // Start drawing to the box p5.Framebuffer.\n   *   boxLayer.end();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and hold a mouse button to change shapes.\n   *\n   * let pg;\n   * let torusLayer;\n   * let boxLayer;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create an options object.\n   *   let options = { width: 25, height: 25 };\n   *\n   *   // Create a p5.Graphics object using WebGL mode.\n   *   pg = createGraphics(100, 100, WEBGL);\n   *\n   *   // Create the p5.Framebuffer objects.\n   *   // Use options for configuration.\n   *   torusLayer = pg.createFramebuffer(options);\n   *   boxLayer = pg.createFramebuffer(options);\n   *\n   *   describe('A grid of white toruses rotating against a dark gray background. The shapes become boxes while the user holds a mouse button.');\n   * }\n   *\n   * function draw() {\n   *   // Update and draw the layers offscreen.\n   *   drawTorus();\n   *   drawBox();\n   *\n   *   // Choose the layer to display.\n   *   let layer;\n   *   if (mouseIsPressed === true) {\n   *     layer = boxLayer;\n   *   } else {\n   *     layer = torusLayer;\n   *   }\n   *\n   *   // Draw to the p5.Graphics object.\n   *   pg.background(50);\n   *\n   *   // Iterate from left to right.\n   *   for (let x = -50; x < 50; x += 25) {\n   *     // Iterate from top to bottom.\n   *     for (let y = -50; y < 50; y += 25) {\n   *       // Draw the layer to the p5.Graphics object\n   *       pg.image(layer, x, y);\n   *     }\n   *   }\n   *\n   *   // Display the p5.Graphics object.\n   *   image(pg, 0, 0);\n   * }\n   *\n   * // Update and draw the torus layer offscreen.\n   * function drawTorus() {\n   *   // Start drawing to the torus p5.Framebuffer.\n   *   torusLayer.begin();\n   *\n   *   // Clear the drawing surface.\n   *   pg.clear();\n   *\n   *   // Turn on the lights.\n   *   pg.lights();\n   *\n   *   // Rotate the coordinate system.\n   *   pg.rotateX(frameCount * 0.01);\n   *   pg.rotateY(frameCount * 0.01);\n   *\n   *   // Style the torus.\n   *   pg.noStroke();\n   *\n   *   // Draw the torus.\n   *   pg.torus(5, 2.5);\n   *\n   *   // Start drawing to the torus p5.Framebuffer.\n   *   torusLayer.end();\n   * }\n   *\n   * // Update and draw the box layer offscreen.\n   * function drawBox() {\n   *   // Start drawing to the box p5.Framebuffer.\n   *   boxLayer.begin();\n   *\n   *   // Clear the drawing surface.\n   *   pg.clear();\n   *\n   *   // Turn on the lights.\n   *   pg.lights();\n   *\n   *   // Rotate the coordinate system.\n   *   pg.rotateX(frameCount * 0.01);\n   *   pg.rotateY(frameCount * 0.01);\n   *\n   *   // Style the box.\n   *   pg.noStroke();\n   *\n   *   // Draw the box.\n   *   pg.box(7.5);\n   *\n   *   // Start drawing to the box p5.Framebuffer.\n   *   boxLayer.end();\n   * }\n   * </code>\n   * </div>\n   */\n  createFramebuffer(options) {\n    return new Framebuffer(this._renderer, options);\n  }\n\n  _assert3d(name) {\n    if (!this._renderer.isP3D)\n      throw new Error(\n        `${name}() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information.`\n      );\n  };\n\n  _initializeInstanceVariables() {\n    this._accessibleOutputs = {\n      text: false,\n      grid: false,\n      textLabel: false,\n      gridLabel: false\n    };\n\n    this._styles = [];\n\n    // this._colorMode = RGB;\n    // this._colorMaxes = {\n    //   rgb: [255, 255, 255, 255],\n    //   hsb: [360, 100, 100, 1],\n    //   hsl: [360, 100, 100, 1]\n    // };\n\n    this._downKeys = {}; //Holds the key codes of currently pressed keys\n  }\n}\nfunction graphics(p5, fn){\n  /**\n   * A class to describe a drawing surface that's separate from the main canvas.\n   *\n   * Each `p5.Graphics` object provides a dedicated drawing surface called a\n   * *graphics buffer*. Graphics buffers are helpful when drawing should happen\n   * offscreen. For example, separate scenes can be drawn offscreen and\n   * displayed only when needed.\n   *\n   * `p5.Graphics` objects have nearly all the drawing features of the main\n   * canvas. For example, calling the method `myGraphics.circle(50, 50, 20)`\n   * draws to the graphics buffer. The resulting image can be displayed on the\n   * main canvas by passing the `p5.Graphics` object to the\n   * <a href=\"#/p5/image\">image()</a> function, as in `image(myGraphics, 0, 0)`.\n   *\n   * Note: <a href=\"#/p5/createGraphics\">createGraphics()</a> is the recommended\n   * way to create an instance of this class.\n   *\n   * @class p5.Graphics\n   * @extends p5.Element\n   * @param {Number} w            width width of the graphics buffer in pixels.\n   * @param {Number} h            height height of the graphics buffer in pixels.\n   * @param {(P2D|WEBGL|P2DHDR)} renderer   the renderer to use, either P2D or WEBGL.\n   * @param {p5} [pInst]          sketch instance.\n   * @param {HTMLCanvasElement} [canvas]     existing `&lt;canvas&gt;` element to use.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Graphics object.\n   *   pg = createGraphics(50, 50);\n   *\n   *   // Draw to the p5.Graphics object.\n   *   pg.background(100);\n   *   pg.circle(25, 25, 20);\n   *\n   *   describe('A dark gray square with a white circle at its center drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Display the p5.Graphics object.\n   *   image(pg, 25, 25);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click the canvas to display the graphics buffer.\n   *\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Graphics object.\n   *   pg = createGraphics(50, 50);\n   *\n   *   describe('A square appears on a gray background when the user presses the mouse. The square cycles between white and black.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the background color.\n   *   let bg = frameCount % 255;\n   *\n   *   // Draw to the p5.Graphics object.\n   *   pg.background(bg);\n   *\n   *   // Display the p5.Graphics object while\n   *   // the user presses the mouse.\n   *   if (mouseIsPressed === true) {\n   *     image(pg, 25, 25);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  p5.Graphics = Graphics;\n\n  // Shapes\n  primitives(p5, p5.Graphics.prototype);\n  attributes(p5, p5.Graphics.prototype);\n  curves(p5, p5.Graphics.prototype);\n  vertex(p5, p5.Graphics.prototype);\n  customShapes(p5, p5.Graphics.prototype);\n\n  setting(p5, p5.Graphics.prototype);\n  loadingDisplaying(p5, p5.Graphics.prototype);\n  image(p5, p5.Graphics.prototype);\n  pixels(p5, p5.Graphics.prototype);\n\n  transform(p5, p5.Graphics.prototype);\n\n  primitives3D(p5, p5.Graphics.prototype);\n  light(p5, p5.Graphics.prototype);\n  material(p5, p5.Graphics.prototype);\n  creatingReading(p5, p5.Graphics.prototype);\n  trigonometry(p5, p5.Graphics.prototype);\n}\n\n/**\n * This module defines the p5.Texture class\n * @module 3D\n * @submodule Material\n * @for p5\n * @requires core\n */\n\n\nclass Texture {\n  constructor (renderer, obj, settings) {\n    this._renderer = renderer;\n\n    const gl = this._renderer.GL;\n\n    settings = settings || {};\n\n    this.src = obj;\n    this.glTex = undefined;\n    this.glTarget = gl.TEXTURE_2D;\n    this.glFormat = settings.format || gl.RGBA;\n    this.mipmaps = false;\n    this.glMinFilter = settings.minFilter || gl.LINEAR;\n    this.glMagFilter = settings.magFilter || gl.LINEAR;\n    this.glWrapS = settings.wrapS || gl.CLAMP_TO_EDGE;\n    this.glWrapT = settings.wrapT || gl.CLAMP_TO_EDGE;\n    this.glDataType = settings.dataType || gl.UNSIGNED_BYTE;\n\n    const support = checkWebGLCapabilities(renderer);\n    if (this.glFormat === gl.HALF_FLOAT && !support.halfFloat) {\n      console.log('This device does not support dataType HALF_FLOAT. Falling back to FLOAT.');\n      this.glDataType = gl.FLOAT;\n    }\n    if (\n      this.glFormat === gl.HALF_FLOAT &&\n      (this.glMinFilter === gl.LINEAR || this.glMagFilter === gl.LINEAR) &&\n      !support.halfFloatLinear\n    ) {\n      console.log('This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST.');\n      if (this.glMinFilter === gl.LINEAR) this.glMinFilter = gl.NEAREST;\n      if (this.glMagFilter === gl.LINEAR) this.glMagFilter = gl.NEAREST;\n    }\n    if (this.glFormat === gl.FLOAT && !support.float) {\n      console.log('This device does not support dataType FLOAT. Falling back to UNSIGNED_BYTE.');\n      this.glDataType = gl.UNSIGNED_BYTE;\n    }\n    if (\n      this.glFormat === gl.FLOAT &&\n      (this.glMinFilter === gl.LINEAR || this.glMagFilter === gl.LINEAR) &&\n      !support.floatLinear\n    ) {\n      console.log('This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST.');\n      if (this.glMinFilter === gl.LINEAR) this.glMinFilter = gl.NEAREST;\n      if (this.glMagFilter === gl.LINEAR) this.glMagFilter = gl.NEAREST;\n    }\n\n    // used to determine if this texture might need constant updating\n    // because it is a video or gif.\n    this.isSrcMediaElement = false;\n    this._videoPrevUpdateTime = 0;\n    this.isSrcHTMLElement =\n      typeof Element !== 'undefined' &&\n      obj instanceof Element &&\n      !(obj instanceof Graphics) &&\n      !(obj instanceof Renderer);\n    this.isSrcP5Image = obj instanceof Image;\n    this.isSrcP5Graphics = obj instanceof Graphics;\n    this.isSrcP5Renderer = obj instanceof Renderer;\n    this.isImageData =\n      typeof ImageData !== 'undefined' && obj instanceof ImageData;\n    this.isFramebufferTexture = obj instanceof FramebufferTexture;\n\n    const textureData = this._getTextureDataFromSource();\n    this.width = textureData.width;\n    this.height = textureData.height;\n\n    this.init(textureData);\n    return this;\n  }\n\n  remove() {\n    if (this.glTex) {\n      const gl = this._renderer.GL;\n      gl.deleteTexture(this.glTex);\n      this.glTex = undefined;\n    }\n  }\n\n  _getTextureDataFromSource () {\n    let textureData;\n    if (this.isFramebufferTexture) {\n      textureData = this.src.rawTexture();\n    } else if (this.isSrcP5Image) {\n    // param is a p5.Image\n      textureData = this.src.canvas;\n    } else if (\n      this.isSrcMediaElement ||\n      this.isSrcHTMLElement\n    ) {\n      // if param is a video HTML element\n      if (this.src._ensureCanvas) {\n        this.src._ensureCanvas();\n      }\n      textureData = this.src.elt;\n    } else if (this.isSrcP5Graphics || this.isSrcP5Renderer) {\n      textureData = this.src.canvas;\n    } else if (this.isImageData) {\n      textureData = this.src;\n    }\n    return textureData;\n  }\n\n  /**\n   * Initializes common texture parameters, creates a gl texture,\n   * tries to upload the texture for the first time if data is\n   * already available.\n   */\n  init (data) {\n    const gl = this._renderer.GL;\n    if (!this.isFramebufferTexture) {\n      this.glTex = gl.createTexture();\n    }\n\n    this.glWrapS = this._renderer.states.textureWrapX;\n    this.glWrapT = this._renderer.states.textureWrapY;\n\n    this.setWrapMode(this.glWrapS, this.glWrapT);\n    this.bindTexture();\n\n    //gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.glMagFilter);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.glMinFilter);\n\n    if (this.isFramebufferTexture) ; else if (\n      this.width === 0 ||\n      this.height === 0 ||\n      (this.isSrcMediaElement && !this.src.loadedmetadata)\n    ) {\n    // assign a 11 empty texture initially, because data is not yet ready,\n    // so that no errors occur in gl console!\n      const tmpdata = new Uint8Array([1, 1, 1, 1]);\n      gl.texImage2D(\n        this.glTarget,\n        0,\n        gl.RGBA,\n        1,\n        1,\n        0,\n        this.glFormat,\n        this.glDataType,\n        tmpdata\n      );\n    } else {\n    // data is ready: just push the texture!\n      gl.texImage2D(\n        this.glTarget,\n        0,\n        this.glFormat,\n        this.glFormat,\n        this.glDataType,\n        data\n      );\n    }\n  }\n\n  /**\n   * Checks if the source data for this texture has changed (if it's\n   * easy to do so) and reuploads the texture if necessary. If it's not\n   * possible or to expensive to do a calculation to determine wheter or\n   * not the data has occurred, this method simply re-uploads the texture.\n   */\n  update () {\n    const data = this.src;\n    if (data.width === 0 || data.height === 0) {\n      return false; // nothing to do!\n    }\n\n    // FramebufferTexture instances wrap raw WebGL textures already, which\n    // don't need any extra updating, as they already live on the GPU\n    if (this.isFramebufferTexture) {\n      this.src.update();\n      return false;\n    }\n\n    const textureData = this._getTextureDataFromSource();\n    let updated = false;\n\n    const gl = this._renderer.GL;\n    // pull texture from data, make sure width & height are appropriate\n    if (\n      textureData.width !== this.width ||\n      textureData.height !== this.height\n    ) {\n      updated = true;\n\n      // make sure that if the width and height of this.src have changed\n      // for some reason, we update our metadata and upload the texture again\n      this.width = textureData.width || data.width;\n      this.height = textureData.height || data.height;\n\n      if (this.isSrcP5Image) {\n        data.setModified(false);\n      } else if (this.isSrcMediaElement || this.isSrcHTMLElement) {\n        // on the first frame the metadata comes in, the size will be changed\n        // from 0 to actual size, but pixels may not be available.\n        // flag for update in a future frame.\n        // if we don't do this, a paused video, for example, may not\n        // send the first frame to texture memory.\n        data.setModified && data.setModified(true);\n      }\n    } else if (this.isSrcP5Image) {\n      // for an image, we only update if the modified field has been set,\n      // for example, by a call to p5.Image.set\n      if (data.isModified()) {\n        updated = true;\n        data.setModified(false);\n      }\n    } else if (this.isSrcMediaElement) {\n      // for a media element (video), we'll check if the current time in\n      // the video frame matches the last time. if it doesn't match, the\n      // video has advanced or otherwise been taken to a new frame,\n      // and we need to upload it.\n      if (data.isModified()) {\n        // p5.MediaElement may have also had set/updatePixels, etc. called\n        // on it and should be updated, or may have been set for the first\n        // time!\n        updated = true;\n        data.setModified(false);\n      } else if (data.loadedmetadata) {\n        // if the meta data has been loaded, we can ask the video\n        // what it's current position (in time) is.\n        if (this._videoPrevUpdateTime !== data.time()) {\n          // update the texture in gpu mem only if the current\n          // video timestamp does not match the timestamp of the last\n          // time we uploaded this texture (and update the time we\n          // last uploaded, too)\n          this._videoPrevUpdateTime = data.time();\n          updated = true;\n        }\n      }\n    } else if (this.isImageData) {\n      if (data._dirty) {\n        data._dirty = false;\n        updated = true;\n      }\n    } else {\n      /* data instanceof p5.Graphics, probably */\n      // there is not enough information to tell if the texture can be\n      // conditionally updated; so to be safe, we just go ahead and upload it.\n      updated = true;\n    }\n\n    if (updated) {\n      this.bindTexture();\n      gl.texImage2D(\n        this.glTarget,\n        0,\n        this.glFormat,\n        this.glFormat,\n        this.glDataType,\n        textureData\n      );\n    }\n\n    return updated;\n  }\n\n  /**\n   * Binds the texture to the appropriate GL target.\n   */\n  bindTexture () {\n    // bind texture using gl context + glTarget and\n    // generated gl texture object\n    const gl = this._renderer.GL;\n    gl.bindTexture(this.glTarget, this.getTexture());\n\n    return this;\n  }\n\n  /**\n   * Unbinds the texture from the appropriate GL target.\n   */\n  unbindTexture () {\n    // unbind per above, disable texturing on glTarget\n    const gl = this._renderer.GL;\n    gl.bindTexture(this.glTarget, null);\n  }\n\n  getTexture() {\n    if (this.isFramebufferTexture) {\n      return this.src.rawTexture();\n    } else {\n      return this.glTex;\n    }\n  }\n\n  /**\n   * Sets how a texture is be interpolated when upscaled or downscaled.\n   * Nearest filtering uses nearest neighbor scaling when interpolating\n   * Linear filtering uses WebGL's linear scaling when interpolating\n   * @param {String} downScale Specifies the texture filtering when\n   *                           textures are shrunk. Options are LINEAR or NEAREST\n   * @param {String} upScale Specifies the texture filtering when\n   *                         textures are magnified. Options are LINEAR or NEAREST\n   * @todo implement mipmapping filters\n   */\n  setInterpolation (downScale, upScale) {\n    const gl = this._renderer.GL;\n\n    this.glMinFilter = this.glFilter(downScale);\n    this.glMagFilter = this.glFilter(upScale);\n\n    this.bindTexture();\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.glMinFilter);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.glMagFilter);\n    this.unbindTexture();\n  }\n\n  glFilter(filter) {\n    const gl = this._renderer.GL;\n    if (filter === NEAREST) {\n      return gl.NEAREST;\n    } else {\n      return gl.LINEAR;\n    }\n  }\n\n  /**\n   * Sets the texture wrapping mode. This controls how textures behave\n   * when their uv's go outside of the 0 - 1 range. There are three options:\n   * CLAMP, REPEAT, and MIRROR. REPEAT & MIRROR are only available if the texture\n   * is a power of two size (128, 256, 512, 1024, etc.).\n   * @param {String} wrapX Controls the horizontal texture wrapping behavior\n   * @param {String} wrapY Controls the vertical texture wrapping behavior\n   */\n  setWrapMode (wrapX, wrapY) {\n    const gl = this._renderer.GL;\n\n    // for webgl 1 we need to check if the texture is power of two\n    // if it isn't we will set the wrap mode to CLAMP\n    // webgl2 will support npot REPEAT and MIRROR but we don't check for it yet\n    const isPowerOfTwo = x => (x & (x - 1)) === 0;\n    const textureData = this._getTextureDataFromSource();\n\n    let wrapWidth;\n    let wrapHeight;\n\n    if (textureData.naturalWidth && textureData.naturalHeight) {\n      wrapWidth = textureData.naturalWidth;\n      wrapHeight = textureData.naturalHeight;\n    } else {\n      wrapWidth = this.width;\n      wrapHeight = this.height;\n    }\n\n    const widthPowerOfTwo = isPowerOfTwo(wrapWidth);\n    const heightPowerOfTwo = isPowerOfTwo(wrapHeight);\n\n    if (wrapX === REPEAT) {\n      if (\n        this._renderer.webglVersion === WEBGL2 ||\n      (widthPowerOfTwo && heightPowerOfTwo)\n      ) {\n        this.glWrapS = gl.REPEAT;\n      } else {\n        console.warn(\n          'You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead'\n        );\n        this.glWrapS = gl.CLAMP_TO_EDGE;\n      }\n    } else if (wrapX === MIRROR) {\n      if (\n        this._renderer.webglVersion === WEBGL2 ||\n      (widthPowerOfTwo && heightPowerOfTwo)\n      ) {\n        this.glWrapS = gl.MIRRORED_REPEAT;\n      } else {\n        console.warn(\n          'You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead'\n        );\n        this.glWrapS = gl.CLAMP_TO_EDGE;\n      }\n    } else {\n      // falling back to default if didn't get a proper mode\n      this.glWrapS = gl.CLAMP_TO_EDGE;\n    }\n\n    if (wrapY === REPEAT) {\n      if (\n        this._renderer.webglVersion === WEBGL2 ||\n      (widthPowerOfTwo && heightPowerOfTwo)\n      ) {\n        this.glWrapT = gl.REPEAT;\n      } else {\n        console.warn(\n          'You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead'\n        );\n        this.glWrapT = gl.CLAMP_TO_EDGE;\n      }\n    } else if (wrapY === MIRROR) {\n      if (\n        this._renderer.webglVersion === WEBGL2 ||\n      (widthPowerOfTwo && heightPowerOfTwo)\n      ) {\n        this.glWrapT = gl.MIRRORED_REPEAT;\n      } else {\n        console.warn(\n          'You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead'\n        );\n        this.glWrapT = gl.CLAMP_TO_EDGE;\n      }\n    } else {\n      // falling back to default if didn't get a proper mode\n      this.glWrapT = gl.CLAMP_TO_EDGE;\n    }\n\n    this.bindTexture();\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, this.glWrapS);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, this.glWrapT);\n    this.unbindTexture();\n  }\n}\n\nclass MipmapTexture extends Texture {\n  constructor(renderer, levels, settings) {\n    super(renderer, levels, settings);\n    const gl = this._renderer.GL;\n    if (this.glMinFilter === gl.LINEAR) {\n      this.glMinFilter = gl.LINEAR_MIPMAP_LINEAR;\n    }\n  }\n\n  glFilter(_filter) {\n    const gl = this._renderer.GL;\n    // TODO: support others\n    return gl.LINEAR_MIPMAP_LINEAR;\n  }\n\n  _getTextureDataFromSource() {\n    return this.src;\n  }\n\n  init(levels) {\n    const gl = this._renderer.GL;\n    this.glTex = gl.createTexture();\n\n    this.bindTexture();\n    for (let level = 0; level < levels.length; level++) {\n      gl.texImage2D(\n        this.glTarget,\n        level,\n        this.glFormat,\n        this.glFormat,\n        this.glDataType,\n        levels[level]\n      );\n    }\n\n    this.glMinFilter = gl.LINEAR_MIPMAP_LINEAR;\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, this.glMagFilter);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, this.glMinFilter);\n\n    this.unbindTexture();\n  }\n\n  update() {}\n}\n\nfunction texture(p5, fn){\n  /**\n   * Texture class for WEBGL Mode\n   * @private\n   * @class p5.Texture\n   * @param {p5.RendererGL} renderer an instance of p5.RendererGL that\n   * will provide the GL context for this new p5.Texture\n   * @param {p5.Image|p5.Graphics|p5.Element|p5.MediaElement|ImageData|p5.Framebuffer|p5.FramebufferTexture|ImageData} [obj] the\n   * object containing the image data to store in the texture.\n   * @param {Object} [settings] optional A javascript object containing texture\n   * settings.\n   * @param {Number} [settings.format] optional The internal color component\n   * format for the texture. Possible values for format include gl.RGBA,\n   * gl.RGB, gl.ALPHA, gl.LUMINANCE, gl.LUMINANCE_ALPHA. Defaults to gl.RBGA\n   * @param {Number} [settings.minFilter] optional The texture minification\n   * filter setting. Possible values are gl.NEAREST or gl.LINEAR. Defaults\n   * to gl.LINEAR. Note, Mipmaps are not implemented in p5.\n   * @param {Number} [settings.magFilter] optional The texture magnification\n   * filter setting. Possible values are gl.NEAREST or gl.LINEAR. Defaults\n   * to gl.LINEAR. Note, Mipmaps are not implemented in p5.\n   * @param {Number} [settings.wrapS] optional The texture wrap settings for\n   * the s coordinate, or x axis. Possible values are gl.CLAMP_TO_EDGE,\n   * gl.REPEAT, and gl.MIRRORED_REPEAT. The mirror settings are only available\n   * when using a power of two sized texture. Defaults to gl.CLAMP_TO_EDGE\n   * @param {Number} [settings.wrapT] optional The texture wrap settings for\n   * the t coordinate, or y axis. Possible values are gl.CLAMP_TO_EDGE,\n   * gl.REPEAT, and gl.MIRRORED_REPEAT. The mirror settings are only available\n   * when using a power of two sized texture. Defaults to gl.CLAMP_TO_EDGE\n   * @param {Number} [settings.dataType] optional The data type of the texel\n   * data. Possible values are gl.UNSIGNED_BYTE or gl.FLOAT. There are more\n   * formats that are not implemented in p5. Defaults to gl.UNSIGNED_BYTE.\n   */\n  p5.Texture = Texture;\n\n  p5.MipmapTexture = MipmapTexture;\n}\n\nfunction checkWebGLCapabilities({ GL, webglVersion }) {\n  const gl = GL;\n  const supportsFloat = webglVersion === WEBGL2\n    ? (gl.getExtension('EXT_color_buffer_float') &&\n        gl.getExtension('EXT_float_blend'))\n    : gl.getExtension('OES_texture_float');\n  const supportsFloatLinear = supportsFloat &&\n    gl.getExtension('OES_texture_float_linear');\n  const supportsHalfFloat = webglVersion === WEBGL2\n    ? gl.getExtension('EXT_color_buffer_float')\n    : gl.getExtension('OES_texture_half_float');\n  const supportsHalfFloatLinear = supportsHalfFloat &&\n    gl.getExtension('OES_texture_half_float_linear');\n  return {\n    float: supportsFloat,\n    floatLinear: supportsFloatLinear,\n    halfFloat: supportsHalfFloat,\n    halfFloatLinear: supportsHalfFloatLinear\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  texture(p5, p5.prototype);\n}\n\n/**\n * @module Rendering\n * @requires constants\n */\n\n\nconst constrain = (n, low, high) => Math.max(Math.min(n, high), low);\n\nclass FramebufferCamera extends Camera {\n  constructor(framebuffer) {\n    super(framebuffer.renderer);\n    this.fbo = framebuffer;\n\n    // WebGL textures are upside-down compared to textures that come from\n    // images and graphics. Framebuffer cameras need to invert their y\n    // axes when being rendered to so that the texture comes out rightway up\n    // when read in shaders or image().\n    this.yScale = -1;\n  }\n\n  _computeCameraDefaultSettings() {\n    super._computeCameraDefaultSettings();\n    this.defaultAspectRatio = this.fbo.width / this.fbo.height;\n    this.defaultCameraFOV =\n      2 * Math.atan(this.fbo.height / 2 / this.defaultEyeZ);\n  }\n}\n\nclass FramebufferTexture {\n  constructor(framebuffer, property) {\n    this.framebuffer = framebuffer;\n    this.property = property;\n  }\n\n  get width() {\n    return this.framebuffer.width * this.framebuffer.density;\n  }\n\n  get height() {\n    return this.framebuffer.height * this.framebuffer.density;\n  }\n\n  update() {\n    this.framebuffer._update(this.property);\n  }\n\n  rawTexture() {\n    return this.framebuffer[this.property];\n  }\n}\n\nclass Framebuffer {\n  constructor(renderer, settings = {}) {\n    this.renderer = renderer;\n    this.renderer.framebuffers.add(this);\n\n    this._isClipApplied = false;\n\n    this.dirty = { colorTexture: false, depthTexture: false };\n\n    this.pixels = [];\n\n    this.format = settings.format || UNSIGNED_BYTE;\n    this.channels = settings.channels || (\n      this.renderer._pInst._glAttributes.alpha\n        ? RGBA\n        : RGB\n    );\n    this.useDepth = settings.depth === undefined ? true : settings.depth;\n    this.depthFormat = settings.depthFormat || FLOAT;\n    this.textureFiltering = settings.textureFiltering || LINEAR;\n    if (settings.antialias === undefined) {\n      this.antialiasSamples = this.renderer._pInst._glAttributes.antialias\n        ? 2\n        : 0;\n    } else if (typeof settings.antialias === 'number') {\n      this.antialiasSamples = settings.antialias;\n    } else {\n      this.antialiasSamples = settings.antialias ? 2 : 0;\n    }\n    this.antialias = this.antialiasSamples > 0;\n    if (this.antialias && this.renderer.webglVersion !== WEBGL2) {\n      console.warn('Antialiasing is unsupported in a WebGL 1 context');\n      this.antialias = false;\n    }\n    this.density = settings.density || this.renderer._pixelDensity;\n    const gl = this.renderer.GL;\n    this.gl = gl;\n    if (settings.width && settings.height) {\n      const dimensions =\n        this.renderer._adjustDimensions(settings.width, settings.height);\n      this.width = dimensions.adjustedWidth;\n      this.height = dimensions.adjustedHeight;\n      this._autoSized = false;\n    } else {\n      if ((settings.width === undefined) !== (settings.height === undefined)) {\n        console.warn(\n          'Please supply both width and height for a framebuffer to give it a ' +\n            'size. Only one was given, so the framebuffer will match the size ' +\n            'of its canvas.'\n        );\n      }\n      this.width = this.renderer.width;\n      this.height = this.renderer.height;\n      this._autoSized = true;\n    }\n    this._checkIfFormatsAvailable();\n\n    if (settings.stencil && !this.useDepth) {\n      console.warn('A stencil buffer can only be used if also using depth. Since the framebuffer has no depth buffer, the stencil buffer will be ignored.');\n    }\n    this.useStencil = this.useDepth &&\n      (settings.stencil === undefined ? true : settings.stencil);\n\n    this.framebuffer = gl.createFramebuffer();\n    if (!this.framebuffer) {\n      throw new Error('Unable to create a framebuffer');\n    }\n    if (this.antialias) {\n      this.aaFramebuffer = gl.createFramebuffer();\n      if (!this.aaFramebuffer) {\n        throw new Error('Unable to create a framebuffer for antialiasing');\n      }\n    }\n\n    this._recreateTextures();\n\n    const prevCam = this.renderer.states.curCamera;\n    this.defaultCamera = this.createCamera();\n    this.filterCamera = this.createCamera();\n    this.renderer.states.setValue('curCamera', prevCam);\n\n    this.draw(() => this.renderer.clear());\n  }\n\n  /**\n   * Resizes the framebuffer to a given width and height.\n   *\n   * The parameters, `width` and `height`, set the dimensions of the\n   * framebuffer. For example, calling `myBuffer.resize(300, 500)` resizes\n   * the framebuffer to 300500 pixels, then sets `myBuffer.width` to 300\n   * and `myBuffer.height` 500.\n   *\n   * @param {Number} width width of the framebuffer.\n   * @param {Number} height height of the framebuffer.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myBuffer;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   myBuffer = createFramebuffer();\n   *\n   *   describe('A multicolor sphere on a white surface. The image grows larger or smaller when the user moves the mouse, revealing a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw to the p5.Framebuffer object.\n   *   myBuffer.begin();\n   *   background(255);\n   *   normalMaterial();\n   *   sphere(20);\n   *   myBuffer.end();\n   *\n   *   // Display the p5.Framebuffer object.\n   *   image(myBuffer, -50, -50);\n   * }\n   *\n   * // Resize the p5.Framebuffer object when the\n   * // user moves the mouse.\n   * function mouseMoved() {\n   *   myBuffer.resize(mouseX, mouseY);\n   * }\n   * </code>\n   * </div>\n   */\n  resize(width, height) {\n    this._autoSized = false;\n    const dimensions =\n      this.renderer._adjustDimensions(width, height);\n    width = dimensions.adjustedWidth;\n    height = dimensions.adjustedHeight;\n    this.width = width;\n    this.height = height;\n    this._handleResize();\n  }\n\n  /**\n   * Sets the framebuffer's pixel density or returns its current density.\n   *\n   * Computer displays are grids of little lights called pixels. A display's\n   * pixel density describes how many pixels it packs into an area. Displays\n   * with smaller pixels have a higher pixel density and create sharper\n   * images.\n   *\n   * The parameter, `density`, is optional. If a number is passed, as in\n   * `myBuffer.pixelDensity(1)`, it sets the framebuffer's pixel density. By\n   * default, the framebuffer's pixel density will match that of the canvas\n   * where it was created. All canvases default to match the display's pixel\n   * density.\n   *\n   * Calling `myBuffer.pixelDensity()` without an argument returns its current\n   * pixel density.\n   *\n   * @param {Number} [density] pixel density to set.\n   * @returns {Number} current pixel density.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myBuffer;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   myBuffer = createFramebuffer();\n   *\n   *   describe(\"A white circle on a gray canvas. The circle's edge become fuzzy while the user presses and holds the mouse.\");\n   * }\n   *\n   * function draw() {\n   *   // Draw to the p5.Framebuffer object.\n   *   myBuffer.begin();\n   *   background(200);\n   *   circle(0, 0, 40);\n   *   myBuffer.end();\n   *\n   *   // Display the p5.Framebuffer object.\n   *   image(myBuffer, -50, -50);\n   * }\n   *\n   * // Decrease the pixel density when the user\n   * // presses the mouse.\n   * function mousePressed() {\n   *   myBuffer.pixelDensity(1);\n   * }\n   *\n   * // Increase the pixel density when the user\n   * // releases the mouse.\n   * function mouseReleased() {\n   *   myBuffer.pixelDensity(2);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myBuffer;\n   * let myFont;\n   *\n   * async function setup() {\n   *   // Load a font and create a p5.Font object.\n   *   myFont = await loadFont('assets/inconsolata.otf');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   myBuffer = createFramebuffer();\n   *\n   *   // Get the p5.Framebuffer object's pixel density.\n   *   let d = myBuffer.pixelDensity();\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont(myFont);\n   *   textSize(16);\n   *   fill(0);\n   *\n   *   // Display the pixel density.\n   *   text(`Density: ${d}`, 0, 0);\n   *\n   *   describe(`The text \"Density: ${d}\" written in black on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   */\n  pixelDensity(density) {\n    if (density) {\n      this._autoSized = false;\n      this.density = density;\n      this._handleResize();\n    } else {\n      return this.density;\n    }\n  }\n\n  /**\n   * Toggles the framebuffer's autosizing mode or returns the current mode.\n   *\n   * By default, the framebuffer automatically resizes to match the canvas\n   * that created it. Calling `myBuffer.autoSized(false)` disables this\n   * behavior and calling `myBuffer.autoSized(true)` re-enables it.\n   *\n   * Calling `myBuffer.autoSized()` without an argument returns `true` if\n   * the framebuffer automatically resizes and `false` if not.\n   *\n   * @param {Boolean} [autoSized] whether to automatically resize the framebuffer to match the canvas.\n   * @returns {Boolean} current autosize setting.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to toggle the autosizing mode.\n   *\n   * let myBuffer;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   myBuffer = createFramebuffer();\n   *\n   *   describe('A multicolor sphere on a gray background. The image resizes when the user moves the mouse.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Draw to the p5.Framebuffer object.\n   *   myBuffer.begin();\n   *   background(200);\n   *   normalMaterial();\n   *   sphere(width / 4);\n   *   myBuffer.end();\n   *\n   *   // Display the p5.Framebuffer object.\n   *   image(myBuffer, -width / 2, -height / 2);\n   * }\n   *\n   * // Resize the canvas when the user moves the mouse.\n   * function mouseMoved() {\n   *   let w = constrain(mouseX, 0, 100);\n   *   let h = constrain(mouseY, 0, 100);\n   *   resizeCanvas(w, h);\n   * }\n   *\n   * // Toggle autoSizing when the user double-clicks.\n   * // Note: opened an issue to fix(?) this.\n   * function doubleClicked() {\n   *   let isAuto = myBuffer.autoSized();\n   *   myBuffer.autoSized(!isAuto);\n   * }\n   * </code>\n   * </div>\n   */\n  autoSized(autoSized) {\n    if (autoSized === undefined) {\n      return this._autoSized;\n    } else {\n      this._autoSized = autoSized;\n      this._handleResize();\n    }\n  }\n\n  /**\n   * Checks the capabilities of the current WebGL environment to see if the\n   * settings supplied by the user are capable of being fulfilled. If they\n   * are not, warnings will be logged and the settings will be changed to\n   * something close that can be fulfilled.\n   *\n   * @private\n   */\n  _checkIfFormatsAvailable() {\n    const gl = this.gl;\n\n    if (\n      this.useDepth &&\n      this.renderer.webglVersion === WEBGL &&\n      !gl.getExtension('WEBGL_depth_texture')\n    ) {\n      console.warn(\n        'Unable to create depth textures in this environment. Falling back ' +\n          'to a framebuffer without depth.'\n      );\n      this.useDepth = false;\n    }\n\n    if (\n      this.useDepth &&\n      this.renderer.webglVersion === WEBGL &&\n      this.depthFormat === FLOAT\n    ) {\n      console.warn(\n        'FLOAT depth format is unavailable in WebGL 1. ' +\n          'Defaulting to UNSIGNED_INT.'\n      );\n      this.depthFormat = UNSIGNED_INT;\n    }\n\n    if (![\n      UNSIGNED_BYTE,\n      FLOAT,\n      HALF_FLOAT\n    ].includes(this.format)) {\n      console.warn(\n        'Unknown Framebuffer format. ' +\n          'Please use UNSIGNED_BYTE, FLOAT, or HALF_FLOAT. ' +\n          'Defaulting to UNSIGNED_BYTE.'\n      );\n      this.format = UNSIGNED_BYTE;\n    }\n    if (this.useDepth && ![\n      UNSIGNED_INT,\n      FLOAT\n    ].includes(this.depthFormat)) {\n      console.warn(\n        'Unknown Framebuffer depth format. ' +\n          'Please use UNSIGNED_INT or FLOAT. Defaulting to FLOAT.'\n      );\n      this.depthFormat = FLOAT;\n    }\n\n    const support = checkWebGLCapabilities(this.renderer);\n    if (!support.float && this.format === FLOAT) {\n      console.warn(\n        'This environment does not support FLOAT textures. ' +\n          'Falling back to UNSIGNED_BYTE.'\n      );\n      this.format = UNSIGNED_BYTE;\n    }\n    if (\n      this.useDepth &&\n      !support.float &&\n      this.depthFormat === FLOAT\n    ) {\n      console.warn(\n        'This environment does not support FLOAT depth textures. ' +\n          'Falling back to UNSIGNED_INT.'\n      );\n      this.depthFormat = UNSIGNED_INT;\n    }\n    if (!support.halfFloat && this.format === HALF_FLOAT) {\n      console.warn(\n        'This environment does not support HALF_FLOAT textures. ' +\n          'Falling back to UNSIGNED_BYTE.'\n      );\n      this.format = UNSIGNED_BYTE;\n    }\n\n    if (\n      this.channels === RGB &&\n      [FLOAT, HALF_FLOAT].includes(this.format)\n    ) {\n      console.warn(\n        'FLOAT and HALF_FLOAT formats do not work cross-platform with only ' +\n          'RGB channels. Falling back to RGBA.'\n      );\n      this.channels = RGBA;\n    }\n  }\n\n  /**\n   * Creates new textures and renderbuffers given the current size of the\n   * framebuffer.\n   *\n   * @private\n   */\n  _recreateTextures() {\n    const gl = this.gl;\n\n    this._updateSize();\n\n    const prevBoundTexture = gl.getParameter(gl.TEXTURE_BINDING_2D);\n    const prevBoundFramebuffer = gl.getParameter(gl.FRAMEBUFFER_BINDING);\n\n    const colorTexture = gl.createTexture();\n    if (!colorTexture) {\n      throw new Error('Unable to create color texture');\n    }\n    gl.bindTexture(gl.TEXTURE_2D, colorTexture);\n    const colorFormat = this._glColorFormat();\n    gl.texImage2D(\n      gl.TEXTURE_2D,\n      0,\n      colorFormat.internalFormat,\n      this.width * this.density,\n      this.height * this.density,\n      0,\n      colorFormat.format,\n      colorFormat.type,\n      null\n    );\n    this.colorTexture = colorTexture;\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n    gl.framebufferTexture2D(\n      gl.FRAMEBUFFER,\n      gl.COLOR_ATTACHMENT0,\n      gl.TEXTURE_2D,\n      colorTexture,\n      0\n    );\n\n    if (this.useDepth) {\n      // Create the depth texture\n      const depthTexture = gl.createTexture();\n      if (!depthTexture) {\n        throw new Error('Unable to create depth texture');\n      }\n      const depthFormat = this._glDepthFormat();\n      gl.bindTexture(gl.TEXTURE_2D, depthTexture);\n      gl.texImage2D(\n        gl.TEXTURE_2D,\n        0,\n        depthFormat.internalFormat,\n        this.width * this.density,\n        this.height * this.density,\n        0,\n        depthFormat.format,\n        depthFormat.type,\n        null\n      );\n\n      gl.framebufferTexture2D(\n        gl.FRAMEBUFFER,\n        this.useStencil ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT,\n        gl.TEXTURE_2D,\n        depthTexture,\n        0\n      );\n      this.depthTexture = depthTexture;\n    }\n\n    // Create separate framebuffer for antialiasing\n    if (this.antialias) {\n      this.colorRenderbuffer = gl.createRenderbuffer();\n      gl.bindRenderbuffer(gl.RENDERBUFFER, this.colorRenderbuffer);\n      gl.renderbufferStorageMultisample(\n        gl.RENDERBUFFER,\n        Math.max(\n          0,\n          Math.min(this.antialiasSamples, gl.getParameter(gl.MAX_SAMPLES))\n        ),\n        colorFormat.internalFormat,\n        this.width * this.density,\n        this.height * this.density\n      );\n\n      if (this.useDepth) {\n        const depthFormat = this._glDepthFormat();\n        this.depthRenderbuffer = gl.createRenderbuffer();\n        gl.bindRenderbuffer(gl.RENDERBUFFER, this.depthRenderbuffer);\n        gl.renderbufferStorageMultisample(\n          gl.RENDERBUFFER,\n          Math.max(\n            0,\n            Math.min(this.antialiasSamples, gl.getParameter(gl.MAX_SAMPLES))\n          ),\n          depthFormat.internalFormat,\n          this.width * this.density,\n          this.height * this.density\n        );\n      }\n\n      gl.bindFramebuffer(gl.FRAMEBUFFER, this.aaFramebuffer);\n      gl.framebufferRenderbuffer(\n        gl.FRAMEBUFFER,\n        gl.COLOR_ATTACHMENT0,\n        gl.RENDERBUFFER,\n        this.colorRenderbuffer\n      );\n      if (this.useDepth) {\n        gl.framebufferRenderbuffer(\n          gl.FRAMEBUFFER,\n          this.useStencil ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT,\n          gl.RENDERBUFFER,\n          this.depthRenderbuffer\n        );\n      }\n    }\n\n    if (this.useDepth) {\n      this.depth = new FramebufferTexture(this, 'depthTexture');\n      const depthFilter = gl.NEAREST;\n      this.depthP5Texture = new Texture(\n        this.renderer,\n        this.depth,\n        {\n          minFilter: depthFilter,\n          magFilter: depthFilter\n        }\n      );\n      this.renderer.textures.set(this.depth, this.depthP5Texture);\n    }\n\n    this.color = new FramebufferTexture(this, 'colorTexture');\n    const filter = this.textureFiltering === LINEAR\n      ? gl.LINEAR\n      : gl.NEAREST;\n    this.colorP5Texture = new Texture(\n      this.renderer,\n      this.color,\n      {\n        minFilter: filter,\n        magFilter: filter\n      }\n    );\n    this.renderer.textures.set(this.color, this.colorP5Texture);\n\n    gl.bindTexture(gl.TEXTURE_2D, prevBoundTexture);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, prevBoundFramebuffer);\n  }\n\n  /**\n   * To create a WebGL texture, one needs to supply three pieces of information:\n   * the type (the data type each channel will be stored as, e.g. int or float),\n   * the format (the color channels that will each be stored in the previously\n   * specified type, e.g. rgb or rgba), and the internal format (the specifics\n   * of how data for each channel, in the aforementioned type, will be packed\n   * together, such as how many bits to use, e.g. RGBA32F or RGB565.)\n   *\n   * The format and channels asked for by the user hint at what these values\n   * need to be, and the WebGL version affects what options are avaiable.\n   * This method returns the values for these three properties, given the\n   * framebuffer's settings.\n   *\n   * @private\n   */\n  _glColorFormat() {\n    let type, format, internalFormat;\n    const gl = this.gl;\n\n    if (this.format === FLOAT) {\n      type = gl.FLOAT;\n    } else if (this.format === HALF_FLOAT) {\n      type = this.renderer.webglVersion === WEBGL2\n        ? gl.HALF_FLOAT\n        : gl.getExtension('OES_texture_half_float').HALF_FLOAT_OES;\n    } else {\n      type = gl.UNSIGNED_BYTE;\n    }\n\n    if (this.channels === RGBA) {\n      format = gl.RGBA;\n    } else {\n      format = gl.RGB;\n    }\n\n    if (this.renderer.webglVersion === WEBGL2) {\n      // https://webgl2fundamentals.org/webgl/lessons/webgl-data-textures.html\n      const table = {\n        [gl.FLOAT]: {\n          [gl.RGBA]: gl.RGBA32F\n          // gl.RGB32F is not available in Firefox without an alpha channel\n        },\n        [gl.HALF_FLOAT]: {\n          [gl.RGBA]: gl.RGBA16F\n          // gl.RGB16F is not available in Firefox without an alpha channel\n        },\n        [gl.UNSIGNED_BYTE]: {\n          [gl.RGBA]: gl.RGBA8, // gl.RGBA4\n          [gl.RGB]: gl.RGB8 // gl.RGB565\n        }\n      };\n      internalFormat = table[type][format];\n    } else if (this.format === HALF_FLOAT) {\n      internalFormat = gl.RGBA;\n    } else {\n      internalFormat = format;\n    }\n\n    return { internalFormat, format, type };\n  }\n\n  /**\n   * To create a WebGL texture, one needs to supply three pieces of information:\n   * the type (the data type each channel will be stored as, e.g. int or float),\n   * the format (the color channels that will each be stored in the previously\n   * specified type, e.g. rgb or rgba), and the internal format (the specifics\n   * of how data for each channel, in the aforementioned type, will be packed\n   * together, such as how many bits to use, e.g. RGBA32F or RGB565.)\n   *\n   * This method takes into account the settings asked for by the user and\n   * returns values for these three properties that can be used for the\n   * texture storing depth information.\n   *\n   * @private\n   */\n  _glDepthFormat() {\n    let type, format, internalFormat;\n    const gl = this.gl;\n\n    if (this.useStencil) {\n      if (this.depthFormat === FLOAT) {\n        type = gl.FLOAT_32_UNSIGNED_INT_24_8_REV;\n      } else if (this.renderer.webglVersion === WEBGL2) {\n        type = gl.UNSIGNED_INT_24_8;\n      } else {\n        type = gl.getExtension('WEBGL_depth_texture').UNSIGNED_INT_24_8_WEBGL;\n      }\n    } else {\n      if (this.depthFormat === FLOAT) {\n        type = gl.FLOAT;\n      } else {\n        type = gl.UNSIGNED_INT;\n      }\n    }\n\n    if (this.useStencil) {\n      format = gl.DEPTH_STENCIL;\n    } else {\n      format = gl.DEPTH_COMPONENT;\n    }\n\n    if (this.useStencil) {\n      if (this.depthFormat === FLOAT) {\n        internalFormat = gl.DEPTH32F_STENCIL8;\n      } else if (this.renderer.webglVersion === WEBGL2) {\n        internalFormat = gl.DEPTH24_STENCIL8;\n      } else {\n        internalFormat = gl.DEPTH_STENCIL;\n      }\n    } else if (this.renderer.webglVersion === WEBGL2) {\n      if (this.depthFormat === FLOAT) {\n        internalFormat = gl.DEPTH_COMPONENT32F;\n      } else {\n        internalFormat = gl.DEPTH_COMPONENT24;\n      }\n    } else {\n      internalFormat = gl.DEPTH_COMPONENT;\n    }\n\n    return { internalFormat, format, type };\n  }\n\n  /**\n   * A method that will be called when recreating textures. If the framebuffer\n   * is auto-sized, it will update its width, height, and density properties.\n   *\n   * @private\n   */\n  _updateSize() {\n    if (this._autoSized) {\n      this.width = this.renderer.width;\n      this.height = this.renderer.height;\n      this.density = this.renderer._pixelDensity;\n    }\n  }\n\n  /**\n   * Called when the canvas that the framebuffer is attached to resizes. If the\n   * framebuffer is auto-sized, it will update its textures to match the new\n   * size.\n   *\n   * @private\n   */\n  _canvasSizeChanged() {\n    if (this._autoSized) {\n      this._handleResize();\n    }\n  }\n\n  /**\n   * Called when the size of the framebuffer has changed (either by being\n   * manually updated or from auto-size updates when its canvas changes size.)\n   * Old textures and renderbuffers will be deleted, and then recreated with the\n   * new size.\n   *\n   * @private\n   */\n  _handleResize() {\n    const oldColor = this.color;\n    const oldDepth = this.depth;\n    const oldColorRenderbuffer = this.colorRenderbuffer;\n    const oldDepthRenderbuffer = this.depthRenderbuffer;\n\n    this._deleteTexture(oldColor);\n    if (oldDepth) this._deleteTexture(oldDepth);\n    const gl = this.gl;\n    if (oldColorRenderbuffer) gl.deleteRenderbuffer(oldColorRenderbuffer);\n    if (oldDepthRenderbuffer) gl.deleteRenderbuffer(oldDepthRenderbuffer);\n\n    this._recreateTextures();\n    this.defaultCamera._resize();\n  }\n\n  /**\n   * Creates a new\n   * <a href=\"#/p5.Camera\">p5.Camera</a> object to use with the framebuffer.\n   *\n   * The new camera is initialized with a default position `(0, 0, 800)` and a\n   * default perspective projection. Its properties can be controlled with\n   * <a href=\"#/p5.Camera\">p5.Camera</a> methods such as `myCamera.lookAt(0, 0, 0)`.\n   *\n   * Framebuffer cameras should be created between calls to\n   * <a href=\"#/p5.Framebuffer/begin\">myBuffer.begin()</a> and\n   * <a href=\"#/p5.Framebuffer/end\">myBuffer.end()</a> like so:\n   *\n   * ```js\n   * let myCamera;\n   *\n   * myBuffer.begin();\n   *\n   * // Create the camera for the framebuffer.\n   * myCamera = myBuffer.createCamera();\n   *\n   * myBuffer.end();\n   * ```\n   *\n   * Calling <a href=\"#/p5/setCamera\">setCamera()</a> updates the\n   * framebuffer's projection using the camera.\n   * <a href=\"#/p5/resetMatrix\">resetMatrix()</a> must also be called for the\n   * view to change properly:\n   *\n   * ```js\n   * myBuffer.begin();\n   *\n   * // Set the camera for the framebuffer.\n   * setCamera(myCamera);\n   *\n   * // Reset all transformations.\n   * resetMatrix();\n   *\n   * // Draw stuff...\n   *\n   * myBuffer.end();\n   * ```\n   *\n   * @returns {p5.Camera} new camera.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to toggle between cameras.\n   *\n   * let myBuffer;\n   * let cam1;\n   * let cam2;\n   * let usingCam1 = true;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   myBuffer = createFramebuffer();\n   *\n   *   // Create the cameras between begin() and end().\n   *   myBuffer.begin();\n   *\n   *   // Create the first camera.\n   *   // Keep its default settings.\n   *   cam1 = myBuffer.createCamera();\n   *\n   *   // Create the second camera.\n   *   // Place it at the top-left.\n   *   // Point it at the origin.\n   *   cam2 = myBuffer.createCamera();\n   *   cam2.setPosition(400, -400, 800);\n   *   cam2.lookAt(0, 0, 0);\n   *\n   *   myBuffer.end();\n   *\n   *   describe(\n   *     'A white cube on a gray background. The camera toggles between frontal and aerial views when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   // Draw to the p5.Framebuffer object.\n   *   myBuffer.begin();\n   *   background(200);\n   *\n   *   // Set the camera.\n   *   if (usingCam1 === true) {\n   *     setCamera(cam1);\n   *   } else {\n   *     setCamera(cam2);\n   *   }\n   *\n   *   // Reset all transformations.\n   *   resetMatrix();\n   *\n   *   // Draw the box.\n   *   box();\n   *\n   *   myBuffer.end();\n   *\n   *   // Display the p5.Framebuffer object.\n   *   image(myBuffer, -50, -50);\n   * }\n   *\n   * // Toggle the current camera when the user double-clicks.\n   * function doubleClicked() {\n   *   if (usingCam1 === true) {\n   *     usingCam1 = false;\n   *   } else {\n   *     usingCam1 = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  createCamera() {\n    const cam = new FramebufferCamera(this);\n    cam._computeCameraDefaultSettings();\n    cam._setDefaultCamera();\n    return cam;\n  }\n\n  /**\n   * Given a raw texture wrapper, delete its stored texture from WebGL memory,\n   * and remove it from p5's list of active textures.\n   *\n   * @param {p5.FramebufferTexture} texture\n   * @private\n   */\n  _deleteTexture(texture) {\n    const gl = this.gl;\n    gl.deleteTexture(texture.rawTexture());\n\n    this.renderer.textures.delete(texture);\n  }\n\n  /**\n   * Deletes the framebuffer from GPU memory.\n   *\n   * Calling `myBuffer.remove()` frees the GPU memory used by the framebuffer.\n   * The framebuffer also uses a bit of memory on the CPU which can be freed\n   * like so:\n   *\n   * ```js\n   * // Delete the framebuffer from GPU memory.\n   * myBuffer.remove();\n   *\n   * // Delete the framebuffer from CPU memory.\n   * myBuffer = undefined;\n   * ```\n   *\n   * Note: All variables that reference the framebuffer must be assigned\n   * the value `undefined` to delete the framebuffer from CPU memory. If any\n   * variable still refers to the framebuffer, then it won't be garbage\n   * collected.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to remove the p5.Framebuffer object.\n   *\n   * let myBuffer;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create an options object.\n   *   let options = { width: 60, height: 60 };\n   *\n   *   // Create a p5.Framebuffer object and\n   *   // configure it using options.\n   *   myBuffer = createFramebuffer(options);\n   *\n   *   describe('A white circle at the center of a dark gray square disappears when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Display the p5.Framebuffer object if\n   *   // it's available.\n   *   if (myBuffer) {\n   *     // Draw to the p5.Framebuffer object.\n   *     myBuffer.begin();\n   *     background(100);\n   *     circle(0, 0, 20);\n   *     myBuffer.end();\n   *\n   *     image(myBuffer, -30, -30);\n   *   }\n   * }\n   *\n   * // Remove the p5.Framebuffer object when the\n   * // the user double-clicks.\n   * function doubleClicked() {\n   *   // Delete the framebuffer from GPU memory.\n   *   myBuffer.remove();\n   *\n   *   // Delete the framebuffer from CPU memory.\n   *   myBuffer = undefined;\n   * }\n   * </code>\n   * </div>\n   */\n  remove() {\n    const gl = this.gl;\n    this._deleteTexture(this.color);\n    if (this.depth) this._deleteTexture(this.depth);\n    gl.deleteFramebuffer(this.framebuffer);\n    if (this.aaFramebuffer) {\n      gl.deleteFramebuffer(this.aaFramebuffer);\n    }\n    if (this.depthRenderbuffer) {\n      gl.deleteRenderbuffer(this.depthRenderbuffer);\n    }\n    if (this.colorRenderbuffer) {\n      gl.deleteRenderbuffer(this.colorRenderbuffer);\n    }\n    this.renderer.framebuffers.delete(this);\n  }\n\n  /**\n   * Begins drawing shapes to the framebuffer.\n   *\n   * `myBuffer.begin()` and <a href=\"#/p5.Framebuffer/end\">myBuffer.end()</a>\n   * allow shapes to be drawn to the framebuffer. `myBuffer.begin()` begins\n   * drawing to the framebuffer and\n   * <a href=\"#/p5.Framebuffer/end\">myBuffer.end()</a> stops drawing to the\n   * framebuffer. Changes won't be visible until the framebuffer is displayed\n   * as an image or texture.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myBuffer;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   myBuffer = createFramebuffer();\n   *\n   *   describe('An empty gray canvas. The canvas gets darker and a rotating, multicolor torus appears while the user presses and holds the mouse.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Start drawing to the p5.Framebuffer object.\n   *   myBuffer.begin();\n   *\n   *   background(50);\n   *   rotateY(frameCount * 0.01);\n   *   normalMaterial();\n   *   torus(30);\n   *\n   *   // Stop drawing to the p5.Framebuffer object.\n   *   myBuffer.end();\n   *\n   *   // Display the p5.Framebuffer object while\n   *   // the user presses the mouse.\n   *   if (mouseIsPressed === true) {\n   *     image(myBuffer, -50, -50);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  begin() {\n    this.prevFramebuffer = this.renderer.activeFramebuffer();\n    if (this.prevFramebuffer) {\n      this.prevFramebuffer._beforeEnd();\n    }\n    this.renderer.activeFramebuffers.push(this);\n    this._beforeBegin();\n    this.renderer.push();\n    // Apply the framebuffer's camera. This does almost what\n    // RendererGL.reset() does, but this does not try to clear any buffers;\n    // it only sets the camera.\n    // this.renderer.setCamera(this.defaultCamera);\n    this.renderer.states.setValue('curCamera', this.defaultCamera);\n    // set the projection matrix (which is not normally updated each frame)\n    this.renderer.states.setValue('uPMatrix', this.renderer.states.uPMatrix.clone());\n    this.renderer.states.uPMatrix.set(this.defaultCamera.projMatrix);\n    this.renderer.states.setValue('uViewMatrix', this.renderer.states.uViewMatrix.clone());\n    this.renderer.states.uViewMatrix.set(this.defaultCamera.cameraMatrix);\n\n    this.renderer.resetMatrix();\n    this.renderer.states.uViewMatrix\n      .set(this.renderer.states.curCamera.cameraMatrix);\n    this.renderer.states.uModelMatrix.reset();\n    this.renderer._applyStencilTestIfClipping();\n  }\n\n  /**\n   * When making a p5.Framebuffer active so that it may be drawn to, this method\n   * returns the underlying WebGL framebuffer that needs to be active to\n   * support this. Antialiased framebuffers first write to a multisampled\n   * renderbuffer, while other framebuffers can write directly to their main\n   * framebuffers.\n   *\n   * @private\n   */\n  _framebufferToBind() {\n    if (this.antialias) {\n      // If antialiasing, draw to an antialiased renderbuffer rather\n      // than directly to the texture. In end() we will copy from the\n      // renderbuffer to the texture.\n      return this.aaFramebuffer;\n    } else {\n      return this.framebuffer;\n    }\n  }\n\n  /**\n   * Ensure all readable textures are up-to-date.\n   * @private\n   * @property {'colorTexutre'|'depthTexture'} property The property to update\n   */\n  _update(property) {\n    if (this.dirty[property] && this.antialias) {\n      const gl = this.gl;\n      gl.bindFramebuffer(gl.READ_FRAMEBUFFER, this.aaFramebuffer);\n      gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, this.framebuffer);\n      const partsToCopy = {\n        colorTexture: [gl.COLOR_BUFFER_BIT, this.colorP5Texture.glMagFilter],\n      };\n      if (this.useDepth) {\n        partsToCopy.depthTexture = [\n          gl.DEPTH_BUFFER_BIT,\n          this.depthP5Texture.glMagFilter\n        ];\n      }\n      const [flag, filter] = partsToCopy[property];\n      gl.blitFramebuffer(\n        0,\n        0,\n        this.width * this.density,\n        this.height * this.density,\n        0,\n        0,\n        this.width * this.density,\n        this.height * this.density,\n        flag,\n        filter\n      );\n      this.dirty[property] = false;\n\n      const activeFbo = this.renderer.activeFramebuffer();\n      if (activeFbo) {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, activeFbo._framebufferToBind());\n      } else {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n      }\n    }\n  }\n\n  /**\n   * Ensures that the framebuffer is ready to be drawn to\n   *\n   * @private\n   */\n  _beforeBegin() {\n    const gl = this.gl;\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this._framebufferToBind());\n    this.renderer.viewport(\n      this.width * this.density,\n      this.height * this.density\n    );\n  }\n\n  /**\n   * Ensures that the framebuffer is ready to be read by other framebuffers.\n   *\n   * @private\n   */\n  _beforeEnd() {\n    if (this.antialias) {\n      this.dirty = { colorTexture: true, depthTexture: true };\n    }\n  }\n\n  /**\n   * Stops drawing shapes to the framebuffer.\n   *\n   * <a href=\"#/p5.Framebuffer/begin\">myBuffer.begin()</a> and `myBuffer.end()`\n   * allow shapes to be drawn to the framebuffer.\n   * <a href=\"#/p5.Framebuffer/begin\">myBuffer.begin()</a> begins drawing to\n   * the framebuffer and `myBuffer.end()` stops drawing to the framebuffer.\n   * Changes won't be visible until the framebuffer is displayed as an image\n   * or texture.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myBuffer;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   myBuffer = createFramebuffer();\n   *\n   *   describe('An empty gray canvas. The canvas gets darker and a rotating, multicolor torus appears while the user presses and holds the mouse.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Start drawing to the p5.Framebuffer object.\n   *   myBuffer.begin();\n   *\n   *   background(50);\n   *   rotateY(frameCount * 0.01);\n   *   normalMaterial();\n   *   torus(30);\n   *\n   *   // Stop drawing to the p5.Framebuffer object.\n   *   myBuffer.end();\n   *\n   *   // Display the p5.Framebuffer object while\n   *   // the user presses the mouse.\n   *   if (mouseIsPressed === true) {\n   *     image(myBuffer, -50, -50);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  end() {\n    const gl = this.gl;\n    this.renderer.pop();\n    const fbo = this.renderer.activeFramebuffers.pop();\n    if (fbo !== this) {\n      throw new Error(\"It looks like you've called end() while another Framebuffer is active.\");\n    }\n    this._beforeEnd();\n    if (this.prevFramebuffer) {\n      this.prevFramebuffer._beforeBegin();\n    } else {\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n      this.renderer.viewport(\n        this.renderer._origViewport.width,\n        this.renderer._origViewport.height\n      );\n    }\n    this.renderer._applyStencilTestIfClipping();\n  }\n\n  /**\n   * Draws to the framebuffer by calling a function that contains drawing\n   * instructions.\n   *\n   * The parameter, `callback`, is a function with the drawing instructions\n   * for the framebuffer. For example, calling `myBuffer.draw(myFunction)`\n   * will call a function named `myFunction()` to draw to the framebuffer.\n   * Doing so has the same effect as the following:\n   *\n   * ```js\n   * myBuffer.begin();\n   * myFunction();\n   * myBuffer.end();\n   * ```\n   *\n   * @param {Function} callback function that draws to the framebuffer.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click the canvas to display the framebuffer.\n   *\n   * let myBuffer;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   myBuffer = createFramebuffer();\n   *\n   *   describe('An empty gray canvas. The canvas gets darker and a rotating, multicolor torus appears while the user presses and holds the mouse.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw to the p5.Framebuffer object.\n   *   myBuffer.draw(bagel);\n   *\n   *   // Display the p5.Framebuffer object while\n   *   // the user presses the mouse.\n   *   if (mouseIsPressed === true) {\n   *     image(myBuffer, -50, -50);\n   *   }\n   * }\n   *\n   * // Draw a rotating, multicolor torus.\n   * function bagel() {\n   *   background(50);\n   *   rotateY(frameCount * 0.01);\n   *   normalMaterial();\n   *   torus(30);\n   * }\n   * </code>\n   * </div>\n   */\n  draw(callback) {\n    this.begin();\n    callback();\n    this.end();\n  }\n\n  /**\n   * Loads the current value of each pixel in the framebuffer into its\n   * <a href=\"#/p5.Framebuffer/pixels\">pixels</a> array.\n   *\n   * `myBuffer.loadPixels()` must be called before reading from or writing to\n   * <a href=\"#/p5.Framebuffer/pixels\">myBuffer.pixels</a>.\n   *\n   * @method loadPixels\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   let myBuffer = createFramebuffer();\n   *\n   *   // Load the pixels array.\n   *   myBuffer.loadPixels();\n   *\n   *   // Get the number of pixels in the\n   *   // top half of the framebuffer.\n   *   let numPixels = myBuffer.pixels.length / 2;\n   *\n   *   // Set the framebuffer's top half to pink.\n   *   for (let i = 0; i < numPixels; i += 4) {\n   *     myBuffer.pixels[i] = 255;\n   *     myBuffer.pixels[i + 1] = 102;\n   *     myBuffer.pixels[i + 2] = 204;\n   *     myBuffer.pixels[i + 3] = 255;\n   *   }\n   *\n   *   // Update the pixels array.\n   *   myBuffer.updatePixels();\n   *\n   *   // Draw the p5.Framebuffer object to the canvas.\n   *   image(myBuffer, -50, -50);\n   *\n   *   describe('A pink rectangle above a gray rectangle.');\n   * }\n   * </code>\n   * </div>\n   */\n  loadPixels() {\n    this._update('colorTexture');\n    const gl = this.gl;\n    const prevFramebuffer = this.renderer.activeFramebuffer();\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n    const colorFormat = this._glColorFormat();\n    this.pixels = readPixelsWebGL(\n      this.pixels,\n      gl,\n      this.framebuffer,\n      0,\n      0,\n      this.width * this.density,\n      this.height * this.density,\n      colorFormat.format,\n      colorFormat.type\n    );\n    if (prevFramebuffer) {\n      gl.bindFramebuffer(gl.FRAMEBUFFER, prevFramebuffer._framebufferToBind());\n    } else {\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n    }\n  }\n\n  /**\n   * Gets a pixel or a region of pixels from the framebuffer.\n   *\n   * `myBuffer.get()` is easy to use but it's not as fast as\n   * <a href=\"#/p5.Framebuffer/pixels\">myBuffer.pixels</a>. Use\n   * <a href=\"#/p5.Framebuffer/pixels\">myBuffer.pixels</a> to read many pixel\n   * values.\n   *\n   * The version of `myBuffer.get()` with no parameters returns the entire\n   * framebuffer as a a <a href=\"#/p5.Image\">p5.Image</a> object.\n   *\n   * The version of `myBuffer.get()` with two parameters interprets them as\n   * coordinates. It returns an array with the `[R, G, B, A]` values of the\n   * pixel at the given point.\n   *\n   * The version of `myBuffer.get()` with four parameters interprets them as\n   * coordinates and dimensions. It returns a subsection of the framebuffer as\n   * a <a href=\"#/p5.Image\">p5.Image</a> object. The first two parameters are\n   * the coordinates for the upper-left corner of the subsection. The last two\n   * parameters are the width and height of the subsection.\n   *\n   * @param  {Number} x x-coordinate of the pixel. Defaults to 0.\n   * @param  {Number} y y-coordinate of the pixel. Defaults to 0.\n   * @param  {Number} w width of the subsection to be returned.\n   * @param  {Number} h height of the subsection to be returned.\n   * @return {p5.Image} subsection as a <a href=\"#/p5.Image\">p5.Image</a> object.\n   */\n  /**\n   * @return {p5.Image} entire framebuffer as a <a href=\"#/p5.Image\">p5.Image</a> object.\n   */\n  /**\n   * @param  {Number} x\n   * @param  {Number} y\n   * @return {Number[]}  color of the pixel at `(x, y)` as an array of color values `[R, G, B, A]`.\n   */\n  get(x, y, w, h) {\n    this._update('colorTexture');\n    // p5._validateParameters('p5.Framebuffer.get', arguments);\n    const colorFormat = this._glColorFormat();\n    if (x === undefined && y === undefined) {\n      x = 0;\n      y = 0;\n      w = this.width;\n      h = this.height;\n    } else if (w === undefined && h === undefined) {\n      if (x < 0 || y < 0 || x >= this.width || y >= this.height) {\n        console.warn(\n          'The x and y values passed to p5.Framebuffer.get are outside of its range and will be clamped.'\n        );\n        x = constrain(x, 0, this.width - 1);\n        y = constrain(y, 0, this.height - 1);\n      }\n\n      return readPixelWebGL(\n        this.gl,\n        this.framebuffer,\n        x * this.density,\n        y * this.density,\n        colorFormat.format,\n        colorFormat.type\n      );\n    }\n\n    x = constrain(x, 0, this.width - 1);\n    y = constrain(y, 0, this.height - 1);\n    w = constrain(w, 1, this.width - x);\n    h = constrain(h, 1, this.height - y);\n\n    const rawData = readPixelsWebGL(\n      undefined,\n      this.gl,\n      this.framebuffer,\n      x * this.density,\n      y * this.density,\n      w * this.density,\n      h * this.density,\n      colorFormat.format,\n      colorFormat.type\n    );\n    // Framebuffer data might be either a Uint8Array or Float32Array\n    // depending on its format, and it may or may not have an alpha channel.\n    // To turn it into an image, we have to normalize the data into a\n    // Uint8ClampedArray with alpha.\n    const fullData = new Uint8ClampedArray(\n      w * h * this.density * this.density * 4\n    );\n\n    // Default channels that aren't in the framebuffer (e.g. alpha, if the\n    // framebuffer is in RGB mode instead of RGBA) to 255\n    fullData.fill(255);\n\n    const channels = colorFormat.type === this.gl.RGB ? 3 : 4;\n    for (let y = 0; y < h * this.density; y++) {\n      for (let x = 0; x < w * this.density; x++) {\n        for (let channel = 0; channel < 4; channel++) {\n          const idx = (y * w * this.density + x) * 4 + channel;\n          if (channel < channels) {\n            // Find the index of this pixel in `rawData`, which might have a\n            // different number of channels\n            const rawDataIdx = channels === 4\n              ? idx\n              : (y * w * this.density + x) * channels + channel;\n            fullData[idx] = rawData[rawDataIdx];\n          }\n        }\n      }\n    }\n\n    // Create an image from the data\n    const region = new Image(w * this.density, h * this.density);\n    region.imageData = region.canvas.getContext('2d').createImageData(\n      region.width,\n      region.height\n    );\n    region.imageData.data.set(fullData);\n    region.pixels = region.imageData.data;\n    region.updatePixels();\n    if (this.density !== 1) {\n      // TODO: support get() at a pixel density > 1\n      region.resize(w, h);\n    }\n    return region;\n  }\n\n  /**\n   * Updates the framebuffer with the RGBA values in the\n   * <a href=\"#/p5.Framebuffer/pixels\">pixels</a> array.\n   *\n   * `myBuffer.updatePixels()` only needs to be called after changing values\n   * in the <a href=\"#/p5.Framebuffer/pixels\">myBuffer.pixels</a> array. Such\n   * changes can be made directly after calling\n   * <a href=\"#/p5.Framebuffer/loadPixels\">myBuffer.loadPixels()</a>.\n   *\n   * @method updatePixels\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   let myBuffer = createFramebuffer();\n   *\n   *   // Load the pixels array.\n   *   myBuffer.loadPixels();\n   *\n   *   // Get the number of pixels in the\n   *   // top half of the framebuffer.\n   *   let numPixels = myBuffer.pixels.length / 2;\n   *\n   *   // Set the framebuffer's top half to pink.\n   *   for (let i = 0; i < numPixels; i += 4) {\n   *     myBuffer.pixels[i] = 255;\n   *     myBuffer.pixels[i + 1] = 102;\n   *     myBuffer.pixels[i + 2] = 204;\n   *     myBuffer.pixels[i + 3] = 255;\n   *   }\n   *\n   *   // Update the pixels array.\n   *   myBuffer.updatePixels();\n   *\n   *   // Draw the p5.Framebuffer object to the canvas.\n   *   image(myBuffer, -50, -50);\n   *\n   *   describe('A pink rectangle above a gray rectangle.');\n   * }\n   * </code>\n   * </div>\n   */\n  updatePixels() {\n    const gl = this.gl;\n    this.colorP5Texture.bindTexture();\n    const colorFormat = this._glColorFormat();\n\n    const channels = colorFormat.format === gl.RGBA ? 4 : 3;\n    const len =\n      this.width * this.height * this.density * this.density * channels;\n    const TypedArrayClass = colorFormat.type === gl.UNSIGNED_BYTE\n      ? Uint8Array\n      : Float32Array;\n    if (\n      !(this.pixels instanceof TypedArrayClass) || this.pixels.length !== len\n    ) {\n      throw new Error(\n        'The pixels array has not been set correctly. Please call loadPixels() before updatePixels().'\n      );\n    }\n\n    gl.texImage2D(\n      gl.TEXTURE_2D,\n      0,\n      colorFormat.internalFormat,\n      this.width * this.density,\n      this.height * this.density,\n      0,\n      colorFormat.format,\n      colorFormat.type,\n      this.pixels\n    );\n    this.colorP5Texture.unbindTexture();\n    this.dirty.colorTexture = false;\n\n    const prevFramebuffer = this.renderer.activeFramebuffer();\n    if (this.antialias) {\n      // We need to make sure the antialiased framebuffer also has the updated\n      // pixels so that if more is drawn to it, it goes on top of the updated\n      // pixels instead of replacing them.\n      // We can't blit the framebuffer to the multisampled antialias\n      // framebuffer to leave both in the same state, so instead we have\n      // to use image() to put the framebuffer texture onto the antialiased\n      // framebuffer.\n      this.begin();\n      this.renderer.push();\n      // this.renderer.imageMode(constants.CENTER);\n      this.renderer.states.setValue('imageMode', CORNER);\n      this.renderer.setCamera(this.filterCamera);\n      this.renderer.resetMatrix();\n      this.renderer.states.setValue('strokeColor', null);\n      this.renderer.clear();\n      this.renderer._drawingFilter = true;\n      this.renderer.image(\n        this,\n        0, 0,\n        this.width, this.height,\n        -this.renderer.width / 2, -this.renderer.height / 2,\n        this.renderer.width, this.renderer.height\n      );\n      this.renderer._drawingFilter = false;\n      this.renderer.pop();\n      if (this.useDepth) {\n        gl.clearDepth(1);\n        gl.clear(gl.DEPTH_BUFFER_BIT);\n      }\n      this.end();\n    } else {\n      gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n      if (this.useDepth) {\n        gl.clearDepth(1);\n        gl.clear(gl.DEPTH_BUFFER_BIT);\n      }\n      if (prevFramebuffer) {\n        gl.bindFramebuffer(\n          gl.FRAMEBUFFER,\n          prevFramebuffer._framebufferToBind()\n        );\n      } else {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n      }\n    }\n  }\n}\n\nfunction framebuffer(p5, fn){\n  /**\n   * A <a href=\"#/p5.Camera\">p5.Camera</a> attached to a\n   * <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a>.\n   *\n   * @class p5.FramebufferCamera\n   * @param {p5.Framebuffer} framebuffer The framebuffer this camera is\n   * attached to\n   * @private\n   */\n  p5.FramebufferCamera = FramebufferCamera;\n\n  /**\n   * A <a href=\"#/p5.Texture\">p5.Texture</a> corresponding to a property of a\n   * <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a>.\n   *\n   * @class p5.FramebufferTexture\n   * @param {p5.Framebuffer} framebuffer The framebuffer represented by this\n   * texture\n   * @param {String} property The property of the framebuffer represented by\n   * this texture, either `color` or `depth`\n   * @private\n   */\n  p5.FramebufferTexture = FramebufferTexture;\n\n  /**\n   * A class to describe a high-performance drawing surface for textures.\n   *\n   * Each `p5.Framebuffer` object provides a dedicated drawing surface called\n   * a *framebuffer*. They're similar to\n   * <a href=\"#/p5.Graphics\">p5.Graphics</a> objects but can run much faster.\n   * Performance is improved because the framebuffer shares the same WebGL\n   * context as the canvas used to create it.\n   *\n   * `p5.Framebuffer` objects have all the drawing features of the main\n   * canvas. Drawing instructions meant for the framebuffer must be placed\n   * between calls to\n   * <a href=\"#/p5.Framebuffer/begin\">myBuffer.begin()</a> and\n   * <a href=\"#/p5.Framebuffer/end\">myBuffer.end()</a>. The resulting image\n   * can be applied as a texture by passing the `p5.Framebuffer` object to the\n   * <a href=\"#/p5/texture\">texture()</a> function, as in `texture(myBuffer)`.\n   * It can also be displayed on the main canvas by passing it to the\n   * <a href=\"#/p5/image\">image()</a> function, as in `image(myBuffer, 0, 0)`.\n   *\n   * Note: <a href=\"#/p5/createFramebuffer\">createFramebuffer()</a> is the\n   * recommended way to create an instance of this class.\n   *\n   * @class p5.Framebuffer\n   * @param {p5.Graphics|p5} target sketch instance or\n   *                                <a href=\"#/p5.Graphics\">p5.Graphics</a>\n   *                                object.\n   * @param {Object} [settings] configuration options.\n   */\n  p5.Framebuffer = Framebuffer;\n\n  /**\n   * An object that stores the framebuffer's color data.\n   *\n   * Each framebuffer uses a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/WebGLTexture\" target=\"_blank\">WebGLTexture</a>\n   * object internally to store its color data. The `myBuffer.color` property\n   * makes it possible to pass this data directly to other functions. For\n   * example, calling `texture(myBuffer.color)` or\n   * `myShader.setUniform('colorTexture', myBuffer.color)`  may be helpful for\n   * advanced use cases.\n   *\n   * Note: By default, a framebuffer's y-coordinates are flipped compared to\n   * images and videos. It's easy to flip a framebuffer's y-coordinates as\n   * needed when applying it as a texture. For example, calling\n   * `plane(myBuffer.width, -myBuffer.height)` will flip the framebuffer.\n   *\n   * @property {p5.FramebufferTexture} color\n   * @for p5.Framebuffer\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   let myBuffer = createFramebuffer();\n   *\n   *   // Start drawing to the p5.Framebuffer object.\n   *   myBuffer.begin();\n   *\n   *   triangle(-25, 25, 0, -25, 25, 25);\n   *\n   *   // Stop drawing to the p5.Framebuffer object.\n   *   myBuffer.end();\n   *\n   *   // Use the p5.Framebuffer object's WebGLTexture.\n   *   texture(myBuffer.color);\n   *\n   *   // Style the plane.\n   *   noStroke();\n   *\n   *   // Draw the plane.\n   *   plane(myBuffer.width, myBuffer.height);\n   *\n   *   describe('A white triangle on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * An object that stores the framebuffer's depth data.\n   *\n   * Each framebuffer uses a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/WebGLTexture\" target=\"_blank\">WebGLTexture</a>\n   * object internally to store its depth data. The `myBuffer.depth` property\n   * makes it possible to pass this data directly to other functions. For\n   * example, calling `texture(myBuffer.depth)` or\n   * `myShader.setUniform('depthTexture', myBuffer.depth)`  may be helpful for\n   * advanced use cases.\n   *\n   * Note: By default, a framebuffer's y-coordinates are flipped compared to\n   * images and videos. It's easy to flip a framebuffer's y-coordinates as\n   * needed when applying it as a texture. For example, calling\n   * `plane(myBuffer.width, -myBuffer.height)` will flip the framebuffer.\n   *\n   * @property {p5.FramebufferTexture} depth\n   * @for p5.Framebuffer\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Note: A \"uniform\" is a global variable within a shader program.\n   *\n   * // Create a string with the vertex shader program.\n   * // The vertex shader is called for each vertex.\n   * let vertSrc = `\n   * precision highp float;\n   * attribute vec3 aPosition;\n   * attribute vec2 aTexCoord;\n   * uniform mat4 uModelViewMatrix;\n   * uniform mat4 uProjectionMatrix;\n   * varying vec2 vTexCoord;\n   *\n   * void main() {\n   *   vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);\n   *   gl_Position = uProjectionMatrix * viewModelPosition;\n   *   vTexCoord = aTexCoord;\n   * }\n   * `;\n   *\n   * // Create a string with the fragment shader program.\n   * // The fragment shader is called for each pixel.\n   * let fragSrc = `\n   * precision highp float;\n   * varying vec2 vTexCoord;\n   * uniform sampler2D depth;\n   *\n   * void main() {\n   *   // Get the pixel's depth value.\n   *   float depthVal = texture2D(depth, vTexCoord).r;\n   *\n   *   // Set the pixel's color based on its depth.\n   *   gl_FragColor = mix(\n   *     vec4(0., 0., 0., 1.),\n   *     vec4(1., 0., 1., 1.),\n   *     depthVal);\n   * }\n   * `;\n   *\n   * let myBuffer;\n   * let myShader;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   myBuffer = createFramebuffer();\n   *\n   *   // Create a p5.Shader object.\n   *   myShader = createShader(vertSrc, fragSrc);\n   *\n   *   // Compile and apply the shader.\n   *   shader(myShader);\n   *\n   *   describe('The shadow of a box rotates slowly against a magenta background.');\n   * }\n   *\n   * function draw() {\n   *   // Draw to the p5.Framebuffer object.\n   *   myBuffer.begin();\n   *   background(255);\n   *   rotateX(frameCount * 0.01);\n   *   box(20, 20, 80);\n   *   myBuffer.end();\n   *\n   *   // Set the shader's depth uniform using\n   *   // the framebuffer's depth texture.\n   *   myShader.setUniform('depth', myBuffer.depth);\n   *\n   *   // Style the plane.\n   *   noStroke();\n   *\n   *   // Draw the plane.\n   *   plane(myBuffer.width, myBuffer.height);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * An array containing the color of each pixel in the framebuffer.\n   *\n   * <a href=\"#/p5.Framebuffer/loadPixels\">myBuffer.loadPixels()</a> must be\n   * called before accessing the `myBuffer.pixels` array.\n   * <a href=\"#/p5.Framebuffer/updatePixels\">myBuffer.updatePixels()</a>\n   * must be called after any changes are made.\n   *\n   * Note: Updating pixels via this property is slower than drawing to the\n   * framebuffer directly. Consider using a\n   * <a href=\"#/p5.Shader\">p5.Shader</a> object instead of looping over\n   * `myBuffer.pixels`.\n   *\n   * @property {Number[]} pixels\n   * @for p5.Framebuffer\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   let myBuffer = createFramebuffer();\n   *\n   *   // Load the pixels array.\n   *   myBuffer.loadPixels();\n   *\n   *   // Get the number of pixels in the\n   *   // top half of the framebuffer.\n   *   let numPixels = myBuffer.pixels.length / 2;\n   *\n   *   // Set the framebuffer's top half to pink.\n   *   for (let i = 0; i < numPixels; i += 4) {\n   *     myBuffer.pixels[i] = 255;\n   *     myBuffer.pixels[i + 1] = 102;\n   *     myBuffer.pixels[i + 2] = 204;\n   *     myBuffer.pixels[i + 3] = 255;\n   *   }\n   *\n   *   // Update the pixels array.\n   *   myBuffer.updatePixels();\n   *\n   *   // Draw the p5.Framebuffer object to the canvas.\n   *   image(myBuffer, -50, -50);\n   *\n   *   describe('A pink rectangle above a gray rectangle.');\n   * }\n   * </code>\n   * </div>\n   */\n}\n\nif(typeof p5 !== 'undefined'){\n  framebuffer(p5, p5.prototype);\n}\n\n/**\n * @module Rendering\n * @submodule Rendering\n * @for p5\n */\n\n\nlet renderers;\nfunction rendering(p5, fn){\n  // Extend additional renderers object to p5 class, new renderer can be similarly attached\n  renderers = p5.renderers = {};\n\n  /**\n   * Creates a canvas element on the web page.\n   *\n   * `createCanvas()` creates the main drawing canvas for a sketch. It should\n   * only be called once at the beginning of <a href=\"#/p5/setup\">setup()</a>.\n   * Calling `createCanvas()` more than once causes unpredictable behavior.\n   *\n   * The first two parameters, `width` and `height`, are optional. They set the\n   * dimensions of the canvas and the values of the\n   * <a href=\"#/p5/width\">width</a> and <a href=\"#/p5/height\">height</a> system\n   * variables. For example, calling `createCanvas(900, 500)` creates a canvas\n   * that's 900500 pixels. By default, `width` and `height` are both 100.\n   *\n   * The third parameter is also optional. If either of the constants `P2D` or\n   * `WEBGL` is passed, as in `createCanvas(900, 500, WEBGL)`, then it will set\n   * the sketch's rendering mode. If an existing\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement\" target=\"_blank\">HTMLCanvasElement</a>\n   * is passed, as in `createCanvas(900, 500, myCanvas)`, then it will be used\n   * by the sketch.\n   *\n   * The fourth parameter is also optional. If an existing\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement\" target=\"_blank\">HTMLCanvasElement</a>\n   * is passed, as in `createCanvas(900, 500, WEBGL, myCanvas)`, then it will be\n   * used by the sketch.\n   *\n   * Note: In WebGL mode, the canvas will use a WebGL2 context if it's supported\n   * by the browser. Check the <a href=\"#/p5/webglVersion\">webglVersion</a>\n   * system variable to check what version is being used, or call\n   * `setAttributes({ version: 1 })` to create a WebGL1 context.\n   *\n   * @method createCanvas\n   * @param  {Number} [width] width of the canvas. Defaults to 100.\n   * @param  {Number} [height] height of the canvas. Defaults to 100.\n   * @param  {(P2D|WEBGL|P2DHDR)} [renderer] either P2D or WEBGL. Defaults to `P2D`.\n   * @param  {HTMLCanvasElement} [canvas] existing canvas element that should be used for the sketch.\n   * @return {p5.Renderer} new `p5.Renderer` that holds the canvas.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Draw a diagonal line.\n   *   line(0, 0, width, height);\n   *\n   *   describe('A diagonal line drawn from top-left to bottom-right on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 50);\n   *\n   *   background(200);\n   *\n   *   // Draw a diagonal line.\n   *   line(0, 0, width, height);\n   *\n   *   describe('A diagonal line drawn from top-left to bottom-right on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Use WebGL mode.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   background(200);\n   *\n   *   // Draw a diagonal line.\n   *   line(-width / 2, -height / 2, width / 2, height / 2);\n   *\n   *   describe('A diagonal line drawn from top-left to bottom-right on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create a p5.Render object.\n   *   let cnv = createCanvas(50, 50);\n   *\n   *   // Position the canvas.\n   *   cnv.position(10, 20);\n   *\n   *   background(200);\n   *\n   *   // Draw a diagonal line.\n   *   line(0, 0, width, height);\n   *\n   *   describe('A diagonal line drawn from top-left to bottom-right on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method createCanvas\n   * @param  {Number} [width]\n   * @param  {Number} [height]\n   * @param  {HTMLCanvasElement} [canvas]\n   * @return {p5.Renderer}\n   */\n  fn.createCanvas = function (w, h, renderer, ...args) {\n    // p5._validateParameters('createCanvas', arguments);\n    //optional: renderer, otherwise defaults to p2d\n\n    let selectedRenderer = P2D;\n    // Check third argument whether it is renderer constants\n    if(Reflect.ownKeys(renderers).includes(renderer)){\n      selectedRenderer = renderer;\n    }else {\n      args.unshift(renderer);\n    }\n\n    // Init our graphics renderer\n    if(this._renderer) this._renderer.remove();\n    this._renderer = new renderers[selectedRenderer](this, w, h, true, ...args);\n    this._defaultGraphicsCreated = true;\n    this._elements.push(this._renderer);\n    this._renderer._applyDefaults();\n\n    // Make the renderer own `pixels`\n    if (!Object.hasOwn(this, 'pixels')) {\n      Object.defineProperty(this, 'pixels', {\n        get(){\n          return this._renderer?.pixels;\n        }\n      });\n    }\n\n    return this._renderer;\n  };\n\n  /**\n   * Resizes the canvas to a given width and height.\n   *\n   * `resizeCanvas()` immediately clears the canvas and calls\n   * <a href=\"#/p5/redraw\">redraw()</a>. It's common to call `resizeCanvas()`\n   * within the body of <a href=\"#/p5/windowResized\">windowResized()</a> like\n   * so:\n   *\n   * ```js\n   * function windowResized() {\n   *   resizeCanvas(windowWidth, windowHeight);\n   * }\n   * ```\n   *\n   * The first two parameters, `width` and `height`, set the dimensions of the\n   * canvas. They also the values of the <a href=\"#/p5/width\">width</a> and\n   * <a href=\"#/p5/height\">height</a> system variables. For example, calling\n   * `resizeCanvas(300, 500)` resizes the canvas to 300500 pixels, then sets\n   * <a href=\"#/p5/width\">width</a> to 300 and\n   * <a href=\"#/p5/height\">height</a> 500.\n   *\n   * The third parameter, `noRedraw`, is optional. If `true` is passed, as in\n   * `resizeCanvas(300, 500, true)`, then the canvas will be canvas to 300500\n   * pixels but the <a href=\"#/p5/redraw\">redraw()</a> function won't be called\n   * immediately. By default, <a href=\"#/p5/redraw\">redraw()</a> is called\n   * immediately when `resizeCanvas()` finishes executing.\n   *\n   * @method resizeCanvas\n   * @param  {Number} width width of the canvas.\n   * @param  {Number} height height of the canvas.\n   * @param  {Boolean} [noRedraw] whether to delay calling\n   *                              <a href=\"#/p5/redraw\">redraw()</a>. Defaults\n   *                              to `false`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to resize the canvas.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A white circle drawn on a gray background. The canvas shrinks by half the first time the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a circle at the center of the canvas.\n   *   circle(width / 2, height / 2, 20);\n   * }\n   *\n   * // Resize the canvas when the user double-clicks.\n   * function doubleClicked() {\n   *   resizeCanvas(50, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Resize the web browser to change the canvas size.\n   *\n   * function setup() {\n   *   createCanvas(windowWidth, windowHeight);\n   *\n   *   describe('A white circle drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a circle at the center of the canvas.\n   *   circle(width / 2, height / 2, 20);\n   * }\n   *\n   * // Always resize the canvas to fill the browser window.\n   * function windowResized() {\n   *   resizeCanvas(windowWidth, windowHeight);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.resizeCanvas = function (w, h, noRedraw) {\n    // p5._validateParameters('resizeCanvas', arguments);\n    if (this._renderer) {\n      // Make sure width and height are updated before the renderer resizes so\n      // that framebuffers updated from the resize read the correct size\n      this._renderer.resize(w, h);\n\n      if (!noRedraw) {\n        this.redraw();\n      }\n    }\n    //accessible Outputs\n    if (this._addAccsOutput()) {\n      this._updateAccsOutput();\n    }\n  };\n\n  /**\n   * Removes the default canvas.\n   *\n   * By default, a 100100 pixels canvas is created without needing to call\n   * <a href=\"#/p5/createCanvas\">createCanvas()</a>. `noCanvas()` removes the\n   * default canvas for sketches that don't need it.\n   *\n   * @method noCanvas\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   noCanvas();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noCanvas = function () {\n    if (this.canvas) {\n      this.canvas.parentNode.removeChild(this.canvas);\n    }\n  };\n\n  /**\n   * Creates a <a href=\"#/p5.Graphics\">p5.Graphics</a> object.\n   *\n   * `createGraphics()` creates an offscreen drawing canvas (graphics buffer)\n   * and returns it as a <a href=\"#/p5.Graphics\">p5.Graphics</a> object. Drawing\n   * to a separate graphics buffer can be helpful for performance and for\n   * organizing code.\n   *\n   * The first two parameters, `width` and `height`, are optional. They set the\n   * dimensions of the <a href=\"#/p5.Graphics\">p5.Graphics</a> object. For\n   * example, calling `createGraphics(900, 500)` creates a graphics buffer\n   * that's 900500 pixels.\n   *\n   * The third parameter is also optional. If either of the constants `P2D` or\n   * `WEBGL` is passed, as in `createGraphics(900, 500, WEBGL)`, then it will set\n   * the <a href=\"#/p5.Graphics\">p5.Graphics</a> object's rendering mode. If an\n   * existing\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement\" target=\"_blank\">HTMLCanvasElement</a>\n   * is passed, as in `createGraphics(900, 500, myCanvas)`, then it will be used\n   * by the graphics buffer.\n   *\n   * The fourth parameter is also optional. If an existing\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement\" target=\"_blank\">HTMLCanvasElement</a>\n   * is passed, as in `createGraphics(900, 500, WEBGL, myCanvas)`, then it will be\n   * used by the graphics buffer.\n   *\n   * Note: In WebGL mode, the <a href=\"#/p5.Graphics\">p5.Graphics</a> object\n   * will use a WebGL2 context if it's supported by the browser. Check the\n   * <a href=\"#/p5/webglVersion\">webglVersion</a> system variable to check what\n   * version is being used, or call `setAttributes({ version: 1 })` to create a\n   * WebGL1 context.\n   *\n   * @method createGraphics\n   * @param  {Number} width width of the graphics buffer.\n   * @param  {Number} height height of the graphics buffer.\n   * @param  {(P2D|WEBGL)} [renderer] either P2D or WEBGL. Defaults to P2D.\n   * @param  {HTMLCanvasElement} [canvas] existing canvas element that should be\n   *                                      used for the graphics buffer..\n   * @return {p5.Graphics} new graphics buffer.\n   *\n   * @example\n   * <div>\n   * <code>\n   * //  Double-click to draw the contents of the graphics buffer.\n   *\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create the p5.Graphics object.\n   *   pg = createGraphics(50, 50);\n   *\n   *   // Draw to the graphics buffer.\n   *   pg.background(100);\n   *   pg.circle(pg.width / 2, pg.height / 2, 20);\n   *\n   *   describe('A gray square. A smaller, darker square with a white circle at its center appears when the user double-clicks.');\n   * }\n   *\n   * // Display the graphics buffer when the user double-clicks.\n   * function doubleClicked() {\n   *   if (mouseX > 0 && mouseX < 100 && mouseY > 0 && mouseY < 100) {\n   *     image(pg, 25, 25);\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * //  Double-click to draw the contents of the graphics buffer.\n   *\n   * let pg;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create the p5.Graphics object in WebGL mode.\n   *   pg = createGraphics(50, 50, WEBGL);\n   *\n   *   // Draw to the graphics buffer.\n   *   pg.background(100);\n   *   pg.lights();\n   *   pg.noStroke();\n   *   pg.rotateX(QUARTER_PI);\n   *   pg.rotateY(QUARTER_PI);\n   *   pg.torus(15, 5);\n   *\n   *   describe('A gray square. A smaller, darker square with a white torus at its center appears when the user double-clicks.');\n   * }\n   *\n   * // Display the graphics buffer when the user double-clicks.\n   * function doubleClicked() {\n   *   if (mouseX > 0 && mouseX < 100 && mouseY > 0 && mouseY < 100) {\n   *     image(pg, 25, 25);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method createGraphics\n   * @param  {Number} width\n   * @param  {Number} height\n   * @param  {HTMLCanvasElement} [canvas]\n   * @return {p5.Graphics}\n   */\n  fn.createGraphics = function (w, h, ...args) {\n    /**\n      * args[0] is expected to be renderer\n      * args[1] is expected to be canvas\n      */\n    if (args[0] instanceof HTMLCanvasElement) {\n      args[1] = args[0];\n      args[0] = P2D;\n    }\n    // p5._validateParameters('createGraphics', arguments);\n    return new p5.Graphics(w, h, args[0], this, args[1]);\n  };\n\n  /**\n   * Creates and a new <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object.\n   *\n   * <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> objects are separate drawing\n   * surfaces that can be used as textures in WebGL mode. They're similar to\n   * <a href=\"#/p5.Graphics\">p5.Graphics</a> objects and generally run much\n   * faster when used as textures.\n   *\n   * The parameter, `options`, is optional. An object can be passed to configure\n   * the <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object. The available\n   * properties are:\n   *\n   * - `format`: data format of the texture, either `UNSIGNED_BYTE`, `FLOAT`, or `HALF_FLOAT`. Default is `UNSIGNED_BYTE`.\n   * - `channels`: whether to store `RGB` or `RGBA` color channels. Default is to match the main canvas which is `RGBA`.\n   * - `depth`: whether to include a depth buffer. Default is `true`.\n   * - `depthFormat`: data format of depth information, either `UNSIGNED_INT` or `FLOAT`. Default is `FLOAT`.\n   * - `stencil`: whether to include a stencil buffer for masking. `depth` must be `true` for this feature to work. Defaults to the value of `depth` which is `true`.\n   * - `antialias`: whether to perform anti-aliasing. If set to `true`, as in `{ antialias: true }`, 2 samples will be used by default. The number of samples can also be set, as in `{ antialias: 4 }`. Default is to match <a href=\"#/p5/setAttributes\">setAttributes()</a> which is `false` (`true` in Safari).\n   * - `width`: width of the <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object. Default is to always match the main canvas width.\n   * - `height`: height of the <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object. Default is to always match the main canvas height.\n   * - `density`: pixel density of the <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object. Default is to always match the main canvas pixel density.\n   * - `textureFiltering`: how to read values from the <a href=\"#/p5.Framebuffer\">p5.Framebuffer</a> object. Either `LINEAR` (nearby pixels will be interpolated) or `NEAREST` (no interpolation). Generally, use `LINEAR` when using the texture as an image and `NEAREST` if reading the texture as data. Default is `LINEAR`.\n   *\n   * If the `width`, `height`, or `density` attributes are set, they won't automatically match the main canvas and must be changed manually.\n   *\n   * Note: `createFramebuffer()` can only be used in WebGL mode.\n   *\n   * @method createFramebuffer\n   * @param {Object} [options] configuration options.\n   * @return {p5.Framebuffer} new framebuffer.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myBuffer;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create a p5.Framebuffer object.\n   *   myBuffer = createFramebuffer();\n   *\n   *   describe('A grid of white toruses rotating against a dark gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Start drawing to the p5.Framebuffer object.\n   *   myBuffer.begin();\n   *\n   *   // Clear the drawing surface.\n   *   clear();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Rotate the coordinate system.\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Style the torus.\n   *   noStroke();\n   *\n   *   // Draw the torus.\n   *   torus(20);\n   *\n   *   // Stop drawing to the p5.Framebuffer object.\n   *   myBuffer.end();\n   *\n   *   // Iterate from left to right.\n   *   for (let x = -50; x < 50; x += 25) {\n   *     // Iterate from top to bottom.\n   *     for (let y = -50; y < 50; y += 25) {\n   *       // Draw the p5.Framebuffer object to the canvas.\n   *       image(myBuffer, x, y, 25, 25);\n   *     }\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myBuffer;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create an options object.\n   *   let options = { width: 25, height: 25 };\n   *\n   *   // Create a p5.Framebuffer object.\n   *   // Use options for configuration.\n   *   myBuffer = createFramebuffer(options);\n   *\n   *   describe('A grid of white toruses rotating against a dark gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Start drawing to the p5.Framebuffer object.\n   *   myBuffer.begin();\n   *\n   *   // Clear the drawing surface.\n   *   clear();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Rotate the coordinate system.\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *\n   *   // Style the torus.\n   *   noStroke();\n   *\n   *   // Draw the torus.\n   *   torus(5, 2.5);\n   *\n   *   // Stop drawing to the p5.Framebuffer object.\n   *   myBuffer.end();\n   *\n   *   // Iterate from left to right.\n   *   for (let x = -50; x < 50; x += 25) {\n   *     // Iterate from top to bottom.\n   *     for (let y = -50; y < 50; y += 25) {\n   *       // Draw the p5.Framebuffer object to the canvas.\n   *       image(myBuffer, x, y);\n   *     }\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createFramebuffer = function (options) {\n    return new Framebuffer(this._renderer, options);\n  };\n\n  /**\n   * Clears the depth buffer in WebGL mode.\n   *\n   * `clearDepth()` clears information about how far objects are from the camera\n   * in 3D space. This information is stored in an object called the\n   * *depth buffer*. Clearing the depth buffer ensures new objects aren't drawn\n   * behind old ones. Doing so can be useful for feedback effects in which the\n   * previous frame serves as the background for the current frame.\n   *\n   * The parameter, `depth`, is optional. If a number is passed, as in\n   * `clearDepth(0.5)`, it determines the range of objects to clear from the\n   * depth buffer. 0 doesn't clear any depth information, 0.5 clears depth\n   * information halfway between the near and far clipping planes, and 1 clears\n   * depth information all the way to the far clipping plane. By default,\n   * `depth` is 1.\n   *\n   * Note: `clearDepth()` can only be used in WebGL mode.\n   *\n   * @method clearDepth\n   * @param {Number} [depth] amount of the depth buffer to clear between 0\n   *                         (none) and 1 (far clipping plane). Defaults to 1.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let previous;\n   * let current;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the p5.Framebuffer objects.\n   *   previous = createFramebuffer({ format: FLOAT });\n   *   current = createFramebuffer({ format: FLOAT });\n   *\n   *   describe(\n   *     'A multicolor box drifts from side to side on a white background. It leaves a trail that fades over time.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   // Swap the previous p5.Framebuffer and the\n   *   // current one so it can be used as a texture.\n   *   [previous, current] = [current, previous];\n   *\n   *   // Start drawing to the current p5.Framebuffer.\n   *   current.begin();\n   *\n   *   // Paint the background.\n   *   background(255);\n   *\n   *   // Draw the previous p5.Framebuffer.\n   *   // Clear the depth buffer so the previous\n   *   // frame doesn't block the current one.\n   *   push();\n   *   tint(255, 250);\n   *   image(previous, -50, -50);\n   *   clearDepth();\n   *   pop();\n   *\n   *   // Draw the box on top of the previous frame.\n   *   push();\n   *   let x = 25 * sin(frameCount * 0.01);\n   *   let y = 25 * sin(frameCount * 0.02);\n   *   translate(x, y, 0);\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   normalMaterial();\n   *   box(12);\n   *   pop();\n   *\n   *   // Stop drawing to the current p5.Framebuffer.\n   *   current.end();\n   *\n   *   // Display the current p5.Framebuffer.\n   *   image(current, -50, -50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.clearDepth = function (depth) {\n    this._assert3d('clearDepth');\n    this._renderer.clearDepth(depth);\n  };\n\n  /**\n   * A system variable that provides direct access to the sketch's\n   * `&lt;canvas&gt;` element.\n   *\n   * The `&lt;canvas&gt;` element provides many specialized features that aren't\n   * included in the p5.js library. The `drawingContext` system variable\n   * provides access to these features by exposing the sketch's\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D\">CanvasRenderingContext2D</a>\n   * object.\n   *\n   * @property drawingContext\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the circle using shadows.\n   *   drawingContext.shadowOffsetX = 5;\n   *   drawingContext.shadowOffsetY = -5;\n   *   drawingContext.shadowBlur = 10;\n   *   drawingContext.shadowColor = 'black';\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, 40);\n   *\n   *   describe(\"A white circle on a gray background. The circle's edges are shadowy.\");\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background('skyblue');\n   *\n   *   // Style the circle using a color gradient.\n   *   let myGradient = drawingContext.createRadialGradient(50, 50, 3, 50, 50, 40);\n   *   myGradient.addColorStop(0, 'yellow');\n   *   myGradient.addColorStop(0.6, 'orangered');\n   *   myGradient.addColorStop(1, 'yellow');\n   *   drawingContext.fillStyle = myGradient;\n   *   drawingContext.strokeStyle = 'rgba(0, 0, 0, 0)';\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, 40);\n   *\n   *   describe('A fiery sun drawn on a light blue background.');\n   * }\n   * </code>\n   * </div>\n   */\n}\n\nif(typeof p5 !== 'undefined'){\n  rendering(p5, p5.prototype);\n}\n\nexport { readPixelsWebGL as A, readPixelWebGL as B, Camera as C, checkWebGLCapabilities as D, FramebufferCamera as E, FramebufferTexture as F, Graphics as G, Framebuffer as H, renderers as I, MipmapTexture as M, RendererGL as R, Shader as S, Texture as T, request as a, loadingDisplaying as b, camera as c, files as d, filterOpaqueFrag as e, framebuffer as f, filterPosterizeFrag as g, filterDilateFrag as h, image as i, filterGrayFrag as j, filterErodeFrag as k, light as l, material as m, filterThresholdFrag as n, filterInvertFrag as o, primitives3D as p, filterBlurFrag as q, rendererGL as r, shader as s, texture as t, filterBaseVert as u, filterBaseFrag as v, webgl2CompatibilityShader as w, filterShaderVert as x, rendering as y, graphics as z };\n","import { T as Texture, e as filterOpaqueFrag, g as filterPosterizeFrag, h as filterDilateFrag, j as filterGrayFrag, k as filterErodeFrag, n as filterThresholdFrag, o as filterInvertFrag, q as filterBlurFrag, S as Shader, w as webgl2CompatibilityShader, u as filterBaseVert, v as filterBaseFrag, x as filterShaderVert } from '../rendering-BELwvfI6.js';\nimport { I as Image } from '../p5.Renderer-DoDzbpcT.js';\nimport { z as WEBGL2, K as OPAQUE, U as POSTERIZE, V as DILATE, X as GRAY, Y as ERODE, Z as THRESHOLD, _ as INVERT, $ as BLUR, e as CORNER, u as BLEND, a0 as WEBGL } from '../constants-8IpwyBct.js';\nimport { filterParamDefaults } from './const.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../dom/p5.Element.js';\nimport '../dom/p5.File.js';\nimport '../io/p5.XML.js';\nimport '../dom/p5.MediaElement.js';\nimport '../shape/2d_primitives.js';\nimport '../core/helpers.js';\nimport '../shape/attributes.js';\nimport '../shape/curves.js';\nimport '../shape/vertex.js';\nimport '../color/setting.js';\nimport 'omggif';\nimport '../io/csv.js';\nimport '../io/utilities.js';\nimport 'file-saver';\nimport 'gifenc';\nimport './pixels.js';\nimport './filters.js';\nimport '../core/transform.js';\nimport '../webgl/GeometryBuilder.js';\nimport '../math/p5.Matrix.js';\nimport '../math/Matrices/Matrix.js';\nimport '../math/p5.Vector.js';\nimport '../math/Matrices/MatrixInterface.js';\nimport '../webgl/p5.Geometry.js';\nimport '../webgl/p5.DataArray.js';\nimport '../webgl/p5.Quat.js';\nimport '../webgl/p5.RenderBuffer.js';\nimport '../webgl/ShapeBuilder.js';\nimport 'libtess';\nimport '../webgl/GeometryBufferCache.js';\nimport '../shape/custom_shapes.js';\nimport '../math/trigonometry.js';\nimport '../core/States.js';\n\nclass FilterRenderer2D {\n  /**\n   * Creates a new FilterRenderer2D instance.\n   * @param {p5} pInst - The p5.js instance.\n   */\n  constructor(pInst) {\n    this.pInst = pInst;\n    // Create a canvas for applying WebGL-based filters\n    this.canvas = document.createElement('canvas');\n    this.canvas.width = pInst.width;\n    this.canvas.height = pInst.height;\n\n    // Initialize the WebGL context\n    let webglVersion = WEBGL2;\n    this.gl = this.canvas.getContext('webgl2');\n    if (!this.gl) {\n      webglVersion = WEBGL;\n      this.gl = this.canvas.getContext('webgl');\n    }\n    if (!this.gl) {\n      console.error(\"WebGL not supported, cannot apply filter.\");\n      return;\n    }\n    // Minimal renderer object required by p5.Shader and p5.Texture\n    this._renderer = {\n      GL: this.gl,\n      registerEnabled: new Set(),\n      _curShader: null,\n      _emptyTexture: null,\n      webglVersion,\n      states: {\n        textureWrapX: this.gl.CLAMP_TO_EDGE,\n        textureWrapY: this.gl.CLAMP_TO_EDGE,\n      },\n      _arraysEqual: (a, b) => JSON.stringify(a) === JSON.stringify(b),\n      _getEmptyTexture: () => {\n        if (!this._emptyTexture) {\n          const im = new Image(1, 1);\n          im.set(0, 0, 255);\n          this._emptyTexture = new Texture(this._renderer, im);\n        }\n        return this._emptyTexture;\n      },\n    };\n\n    this._baseFilterShader = undefined;\n\n    // Store the fragment shader sources\n    this.filterShaderSources = {\n      [BLUR]: filterBlurFrag,\n      [INVERT]: filterInvertFrag,\n      [THRESHOLD]: filterThresholdFrag,\n      [ERODE]: filterErodeFrag,\n      [GRAY]: filterGrayFrag,\n      [DILATE]: filterDilateFrag,\n      [POSTERIZE]: filterPosterizeFrag,\n      [OPAQUE]: filterOpaqueFrag,\n    };\n\n    // Store initialized shaders for each operation\n    this.filterShaders = {};\n\n    // These will be set by setOperation\n    this.operation = null;\n    this.filterParameter = 1;\n    this.customShader = null;\n    this._shader = null;\n\n    // Create buffers once\n    this.vertexBuffer = this.gl.createBuffer();\n    this.texcoordBuffer = this.gl.createBuffer();\n\n    // Set up the vertices and texture coordinates for a full-screen quad\n    this.vertices = new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]);\n    this.texcoords = new Float32Array([0, 1, 1, 1, 0, 0, 1, 0]);\n\n    // Upload vertex data once\n    this._bindBufferData(this.vertexBuffer, this.gl.ARRAY_BUFFER, this.vertices);\n\n    // Upload texcoord data once\n    this._bindBufferData(this.texcoordBuffer, this.gl.ARRAY_BUFFER, this.texcoords);\n  }\n\n  _webGL2CompatibilityPrefix(shaderType, floatPrecision) {\n    let code = \"\";\n    if (this._renderer.webglVersion === WEBGL2) {\n      code += \"#version 300 es\\n#define WEBGL2\\n\";\n    }\n    if (shaderType === \"vert\") {\n      code += \"#define VERTEX_SHADER\\n\";\n    } else if (shaderType === \"frag\") {\n      code += \"#define FRAGMENT_SHADER\\n\";\n    }\n    if (floatPrecision) {\n      code += `precision ${floatPrecision} float;\\n`;\n    }\n    return code;\n  }\n\n  baseFilterShader() {\n    if (!this._baseFilterShader) {\n      this._baseFilterShader = new Shader(\n        this._renderer,\n        this._webGL2CompatibilityPrefix(\"vert\", \"highp\") +\n          webgl2CompatibilityShader +\n          filterBaseVert,\n        this._webGL2CompatibilityPrefix(\"frag\", \"highp\") +\n          webgl2CompatibilityShader +\n          filterBaseFrag,\n        {\n            vertex: {},\n            fragment: {\n              \"vec4 getColor\": `(FilterInputs inputs, in sampler2D canvasContent) {\n                return getTexture(canvasContent, inputs.texCoord);\n              }`,\n            },\n          }\n      );\n    }\n    return this._baseFilterShader;\n  }\n\n  /**\n   * Set the current filter operation and parameter. If a customShader is provided,\n   * that overrides the operation-based shader.\n   * @param {String} operation - The filter operation type (e.g., constants.BLUR).\n   * @param {Number} filterParameter - The strength of the filter.\n   * @param {p5.Shader} customShader - Optional custom shader.\n   */\n  setOperation(operation, filterParameter, customShader = null) {\n    this.operation = operation;\n    this.filterParameter = filterParameter;\n\n    let useDefaultParam = operation in filterParamDefaults && filterParameter === undefined;\n    if (useDefaultParam) {\n      this.filterParameter = filterParamDefaults[operation];\n    }\n\n    this.customShader = customShader;\n    this._initializeShader();\n  }\n\n  /**\n   * Initializes or retrieves the shader program for the current operation.\n   * If a customShader is provided, that is used.\n   * Otherwise, returns a cached shader if available, or creates a new one, caches it, and sets it as current.\n   */\n  _initializeShader() {\n    if (this.customShader) {\n      this._shader = this.customShader;\n      return;\n    }\n\n    if (!this.operation) {\n      console.error(\"No operation set for FilterRenderer2D, cannot initialize shader.\");\n      return;\n    }\n\n    // If we already have a compiled shader for this operation, reuse it\n    if (this.filterShaders[this.operation]) {\n      this._shader = this.filterShaders[this.operation];\n      return;\n    }\n\n    const fragShaderSrc = this.filterShaderSources[this.operation];\n    if (!fragShaderSrc) {\n      console.error(\"No shader available for this operation:\", this.operation);\n      return;\n    }\n\n    // Create and store the new shader\n    const newShader = new Shader(this._renderer, filterShaderVert, fragShaderSrc);\n    this.filterShaders[this.operation] = newShader;\n    this._shader = newShader;\n  }\n\n  /**\n   * Binds a buffer to the drawing context\n   * when passed more than two arguments it also updates or initializes\n   * the data associated with the buffer\n   */\n  _bindBufferData(buffer, target, values) {\n    const gl = this.gl;\n    gl.bindBuffer(target, buffer);\n    gl.bufferData(target, values, gl.STATIC_DRAW);\n  }\n\n  get canvasTexture() {\n    if (!this._canvasTexture) {\n      this._canvasTexture = new Texture(this._renderer, this.pInst.wrappedElt);\n    }\n    return this._canvasTexture;\n  }\n\n  /**\n   * Prepares and runs the full-screen quad draw call.\n   */\n  _renderPass() {\n    const gl = this.gl;\n    this._shader.bindShader();\n    const pixelDensity = this.pInst.pixelDensity ? this.pInst.pixelDensity() : 1;\n\n    const texelSize = [\n      1 / (this.pInst.width * pixelDensity),\n      1 / (this.pInst.height * pixelDensity)\n    ];\n\n    const canvasTexture = this.canvasTexture;\n\n    // Set uniforms for the shader\n    this._shader.setUniform('tex0', canvasTexture);\n    this._shader.setUniform('texelSize', texelSize);\n    this._shader.setUniform('canvasSize', [this.pInst.width, this.pInst.height]);\n    this._shader.setUniform('radius', Math.max(1, this.filterParameter));\n    this._shader.setUniform('filterParameter', this.filterParameter);\n    this._shader.setDefaultUniforms();\n    \n    this.pInst.states.setValue('rectMode', CORNER);\n    this.pInst.states.setValue('imageMode', CORNER);\n    this.pInst.blendMode(BLEND);\n    this.pInst.resetMatrix();\n\n\n    const identityMatrix = [1, 0, 0, 0,\n                            0, 1, 0, 0,\n                            0, 0, 1, 0,\n                            0, 0, 0, 1];\n    this._shader.setUniform('uModelViewMatrix', identityMatrix);\n    this._shader.setUniform('uProjectionMatrix', identityMatrix);\n\n    // Bind and enable vertex attributes\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n    this._shader.enableAttrib(this._shader.attributes.aPosition, 2);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.texcoordBuffer);\n    this._shader.enableAttrib(this._shader.attributes.aTexCoord, 2);\n\n    this._shader.bindTextures();\n    this._shader.disableRemainingAttributes();\n\n    // Draw the quad\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    // Unbind the shader\n    this._shader.unbindShader();\n  }\n\n  /**\n   * Applies the current filter operation. If the filter requires multiple passes (e.g. blur),\n   * it handles those internally. Make sure setOperation() has been called before applyFilter().\n   */\n  applyFilter() {\n    if (!this._shader) {\n      console.error(\"Cannot apply filter: shader not initialized.\");\n      return;\n    }\n    this.pInst.push();\n    this.pInst.resetMatrix();\n    // For blur, we typically do two passes: one horizontal, one vertical.\n    if (this.operation === BLUR && !this.customShader) {\n      // Horizontal pass\n      this._shader.setUniform('direction', [1, 0]);\n      this._renderPass();\n\n      // Draw the result onto itself\n      this.pInst.clear();\n      this.pInst.drawingContext.drawImage(this.canvas, 0, 0, this.pInst.width, this.pInst.height);\n\n      // Vertical pass\n      this._shader.setUniform('direction', [0, 1]);\n      this._renderPass();\n\n      this.pInst.clear();\n      this.pInst.drawingContext.drawImage(this.canvas, 0, 0, this.pInst.width, this.pInst.height);\n    } else {\n      // Single-pass filters\n\n      this._renderPass();\n      this.pInst.clear();\n      // con\n      this.pInst.blendMode(BLEND);\n\n\n      this.pInst.drawingContext.drawImage(this.canvas, 0, 0, this.pInst.width, this.pInst.height);\n    }\n    this.pInst.pop();\n  }\n}\n\nexport { FilterRenderer2D as default };\n","import { P as P2D, a0 as WEBGL, u as BLEND, a2 as _DEFAULT_FILL, a3 as _DEFAULT_STROKE, j as ROUND, a4 as REMOVE, a5 as SUBTRACT, a6 as DARKEST, a7 as LIGHTEST, a8 as DIFFERENCE, a9 as MULTIPLY, aa as EXCLUSION, ab as SCREEN, ac as REPLACE, ad as OVERLAY, ae as HARD_LIGHT, af as SOFT_LIGHT, ag as DODGE, ah as BURN, ai as ADD, aj as PIE, ak as CHORD, f as TWO_PI, S as SQUARE, k as PROJECT, B as BEVEL, l as MITER, O as OPEN, v as constants, al as VERSION } from './constants-8IpwyBct.js';\nimport transform from './core/transform.js';\nimport structure from './core/structure.js';\nimport environment from './core/environment.js';\nimport { G as Graphics, y as rendering, z as graphics } from './rendering-BELwvfI6.js';\nimport { R as Renderer, I as Image, r as renderer } from './p5.Renderer-DoDzbpcT.js';\nimport { Element } from './dom/p5.Element.js';\nimport { MediaElement } from './dom/p5.MediaElement.js';\nimport { b as RGBHDR } from './creating_reading-BdolPjuO.js';\nimport FilterRenderer2D from './image/filterRenderer2D.js';\nimport './math/p5.Matrix.js';\nimport { PrimitiveToPath2DConverter } from './shape/custom_shapes.js';\nimport { Matrix } from './math/Matrices/Matrix.js';\n\nconst styleEmpty = 'rgba(0,0,0,0)';\n// const alphaThreshold = 0.00125; // minimum visible\n\nclass Renderer2D extends Renderer {\n  constructor(pInst, w, h, isMainCanvas, elt, attributes = {}) {\n    super(pInst, w, h, isMainCanvas);\n\n    this.canvas = this.elt = elt || document.createElement('canvas');\n\n    if (isMainCanvas) {\n      // for pixel method sharing with pimage\n      this._pInst._curElement = this;\n      this._pInst.canvas = this.canvas;\n    } else {\n      // hide if offscreen buffer by default\n      this.canvas.style.display = 'none';\n    }\n\n    this.elt.id = 'defaultCanvas0';\n    this.elt.classList.add('p5Canvas');\n\n    // Extend renderer with methods of p5.Element with getters\n    for (const p of Object.getOwnPropertyNames(Element.prototype)) {\n      if (p !== 'constructor' && p[0] !== '_') {\n        Object.defineProperty(this, p, {\n          get() {\n            return this.wrappedElt[p];\n          }\n        });\n      }\n    }\n\n    // Set canvas size\n    this.elt.width = w * this._pixelDensity;\n    this.elt.height = h * this._pixelDensity;\n    this.elt.style.width = `${w}px`;\n    this.elt.style.height = `${h}px`;\n\n    // Attach canvas element to DOM\n    if (this._pInst._userNode) {\n      // user input node case\n      this._pInst._userNode.appendChild(this.elt);\n    } else {\n      //create main element\n      if (document.getElementsByTagName('main').length === 0) {\n        let m = document.createElement('main');\n        document.body.appendChild(m);\n      }\n      //append canvas to main\n      document.getElementsByTagName('main')[0].appendChild(this.elt);\n    }\n\n    // Get and store drawing context\n    this.drawingContext = this.canvas.getContext('2d', attributes);\n    if(attributes.colorSpace === 'display-p3'){\n      this.states.colorMode = RGBHDR;\n    }\n    this.scale(this._pixelDensity, this._pixelDensity);\n\n    if(!this.filterRenderer){\n      this.filterRenderer = new FilterRenderer2D(this);\n    }\n    // Set and return p5.Element\n    this.wrappedElt = new Element(this.elt, this._pInst);\n    this.clipPath = null;\n  }\n\n  remove(){\n    this.wrappedElt.remove();\n    this.wrappedElt = null;\n    this.canvas = null;\n    this.elt = null;\n  }\n\n  getFilterGraphicsLayer() {\n    // create hidden webgl renderer if it doesn't exist\n    if (!this.filterGraphicsLayer) {\n      const pInst = this._pInst;\n\n      // create secondary layer\n      this.filterGraphicsLayer =\n        new Graphics(\n          this.width,\n          this.height,\n          WEBGL,\n          pInst\n        );\n    }\n    if (\n      this.filterGraphicsLayer.width !== this.width ||\n      this.filterGraphicsLayer.height !== this.height\n    ) {\n      // Resize the graphics layer\n      this.filterGraphicsLayer.resizeCanvas(this.width, this.height);\n    }\n    if (\n      this.filterGraphicsLayer.pixelDensity() !== this._pInst.pixelDensity()\n    ) {\n      this.filterGraphicsLayer.pixelDensity(this._pInst.pixelDensity());\n    }\n\n    return this.filterGraphicsLayer;\n  }\n\n  _applyDefaults() {\n    this.states.setValue('_cachedFillStyle', undefined);\n    this.states.setValue('_cachedStrokeStyle', undefined);\n    this._cachedBlendMode = BLEND;\n    this._setFill(_DEFAULT_FILL);\n    this._setStroke(_DEFAULT_STROKE);\n    this.drawingContext.lineCap = ROUND;\n    this.drawingContext.font = 'normal 12px sans-serif';\n  }\n\n  resize(w, h) {\n    super.resize(w, h);\n\n    // save canvas properties\n    const props = {};\n    for (const key in this.drawingContext) {\n      const val = this.drawingContext[key];\n      if (typeof val !== 'object' && typeof val !== 'function') {\n        props[key] = val;\n      }\n    }\n\n    this.canvas.width = w * this._pixelDensity;\n    this.canvas.height = h * this._pixelDensity;\n    this.canvas.style.width = `${w}px`;\n    this.canvas.style.height = `${h}px`;\n    this.drawingContext.scale(\n      this._pixelDensity,\n      this._pixelDensity\n    );\n\n    // reset canvas properties\n    for (const savedKey in props) {\n      try {\n        this.drawingContext[savedKey] = props[savedKey];\n      } catch (err) {\n        // ignore read-only property errors\n      }\n    }\n  }\n\n  //////////////////////////////////////////////\n  // COLOR | Setting\n  //////////////////////////////////////////////\n\n  background(...args) {\n    this.push();\n    this.resetMatrix();\n\n    if (args[0] instanceof Image) {\n      if (args[1] >= 0) {\n        // set transparency of background\n        const img = args[0];\n        this.drawingContext.globalAlpha = args[1] / 255;\n        this._pInst.image(img, 0, 0, this.width, this.height);\n      } else {\n        this._pInst.image(args[0], 0, 0, this.width, this.height);\n      }\n    } else {\n      // create background rect\n      const color = this._pInst.color(...args);\n\n      // Add accessible outputs if the method exists; on success, \n      // set the accessible output background to white.\n      if (this._pInst._addAccsOutput?.()) {\n        this._pInst._accsBackground?.(color._getRGBA([255, 255, 255, 255]));\n      }\n\n      const newFill = color.toString();\n      this._setFill(newFill);\n\n      if (this._isErasing) {\n        this.blendMode(this._cachedBlendMode);\n      }\n\n      this.drawingContext.fillRect(0, 0, this.width, this.height);\n\n      if (this._isErasing) {\n        this._pInst.erase();\n      }\n    }\n    this.pop();\n  }\n\n  clear() {\n    this.drawingContext.save();\n    this.resetMatrix();\n    this.drawingContext.clearRect(0, 0, this.width, this.height);\n    this.drawingContext.restore();\n  }\n\n  fill(...args) {\n    super.fill(...args);\n    const color = this.states.fillColor;\n    this._setFill(color.toString());\n\n      // Add accessible outputs if the method exists; on success, \n      // set the accessible output background to white.\n    if (this._pInst._addAccsOutput?.()) {\n      this._pInst._accsCanvasColors?.('fill', color._getRGBA([255, 255, 255, 255]));\n    }\n  }\n\n  stroke(...args) {\n    super.stroke(...args);\n    const color = this.states.strokeColor;\n    this._setStroke(color.toString());\n\n      // Add accessible outputs if the method exists; on success, \n      // set the accessible output background to white.\n    if (this._pInst._addAccsOutput?.()) {\n      this._pInst._accsCanvasColors?.('stroke', color._getRGBA([255, 255, 255, 255]));\n    }\n  }\n\n  erase(opacityFill, opacityStroke) {\n    if (!this._isErasing) {\n      // cache the fill style\n      this.states.setValue('_cachedFillStyle', this.drawingContext.fillStyle);\n      const newFill = this._pInst.color(255, opacityFill).toString();\n      this.drawingContext.fillStyle = newFill;\n\n      // cache the stroke style\n      this.states.setValue('_cachedStrokeStyle', this.drawingContext.strokeStyle);\n      const newStroke = this._pInst.color(255, opacityStroke).toString();\n      this.drawingContext.strokeStyle = newStroke;\n\n      // cache blendMode\n      const tempBlendMode = this._cachedBlendMode;\n      this.blendMode(REMOVE);\n      this._cachedBlendMode = tempBlendMode;\n\n      this._isErasing = true;\n    }\n  }\n\n  noErase() {\n    if (this._isErasing) {\n      this.drawingContext.fillStyle = this.states._cachedFillStyle;\n      this.drawingContext.strokeStyle = this.states._cachedStrokeStyle;\n\n      this.blendMode(this._cachedBlendMode);\n      this._isErasing = false;\n    }\n  }\n\n  drawShape(shape) {\n    const visitor = new PrimitiveToPath2DConverter({ strokeWeight: this.states.strokeWeight });\n    shape.accept(visitor);\n    if (this._clipping) {\n      this.clipPath.addPath(visitor.path);\n      this.clipPath.closePath();\n    } else {\n      if (this.states.fillColor) {\n        this.drawingContext.fill(visitor.path);\n      }\n      if (this.states.strokeColor) {\n        this.drawingContext.stroke(visitor.path);\n      }\n    }\n  }\n\n  beginClip(options = {}) {\n    super.beginClip(options);\n\n    // cache the fill style\n    this.states.setValue('_cachedFillStyle', this.drawingContext.fillStyle);\n    const newFill = this._pInst.color(255, 0).toString();\n    this.drawingContext.fillStyle = newFill;\n\n    // cache the stroke style\n    this.states.setValue('_cachedStrokeStyle', this.drawingContext.strokeStyle);\n    const newStroke = this._pInst.color(255, 0).toString();\n    this.drawingContext.strokeStyle = newStroke;\n\n    // cache blendMode\n    const tempBlendMode = this._cachedBlendMode;\n    this.blendMode(BLEND);\n    this._cachedBlendMode = tempBlendMode;\n\n    // Since everything must be in one path, create a new single Path2D to chain all shapes onto.\n    // Start a new path. Everything from here on out should become part of this\n    // one path so that we can clip to the whole thing.\n    this.clipPath = new Path2D();\n\n    if (this._clipInvert) {\n      // Slight hack: draw a big rectangle over everything with reverse winding\n      // order. This is hopefully large enough to cover most things.\n      this.clipPath.moveTo(\n        -2 * this.width,\n        -2 * this.height\n      );\n      this.clipPath.lineTo(\n        -2 * this.width,\n        2 * this.height\n      );\n      this.clipPath.lineTo(\n        2 * this.width,\n        2 * this.height\n      );\n      this.clipPath.lineTo(\n        2 * this.width,\n        -2 * this.height\n      );\n      this.clipPath.closePath();\n    }\n  }\n\n  endClip() {\n    this.drawingContext.clip(this.clipPath);\n    this.clipPath = null;\n\n    super.endClip();\n\n    this.drawingContext.fillStyle = this.states._cachedFillStyle;\n    this.drawingContext.strokeStyle = this.states._cachedStrokeStyle;\n\n    this.blendMode(this._cachedBlendMode);\n  }\n\n  //////////////////////////////////////////////\n  // IMAGE | Loading & Displaying\n  //////////////////////////////////////////////\n\n  image(\n    img,\n    sx,\n    sy,\n    sWidth,\n    sHeight,\n    dx,\n    dy,\n    dWidth,\n    dHeight\n  ) {\n    let cnv;\n    if (img.gifProperties) {\n      img._animateGif(this._pInst);\n    }\n\n    try {\n      if (img instanceof MediaElement) {\n        img._ensureCanvas();\n      }\n      if (this.states.tint && img.canvas) {\n        cnv = this._getTintedImageCanvas(img);\n      }\n      if (!cnv) {\n        cnv = img.canvas || img.elt;\n      }\n      let s = 1;\n      if (img.width && img.width > 0) {\n        s = cnv.width / img.width;\n      }\n      if (this._isErasing) {\n        this.blendMode(this._cachedBlendMode);\n      }\n\n      this.drawingContext.drawImage(\n        cnv,\n        s * sx,\n        s * sy,\n        s * sWidth,\n        s * sHeight,\n        dx,\n        dy,\n        dWidth,\n        dHeight\n      );\n      if (this._isErasing) {\n        this._pInst.erase();\n      }\n    } catch (e) {\n      if (e.name !== 'NS_ERROR_NOT_AVAILABLE') {\n        throw e;\n      }\n    }\n  }\n\n  _getTintedImageCanvas(img) {\n    if (!img.canvas) {\n      return img;\n    }\n\n    if (!img.tintCanvas) {\n      // Once an image has been tinted, keep its tint canvas\n      // around so we don't need to re-incur the cost of\n      // creating a new one for each tint\n      img.tintCanvas = document.createElement('canvas');\n    }\n\n    // Keep the size of the tint canvas up-to-date\n    if (img.tintCanvas.width !== img.canvas.width) {\n      img.tintCanvas.width = img.canvas.width;\n    }\n    if (img.tintCanvas.height !== img.canvas.height) {\n      img.tintCanvas.height = img.canvas.height;\n    }\n\n    // Goal: multiply the r,g,b,a values of the source by\n    // the r,g,b,a values of the tint color\n    const ctx = img.tintCanvas.getContext('2d');\n\n    ctx.save();\n    ctx.clearRect(0, 0, img.canvas.width, img.canvas.height);\n\n    if (this.states.tint[0] < 255 || this.states.tint[1] < 255 || this.states.tint[2] < 255) {\n      // Color tint: we need to use the multiply blend mode to change the colors.\n      // However, the canvas implementation of this destroys the alpha channel of\n      // the image. To accommodate, we first get a version of the image with full\n      // opacity everywhere, tint using multiply, and then use the destination-in\n      // blend mode to restore the alpha channel again.\n\n      // Start with the original image\n      ctx.drawImage(img.canvas, 0, 0);\n\n      // This blend mode makes everything opaque but forces the luma to match\n      // the original image again\n      ctx.globalCompositeOperation = 'luminosity';\n      ctx.drawImage(img.canvas, 0, 0);\n\n      // This blend mode forces the hue and chroma to match the original image.\n      // After this we should have the original again, but with full opacity.\n      ctx.globalCompositeOperation = 'color';\n      ctx.drawImage(img.canvas, 0, 0);\n\n      // Apply color tint\n      ctx.globalCompositeOperation = 'multiply';\n      ctx.fillStyle = `rgb(${this.states.tint.slice(0, 3).join(', ')})`;\n      ctx.fillRect(0, 0, img.canvas.width, img.canvas.height);\n\n      // Replace the alpha channel with the original alpha * the alpha tint\n      ctx.globalCompositeOperation = 'destination-in';\n      ctx.globalAlpha = this.states.tint[3] / 255;\n      ctx.drawImage(img.canvas, 0, 0);\n    } else {\n      // If we only need to change the alpha, we can skip all the extra work!\n      ctx.globalAlpha = this.states.tint[3] / 255;\n      ctx.drawImage(img.canvas, 0, 0);\n    }\n\n    ctx.restore();\n    return img.tintCanvas;\n  }\n\n  //////////////////////////////////////////////\n  // IMAGE | Pixels\n  //////////////////////////////////////////////\n\n  blendMode(mode) {\n    if (mode === SUBTRACT) {\n      console.warn('blendMode(SUBTRACT) only works in WEBGL mode.');\n    } else if (\n      mode === BLEND ||\n      mode === REMOVE ||\n      mode === DARKEST ||\n      mode === LIGHTEST ||\n      mode === DIFFERENCE ||\n      mode === MULTIPLY ||\n      mode === EXCLUSION ||\n      mode === SCREEN ||\n      mode === REPLACE ||\n      mode === OVERLAY ||\n      mode === HARD_LIGHT ||\n      mode === SOFT_LIGHT ||\n      mode === DODGE ||\n      mode === BURN ||\n      mode === ADD\n    ) {\n      this._cachedBlendMode = mode;\n      this.drawingContext.globalCompositeOperation = mode;\n    } else {\n      throw new Error(`Mode ${mode} not recognized.`);\n    }\n  }\n\n  blend(...args) {\n    const currBlend = this.drawingContext.globalCompositeOperation;\n    const blendMode = args[args.length - 1];\n\n    const copyArgs = Array.prototype.slice.call(args, 0, args.length - 1);\n\n    this.drawingContext.globalCompositeOperation = blendMode;\n\n    p5.prototype.copy.apply(this, copyArgs);\n\n    this.drawingContext.globalCompositeOperation = currBlend;\n  }\n\n  // p5.Renderer2D.prototype.get = p5.Renderer.prototype.get;\n  // .get() is not overridden\n\n  // x,y are canvas-relative (pre-scaled by _pixelDensity)\n  _getPixel(x, y) {\n    let imageData, index;\n    imageData = this.drawingContext.getImageData(x, y, 1, 1).data;\n    index = 0;\n    return [\n      imageData[index + 0],\n      imageData[index + 1],\n      imageData[index + 2],\n      imageData[index + 3]\n    ];\n  }\n\n  loadPixels() {\n    const pd = this._pixelDensity;\n    const w = this.width * pd;\n    const h = this.height * pd;\n    const imageData = this.drawingContext.getImageData(0, 0, w, h);\n    // @todo this should actually set pixels per object, so diff buffers can\n    // have diff pixel arrays.\n    this.imageData = imageData;\n    this.pixels = imageData.data;\n  }\n\n  set(x, y, imgOrCol) {\n    // round down to get integer numbers\n    x = Math.floor(x);\n    y = Math.floor(y);\n    if (imgOrCol instanceof Image) {\n      this.drawingContext.save();\n      this.drawingContext.setTransform(1, 0, 0, 1, 0, 0);\n      this.drawingContext.scale(\n        this._pixelDensity,\n        this._pixelDensity\n      );\n      this.drawingContext.clearRect(x, y, imgOrCol.width, imgOrCol.height);\n      this.drawingContext.drawImage(imgOrCol.canvas, x, y);\n      this.drawingContext.restore();\n    } else {\n      let r = 0,\n        g = 0,\n        b = 0,\n        a = 0;\n      let idx =\n        4 *\n        (y *\n          this._pixelDensity *\n          (this.width * this._pixelDensity) +\n          x * this._pixelDensity);\n      if (!this.imageData) {\n        this.loadPixels();\n      }\n      if (typeof imgOrCol === 'number') {\n        if (idx < this.pixels.length) {\n          r = imgOrCol;\n          g = imgOrCol;\n          b = imgOrCol;\n          a = 255;\n          //this.updatePixels.call(this);\n        }\n      } else if (Array.isArray(imgOrCol)) {\n        if (imgOrCol.length < 4) {\n          throw new Error('pixel array must be of the form [R, G, B, A]');\n        }\n        if (idx < this.pixels.length) {\n          r = imgOrCol[0];\n          g = imgOrCol[1];\n          b = imgOrCol[2];\n          a = imgOrCol[3];\n          //this.updatePixels.call(this);\n        }\n      } else if (imgOrCol instanceof p5.Color) {\n        if (idx < this.pixels.length) {\n          [r, g, b, a] = imgOrCol._getRGBA([255, 255, 255, 255]);\n          //this.updatePixels.call(this);\n        }\n      }\n      // loop over pixelDensity * pixelDensity\n      for (let i = 0; i < this._pixelDensity; i++) {\n        for (let j = 0; j < this._pixelDensity; j++) {\n          // loop over\n          idx =\n            4 *\n            ((y * this._pixelDensity + j) *\n              this.width *\n              this._pixelDensity +\n              (x * this._pixelDensity + i));\n          this.pixels[idx] = r;\n          this.pixels[idx + 1] = g;\n          this.pixels[idx + 2] = b;\n          this.pixels[idx + 3] = a;\n        }\n      }\n    }\n  }\n\n  updatePixels(x, y, w, h) {\n    const pd = this._pixelDensity;\n    if (\n      x === undefined &&\n      y === undefined &&\n      w === undefined &&\n      h === undefined\n    ) {\n      x = 0;\n      y = 0;\n      w = this.width;\n      h = this.height;\n    }\n    x *= pd;\n    y *= pd;\n    w *= pd;\n    h *= pd;\n\n    if (this.gifProperties) {\n      this.gifProperties.frames[this.gifProperties.displayIndex].image =\n        this.imageData;\n    }\n\n    this.drawingContext.putImageData(this.imageData, 0, 0, x, y, w, h);\n  }\n\n  //////////////////////////////////////////////\n  // SHAPE | 2D Primitives\n  //////////////////////////////////////////////\n\n  /*\n   * This function requires that:\n   *\n   *   0 <= start < TWO_PI\n   *\n   *   start <= stop < start + TWO_PI\n   */\n  arc(x, y, w, h, start, stop, mode) {\n    const ctx = this.clipPa || this.drawingContext;\n\n    const centerX = x + w / 2,\n      centerY = y + h / 2,\n      radiusX = w / 2,\n      radiusY = h / 2;\n\n    // Determines whether to add a line to the center, which should be done\n    // when the mode is PIE or default; as well as when the start and end\n    // angles do not form a full circle.\n    const createPieSlice = ! (\n      mode === CHORD ||\n      mode === OPEN ||\n      (stop - start) % TWO_PI === 0\n    );\n\n    // Fill curves\n    if (this.states.fillColor) {\n      if (!this._clipping) ctx.beginPath();\n      ctx.ellipse(centerX, centerY, radiusX, radiusY, 0, start, stop);\n      if (createPieSlice) ctx.lineTo(centerX, centerY);\n      ctx.closePath();\n      if (!this._clipping) ctx.fill();\n    }\n\n    // Stroke curves\n    if (this.states.strokeColor) {\n      if (!this._clipping) ctx.beginPath();\n      ctx.ellipse(centerX, centerY, radiusX, radiusY, 0, start, stop);\n\n      if (mode === PIE && createPieSlice) {\n        // In PIE mode, stroke is added to the center and back to path,\n        // unless the pie forms a complete ellipse (see: createPieSlice)\n        ctx.lineTo(centerX, centerY);\n      }\n\n      if (mode === PIE || mode === CHORD) {\n        // Stroke connects back to path begin for both PIE and CHORD\n        ctx.closePath();\n      }\n\n      if (!this._clipping) ctx.stroke();\n    }\n\n    return this;\n\n  }\n\n  ellipse(args) {\n    const ctx = this.clipPath || this.drawingContext;\n    const doFill = !!this.states.fillColor,\n      doStroke = this.states.strokeColor;\n    const x = parseFloat(args[0]),\n      y = parseFloat(args[1]),\n      w = parseFloat(args[2]),\n      h = parseFloat(args[3]);\n    if (doFill && !doStroke) {\n      if (this._getFill() === styleEmpty) {\n        return this;\n      }\n    } else if (!doFill && doStroke) {\n      if (this._getStroke() === styleEmpty) {\n        return this;\n      }\n    }\n    const centerX = x + w / 2,\n      centerY = y + h / 2,\n      radiusX = w / 2,\n      radiusY = h / 2;\n    if (!this._clipping) ctx.beginPath();\n\n    ctx.ellipse(centerX, centerY, radiusX, radiusY, 0, 0, 2 * Math.PI);\n    ctx.closePath();\n\n    if (!this._clipping && doFill) {\n      ctx.fill();\n    }\n    if (!this._clipping && doStroke) {\n      ctx.stroke();\n    }\n  }\n\n  line(x1, y1, x2, y2) {\n    const ctx = this.clipPath || this.drawingContext;\n    if (!this.states.strokeColor) {\n      return this;\n    } else if (this._getStroke() === styleEmpty) {\n      return this;\n    }\n    if (!this._clipping) ctx.beginPath();\n    ctx.moveTo(x1, y1);\n    ctx.lineTo(x2, y2);\n    ctx.stroke();\n    return this;\n  }\n\n  point(x, y) {\n    const ctx = this.clipPath || this.drawingContext;\n    if (!this.states.strokeColor) {\n      return this;\n    } else if (this._getStroke() === styleEmpty) {\n      return this;\n    }\n    const s = this._getStroke();\n    const f = this._getFill();\n    if (!this._clipping) {\n      // swapping fill color to stroke and back after for correct point rendering\n      this._setFill(s);\n    }\n    if (!this._clipping) ctx.beginPath();\n    ctx.arc(x, y, ctx.lineWidth / 2, 0, TWO_PI, false);\n    if (!this._clipping) {\n      ctx.fill();\n      this._setFill(f);\n    }\n  }\n\n  quad(x1, y1, x2, y2, x3, y3, x4, y4) {\n    const ctx = this.clipPath || this.drawingContext;\n    const doFill = !!this.states.fillColor,\n      doStroke = this.states.strokeColor;\n    if (doFill && !doStroke) {\n      if (this._getFill() === styleEmpty) {\n        return this;\n      }\n    } else if (!doFill && doStroke) {\n      if (this._getStroke() === styleEmpty) {\n        return this;\n      }\n    }\n    if (!this._clipping) ctx.beginPath();\n    ctx.moveTo(x1, y1);\n    ctx.lineTo(x2, y2);\n    ctx.lineTo(x3, y3);\n    ctx.lineTo(x4, y4);\n    ctx.closePath();\n    if (!this._clipping && doFill) {\n      ctx.fill();\n    }\n    if (!this._clipping && doStroke) {\n      ctx.stroke();\n    }\n    return this;\n  }\n\n  rect(args) {\n    const x = args[0];\n    const y = args[1];\n    const w = args[2];\n    const h = args[3];\n    let tl = args[4];\n    let tr = args[5];\n    let br = args[6];\n    let bl = args[7];\n    const ctx = this.clipPath || this.drawingContext;\n    const doFill = !!this.states.fillColor,\n      doStroke = this.states.strokeColor;\n    if (doFill && !doStroke) {\n      if (this._getFill() === styleEmpty) {\n        return this;\n      }\n    } else if (!doFill && doStroke) {\n      if (this._getStroke() === styleEmpty) {\n        return this;\n      }\n    }\n    if (!this._clipping) ctx.beginPath();\n\n    if (typeof tl === 'undefined') {\n      // No rounded corners\n      ctx.rect(x, y, w, h);\n    } else {\n      // At least one rounded corner\n      // Set defaults when not specified\n      if (typeof tr === 'undefined') {\n        tr = tl;\n      }\n      if (typeof br === 'undefined') {\n        br = tr;\n      }\n      if (typeof bl === 'undefined') {\n        bl = br;\n      }\n\n      // corner rounding must always be positive\n      const absW = Math.abs(w);\n      const absH = Math.abs(h);\n      const hw = absW / 2;\n      const hh = absH / 2;\n\n      // Clip radii\n      if (absW < 2 * tl) {\n        tl = hw;\n      }\n      if (absH < 2 * tl) {\n        tl = hh;\n      }\n      if (absW < 2 * tr) {\n        tr = hw;\n      }\n      if (absH < 2 * tr) {\n        tr = hh;\n      }\n      if (absW < 2 * br) {\n        br = hw;\n      }\n      if (absH < 2 * br) {\n        br = hh;\n      }\n      if (absW < 2 * bl) {\n        bl = hw;\n      }\n      if (absH < 2 * bl) {\n        bl = hh;\n      }\n\n      ctx.roundRect(x, y, w, h, [tl, tr, br, bl]);\n    }\n    if (!this._clipping && this.states.fillColor) {\n      ctx.fill();\n    }\n    if (!this._clipping && this.states.strokeColor) {\n      ctx.stroke();\n    }\n    return this;\n  }\n\n\n  triangle(args) {\n    const ctx = this.clipPath || this.drawingContext;\n    const doFill = !!this.states.fillColor,\n      doStroke = this.states.strokeColor;\n    const x1 = args[0],\n      y1 = args[1];\n    const x2 = args[2],\n      y2 = args[3];\n    const x3 = args[4],\n      y3 = args[5];\n    if (doFill && !doStroke) {\n      if (this._getFill() === styleEmpty) {\n        return this;\n      }\n    } else if (!doFill && doStroke) {\n      if (this._getStroke() === styleEmpty) {\n        return this;\n      }\n    }\n    if (!this._clipping) ctx.beginPath();\n    ctx.moveTo(x1, y1);\n    ctx.lineTo(x2, y2);\n    ctx.lineTo(x3, y3);\n    ctx.closePath();\n    if (!this._clipping && doFill) {\n      ctx.fill();\n    }\n    if (!this._clipping && doStroke) {\n      ctx.stroke();\n    }\n  }\n\n  //////////////////////////////////////////////\n  // SHAPE | Attributes\n  //////////////////////////////////////////////\n\n  strokeCap(cap) {\n    if (\n      cap === ROUND ||\n      cap === SQUARE ||\n      cap === PROJECT\n    ) {\n      this.drawingContext.lineCap = cap;\n    }\n    return this;\n  }\n\n  strokeJoin(join) {\n    if (\n      join === ROUND ||\n      join === BEVEL ||\n      join === MITER\n    ) {\n      this.drawingContext.lineJoin = join;\n    }\n    return this;\n  }\n\n  strokeWeight(w) {\n    super.strokeWeight(w);\n    if (typeof w === 'undefined' || w === 0) {\n      // hack because lineWidth 0 doesn't work\n      this.drawingContext.lineWidth = 0.0001;\n    } else {\n      this.drawingContext.lineWidth = w;\n    }\n    return this;\n  }\n\n  _getFill() {\n    if (!this.states._cachedFillStyle) {\n      this.states.setValue('_cachedFillStyle', this.drawingContext.fillStyle);\n    }\n    return this.states._cachedFillStyle;\n  }\n\n  _setFill(fillStyle) {\n    if (fillStyle !== this.states._cachedFillStyle) {\n      this.drawingContext.fillStyle = fillStyle;\n      this.states.setValue('_cachedFillStyle', fillStyle);\n    }\n  }\n\n  _getStroke() {\n    if (!this.states._cachedStrokeStyle) {\n      this.states.setValue('_cachedStrokeStyle', this.drawingContext.strokeStyle);\n    }\n    return this.states._cachedStrokeStyle;\n  }\n\n  _setStroke(strokeStyle) {\n    if (strokeStyle !== this.states._cachedStrokeStyle) {\n      this.drawingContext.strokeStyle = strokeStyle;\n      this.states.setValue('_cachedStrokeStyle', strokeStyle);\n    }\n  }\n\n  //////////////////////////////////////////////\n  // TRANSFORM\n  //////////////////////////////////////////////\n\n  applyMatrix(a, b, c, d, e, f) {\n    this.drawingContext.transform(a, b, c, d, e, f);\n  }\n\n  getWorldToScreenMatrix() {\n    let domMatrix = new DOMMatrix()\n      .scale(1 / this._pixelDensity)\n      .multiply(this.drawingContext.getTransform());\n    return new Matrix(domMatrix.toFloat32Array());\n  }\n\n  resetMatrix() {\n    this.drawingContext.setTransform(1, 0, 0, 1, 0, 0);\n    this.drawingContext.scale(\n      this._pixelDensity,\n      this._pixelDensity\n    );\n    return this;\n  }\n\n  rotate(rad) {\n    this.drawingContext.rotate(rad);\n  }\n\n  scale(x, y) {\n    this.drawingContext.scale(x, y);\n    return this;\n  }\n\n  translate(x, y) {\n    // support passing a vector as the 1st parameter\n    if (x instanceof p5.Vector) {\n      y = x.y;\n      x = x.x;\n    }\n    this.drawingContext.translate(x, y);\n    return this;\n  }\n\n  //////////////////////////////////////////////\n  // TYPOGRAPHY (see src/type/textCore.js)\n  //////////////////////////////////////////////\n\n  //////////////////////////////////////////////\n  // STRUCTURE\n  //////////////////////////////////////////////\n\n  // a push() operation is in progress.\n  // the renderer should return a 'style' object that it wishes to\n  // store on the push stack.\n  // derived renderers should call the base class' push() method\n  // to fetch the base style object.\n  push() {\n    this.drawingContext.save();\n\n    // get the base renderer style\n    return super.push();\n  }\n\n  // a pop() operation is in progress\n  // the renderer is passed the 'style' object that it returned\n  // from its push() method.\n  // derived renderers should pass this object to their base\n  // class' pop method\n  pop(style) {\n    this.drawingContext.restore();\n\n    super.pop(style);\n  }\n}\n\nfunction renderer2D(p5, fn){\n  /**\n   * p5.Renderer2D\n   * The 2D graphics canvas renderer class.\n   * extends p5.Renderer\n   * @private\n   */\n  p5.Renderer2D = Renderer2D;\n  p5.renderers[P2D] = Renderer2D;\n  p5.renderers['p2d-hdr'] = new Proxy(Renderer2D, {\n    construct(target, [pInst, w, h, isMainCanvas, elt]){\n      return new target(pInst, w, h, isMainCanvas, elt, {colorSpace: \"display-p3\"})\n    }\n  });\n}\n\n/**\n * @module Structure\n * @submodule Structure\n * @for p5\n * @requires constants\n */\n\n\n/**\n * This is the p5 instance constructor.\n *\n * A p5 instance holds all the properties and methods related to\n * a p5 sketch.  It expects an incoming sketch closure and it can also\n * take an optional node parameter for attaching the generated p5 canvas\n * to a node.  The sketch closure takes the newly created p5 instance as\n * its sole argument and may optionally set an asynchronous function\n * using `async/await`, along with the standard <a href=\"#/p5/setup\">setup()</a>,\n *  and/or <a href=\"#/p5/setup\">setup()</a>, and/or <a href=\"#/p5/draw\">draw()</a>\n *  properties on it for running a sketch.\n *\n * A p5 sketch can run in \"global\" or \"instance\" mode:\n * \"global\"   - all properties and methods are attached to the window\n * \"instance\" - all properties and methods are bound to this p5 object\n *\n * @class p5\n * @param  {function(p5)}       sketch a closure that can set optional <a href=\"#/p5/preload\">preload()</a>,\n *                              <a href=\"#/p5/setup\">setup()</a>, and/or <a href=\"#/p5/draw\">draw()</a> properties on the\n *                              given p5 instance\n * @param  {HTMLElement}        [node] element to attach canvas to\n * @return {p5}                 a p5 instance\n */\nclass p5 {\n  static VERSION = VERSION;\n  // This is a pointer to our global mode p5 instance, if we're in\n  // global mode.\n  static instance = null;\n  static lifecycleHooks = {\n    presetup: [],\n    postsetup: [],\n    predraw: [],\n    postdraw: [],\n    remove: []\n  };\n\n  // FES stub\n  static _checkForUserDefinedFunctions = () => {};\n  static _friendlyFileLoadError = () => {};\n\n  constructor(sketch, node) {\n    //////////////////////////////////////////////\n    // PRIVATE p5 PROPERTIES AND METHODS\n    //////////////////////////////////////////////\n\n    this.hitCriticalError = false;\n    this._setupDone = false;\n    this._userNode = node;\n    this._curElement = null;\n    this._elements = [];\n    this._glAttributes = null;\n    this._requestAnimId = 0;\n    this._isGlobal = false;\n    this._loop = true;\n    this._startListener = null;\n    this._initializeInstanceVariables();\n    this._events = {\n      // keep track of user-events for unregistering later\n      pointerdown: null,\n      pointerup: null,\n      pointermove: null,\n      dragend: null,\n      dragover: null,\n      click: null,\n      dblclick: null,\n      mouseover: null,\n      mouseout: null,\n      keydown: null,\n      keyup: null,\n      keypress: null,\n      wheel: null,\n      resize: null,\n      blur: null\n    };\n    this._millisStart = -1;\n    this._recording = false;\n\n    // States used in the custom random generators\n    this._lcg_random_state = null; // NOTE: move to random.js\n    this._gaussian_previous = false; // NOTE: move to random.js\n\n    if (window.DeviceOrientationEvent) {\n      this._events.deviceorientation = null;\n    }\n    if (window.DeviceMotionEvent && !window._isNodeWebkit) {\n      this._events.devicemotion = null;\n    }\n\n    // ensure correct reporting of window dimensions\n    this._updateWindowSize();\n\n    const bindGlobal = (property) => {\n      Object.defineProperty(window, property, {\n        configurable: true,\n        enumerable: true,\n        get: () => {\n          if(typeof this[property] === 'function'){\n            return this[property].bind(this);\n          }else {\n            return this[property];\n          }\n        },\n        set: (newValue) => {\n          Object.defineProperty(window, property, {\n            configurable: true,\n            enumerable: true,\n            value: newValue,\n            writable: true\n          });\n          if (!p5.disableFriendlyErrors) {\n            console.log(`You just changed the value of \"${property}\", which was a p5 global value. This could cause problems later if you're not careful.`);\n          }\n        }\n      });\n    };\n    // If the user has created a global setup or draw function,\n    // assume \"global\" mode and make everything global (i.e. on the window)\n    if (!sketch) {\n      this._isGlobal = true;\n      if (window.hitCriticalError) {\n        return;\n      }\n      p5.instance = this;\n\n      // Loop through methods on the prototype and attach them to the window\n      // All methods and properties with name starting with '_' will be skipped\n      for (const p of Object.getOwnPropertyNames(p5.prototype)) {\n        if(p[0] === '_') continue;\n        bindGlobal(p);\n      }\n\n      const protectedProperties = ['constructor', 'length'];\n      // Attach its properties to the window\n      for (const p in this) {\n        if (this.hasOwnProperty(p)) {\n          if(p[0] === '_' || protectedProperties.includes(p)) continue;\n          bindGlobal(p);\n        }\n      }\n    } else {\n      // Else, the user has passed in a sketch closure that may set\n      // user-provided 'setup', 'draw', etc. properties on this instance of p5\n      sketch(this);\n\n      // Run a check to see if the user has misspelled 'setup', 'draw', etc\n      // detects capitalization mistakes only ( Setup, SETUP, MouseClicked, etc)\n      p5._checkForUserDefinedFunctions(this);\n    }\n\n    // Bind events to window (not using container div bc key events don't work)\n    for (const e in this._events) {\n      const f = this[`_on${e}`];\n      if (f) {\n        const m = f.bind(this);\n        window.addEventListener(e, m, { passive: false });\n        this._events[e] = m;\n      }\n    }\n\n    const focusHandler = () => {\n      this.focused = true;\n    };\n    const blurHandler = () => {\n      this.focused = false;\n    };\n    window.addEventListener('focus', focusHandler);\n    window.addEventListener('blur', blurHandler);\n    p5.lifecycleHooks.remove.push(function() {\n      window.removeEventListener('focus', focusHandler);\n      window.removeEventListener('blur', blurHandler);\n    });\n\n    // Initialization complete, start runtime\n    if (document.readyState === 'complete') {\n      this.#_start();\n    } else {\n      this._startListener = this.#_start.bind(this);\n      window.addEventListener('load', this._startListener, false);\n    }\n  }\n\n  get pixels(){\n    return this._renderer.pixels;\n  }\n\n  get drawingContext(){\n    return this._renderer.drawingContext;\n  }\n\n  static registerAddon(addon) {\n    const lifecycles = {};\n    addon(p5, p5.prototype, lifecycles);\n\n    const validLifecycles = Object.keys(p5.lifecycleHooks);\n    for(const name of validLifecycles){\n      if(typeof lifecycles[name] === 'function'){\n        p5.lifecycleHooks[name].push(lifecycles[name]);\n      }\n    }\n  }\n\n  async #_start() {\n    if (this.hitCriticalError) return;\n    // Find node if id given\n    if (this._userNode) {\n      if (typeof this._userNode === 'string') {\n        this._userNode = document.getElementById(this._userNode);\n      }\n    }\n\n    await this.#_setup();\n    if (this.hitCriticalError) return;\n    if (!this._recording) {\n      this._draw();\n    }\n  }\n\n  async #_setup() {\n    // Run `presetup` hooks\n    await this._runLifecycleHook('presetup');\n    if (this.hitCriticalError) return;\n\n    // Always create a default canvas.\n    // Later on if the user calls createCanvas, this default one\n    // will be replaced\n    this.createCanvas(\n      100,\n      100,\n      P2D\n    );\n\n    // Record the time when setup starts. millis() will start at 0 within\n    // setup, but this isn't documented, locked-in behavior yet.\n    this._millisStart = window.performance.now();\n\n    const context = this._isGlobal ? window : this;\n    if (typeof context.setup === 'function') {\n      await context.setup();\n    }\n    if (this.hitCriticalError) return;\n\n    // unhide any hidden canvases that were created\n    const canvases = document.getElementsByTagName('canvas');\n\n    // Apply touchAction = 'none' to canvases if pointer events exist\n    if (Object.keys(this._events).some(event => event.startsWith('pointer'))) {\n      for (const k of canvases) {\n        k.style.touchAction = 'none';\n      }\n    }\n\n\n    for (const k of canvases) {\n      if (k.dataset.hidden === 'true') {\n        k.style.visibility = '';\n        delete k.dataset.hidden;\n      }\n    }\n\n    this._lastTargetFrameTime = window.performance.now();\n    this._lastRealFrameTime = window.performance.now();\n    this._setupDone = true;\n    if (this._accessibleOutputs.grid || this._accessibleOutputs.text) {\n      this._updateAccsOutput();\n    }\n\n    // Run `postsetup` hooks\n    await this._runLifecycleHook('postsetup');\n\n    // Record the time when the draw loop starts so that millis() starts at 0\n    // when the draw loop begins.\n    this._millisStart = window.performance.now();\n  }\n\n  // While '#_draw' here is async, it is not awaited as 'requestAnimationFrame'\n  // does not await its callback. Thus it is not recommended for 'draw()` to be\n  // async and use await within as the next frame may start rendering before the\n  // current frame finish awaiting. The same goes for lifecycle hooks 'predraw'\n  // and 'postdraw'.\n  async _draw(requestAnimationFrameTimestamp) {\n    if (this.hitCriticalError) return;\n    const now = requestAnimationFrameTimestamp || window.performance.now();\n    const timeSinceLastFrame = now - this._lastTargetFrameTime;\n    const targetTimeBetweenFrames = 1000 / this._targetFrameRate;\n\n    // only draw if we really need to; don't overextend the browser.\n    // draw if we're within 5ms of when our next frame should paint\n    // (this will prevent us from giving up opportunities to draw\n    // again when it's really about time for us to do so). fixes an\n    // issue where the frameRate is too low if our refresh loop isn't\n    // in sync with the browser. note that we have to draw once even\n    // if looping is off, so we bypass the time delay if that\n    // is the case.\n    const epsilon = 5;\n    if (\n      !this._loop ||\n      timeSinceLastFrame >= targetTimeBetweenFrames - epsilon\n    ) {\n      //mandatory update values(matrixes and stack)\n      this.deltaTime = now - this._lastRealFrameTime;\n      this._frameRate = 1000.0 / this.deltaTime;\n      await this.redraw();\n      this._lastTargetFrameTime = Math.max(this._lastTargetFrameTime\n        + targetTimeBetweenFrames, now);\n      this._lastRealFrameTime = now;\n\n      // If the user is actually using mouse module, then update\n      // coordinates, otherwise skip. We can test this by simply\n      // checking if any of the mouse functions are available or not.\n      // NOTE : This reflects only in complete build or modular build.\n      if (typeof this._updateMouseCoords !== 'undefined') {\n        this._updateMouseCoords();\n\n        //reset delta values so they reset even if there is no mouse event to set them\n        // for example if the mouse is outside the screen\n        this.movedX = 0;\n        this.movedY = 0;\n      }\n    }\n\n    // get notified the next time the browser gives us\n    // an opportunity to draw.\n    if (this._loop) {\n      this._requestAnimId = window.requestAnimationFrame(\n        this._draw.bind(this)\n      );\n    }\n  }\n\n  /**\n   * Removes the sketch from the web page.\n   *\n   * Calling `remove()` stops the draw loop and removes any HTML elements\n   * created by the sketch, including the canvas. A new sketch can be\n   * created by using the <a href=\"#/p5/p5\">p5()</a> constructor, as in\n   * `new p5()`.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to remove the canvas.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A white circle on a gray background. The circle follows the mouse as the user moves. The sketch disappears when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   // Paint the background repeatedly.\n   *   background(200);\n   *\n   *   // Draw circles repeatedly.\n   *   circle(mouseX, mouseY, 40);\n   * }\n   *\n   * // Remove the sketch when the user double-clicks.\n   * function doubleClicked() {\n   *   remove();\n   * }\n   * </code>\n   * </div>\n   */\n  async remove() {\n    // Remove start listener to prevent orphan canvas being created\n    if(this._startListener){\n      window.removeEventListener('load', this._startListener, false);\n    }\n\n    if (this._curElement) {\n      // stop draw\n      this._loop = false;\n      if (this._requestAnimId) {\n        window.cancelAnimationFrame(this._requestAnimId);\n      }\n\n      // unregister events sketch-wide\n      for (const ev in this._events) {\n        window.removeEventListener(ev, this._events[ev]);\n      }\n\n      // remove DOM elements created by p5, and listeners\n      for (const e of this._elements) {\n        if (e.elt && e.elt.parentNode) {\n          e.elt.parentNode.removeChild(e.elt);\n        }\n        for (const elt_ev in e._events) {\n          e.elt.removeEventListener(elt_ev, e._events[elt_ev]);\n        }\n      }\n\n      // Run `remove` hooks\n      await this._runLifecycleHook('remove');\n    }\n\n    // remove window bound properties and methods\n    if (this._isGlobal) {\n      for (const p in p5.prototype) {\n        try {\n          delete window[p];\n        } catch (x) {\n          window[p] = undefined;\n        }\n      }\n      for (const p2 in this) {\n        if (this.hasOwnProperty(p2)) {\n          try {\n            delete window[p2];\n          } catch (x) {\n            window[p2] = undefined;\n          }\n        }\n      }\n      p5.instance = null;\n    }\n  }\n\n  async _runLifecycleHook(hookName) {\n    for(const hook of p5.lifecycleHooks[hookName]){\n      await hook.call(this);\n    }\n  }\n\n  _initializeInstanceVariables() {\n    this._accessibleOutputs = {\n      text: false,\n      grid: false,\n      textLabel: false,\n      gridLabel: false\n    };\n\n    this._styles = [];\n    this._downKeys = {}; //Holds the key codes of currently pressed keys\n    this._downKeyCodes = {};\n  }\n}\n\n// Attach constants to p5 prototype\nfor (const k in constants) {\n  p5.prototype[k] = constants[k];\n}\n\n//////////////////////////////////////////////\n// PUBLIC p5 PROPERTIES AND METHODS\n//////////////////////////////////////////////\n\n/**\n * A function that's called once when the sketch begins running.\n *\n * Declaring the function `setup()` sets a code block to run once\n * automatically when the sketch starts running. It's used to perform\n * setup tasks such as creating the canvas and initializing variables:\n *\n * ```js\n * function setup() {\n *   // Code to run once at the start of the sketch.\n * }\n * ```\n *\n * Code placed in `setup()` will run once before code placed in\n * <a href=\"#/p5/draw\">draw()</a> begins looping.\n * If `setup()` is declared `async` (e.g. `async function setup()`),\n * execution pauses at each `await` until its promise resolves.\n * For example, `font = await loadFont(...)` waits for the font asset\n * to load because `loadFont()` function returns a promise, and the await\n * keyword means the program will wait for the promise to resolve.\n * This ensures that all assets are fully loaded before the sketch continues.\n\n *\n * loading assets.\n *\n * Note: `setup()` doesnt have to be declared, but its common practice to do so.\n *\n * @method setup\n * @for p5\n *\n * @example\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // Draw the circle.\n *   circle(50, 50, 40);\n *\n *   describe('A white circle on a gray background.');\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   // Paint the background once.\n *   background(200);\n *\n *   describe(\n *     'A white circle on a gray background. The circle follows the mouse as the user moves, leaving a trail.'\n *   );\n * }\n *\n * function draw() {\n *   // Draw circles repeatedly.\n *   circle(mouseX, mouseY, 40);\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * let img;\n *\n * async function setup() {\n *   img = await loadImage('assets/bricks.jpg');\n *\n *   createCanvas(100, 100);\n *\n *   // Draw the image.\n *   image(img, 0, 0);\n *\n *   describe(\n *     'A white circle on a brick wall. The circle follows the mouse as the user moves, leaving a trail.'\n *   );\n * }\n *\n * function draw() {\n *   // Style the circle.\n *   noStroke();\n *\n *   // Draw the circle.\n *   circle(mouseX, mouseY, 10);\n * }\n * </code>\n * </div>\n */\n/**\n * A function that's called repeatedly while the sketch runs.\n *\n * Declaring the function `draw()` sets a code block to run repeatedly\n * once the sketch starts. Its used to create animations and respond to\n * user inputs:\n *\n * ```js\n * function draw() {\n *   // Code to run repeatedly.\n * }\n * ```\n *\n * This is often called the \"draw loop\" because p5.js calls the code in\n * `draw()` in a loop behind the scenes. By default, `draw()` tries to run\n * 60 times per second. The actual rate depends on many factors. The\n * drawing rate, called the \"frame rate\", can be controlled by calling\n * <a href=\"#/p5/frameRate\">frameRate()</a>. The number of times `draw()`\n * has run is stored in the system variable\n * <a href=\"#/p5/frameCount\">frameCount()</a>.\n *\n * Code placed within `draw()` begins looping after\n * <a href=\"#/p5/setup\">setup()</a> runs. `draw()` will run until the user\n * closes the sketch. `draw()` can be stopped by calling the\n * <a href=\"#/p5/noLoop\">noLoop()</a> function. `draw()` can be resumed by\n * calling the <a href=\"#/p5/loop\">loop()</a> function.\n *\n * @method draw\n * @for p5\n *\n * @example\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   // Paint the background once.\n *   background(200);\n *\n *   describe(\n *     'A white circle on a gray background. The circle follows the mouse as the user moves, leaving a trail.'\n *   );\n * }\n *\n * function draw() {\n *   // Draw circles repeatedly.\n *   circle(mouseX, mouseY, 40);\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   describe(\n *     'A white circle on a gray background. The circle follows the mouse as the user moves.'\n *   );\n * }\n *\n * function draw() {\n *   // Paint the background repeatedly.\n *   background(200);\n *\n *   // Draw circles repeatedly.\n *   circle(mouseX, mouseY, 40);\n * }\n * </code>\n * </div>\n *\n * <div>\n * <code>\n * // Double-click the canvas to change the circle's color.\n *\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   describe(\n *     'A white circle on a gray background. The circle follows the mouse as the user moves. The circle changes color to pink when the user double-clicks.'\n *   );\n * }\n *\n * function draw() {\n *   // Paint the background repeatedly.\n *   background(200);\n *\n *   // Draw circles repeatedly.\n *   circle(mouseX, mouseY, 40);\n * }\n *\n * // Change the fill color when the user double-clicks.\n * function doubleClicked() {\n *   fill('deeppink');\n * }\n * </code>\n * </div>\n */\n\n/**\n * Turns off the parts of the Friendly Error System (FES) that impact performance.\n *\n * The <a href=\"https://github.com/processing/p5.js/blob/main/contributor_docs/friendly_error_system.md\" target=\"_blank\">FES</a>\n * can cause sketches to draw slowly because it does extra work behind the\n * scenes. For example, the FES checks the arguments passed to functions,\n * which takes time to process. Disabling the FES can significantly improve\n * performance by turning off these checks.\n *\n * @property {Boolean} disableFriendlyErrors\n *\n * @example\n * <div>\n * <code>\n * // Disable the FES.\n * p5.disableFriendlyErrors = true;\n *\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // The circle() function requires three arguments. The\n *   // next line would normally display a friendly error that\n *   // points this out. Instead, nothing happens and it fails\n *   // silently.\n *   circle(50, 50);\n *\n *   describe('A gray square.');\n * }\n * </code>\n * </div>\n */\np5.disableFriendlyErrors = false;\n\np5.registerAddon(transform);\np5.registerAddon(structure);\np5.registerAddon(environment);\np5.registerAddon(rendering);\np5.registerAddon(renderer);\np5.registerAddon(renderer2D);\np5.registerAddon(graphics);\n\nexport { Renderer2D as R, p5 as p, renderer2D as r };\n","/**\n * @module Environment\n * @submodule Environment\n * @for p5\n * @requires core\n */\n\nfunction describe(p5, fn){\n  const descContainer = '_Description'; //Fallback container\n  const fallbackDescId = '_fallbackDesc'; //Fallback description\n  const fallbackTableId = '_fallbackTable'; //Fallback Table\n  const fallbackTableElId = '_fte_'; //Fallback Table Element\n  const labelContainer = '_Label'; //Label container\n  const labelDescId = '_labelDesc'; //Label description\n  const labelTableId = '_labelTable'; //Label Table\n  const labelTableElId = '_lte_'; //Label Table Element\n\n  /**\n   * Creates a screen reader-accessible description of the canvas.\n   *\n   * The first parameter, `text`, is the description of the canvas.\n   *\n   * The second parameter, `display`, is optional. It determines how the\n   * description is displayed. If `LABEL` is passed, as in\n   * `describe('A description.', LABEL)`, the description will be visible in\n   * a div element next to the canvas. If `FALLBACK` is passed, as in\n   * `describe('A description.', FALLBACK)`, the description will only be\n   * visible to screen readers. This is the default mode.\n   *\n   * Read\n   * <a href=\"/learn/accessible-labels.html\">Writing accessible canvas descriptions</a>\n   * to learn more about making sketches accessible.\n   *\n   * @method describe\n   * @param  {String} text        description of the canvas.\n   * @param  {(FALLBACK|LABEL)} [display] either LABEL or FALLBACK.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   background('pink');\n   *\n   *   // Draw a heart.\n   *   fill('red');\n   *   noStroke();\n   *   circle(67, 67, 20);\n   *   circle(83, 67, 20);\n   *   triangle(91, 73, 75, 95, 59, 73);\n   *\n   *   // Add a general description of the canvas.\n   *   describe('A pink square with a red heart in the bottom-right corner.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   background('pink');\n   *\n   *   // Draw a heart.\n   *   fill('red');\n   *   noStroke();\n   *   circle(67, 67, 20);\n   *   circle(83, 67, 20);\n   *   triangle(91, 73, 75, 95, 59, 73);\n   *\n   *   // Add a general description of the canvas\n   *   // and display it for debugging.\n   *   describe('A pink square with a red heart in the bottom-right corner.', LABEL);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * \n   * function setup(){\n   *  createCanvas(100, 100);\n   * };\n   * \n   * function draw() {\n   *   background(200);\n   *\n   *   // The expression\n   *   // frameCount % 100\n   *   // causes x to increase from 0\n   *   // to 99, then restart from 0.\n   *   let x = frameCount % 100;\n   *\n   *   // Draw the circle.\n   *   fill(0, 255, 0);\n   *   circle(x, 50, 40);\n   *\n   *   // Add a general description of the canvas.\n   *   describe(`A green circle at (${x}, 50) moves from left to right on a gray square.`);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * \n   * function setup(){\n   * createCanvas(100, 100);\n   * }\n   * \n   * function draw() {\n   *   background(200);\n   *\n   *   // The expression\n   *   // frameCount % 100\n   *   // causes x to increase from 0\n   *   // to 99, then restart from 0.\n   *   let x = frameCount % 100;\n   *\n   *   // Draw the circle.\n   *   fill(0, 255, 0);\n   *   circle(x, 50, 40);\n   *\n   *   // Add a general description of the canvas\n   *   // and display it for debugging.\n   *   describe(`A green circle at (${x}, 50) moves from left to right on a gray square.`, LABEL);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.describe = function(text, display) {\n    // p5._validateParameters('describe', arguments);\n    if (typeof text !== 'string') {\n      return;\n    }\n    const cnvId = this.canvas.id;\n    //calls function that adds punctuation for better screen reading\n    text = _descriptionText(text);\n    //if there is no dummyDOM\n    if (!this.dummyDOM) {\n      this.dummyDOM = document.getElementById(cnvId).parentNode;\n    }\n    if (!this.descriptions) {\n      this.descriptions = {};\n    }\n    //check if html structure for description is ready\n    if (this.descriptions.fallback) {\n      //check if text is different from current description\n      if (this.descriptions.fallback.innerHTML !== text) {\n        //update description\n        this.descriptions.fallback.innerHTML = text;\n      }\n    } else {\n      //create fallback html structure\n      this._describeHTML('fallback', text);\n    }\n    //if display is LABEL\n    if (display === this.LABEL) {\n      //check if html structure for label is ready\n      if (this.descriptions.label) {\n        //check if text is different from current label\n        if (this.descriptions.label.innerHTML !== text) {\n          //update label description\n          this.descriptions.label.innerHTML = text;\n        }\n      } else {\n        //create label html structure\n        this._describeHTML('label', text);\n      }\n    }\n  };\n\n  /**\n   * Creates a screen reader-accessible description of elements in the canvas.\n   *\n   * Elements are shapes or groups of shapes that create meaning together. For\n   * example, a few overlapping circles could make an \"eye\" element.\n   *\n   * The first parameter, `name`, is the name of the element.\n   *\n   * The second parameter, `text`, is the description of the element.\n   *\n   * The third parameter, `display`, is optional. It determines how the\n   * description is displayed. If `LABEL` is passed, as in\n   * `describe('A description.', LABEL)`, the description will be visible in\n   * a div element next to the canvas. Using `LABEL` creates unhelpful\n   * duplicates for screen readers. Only use `LABEL` during development. If\n   * `FALLBACK` is passed, as in `describe('A description.', FALLBACK)`, the\n   * description will only be visible to screen readers. This is the default\n   * mode.\n   *\n   * Read\n   * <a href=\"/learn/accessible-labels.html\">Writing accessible canvas descriptions</a>\n   * to learn more about making sketches accessible.\n   *\n   * @method describeElement\n   * @param  {String} name        name of the element.\n   * @param  {String} text        description of the element.\n   * @param  {(FALLBACK|LABEL)} [display] either LABEL or FALLBACK.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   background('pink');\n   *\n   *   // Describe the first element\n   *   // and draw it.\n   *   describeElement('Circle', 'A yellow circle in the top-left corner.');\n   *   noStroke();\n   *   fill('yellow');\n   *   circle(25, 25, 40);\n   *\n   *   // Describe the second element\n   *   // and draw it.\n   *   describeElement('Heart', 'A red heart in the bottom-right corner.');\n   *   fill('red');\n   *   circle(66.6, 66.6, 20);\n   *   circle(83.2, 66.6, 20);\n   *   triangle(91.2, 72.6, 75, 95, 58.6, 72.6);\n   *\n   *   // Add a general description of the canvas.\n   *   describe('A red heart and yellow circle over a pink background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   background('pink');\n   *\n   *   // Describe the first element\n   *   // and draw it. Display the\n   *   // description for debugging.\n   *   describeElement('Circle', 'A yellow circle in the top-left corner.', LABEL);\n   *   noStroke();\n   *   fill('yellow');\n   *   circle(25, 25, 40);\n   *\n   *   // Describe the second element\n   *   // and draw it. Display the\n   *   // description for debugging.\n   *   describeElement('Heart', 'A red heart in the bottom-right corner.', LABEL);\n   *   fill('red');\n   *   circle(66.6, 66.6, 20);\n   *   circle(83.2, 66.6, 20);\n   *   triangle(91.2, 72.6, 75, 95, 58.6, 72.6);\n   *\n   *   // Add a general description of the canvas.\n   *   describe('A red heart and yellow circle over a pink background.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  fn.describeElement = function(name, text, display) {\n    // p5._validateParameters('describeElement', arguments);\n    if (typeof text !== 'string' || typeof name !== 'string') {\n      return;\n    }\n    const cnvId = this.canvas.id;\n    //calls function that adds punctuation for better screen reading\n    text = _descriptionText(text);\n    //calls function that adds punctuation for better screen reading\n    let elementName = _elementName(name);\n    //remove any special characters from name to use it as html id\n    name = name.replace(/[^a-zA-Z0-9]/g, '');\n\n    //store element description\n    let inner = `<th scope=\"row\">${elementName}</th><td>${text}</td>`;\n    //if there is no dummyDOM\n    if (!this.dummyDOM) {\n      this.dummyDOM = document.getElementById(cnvId).parentNode;\n    }\n    if (!this.descriptions) {\n      this.descriptions = { fallbackElements: {} };\n    } else if (!this.descriptions.fallbackElements) {\n      this.descriptions.fallbackElements = {};\n    }\n    //check if html structure for element description is ready\n    if (this.descriptions.fallbackElements[name]) {\n      //if current element description is not the same as inner\n      if (this.descriptions.fallbackElements[name].innerHTML !== inner) {\n        //update element description\n        this.descriptions.fallbackElements[name].innerHTML = inner;\n      }\n    } else {\n      //create fallback html structure\n      this._describeElementHTML('fallback', name, inner);\n    }\n    //if display is LABEL\n    if (display === this.LABEL) {\n      if (!this.descriptions.labelElements) {\n        this.descriptions.labelElements = {};\n      }\n      //if html structure for label element description is ready\n      if (this.descriptions.labelElements[name]) {\n        //if label element description is different\n        if (this.descriptions.labelElements[name].innerHTML !== inner) {\n          //update label element description\n          this.descriptions.labelElements[name].innerHTML = inner;\n        }\n      } else {\n        //create label element html structure\n        this._describeElementHTML('label', name, inner);\n      }\n    }\n  };\n\n  /*\n   *\n   * Helper functions for describe() and describeElement().\n   *\n   */\n\n  // check that text is not LABEL or FALLBACK and ensure text ends with punctuation mark\n  function _descriptionText(text) {\n    if (text === 'label' || text === 'fallback') {\n      throw new Error('description should not be LABEL or FALLBACK');\n    }\n    //if string does not end with '.'\n    if (\n      !text.endsWith('.') &&\n      !text.endsWith(';') &&\n      !text.endsWith(',') &&\n      !text.endsWith('?') &&\n      !text.endsWith('!')\n    ) {\n      //add '.' to the end of string\n      text = text + '.';\n    }\n    return text;\n  }\n\n  /*\n   * Helper functions for describe()\n   */\n\n  //creates HTML structure for canvas descriptions\n  fn._describeHTML = function(type, text) {\n    const cnvId = this.canvas.id;\n    if (type === 'fallback') {\n      //if there is no description container\n      if (!this.dummyDOM.querySelector(`#${cnvId + descContainer}`)) {\n        //if there are no accessible outputs (see textOutput() and gridOutput())\n        let html = `<div id=\"${cnvId}${descContainer}\" role=\"region\" aria-label=\"Canvas Description\"><p id=\"${cnvId}${fallbackDescId}\"></p></div>`;\n        if (!this.dummyDOM.querySelector(`#${cnvId}accessibleOutput`)) {\n          //create description container + <p> for fallback description\n          this.dummyDOM.querySelector(`#${cnvId}`).innerHTML = html;\n        } else {\n          //create description container + <p> for fallback description before outputs\n          this.dummyDOM\n            .querySelector(`#${cnvId}accessibleOutput`)\n            .insertAdjacentHTML('beforebegin', html);\n        }\n      } else {\n        //if describeElement() has already created the container and added a table of elements\n        //create fallback description <p> before the table\n        this.dummyDOM\n          .querySelector('#' + cnvId + fallbackTableId)\n          .insertAdjacentHTML(\n            'beforebegin',\n            `<p id=\"${cnvId + fallbackDescId}\"></p>`\n          );\n      }\n      //if the container for the description exists\n      this.descriptions.fallback = this.dummyDOM.querySelector(\n        `#${cnvId}${fallbackDescId}`\n      );\n      this.descriptions.fallback.innerHTML = text;\n      return;\n    } else if (type === 'label') {\n      //if there is no label container\n      if (!this.dummyDOM.querySelector(`#${cnvId + labelContainer}`)) {\n        let html = `<div id=\"${cnvId}${labelContainer}\" class=\"p5Label\"><p id=\"${cnvId}${labelDescId}\"></p></div>`;\n        //if there are no accessible outputs (see textOutput() and gridOutput())\n        if (!this.dummyDOM.querySelector(`#${cnvId}accessibleOutputLabel`)) {\n          //create label container + <p> for label description\n          this.dummyDOM\n            .querySelector('#' + cnvId)\n            .insertAdjacentHTML('afterend', html);\n        } else {\n          //create label container + <p> for label description before outputs\n          this.dummyDOM\n            .querySelector(`#${cnvId}accessibleOutputLabel`)\n            .insertAdjacentHTML('beforebegin', html);\n        }\n      } else if (this.dummyDOM.querySelector(`#${cnvId + labelTableId}`)) {\n        //if describeElement() has already created the container and added a table of elements\n        //create label description <p> before the table\n        this.dummyDOM\n          .querySelector(`#${cnvId + labelTableId}`)\n          .insertAdjacentHTML(\n            'beforebegin',\n            `<p id=\"${cnvId}${labelDescId}\"></p>`\n          );\n      }\n      this.descriptions.label = this.dummyDOM.querySelector(\n        '#' + cnvId + labelDescId\n      );\n      this.descriptions.label.innerHTML = text;\n      return;\n    }\n  };\n\n  /*\n   * Helper functions for describeElement().\n   */\n\n  //check that name is not LABEL or FALLBACK and ensure text ends with colon\n  function _elementName(name) {\n    if (name === 'label' || name === 'fallback') {\n      throw new Error('element name should not be LABEL or FALLBACK');\n    }\n    //check if last character of string n is '.', ';', or ','\n    if (name.endsWith('.') || name.endsWith(';') || name.endsWith(',')) {\n      //replace last character with ':'\n      name = name.replace(/.$/, ':');\n    } else if (!name.endsWith(':')) {\n      //if string n does not end with ':'\n      //add ':'' at the end of string\n      name = name + ':';\n    }\n    return name;\n  }\n\n  //creates HTML structure for element descriptions\n  fn._describeElementHTML = function(type, name, text) {\n    const cnvId = this.canvas.id;\n    if (type === 'fallback') {\n      //if there is no description container\n      if (!this.dummyDOM.querySelector(`#${cnvId + descContainer}`)) {\n        //if there are no accessible outputs (see textOutput() and gridOutput())\n        let html = `<div id=\"${cnvId}${descContainer}\" role=\"region\" aria-label=\"Canvas Description\"><table id=\"${cnvId}${fallbackTableId}\"><caption>Canvas elements and their descriptions</caption></table></div>`;\n        if (!this.dummyDOM.querySelector(`#${cnvId}accessibleOutput`)) {\n          //create container + table for element descriptions\n          this.dummyDOM.querySelector('#' + cnvId).innerHTML = html;\n        } else {\n          //create container + table for element descriptions before outputs\n          this.dummyDOM\n            .querySelector(`#${cnvId}accessibleOutput`)\n            .insertAdjacentHTML('beforebegin', html);\n        }\n      } else if (!this.dummyDOM.querySelector('#' + cnvId + fallbackTableId)) {\n        //if describe() has already created the container and added a description\n        //and there is no table create fallback table for element description after\n        //fallback description\n        this.dummyDOM\n          .querySelector('#' + cnvId + fallbackDescId)\n          .insertAdjacentHTML(\n            'afterend',\n            `<table id=\"${cnvId}${fallbackTableId}\"><caption>Canvas elements and their descriptions</caption></table>`\n          );\n      }\n      //create a table row for the element\n      let tableRow = document.createElement('tr');\n      tableRow.id = cnvId + fallbackTableElId + name;\n      this.dummyDOM\n        .querySelector('#' + cnvId + fallbackTableId)\n        .appendChild(tableRow);\n      //update element description\n      this.descriptions.fallbackElements[name] = this.dummyDOM.querySelector(\n        `#${cnvId}${fallbackTableElId}${name}`\n      );\n      this.descriptions.fallbackElements[name].innerHTML = text;\n      return;\n    } else if (type === 'label') {\n      //If display is LABEL creates a div adjacent to the canvas element with\n      //a table, a row header cell with the name of the elements,\n      //and adds the description of the element in adjacent cell.\n      //if there is no label description container\n      if (!this.dummyDOM.querySelector(`#${cnvId + labelContainer}`)) {\n        //if there are no accessible outputs (see textOutput() and gridOutput())\n        let html = `<div id=\"${cnvId}${labelContainer}\" class=\"p5Label\"><table id=\"${cnvId}${labelTableId}\"></table></div>`;\n        if (!this.dummyDOM.querySelector(`#${cnvId}accessibleOutputLabel`)) {\n          //create container + table for element descriptions\n          this.dummyDOM\n            .querySelector('#' + cnvId)\n            .insertAdjacentHTML('afterend', html);\n        } else {\n          //create container + table for element descriptions before outputs\n          this.dummyDOM\n            .querySelector(`#${cnvId}accessibleOutputLabel`)\n            .insertAdjacentHTML('beforebegin', html);\n        }\n      } else if (!this.dummyDOM.querySelector(`#${cnvId + labelTableId}`)) {\n        //if describe() has already created the label container and added a description\n        //and there is no table create label table for element description after\n        //label description\n        this.dummyDOM\n          .querySelector('#' + cnvId + labelDescId)\n          .insertAdjacentHTML(\n            'afterend',\n            `<table id=\"${cnvId + labelTableId}\"></table>`\n          );\n      }\n      //create a table row for the element label description\n      let tableRow = document.createElement('tr');\n      tableRow.id = cnvId + labelTableElId + name;\n      this.dummyDOM\n        .querySelector('#' + cnvId + labelTableId)\n        .appendChild(tableRow);\n      //update element label description\n      this.descriptions.labelElements[name] = this.dummyDOM.querySelector(\n        `#${cnvId}${labelTableElId}${name}`\n      );\n      this.descriptions.labelElements[name].innerHTML = text;\n    }\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  describe(p5, p5.prototype);\n}\n\nexport { describe as default };\n","/**\n * @module Environment\n * @submodule Environment\n * @for p5\n * @requires core\n */\n\nfunction gridOutput(p5, fn){\n  //the functions in this file support updating the grid output\n\n  //updates gridOutput\n  fn._updateGridOutput = function(idT) {\n    //if html structure is not there yet\n    if (!this.dummyDOM.querySelector(`#${idT}_summary`)) {\n      return;\n    }\n    let current = this._accessibleOutputs[idT];\n    //create shape details list\n    let innerShapeDetails = _gridShapeDetails(idT, this.ingredients.shapes);\n    //create summary\n    let innerSummary = _gridSummary(\n      innerShapeDetails.numShapes,\n      this.ingredients.colors.background,\n      this.width,\n      this.height\n    );\n    //create grid map\n    let innerMap = _gridMap(idT, this.ingredients.shapes);\n    //if it is different from current summary\n    if (innerSummary !== current.summary.innerHTML) {\n      //update\n      current.summary.innerHTML = innerSummary;\n    }\n    //if it is different from current map\n    if (innerMap !== current.map.innerHTML) {\n      //update\n      current.map.innerHTML = innerMap;\n    }\n    //if it is different from current shape details\n    if (innerShapeDetails.details !== current.shapeDetails.innerHTML) {\n      //update\n      current.shapeDetails.innerHTML = innerShapeDetails.details;\n    }\n    this._accessibleOutputs[idT] = current;\n  };\n\n  //creates spatial grid that maps the location of shapes\n  function _gridMap(idT, ingredients) {\n    let shapeNumber = 0;\n    let table = '';\n    //create an array of arrays 10*10 of empty cells\n    let cells = Array.from(Array(10), () => Array(10));\n    for (let x in ingredients) {\n      for (let y in ingredients[x]) {\n        let fill;\n        if (x !== 'line') {\n          fill = `<a href=\"#${idT}shape${shapeNumber}\">${\n            ingredients[x][y].color\n          } ${x}</a>`;\n        } else {\n          fill = `<a href=\"#${idT}shape${shapeNumber}\">${\n            ingredients[x][y].color\n          } ${x} midpoint</a>`;\n        }\n\n        // Check if shape is in canvas, skip if not\n        if(\n          ingredients[x][y].loc.locY < cells.length &&\n          ingredients[x][y].loc.locX < cells[ingredients[x][y].loc.locY].length\n        ){\n          //if empty cell of location of shape is undefined\n          if (!cells[ingredients[x][y].loc.locY][ingredients[x][y].loc.locX]) {\n            //fill it with shape info\n            cells[ingredients[x][y].loc.locY][ingredients[x][y].loc.locX] = fill;\n            //if a shape is already in that location\n          } else {\n            //add it\n            cells[ingredients[x][y].loc.locY][ingredients[x][y].loc.locX] =\n              cells[ingredients[x][y].loc.locY][ingredients[x][y].loc.locX] +\n              '  ' +\n              fill;\n          }\n          shapeNumber++;\n        }\n      }\n    }\n    //make table based on array\n    for (let _r in cells) {\n      let row = '<tr>';\n      for (let c in cells[_r]) {\n        row = row + '<td>';\n        if (cells[_r][c] !== undefined) {\n          row = row + cells[_r][c];\n        }\n        row = row + '</td>';\n      }\n      table = table + row + '</tr>';\n    }\n    return table;\n  }\n\n  //creates grid summary\n  function _gridSummary(numShapes, background, width, height) {\n    let text = `${background} canvas, ${width} by ${height} pixels, contains ${\n      numShapes[0]\n    }`;\n    if (numShapes[0] === 1) {\n      text = `${text} shape: ${numShapes[1]}`;\n    } else {\n      text = `${text} shapes: ${numShapes[1]}`;\n    }\n    return text;\n  }\n\n  //creates list of shapes\n  function _gridShapeDetails(idT, ingredients) {\n    let shapeDetails = '';\n    let shapes = '';\n    let totalShapes = 0;\n    //goes trhough every shape type in ingredients\n    for (let x in ingredients) {\n      let shapeNum = 0;\n      for (let y in ingredients[x]) {\n        //it creates a line in a list\n        let line = `<li id=\"${idT}shape${totalShapes}\">${\n          ingredients[x][y].color\n        } ${x},`;\n        if (x === 'line') {\n          line =\n            line +\n            ` location = ${ingredients[x][y].pos}, length = ${\n              ingredients[x][y].length\n            } pixels`;\n        } else {\n          line = line + ` location = ${ingredients[x][y].pos}`;\n          if (x !== 'point') {\n            line = line + `, area = ${ingredients[x][y].area} %`;\n          }\n          line = line + '</li>';\n        }\n        shapeDetails = shapeDetails + line;\n        shapeNum++;\n        totalShapes++;\n      }\n      if (shapeNum > 1) {\n        shapes = `${shapes} ${shapeNum} ${x}s`;\n      } else {\n        shapes = `${shapes} ${shapeNum} ${x}`;\n      }\n    }\n    return { numShapes: [totalShapes, shapes], details: shapeDetails };\n  }\n}\n\nif(typeof p5 !== 'undefined'){\n  gridOutput(p5, p5.prototype);\n}\n\nexport { gridOutput as default };\n","/**\n * @module Environment\n * @submodule Environment\n * @for p5\n * @requires core\n */\n\nfunction textOutput(p5, fn){\n  //the functions in this file support updating the text output\n\n  //updates textOutput\n  fn._updateTextOutput = function(idT) {\n    //if html structure is not there yet\n    if (!this.dummyDOM.querySelector(`#${idT}_summary`)) {\n      return;\n    }\n    let current = this._accessibleOutputs[idT];\n    //create shape list\n    let innerList = _shapeList(idT, this.ingredients.shapes);\n    //create output summary\n    let innerSummary = _textSummary(\n      innerList.numShapes,\n      this.ingredients.colors.background,\n      this.width,\n      this.height\n    );\n    //create shape details\n    let innerShapeDetails = _shapeDetails(idT, this.ingredients.shapes);\n    //if it is different from current summary\n    if (innerSummary !== current.summary.innerHTML) {\n      //update\n      current.summary.innerHTML = innerSummary;\n    }\n    //if it is different from current shape list\n    if (innerList.listShapes !== current.list.innerHTML) {\n      //update\n      current.list.innerHTML = innerList.listShapes;\n    }\n    //if it is different from current shape details\n    if (innerShapeDetails !== current.shapeDetails.innerHTML) {\n      //update\n      current.shapeDetails.innerHTML = innerShapeDetails;\n    }\n    this._accessibleOutputs[idT] = current;\n  };\n\n  //Builds textOutput summary\n  function _textSummary(numShapes, background, width, height) {\n    let text = `Your output is a, ${width} by ${height} pixels, ${background} canvas containing the following`;\n    if (numShapes === 1) {\n      text = `${text} shape:`;\n    } else {\n      text = `${text} ${numShapes} shapes:`;\n    }\n    return text;\n  }\n\n  //Builds textOutput table with shape details\n  function _shapeDetails(idT, ingredients) {\n    let shapeDetails = '';\n    let shapeNumber = 0;\n    //goes trhough every shape type in ingredients\n    for (let x in ingredients) {\n      //and for every shape\n      for (let y in ingredients[x]) {\n        //it creates a table row\n        let row = `<tr id=\"${idT}shape${shapeNumber}\"><th>${\n          ingredients[x][y].color\n        } ${x}</th>`;\n        if (x === 'line') {\n          row =\n            row +\n            `<td>location = ${ingredients[x][y].pos}</td><td>length = ${\n              ingredients[x][y].length\n            } pixels</td></tr>`;\n        } else {\n          row = row + `<td>location = ${ingredients[x][y].pos}</td>`;\n          if (x !== 'point') {\n            row = row + `<td> area = ${ingredients[x][y].area}%</td>`;\n          }\n          row = row + '</tr>';\n        }\n        shapeDetails = shapeDetails + row;\n        shapeNumber++;\n      }\n    }\n    return shapeDetails;\n  }\n\n  //Builds textOutput shape list\n  function _shapeList(idT, ingredients) {\n    let shapeList = '';\n    let shapeNumber = 0;\n    //goes trhough every shape type in ingredients\n    for (let x in ingredients) {\n      for (let y in ingredients[x]) {\n        //it creates a line in a list\n        let _line = `<li><a href=\"#${idT}shape${shapeNumber}\">${\n          ingredients[x][y].color\n        } ${x}</a>`;\n        if (x === 'line') {\n          _line =\n            _line +\n            `, ${ingredients[x][y].pos}, ${\n              ingredients[x][y].length\n            } pixels long.</li>`;\n        } else {\n          _line = _line + `, at ${ingredients[x][y].pos}`;\n          if (x !== 'point') {\n            _line = _line + `, covering ${ingredients[x][y].area}% of the canvas`;\n          }\n          _line = _line + '.</li>';\n        }\n        shapeList = shapeList + _line;\n        shapeNumber++;\n      }\n    }\n    return { numShapes: shapeNumber, listShapes: shapeList };\n  }\n}\n\nif(typeof p5 !== 'undefined'){\n  textOutput(p5, p5.prototype);\n}\n\nexport { textOutput as default };\n","/**\n * @module Environment\n * @submodule Environment\n * @for p5\n * @requires core\n */\n\nfunction outputs(p5, fn){\n  /**\n   * Creates a screen reader-accessible description of shapes on the canvas.\n   *\n   * `textOutput()` adds a general description, list of shapes, and\n   * table of shapes to the web page. The general description includes the\n   * canvas size, canvas color, and number of shapes. For example,\n   * `Your output is a, 100 by 100 pixels, gray canvas containing the following 2 shapes:`.\n   *\n   * A list of shapes follows the general description. The list describes the\n   * color, location, and area of each shape. For example,\n   * `a red circle at middle covering 3% of the canvas`. Each shape can be\n   * selected to get more details.\n   *\n   * `textOutput()` uses its table of shapes as a list. The table describes the\n   * shape, color, location, coordinates and area. For example,\n   * `red circle location = middle area = 3%`. This is different from\n   * <a href=\"#/p5/gridOutput\">gridOutput()</a>, which uses its table as a grid.\n   *\n   * The `display` parameter is optional. It determines how the description is\n   * displayed. If `LABEL` is passed, as in `textOutput(LABEL)`, the description\n   * will be visible in a div element next to the canvas. Using `LABEL` creates\n   * unhelpful duplicates for screen readers. Only use `LABEL` during\n   * development. If `FALLBACK` is passed, as in `textOutput(FALLBACK)`, the\n   * description will only be visible to screen readers. This is the default\n   * mode.\n   *\n   * Read\n   * <a href=\"/learn/accessible-labels.html\">Writing accessible canvas descriptions</a>\n   * to learn more about making sketches accessible.\n   *\n   * @method textOutput\n   * @param  {(FALLBACK|LABEL)} [display] either FALLBACK or LABEL.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Add the text description.\n   *   textOutput();\n   *\n   *   // Draw a couple of shapes.\n   *   background(200);\n   *   fill(255, 0, 0);\n   *   circle(20, 20, 20);\n   *   fill(0, 0, 255);\n   *   square(50, 50, 50);\n   *\n   *   // Add a general description of the canvas.\n   *   describe('A red circle and a blue square on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Add the text description and\n   *   // display it for debugging.\n   *   textOutput(LABEL);\n   *\n   *   // Draw a couple of shapes.\n   *   background(200);\n   *   fill(255, 0, 0);\n   *   circle(20, 20, 20);\n   *   fill(0, 0, 255);\n   *   square(50, 50, 50);\n   *\n   *   // Add a general description of the canvas.\n   *   describe('A red circle and a blue square on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * \n   * function setup(){\n   *  createCanvas(100, 100);\n   * }\n   * \n   * function draw() {\n   *   // Add the text description.\n   *   textOutput();\n   *\n   *   // Draw a moving circle.\n   *   background(200);\n   *   let x = frameCount * 0.1;\n   *   fill(255, 0, 0);\n   *   circle(x, 20, 20);\n   *   fill(0, 0, 255);\n   *   square(50, 50, 50);\n   *\n   *   // Add a general description of the canvas.\n   *   describe('A red circle moves from left to right above a blue square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * \n   * function setup(){\n   *  createCanvas(100, 100);\n   * }\n   * \n   * function draw() {\n   *   // Add the text description and\n   *   // display it for debugging.\n   *   textOutput(LABEL);\n   *\n   *   // Draw a moving circle.\n   *   background(200);\n   *   let x = frameCount * 0.1;\n   *   fill(255, 0, 0);\n   *   circle(x, 20, 20);\n   *   fill(0, 0, 255);\n   *   square(50, 50, 50);\n   *\n   *   // Add a general description of the canvas.\n   *   describe('A red circle moves from left to right above a blue square.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.textOutput = function(display) {\n    // p5._validateParameters('textOutput', arguments);\n    //if textOutput is already true\n    if (this._accessibleOutputs.text) {\n      return;\n    } else {\n      //make textOutput true\n      this._accessibleOutputs.text = true;\n      //create output for fallback\n      this._createOutput('textOutput', 'Fallback');\n      if (display === this.LABEL) {\n        //make textOutput label true\n        this._accessibleOutputs.textLabel = true;\n        //create output for label\n        this._createOutput('textOutput', 'Label');\n      }\n    }\n  };\n\n  /**\n   * Creates a screen reader-accessible description of shapes on the canvas.\n   *\n   * `gridOutput()` adds a general description, table of shapes, and list of\n   * shapes to the web page. The general description includes the canvas size,\n   * canvas color, and number of shapes. For example,\n   * `gray canvas, 100 by 100 pixels, contains 2 shapes:  1 circle 1 square`.\n   *\n   * `gridOutput()` uses its table of shapes as a grid. Each shape in the grid\n   * is placed in a cell whose row and column correspond to the shape's location\n   * on the canvas. The grid cells describe the color and type of shape at that\n   * location. For example, `red circle`. These descriptions can be selected\n   * individually to get more details. This is different from\n   * <a href=\"#/p5/textOutput\">textOutput()</a>, which uses its table as a list.\n   *\n   * A list of shapes follows the table. The list describes the color, type,\n   * location, and area of each shape. For example,\n   * `red circle, location = middle, area = 3 %`.\n   *\n   * The `display` parameter is optional. It determines how the description is\n   * displayed. If `LABEL` is passed, as in `gridOutput(LABEL)`, the description\n   * will be visible in a div element next to the canvas. Using `LABEL` creates\n   * unhelpful duplicates for screen readers. Only use `LABEL` during\n   * development. If `FALLBACK` is passed, as in `gridOutput(FALLBACK)`, the\n   * description will only be visible to screen readers. This is the default\n   * mode.\n   *\n   * Read\n   * <a href=\"/learn/accessible-labels.html\">Writing accessible canvas descriptions</a>\n   * to learn more about making sketches accessible.\n   *\n   * @method gridOutput\n   * @param  {(FALLBACK|LABEL)} [display] either FALLBACK or LABEL.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Add the grid description.\n   *   gridOutput();\n   *\n   *   // Draw a couple of shapes.\n   *   background(200);\n   *   fill(255, 0, 0);\n   *   circle(20, 20, 20);\n   *   fill(0, 0, 255);\n   *   square(50, 50, 50);\n   *\n   *   // Add a general description of the canvas.\n   *   describe('A red circle and a blue square on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Add the grid description and\n   *   // display it for debugging.\n   *   gridOutput(LABEL);\n   *\n   *   // Draw a couple of shapes.\n   *   background(200);\n   *   fill(255, 0, 0);\n   *   circle(20, 20, 20);\n   *   fill(0, 0, 255);\n   *   square(50, 50, 50);\n   *\n   *   // Add a general description of the canvas.\n   *   describe('A red circle and a blue square on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * \n   * function setup() {\n   *   createCanvas(100, 100);\n   * }\n   * \n   * function draw() {\n   *   // Add the grid description.\n   *   gridOutput();\n   *\n   *   // Draw a moving circle.\n   *   background(200);\n   *   let x = frameCount * 0.1;\n   *   fill(255, 0, 0);\n   *   circle(x, 20, 20);\n   *   fill(0, 0, 255);\n   *   square(50, 50, 50);\n   *\n   *   // Add a general description of the canvas.\n   *   describe('A red circle moves from left to right above a blue square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * \n   * function setup(){\n   *  createCanvas(100, 100);\n   * }\n   * \n   * function draw() {\n   *   // Add the grid description and\n   *   // display it for debugging.\n   *   gridOutput(LABEL);\n   *\n   *   // Draw a moving circle.\n   *   background(200);\n   *   let x = frameCount * 0.1;\n   *   fill(255, 0, 0);\n   *   circle(x, 20, 20);\n   *   fill(0, 0, 255);\n   *   square(50, 50, 50);\n   *\n   *   // Add a general description of the canvas.\n   *   describe('A red circle moves from left to right above a blue square.');\n   * }\n   * </code>\n   * </div>\n   */\n\n\n  fn.gridOutput = function(display) {\n    // p5._validateParameters('gridOutput', arguments);\n    //if gridOutput is already true\n    if (this._accessibleOutputs.grid) {\n      return;\n    } else {\n      //make gridOutput true\n      this._accessibleOutputs.grid = true;\n      //create output for fallback\n      this._createOutput('gridOutput', 'Fallback');\n      if (display === this.LABEL) {\n        //make gridOutput label true\n        this._accessibleOutputs.gridLabel = true;\n        //create output for label\n        this._createOutput('gridOutput', 'Label');\n      }\n    }\n  };\n\n  //helper function returns true when accessible outputs are true\n  fn._addAccsOutput = function() {\n    //if there are no accessible outputs create object with all false\n    if (!this._accessibleOutputs) {\n      this._accessibleOutputs = {\n        text: false,\n        grid: false,\n        textLabel: false,\n        gridLabel: false\n      };\n    }\n    return this._accessibleOutputs.grid || this._accessibleOutputs.text;\n  };\n\n  //helper function that creates html structure for accessible outputs\n  fn._createOutput = function(type, display) {\n    let cnvId = this.canvas.id;\n    //if there are no ingredients create object. this object stores data for the outputs\n    if (!this.ingredients) {\n      this.ingredients = {\n        shapes: {},\n        colors: { background: 'white', fill: 'white', stroke: 'black' },\n        pShapes: '',\n        pBackground: ''\n      };\n    }\n    //if there is no dummyDOM create it\n    if (!this.dummyDOM) {\n      this.dummyDOM = document.getElementById(cnvId).parentNode;\n    }\n    let cIdT, container, inner;\n    let query = '';\n    if (display === 'Fallback') {\n      cIdT = cnvId + type;\n      container = cnvId + 'accessibleOutput';\n      if (!this.dummyDOM.querySelector(`#${container}`)) {\n        //if there is no canvas description (see describe() and describeElement())\n        if (!this.dummyDOM.querySelector(`#${cnvId}_Description`)) {\n          //create html structure inside of canvas\n          this.dummyDOM.querySelector(\n            `#${cnvId}`\n          ).innerHTML = `<div id=\"${container}\" role=\"region\" aria-label=\"Canvas Outputs\"></div>`;\n        } else {\n          //create html structure after canvas description container\n          this.dummyDOM\n            .querySelector(`#${cnvId}_Description`)\n            .insertAdjacentHTML(\n              'afterend',\n              `<div id=\"${container}\" role=\"region\" aria-label=\"Canvas Outputs\"></div>`\n            );\n        }\n      }\n    } else if (display === 'Label') {\n      query = display;\n      cIdT = cnvId + type + display;\n      container = cnvId + 'accessibleOutput' + display;\n      if (!this.dummyDOM.querySelector(`#${container}`)) {\n        //if there is no canvas description label (see describe() and describeElement())\n        if (!this.dummyDOM.querySelector(`#${cnvId}_Label`)) {\n          //create html structure adjacent to canvas\n          this.dummyDOM\n            .querySelector(`#${cnvId}`)\n            .insertAdjacentHTML('afterend', `<div id=\"${container}\"></div>`);\n        } else {\n          //create html structure after canvas label\n          this.dummyDOM\n            .querySelector(`#${cnvId}_Label`)\n            .insertAdjacentHTML('afterend', `<div id=\"${container}\"></div>`);\n        }\n      }\n    }\n    //create an object to store the latest output. this object is used in _updateTextOutput() and _updateGridOutput()\n    this._accessibleOutputs[cIdT] = {};\n    if (type === 'textOutput') {\n      query = `#${cnvId}gridOutput${query}`; //query is used to check if gridOutput already exists\n      inner = `<div id=\"${cIdT}\">Text Output<div id=\"${cIdT}Summary\" aria-label=\"text output summary\"><p id=\"${cIdT}_summary\"></p><ul id=\"${cIdT}_list\"></ul></div><table id=\"${cIdT}_shapeDetails\" summary=\"text output shape details\"></table></div>`;\n      //if gridOutput already exists\n      if (this.dummyDOM.querySelector(query)) {\n        //create textOutput before gridOutput\n        this.dummyDOM\n          .querySelector(query)\n          .insertAdjacentHTML('beforebegin', inner);\n      } else {\n        //create output inside of container\n        this.dummyDOM.querySelector(`#${container}`).innerHTML = inner;\n      }\n      //store output html elements\n      this._accessibleOutputs[cIdT].list = this.dummyDOM.querySelector(\n        `#${cIdT}_list`\n      );\n    } else if (type === 'gridOutput') {\n      query = `#${cnvId}textOutput${query}`; //query is used to check if textOutput already exists\n      inner = `<div id=\"${cIdT}\">Grid Output<p id=\"${cIdT}_summary\" aria-label=\"grid output summary\"><table id=\"${cIdT}_map\" summary=\"grid output content\"></table><ul id=\"${cIdT}_shapeDetails\" aria-label=\"grid output shape details\"></ul></div>`;\n      //if textOutput already exists\n      if (this.dummyDOM.querySelector(query)) {\n        //create gridOutput after textOutput\n        this.dummyDOM.querySelector(query).insertAdjacentHTML('afterend', inner);\n      } else {\n        //create output inside of container\n        this.dummyDOM.querySelector(`#${container}`).innerHTML = inner;\n      }\n      //store output html elements\n      this._accessibleOutputs[cIdT].map = this.dummyDOM.querySelector(\n        `#${cIdT}_map`\n      );\n    }\n    this._accessibleOutputs[cIdT].shapeDetails = this.dummyDOM.querySelector(\n      `#${cIdT}_shapeDetails`\n    );\n    this._accessibleOutputs[cIdT].summary = this.dummyDOM.querySelector(\n      `#${cIdT}_summary`\n    );\n  };\n\n  //this function is called at the end of setup and draw if using\n  //accessibleOutputs and calls update functions of outputs\n  fn._updateAccsOutput = function() {\n    let cnvId = this.canvas.id;\n    //if the shapes are not the same as before\n    if (\n      JSON.stringify(this.ingredients.shapes) !== this.ingredients.pShapes ||\n      this.ingredients.colors.background !== this.ingredients.pBackground\n    ) {\n      //save current shapes as string in pShapes\n      this.ingredients.pShapes = JSON.stringify(this.ingredients.shapes);\n      if (this._accessibleOutputs.text) {\n        this._updateTextOutput(cnvId + 'textOutput');\n      }\n      if (this._accessibleOutputs.grid) {\n        this._updateGridOutput(cnvId + 'gridOutput');\n      }\n      if (this._accessibleOutputs.textLabel) {\n        this._updateTextOutput(cnvId + 'textOutputLabel');\n      }\n      if (this._accessibleOutputs.gridLabel) {\n        this._updateGridOutput(cnvId + 'gridOutputLabel');\n      }\n    }\n  };\n\n  //helper function that resets all ingredients when background is called\n  //and saves background color name\n  fn._accsBackground = function(args) {\n    //save current shapes as string in pShapes\n    this.ingredients.pShapes = JSON.stringify(this.ingredients.shapes);\n    this.ingredients.pBackground = this.ingredients.colors.background;\n    //empty shapes JSON\n    this.ingredients.shapes = {};\n    //update background different\n    if (this.ingredients.colors.backgroundRGBA !== args) {\n      this.ingredients.colors.backgroundRGBA = args;\n      this.ingredients.colors.background = this._rgbColorName(args);\n    }\n  };\n\n  //helper function that gets fill and stroke of shapes\n  fn._accsCanvasColors = function(f, args) {\n    if (f === 'fill') {\n      //update fill different\n      if (this.ingredients.colors.fillRGBA !== args) {\n        this.ingredients.colors.fillRGBA = args;\n        this.ingredients.colors.fill = this._rgbColorName(args);\n      }\n    } else if (f === 'stroke') {\n      //update stroke if different\n      if (this.ingredients.colors.strokeRGBA !== args) {\n        this.ingredients.colors.strokeRGBA = args;\n        this.ingredients.colors.stroke = this._rgbColorName(args);\n      }\n    }\n  };\n\n  //builds ingredients.shapes used for building outputs\n  fn._accsOutput = function(f, args) {\n    if (f === 'ellipse' && args[2] === args[3]) {\n      f = 'circle';\n    } else if (f === 'rectangle' && args[2] === args[3]) {\n      f = 'square';\n    }\n    let include = {};\n    let add = true;\n    let middle = _getMiddle(f, args);\n    if (f === 'line') {\n      //make color stroke\n      include.color = this.ingredients.colors.stroke;\n      //get lenght\n      include.length = Math.round(\n        Math.hypot(args[2] - args[0], args[3] - args[1])\n      );\n      //get position of end points\n      let p1 = this._getPos(args[0], [1]);\n      let p2 = this._getPos(args[2], [3]);\n      include.loc = _canvasLocator(middle, this.width, this.height);\n      if (p1 === p2) {\n        include.pos = `at ${p1}`;\n      } else {\n        include.pos = `from ${p1} to ${p2}`;\n      }\n    } else {\n      if (f === 'point') {\n        //make color stroke\n        include.color = this.ingredients.colors.stroke;\n      } else {\n        //make color fill\n        include.color = this.ingredients.colors.fill;\n        //get area of shape\n        include.area = this._getArea(f, args);\n      }\n      //get middle of shapes\n      //calculate position using middle of shape\n      include.pos = this._getPos(...middle);\n      //calculate location using middle of shape\n      include.loc = _canvasLocator(middle, this.width, this.height);\n    }\n    //if it is the first time this shape is created\n    if (!this.ingredients.shapes[f]) {\n      this.ingredients.shapes[f] = [include];\n      //if other shapes of this type have been created\n    } else {\n      //for every shape of this type\n      for (let y in this.ingredients.shapes[f]) {\n        //compare it with current shape and if it already exists make add false\n        if (\n          JSON.stringify(this.ingredients.shapes[f][y]) ===\n          JSON.stringify(include)\n        ) {\n          add = false;\n        }\n      }\n      //add shape by pushing it to the end\n      if (add === true) {\n        this.ingredients.shapes[f].push(include);\n      }\n    }\n  };\n\n  //gets middle point / centroid of shape\n  function _getMiddle(f, args) {\n    let x, y;\n    if (\n      f === 'rectangle' ||\n      f === 'ellipse' ||\n      f === 'arc' ||\n      f === 'circle' ||\n      f === 'square'\n    ) {\n      x = Math.round(args[0] + args[2] / 2);\n      y = Math.round(args[1] + args[3] / 2);\n    } else if (f === 'triangle') {\n      x = (args[0] + args[2] + args[4]) / 3;\n      y = (args[1] + args[3] + args[5]) / 3;\n    } else if (f === 'quadrilateral') {\n      x = (args[0] + args[2] + args[4] + args[6]) / 4;\n      y = (args[1] + args[3] + args[5] + args[7]) / 4;\n    } else if (f === 'line') {\n      x = (args[0] + args[2]) / 2;\n      y = (args[1] + args[3]) / 2;\n    } else {\n      x = args[0];\n      y = args[1];\n    }\n    return [x, y];\n  }\n\n  //gets position of shape in the canvas\n  fn._getPos = function (x, y) {\n    const { x: transformedX, y: transformedY } = this.worldToScreen(new p5.Vector(x, y));\n    const canvasWidth = this.width;\n    const canvasHeight = this.height;\n    if (transformedX < 0.4 * canvasWidth) {\n      if (transformedY < 0.4 * canvasHeight) {\n        return 'top left';\n      } else if (transformedY > 0.6 * canvasHeight) {\n        return 'bottom left';\n      } else {\n        return 'mid left';\n      }\n    } else if (transformedX > 0.6 * canvasWidth) {\n      if (transformedY < 0.4 * canvasHeight) {\n        return 'top right';\n      } else if (transformedY > 0.6 * canvasHeight) {\n        return 'bottom right';\n      } else {\n        return 'mid right';\n      }\n    } else {\n      if (transformedY < 0.4 * canvasHeight) {\n        return 'top middle';\n      } else if (transformedY > 0.6 * canvasHeight) {\n        return 'bottom middle';\n      } else {\n        return 'middle';\n      }\n    }\n  };\n\n  //locates shape in a 10*10 grid\n  function _canvasLocator(args, canvasWidth, canvasHeight) {\n    const noRows = 10;\n    const noCols = 10;\n    let locX = Math.floor(args[0] / canvasWidth * noRows);\n    let locY = Math.floor(args[1] / canvasHeight * noCols);\n    if (locX === noRows) {\n      locX = locX - 1;\n    }\n    if (locY === noCols) {\n      locY = locY - 1;\n    }\n    return {\n      locX,\n      locY\n    };\n  }\n\n  //calculates area of shape\n  fn._getArea = function (objectType, shapeArgs) {\n    let objectArea = 0;\n    if (objectType === 'arc') {\n      // area of full ellipse = PI * horizontal radius * vertical radius.\n      // therefore, area of arc = difference bet. arc's start and end radians * horizontal radius * vertical radius.\n      // the below expression is adjusted for negative values and differences in arc's start and end radians over PI*2\n      const arcSizeInRadians =\n        ((shapeArgs[5] - shapeArgs[4]) % (Math.PI * 2) + Math.PI * 2) %\n        (Math.PI * 2);\n      objectArea = arcSizeInRadians * shapeArgs[2] * shapeArgs[3] / 8;\n      if (shapeArgs[6] === 'open' || shapeArgs[6] === 'chord') {\n        // when the arc's mode is OPEN or CHORD, we need to account for the area of the triangle that is formed to close the arc\n        // (Ax( By   Cy) + Bx(Cy  Ay) + Cx(Ay  By ) )/2\n        const Ax = shapeArgs[0];\n        const Ay = shapeArgs[1];\n        const Bx =\n          shapeArgs[0] + shapeArgs[2] / 2 * Math.cos(shapeArgs[4]).toFixed(2);\n        const By =\n          shapeArgs[1] + shapeArgs[3] / 2 * Math.sin(shapeArgs[4]).toFixed(2);\n        const Cx =\n          shapeArgs[0] + shapeArgs[2] / 2 * Math.cos(shapeArgs[5]).toFixed(2);\n        const Cy =\n          shapeArgs[1] + shapeArgs[3] / 2 * Math.sin(shapeArgs[5]).toFixed(2);\n        const areaOfExtraTriangle =\n          Math.abs(Ax * (By - Cy) + Bx * (Cy - Ay) + Cx * (Ay - By)) / 2;\n        if (arcSizeInRadians > Math.PI) {\n          objectArea = objectArea + areaOfExtraTriangle;\n        } else {\n          objectArea = objectArea - areaOfExtraTriangle;\n        }\n      }\n    } else if (objectType === 'ellipse' || objectType === 'circle') {\n      objectArea = 3.14 * shapeArgs[2] / 2 * shapeArgs[3] / 2;\n    } else if (objectType === 'line') {\n      objectArea = 0;\n    } else if (objectType === 'point') {\n      objectArea = 0;\n    } else if (objectType === 'quadrilateral') {\n      // ((x4+x1)*(y4-y1)+(x1+x2)*(y1-y2)+(x2+x3)*(y2-y3)+(x3+x4)*(y3-y4))/2\n      objectArea =\n        Math.abs(\n          (shapeArgs[6] + shapeArgs[0]) * (shapeArgs[7] - shapeArgs[1]) +\n            (shapeArgs[0] + shapeArgs[2]) * (shapeArgs[1] - shapeArgs[3]) +\n            (shapeArgs[2] + shapeArgs[4]) * (shapeArgs[3] - shapeArgs[5]) +\n            (shapeArgs[4] + shapeArgs[6]) * (shapeArgs[5] - shapeArgs[7])\n        ) / 2;\n    } else if (objectType === 'rectangle' || objectType === 'square') {\n      objectArea = shapeArgs[2] * shapeArgs[3];\n    } else if (objectType === 'triangle') {\n      objectArea =\n        Math.abs(\n          shapeArgs[0] * (shapeArgs[3] - shapeArgs[5]) +\n            shapeArgs[2] * (shapeArgs[5] - shapeArgs[1]) +\n            shapeArgs[4] * (shapeArgs[1] - shapeArgs[3])\n        ) / 2;\n      // (Ax( By   Cy) + Bx(Cy  Ay) + Cx(Ay  By ))/2\n    }\n    //  Store the positions of the canvas corners\n    const canvasWidth = this.width * this._renderer._pixelDensity;\n    const canvasHeight = this.height * this._renderer._pixelDensity;\n    const canvasCorners = [\n      new DOMPoint(0, 0),\n      new DOMPoint(canvasWidth, 0),\n      new DOMPoint(canvasWidth, canvasHeight),\n      new DOMPoint(0, canvasHeight)\n    ];\n    //  Apply the inverse of the current transformations to the canvas corners\n    const currentTransform = this._renderer.isP3D ?\n      new DOMMatrix(this._renderer.uMVMatrix.mat4) :\n      this.drawingContext.getTransform();\n    const invertedTransform = currentTransform.inverse();\n    const tc = canvasCorners.map(\n      corner => corner.matrixTransform(invertedTransform)\n    );\n    /*  Use same shoelace formula used for quad area (above) to calculate\n    the area of the canvas with inverted transformation applied */\n    const transformedCanvasArea = Math.abs(\n      (tc[3].x + tc[0].x) * (tc[3].y - tc[0].y) +\n      (tc[0].x + tc[1].x) * (tc[0].y - tc[1].y) +\n      (tc[1].x + tc[2].x) * (tc[1].y - tc[2].y)+\n      (tc[2].x + tc[3].x) * (tc[2].y - tc[3].y)\n    ) / 2;\n    /*  Compare area of shape (minus transformations) to area of canvas\n    with inverted transformation applied.\n    Return percentage  */\n    const untransformedArea = Math.round(\n      objectArea * 100 / (transformedCanvasArea)\n    );\n    return untransformedArea;\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  outputs(p5, p5.prototype);\n}\n\nexport { outputs as default };\n","import { p as p5 } from '../main-B3Z63C6j.js';\nimport '../constants-8IpwyBct.js';\nimport '../core/transform.js';\nimport '../core/structure.js';\nimport '../core/environment.js';\nimport '../math/p5.Vector.js';\nimport '../rendering-BELwvfI6.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport './color_spaces/hsb.js';\nimport '../dom/p5.Element.js';\nimport '../dom/p5.File.js';\nimport '../io/p5.XML.js';\nimport '../p5.Renderer-DoDzbpcT.js';\nimport '../image/filters.js';\nimport '../shape/custom_shapes.js';\nimport '../core/States.js';\nimport '../io/utilities.js';\nimport 'file-saver';\nimport '../dom/p5.MediaElement.js';\nimport '../shape/2d_primitives.js';\nimport '../core/helpers.js';\nimport '../shape/attributes.js';\nimport '../shape/curves.js';\nimport '../shape/vertex.js';\nimport './setting.js';\nimport 'omggif';\nimport '../io/csv.js';\nimport 'gifenc';\nimport '../image/pixels.js';\nimport '../webgl/GeometryBuilder.js';\nimport '../math/p5.Matrix.js';\nimport '../math/Matrices/Matrix.js';\nimport '../math/Matrices/MatrixInterface.js';\nimport '../webgl/p5.Geometry.js';\nimport '../webgl/p5.DataArray.js';\nimport '../webgl/p5.Quat.js';\nimport '../webgl/p5.RenderBuffer.js';\nimport '../webgl/ShapeBuilder.js';\nimport 'libtess';\nimport '../webgl/GeometryBufferCache.js';\nimport '../image/const.js';\nimport '../math/trigonometry.js';\nimport '../image/filterRenderer2D.js';\n\n/**\n * @module Color\n * @submodule Color Conversion\n * @for p5\n * @requires core\n */\n\np5.ColorConversion = {\n  /**\n   * Convert an HSBA array to HSLA.\n   */\n  _hsbaToHSLA(hsba) {\n    const hue = hsba[0];\n    let sat = hsba[1];\n    const val = hsba[2];\n\n    // Calculate lightness.\n    const li = (2 - sat) * val / 2;\n\n    // Convert saturation.\n    if (li !== 0) {\n      if (li === 1) {\n        sat = 0;\n      } else if (li < 0.5) {\n        sat = sat / (2 - sat);\n      } else {\n        sat = sat * val / (2 - li * 2);\n      }\n    }\n\n    // Hue and alpha stay the same.\n    return [hue, sat, li, hsba[3]];\n  },\n\n  /**\n   * Convert an HSBA array to RGBA.\n   */\n  _hsbaToRGBA(hsba) {\n    const hue = hsba[0] * 6; // We will split hue into 6 sectors.\n    const sat = hsba[1];\n    const val = hsba[2];\n\n    let RGBA = [];\n\n    if (sat === 0) {\n      RGBA = [val, val, val, hsba[3]]; // Return early if grayscale.\n    } else {\n      const sector = Math.floor(hue);\n      const tint1 = val * (1 - sat);\n      const tint2 = val * (1 - sat * (hue - sector));\n      const tint3 = val * (1 - sat * (1 + sector - hue));\n      let red, green, blue;\n      if (sector === 1) {\n        // Yellow to green.\n        red = tint2;\n        green = val;\n        blue = tint1;\n      } else if (sector === 2) {\n        // Green to cyan.\n        red = tint1;\n        green = val;\n        blue = tint3;\n      } else if (sector === 3) {\n        // Cyan to blue.\n        red = tint1;\n        green = tint2;\n        blue = val;\n      } else if (sector === 4) {\n        // Blue to magenta.\n        red = tint3;\n        green = tint1;\n        blue = val;\n      } else if (sector === 5) {\n        // Magenta to red.\n        red = val;\n        green = tint1;\n        blue = tint2;\n      } else {\n        // Red to yellow (sector could be 0 or 6).\n        red = val;\n        green = tint3;\n        blue = tint1;\n      }\n      RGBA = [red, green, blue, hsba[3]];\n    }\n\n    return RGBA;\n  },\n\n  /**\n   * Convert an HSLA array to HSBA.\n   */\n  _hslaToHSBA(hsla) {\n    const hue = hsla[0];\n    let sat = hsla[1];\n    const li = hsla[2];\n\n    // Calculate brightness.\n    let val;\n    if (li < 0.5) {\n      val = (1 + sat) * li;\n    } else {\n      val = li + sat - li * sat;\n    }\n\n    // Convert saturation.\n    sat = 2 * (val - li) / val;\n\n    // Hue and alpha stay the same.\n    return [hue, sat, val, hsla[3]];\n  },\n\n  /**\n   * Convert an HSLA array to RGBA.\n   *\n   * We need to change basis from HSLA to something that can be more easily be\n   * projected onto RGBA. We will choose hue and brightness as our first two\n   * components, and pick a convenient third one ('zest') so that we don't need\n   * to calculate formal HSBA saturation.\n   */\n  _hslaToRGBA(hsla) {\n    const hue = hsla[0] * 6; // We will split hue into 6 sectors.\n    const sat = hsla[1];\n    const li = hsla[2];\n\n    let RGBA = [];\n\n    if (sat === 0) {\n      RGBA = [li, li, li, hsla[3]]; // Return early if grayscale.\n    } else {\n      // Calculate brightness.\n      let val;\n      if (li < 0.5) {\n        val = (1 + sat) * li;\n      } else {\n        val = li + sat - li * sat;\n      }\n\n      // Define zest.\n      const zest = 2 * li - val;\n\n      // Implement projection (project onto green by default).\n      const hzvToRGB = (hue, zest, val) => {\n        if (hue < 0) {\n          // Hue must wrap to allow projection onto red and blue.\n          hue += 6;\n        } else if (hue >= 6) {\n          hue -= 6;\n        }\n        if (hue < 1) {\n          // Red to yellow (increasing green).\n          return zest + (val - zest) * hue;\n        } else if (hue < 3) {\n          // Yellow to cyan (greatest green).\n          return val;\n        } else if (hue < 4) {\n          // Cyan to blue (decreasing green).\n          return zest + (val - zest) * (4 - hue);\n        } else {\n          // Blue to red (least green).\n          return zest;\n        }\n      };\n\n      // Perform projections, offsetting hue as necessary.\n      RGBA = [\n        hzvToRGB(hue + 2, zest, val),\n        hzvToRGB(hue, zest, val),\n        hzvToRGB(hue - 2, zest, val),\n        hsla[3]\n      ];\n    }\n\n    return RGBA;\n  },\n\n  /**\n   * Convert an RGBA array to HSBA.\n   */\n  _rgbaToHSBA(rgba) {\n    const red = rgba[0];\n    const green = rgba[1];\n    const blue = rgba[2];\n\n    const val = Math.max(red, green, blue);\n    const chroma = val - Math.min(red, green, blue);\n\n    let hue, sat;\n    if (chroma === 0) {\n      // Return early if grayscale.\n      hue = 0;\n      sat = 0;\n    } else {\n      sat = chroma / val;\n      if (red === val) {\n        // Magenta to yellow.\n        hue = (green - blue) / chroma;\n      } else if (green === val) {\n        // Yellow to cyan.\n        hue = 2 + (blue - red) / chroma;\n      } else if (blue === val) {\n        // Cyan to magenta.\n        hue = 4 + (red - green) / chroma;\n      }\n      if (hue < 0) {\n        // Confine hue to the interval [0, 1).\n        hue += 6;\n      } else if (hue >= 6) {\n        hue -= 6;\n      }\n    }\n\n    return [hue / 6, sat, val, rgba[3]];\n  },\n\n  /**\n   * Convert an RGBA array to HSLA.\n   */\n  _rgbaToHSLA(rgba) {\n    const red = rgba[0];\n    const green = rgba[1];\n    const blue = rgba[2];\n\n    const val = Math.max(red, green, blue);\n    const min = Math.min(red, green, blue);\n    const li = val + min; // We will halve this later.\n    const chroma = val - min;\n\n    let hue, sat;\n    if (chroma === 0) {\n      // Return early if grayscale.\n      hue = 0;\n      sat = 0;\n    } else {\n      if (li < 1) {\n        sat = chroma / li;\n      } else {\n        sat = chroma / (2 - li);\n      }\n      if (red === val) {\n        // Magenta to yellow.\n        hue = (green - blue) / chroma;\n      } else if (green === val) {\n        // Yellow to cyan.\n        hue = 2 + (blue - red) / chroma;\n      } else if (blue === val) {\n        // Cyan to magenta.\n        hue = 4 + (red - green) / chroma;\n      }\n      if (hue < 0) {\n        // Confine hue to the interval [0, 1).\n        hue += 6;\n      } else if (hue >= 6) {\n        hue -= 6;\n      }\n    }\n\n    return [hue / 6, sat, li / 2, rgba[3]];\n  }\n};\nvar color_conversion = p5.ColorConversion;\n\nexport { color_conversion as default };\n","import color_conversion from '../color/color_conversion.js';\nimport '../main-B3Z63C6j.js';\nimport '../constants-8IpwyBct.js';\nimport '../core/transform.js';\nimport '../core/structure.js';\nimport '../core/environment.js';\nimport '../math/p5.Vector.js';\nimport '../rendering-BELwvfI6.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../dom/p5.Element.js';\nimport '../dom/p5.File.js';\nimport '../io/p5.XML.js';\nimport '../p5.Renderer-DoDzbpcT.js';\nimport '../image/filters.js';\nimport '../shape/custom_shapes.js';\nimport '../core/States.js';\nimport '../io/utilities.js';\nimport 'file-saver';\nimport '../dom/p5.MediaElement.js';\nimport '../shape/2d_primitives.js';\nimport '../core/helpers.js';\nimport '../shape/attributes.js';\nimport '../shape/curves.js';\nimport '../shape/vertex.js';\nimport '../color/setting.js';\nimport 'omggif';\nimport '../io/csv.js';\nimport 'gifenc';\nimport '../image/pixels.js';\nimport '../webgl/GeometryBuilder.js';\nimport '../math/p5.Matrix.js';\nimport '../math/Matrices/Matrix.js';\nimport '../math/Matrices/MatrixInterface.js';\nimport '../webgl/p5.Geometry.js';\nimport '../webgl/p5.DataArray.js';\nimport '../webgl/p5.Quat.js';\nimport '../webgl/p5.RenderBuffer.js';\nimport '../webgl/ShapeBuilder.js';\nimport 'libtess';\nimport '../webgl/GeometryBufferCache.js';\nimport '../image/const.js';\nimport '../math/trigonometry.js';\nimport '../image/filterRenderer2D.js';\n\n/**\n * @module Environment\n * @submodule Environment\n * @for p5\n * @requires core\n */\n\n\nfunction colorNamer(p5, fn){\n  //stores the original hsb values\n  let originalHSB;\n\n  //stores values for color name exceptions\n  const colorExceptions = [\n    {\n      h: 0,\n      s: 0,\n      b: 0.8275,\n      name: 'gray'\n    },\n    {\n      h: 0,\n      s: 0,\n      b: 0.8627,\n      name: 'gray'\n    },\n    {\n      h: 0,\n      s: 0,\n      b: 0.7529,\n      name: 'gray'\n    },\n    {\n      h: 0.0167,\n      s: 0.1176,\n      b: 1,\n      name: 'light pink'\n    }\n  ];\n\n  //stores values for color names\n  const colorLookUp = [\n    {\n      h: 0,\n      s: 0,\n      b: 0,\n      name: 'black'\n    },\n    {\n      h: 0,\n      s: 0,\n      b: 0.5,\n      name: 'gray'\n    },\n    {\n      h: 0,\n      s: 0,\n      b: 1,\n      name: 'white'\n    },\n    {\n      h: 0,\n      s: 0.5,\n      b: 0.5,\n      name: 'dark maroon'\n    },\n    {\n      h: 0,\n      s: 0.5,\n      b: 1,\n      name: 'salmon pink'\n    },\n    {\n      h: 0,\n      s: 1,\n      b: 0,\n      name: 'black'\n    },\n    {\n      h: 0,\n      s: 1,\n      b: 0.5,\n      name: 'dark red'\n    },\n    {\n      h: 0,\n      s: 1,\n      b: 1,\n      name: 'red'\n    },\n    {\n      h: 5,\n      s: 0,\n      b: 1,\n      name: 'very light peach'\n    },\n    {\n      h: 5,\n      s: 0.5,\n      b: 0.5,\n      name: 'brown'\n    },\n    {\n      h: 5,\n      s: 0.5,\n      b: 1,\n      name: 'peach'\n    },\n    {\n      h: 5,\n      s: 1,\n      b: 0.5,\n      name: 'brick red'\n    },\n    {\n      h: 5,\n      s: 1,\n      b: 1,\n      name: 'crimson'\n    },\n    {\n      h: 10,\n      s: 0,\n      b: 1,\n      name: 'light peach'\n    },\n    {\n      h: 10,\n      s: 0.5,\n      b: 0.5,\n      name: 'brown'\n    },\n    {\n      h: 10,\n      s: 0.5,\n      b: 1,\n      name: 'light orange'\n    },\n    {\n      h: 10,\n      s: 1,\n      b: 0.5,\n      name: 'brown'\n    },\n    {\n      h: 10,\n      s: 1,\n      b: 1,\n      name: 'orange'\n    },\n    {\n      h: 15,\n      s: 0,\n      b: 1,\n      name: 'very light yellow'\n    },\n    {\n      h: 15,\n      s: 0.5,\n      b: 0.5,\n      name: 'olive green'\n    },\n    {\n      h: 15,\n      s: 0.5,\n      b: 1,\n      name: 'light yellow'\n    },\n    {\n      h: 15,\n      s: 1,\n      b: 0,\n      name: 'dark olive green'\n    },\n    {\n      h: 15,\n      s: 1,\n      b: 0.5,\n      name: 'olive green'\n    },\n    {\n      h: 15,\n      s: 1,\n      b: 1,\n      name: 'yellow'\n    },\n    {\n      h: 20,\n      s: 0,\n      b: 1,\n      name: 'very light yellow'\n    },\n    {\n      h: 20,\n      s: 0.5,\n      b: 0.5,\n      name: 'olive green'\n    },\n    {\n      h: 20,\n      s: 0.5,\n      b: 1,\n      name: 'light yellow green'\n    },\n    {\n      h: 20,\n      s: 1,\n      b: 0,\n      name: 'dark olive green'\n    },\n    {\n      h: 20,\n      s: 1,\n      b: 0.5,\n      name: 'dark yellow green'\n    },\n    {\n      h: 20,\n      s: 1,\n      b: 1,\n      name: 'yellow green'\n    },\n    {\n      h: 25,\n      s: 0.5,\n      b: 0.5,\n      name: 'dark yellow green'\n    },\n    {\n      h: 25,\n      s: 0.5,\n      b: 1,\n      name: 'light green'\n    },\n    {\n      h: 25,\n      s: 1,\n      b: 0.5,\n      name: 'dark green'\n    },\n    {\n      h: 25,\n      s: 1,\n      b: 1,\n      name: 'green'\n    },\n    {\n      h: 30,\n      s: 0.5,\n      b: 1,\n      name: 'light green'\n    },\n    {\n      h: 30,\n      s: 1,\n      b: 0.5,\n      name: 'dark green'\n    },\n    {\n      h: 30,\n      s: 1,\n      b: 1,\n      name: 'green'\n    },\n    {\n      h: 35,\n      s: 0,\n      b: 0.5,\n      name: 'light green'\n    },\n    {\n      h: 35,\n      s: 0,\n      b: 1,\n      name: 'very light green'\n    },\n    {\n      h: 35,\n      s: 0.5,\n      b: 0.5,\n      name: 'dark green'\n    },\n    {\n      h: 35,\n      s: 0.5,\n      b: 1,\n      name: 'light green'\n    },\n    {\n      h: 35,\n      s: 1,\n      b: 0,\n      name: 'very dark green'\n    },\n    {\n      h: 35,\n      s: 1,\n      b: 0.5,\n      name: 'dark green'\n    },\n    {\n      h: 35,\n      s: 1,\n      b: 1,\n      name: 'green'\n    },\n    {\n      h: 40,\n      s: 0,\n      b: 1,\n      name: 'very light green'\n    },\n    {\n      h: 40,\n      s: 0.5,\n      b: 0.5,\n      name: 'dark green'\n    },\n    {\n      h: 40,\n      s: 0.5,\n      b: 1,\n      name: 'light green'\n    },\n    {\n      h: 40,\n      s: 1,\n      b: 0.5,\n      name: 'dark green'\n    },\n    {\n      h: 40,\n      s: 1,\n      b: 1,\n      name: 'green'\n    },\n    {\n      h: 45,\n      s: 0.5,\n      b: 1,\n      name: 'light turquoise'\n    },\n    {\n      h: 45,\n      s: 1,\n      b: 0.5,\n      name: 'dark turquoise'\n    },\n    {\n      h: 45,\n      s: 1,\n      b: 1,\n      name: 'turquoise'\n    },\n    {\n      h: 50,\n      s: 0,\n      b: 1,\n      name: 'light sky blue'\n    },\n    {\n      h: 50,\n      s: 0.5,\n      b: 0.5,\n      name: 'dark cyan'\n    },\n    {\n      h: 50,\n      s: 0.5,\n      b: 1,\n      name: 'light cyan'\n    },\n    {\n      h: 50,\n      s: 1,\n      b: 0.5,\n      name: 'dark cyan'\n    },\n    {\n      h: 50,\n      s: 1,\n      b: 1,\n      name: 'cyan'\n    },\n    {\n      h: 55,\n      s: 0,\n      b: 1,\n      name: 'light sky blue'\n    },\n    {\n      h: 55,\n      s: 0.5,\n      b: 1,\n      name: 'light sky blue'\n    },\n    {\n      h: 55,\n      s: 1,\n      b: 0.5,\n      name: 'dark blue'\n    },\n    {\n      h: 55,\n      s: 1,\n      b: 1,\n      name: 'sky blue'\n    },\n    {\n      h: 60,\n      s: 0,\n      b: 0.5,\n      name: 'gray'\n    },\n    {\n      h: 60,\n      s: 0,\n      b: 1,\n      name: 'very light blue'\n    },\n    {\n      h: 60,\n      s: 0.5,\n      b: 0.5,\n      name: 'blue'\n    },\n    {\n      h: 60,\n      s: 0.5,\n      b: 1,\n      name: 'light blue'\n    },\n    {\n      h: 60,\n      s: 1,\n      b: 0.5,\n      name: 'navy blue'\n    },\n    {\n      h: 60,\n      s: 1,\n      b: 1,\n      name: 'blue'\n    },\n    {\n      h: 65,\n      s: 0,\n      b: 1,\n      name: 'lavender'\n    },\n    {\n      h: 65,\n      s: 0.5,\n      b: 0.5,\n      name: 'navy blue'\n    },\n    {\n      h: 65,\n      s: 0.5,\n      b: 1,\n      name: 'light purple'\n    },\n    {\n      h: 65,\n      s: 1,\n      b: 0.5,\n      name: 'dark navy blue'\n    },\n    {\n      h: 65,\n      s: 1,\n      b: 1,\n      name: 'blue'\n    },\n    {\n      h: 70,\n      s: 0,\n      b: 1,\n      name: 'lavender'\n    },\n    {\n      h: 70,\n      s: 0.5,\n      b: 0.5,\n      name: 'navy blue'\n    },\n    {\n      h: 70,\n      s: 0.5,\n      b: 1,\n      name: 'lavender blue'\n    },\n    {\n      h: 70,\n      s: 1,\n      b: 0.5,\n      name: 'dark navy blue'\n    },\n    {\n      h: 70,\n      s: 1,\n      b: 1,\n      name: 'blue'\n    },\n    {\n      h: 75,\n      s: 0.5,\n      b: 1,\n      name: 'lavender'\n    },\n    {\n      h: 75,\n      s: 1,\n      b: 0.5,\n      name: 'dark purple'\n    },\n    {\n      h: 75,\n      s: 1,\n      b: 1,\n      name: 'purple'\n    },\n    {\n      h: 80,\n      s: 0.5,\n      b: 1,\n      name: 'pinkish purple'\n    },\n    {\n      h: 80,\n      s: 1,\n      b: 0.5,\n      name: 'dark purple'\n    },\n    {\n      h: 80,\n      s: 1,\n      b: 1,\n      name: 'purple'\n    },\n    {\n      h: 85,\n      s: 0,\n      b: 1,\n      name: 'light pink'\n    },\n    {\n      h: 85,\n      s: 0.5,\n      b: 0.5,\n      name: 'purple'\n    },\n    {\n      h: 85,\n      s: 0.5,\n      b: 1,\n      name: 'light fuchsia'\n    },\n    {\n      h: 85,\n      s: 1,\n      b: 0.5,\n      name: 'dark fuchsia'\n    },\n    {\n      h: 85,\n      s: 1,\n      b: 1,\n      name: 'fuchsia'\n    },\n    {\n      h: 90,\n      s: 0.5,\n      b: 0.5,\n      name: 'dark fuchsia'\n    },\n    {\n      h: 90,\n      s: 0.5,\n      b: 1,\n      name: 'hot pink'\n    },\n    {\n      h: 90,\n      s: 1,\n      b: 0.5,\n      name: 'dark fuchsia'\n    },\n    {\n      h: 90,\n      s: 1,\n      b: 1,\n      name: 'fuchsia'\n    },\n    {\n      h: 95,\n      s: 0,\n      b: 1,\n      name: 'pink'\n    },\n    {\n      h: 95,\n      s: 0.5,\n      b: 1,\n      name: 'light pink'\n    },\n    {\n      h: 95,\n      s: 1,\n      b: 0.5,\n      name: 'dark magenta'\n    },\n    {\n      h: 95,\n      s: 1,\n      b: 1,\n      name: 'magenta'\n    }\n  ];\n\n  //returns text with color name\n  function _calculateColor(hsb) {\n    let colortext;\n    //round hue\n    if (hsb[0] !== 0) {\n      hsb[0] = Math.round(hsb[0] * 100);\n      let hue = hsb[0].toString().split('');\n      const last = hue.length - 1;\n      hue[last] = parseInt(hue[last]);\n      //if last digit of hue is < 2.5 make it 0\n      if (hue[last] < 2.5) {\n        hue[last] = 0;\n        //if last digit of hue is >= 2.5 and less than 7.5 make it 5\n      } else if (hue[last] >= 2.5 && hue[last] < 7.5) {\n        hue[last] = 5;\n      }\n      //if hue only has two digits\n      if (hue.length === 2) {\n        hue[0] = parseInt(hue[0]);\n        //if last is greater than 7.5\n        if (hue[last] >= 7.5) {\n          //add one to the tens\n          hue[last] = 0;\n          hue[0] = hue[0] + 1;\n        }\n        hsb[0] = hue[0] * 10 + hue[1];\n      } else {\n        if (hue[last] >= 7.5) {\n          hsb[0] = 10;\n        } else {\n          hsb[0] = hue[last];\n        }\n      }\n    }\n    //map brightness from 0 to 1\n    hsb[2] = hsb[2] / 255;\n    //round saturation and brightness\n    for (let i = hsb.length - 1; i >= 1; i--) {\n      if (hsb[i] <= 0.25) {\n        hsb[i] = 0;\n      } else if (hsb[i] > 0.25 && hsb[i] < 0.75) {\n        hsb[i] = 0.5;\n      } else {\n        hsb[i] = 1;\n      }\n    }\n    //after rounding, if the values are hue 0, saturation 0 and brightness 1\n    //look at color exceptions which includes several tones from white to gray\n    if (hsb[0] === 0 && hsb[1] === 0 && hsb[2] === 1) {\n      //round original hsb values\n      for (let i = 2; i >= 0; i--) {\n        originalHSB[i] = Math.round(originalHSB[i] * 10000) / 10000;\n      }\n      //compare with the values in the colorExceptions array\n      for (let e = 0; e < colorExceptions.length; e++) {\n        if (\n          colorExceptions[e].h === originalHSB[0] &&\n          colorExceptions[e].s === originalHSB[1] &&\n          colorExceptions[e].b === originalHSB[2]\n        ) {\n          colortext = colorExceptions[e].name;\n          break;\n        } else {\n          //if there is no match return white\n          colortext = 'white';\n        }\n      }\n    } else {\n      //otherwise, compare with values in colorLookUp\n      for (let i = 0; i < colorLookUp.length; i++) {\n        if (\n          colorLookUp[i].h === hsb[0] &&\n          colorLookUp[i].s === hsb[1] &&\n          colorLookUp[i].b === hsb[2]\n        ) {\n          colortext = colorLookUp[i].name;\n          break;\n        }\n      }\n    }\n    return colortext;\n  }\n\n  //gets rgba and returs a color name\n  fn._rgbColorName = function(arg) {\n    //conversts rgba to hsb\n    let hsb = color_conversion._rgbaToHSBA(arg);\n    //stores hsb in global variable\n    originalHSB = hsb;\n    //calculate color name\n    return _calculateColor([hsb[0], hsb[1], hsb[2]]);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  colorNamer(p5, p5.prototype);\n}\n\nexport { colorNamer as default };\n","import i18next from 'i18next';\nimport LanguageDetector from 'i18next-browser-languagedetector';\n\nvar fes = {\n\tautoplay: \"The media that tried to play (with '{{src}}') wasn't allowed to by this browser, most likely due to the browser's autoplay policy.\\n\\n+ More info: {{url}}\",\n\tcheckUserDefinedFns: \"It seems that you may have accidentally written {{name}} instead of {{actualName}}. Please correct it if it's not intentional.\",\n\tfileLoadError: {\n\t\tbytes: \"It looks like there was a problem loading your file. {{suggestion}}\",\n\t\tfont: \"It looks like there was a problem loading your font. {{suggestion}}\",\n\t\tgif: \"There was some trouble loading your GIF. Make sure that your GIF is using 87a or 89a encoding.\",\n\t\timage: \"It looks like there was a problem loading your image. {{suggestion}}\",\n\t\tjson: \"It looks like there was a problem loading your JSON file. {{suggestion}}\",\n\t\tlarge: \"If your large file isn't fetched successfully, we recommend splitting the file into smaller segments and fetching those.\",\n\t\tstrings: \"It looks like there was a problem loading your text file. {{suggestion}}\",\n\t\tsuggestion: \"Try checking if the file path ({{filePath}}) is correct, hosting the file online, or running a local server.\\n\\n+ More info: {{url}}\",\n\t\ttable: \"It looks like there was a problem loading your table file. {{suggestion}}\",\n\t\txml: \"It looks like there was a problem loading your XML file. {{suggestion}}\"\n\t},\n\tfriendlyParamError: {\n\t\ttype_EMPTY_VAR: \"{{location}} {{func}}() was expecting {{formatType}} for the {{position}} parameter, received an empty variable instead. If not intentional, this is often a problem with scope.\\n\\n+ More info: {{url}}\",\n\t\ttype_TOO_FEW_ARGUMENTS: \"{{location}} {{func}}() was expecting at least {{minParams}} arguments, but received only {{argCount}}.\",\n\t\ttype_TOO_MANY_ARGUMENTS: \"{{location}} {{func}}() was expecting no more than {{maxParams}} arguments, but received {{argCount}}.\",\n\t\ttype_WRONG_TYPE: \"{{location}} {{func}}() was expecting {{formatType}} for the {{position}} parameter, received {{argType}} instead.\"\n\t},\n\tglobalErrors: {\n\t\treference: {\n\t\t\tcannotAccess: \"\\n{{location}} \\\"{{symbol}}\\\" is used before declaration. Make sure you have declared the variable before using it.\\n\\n+ More info: {{url}}\",\n\t\t\tnotDefined: \"\\n{{location}} \\\"{{symbol}}\\\" is not defined in the current scope. If you have defined it in your code, you should check its scope, spelling, and letter-casing (JavaScript is case-sensitive).\\n\\n+ More info: {{url}}\"\n\t\t},\n\t\tstackSubseq: \"[{{location}}] \\n\\t Called from line {{line}} in {{func}}()\\n\",\n\t\tstackTop: \"[{{location}}] \\n\\t Error at line {{line}} in {{func}}()\\n\",\n\t\tsyntax: {\n\t\t\tbadReturnOrYield: \"\\nSyntax Error - return lies outside of a function. Make sure youre not missing any brackets, so that return lies inside a function.\\n\\n+ More info: {{url}}\",\n\t\t\tinvalidToken: \"\\nSyntax Error - Found a symbol that JavaScript doesn't recognize or didn't expect at it's place.\\n\\n+ More info: {{url}}\",\n\t\t\tmissingInitializer: \"\\nSyntax Error - A const variable is declared but not initialized. In JavaScript, an initializer for a const is required. A value must be specified in the same statement in which the variable is declared. Check the line number in the error and assign the const variable a value.\\n\\n+ More info: {{url}}\",\n\t\t\tredeclaredVariable: \"\\nSyntax Error - \\\"{{symbol}}\\\" is being redeclared. JavaScript doesn't allow declaring a variable more than once. Check the line number in error for redeclaration of the variable.\\n\\n+ More info: {{url}}\",\n\t\t\tunexpectedToken: \"\\nSyntax Error - Symbol present at a place that wasn't expected.\\nUsually this is due to a typo. Check the line number in the error for anything missing/extra.\\n\\n+ More info: {{url}}\"\n\t\t},\n\t\ttype: {\n\t\t\tconstAssign: \"\\n{{location}} A const variable is being re-assigned. In javascript, re-assigning a value to a constant is not allowed. If you want to re-assign new values to a variable, make sure it is declared as var or let.\\n\\n+ More info: {{url}}\",\n\t\t\tnotfunc: \"\\n{{location}} \\\"{{symbol}}\\\" could not be called as a function.\\nCheck the spelling, letter-casing (JavaScript is case-sensitive) and its type.\\n\\n+ More info: {{url}}\",\n\t\t\tnotfuncObj: \"\\n{{location}} \\\"{{symbol}}\\\" could not be called as a function.\\nVerify whether \\\"{{obj}}\\\" has \\\"{{symbol}}\\\" in it and check the spelling, letter-casing (JavaScript is case-sensitive) and its type.\\n\\n+ More info: {{url}}\",\n\t\t\treadFromNull: \"\\n{{location}} The property of null can't be read. In javascript the value null indicates that an object has no value.\\n\\n+ More info: {{url}}\",\n\t\t\treadFromUndefined: \"\\n{{location}} Cannot read property of undefined. Check the line number in error and make sure the variable which is being operated is not undefined.\\n\\n + More info: {{url}}\"\n\t\t}\n\t},\n\tlibraryError: \"{{location}} An error with message \\\"{{error}}\\\" occurred inside the p5js library when {{func}} was called. If not stated otherwise, it might be an issue with the arguments passed to {{func}}.\",\n\tlocation: \"[{{file}}, line {{line}}]\",\n\tmisspelling: \"{{location}} It seems that you may have accidentally written \\\"{{name}}\\\" instead of \\\"{{actualName}}\\\". Please correct it to {{actualName}} if you wish to use the {{type}} from p5.js.\",\n\tmisspelling_plural: \"{{location}} It seems that you may have accidentally written \\\"{{name}}\\\".\\nYou may have meant one of the following: \\n{{suggestions}}\",\n\tmisusedTopLevel: \"Did you just try to use p5.js's {{symbolName}} {{symbolType}}? If so, you may want to move it into your sketch's setup() function.\\n\\n+ More info: {{url}}\",\n\tpreloadDisabled: \"The preload() function has been removed in p5.js 2.0. Please load assets in setup() using async / await keywords or callbacks instead. See https://dev.to/limzykenneth/asynchronous-p5js-20-458f for more information.\",\n\tpositions: {\n\t\tp_1: \"first\",\n\t\tp_10: \"tenth\",\n\t\tp_11: \"eleventh\",\n\t\tp_12: \"twelfth\",\n\t\tp_2: \"second\",\n\t\tp_3: \"third\",\n\t\tp_4: \"fourth\",\n\t\tp_5: \"fifth\",\n\t\tp_6: \"sixth\",\n\t\tp_7: \"seventh\",\n\t\tp_8: \"eighth\",\n\t\tp_9: \"ninth\"\n\t},\n\tpre: \"\\n p5.js says: {{message}}\",\n\tsketchReaderErrors: {\n\t\treservedConst: \"you have used a p5.js reserved variable \\\"{{symbol}}\\\" make sure you change the variable name to something else.\\n\\n+ More info: {{url}}\",\n\t\treservedFunc: \"you have used a p5.js reserved function \\\"{{symbol}}\\\" make sure you change the function name to something else.\\n\\n+ More info: {{url}}\"\n\t},\n\twelcome: \"Welcome! This is your friendly debugger. To turn me off, switch to using p5.min.js.\",\n\twrongPreload: \"{{location}} An error with message \\\"{{error}}\\\" occurred inside the p5js library when \\\"{{func}}\\\" was called. If not stated otherwise, it might be due to \\\"{{func}}\\\" being called from preload. Nothing besides load calls (loadImage, loadJSON, loadFont, loadStrings, etc.) should be inside the preload function.\"\n};\nvar en = {\n\tfes: fes\n};\n\n// Only one language is imported above. This is intentional as other languages\n// will be hosted online and then downloaded whenever needed\n\n/*\n * Here, we define a default/fallback language which we can use without internet.\n * You won't have to change this when adding a new language.\n *\n * `translation` is the namespace we are using for our initial set of strings\n */\nvar fallbackResources = {\n  en: {\n    translation: en\n  }\n};\n\n/*\n * This is a list of languages that we have added so far.\n * If you have just added a new language (yay!), add its key to the list below\n * (`en` is english, `es` es espaol). Also add its export to\n * dev.js, which is another file in this folder.\n * @private\n */\nconst languages = [\n  'en',\n  'es',\n  'ko',\n  'zh',\n  'hi',\n  'ja'\n];\n\nif (typeof IS_MINIFIED === 'undefined') {\n  // internationalization is only for the unminified build\n\n  if (typeof P5_DEV_BUILD !== 'undefined') {\n    // When the library is built in development mode ( using npm run dev )\n    // we want to use the current translation files on the disk, which may have\n    // been updated but not yet pushed to the CDN.\n    let completeResources = require('../../translations/dev');\n    for (const language of Object.keys(completeResources)) {\n      // In es_translation, language is es and namespace is translation\n      // In es_MX_translation, language is es-MX and namespace is translation\n      const parts = language.split('_');\n      const lng = parts.slice(0, parts.length - 1).join('-');\n      const ns = parts[parts.length - 1];\n\n      fallbackResources[lng] = fallbackResources[lng] || {};\n      fallbackResources[lng][ns] = completeResources[language];\n    }\n  }\n}\n\n/*\n * This is our i18next \"backend\" plugin. It tries to fetch languages\n * from a CDN.\n * @private\n */\nclass FetchResources {\n  constructor(services, options) {\n    this.init(services, options);\n  }\n\n  // run fetch with a timeout. Automatically rejects on timeout\n  // default timeout = 2000 ms\n  fetchWithTimeout(url, options, timeout = 2000) {\n    return Promise.race([\n      fetch(url, options),\n      new Promise((_, reject) =>\n        setTimeout(() => reject(new Error('timeout')), timeout)\n      )\n    ]);\n  }\n\n  init(services, options = {}) {\n    this.services = services;\n    this.options = options;\n  }\n\n  read(language, namespace, callback) {\n    const loadPath = this.options.loadPath;\n\n    if (language === this.options.fallback) {\n      // if the default language of the user is the same as our inbuilt fallback,\n      // there's no need to fetch resources from the cdn. This won't actually\n      // need to run when we use \"partialBundledLanguages\" in the init\n      // function.\n      callback(null, fallbackResources[language][namespace]);\n    } else if (languages.includes(language)) {\n      // The user's language is included in the list of languages\n      // that we so far added translations for.\n\n      const url = this.services.interpolator.interpolate(loadPath, {\n        lng: language,\n        ns: namespace\n      });\n      this.loadUrl(url, callback);\n    } else {\n      // We don't have translations for this language. i18next will use\n      // the default language instead.\n      callback('Not found', false);\n    }\n  }\n\n  loadUrl(url, callback) {\n    this.fetchWithTimeout(url)\n      .then(\n        response => {\n          const ok = response.ok;\n\n          if (!ok) {\n            // caught in the catch() below\n            throw new Error(`failed loading ${url}`);\n          }\n          return response.json();\n        },\n        () => {\n          // caught in the catch() below\n          throw new Error(`failed loading ${url}`);\n        }\n      )\n      .then(data => {\n        return callback(null, data);\n      })\n      .catch(callback);\n  }\n}\nFetchResources.type = 'backend';\n\n/**\n * This is our translation function. Give it a key and\n * it will retrieve the appropriate string\n * (within supported languages) according to the\n * user's browser's language settings.\n * @function translator\n * @param {String} key a key that corresponds to a message in our translation files\n * @param {Object} values values for use in the message under the given `key`\n * @returns {String} message (with values inserted) in the user's browser language\n * @private\n */\nlet translator = (key, values) => {\n  console.debug('p5.js translator called before translations were loaded');\n\n  // Certain FES functionality may trigger before translations are downloaded.\n  // Using \"partialBundledLanguages\" option during initialization, we can\n  // still use our fallback language to display messages\n  i18next.t(key, values); /* i18next-extract-disable-line */\n};\n// (We'll set this to a real value in the init function below!)\n\n/*\n * Set up our translation function, with loaded languages\n * @private\n */\nconst initialize = () => {\n  let i18init = i18next\n    .use(LanguageDetector)\n    .use(FetchResources)\n    .init({\n      fallbackLng: 'en',\n      nestingPrefix: '$tr(',\n      nestingSuffix: ')',\n      defaultNS: 'translation',\n      returnEmptyString: false,\n      interpolation: {\n        escapeValue: false\n      },\n      detection: {\n        checkWhitelist: false,\n\n        // prevent storing or locating language from cookie or localStorage\n        // more info on https://github.com/processing/p5.js/issues/4862\n        order: ['querystring', 'navigator', 'htmlTag', 'path', 'subdomain'],\n        caches: []\n      },\n      backend: {\n        fallback: 'en',\n        loadPath:\n          'https://cdn.jsdelivr.net/npm/p5/translations/{{lng}}/{{ns}}.json'\n      },\n      partialBundledLanguages: true,\n      resources: fallbackResources\n    })\n    .then(\n      translateFn => {\n        translator = translateFn;\n      },\n      e => console.debug(`Translations failed to load (${e})`)\n    );\n\n  // i18next.init() returns a promise that resolves when the translations\n  // are loaded. We use this in core/init.js to hold p5 initialization until\n  // we have the translation files.\n  return i18init;\n};\n\n/*\n * Returns a list of languages we have translations loaded for\n * @private\n */\nconst availableTranslatorLanguages = () => {\n  return i18next.languages;\n};\n\n/*\n * Returns the current language selected for translation\n * @private\n */\nconst currentTranslatorLanguage = language => {\n  return i18next.language;\n};\n\n/*\n * Sets the current language for translation\n * Returns a promise that resolved when loading is finished,\n * or rejects if it fails.\n * @private\n */\nconst setTranslatorLanguage = language => {\n  return i18next.changeLanguage(language || undefined, e =>\n    console.debug(`Translations failed to load (${e})`)\n  );\n};\n\nexport { availableTranslatorLanguages, currentTranslatorLanguage, initialize, setTranslatorLanguage, translator };\n","// This contains a data table used by ./fes_core.js/fesErrorMonitor().\n//\n// Note: Different browsers use different error strings for the same error.\n// Extracting info from the browser error messages is easier and cleaner\n// if we have a predefined lookup. This file serves as that lookup.\n// Using this lookup we match the errors obtained from the browser, classify\n// them into types and extract the required information.\n// The FES can use the extracted info to generate a friendly error message\n// for the matching error.\nconst strings = {\n  ReferenceError: [\n    {\n      msg: '{{}} is not defined',\n      type: 'NOTDEFINED',\n      browser: 'all'\n    },\n    {\n      msg: \"Can't find variable: {{}}\",\n      type: 'NOTDEFINED',\n      browser: 'Safari'\n    },\n    {\n      msg: \"Cannot access '{{.}}' before initialization\",\n      type: 'CANNOTACCESS',\n      browser: 'Chrome'\n    },\n    {\n      msg: \"can't access lexical declaration '{{.}}' before initialization\",\n      type: 'CANNOTACCESS',\n      browser: 'Firefox'\n    }\n  ],\n  SyntaxError: [\n    {\n      msg: 'illegal character',\n      type: 'INVALIDTOKEN',\n      browser: 'Firefox'\n    },\n    {\n      msg: 'Invalid character',\n      type: 'INVALIDTOKEN',\n      browser: 'Safari'\n    },\n    {\n      msg: 'Invalid or unexpected token',\n      type: 'INVALIDTOKEN',\n      browser: 'Chrome'\n    },\n    {\n      msg: \"Unexpected token '{{.}}'\",\n      type: 'UNEXPECTEDTOKEN',\n      browser: 'Chrome'\n    },\n    {\n      msg: \"expected {{.}}, got '{{.}}'\",\n      type: 'UNEXPECTEDTOKEN',\n      browser: 'Chrome'\n    },\n    {\n      msg: \"Identifier '{{.}}' has already been declared\",\n      type: 'REDECLAREDVARIABLE',\n      browser: 'Chrome'\n    },\n    {\n      msg: 'redeclaration of {} {{.}}',\n      type: 'REDECLAREDVARIABLE',\n      browser: 'Firefox'\n    },\n    {\n      msg: 'Missing initializer in const declaration',\n      type: 'MISSINGINITIALIZER',\n      browser: 'Chrome'\n    },\n    {\n      msg: 'missing = in const declaration',\n      type: 'MISSINGINITIALIZER',\n      browser: 'Firefox'\n    },\n    {\n      msg: 'Illegal return statement',\n      type: 'BADRETURNORYIELD',\n      browser: 'Chrome'\n    },\n    {\n      msg: 'return not in function',\n      type: 'BADRETURNORYIELD',\n      browser: 'Firefox'\n    }\n  ],\n  TypeError: [\n    {\n      msg: '{{.}} is not a function',\n      type: 'NOTFUNC',\n      browser: 'all'\n    },\n    {\n      msg: 'Cannot read {{.}} null',\n      type: 'READNULL',\n      browser: 'Chrome'\n    },\n    {\n      msg: '{{.}} is null',\n      type: 'READNULL',\n      browser: 'Firefox'\n    },\n    {\n      msg: 'Cannot read {{.}} undefined',\n      type: 'READUDEFINED',\n      browser: 'Chrome'\n    },\n    {\n      msg: '{{.}} is undefined',\n      type: 'READUDEFINED',\n      browser: 'Firefox'\n    },\n    {\n      msg: 'Assignment to constant variable',\n      type: 'CONSTASSIGN',\n      browser: 'Chrome'\n    },\n    {\n      msg: \"invalid assignment to const '{{.}}'\",\n      type: 'CONSTASSIGN',\n      browser: 'Firefox'\n    }\n  ]\n};\n\nexport { strings as default };\n","import { translator } from '../internationalization.js';\nimport strings from './browser_errors.js';\nimport { v as constants } from '../../constants-8IpwyBct.js';\nimport 'i18next';\nimport 'i18next-browser-languagedetector';\n\n/**\n * @for p5\n * @requires core\n *\n * This is the main file for the Friendly Error System (FES), containing\n * the core as well as miscellaneous functionality of the FES. Here is a\n * brief outline of the functions called in this system.\n *\n * The FES may be invoked by a call to either\n * (1) _validateParameters, (2) _friendlyFileLoadError, (3) _friendlyError,\n * (4) helpForMisusedAtTopLevelCode, or (5) _fesErrorMonitor.\n *\n * _validateParameters is located in validate_params.js along with other code\n * used for parameter validation.\n * _friendlyFileLoadError is located in file_errors.js along with other code\n * used for dealing with file load errors.\n * Apart from this, there's also a file stacktrace.js, which contains the code\n * to parse the error stack, borrowed from:\n * https://github.com/stacktracejs/stacktrace.js\n *\n * For more detailed information on the FES functions, including the call\n * sequence of each function, please look at the FES Reference + Dev Notes:\n * https://github.com/processing/p5.js/blob/main/contributor_docs/fes_reference_dev_notes.md\n */\n\nfunction fesCore(p5, fn){\n  // p5.js blue, p5.js orange, auto dark green; fallback p5.js darkened magenta\n  // See testColors below for all the color codes and names\n  const typeColors = ['#2D7BB6', '#EE9900', '#4DB200', '#C83C00'];\n  let misusedAtTopLevelCode = null;\n  let defineMisusedAtTopLevelCode = null;\n\n  // the threshold for the maximum allowed levenshtein distance\n  // used in misspelling detection\n  const EDIT_DIST_THRESHOLD = 2;\n\n  // Used for internally thrown errors that should not get wrapped by another\n  // friendly error handler\n  class FESError extends Error {}\n  if (typeof IS_MINIFIED !== 'undefined') {\n    p5._friendlyError =\n      p5._checkForUserDefinedFunctions =\n      p5._fesErrorMonitor =\n      () => {};\n  } else {\n\n    // const errorTable = require('./browser_errors').default;\n\n    // -- Borrowed from jQuery 1.11.3 --\n    const class2type = {};\n    const toString = class2type.toString;\n    const names = [\n      'Boolean',\n      'Number',\n      'String',\n      'Function',\n      'Array',\n      'Date',\n      'RegExp',\n      'Object',\n      'Error'\n    ];\n    for (let n = 0; n < names.length; n++) {\n      class2type[`[object ${names[n]}]`] = names[n].toLowerCase();\n    }\n    const getType = obj => {\n      if (obj == null) {\n        return `${obj}`;\n      }\n      return typeof obj === 'object' || typeof obj === 'function'\n        ? class2type[toString.call(obj)] || 'object'\n        : typeof obj;\n    };\n\n    // -- End borrow --\n\n    // entry points into user-defined code\n    const entryPoints = [\n      'setup',\n      'draw',\n      'deviceMoved',\n      'deviceTurned',\n      'deviceShaken',\n      'doubleClicked',\n      'mousePressed',\n      'mouseReleased',\n      'mouseMoved',\n      'mouseDragged',\n      'mouseClicked',\n      'mouseWheel',\n      'touchStarted',\n      'touchMoved',\n      'touchEnded',\n      'keyPressed',\n      'keyReleased',\n      'keyTyped',\n      'windowResized'\n    ];\n\n    /**\n     * Takes a message and a p5 function func, and adds a link pointing to\n     * the reference documentation of func at the end of the message\n     *\n     * @method mapToReference\n     * @private\n     * @param {String}  message   the words to be said\n     * @param {String}  [func]    the name of function\n     *\n     * @returns {String}\n     */\n    const mapToReference = (message, func) => {\n      let msgWithReference = '';\n      if (func == null || func.substring(0, 4) === 'load') {\n        msgWithReference = message;\n      } else {\n        const methodParts = func.split('.');\n        const referenceSection =\n          methodParts.length > 1 ? `${methodParts[0]}.${methodParts[1]}` : 'p5';\n\n        const funcName =\n          methodParts.length === 1 ? func : methodParts.slice(2).join('/');\n\n        //Whenever func having p5.[Class] is encountered, we need to have the error link as mentioned below else different link\n        funcName.startsWith('p5.')  ?\n          msgWithReference = `${message} (https://p5js.org/reference/${referenceSection}.${funcName})` :\n          msgWithReference = `${message} (https://p5js.org/reference/${referenceSection}/${funcName})`;\n      }\n      return msgWithReference;\n    };\n\n    /**\n     * Prints out a fancy, colorful message to the console log\n     * Attaches Friendly Errors prefix [fes.pre] to the message.\n     *\n     * @method _report\n     * @private\n     * @param  {String}          message  Message to be printed\n     * @param  {String}          [func]   Name of function\n     * @param  {Number|String}   [color]  CSS color code\n     *\n     * @return console logs\n     */\n    p5._report = (message, func, color) => {\n      // if p5._fesLogger is set ( i.e we are running tests ), use that\n      // instead of console.log\n      const log =\n        p5._fesLogger == null ? console.log.bind(console) : p5._fesLogger;\n      if ('undefined' === getType(color)) {\n        color = '#B40033'; // dark magenta\n      } else if (getType(color) === 'number') {\n        // Type to color\n        color = typeColors[color];\n      }\n\n      // Add a link to the reference docs of func at the end of the message\n      message = mapToReference(message, func);\n      const prefixedMsg = translator('fes.pre', { message });\n\n      {\n        log(prefixedMsg);\n      }\n    };\n\n    /**\n     * Throws an error with helpful p5 context. Similar to _report, but\n     * this will stop other code execution to prevent downstream errors\n     * from being logged.\n     *\n     * @method _error\n     * @private\n     * @param                    context  p5 instance the error is from\n     * @param  {String}          message  Message to be printed\n     * @param  {String}          [func]   Name of function\n     */\n    p5._error = (context, message, func) => {\n      p5._report(message, func);\n      context.hitCriticalError = true;\n      // Throw an error to stop the current function (e.g. setup or draw) from\n      // running more code\n      throw new FESError('Stopping sketch to prevent more errors');\n    };\n\n    /**\n     * This is a generic method that can be called from anywhere in the p5\n     * library to alert users to a common error.\n     *\n     * @method _friendlyError\n     * @private\n     * @param  {String}         message   Message to be printed\n     * @param  {String}         [func]    Name of the function linked to error\n     * @param  {Number|String}  [color]   CSS color code\n     */\n    p5._friendlyError = function(message, func, color) {\n      p5._report(message, func, color);\n    };\n\n    /**\n     * This is called internally if there is an error with autoplay. Generates\n     * and prints a friendly error message [fes.autoplay].\n     *\n     * @method _friendlyAutoplayError\n     * @private\n     */\n    p5._friendlyAutoplayError = function(src) {\n      const message = translator('fes.autoplay', {\n        src,\n        url: 'https://developer.mozilla.org/docs/Web/Media/Autoplay_guide'\n      });\n      console.log(translator('fes.pre', { message }));\n    };\n\n    /**\n     * Measures dissimilarity between two strings by calculating\n     * the Levenshtein distance.\n     *\n     * If the \"distance\" between them is small enough, it is\n     * reasonable to think that one is the misspelled version of the other.\n     *\n     * Specifically, this uses the WagnerFischer algorithm.\n     * @method computeEditDistance\n     * @private\n     * @param {String} w1 the first word\n     * @param {String} w2 the second word\n     *\n     * @returns {Number} the \"distance\" between the two words, a smaller value\n     *                   indicates that the words are similar\n     */\n    const computeEditDistance = (w1, w2) => {\n      const l1 = w1.length,\n        l2 = w2.length;\n      if (l1 === 0) return w2;\n      if (l2 === 0) return w1;\n\n      let prev = [];\n      let cur = [];\n\n      for (let j = 0; j < l2 + 1; j++) {\n        cur[j] = j;\n      }\n\n      prev = cur;\n\n      for (let i = 1; i < l1 + 1; i++) {\n        cur = [];\n        for (let j = 0; j < l2 + 1; j++) {\n          if (j === 0) {\n            cur[j] = i;\n          } else {\n            let a1 = w1[i - 1],\n              a2 = w2[j - 1];\n            let temp = 999999;\n            let cost = a1.toLowerCase() === a2.toLowerCase() ? 0 : 1;\n            temp = temp > cost + prev[j - 1] ? cost + prev[j - 1] : temp;\n            temp = temp > 1 + cur[j - 1] ? 1 + cur[j - 1] : temp;\n            temp = temp > 1 + prev[j] ? 1 + prev[j] : temp;\n            cur[j] = temp;\n          }\n        }\n        prev = cur;\n      }\n\n      return cur[l2];\n    };\n\n    /**\n     * Whether or not p5.js is running in an environment where `preload` will be\n     * run before `setup`.\n     *\n     * This will return false for default builds >= 2.0, but backwards compatibility\n     * addons may set this to true.\n     *\n     * @private\n     */\n    p5.isPreloadSupported = function() {\n      return false;\n    };\n\n    /**\n     * Checks capitalization for user defined functions.\n     *\n     * Generates and prints a friendly error message using key:\n     * \"fes.checkUserDefinedFns\".\n     *\n     * @method checkForUserDefinedFunctions\n     * @private\n     * @param {*} context   Current default context. Set to window in\n     *                      \"global mode\" and to a p5 instance in \"instance mode\"\n     */\n    const checkForUserDefinedFunctions = context => {\n      if (p5.disableFriendlyErrors) return;\n\n      // if using instance mode, this function would be called with the current\n      // instance as context\n      const instanceMode = context instanceof p5;\n      context = instanceMode ? context : window;\n      const fnNames = entryPoints;\n\n      if (context.preload && !p5.isPreloadSupported()) {\n        p5._error(context, translator('fes.preloadDisabled'));\n      }\n\n      const fxns = {};\n      // lowercasename -> actualName mapping\n      fnNames.forEach(symbol => {\n        fxns[symbol.toLowerCase()] = symbol;\n      });\n\n      for (const prop of Object.keys(context)) {\n        const lowercase = prop.toLowerCase();\n\n        // check if the lowercase property name has an entry in fxns, if the\n        // actual name with correct capitalization doesnt exist in context,\n        // and if the user-defined symbol is of the type function\n        if (\n          fxns.hasOwnProperty(lowercase) &&\n          !context[fxns[lowercase]] &&\n          typeof context[prop] === 'function'\n        ) {\n          const msg = translator('fes.checkUserDefinedFns', {\n            name: prop,\n            actualName: fxns[lowercase]\n          });\n\n          p5._friendlyError(msg, fxns[lowercase]);\n        }\n      }\n    };\n\n    /**\n     * Compares the symbol caught in the ReferenceError to everything in\n     * misusedAtTopLevel ( all public p5 properties ).\n     *\n     * Generates and prints a friendly error message using key: \"fes.misspelling\".\n     *\n     * @method handleMisspelling\n     * @private\n     * @param {String} errSym   Symbol to whose spelling to check\n     * @param {Error} error     ReferenceError object\n     *\n     * @returns {Boolean} tell whether error was likely due to typo\n     */\n    const handleMisspelling = (errSym, error) => {\n      if (!misusedAtTopLevelCode) {\n        defineMisusedAtTopLevelCode();\n      }\n\n      const distanceMap = {};\n      let min = 999999;\n      // compute the levenshtein distance for the symbol against all known\n      // public p5 properties. Find the property with the minimum distance\n      misusedAtTopLevelCode.forEach(symbol => {\n        let dist = computeEditDistance(errSym, symbol.name);\n        if (distanceMap[dist]) distanceMap[dist].push(symbol);\n        else distanceMap[dist] = [symbol];\n\n        if (dist < min) min = dist;\n      });\n\n      // if the closest match has more \"distance\" than the max allowed threshold\n      if (min > Math.min(EDIT_DIST_THRESHOLD, errSym.length)) return false;\n\n      // Show a message only if the caught symbol and the matched property name\n      // differ in their name ( either letter difference or difference of case )\n      const matchedSymbols = distanceMap[min].filter(\n        symbol => symbol.name !== errSym\n      );\n      if (matchedSymbols.length !== 0) {\n        const parsed = p5._getErrorStackParser().parse(error);\n        let locationObj;\n        if (\n          parsed &&\n          parsed[0] &&\n          parsed[0].fileName &&\n          parsed[0].lineNumber &&\n          parsed[0].columnNumber\n        ) {\n          locationObj = {\n            location: `${parsed[0].fileName}:${parsed[0].lineNumber}:${\n              parsed[0].columnNumber\n            }`,\n            file: parsed[0].fileName.split('/').slice(-1),\n            line: parsed[0].lineNumber\n          };\n        }\n\n        let msg;\n        if (matchedSymbols.length === 1) {\n          // To be used when there is only one closest match. The count parameter\n          // allows i18n to pick between the keys \"fes.misspelling\" and\n          // \"fes.misspelling_plural\"\n          msg = translator('fes.misspelling', {\n            name: errSym,\n            actualName: matchedSymbols[0].name,\n            type: matchedSymbols[0].type,\n            location: locationObj ? translator('fes.location', locationObj) : '',\n            count: matchedSymbols.length\n          });\n        } else {\n          // To be used when there are multiple closest matches. Gives each\n          // suggestion on its own line, the function name followed by a link to\n          // reference documentation\n          const suggestions = matchedSymbols\n            .map(symbol => {\n              const message =\n                ' ' + symbol.name + (symbol.type === 'function' ? '()' : '');\n              return mapToReference(message, symbol.name);\n            })\n            .join('\\n');\n\n          msg = translator('fes.misspelling', {\n            name: errSym,\n            suggestions,\n            location: locationObj ? translator('fes.location', locationObj) : '',\n            count: matchedSymbols.length\n          });\n        }\n\n        // If there is only one closest match, tell _friendlyError to also add\n        // a link to the reference documentation. In case of multiple matches,\n        // this is already done in the suggestions variable, one link for each\n        // suggestion.\n        p5._friendlyError(\n          msg,\n          matchedSymbols.length === 1 ? matchedSymbols[0].name : undefined\n        );\n        return true;\n      }\n      return false;\n    };\n\n    /**\n     * Prints a friendly stacktrace for user-written functions for \"global\" errors\n     *\n     * Generates and prints a friendly error message using key:\n     * \"fes.globalErrors.stackTop\", \"fes.globalErrors.stackSubseq\".\n     *\n     * @method printFriendlyStack\n     * @private\n     * @param {Array} friendlyStack\n     */\n    const printFriendlyStack = friendlyStack => {\n      const log =\n        p5._fesLogger && typeof p5._fesLogger === 'function'\n          ? p5._fesLogger\n          : console.log.bind(console);\n      if (friendlyStack.length > 1) {\n        let stacktraceMsg = '';\n        friendlyStack.forEach((frame, idx) => {\n          const location = `${frame.fileName}:${frame.lineNumber}:${\n            frame.columnNumber\n          }`;\n          let frameMsg,\n            translationObj = {\n              func: frame.functionName,\n              line: frame.lineNumber,\n              location,\n              file: frame.fileName.split('/').slice(-1)\n            };\n          if (idx === 0) {\n            frameMsg = translator('fes.globalErrors.stackTop', translationObj);\n          } else {\n            frameMsg = translator('fes.globalErrors.stackSubseq', translationObj);\n          }\n          stacktraceMsg += frameMsg;\n        });\n        log(stacktraceMsg);\n      }\n    };\n\n    /**\n     * Takes a stacktrace array and filters out all frames that show internal p5\n     * details.\n     *\n     * Generates and prints a friendly error message using key:\n     * \"fes.wrongPreload\", \"fes.libraryError\".\n     *\n     * The processed stack is used to find whether the error happened internally\n     * within the library, and if the error was due to a non-loadX() method\n     * being used in preload.\n     *\n     * \"Internally\" here means that the exact location of the error (the top of\n     * the stack) is a piece of code written in the p5.js library (which may or\n     * may not have been called from the user's sketch).\n     *\n     * @method processStack\n     * @private\n     * @param {Error} error\n     * @param {Array} stacktrace\n     *\n     * @returns {Array} An array with two elements, [isInternal, friendlyStack]\n     *                 isInternal: a boolean value indicating whether the error\n     *                             happened internally\n     *                 friendlyStack: the filtered (simplified) stacktrace\n     */\n    const processStack = (error, stacktrace) => {\n      // cannot process a stacktrace that doesn't exist\n      if (!stacktrace) return [false, null];\n\n      stacktrace.forEach(frame => {\n        frame.functionName = frame.functionName || '';\n      });\n\n      // isInternal - Did this error happen inside the library\n      let isInternal = false;\n      let p5FileName, friendlyStack, currentEntryPoint;\n\n      // Intentionally throw an error that we catch so that we can check the name\n      // of the current file. Any errors we see from this file, we treat as\n      // internal errors.\n      try {\n        throw new Error();\n      } catch (testError) {\n        const testStacktrace = p5._getErrorStackParser().parse(testError);\n        p5FileName = testStacktrace[0].fileName;\n      }\n\n      for (let i = stacktrace.length - 1; i >= 0; i--) {\n        let splitted = stacktrace[i].functionName.split('.');\n        if (entryPoints.includes(splitted[splitted.length - 1])) {\n          // remove everything below an entry point function (setup, draw, etc).\n          // (it's usually the internal initialization calls)\n          friendlyStack = stacktrace.slice(0, i + 1);\n          currentEntryPoint = splitted[splitted.length - 1];\n          // We call the error \"internal\" if the source of the error was a\n          // function from within the p5.js library file, but called from the\n          // user's code directly. We only need to check the topmost frame in\n          // the stack trace since any function internal to p5 should pass this\n          // check, not just public p5 functions.\n          if (stacktrace[0].fileName === p5FileName) {\n            isInternal = true;\n            break;\n          }\n          break;\n        }\n      }\n\n      // in some cases ( errors in promises, callbacks, etc), no entry-point\n      // function may be found in the stacktrace. In that case just use the\n      // entire stacktrace for friendlyStack\n      if (!friendlyStack) friendlyStack = stacktrace;\n\n      if (isInternal) {\n        // the frameIndex property is added before the filter, so frameIndex\n        // corresponds to the index of a frame in the original stacktrace.\n        // Then we filter out all frames which belong to the file that contains\n        // the p5 library\n        friendlyStack = friendlyStack\n          .map((frame, index) => {\n            frame.frameIndex = index;\n            return frame;\n          })\n          .filter(frame => frame.fileName !== p5FileName);\n\n        // a weird case, if for some reason we can't identify the function called\n        // from user's code\n        if (friendlyStack.length === 0) return [true, null];\n\n        // get the function just above the topmost frame in the friendlyStack.\n        // i.e the name of the library function called from user's code\n        const func = stacktrace[friendlyStack[0].frameIndex - 2].functionName\n          .split('.')\n          .slice(-1)[0];\n\n        // Try and get the location (line no.) from the top element of the stack\n        let locationObj;\n        if (\n          friendlyStack[0].fileName &&\n          friendlyStack[0].lineNumber &&\n          friendlyStack[0].columnNumber\n        ) {\n          locationObj = {\n            location: `${friendlyStack[0].fileName}:${\n              friendlyStack[0].lineNumber\n            }:${friendlyStack[0].columnNumber}`,\n            file: friendlyStack[0].fileName.split('/').slice(-1),\n            line: friendlyStack[0].lineNumber\n          };\n\n          // if already handled by another part of the FES, don't handle again\n          if (p5._fesLogCache[locationObj.location]) return [true, null];\n        }\n\n        // Check if the error is due to a non loadX method being used incorrectly\n        // in preload\n        if (\n          currentEntryPoint === 'preload' &&\n          fn._preloadMethods[func] == null\n        ) {\n          p5._friendlyError(\n            translator('fes.wrongPreload', {\n              func,\n              location: locationObj\n                ? translator('fes.location', locationObj)\n                : '',\n              error: error.message\n            }),\n            'preload'\n          );\n        } else {\n          // Library error\n          p5._friendlyError(\n            translator('fes.libraryError', {\n              func,\n              location: locationObj\n                ? translator('fes.location', locationObj)\n                : '',\n              error: error.message\n            }),\n            func\n          );\n        }\n\n        // Finally, if it's an internal error, print the friendlyStack\n        // ( fesErrorMonitor won't handle this error )\n        if (friendlyStack && friendlyStack.length) {\n          printFriendlyStack(friendlyStack);\n        }\n      }\n      return [isInternal, friendlyStack];\n    };\n\n    /**\n     * Handles \"global\" errors that the browser catches.\n     *\n     * Called when an error event happens and detects the type of error.\n     *\n     * Generates and prints a friendly error message using key:\n     * \"fes.globalErrors.syntax.[*]\", \"fes.globalErrors.reference.[*]\",\n     * \"fes.globalErrors.type.[*]\".\n     *\n     * @method fesErrorMonitor\n     * @private\n     * @param {*} e  Event object to extract error details from\n     */\n    const fesErrorMonitor = e => {\n      if (p5.disableFriendlyErrors) return;\n\n      // Don't try to handle an error intentionally emitted by FES to halt execution\n      if (e && (e instanceof FESError || e.reason instanceof FESError)) return;\n\n      // Try to get the error object from e\n      let error;\n      if (e instanceof Error) {\n        error = e;\n      } else if (e instanceof ErrorEvent) {\n        error = e.error;\n      } else if (e instanceof PromiseRejectionEvent) {\n        error = e.reason;\n        if (!(error instanceof Error)) return;\n      }\n      if (!error) return;\n\n      let stacktrace = p5._getErrorStackParser().parse(error);\n      // process the stacktrace from the browser and simplify it to give\n      // friendlyStack.\n      let [isInternal, friendlyStack] = processStack(error, stacktrace);\n\n      // if this is an internal library error, the type of the error is not relevant,\n      // only the user code that lead to it is.\n      if (isInternal) {\n        return;\n      }\n\n      const errList = strings[error.name];\n      if (!errList) return; // this type of error can't be handled yet\n      let matchedError;\n      for (const obj of errList) {\n        let string = obj.msg;\n        // capture the primary symbol mentioned in the error\n        string = string.replace(new RegExp('{{}}', 'g'), '([a-zA-Z0-9_]+)');\n        string = string.replace(new RegExp('{{.}}', 'g'), '(.+)');\n        string = string.replace(new RegExp('{}', 'g'), '(?:[a-zA-Z0-9_]+)');\n        let matched = error.message.match(string);\n\n        if (matched) {\n          matchedError = Object.assign({}, obj);\n          matchedError.match = matched;\n          break;\n        }\n      }\n\n      if (!matchedError) return;\n\n      // Try and get the location from the top element of the stack\n      let locationObj;\n      if (\n        stacktrace &&\n        stacktrace[0].fileName &&\n        stacktrace[0].lineNumber &&\n        stacktrace[0].columnNumber\n      ) {\n        locationObj = {\n          location: `${stacktrace[0].fileName}:${stacktrace[0].lineNumber}:${\n            stacktrace[0].columnNumber\n          }`,\n          file: stacktrace[0].fileName.split('/').slice(-1),\n          line: friendlyStack[0].lineNumber\n        };\n      }\n\n      switch (error.name) {\n        case 'SyntaxError': {\n          // We can't really do much with syntax errors other than try to use\n          // a simpler framing of the error message. The stack isn't available\n          // for syntax errors\n          switch (matchedError.type) {\n            case 'INVALIDTOKEN': {\n              //Error if there is an invalid or unexpected token that doesn't belong at this position in the code\n              //let x = not a string; -> string not in proper quotes\n              let url =\n                'https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Illegal_character#What_went_wrong';\n              p5._friendlyError(\n                translator('fes.globalErrors.syntax.invalidToken', {\n                  url\n                })\n              );\n              break;\n            }\n            case 'UNEXPECTEDTOKEN': {\n              //Error if a specific language construct(, { ; etc) was expected, but something else was provided\n              //for (let i = 0; i < 5,; ++i) -> a comma after i<5 instead of a semicolon\n              let url =\n                'https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Unexpected_token#What_went_wrong';\n              p5._friendlyError(\n                translator('fes.globalErrors.syntax.unexpectedToken', {\n                  url\n                })\n              );\n              break;\n            }\n            case 'REDECLAREDVARIABLE': {\n              //Error if a variable is redeclared by the user. Example=>\n              //let a = 10;\n              //let a = 100;\n              let errSym = matchedError.match[1];\n              let url =\n                'https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Redeclared_parameter#what_went_wrong';\n              p5._friendlyError(\n                translator('fes.globalErrors.syntax.redeclaredVariable', {\n                  symbol: errSym,\n                  url\n                })\n              );\n              break;\n            }\n            case 'MISSINGINITIALIZER': {\n              //Error if a const variable is not initialized during declaration\n              //Example => const a;\n              let url =\n                'https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Missing_initializer_in_const#what_went_wrong';\n              p5._friendlyError(\n                translator('fes.globalErrors.syntax.missingInitializer', {\n                  url\n                })\n              );\n              break;\n            }\n            case 'BADRETURNORYIELD': {\n              //Error when a return statement is misplaced(usually outside of a function)\n              // const a = function(){\n              //  .....\n              //  }\n              //  return; -> misplaced return statement\n              let url =\n                'https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Bad_return_or_yield#what_went_wrong';\n              p5._friendlyError(\n                translator('fes.globalErrors.syntax.badReturnOrYield', {\n                  url\n                })\n              );\n              break;\n            }\n          }\n          break;\n        }\n        case 'ReferenceError': {\n          switch (matchedError.type) {\n            case 'NOTDEFINED': {\n              //Error if there is a non-existent variable referenced somewhere\n              //let a = 10;\n              //console.log(x);\n              let errSym = matchedError.match[1];\n\n              if (errSym && handleMisspelling(errSym, error)) {\n                break;\n              }\n\n              // if the flow gets this far, this is likely not a misspelling\n              // of a p5 property/function\n              let url = 'https://p5js.org/examples/data-variable-scope.html';\n              p5._friendlyError(\n                translator('fes.globalErrors.reference.notDefined', {\n                  url,\n                  symbol: errSym,\n                  location: locationObj\n                    ? translator('fes.location', locationObj)\n                    : ''\n                })\n              );\n\n              if (friendlyStack) printFriendlyStack(friendlyStack);\n              break;\n            }\n            case 'CANNOTACCESS': {\n              //Error if a lexical variable was accessed before it was initialized\n              //console.log(a); -> variable accessed before it was initialized\n              //let a=100;\n              let errSym = matchedError.match[1];\n              let url =\n                'https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_lexical_declaration_before_init#what_went_wrong';\n              p5._friendlyError(\n                translator('fes.globalErrors.reference.cannotAccess', {\n                  url,\n                  symbol: errSym,\n                  location: locationObj\n                    ? translator('fes.location', locationObj)\n                    : ''\n                })\n              );\n\n              if (friendlyStack) printFriendlyStack(friendlyStack);\n              break;\n            }\n          }\n          break;\n        }\n\n        case 'TypeError': {\n          switch (matchedError.type) {\n            case 'NOTFUNC': {\n              //Error when some code expects you to provide a function, but that didn't happen\n              //let a = document.getElementByID('foo'); -> getElementById instead of getElementByID\n              let errSym = matchedError.match[1];\n              let splitSym = errSym.split('.');\n              let url =\n                'https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Not_a_function#What_went_wrong';\n\n              // if errSym is aa.bb.cc , symbol would be cc and obj would aa.bb\n              let translationObj = {\n                url,\n                symbol: splitSym[splitSym.length - 1],\n                obj: splitSym.slice(0, splitSym.length - 1).join('.'),\n                location: locationObj\n                  ? translator('fes.location', locationObj)\n                  : ''\n              };\n\n              // There are two cases to handle here. When the function is called\n              // as a property of an object and when it's called independently.\n              // Both have different explanations.\n              if (splitSym.length > 1) {\n                p5._friendlyError(\n                  translator('fes.globalErrors.type.notfuncObj', translationObj)\n                );\n              } else {\n                p5._friendlyError(\n                  translator('fes.globalErrors.type.notfunc', translationObj)\n                );\n              }\n\n              if (friendlyStack) printFriendlyStack(friendlyStack);\n              break;\n            }\n            case 'READNULL': {\n              //Error if a property of null is accessed\n              //let a = null;\n              //console.log(a.property); -> a is null\n              let errSym = matchedError.match[1];\n              let url =\n                'https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_property#what_went_wrong';\n              /*let url2 =\n                'https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null';*/\n              p5._friendlyError(\n                translator('fes.globalErrors.type.readFromNull', {\n                  url,\n                  symbol: errSym,\n                  location: locationObj\n                    ? translator('fes.location', locationObj)\n                    : ''\n                })\n              );\n\n              if (friendlyStack) printFriendlyStack(friendlyStack);\n              break;\n            }\n            case 'READUDEFINED': {\n              //Error if a property of undefined is accessed\n              //let a; -> default value of a is undefined\n              //console.log(a.property); -> a is undefined\n              let errSym = matchedError.match[1];\n              let url =\n                'https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_property#what_went_wrong';\n              /*let url2 =\n                'https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined#description';*/\n              p5._friendlyError(\n                translator('fes.globalErrors.type.readFromUndefined', {\n                  url,\n                  symbol: errSym,\n                  location: locationObj\n                    ? translator('fes.location', locationObj)\n                    : ''\n                })\n              );\n\n              if (friendlyStack) printFriendlyStack(friendlyStack);\n              break;\n            }\n            case 'CONSTASSIGN': {\n              //Error when a const variable is reassigned a value\n              //const a = 100;\n              //a=10;\n              let url =\n                'https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Invalid_const_assignment#what_went_wrong';\n              p5._friendlyError(\n                translator('fes.globalErrors.type.constAssign', {\n                  url,\n                  location: locationObj\n                    ? translator('fes.location', locationObj)\n                    : ''\n                })\n              );\n\n              if (friendlyStack) printFriendlyStack(friendlyStack);\n              break;\n            }\n          }\n        }\n      }\n    };\n\n    p5._fesErrorMonitor = fesErrorMonitor;\n    p5._checkForUserDefinedFunctions = checkForUserDefinedFunctions;\n\n    // logger for testing purposes.\n    p5._fesLogger = null;\n    p5._fesLogCache = {};\n\n    window.addEventListener('load', checkForUserDefinedFunctions, false);\n    window.addEventListener('error', p5._fesErrorMonitor, false);\n    window.addEventListener('unhandledrejection', p5._fesErrorMonitor, false);\n\n    /**\n     * Prints out all the colors in the color pallete with white text.\n     * For color blindness testing.\n     */\n    /* function testColors() {\n      const str = 'A box of biscuits, a box of mixed biscuits and a biscuit mixer';\n      p5._friendlyError(str, 'print', '#ED225D'); // p5.js magenta\n      p5._friendlyError(str, 'print', '#2D7BB6'); // p5.js blue\n      p5._friendlyError(str, 'print', '#EE9900'); // p5.js orange\n      p5._friendlyError(str, 'print', '#A67F59'); // p5.js light brown\n      p5._friendlyError(str, 'print', '#704F21'); // p5.js gold\n      p5._friendlyError(str, 'print', '#1CC581'); // auto cyan\n      p5._friendlyError(str, 'print', '#FF6625'); // auto orange\n      p5._friendlyError(str, 'print', '#79EB22'); // auto green\n      p5._friendlyError(str, 'print', '#B40033'); // p5.js darkened magenta\n      p5._friendlyError(str, 'print', '#084B7F'); // p5.js darkened blue\n      p5._friendlyError(str, 'print', '#945F00'); // p5.js darkened orange\n      p5._friendlyError(str, 'print', '#6B441D'); // p5.js darkened brown\n      p5._friendlyError(str, 'print', '#2E1B00'); // p5.js darkened gold\n      p5._friendlyError(str, 'print', '#008851'); // auto dark cyan\n      p5._friendlyError(str, 'print', '#C83C00'); // auto dark orange\n      p5._friendlyError(str, 'print', '#4DB200'); // auto dark green\n    } */\n  }\n\n  // This is a lazily-defined list of p5 symbols that may be\n  // misused by beginners at top-level code, outside of setup/draw. We'd like\n  // to detect these errors and help the user by suggesting they move them\n  // into setup/draw.\n  //\n  // For more details, see https://github.com/processing/p5.js/issues/1121.\n  misusedAtTopLevelCode = null;\n  const FAQ_URL =\n    'https://github.com/processing/p5.js/wiki/p5.js-overview#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup';\n\n  /**\n   * A helper function for populating misusedAtTopLevel list.\n   *\n   * @method defineMisusedAtTopLevelCode\n   * @private\n   */\n  defineMisusedAtTopLevelCode = () => {\n    const uniqueNamesFound = {};\n\n    const getSymbols = obj =>\n      Object.getOwnPropertyNames(obj)\n        .filter(name => {\n          if (name[0] === '_') {\n            return false;\n          }\n          if (name in uniqueNamesFound) {\n            return false;\n          }\n\n          uniqueNamesFound[name] = true;\n\n          return true;\n        })\n        .map(name => {\n          let type;\n\n          if (typeof obj[name] === 'function') {\n            type = 'function';\n          } else if (name === name.toUpperCase()) {\n            type = 'constant';\n          } else {\n            type = 'variable';\n          }\n\n          return { name, type };\n        });\n\n    misusedAtTopLevelCode = [].concat(\n      getSymbols(fn),\n      // At present, p5 only adds its constants to fn during\n      // construction, which may not have happened at the time a\n      // ReferenceError is thrown, so we'll manually add them to our list.\n      getSymbols(constants)\n    );\n\n    // This will ultimately ensure that we report the most specific error\n    // possible to the user, e.g. advising them about HALF_PI instead of PI\n    // when their code misuses the former.\n    misusedAtTopLevelCode.sort((a, b) => b.name.length - a.name.length);\n  };\n\n  /**\n   * Detects browser level error event for p5 constants/functions used outside\n   * of setup() and draw().\n   *\n   * Generates and prints a friendly error message using key:\n   * \"fes.misusedTopLevel\".\n   *\n   * @method helpForMisusedAtTopLevelCode\n   * @private\n   * @param {Event} e       Error event\n   * @param {Boolean} log   false\n   *\n   * @returns {Boolean} true\n   */\n  const helpForMisusedAtTopLevelCode = (e, log) => {\n    if (!log) {\n      log = console.log.bind(console);\n    }\n\n    if (!misusedAtTopLevelCode) {\n      defineMisusedAtTopLevelCode();\n    }\n\n    // If we find that we're logging lots of false positives, we can\n    // uncomment the following code to avoid displaying anything if the\n    // user's code isn't likely to be using p5's global mode. (Note that\n    // setup/draw are more likely to be defined due to JS function hoisting.)\n    //\n    //if (!('setup' in window || 'draw' in window)) {\n    //  return;\n    //}\n\n    misusedAtTopLevelCode.some(symbol => {\n      // Note that while just checking for the occurrence of the\n      // symbol name in the error message could result in false positives,\n      // a more rigorous test is difficult because different browsers\n      // log different messages, and the format of those messages may\n      // change over time.\n      //\n      // For example, if the user uses 'PI' in their code, it may result\n      // in any one of the following messages:\n      //\n      //   * 'PI' is undefined                           (Microsoft Edge)\n      //   * ReferenceError: PI is undefined             (Firefox)\n      //   * Uncaught ReferenceError: PI is not defined  (Chrome)\n\n      if (e.message && e.message.match(`\\\\W?${symbol.name}\\\\W`) !== null) {\n        const symbolName =\n          symbol.type === 'function' ? `${symbol.name}()` : symbol.name;\n        if (typeof IS_MINIFIED !== 'undefined') {\n          log(\n            `Did you just try to use p5.js's ${symbolName} ${\n              symbol.type\n            }? If so, you may want to move it into your sketch's setup() function.\\n\\nFor more details, see: ${FAQ_URL}`\n          );\n        } else {\n          log(\n            translator('fes.misusedTopLevel', {\n              symbolName,\n              symbolType: symbol.type,\n              url: FAQ_URL\n            })\n          );\n        }\n        return true;\n      }\n    });\n  };\n\n  // Exposing this primarily for unit testing.\n  fn._helpForMisusedAtTopLevelCode = helpForMisusedAtTopLevelCode;\n\n  if (document.readyState !== 'complete') {\n    window.addEventListener('error', helpForMisusedAtTopLevelCode, false);\n\n    // Our job is only to catch ReferenceErrors that are thrown when\n    // global (non-instance mode) p5 APIs are used at the top-level\n    // scope of a file, so we'll unbind our error listener now to make\n    // sure we don't log false positives later.\n    window.addEventListener('load', () => {\n      window.removeEventListener('error', helpForMisusedAtTopLevelCode, false);\n    });\n  }\n}\n\nif (typeof p5 !== 'undefined') {\n  fesCore(p5, p5.prototype);\n}\n\nexport { fesCore as default };\n","/**\n * @for p5\n * @requires core\n */\n// Borrow from stacktracejs https://github.com/stacktracejs/stacktrace.js with\n// minor modifications. The license for the same and the code is included below\n\n// Copyright (c) 2017 Eric Wendelin and other contributors\n// Permission is hereby granted, free of charge, to any person obtaining a copy of\n// this software and associated documentation files (the \"Software\"), to deal in\n// the Software without restriction, including without limitation the rights to\n// use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\n// of the Software, and to permit persons to whom the Software is furnished to do\n// so, subject to the following conditions:\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\nfunction ErrorStackParser() {\n  let FIREFOX_SAFARI_STACK_REGEXP = /(^|@)\\S+:\\d+/;\n  let CHROME_IE_STACK_REGEXP = /^\\s*at .*(\\S+:\\d+|\\(native\\))/m;\n  let SAFARI_NATIVE_CODE_REGEXP = /^(eval@)?(\\[native code])?$/;\n\n  return {\n    /**\n     * Given an Error object, extract the most information from it.\n     * @private\n     * @param {Error} error object\n     * @return {Array} of stack frames\n     */\n    parse: function ErrorStackParser$$parse(error) {\n      if (\n        typeof error.stacktrace !== 'undefined' ||\n        typeof error['opera#sourceloc'] !== 'undefined'\n      ) {\n        return this.parseOpera(error);\n      } else if (error.stack && error.stack.match(CHROME_IE_STACK_REGEXP)) {\n        return this.parseV8OrIE(error);\n      } else if (error.stack) {\n        return this.parseFFOrSafari(error);\n      } else ;\n    },\n\n    // Separate line and column numbers from a string of the form: (URI:Line:Column)\n    extractLocation: function ErrorStackParser$$extractLocation(urlLike) {\n      // Fail-fast but return locations like \"(native)\"\n      if (urlLike.indexOf(':') === -1) {\n        return [urlLike];\n      }\n\n      let regExp = /(.+?)(?::(\\d+))?(?::(\\d+))?$/;\n      let parts = regExp.exec(urlLike.replace(/[()]/g, ''));\n      return [parts[1], parts[2] || undefined, parts[3] || undefined];\n    },\n\n    parseV8OrIE: function ErrorStackParser$$parseV8OrIE(error) {\n      let filtered = error.stack.split('\\n').filter(function(line) {\n        return !!line.match(CHROME_IE_STACK_REGEXP);\n      }, this);\n\n      return filtered.map(function(line) {\n        if (line.indexOf('(eval ') > -1) {\n          // Throw away eval information until we implement stacktrace.js/stackframe#8\n          line = line\n            .replace(/eval code/g, 'eval')\n            .replace(/(\\(eval at [^()]*)|(\\),.*$)/g, '');\n        }\n        let sanitizedLine = line\n          .replace(/^\\s+/, '')\n          .replace(/\\(eval code/g, '(');\n\n        // capture and preseve the parenthesized location \"(/foo/my bar.js:12:87)\" in\n        // case it has spaces in it, as the string is split on \\s+ later on\n        let location = sanitizedLine.match(/ (\\((.+):(\\d+):(\\d+)\\)$)/);\n\n        // remove the parenthesized location from the line, if it was matched\n        sanitizedLine = location\n          ? sanitizedLine.replace(location[0], '')\n          : sanitizedLine;\n\n        let tokens = sanitizedLine.split(/\\s+/).slice(1);\n        // if a location was matched, pass it to extractLocation() otherwise pop the last token\n        let locationParts = this.extractLocation(\n          location ? location[1] : tokens.pop()\n        );\n        let functionName = tokens.join(' ') || undefined;\n        let fileName =\n          ['eval', '<anonymous>'].indexOf(locationParts[0]) > -1\n            ? undefined\n            : locationParts[0];\n\n        return {\n          functionName,\n          fileName,\n          lineNumber: locationParts[1],\n          columnNumber: locationParts[2],\n          source: line\n        };\n      }, this);\n    },\n\n    parseFFOrSafari: function ErrorStackParser$$parseFFOrSafari(error) {\n      let filtered = error.stack.split('\\n').filter(function(line) {\n        return !line.match(SAFARI_NATIVE_CODE_REGEXP);\n      }, this);\n\n      return filtered.map(function(line) {\n        // Throw away eval information until we implement stacktrace.js/stackframe#8\n        if (line.indexOf(' > eval') > -1) {\n          line = line.replace(\n            / line (\\d+)(?: > eval line \\d+)* > eval:\\d+:\\d+/g,\n            ':$1'\n          );\n        }\n\n        if (line.indexOf('@') === -1 && line.indexOf(':') === -1) {\n          // Safari eval frames only have function names and nothing else\n          return {\n            functionName: line\n          };\n        } else {\n          let functionNameRegex = /((.*\".+\"[^@]*)?[^@]*)(?:@)/;\n          let matches = line.match(functionNameRegex);\n          let functionName = matches && matches[1] ? matches[1] : undefined;\n          let locationParts = this.extractLocation(\n            line.replace(functionNameRegex, '')\n          );\n\n          return {\n            functionName,\n            fileName: locationParts[0],\n            lineNumber: locationParts[1],\n            columnNumber: locationParts[2],\n            source: line\n          };\n        }\n      }, this);\n    },\n\n    parseOpera: function ErrorStackParser$$parseOpera(e) {\n      if (\n        !e.stacktrace ||\n        (e.message.indexOf('\\n') > -1 &&\n          e.message.split('\\n').length > e.stacktrace.split('\\n').length)\n      ) {\n        return this.parseOpera9(e);\n      } else if (!e.stack) {\n        return this.parseOpera10(e);\n      } else {\n        return this.parseOpera11(e);\n      }\n    },\n\n    parseOpera9: function ErrorStackParser$$parseOpera9(e) {\n      let lineRE = /Line (\\d+).*script (?:in )?(\\S+)/i;\n      let lines = e.message.split('\\n');\n      let result = [];\n\n      for (let i = 2, len = lines.length; i < len; i += 2) {\n        let match = lineRE.exec(lines[i]);\n        if (match) {\n          result.push({\n            fileName: match[2],\n            lineNumber: match[1],\n            source: lines[i]\n          });\n        }\n      }\n\n      return result;\n    },\n\n    parseOpera10: function ErrorStackParser$$parseOpera10(e) {\n      let lineRE = /Line (\\d+).*script (?:in )?(\\S+)(?:: In function (\\S+))?$/i;\n      let lines = e.stacktrace.split('\\n');\n      let result = [];\n\n      for (let i = 0, len = lines.length; i < len; i += 2) {\n        let match = lineRE.exec(lines[i]);\n        if (match) {\n          result.push({\n            functionName: match[3] || undefined,\n            fileName: match[2],\n            lineNumber: match[1],\n            source: lines[i]\n          });\n        }\n      }\n\n      return result;\n    },\n\n    // Opera 10.65+ Error.stack very similar to FF/Safari\n    parseOpera11: function ErrorStackParser$$parseOpera11(error) {\n      let filtered = error.stack.split('\\n').filter(function(line) {\n        return (\n          !!line.match(FIREFOX_SAFARI_STACK_REGEXP) &&\n          !line.match(/^Error created at/)\n        );\n      }, this);\n\n      return filtered.map(function(line) {\n        let tokens = line.split('@');\n        let locationParts = this.extractLocation(tokens.pop());\n        let functionCall = tokens.shift() || '';\n        let functionName =\n          functionCall\n            .replace(/<anonymous function(: (\\w+))?>/, '$2')\n            .replace(/\\([^)]*\\)/g, '') || undefined;\n        let argsRaw;\n        if (functionCall.match(/\\(([^)]*)\\)/)) {\n          argsRaw = functionCall.replace(/^[^(]+\\(([^)]*)\\)$/, '$1');\n        }\n        let args =\n          argsRaw === undefined || argsRaw === '[arguments not available]'\n            ? undefined\n            : argsRaw.split(',');\n\n        return {\n          functionName,\n          args,\n          fileName: locationParts[0],\n          lineNumber: locationParts[1],\n          columnNumber: locationParts[2],\n          source: line\n        };\n      }, this);\n    }\n  };\n}\n\n// End borrow\n\n// wrapper exposing ErrorStackParser\nfunction stacktrace(p5, fn){\n  p5._getErrorStackParser = function getErrorStackParser() {\n    return new ErrorStackParser();\n  };\n}\n\nif (typeof p5 !== 'undefined') {\n  stacktrace(p5, p5.prototype);\n}\n\nexport { stacktrace as default };\n","import { v as constants } from '../../constants-8IpwyBct.js';\nimport { z } from 'zod/v4';\n\nvar p5$1 = {\n\tdescribe: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"FALLBACK|LABEL?\"\n\t\t\t]\n\t\t]\n\t},\n\tdescribeElement: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String\",\n\t\t\t\t\"FALLBACK|LABEL?\"\n\t\t\t]\n\t\t]\n\t},\n\ttextOutput: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"FALLBACK|LABEL?\"\n\t\t\t]\n\t\t]\n\t},\n\tgridOutput: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"FALLBACK|LABEL?\"\n\t\t\t]\n\t\t]\n\t},\n\tp5: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Object\",\n\t\t\t\t\"String|HTMLElement\"\n\t\t\t]\n\t\t]\n\t},\n\tcolor: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color\"\n\t\t\t]\n\t\t]\n\t},\n\tred: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\"\n\t\t\t]\n\t\t]\n\t},\n\tgreen: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\"\n\t\t\t]\n\t\t]\n\t},\n\tblue: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\"\n\t\t\t]\n\t\t]\n\t},\n\talpha: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\"\n\t\t\t]\n\t\t]\n\t},\n\thue: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\"\n\t\t\t]\n\t\t]\n\t},\n\tsaturation: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\"\n\t\t\t]\n\t\t]\n\t},\n\tbrightness: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\"\n\t\t\t]\n\t\t]\n\t},\n\tlightness: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\"\n\t\t\t]\n\t\t]\n\t},\n\tlerpColor: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Color\",\n\t\t\t\t\"p5.Color\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tpaletteLerp: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"[p5.Color|String|Number|Number[], Number][]\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tbeginClip: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\tendClip: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tclip: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\tbackground: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Color\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Image\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tclear: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tcolorMode: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"RGB|HSB|HSL|RGBHDR|HWB|LAB|LCH|OKLAB|OKLCH\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"RGB|HSB|HSL|RGBHDR|HWB|LAB|LCH|OKLAB|OKLCH\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tfill: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color\"\n\t\t\t]\n\t\t]\n\t},\n\tnoFill: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tnoStroke: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tstroke: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color\"\n\t\t\t]\n\t\t]\n\t},\n\terase: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tnoErase: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tblendMode: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|REMOVE|SUBTRACT\"\n\t\t\t]\n\t\t]\n\t},\n\tprint: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Any\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String|Number|Array\"\n\t\t\t]\n\t\t]\n\t},\n\tcursor: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"ARROW|CROSS|HAND|MOVE|TEXT|WAIT|String\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tframeRate: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tgetTargetFrameRate: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tnoCursor: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\twindowResized: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"UIEvent?\"\n\t\t\t]\n\t\t]\n\t},\n\tfullscreen: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tpixelDensity: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tdisplayDensity: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tgetURL: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tgetURLPath: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tgetURLParams: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tworldToScreen: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number|p5.Vector\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tscreenToWorld: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number|p5.Vector\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tsetup: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tdraw: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tcreateCanvas: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"P2D|WEBGL|P2DHDR?\",\n\t\t\t\t\"HTMLCanvasElement?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"HTMLCanvasElement?\"\n\t\t\t]\n\t\t]\n\t},\n\tresizeCanvas: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tnoCanvas: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tcreateGraphics: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"P2D|WEBGL?\",\n\t\t\t\t\"HTMLCanvasElement?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"HTMLCanvasElement?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateFramebuffer: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\tclearDepth: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tnoLoop: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tloop: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tisLooping: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tredraw: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tapplyMatrix: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Array\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tresetMatrix: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\trotate: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector|Number[]?\"\n\t\t\t]\n\t\t]\n\t},\n\trotateX: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\trotateY: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\trotateZ: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tscale: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number|p5.Vector|Number[]\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector|Number[]\"\n\t\t\t]\n\t\t]\n\t},\n\tshearX: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tshearY: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\ttranslate: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tpush: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tpop: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tstoreItem: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String|Number|Boolean|Object|Array\"\n\t\t\t]\n\t\t]\n\t},\n\tgetItem: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\tclearStorage: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tremoveItem: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\tselect: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String|p5.Element|HTMLElement?\"\n\t\t\t]\n\t\t]\n\t},\n\tselectAll: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String|p5.Element|HTMLElement?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateElement: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tremoveElements: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\taddElement: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tcreateDiv: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateP: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateSpan: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateImg: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateA: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateSlider: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateButton: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateCheckbox: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\",\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateSelect: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Boolean?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Object\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateRadio: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Object?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tcreateColorPicker: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|p5.Color?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateInput: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\",\n\t\t\t\t\"String?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateFileInput: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function\",\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tsetMoveThreshold: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsetShakeThreshold: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tdeviceMoved: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tdeviceTurned: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tdeviceShaken: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tkeyPressed: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"KeyboardEvent?\"\n\t\t\t]\n\t\t]\n\t},\n\tkeyReleased: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"KeyboardEvent?\"\n\t\t\t]\n\t\t]\n\t},\n\tkeyTyped: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"KeyboardEvent?\"\n\t\t\t]\n\t\t]\n\t},\n\tkeyIsDown: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number|String\"\n\t\t\t]\n\t\t]\n\t},\n\tmouseMoved: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"MouseEvent?\"\n\t\t\t]\n\t\t]\n\t},\n\tmouseDragged: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"MouseEvent?\"\n\t\t\t]\n\t\t]\n\t},\n\tmousePressed: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"MouseEvent?\"\n\t\t\t]\n\t\t]\n\t},\n\tmouseReleased: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"MouseEvent?\"\n\t\t\t]\n\t\t]\n\t},\n\tmouseClicked: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"MouseEvent?\"\n\t\t\t]\n\t\t]\n\t},\n\tdoubleClicked: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"MouseEvent?\"\n\t\t\t]\n\t\t]\n\t},\n\tmouseWheel: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"WheelEvent?\"\n\t\t\t]\n\t\t]\n\t},\n\trequestPointerLock: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\texitPointerLock: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tcreateImage: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tsaveCanvas: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Framebuffer|p5.Element|HTMLCanvasElement\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"String?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String?\",\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tsaveFrames: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"function(Array)?\"\n\t\t\t]\n\t\t]\n\t},\n\tloadImage: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"function(p5.Image)?\",\n\t\t\t\t\"function(Event)?\"\n\t\t\t]\n\t\t]\n\t},\n\tsaveGif: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\timage: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Image|p5.Element|p5.Texture|p5.Framebuffer|p5.FramebufferTexture|p5.Renderer|p5.Graphics\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Image|p5.Element|p5.Texture|p5.Framebuffer|p5.FramebufferTexture\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"CONTAIN|COVER?\",\n\t\t\t\t\"LEFT|RIGHT|CENTER?\",\n\t\t\t\t\"TOP|BOTTOM|CENTER?\"\n\t\t\t]\n\t\t]\n\t},\n\ttint: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color\"\n\t\t\t]\n\t\t]\n\t},\n\tnoTint: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\timageMode: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"CORNER|CORNERS|CENTER\"\n\t\t\t]\n\t\t]\n\t},\n\tblend: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Image\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL\"\n\t\t\t]\n\t\t]\n\t},\n\tcopy: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Image|p5.Element\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tfilter: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"THRESHOLD|GRAY|OPAQUE|INVERT|POSTERIZE|BLUR|ERODE|DILATE|BLUR\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Boolean?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Shader\"\n\t\t\t]\n\t\t]\n\t},\n\tget: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tloadPixels: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tset: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number|Number[]|Object\"\n\t\t\t]\n\t\t]\n\t},\n\tupdatePixels: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tloadJSON: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tloadStrings: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tloadTable: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tloadXML: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tloadBytes: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tloadBlob: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\thttpGet: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Function\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\thttpPost: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Object|Boolean?\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Object|Boolean\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\thttpDo: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"Object?\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateWriter: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\twrite: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Number|Array\"\n\t\t\t]\n\t\t]\n\t},\n\tclose: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tsave: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Object|String?\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"Boolean|String?\"\n\t\t\t]\n\t\t]\n\t},\n\tsaveJSON: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Array|Object\",\n\t\t\t\t\"String\",\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tsaveStrings: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String[]\",\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tsaveTable: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Table\",\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tabs: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tceil: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tconstrain: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tdist: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\texp: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tfloor: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tlerp: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tlog: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tmag: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tmap: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tmax: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\"\n\t\t\t]\n\t\t]\n\t},\n\tmin: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\"\n\t\t\t]\n\t\t]\n\t},\n\tnorm: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tpow: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tround: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tsq: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsqrt: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tfract: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateVector: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"...Number[]\"\n\t\t\t]\n\t\t]\n\t},\n\tnoise: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tnoiseDetail: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tnoiseSeed: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\trandomSeed: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\trandom: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Array\"\n\t\t\t]\n\t\t]\n\t},\n\trandomGaussian: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tacos: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tasin: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tatan: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tatan2: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tcos: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsin: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\ttan: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tdegrees: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tradians: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tangleMode: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"RADIANS|DEGREES\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tarc: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"CHORD|PIE|OPEN?\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tellipse: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tcircle: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tline: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tpoint: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tquad: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\trect: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tsquare: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\ttriangle: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tellipseMode: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"CENTER|RADIUS|CORNER|CORNERS\"\n\t\t\t]\n\t\t]\n\t},\n\tnoSmooth: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\trectMode: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"CENTER|RADIUS|CORNER|CORNERS\"\n\t\t\t]\n\t\t]\n\t},\n\tsmooth: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tstrokeCap: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"ROUND|SQUARE|PROJECT\"\n\t\t\t]\n\t\t]\n\t},\n\tstrokeJoin: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"MITER|BEVEL|ROUND\"\n\t\t\t]\n\t\t]\n\t},\n\tstrokeWeight: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tbezier: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tbezierPoint: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tbezierTangent: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tspline: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsplinePoint: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsplineTangent: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tbezierOrder: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tsplineVertex: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tsplineProperty: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\tnull\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\tsplineProperties: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Object\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tvertex: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tbeginContour: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tendContour: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"OPEN|CLOSE?\"\n\t\t\t]\n\t\t]\n\t},\n\tbeginShape: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"POINTS|LINES|TRIANGLES|TRIANGLE_FAN|TRIANGLE_STRIP|QUADS|QUAD_STRIP|PATH?\"\n\t\t\t]\n\t\t]\n\t},\n\tbezierVertex: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tendShape: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"CLOSE?\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tnormal: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tvertexProperty: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number|Number[]\"\n\t\t\t]\n\t\t]\n\t},\n\tloadFont: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"Object?\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\ttext: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Object|Array|Number|Boolean\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\ttextAlign: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"LEFT|CENTER|RIGHT\",\n\t\t\t\t\"TOP|BOTTOM|CENTER|BASELINE?\"\n\t\t\t]\n\t\t]\n\t},\n\ttextAscent: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\ttextDescent: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\ttextLeading: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\ttextFont: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Font|String|Object\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\ttextSize: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\ttextStyle: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"NORMAL|ITALIC|BOLD|BOLDITALIC\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\ttextWidth: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\ttextWrap: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"WORD|CHAR\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\ttextBounds: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\ttextDirection: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\ttextProperty: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\tnull\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\ttextProperties: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Object\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tfontBounds: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tfontWidth: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\tfontAscent: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tfontDescent: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\ttextWeight: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tfloat: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String[]\"\n\t\t\t]\n\t\t]\n\t},\n\tint: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Boolean|Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Array\"\n\t\t\t]\n\t\t]\n\t},\n\tstr: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Boolean|Number\"\n\t\t\t]\n\t\t]\n\t},\n\tboolean: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Boolean|Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Array\"\n\t\t\t]\n\t\t]\n\t},\n\tbyte: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Boolean|Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Array\"\n\t\t\t]\n\t\t]\n\t},\n\tchar: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Array\"\n\t\t\t]\n\t\t]\n\t},\n\tunchar: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String[]\"\n\t\t\t]\n\t\t]\n\t},\n\thex: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tunhex: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String[]\"\n\t\t\t]\n\t\t]\n\t},\n\tday: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\thour: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tminute: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tmillis: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tmonth: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tsecond: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tyear: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tnf: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number|String\",\n\t\t\t\t\"Integer|String?\",\n\t\t\t\t\"Integer|String?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\",\n\t\t\t\t\"Integer|String?\",\n\t\t\t\t\"Integer|String?\"\n\t\t\t]\n\t\t]\n\t},\n\tnfc: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number|String\",\n\t\t\t\t\"Integer|String?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\",\n\t\t\t\t\"Integer|String?\"\n\t\t\t]\n\t\t]\n\t},\n\tnfp: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tnfs: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Array\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tsplitTokens: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tshuffle: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Array\",\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tstrokeMode: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\tbuildGeometry: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function\"\n\t\t\t]\n\t\t]\n\t},\n\tfreeGeometry: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Geometry\"\n\t\t\t]\n\t\t]\n\t},\n\tplane: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tbox: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tsphere: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tcylinder: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Boolean?\",\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tcone: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tellipsoid: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\ttorus: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Integer?\",\n\t\t\t\t\"Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tcurveDetail: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\torbitControl: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\tdebugMode: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"GRID|AXES\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"GRID|AXES\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"GRID|AXES\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tnoDebugMode: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tambientLight: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color\"\n\t\t\t]\n\t\t]\n\t},\n\tspecularColor: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color\"\n\t\t\t]\n\t\t]\n\t},\n\tdirectionalLight: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\",\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tpointLight: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\",\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\timageLight: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.image\"\n\t\t\t]\n\t\t]\n\t},\n\tpanorama: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Image\"\n\t\t\t]\n\t\t]\n\t},\n\tlights: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tlightFalloff: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tspotLight: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tnoLights: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tloadModel: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"Boolean\",\n\t\t\t\t\"function(p5.Geometry)?\",\n\t\t\t\t\"function(Event)?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"function(p5.Geometry)?\",\n\t\t\t\t\"function(Event)?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\tmodel: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Geometry\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateModel: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"Boolean\",\n\t\t\t\t\"function(p5.Geometry)?\",\n\t\t\t\t\"function(Event)?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"function(p5.Geometry)?\",\n\t\t\t\t\"function(Event)?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\tloadShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"String|Request\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\tloadFilterShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Function?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateFilterShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\tshader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Shader\"\n\t\t\t]\n\t\t]\n\t},\n\tstrokeShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Shader\"\n\t\t\t]\n\t\t]\n\t},\n\timageShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Shader\"\n\t\t\t]\n\t\t]\n\t},\n\tbaseMaterialShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tbaseFilterShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tbaseNormalShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tbaseColorShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tbaseStrokeShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tresetShader: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\ttexture: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Image|p5.MediaElement|p5.Graphics|p5.Texture|p5.Framebuffer|p5.FramebufferTexture\"\n\t\t\t]\n\t\t]\n\t},\n\ttextureMode: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"IMAGE|NORMAL\"\n\t\t\t]\n\t\t]\n\t},\n\ttextureWrap: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"CLAMP|REPEAT|MIRROR\",\n\t\t\t\t\"CLAMP|REPEAT|MIRROR?\"\n\t\t\t]\n\t\t]\n\t},\n\tnormalMaterial: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tambientMaterial: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\"\n\t\t\t]\n\t\t]\n\t},\n\temissiveMaterial: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\"\n\t\t\t]\n\t\t]\n\t},\n\tspecularMaterial: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Color|Number[]|String\"\n\t\t\t]\n\t\t]\n\t},\n\tshininess: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tmetalness: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tcamera: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tperspective: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tlinePerspective: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Boolean\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tortho: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tfrustum: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateCamera: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tsetCamera: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Camera\"\n\t\t\t]\n\t\t]\n\t},\n\tsaveObj: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tsaveStl: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\tsetAttributes: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Boolean\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Object\"\n\t\t\t]\n\t\t]\n\t},\n\tremove: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tcreateVideo: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|String[]\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateAudio: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String|String[]?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateCapture: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"AUDIO|VIDEO|Object?\",\n\t\t\t\t\"Object?\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t}\n};\nvar dataDoc = {\n\tp5: p5$1,\n\t\"p5.Geometry\": {\n\tflipV: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tcalculateBoundingBox: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tclearColors: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tflipU: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tcomputeFaces: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tcomputeNormals: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"FLAT|SMOOTH?\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\tmakeEdgesFromFaces: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tnormalize: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tvertexProperty: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number|Number[]\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.Color\": {\n\ttoString: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tsetRed: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsetGreen: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsetBlue: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsetAlpha: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.Graphics\": {\n\treset: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tremove: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tcreateFramebuffer: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.Element\": {\n\tremove: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tparent: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|p5.Element|Object\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tchild: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String|p5.Element?\"\n\t\t\t]\n\t\t]\n\t},\n\thtml: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String?\",\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tid: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\t\"class\": {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\taddClass: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\tremoveClass: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\thasClass: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\tnull\n\t\t\t]\n\t\t]\n\t},\n\ttoggleClass: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\tnull\n\t\t\t]\n\t\t]\n\t},\n\tcenter: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tposition: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tshow: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\thide: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tsize: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number|AUTO?\",\n\t\t\t\t\"Number|AUTO?\"\n\t\t\t]\n\t\t]\n\t},\n\tstyle: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String|p5.Color\"\n\t\t\t]\n\t\t]\n\t},\n\tattribute: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\tremoveAttribute: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\tvalue: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"String|Number\"\n\t\t\t]\n\t\t]\n\t},\n\tmousePressed: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tdoubleClicked: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tmouseWheel: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tmouseReleased: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tmouseClicked: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tmouseMoved: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tmouseOver: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tmouseOut: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tdragOver: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tdragLeave: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tchanged: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tinput: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tdrop: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function\",\n\t\t\t\t\"Function?\"\n\t\t\t]\n\t\t]\n\t},\n\tdraggable: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Element?\"\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.MediaElement\": {\n\tplay: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tstop: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tpause: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tloop: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tnoLoop: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tautoplay: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tvolume: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tspeed: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\ttime: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tduration: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tonended: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function\"\n\t\t\t]\n\t\t]\n\t},\n\tconnect: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"AudioNode|Object\"\n\t\t\t]\n\t\t]\n\t},\n\tdisconnect: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tshowControls: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\thideControls: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\taddCue: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Function\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\tremoveCue: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tclearCues: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.Image\": {\n\tpixelDensity: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tloadPixels: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tupdatePixels: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tget: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tset: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number|Number[]|Object\"\n\t\t\t]\n\t\t]\n\t},\n\tresize: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tcopy: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Image|p5.Element\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tmask: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Image\"\n\t\t\t]\n\t\t]\n\t},\n\tfilter: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"THRESHOLD|GRAY|OPAQUE|INVERT|POSTERIZE|ERODE|DILATE|BLUR\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tblend: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Image\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"Integer\",\n\t\t\t\t\"BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL\"\n\t\t\t]\n\t\t]\n\t},\n\tsave: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\treset: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tgetCurrentFrame: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tsetFrame: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tnumFrames: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tplay: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tpause: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tdelay: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.Table\": {\n\taddRow: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.TableRow?\"\n\t\t\t]\n\t\t]\n\t},\n\tremoveRow: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tgetRow: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tgetRows: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tfindRow: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Integer|String\"\n\t\t\t]\n\t\t]\n\t},\n\tfindRows: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Integer|String\"\n\t\t\t]\n\t\t]\n\t},\n\tmatchRow: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|RegExp\",\n\t\t\t\t\"String|Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tmatchRows: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String|Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tgetColumn: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Number\"\n\t\t\t]\n\t\t]\n\t},\n\tclearRows: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\taddColumn: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tgetColumnCount: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tgetRowCount: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tremoveTokens: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"String|Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\ttrim: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Integer?\"\n\t\t\t]\n\t\t]\n\t},\n\tremoveColumn: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tset: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"String|Integer\",\n\t\t\t\t\"String|Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsetNum: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"String|Integer\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsetString: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"String|Integer\",\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\tget: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"String|Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tgetNum: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"String|Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tgetString: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Integer\",\n\t\t\t\t\"String|Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tgetObject: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tgetArray: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.TableRow\": {\n\tset: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Integer\",\n\t\t\t\t\"String|Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsetNum: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Integer\",\n\t\t\t\t\"Number|String\"\n\t\t\t]\n\t\t]\n\t},\n\tsetString: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Integer\",\n\t\t\t\t\"String|Number|Boolean|Object\"\n\t\t\t]\n\t\t]\n\t},\n\tget: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tgetNum: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tgetString: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Integer\"\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.XML\": {\n\tgetParent: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tgetName: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tsetName: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\thasChildren: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tlistChildren: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tgetChildren: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tgetChild: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Integer\"\n\t\t\t]\n\t\t]\n\t},\n\taddChild: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.XML\"\n\t\t\t]\n\t\t]\n\t},\n\tremoveChild: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String|Integer\"\n\t\t\t]\n\t\t]\n\t},\n\tgetAttributeCount: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tlistAttributes: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\thasAttribute: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\"\n\t\t\t]\n\t\t]\n\t},\n\tgetNum: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tgetString: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tsetAttribute: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number|String|Boolean\"\n\t\t\t]\n\t\t]\n\t},\n\tgetContent: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String?\"\n\t\t\t]\n\t\t]\n\t},\n\tserialize: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.Vector\": {\n\tgetValue: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsetValue: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tset: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector|Number[]\"\n\t\t\t]\n\t\t]\n\t},\n\tcopy: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tadd: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number|Array\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector|Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t]\n\t\t]\n\t},\n\trem: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector|Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tsub: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector|Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t]\n\t\t]\n\t},\n\tmult: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number[]\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t]\n\t\t]\n\t},\n\tdiv: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number[]\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number[]\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t]\n\t\t]\n\t},\n\tmag: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tmagSq: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tdot: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tcross: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tnormalize: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t]\n\t\t]\n\t},\n\tlimit: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t]\n\t\t]\n\t},\n\tsetMag: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t]\n\t\t]\n\t},\n\theading: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tsetHeading: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\trotate: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t]\n\t\t]\n\t},\n\tangleBetween: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tlerp: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t]\n\t\t]\n\t},\n\tslerp: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t]\n\t\t]\n\t},\n\treflect: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector?\"\n\t\t\t]\n\t\t]\n\t},\n\tarray: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t},\n\tequals: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector|Array\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector|Array\",\n\t\t\t\t\"p5.Vector|Array\"\n\t\t\t]\n\t\t]\n\t},\n\tfromAngle: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tfromAngles: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\trandom2D: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\trandom3D: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tdist: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"p5.Vector\",\n\t\t\t\t\"p5.Vector\"\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.Font\": {\n\ttextToPaths: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\ttextToPoints: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\ttextToContours: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\ttextToModel: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.Camera\": {\n\tperspective: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tortho: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tfrustum: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tpan: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\ttilt: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tlookAt: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tcamera: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\",\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tmove: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tsetPosition: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tset: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Camera\"\n\t\t\t]\n\t\t]\n\t},\n\tslerp: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5.Camera\",\n\t\t\t\t\"p5.Camera\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.Framebuffer\": {\n\tresize: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t},\n\tpixelDensity: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number?\"\n\t\t\t]\n\t\t]\n\t},\n\tautoSized: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Boolean?\"\n\t\t\t]\n\t\t]\n\t},\n\tcreateCamera: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tremove: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tbegin: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tend: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tdraw: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Function\"\n\t\t\t]\n\t\t]\n\t},\n\tget: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t],\n\t\t\t[\n\t\t\t],\n\t\t\t[\n\t\t\t\t\"Number\",\n\t\t\t\t\"Number\"\n\t\t\t]\n\t\t]\n\t}\n},\n\t\"p5.Shader\": {\n\tversion: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tinspectHooks: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t]\n\t\t]\n\t},\n\tmodify: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"Object?\"\n\t\t\t]\n\t\t]\n\t},\n\tcopyToContext: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"p5|p5.Graphics\"\n\t\t\t]\n\t\t]\n\t},\n\tsetUniform: {\n\t\toverloads: [\n\t\t\t[\n\t\t\t\t\"String\",\n\t\t\t\t\"Boolean|Number|Number[]|p5.Image|p5.Graphics|p5.MediaElement|p5.Texture\"\n\t\t\t]\n\t\t]\n\t}\n}\n};\n\n/**\n * @for p5\n * @requires core\n */\n\nfunction validateParams(p5, fn, lifecycles) {\n  // Cache for Zod schemas\n  let schemaRegistry = new Map();\n\n  // Mapping names of p5 types to their constructor functions.\n  // p5Constructors:\n  //   - Color: f()\n  //   - Graphics: f()\n  //   - Vector: f()\n  // and so on.\n  // const p5Constructors = {};\n  // NOTE: This is a tempt fix for unit test but is not correct\n  // Attaced constructors are `undefined`\n  const p5Constructors = Object.keys(p5).reduce((acc, val) => {\n    if (\n      val.match(/^[A-Z]/) && // Starts with a capital\n      !val.match(/^[A-Z][A-Z0-9]*$/) && // Is not an all caps constant\n      p5[val] instanceof Function // Is a function\n    ) {\n      acc[val] = p5[val];\n    }\n    return acc;\n  }, {});\n\n  function loadP5Constructors() {\n    // Make a list of all p5 classes to be used for argument validation\n    // This must be done only when everything has loaded otherwise we get\n    // an empty array\n    for (let key of Object.keys(p5)) {\n      // Get a list of all constructors in p5. They are functions whose names\n      // start with a capital letter\n      if (typeof p5[key] === 'function' && key[0] !== key[0].toLowerCase()) {\n        p5Constructors[key] = p5[key];\n      }\n    }\n  }\n\n  // `constantsMap` maps constants to their values, e.g.\n  // {\n  //   ADD: 'lighter',\n  //   ALT: 18,\n  //   ARROW: 'default',\n  //   AUTO: 'auto',\n  //   ...\n  // }\n  const constantsMap = {};\n  for (const [key, value] of Object.entries(constants)) {\n    constantsMap[key] = value;\n  }\n\n  // Start initializing `schemaMap` with primitive types. `schemaMap` will\n  // eventually contain both primitive types and web API objects.\n  const schemaMap = {\n    'Any': z.any(),\n    'Array': z.array(z.any()),\n    'Boolean': z.boolean(),\n    'Function': z.function(),\n    'Integer': z.number().int(),\n    'Number': z.number(),\n    'Object': z.object({}),\n    'String': z.string(),\n  };\n\n  const webAPIObjects = [\n    'AudioNode',\n    'HTMLCanvasElement',\n    'HTMLElement',\n    'KeyboardEvent',\n    'MouseEvent',\n    'RegExp',\n    'TouchEvent',\n    'UIEvent',\n    'WheelEvent'\n  ];\n\n  function generateWebAPISchemas(apiObjects) {\n    return apiObjects.reduce((acc, obj) => {\n      acc[obj] = z.custom(data => data instanceof globalThis[obj], {\n        message: `Expected a ${obj}`\n      });\n      return acc;\n    }, {});\n  }\n\n  const webAPISchemas = generateWebAPISchemas(webAPIObjects);\n  // Add web API schemas to the schema map.\n  Object.assign(schemaMap, webAPISchemas);\n\n  // For mapping 0-indexed parameters to their ordinal representation, e.g.\n  // \"first\" for 0, \"second\" for 1, \"third\" for 2, etc.\n  const ordinals = [\"first\", \"second\", \"third\", \"fourth\", \"fifth\", \"sixth\", \"seventh\", \"eighth\", \"ninth\", \"tenth\"];\n\n  function extractFuncNameAndClass(func) {\n    const ichDot = func.lastIndexOf('.');\n    const funcName = func.slice(ichDot + 1);\n    const funcClass = func.slice(0, ichDot !== -1 ? ichDot : 0) || 'p5';\n    return { funcName, funcClass };\n  }\n\n  function validBracketNesting(type) {\n    let level = 0;\n    for (let i = 0; i < type.length; i++) {\n      if (type[i] === '[') {\n        level++;\n      } else if (type[i] === ']') {\n        level--;\n        if (level < 0) return false;\n      }\n    }\n    return level === 0;\n  }\n\n  /**\n   * This is a helper function that generates Zod schemas for a function based on\n   * the parameter data from `docs/parameterData.json`.\n   *\n   * Example parameter data for function `background`:\n   * \"background\": {\n        \"overloads\": [\n          [\"p5.Color\"],\n          [\"String\", \"Number?\"],\n          [\"Number\", \"Number?\"],\n          [\"Number\", \"Number\", \"Number\", \"Number?\"],\n          [\"Number[]\"],\n          [\"p5.Image\", \"Number?\"]\n        ]\n      }\n   * Where each array in `overloads` represents a set of valid overloaded\n   * parameters, and `?` is a shorthand for `Optional`.\n   *\n   * @method generateZodSchemasForFunc\n   * @param {String} func - Name of the function. Expect global functions like `sin` and class methods like `p5.Vector.add`\n   * @returns {z.ZodSchema} Zod schema\n   */\n  fn.generateZodSchemasForFunc = function (func) {\n    const { funcName, funcClass } = extractFuncNameAndClass(func);\n    let funcInfo = dataDoc[funcClass][funcName];\n\n    if(!funcInfo) return;\n\n    let overloads = [];\n    if (funcInfo.hasOwnProperty('overloads')) {\n      overloads = funcInfo.overloads;\n    }\n\n    // Returns a schema for a single type, i.e. z.boolean() for `boolean`.\n    const generateTypeSchema = baseType => {\n      if (!baseType) return z.any();\n\n      let typeSchema;\n\n      // Check for constants. Note that because we're ultimately interested in the value of\n      // the constant, mapping constants to their values via `constantsMap` is\n      // necessary.\n      if (baseType in constantsMap) {\n        typeSchema = z.literal(constantsMap[baseType]);\n      }\n      // Some more constants are attached directly to p5.prototype, e.g. by addons:\n      else if (baseType.match(/^[A-Z][A-Z0-9]*$/) && baseType in fn) {\n        typeSchema = z.literal(fn[baseType]);\n      }\n      // Function types\n      else if (baseType.startsWith('function')) {\n        typeSchema = z.function();\n      }\n      // All p5 objects start with `p5` in the documentation, i.e. `p5.Camera`.\n      else if (/^p5\\.[a-zA-Z0-9]+$/.exec(baseType) || baseType === 'p5') {\n        const className = baseType.substring(baseType.indexOf('.') + 1);\n        typeSchema = z.instanceof(p5Constructors[className]);\n      }\n      // For primitive types and web API objects.\n      else if (schemaMap[baseType]) {\n        typeSchema = schemaMap[baseType];\n      }\n      // Tuple types\n      else if (\n        baseType.startsWith('[') &&\n        baseType.endsWith(']') &&\n        validBracketNesting(baseType.slice(1, -1))\n      ) {\n        typeSchema = z.tuple(\n          baseType\n            .slice(1, -1)\n            .split(/, */g)\n            .map(entry => generateTypeSchema(entry))\n        );\n      }\n      // JavaScript classes, e.g. Request\n      else if (baseType.match(/^[A-Z]/) && baseType in window) {\n        typeSchema = z.instanceof(window[baseType]);\n      }\n      // Generate a schema for a single parameter that can be of multiple\n      // types / constants, i.e. `String|Number|Array`.\n      //\n      // Here, z.union() is used over z.enum() (which seems more intuitive) for\n      // constants for the following reasons:\n      // 1) z.enum() only allows a fixed set of allowable string values. However,\n      // our constants sometimes have numeric or non-primitive values.\n      // 2) In some cases, the type can be constants or strings, making z.enum()\n      // insufficient for the use case.\n      else if (baseType.includes('|') && baseType.split('|').every(t => validBracketNesting(t))) {\n        const types = baseType.split('|');\n        typeSchema = z.union(types\n          .map(t => generateTypeSchema(t))\n          .filter(s => s !== undefined));\n      } else if (baseType.endsWith('[]')) {\n        typeSchema = z.array(generateTypeSchema(baseType.slice(0, -2)));\n      } else {\n        throw new Error(`Unsupported type '${baseType}' in parameter validation. Please report this issue.`);\n      }\n\n      return typeSchema;\n    };\n\n    // Generate a schema for a single parameter. In the case where a parameter can\n    // be of multiple types, `generateTypeSchema` is called for each type.\n    const generateParamSchema = param => {\n      const isOptional = param?.endsWith('?');\n      param = param?.replace(/\\?$/, '');\n\n      const isRest = param?.startsWith('...') && param?.endsWith('[]');\n      param = param?.replace(/^\\.\\.\\.(.+)\\[\\]$/, '$1');\n\n      let schema = generateTypeSchema(param);\n      // Fallback to z.custom() because function types are no longer \n      // returns a Zod schema.\n      if (schema.def.type === 'function') {\n        schema = z.custom(val => val instanceof Function);\n      }\n\n      if (isOptional) {\n        schema = schema.optional();\n      }\n      return { schema, rest: isRest };\n    };\n\n    // Note that in Zod, `optional()` only checks for undefined, not the absence\n    // of value.\n    //\n    // Let's say we have a function with 3 parameters, and the last one is\n    // optional, i.e. func(a, b, c?). If we only have a z.tuple() for the\n    // parameters, where the third schema is optional, then we will only be able\n    // to validate func(10, 10, undefined), but not func(10, 10), which is\n    // a completely valid call.\n    //\n    // Therefore, on top of using `optional()`, we also have to generate parameter\n    // combinations that are valid for all numbers of parameters.\n    const generateOverloadCombinations = params => {\n      // No optional parameters, return the original parameter list right away.\n      if (!params.some(p => p?.endsWith('?'))) {\n        return [params];\n      }\n\n      const requiredParamsCount = params.filter(p => p === null || !p.endsWith('?')).length;\n      const result = [];\n\n      for (let i = requiredParamsCount; i <= params.length; i++) {\n        result.push(params.slice(0, i));\n      }\n\n      return result;\n    };\n\n    // Generate schemas for each function overload and merge them\n    const overloadSchemas = overloads.flatMap(overload => {\n      const combinations = generateOverloadCombinations(overload);\n\n      return combinations.map(combo => {\n        const params = combo\n          .map(p => generateParamSchema(p))\n          .filter(s => s.schema !== undefined);\n\n        let rest;\n        if (params.at(-1)?.rest) {\n          rest = params.pop();\n        }\n\n        let combined = z.tuple(params.map(s => s.schema));\n        if (rest) {\n          combined = combined.rest(rest.schema);\n        }\n        return combined;\n      });\n    });\n\n    return overloadSchemas.length === 1\n      ? overloadSchemas[0]\n      : z.union(overloadSchemas);\n  };\n\n  /**\n   * Finds the closest schema to the input arguments.\n   *\n   * This is a helper function that identifies the closest schema to the input\n   * arguments, in the case of an initial validation error. We will then use the\n   * closest schema to generate a friendly error message.\n   *\n   * @private\n   * @param {z.ZodSchema} schema - Zod schema.\n   * @param {Array} args - User input arguments.\n   * @returns {z.ZodSchema} Closest schema matching the input arguments.\n   */\n  fn.findClosestSchema = function (schema, args) {\n    if (!(schema instanceof z.ZodUnion)) {\n      return schema;\n    }\n\n    // Helper function that scores how close the input arguments are to a schema.\n    // Lower score means closer match.\n    const scoreSchema = schema => {\n      let score = Infinity;\n      if (!(schema instanceof z.ZodTuple)) {\n        console.warn('Schema below is not a tuple: ');\n        printZodSchema(schema);\n        return score;\n      }\n\n      const numArgs = args.length;\n      const schemaItems = schema.def.items;\n      const numSchemaItems = schemaItems.length;\n      const numRequiredSchemaItems = schemaItems.filter(item => !item.isOptional()).length;\n\n      if (numArgs >= numRequiredSchemaItems && numArgs <= numSchemaItems) {\n        score = 0;\n      }\n      // Here, give more weight to mismatch in number of arguments.\n      //\n      // For example, color() can either take [Number, Number?] or\n      // [Number, Number, Number, Number?] as list of parameters.\n      // If the user passed in 3 arguments, [10, undefined, undefined], it's\n      // more than likely that they intended to pass in 3 arguments, but the\n      // last two arguments are invalid.\n      //\n      // If there's no bias towards matching the number of arguments, the error\n      // message will show that we're expecting at most 2 arguments, but more\n      // are received.\n      else {\n        score = Math.abs(\n          numArgs < numRequiredSchemaItems ? numRequiredSchemaItems - numArgs : numArgs - numSchemaItems\n        ) * 4;\n      }\n\n      for (let i = 0; i < Math.min(schemaItems.length, args.length); i++) {\n        const paramSchema = schemaItems[i];\n        const arg = args[i];\n\n        if (!paramSchema.safeParse(arg).success) score++;\n      }\n\n      return score;\n    };\n\n    // Default to the first schema, so that we are guaranteed to return a result.\n    let closestSchema = schema.def.options[0];\n    // We want to return the schema with the lowest score.\n    let bestScore = Infinity;\n\n    const schemaUnion = schema.def.options;\n    schemaUnion.forEach(schema => {\n      const score = scoreSchema(schema);\n      if (score < bestScore) {\n        closestSchema = schema;\n        bestScore = score;\n      }\n    });\n\n    return closestSchema;\n  };\n\n  /**\n   * Prints a friendly error message after parameter validation, if validation\n   * has failed.\n   *\n   * @method _friendlyParamError\n   * @private\n   * @param {z.ZodError} zodErrorObj - The Zod error object containing validation errors.\n   * @param {String} func - Name of the function. Expect global functions like `sin` and class methods like `p5.Vector.add`\n   * @returns {String} The friendly error message.\n   */\n  fn.friendlyParamError = function (zodErrorObj, func, args) {\n    let message = ' p5.js says: ';\n    let isVersionError = false;\n    // The `zodErrorObj` might contain multiple errors of equal importance\n    // (after scoring the schema closeness in `findClosestSchema`). Here, we\n    // always print the first error so that user can work through the errors\n    // one by one.\n    let currentError = zodErrorObj.issues[0];\n\n    // Helper function to build a type mismatch message.\n    const buildTypeMismatchMessage = (actualType, expectedTypeStr, position) => {\n      const positionStr = position ? `at the ${ordinals[position]} parameter` : '';\n      const actualTypeStr = actualType ? `, but received ${actualType}` : '';\n      return `Expected ${expectedTypeStr} ${positionStr}${actualTypeStr}`;\n    };\n\n    // Union errors occur when a parameter can be of multiple types but is not\n    // of any of them. In this case, aggregate all possible types and print\n    // a friendly error message that indicates what the expected types are at\n    // which position (position is not 0-indexed, for accessibility reasons).\n    const processUnionError = (error) => {\n      const expectedTypes = new Set();\n      let actualType;\n\n      error.errors.forEach(err => {\n        const issue = err[0];\n        if (issue) {\n          if (!actualType) {\n            actualType = issue.message;\n          }\n\n          if (issue.code === 'invalid_type') {\n            actualType = issue.message.split(', received ')[1];\n            expectedTypes.add(issue.expected);\n          }\n          // The case for constants. Since we don't want to print out the actual\n          // constant values in the error message, the error message will\n          // direct users to the documentation.\n          else if (issue.code === 'invalid_value') {\n            expectedTypes.add(\"constant (please refer to documentation for allowed values)\");\n              actualType = args[error.path[0]];\n          } else if (issue.code === 'custom') {\n            const match = issue.message.match(/Input not instance of (\\w+)/);\n            if (match) expectedTypes.add(match[1]);\n            actualType = undefined;\n          }\n        }\n      });\n\n      if (expectedTypes.size > 0) {\n        if (error.path?.length > 0 && args[error.path[0]] instanceof Promise)  {\n          message += 'Did you mean to put `await` before a loading function? ' +\n            'An unexpected Promise was found. ';\n          isVersionError = true;\n        }\n\n        const expectedTypesStr = Array.from(expectedTypes).join(' or ');\n        const position = error.path.join('.');\n\n        message += buildTypeMismatchMessage(actualType, expectedTypesStr, position);\n      }\n\n      return message;\n    };\n\n    switch (currentError.code) {\n      case 'invalid_union': {\n        processUnionError(currentError);\n        break;\n      }\n      case 'too_small': {\n        const minArgs = currentError.minimum;\n        message += `Expected at least ${minArgs} argument${minArgs > 1 ? 's' : ''}, but received fewer`;\n        break;\n      }\n      case 'invalid_type': {\n        message += buildTypeMismatchMessage(currentError.message.split(', received ')[1], currentError.expected, currentError.path.join('.'));\n        break;\n      }\n      case 'too_big': {\n        const maxArgs = currentError.maximum;\n        message += `Expected at most ${maxArgs} argument${maxArgs > 1 ? 's' : ''}, but received more`;\n        break;\n      }\n      default: {\n        console.log('Zod error object', currentError);\n      }\n    }\n\n    // Let the user know which function is generating the error.\n    message += ` in ${func}().`;\n\n    // Generates a link to the documentation based on the given function name.\n    // TODO: Check if the link is reachable before appending it to the error\n    // message.\n    const generateDocumentationLink = (func) => {\n      const { funcName, funcClass } = extractFuncNameAndClass(func);\n      const p5BaseUrl = 'https://p5js.org/reference';\n      const url = `${p5BaseUrl}/${funcClass}/${funcName}`;\n\n      return url;\n    };\n\n    if (currentError.code === 'too_big' || currentError.code === 'too_small') {\n      const documentationLink = generateDocumentationLink(func);\n      message += ` For more information, see ${documentationLink}.`;\n    }\n\n    if (isVersionError) {\n      p5._error(this, message);\n    } else {\n      console.log(message);\n    }\n    return message;\n  };\n\n  /**\n   * Runs parameter validation by matching the input parameters to Zod schemas\n   * generated from the parameter data from `docs/parameterData.json`.\n   *\n   * @private\n   * @param {String} func - Name of the function.\n   * @param {Array} args - User input arguments.\n   * @returns {Object} The validation result.\n   * @returns {Boolean} result.success - Whether the validation was successful.\n   * @returns {any} [result.data] - The parsed data if validation was successful.\n   * @returns {String} [result.error] - The validation error message if validation has failed.\n   */\n  fn.validate = function (func, args) {\n    if (p5.disableFriendlyErrors) {\n      return; // skip FES\n    }\n\n    if (!Array.isArray(args)) {\n      args = Array.from(args);\n    }\n\n    // An edge case: even when all arguments are optional and therefore,\n    // theoretically allowed to stay undefined and valid, it is likely that the\n    // user intended to call the function with non-undefined arguments. Skip\n    // regular workflow and return a friendly error message right away.\n    if (Array.isArray(args) && args.length > 0 && args.every(arg => arg === undefined)) {\n      const undefinedErrorMessage = ` p5.js says: All arguments for ${func}() are undefined. There is likely an error in the code.`;\n\n      return {\n        success: false,\n        error: undefinedErrorMessage\n      };\n    }\n\n    let funcSchemas = schemaRegistry.get(func);\n    if (!funcSchemas) {\n      funcSchemas = fn.generateZodSchemasForFunc(func);\n      if (!funcSchemas) return;\n      schemaRegistry.set(func, funcSchemas);\n    }\n\n    try {\n      return {\n        success: true,\n        data: funcSchemas.parse(args)\n      };\n    } catch (error) {\n      const closestSchema = fn.findClosestSchema(funcSchemas, args);\n      const zodError = closestSchema.safeParse(args).error;\n      const errorMessage = fn.friendlyParamError(zodError, func, args);\n\n      return {\n        success: false,\n        error: errorMessage\n      };\n    }\n  };\n\n  lifecycles.presetup = function(){\n    loadP5Constructors();\n\n    if(p5.disableParameterValidator !== true){\n      const excludes = ['validate'];\n      for(const f in this){\n        if(!excludes.includes(f) && !f.startsWith('_') && typeof this[f] === 'function'){\n          const copy = this[f];\n\n          this[f] = function(...args) {\n            this.validate(f, args);\n            return copy.call(this, ...args);\n          };\n        }\n      }\n    }\n  };\n}\n\nif (typeof p5 !== 'undefined') {\n  validateParams(p5, p5.prototype);\n}\n\nexport { validateParams as default };\n","import { parse } from 'acorn';\nimport { simple } from 'acorn-walk';\nimport { v as constants } from '../../constants-8IpwyBct.js';\n\n// List of functions to ignore as they either are meant to be re-defined or\n// generate false positive outputs.\nconst ignoreFunction = [\n  'setup',\n  'draw',\n  'preload',\n  'deviceMoved',\n  'deviceTurned',\n  'deviceShaken',\n  'doubleClicked',\n  'mousePressed',\n  'mouseReleased',\n  'mouseMoved',\n  'mouseDragged',\n  'mouseClicked',\n  'mouseWheel',\n  'touchStarted',\n  'touchMoved',\n  'touchEnded',\n  'keyPressed',\n  'keyReleased',\n  'keyTyped',\n  'windowResized',\n  // 'name',\n  // 'parent',\n  // 'toString',\n  // 'print',\n  // 'stop',\n  // 'onended'\n];\n\nconst verifierUtils = {\n\n  /**\n   * Fetches the contents of a script element in the user's sketch.\n   *\n   * @private\n   * @method fetchScript\n   * @param {HTMLScriptElement} script\n   * @returns {Promise<string>}\n */\n  fetchScript: async function (script) {\n    if (script.src) {\n      try {\n        const contents = await fetch(script.src).then((res) => res.text());\n        return contents;\n      } catch (error) {\n        // TODO: Handle CORS error here.\n        console.error('Error fetching script:', error);\n        return '';\n      }\n    } else {\n      return script.textContent;\n    }\n  },\n\n  /**\n   * Extracts the user-defined variables and functions from the user code with\n   * the help of Espree parser.\n   *\n   * @private\n   * @method extractUserDefinedVariablesAndFuncs\n   * @param {String} code - The code to extract variables and functions from.\n   * @returns {Object} An object containing the user's defined variables and functions.\n   * @returns {Array<{name: string, line: number}>} [userDefinitions.variables] Array of user-defined variable names and their line numbers.\n   * @returns {Array<{name: string, line: number}>} [userDefinitions.functions] Array of user-defined function names and their line numbers.\n   */\n  extractUserDefinedVariablesAndFuncs: function (code) {\n    const userDefinitions = {\n      variables: [],\n      functions: []\n    };\n    // The line numbers from the parser are consistently off by one, add\n    // `lineOffset` here to correct them.\n    const lineOffset = -1;\n\n    try {\n      const ast = parse(code, {\n        ecmaVersion: 2021,\n        sourceType: 'module',\n        locations: true  // This helps us get the line number.\n      });\n\n      simple(ast, {\n        VariableDeclarator(node) {\n          if (node.id.type === 'Identifier') {\n            const category = node.init && ['ArrowFunctionExpression', 'FunctionExpression'].includes(node.init.type)\n              ? 'functions'\n              : 'variables';\n            userDefinitions[category].push({\n              name: node.id.name,\n              line: node.loc.start.line + lineOffset\n            });\n          }\n        },\n        FunctionDeclaration(node) {\n          if (node.id && node.id.type === 'Identifier') {\n            userDefinitions.functions.push({\n              name: node.id.name,\n              line: node.loc.start.line + lineOffset\n            });\n          }\n        },\n        // We consider class declarations to be a special form of variable\n        // declaration.\n        ClassDeclaration(node) {\n          if (node.id && node.id.type === 'Identifier') {\n            userDefinitions.variables.push({\n              name: node.id.name,\n              line: node.loc.start.line + lineOffset\n            });\n          }\n        }\n      });\n    } catch (error) {\n      // TODO: Replace this with a friendly error message.\n      console.error('Error parsing code:', error);\n    }\n\n    return userDefinitions;\n  },\n\n  /**\n   * Checks user-defined variables and functions for conflicts with p5.js\n   * constants and global functions.\n   *\n   * This function performs two main checks:\n   * 1. Verifies if any user definition conflicts with p5.js constants.\n   * 2. Checks if any user definition conflicts with global functions from\n   * p5.js renderer classes.\n   *\n   * If a conflict is found, it reports a friendly error message and halts\n   * further checking.\n   *\n   * @private\n   * @param {Object} userDefinitions - An object containing user-defined variables and functions.\n   * @param {Array<{name: string, line: number}>} userDefinitions.variables - Array of user-defined variable names and their line numbers.\n   * @param {Array<{name: string, line: number}>} userDefinitions.functions - Array of user-defined function names and their line numbers.\n   * @returns {boolean} - Returns true if a conflict is found, false otherwise.\n   */\n  checkForConstsAndFuncs: function (userDefinitions, p5) {\n    const allDefinitions = [\n      ...userDefinitions.variables,\n      ...userDefinitions.functions\n    ];\n\n    // Helper function that generates a friendly error message that contains\n    // the type of redefinition (constant or function), the name of the\n    // redefinition, the line number in user's code, and a link to its\n    // reference on the p5.js website.\n    function generateFriendlyError(errorType, name, line) {\n      const url = `https://p5js.org/reference/p5/${name}`;\n      const message = `${errorType} \"${name}\" on line ${line} is being redeclared and conflicts with a p5.js ${errorType.toLowerCase()}. p5.js reference: ${url}`;\n      return message;\n    }\n\n    // Checks for constant redefinitions.\n    for (let { name, line } of allDefinitions) {\n      const libDefinition = constants[name];\n      if (libDefinition !== undefined) {\n        const message = generateFriendlyError('Constant', name, line);\n        console.log(message);\n        return true;\n      }\n    }\n\n    // The new rules for attaching anything to global are (if true for both of\n    // the following):\n    //   - It is a member of p5.prototype\n    //   - Its name does not start with `_`\n    const globalFunctions = new Set(\n      Object.getOwnPropertyNames(p5.prototype)\n        .filter(key => !key.startsWith('_') && key !== 'constructor')\n    );\n\n    for (let { name, line } of allDefinitions) {\n      if (!ignoreFunction.includes(name) && globalFunctions.has(name)) {\n        const message = generateFriendlyError('Function', name, line);\n        console.log(message);\n        return true;\n      }\n    }\n\n    return false;\n  },\n\n  /**\n   * Extracts the user's code from the script fetched. Note that this method\n   * assumes that the user's code is always the last script element in the\n   * sketch.\n   *\n   * @private\n   * @method getUserCode\n   * @returns {Promise<string>} The user's code as a string.\n   */\n  getUserCode: async function () {\n    // TODO: think of a more robust way to get the user's code. Refer to\n    // https://github.com/processing/p5.js/pull/7293.\n    const scripts = document.querySelectorAll('script');\n    const userCodeScript = scripts[scripts.length - 1];\n    const userCode = await verifierUtils.fetchScript(userCodeScript);\n\n    return userCode;\n  },\n\n  /**\n   * @private\n   */\n  runFES: async function (p5) {\n    const userCode = await verifierUtils.getUserCode();\n    const userDefinedVariablesAndFuncs = verifierUtils.extractUserDefinedVariablesAndFuncs(userCode);\n\n    verifierUtils.checkForConstsAndFuncs(userDefinedVariablesAndFuncs, p5);\n  }\n};\n\nfunction sketchVerifier(p5, _fn, lifecycles) {\n  lifecycles.presetup = async function() {\n    if (!p5.disableFriendlyErrors && !p5.disableSketchChecker) {\n      verifierUtils.runFES(p5);\n    }\n  };\n}\n\nif (typeof p5 !== 'undefined') {\n  sketchVerifier(p5, p5.prototype);\n}\n\nexport { sketchVerifier as default, verifierUtils };\n","import { translator } from '../internationalization.js';\nimport 'i18next';\nimport 'i18next-browser-languagedetector';\n\n/**\n * @for p5\n * @requires core\n */\n\nfunction fileErrors(p5, fn){\n  // mapping used by `_friendlyFileLoadError`\n  const fileLoadErrorCases = (num, filePath) => {\n    const suggestion = translator('fes.fileLoadError.suggestion', {\n      filePath,\n      url: 'https://github.com/processing/p5.js/wiki/Local-server'\n    });\n    switch (num) {\n      case 0:\n        return {\n          message: translator('fes.fileLoadError.image', {\n            suggestion\n          }),\n          method: 'loadImage'\n        };\n      case 1:\n        return {\n          message: translator('fes.fileLoadError.xml', {\n            suggestion\n          }),\n          method: 'loadXML'\n        };\n      case 2:\n        return {\n          message: translator('fes.fileLoadError.table', {\n            suggestion\n          }),\n          method: 'loadTable'\n        };\n      case 3:\n        return {\n          message: translator('fes.fileLoadError.strings', {\n            suggestion\n          }),\n          method: 'loadStrings'\n        };\n      case 4:\n        return {\n          message: translator('fes.fileLoadError.font', {\n            suggestion\n          }),\n          method: 'loadFont'\n        };\n      case 5:\n        return {\n          message: translator('fes.fileLoadError.json', {\n            suggestion\n          }),\n          method: 'loadJSON'\n        };\n      case 6:\n        return {\n          message: translator('fes.fileLoadError.bytes', {\n            suggestion\n          }),\n          method: 'loadBytes'\n        };\n      case 7:\n        return {\n          message: translator('fes.fileLoadError.large'),\n          method: 'loadX'\n        };\n      case 8:\n        return {\n          message: translator('fes.fileLoadError.gif'),\n          method: 'loadImage'\n        };\n    }\n  };\n\n  /**\n   * Called internally if there is an error during file loading.\n   *\n   * Generates and prints a friendly error message using key:\n   * \"fes.fileLoadError.[*]\".\n   *\n   * @method _friendlyFileLoadError\n   * @private\n   * @param  {Number} errorType   Number of file load error type\n   * @param  {String} filePath    Path to file caused the error\n   */\n  p5._friendlyFileLoadError = function(errorType, filePath) {\n    const { message, method } = fileLoadErrorCases(errorType, filePath);\n    p5._friendlyError(message, method, 3);\n  };\n}\n\nif (typeof p5 !== 'undefined') {\n  fileErrors(p5, p5.prototype);\n}\n\nexport { fileErrors as default };\n","/**\n * @module Data\n * @submodule LocalStorage\n * @requires core\n *\n * This module defines the p5 methods for working with local storage\n */\n\nfunction storage(p5, fn){\n  /**\n   * Stores a value in the web browser's local storage.\n   *\n   * Web browsers can save small amounts of data using the built-in\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage\" target=\"_blank\">localStorage object</a>.\n   * Data stored in `localStorage` can be retrieved at any point, even after\n   * refreshing a page or restarting the browser. Data are stored as key-value\n   * pairs.\n   *\n   * `storeItem()` makes it easy to store values in `localStorage` and\n   * <a href=\"#/p5/getItem\">getItem()</a> makes it easy to retrieve them.\n   *\n   * The first parameter, `key`, is the name of the value to be stored as a\n   * string.\n   *\n   * The second parameter, `value`, is the value to be stored. Values can have\n   * any type.\n   *\n   * Note: Sensitive data such as passwords or personal information shouldn't be\n   * stored in `localStorage`.\n   *\n   * @method storeItem\n   * @for p5\n   * @param {String} key name of the value.\n   * @param {String|Number|Boolean|Object|Array} value value to be stored.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Store the player's name.\n   *   storeItem('name', 'Feist');\n   *\n   *   // Store the player's score.\n   *   storeItem('score', 1234);\n   *\n   *   describe('The text \"Feist: 1234\" written in black on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(14);\n   *\n   *   // Retrieve the name.\n   *   let name = getItem('name');\n   *\n   *   // Retrieve the score.\n   *   let score = getItem('score');\n   *\n   *   // Display the score.\n   *   text(`${name}: ${score}`, 50, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create an object.\n   *   let p = { x: 50, y: 50 };\n   *\n   *   // Store the object.\n   *   storeItem('position', p);\n   *\n   *   describe('A white circle on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Retrieve the object.\n   *   let p = getItem('position');\n   *\n   *   // Draw the circle.\n   *   circle(p.x, p.y, 30);\n   * }\n   * </code>\n   * </div>\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color('deeppink');\n   *\n   *   // Store the object.\n   *   storeItem('color', c);\n   *\n   *   describe('A pink circle on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Retrieve the object.\n   *   let c = getItem('color');\n   *\n   *   // Style the circle.\n   *   fill(c);\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, 30);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.storeItem = function(key, value) {\n    if (typeof key !== 'string') {\n      console.log(\n        `The argument that you passed to storeItem() - ${key} is not a string.`\n      );\n    }\n    if (key.endsWith('p5TypeID')) {\n      console.log(\n        `The argument that you passed to storeItem() - ${key} must not end with 'p5TypeID'.`\n      );\n    }\n\n    if (typeof value === 'undefined') {\n      console.log('You cannot store undefined variables using storeItem().');\n    }\n    let type = typeof value;\n    switch (type) {\n      case 'number':\n      case 'boolean':\n        value = value.toString();\n        break;\n      case 'object':\n        if (value instanceof p5.Color) {\n          type = 'p5.Color';\n          value = value.toString();\n        } else if (value instanceof p5.Vector) {\n          type = 'p5.Vector';\n          const coord = [value.x, value.y, value.z];\n          value = coord;\n        }\n        value = JSON.stringify(value);\n        break;\n    }\n\n    localStorage.setItem(key, value);\n    const typeKey = `${key}p5TypeID`;\n    localStorage.setItem(typeKey, type);\n  };\n\n  /**\n   * Returns a value in the web browser's local storage.\n   *\n   * Web browsers can save small amounts of data using the built-in\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage\" target=\"_blank\">localStorage object</a>.\n   * Data stored in `localStorage` can be retrieved at any point, even after\n   * refreshing a page or restarting the browser. Data are stored as key-value\n   * pairs.\n   *\n   * <a href=\"#/p5/storeItem\">storeItem()</a> makes it easy to store values in\n   * `localStorage` and `getItem()` makes it easy to retrieve them.\n   *\n   * The first parameter, `key`, is the name of the value to be stored as a\n   * string.\n   *\n   * The second parameter, `value`, is the value to be retrieved a string. For\n   * example, calling `getItem('size')` retrieves the value with the key `size`.\n   *\n   * Note: Sensitive data such as passwords or personal information shouldn't be\n   * stored in `localStorage`.\n   *\n   * @method getItem\n   * @for p5\n   * @param {String} key name of the value.\n   * @return {String|Number|Boolean|Object|Array} stored item.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Store the player's name.\n   *   storeItem('name', 'Feist');\n   *\n   *   // Store the player's score.\n   *   storeItem('score', 1234);\n   *\n   *   describe('The text \"Feist: 1234\" written in black on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(14);\n   *\n   *   // Retrieve the name.\n   *   let name = getItem('name');\n   *\n   *   // Retrieve the score.\n   *   let score = getItem('score');\n   *\n   *   // Display the score.\n   *   text(`${name}: ${score}`, 50, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create an object.\n   *   let p = { x: 50, y: 50 };\n   *\n   *   // Store the object.\n   *   storeItem('position', p);\n   *\n   *   describe('A white circle on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Retrieve the object.\n   *   let p = getItem('position');\n   *\n   *   // Draw the circle.\n   *   circle(p.x, p.y, 30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a p5.Color object.\n   *   let c = color('deeppink');\n   *\n   *   // Store the object.\n   *   storeItem('color', c);\n   *\n   *   describe('A pink circle on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Retrieve the object.\n   *   let c = getItem('color');\n   *\n   *   // Style the circle.\n   *   fill(c);\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, 30);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.getItem = function(key) {\n    let value = localStorage.getItem(key);\n    const type = localStorage.getItem(`${key}p5TypeID`);\n    if (typeof type === 'undefined') {\n      console.log(\n        `Unable to determine type of item stored under ${key}in local storage. Did you save the item with something other than setItem()?`\n      );\n    } else if (value !== null) {\n      switch (type) {\n        case 'number':\n          value = parseFloat(value);\n          break;\n        case 'boolean':\n          value = value === 'true';\n          break;\n        case 'object':\n          value = JSON.parse(value);\n          break;\n        case 'p5.Color':\n          value = this.color(JSON.parse(value));\n          break;\n        case 'p5.Vector':\n          value = JSON.parse(value);\n          value = this.createVector(...value);\n          break;\n      }\n    }\n    return value;\n  };\n\n  /**\n   * Removes all items in the web browser's local storage.\n   *\n   * Web browsers can save small amounts of data using the built-in\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage\" target=\"_blank\">localStorage object</a>.\n   * Data stored in `localStorage` can be retrieved at any point, even after\n   * refreshing a page or restarting the browser. Data are stored as key-value\n   * pairs. Calling `clearStorage()` removes all data from `localStorage`.\n   *\n   * Note: Sensitive data such as passwords or personal information shouldn't be\n   * stored in `localStorage`.\n   *\n   * @method clearStorage\n   * @for p5\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to clear localStorage.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Store the player's name.\n   *   storeItem('name', 'Feist');\n   *\n   *   // Store the player's score.\n   *   storeItem('score', 1234);\n   *\n   *   describe(\n   *     'The text \"Feist: 1234\" written in black on a gray background. The text \"null: null\" appears when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(14);\n   *\n   *   // Retrieve the name.\n   *   let name = getItem('name');\n   *\n   *   // Retrieve the score.\n   *   let score = getItem('score');\n   *\n   *   // Display the score.\n   *   text(`${name}: ${score}`, 50, 50);\n   * }\n   *\n   * // Clear localStorage when the user double-clicks.\n   * function doubleClicked() {\n   *   clearStorage();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.clearStorage = function () {\n    const keys = Object.keys(localStorage);\n    keys.forEach(key => {\n      if (key.endsWith('p5TypeID')) {\n        this.removeItem(key.replace('p5TypeID', ''));\n      }\n    });\n  };\n\n  /**\n   * Removes an item from the web browser's local storage.\n   *\n   * Web browsers can save small amounts of data using the built-in\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage\" target=\"_blank\">localStorage object</a>.\n   * Data stored in `localStorage` can be retrieved at any point, even after\n   * refreshing a page or restarting the browser. Data are stored as key-value\n   * pairs.\n   *\n   * <a href=\"#/p5/storeItem\">storeItem()</a> makes it easy to store values in\n   * `localStorage` and `removeItem()` makes it easy to delete them.\n   *\n   * The parameter, `key`, is the name of the value to remove as a string. For\n   * example, calling `removeItem('size')` removes the item with the key `size`.\n   *\n   * Note: Sensitive data such as passwords or personal information shouldn't be\n   * stored in `localStorage`.\n   *\n   * @method removeItem\n   * @param {String} key name of the value to remove.\n   * @for p5\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Double-click to remove an item from localStorage.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Store the player's name.\n   *   storeItem('name', 'Feist');\n   *\n   *   // Store the player's score.\n   *   storeItem('score', 1234);\n   *\n   *   describe(\n   *     'The text \"Feist: 1234\" written in black on a gray background. The text \"Feist: null\" appears when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(14);\n   *\n   *   // Retrieve the name.\n   *   let name = getItem('name');\n   *\n   *   // Retrieve the score.\n   *   let score = getItem('score');\n   *\n   *   // Display the score.\n   *   text(`${name}: ${score}`, 50, 50);\n   * }\n   *\n   * // Remove the word from localStorage when the user double-clicks.\n   * function doubleClicked() {\n   *   removeItem('score');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.removeItem = function(key) {\n    if (typeof key !== 'string') {\n      console.log(\n        `The argument that you passed to removeItem() - ${key} is not a string.`\n      );\n    }\n    localStorage.removeItem(key);\n    localStorage.removeItem(`${key}p5TypeID`);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  storage(p5, p5.prototype);\n}\n\nexport { storage as default };\n","import { Element } from './p5.Element.js';\nimport { MediaElement } from './p5.MediaElement.js';\nimport { File } from './p5.File.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../constants-8IpwyBct.js';\nimport '../io/p5.XML.js';\n\n/**\n * The web is much more than just canvas and the DOM functionality makes it easy to interact\n * with other HTML5 objects, including text, hyperlink, image, input, video,\n * audio, and webcam.\n * There is a set of creation methods, DOM manipulation methods, and\n * an extended <a href=\"#/p5.Element\">p5.Element</a> that supports a range of HTML elements. See the\n * <a href='https://github.com/processing/p5.js/wiki/Beyond-the-canvas'>\n * beyond the canvas tutorial</a> for a full overview of how this addon works.\n *\n * See <a href='https://github.com/processing/p5.js/wiki/Beyond-the-canvas'>tutorial: beyond the canvas</a>\n * for more info on how to use this library.</a>\n *\n * @module DOM\n * @submodule DOM\n * @for p5\n * @requires p5\n */\n\n\nfunction dom(p5, fn){\n  /**\n   * Searches the page for the first element that matches the given\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/CSS_basics#different_types_of_selectors\" target=\"_blank\">CSS selector string</a>.\n   *\n   * The selector string can be an ID, class, tag name, or a combination.\n   * `select()` returns a <a href=\"#/p5.Element\">p5.Element</a> object if it\n   * finds a match and `null` if not.\n   *\n   * The second parameter, `container`, is optional. It specifies a container to\n   * search within. `container` can be CSS selector string, a\n   * <a href=\"#/p5.Element\">p5.Element</a> object, or an\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement\" target=\"_blank\">HTMLElement</a> object.\n   *\n   * @method select\n   * @param  {String} selectors CSS selector string of element to search for.\n   * @param  {String|p5.Element|HTMLElement} [container] CSS selector string, <a href=\"#/p5.Element\">p5.Element</a>, or\n   *                                             <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement\" target=\"_blank\">HTMLElement</a> to search within.\n   * @return {p5.Element|null} <a href=\"#/p5.Element\">p5.Element</a> containing the element.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(200);\n   *\n   *   // Select the canvas by its tag.\n   *   let cnv = select('canvas');\n   *   cnv.style('border', '5px deeppink dashed');\n   *\n   *   describe('A gray square with a dashed pink border.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   // Add a class attribute to the canvas.\n   *   cnv.class('pinkborder');\n   *\n   *   background(200);\n   *\n   *   // Select the canvas by its class.\n   *   cnv = select('.pinkborder');\n   *\n   *   // Style its border.\n   *   cnv.style('border', '5px deeppink dashed');\n   *\n   *   describe('A gray square with a dashed pink border.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   let cnv = createCanvas(100, 100);\n   *\n   *   // Set the canvas' ID.\n   *   cnv.id('mycanvas');\n   *\n   *   background(200);\n   *\n   *   // Select the canvas by its ID.\n   *   cnv = select('#mycanvas');\n   *\n   *   // Style its border.\n   *   cnv.style('border', '5px deeppink dashed');\n   *\n   *   describe('A gray square with a dashed pink border.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.select = function (e, p) {\n    // p5._validateParameters('select', arguments);\n    const container = this._getContainer(p);\n    const res = container.querySelector(e);\n    if (res) {\n      return this._wrapElement(res);\n    } else {\n      return null;\n    }\n  };\n\n  /**\n   * Searches the page for all elements that matches the given\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/CSS_basics#different_types_of_selectors\" target=\"_blank\">CSS selector string</a>.\n   *\n   * The selector string can be an ID, class, tag name, or a combination.\n   * `selectAll()` returns an array of <a href=\"#/p5.Element\">p5.Element</a>\n   * objects if it finds any matches and an empty array if none are found.\n   *\n   * The second parameter, `container`, is optional. It specifies a container to\n   * search within. `container` can be CSS selector string, a\n   * <a href=\"#/p5.Element\">p5.Element</a> object, or an\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement\" target=\"_blank\">HTMLElement</a> object.\n   *\n   * @method selectAll\n   * @param  {String} selectors CSS selector string of element to search for.\n   * @param  {String|p5.Element|HTMLElement} [container] CSS selector string, <a href=\"#/p5.Element\">p5.Element</a>, or\n   *                                             <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement\" target=\"_blank\">HTMLElement</a> to search within.\n   * @return {p5.Element[]} array of <a href=\"#/p5.Element\">p5.Element</a>s containing any elements found.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create three buttons.\n   *   createButton('1');\n   *   createButton('2');\n   *   createButton('3');\n   *\n   *   // Select the buttons by their tag.\n   *   let buttons = selectAll('button');\n   *\n   *   // Position the buttons.\n   *   for (let i = 0; i < 3; i += 1) {\n   *     buttons[i].position(0, i * 30);\n   *   }\n   *\n   *   describe('Three buttons stacked vertically. The buttons are labeled, \"1\", \"2\", and \"3\".');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create three buttons and position them.\n   *   let b1 = createButton('1');\n   *   b1.position(0, 0);\n   *   let b2 = createButton('2');\n   *   b2.position(0, 30);\n   *   let b3 = createButton('3');\n   *   b3.position(0, 60);\n   *\n   *   // Add a class attribute to each button.\n   *   b1.class('btn');\n   *   b2.class('btn btn-pink');\n   *   b3.class('btn');\n   *\n   *   // Select the buttons by their class.\n   *   let buttons = selectAll('.btn');\n   *   let pinkButtons = selectAll('.btn-pink');\n   *\n   *   // Style the selected buttons.\n   *   buttons.forEach(setFont);\n   *   pinkButtons.forEach(setColor);\n   *\n   *   describe('Three buttons stacked vertically. The buttons are labeled, \"1\", \"2\", and \"3\". Buttons \"1\" and \"3\" are gray. Button \"2\" is pink.');\n   * }\n   *\n   * // Set a button's font to Comic Sans MS.\n   * function setFont(btn) {\n   *   btn.style('font-family', 'Comic Sans MS');\n   * }\n   *\n   * // Set a button's background and font color.\n   * function setColor(btn) {\n   *   btn.style('background', 'deeppink');\n   *   btn.style('color', 'white');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.selectAll = function (e, p) {\n    // p5._validateParameters('selectAll', arguments);\n    const arr = [];\n    const container = this._getContainer(p);\n    const res = container.querySelectorAll(e);\n    if (res) {\n      for (let j = 0; j < res.length; j++) {\n        const obj = this._wrapElement(res[j]);\n        arr.push(obj);\n      }\n    }\n    return arr;\n  };\n\n  /**\n   * Helper function for select and selectAll\n   */\n  fn._getContainer = function (p) {\n    let container = document;\n    if (typeof p === 'string') {\n      container = document.querySelector(p) || document;\n    } else if (p instanceof Element) {\n      container = p.elt;\n    } else if (p instanceof HTMLElement) {\n      container = p;\n    }\n    return container;\n  };\n\n  /**\n   * Helper function for getElement and getElements.\n   */\n  fn._wrapElement = function (elt) {\n    const children = Array.prototype.slice.call(elt.children);\n    if (elt.tagName === 'INPUT' && elt.type === 'checkbox') {\n      let converted = new Element(elt, this);\n      converted.checked = function (...args) {\n        if (args.length === 0) {\n          return this.elt.checked;\n        } else if (args[0]) {\n          this.elt.checked = true;\n        } else {\n          this.elt.checked = false;\n        }\n        return this;\n      };\n      return converted;\n    } else if (elt.tagName === 'VIDEO' || elt.tagName === 'AUDIO') {\n      return new MediaElement(elt, this);\n    } else if (elt.tagName === 'SELECT') {\n      return this.createSelect(new Element(elt, this));\n    } else if (\n      children.length > 0 &&\n      children.every(function (c) {\n        return c.tagName === 'INPUT' || c.tagName === 'LABEL';\n      }) &&\n      (elt.tagName === 'DIV' || elt.tagName === 'SPAN')\n    ) {\n      return this.createRadio(new Element(elt, this));\n    } else {\n      return new Element(elt, this);\n    }\n  };\n\n  /**\n   * Creates a new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * The first parameter, `tag`, is a string an HTML tag such as `'h5'`.\n   *\n   * The second parameter, `content`, is optional. It's a string that sets the\n   * HTML content to insert into the new element. New elements have no content\n   * by default.\n   *\n   * @method createElement\n   * @param  {String} tag tag for the new element.\n   * @param  {String} [content] HTML content to insert into the element.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an h5 element with nothing in it.\n   *   createElement('h5');\n   *\n   *   describe('A gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an h5 element with the content \"p5*js\".\n   *   let h5 = createElement('h5', 'p5*js');\n   *\n   *   // Set the element's style and position.\n   *   h5.style('color', 'deeppink');\n   *   h5.position(30, 15);\n   *\n   *   describe('The text \"p5*js\" written in pink in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createElement = function (tag, content) {\n    // p5._validateParameters('createElement', arguments);\n    const elt = document.createElement(tag);\n    if (typeof content !== 'undefined') {\n      elt.innerHTML = content;\n    }\n    return addElement(elt, this);\n  };\n\n  /**\n   * Removes all elements created by p5.js, including any event handlers.\n   *\n   * There are two exceptions:\n   * canvas elements created by <a href=\"#/p5/createCanvas\">createCanvas()</a>\n   * and <a href=\"#/p5.Renderer\">p5.Render</a> objects created by\n   * <a href=\"#/p5/createGraphics\">createGraphics()</a>.\n   *\n   * @method removeElements\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a paragraph element and place\n   *   // it in the middle of the canvas.\n   *   let p = createP('p5*js');\n   *   p.position(25, 25);\n   *\n   *   describe('A gray square with the text \"p5*js\" written in its center. The text disappears when the mouse is pressed.');\n   * }\n   *\n   * // Remove all elements when the mouse is pressed.\n   * function mousePressed() {\n   *   removeElements();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let slider;\n   *\n   * function setup() {\n   *   createCanvas(200, 200);\n   *\n   *   // Create a paragraph element and place\n   *   // it at the top of the canvas.\n   *   let p = createP('p5*js');\n   *   p.position(25, 25);\n   *\n   *   // Create a slider element and place it\n   *   // beneath the canvas.\n   *   slider = createSlider(0, 255, 200);\n   *   slider.position(0, 100);\n   *\n   *   describe('A gray square with the text \"p5*js\" written in its center and a range slider beneath it. The square changes color when the slider is moved. The text and slider disappear when the square is double-clicked.');\n   * }\n   *\n   * function draw() {\n   *   // Use the slider value to change the background color.\n   *   let g = slider.value();\n   *   background(g);\n   * }\n   *\n   * // Remove all elements when the mouse is double-clicked.\n   * function doubleClicked() {\n   *   removeElements();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.removeElements = function (e) {\n    // p5._validateParameters('removeElements', arguments);\n    // el.remove splices from this._elements, so don't mix iteration with it\n    const isNotCanvasElement = el => !(el.elt instanceof HTMLCanvasElement);\n    const removeableElements = this._elements.filter(isNotCanvasElement);\n    removeableElements.map(el => el.remove());\n  };\n\n  /**\n   * Helpers for create methods.\n   */\n  function addElement(elt, pInst, media) {\n    const node = pInst._userNode ? pInst._userNode : document.body;\n    node.appendChild(elt);\n    const c = media\n      ? new MediaElement(elt, pInst)\n      : new Element(elt, pInst);\n    pInst._elements.push(c);\n    return c;\n  }\n\n  /**\n   * Creates a `&lt;div&gt;&lt;/div&gt;` element.\n   *\n   * `&lt;div&gt;&lt;/div&gt;` elements are commonly used as containers for\n   * other elements.\n   *\n   * The parameter `html` is optional. It accepts a string that sets the\n   * inner HTML of the new `&lt;div&gt;&lt;/div&gt;`.\n   *\n   * @method createDiv\n   * @param  {String} [html] inner HTML for the new `&lt;div&gt;&lt;/div&gt;` element.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a div element and set its position.\n   *   let div = createDiv('p5*js');\n   *   div.position(25, 35);\n   *\n   *   describe('A gray square with the text \"p5*js\" written in its center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an h3 element within the div.\n   *   let div = createDiv('<h3>p5*js</h3>');\n   *   div.position(20, 5);\n   *\n   *   describe('A gray square with the text \"p5*js\" written in its center.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createDiv = function (html = '') {\n    let elt = document.createElement('div');\n    elt.innerHTML = html;\n    return addElement(elt, this);\n  };\n\n  /**\n   * Creates a paragraph element.\n   *\n   * `&lt;p&gt;&lt;/p&gt;` elements are commonly used for paragraph-length text.\n   *\n   * The parameter `html` is optional. It accepts a string that sets the\n   * inner HTML of the new `&lt;p&gt;&lt;/p&gt;`.\n   *\n   * @method createP\n   * @param  {String} [html] inner HTML for the new `&lt;p&gt;&lt;/p&gt;` element.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a paragraph element and set its position.\n   *   let p = createP('Tell me a story.');\n   *   p.position(5, 0);\n   *\n   *   describe('A gray square displaying the text \"Tell me a story.\" written in black.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createP = function (html = '') {\n    let elt = document.createElement('p');\n    elt.innerHTML = html;\n    return addElement(elt, this);\n  };\n\n  /**\n   * Creates a `&lt;span&gt;&lt;/span&gt;` element.\n   *\n   * `&lt;span&gt;&lt;/span&gt;` elements are commonly used as containers\n   * for inline elements. For example, a `&lt;span&gt;&lt;/span&gt;`\n   * can hold part of a sentence that's a\n   * <span style=\"color: deeppink;\">different</span> style.\n   *\n   * The parameter `html` is optional. It accepts a string that sets the\n   * inner HTML of the new `&lt;span&gt;&lt;/span&gt;`.\n   *\n   * @method createSpan\n   * @param  {String} [html] inner HTML for the new `&lt;span&gt;&lt;/span&gt;` element.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a span element and set its position.\n   *   let span = createSpan('p5*js');\n   *   span.position(25, 35);\n   *\n   *   describe('A gray square with the text \"p5*js\" written in its center.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   background(200);\n   *\n   *   // Create a div element as a container.\n   *   let div = createDiv();\n   *\n   *   // Place the div at the center.\n   *   div.position(25, 35);\n   *\n   *   // Create a span element.\n   *   let s1 = createSpan('p5');\n   *\n   *   // Create a second span element.\n   *   let s2 = createSpan('*');\n   *\n   *   // Set the second span's font color.\n   *   s2.style('color', 'deeppink');\n   *\n   *   // Create a third span element.\n   *   let s3 = createSpan('js');\n   *\n   *   // Add all the spans to the container div.\n   *   s1.parent(div);\n   *   s2.parent(div);\n   *   s3.parent(div);\n   *\n   *   describe('A gray square with the text \"p5*js\" written in black at its center. The asterisk is pink.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createSpan = function (html = '') {\n    let elt = document.createElement('span');\n    elt.innerHTML = html;\n    return addElement(elt, this);\n  };\n\n  /**\n   * Creates an `&lt;img&gt;` element that can appear outside of the canvas.\n   *\n   * The first parameter, `src`, is a string with the path to the image file.\n   * `src` should be a relative path, as in `'assets/image.png'`, or a URL, as\n   * in `'https://example.com/image.png'`.\n   *\n   * The second parameter, `alt`, is a string with the\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/alt#usage_notes\" target=\"_blank\">alternate text</a>\n   * for the image. An empty string `''` can be used for images that aren't displayed.\n   *\n   * The third parameter, `crossOrigin`, is optional. It's a string that sets the\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_settings_attributes\" target=\"_blank\">crossOrigin property</a>\n   * of the image. Use `'anonymous'` or `'use-credentials'` to fetch the image\n   * with cross-origin access.\n   *\n   * The fourth parameter, `callback`, is also optional. It sets a function to\n   * call after the image loads. The new image is passed to the callback\n   * function as a <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @method createImg\n   * @param  {String} src relative path or URL for the image.\n   * @param  {String} alt alternate text for the image.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   let img = createImg(\n   *     '/assets/cat.jpg',\n   *     'image of a cat'\n   *   );\n   *   img.position(0, 10);\n   *\n   *   describe('A gray square with a magenta asterisk in its center.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method createImg\n   * @param  {String} src\n   * @param  {String} alt\n   * @param  {String} [crossOrigin] crossOrigin property to use when fetching the image.\n   * @param  {Function} [successCallback] function to call once the image loads. The new image will be passed\n   *                                      to the function as a <a href=\"#/p5.Element\">p5.Element</a> object.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   */\n  fn.createImg = function () {\n    // p5._validateParameters('createImg', arguments);\n    const elt = document.createElement('img');\n    const args = arguments;\n    let self;\n    if (args.length > 1 && typeof args[1] === 'string') {\n      elt.alt = args[1];\n    }\n    if (args.length > 2 && typeof args[2] === 'string') {\n      elt.crossOrigin = args[2];\n    }\n    elt.src = args[0];\n    self = addElement(elt, this);\n    elt.addEventListener('load', function () {\n      self.width = elt.offsetWidth || elt.width;\n      self.height = elt.offsetHeight || elt.height;\n      const last = args[args.length - 1];\n      if (typeof last === 'function') last(self);\n    });\n    return self;\n  };\n\n  /**\n   * Creates an `&lt;a&gt;&lt;/a&gt;` element that links to another web page.\n   *\n   * The first parmeter, `href`, is a string that sets the URL of the linked\n   * page.\n   *\n   * The second parameter, `html`, is a string that sets the inner HTML of the\n   * link. It's common to use text, images, or buttons as links.\n   *\n   * The third parameter, `target`, is optional. It's a string that tells the\n   * web browser where to open the link. By default, links open in the current\n   * browser tab. Passing `'_blank'` will cause the link to open in a new\n   * browser tab. MDN describes a few\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a#target\" target=\"_blank\">other options</a>.\n   *\n   * @method createA\n   * @param  {String} href       URL of linked page.\n   * @param  {String} html       inner HTML of link element to display.\n   * @param  {String} [target]   target where the new link should open,\n   *                             either `'_blank'`, `'_self'`, `'_parent'`, or `'_top'`.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an anchor element that links to p5js.org.\n   *   let a = createA('https://p5js.org/', 'p5*js');\n   *   a.position(25, 35);\n   *\n   *   describe('The text \"p5*js\" written at the center of a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   background(200);\n   *\n   *   // Create an anchor tag that links to p5js.org.\n   *   // Open the link in a new tab.\n   *   let a = createA('https://p5js.org/', 'p5*js', '_blank');\n   *   a.position(25, 35);\n   *\n   *   describe('The text \"p5*js\" written at the center of a gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createA = function (href, html, target) {\n    // p5._validateParameters('createA', arguments);\n    const elt = document.createElement('a');\n    elt.href = href;\n    elt.innerHTML = html;\n    if (target) elt.target = target;\n    return addElement(elt, this);\n  };\n\n  /* INPUT */\n  /**\n   * Creates a slider `&lt;input&gt;&lt;/input&gt;` element.\n   *\n   * Range sliders are useful for quickly selecting numbers from a given range.\n   *\n   * The first two parameters, `min` and `max`, are numbers that set the\n   * slider's minimum and maximum.\n   *\n   * The third parameter, `value`, is optional. It's a number that sets the\n   * slider's default value.\n   *\n   * The fourth parameter, `step`, is also optional. It's a number that sets the\n   * spacing between each value in the slider's range. Setting `step` to 0\n   * allows the slider to move smoothly from `min` to `max`.\n   *\n   * @method createSlider\n   * @param  {Number} min minimum value of the slider.\n   * @param  {Number} max maximum value of the slider.\n   * @param  {Number} [value] default value of the slider.\n   * @param  {Number} [step] size for each step in the slider's range.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let slider;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a slider and place it at the top of the canvas.\n   *   slider = createSlider(0, 255);\n   *   slider.position(10, 10);\n   *   slider.size(80);\n   *\n   *   describe('A dark gray square with a range slider at the top. The square changes color when the slider is moved.');\n   * }\n   *\n   * function draw() {\n   *   // Use the slider as a grayscale value.\n   *   let g = slider.value();\n   *   background(g);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let slider;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a slider and place it at the top of the canvas.\n   *   // Set its default value to 0.\n   *   slider = createSlider(0, 255, 0);\n   *   slider.position(10, 10);\n   *   slider.size(80);\n   *\n   *   describe('A black square with a range slider at the top. The square changes color when the slider is moved.');\n   * }\n   *\n   * function draw() {\n   *   // Use the slider as a grayscale value.\n   *   let g = slider.value();\n   *   background(g);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let slider;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a slider and place it at the top of the canvas.\n   *   // Set its default value to 0.\n   *   // Set its step size to 50.\n   *   slider = createSlider(0, 255, 0, 50);\n   *   slider.position(10, 10);\n   *   slider.size(80);\n   *\n   *   describe('A black square with a range slider at the top. The square changes color when the slider is moved.');\n   * }\n   *\n   * function draw() {\n   *   // Use the slider as a grayscale value.\n   *   let g = slider.value();\n   *   background(g);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let slider;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a slider and place it at the top of the canvas.\n   *   // Set its default value to 0.\n   *   // Set its step size to 0 so that it moves smoothly.\n   *   slider = createSlider(0, 255, 0, 0);\n   *   slider.position(10, 10);\n   *   slider.size(80);\n   *\n   *   describe('A black square with a range slider at the top. The square changes color when the slider is moved.');\n   * }\n   *\n   * function draw() {\n   *   // Use the slider as a grayscale value.\n   *   let g = slider.value();\n   *   background(g);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createSlider = function (min, max, value, step) {\n    // p5._validateParameters('createSlider', arguments);\n    const elt = document.createElement('input');\n    elt.type = 'range';\n    elt.min = min;\n    elt.max = max;\n    if (step === 0) {\n      elt.step = 0.000000000000000001; // smallest valid step\n    } else if (step) {\n      elt.step = step;\n    }\n    if (typeof value === 'number') elt.value = value;\n    return addElement(elt, this);\n  };\n\n  /**\n   * Creates a `&lt;button&gt;&lt;/button&gt;` element.\n   *\n   * The first parameter, `label`, is a string that sets the label displayed on\n   * the button.\n   *\n   * The second parameter, `value`, is optional. It's a string that sets the\n   * button's value. See\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button#value\" target=\"_blank\">MDN</a>\n   * for more details.\n   *\n   * @method createButton\n   * @param  {String} label label displayed on the button.\n   * @param  {String} [value] value of the button.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a button and place it beneath the canvas.\n   *   let button = createButton('click me');\n   *   button.position(0, 100);\n   *\n   *   // Call repaint() when the button is pressed.\n   *   button.mousePressed(repaint);\n   *\n   *   describe('A gray square with a button that says \"click me\" beneath it. The square changes color when the button is clicked.');\n   * }\n   *\n   * // Change the background color.\n   * function repaint() {\n   *   let g = random(255);\n   *   background(g);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let button;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a button and set its value to 0.\n   *   // Place the button beneath the canvas.\n   *   button = createButton('click me', 'red');\n   *   button.position(0, 100);\n   *\n   *   // Call randomColor() when the button is pressed.\n   *   button.mousePressed(randomColor);\n   *\n   *   describe('A red square with a button that says \"click me\" beneath it. The square changes color when the button is clicked.');\n   * }\n   *\n   * function draw() {\n   *   // Use the button's value to set the background color.\n   *   let c = button.value();\n   *   background(c);\n   * }\n   *\n   * // Set the button's value to a random color.\n   * function randomColor() {\n   *   let c = random(['red', 'green', 'blue', 'yellow']);\n   *   button.value(c);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createButton = function (label, value) {\n    // p5._validateParameters('createButton', arguments);\n    const elt = document.createElement('button');\n    elt.innerHTML = label;\n    if (value) elt.value = value;\n    return addElement(elt, this);\n  };\n\n  /**\n   * Creates a checkbox `&lt;input&gt;&lt;/input&gt;` element.\n   *\n   * Checkboxes extend the <a href=\"#/p5.Element\">p5.Element</a> class with a\n   * `checked()` method. Calling `myBox.checked()` returns `true` if it the box\n   * is checked and `false` if not.\n   *\n   * The first parameter, `label`, is optional. It's a string that sets the label\n   * to display next to the checkbox.\n   *\n   * The second parameter, `value`, is also optional. It's a boolean that sets the\n   * checkbox's value.\n   *\n   * @method createCheckbox\n   * @param  {String} [label] label displayed after the checkbox.\n   * @param  {Boolean} [value] value of the checkbox. Checked is `true` and unchecked is `false`.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let checkbox;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a checkbox and place it beneath the canvas.\n   *   checkbox = createCheckbox();\n   *   checkbox.position(0, 70);\n   *\n   *   describe('A black square with a checkbox beneath it. The square turns white when the box is checked.');\n   * }\n   *\n   * function draw() {\n   *   // Use the checkbox to set the background color.\n   *   if (checkbox.checked()) {\n   *     background(255);\n   *   } else {\n   *     background(0);\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let checkbox;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a checkbox and place it beneath the canvas.\n   *   // Label the checkbox \"white\".\n   *   checkbox = createCheckbox(' white');\n   *   checkbox.position(0, 70);\n   *\n   *   describe('A black square with a checkbox labeled \"white\" beneath it. The square turns white when the box is checked.');\n   * }\n   *\n   * function draw() {\n   *   // Use the checkbox to set the background color.\n   *   if (checkbox.checked()) {\n   *     background(255);\n   *   } else {\n   *     background(0);\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let checkbox;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a checkbox and place it beneath the canvas.\n   *   // Label the checkbox \"white\" and set its value to true.\n   *   checkbox = createCheckbox(' white', true);\n   *   checkbox.position(0, 70);\n   *\n   *   describe('A white square with a checkbox labeled \"white\" beneath it. The square turns black when the box is unchecked.');\n   * }\n   *\n   * function draw() {\n   *   // Use the checkbox to set the background color.\n   *   if (checkbox.checked()) {\n   *     background(255);\n   *   } else {\n   *     background(0);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createCheckbox = function (...args) {\n    // p5._validateParameters('createCheckbox', args);\n\n    // Create a container element\n    const elt = document.createElement('div');\n\n    // Create checkbox type input element\n    const checkbox = document.createElement('input');\n    checkbox.type = 'checkbox';\n\n    // Create label element and wrap it around checkbox\n    const label = document.createElement('label');\n    label.appendChild(checkbox);\n\n    // Append label element inside the container\n    elt.appendChild(label);\n\n    //checkbox must be wrapped in p5.Element before label so that label appears after\n    const self = addElement(elt, this);\n\n    self.checked = function (...args) {\n      const cb = self.elt.firstElementChild.getElementsByTagName('input')[0];\n      if (cb) {\n        if (args.length === 0) {\n          return cb.checked;\n        } else if (args[0]) {\n          cb.checked = true;\n        } else {\n          cb.checked = false;\n        }\n      }\n      return self;\n    };\n\n    this.value = function (val) {\n      self.value = val;\n      return this;\n    };\n\n    // Set the span element innerHTML as the label value if passed\n    if (args[0]) {\n      self.value(args[0]);\n      const span = document.createElement('span');\n      span.innerHTML = args[0];\n      label.appendChild(span);\n    }\n\n    // Set the checked value of checkbox if passed\n    if (args[1]) {\n      checkbox.checked = true;\n    }\n\n    return self;\n  };\n\n  /**\n   * Creates a dropdown menu `&lt;select&gt;&lt;/select&gt;` element.\n   *\n   * The parameter is optional. If `true` is passed, as in\n   * `let mySelect = createSelect(true)`, then the dropdown will support\n   * multiple selections. If an existing `&lt;select&gt;&lt;/select&gt;` element\n   * is passed, as in `let mySelect = createSelect(otherSelect)`, the existing\n   * element will be wrapped in a new <a href=\"#/p5.Element\">p5.Element</a>\n   * object.\n   *\n   * Dropdowns extend the <a href=\"#/p5.Element\">p5.Element</a> class with a few\n   * helpful methods for managing options:\n   * - `mySelect.option(name, [value])` adds an option to the menu. The first paremeter, `name`, is a string that sets the option's name and value. The second parameter, `value`, is optional. If provided, it sets the value that corresponds to the key `name`. If an option with `name` already exists, its value is changed to `value`.\n   * - `mySelect.value()` returns the currently-selected option's value.\n   * - `mySelect.selected()` returns the currently-selected option.\n   * - `mySelect.selected(option)` selects the given option by default.\n   * - `mySelect.disable()` marks the whole dropdown element as disabled.\n   * - `mySelect.disable(option)` marks a given option as disabled.\n   * - `mySelect.enable()` marks the whole dropdown element as enabled.\n   * - `mySelect.enable(option)` marks a given option as enabled.\n   *\n   * @method createSelect\n   * @param {Boolean} [multiple] support multiple selections.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let mySelect;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a dropdown and place it beneath the canvas.\n   *   mySelect = createSelect();\n   *   mySelect.position(0, 100);\n   *\n   *   // Add color options.\n   *   mySelect.option('red');\n   *   mySelect.option('green');\n   *   mySelect.option('blue');\n   *   mySelect.option('yellow');\n   *\n   *   // Set the selected option to \"red\".\n   *   mySelect.selected('red');\n   *\n   *   describe('A red square with a dropdown menu beneath it. The square changes color when a new color is selected.');\n   * }\n   *\n   * function draw() {\n   *   // Use the selected value to paint the background.\n   *   let c = mySelect.selected();\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let mySelect;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a dropdown and place it beneath the canvas.\n   *   mySelect = createSelect();\n   *   mySelect.position(0, 100);\n   *\n   *   // Add color options.\n   *   mySelect.option('red');\n   *   mySelect.option('green');\n   *   mySelect.option('blue');\n   *   mySelect.option('yellow');\n   *\n   *   // Set the selected option to \"red\".\n   *   mySelect.selected('red');\n   *\n   *   // Disable the \"yellow\" option.\n   *   mySelect.disable('yellow');\n   *\n   *   describe('A red square with a dropdown menu beneath it. The square changes color when a new color is selected.');\n   * }\n   *\n   * function draw() {\n   *   // Use the selected value to paint the background.\n   *   let c = mySelect.selected();\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let mySelect;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a dropdown and place it beneath the canvas.\n   *   mySelect = createSelect();\n   *   mySelect.position(0, 100);\n   *\n   *   // Add color options with names and values.\n   *   mySelect.option('one', 'red');\n   *   mySelect.option('two', 'green');\n   *   mySelect.option('three', 'blue');\n   *   mySelect.option('four', 'yellow');\n   *\n   *   // Set the selected option to \"one\".\n   *   mySelect.selected('one');\n   *\n   *   describe('A red square with a dropdown menu beneath it. The square changes color when a new color is selected.');\n   * }\n   *\n   * function draw() {\n   *   // Use the selected value to paint the background.\n   *   let c = mySelect.selected();\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Hold CTRL to select multiple options on Windows and Linux.\n   * // Hold CMD to select multiple options on macOS.\n   * let mySelect;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a dropdown and allow multiple selections.\n   *   // Place it beneath the canvas.\n   *   mySelect = createSelect(true);\n   *   mySelect.position(0, 100);\n   *\n   *   // Add color options.\n   *   mySelect.option('red');\n   *   mySelect.option('green');\n   *   mySelect.option('blue');\n   *   mySelect.option('yellow');\n   *\n   *   describe('A gray square with a dropdown menu beneath it. Colorful circles appear when their color is selected.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Use the selected value(s) to draw circles.\n   *   let colors = mySelect.selected();\n   *   for (let i = 0; i < colors.length; i += 1) {\n   *     // Calculate the x-coordinate.\n   *     let x = 10 + i * 20;\n   *\n   *     // Access the color.\n   *     let c = colors[i];\n   *\n   *     // Draw the circle.\n   *     fill(c);\n   *     circle(x, 50, 20);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method createSelect\n   * @param {Object} existing select element to wrap, either as a <a href=\"#/p5.Element\">p5.Element</a> or\n   *                          a <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLSelectElement\" target=\"_blank\">HTMLSelectElement</a>.\n   * @return {p5.Element}\n   */\n\n  fn.createSelect = function (...args) {\n    // p5._validateParameters('createSelect', args);\n    let self;\n    let arg = args[0];\n    if (arg instanceof Element && arg.elt instanceof HTMLSelectElement) {\n      // If given argument is p5.Element of select type\n      self = arg;\n      this.elt = arg.elt;\n    } else if (arg instanceof HTMLSelectElement) {\n      self = addElement(arg, this);\n      this.elt = arg;\n    } else {\n      const elt = document.createElement('select');\n      if (arg && typeof arg === 'boolean') {\n        elt.setAttribute('multiple', 'true');\n      }\n      self = addElement(elt, this);\n      this.elt = elt;\n    }\n    self.option = function (name, value) {\n      let index;\n\n      // if no name is passed, return\n      if (name === undefined) {\n        return;\n      }\n      //see if there is already an option with this name\n      for (let i = 0; i < this.elt.length; i += 1) {\n        if (this.elt[i].textContent === name) {\n          index = i;\n          break;\n        }\n      }\n      //if there is an option with this name we will modify it\n      if (index !== undefined) {\n        //if the user passed in false then delete that option\n        if (value === false) {\n          this.elt.remove(index);\n        } else {\n          // Update the option at index with the value\n          this.elt[index].value = value;\n        }\n      } else {\n        //if it doesn't exist create it\n        const opt = document.createElement('option');\n        opt.textContent = name;\n        opt.value = value === undefined ? name : value;\n        this.elt.appendChild(opt);\n        this._pInst._elements.push(opt);\n      }\n    };\n\n    self.selected = function (value) {\n      // Update selected status of option\n      if (value !== undefined) {\n        for (let i = 0; i < this.elt.length; i += 1) {\n          if (this.elt[i].value.toString() === value.toString()) {\n            this.elt.selectedIndex = i;\n          }\n        }\n        return this;\n      } else {\n        if (this.elt.getAttribute('multiple')) {\n          let arr = [];\n          for (const selectedOption of this.elt.selectedOptions) {\n            arr.push(selectedOption.value);\n          }\n          return arr;\n        } else {\n          return this.elt.value;\n        }\n      }\n    };\n\n    self.disable = function (value) {\n      if (typeof value === 'string') {\n        for (let i = 0; i < this.elt.length; i++) {\n          if (this.elt[i].value.toString() === value) {\n            this.elt[i].disabled = true;\n            this.elt[i].selected = false;\n          }\n        }\n      } else {\n        this.elt.disabled = true;\n      }\n      return this;\n    };\n\n    self.enable = function (value) {\n      if (typeof value === 'string') {\n        for (let i = 0; i < this.elt.length; i++) {\n          if (this.elt[i].value.toString() === value) {\n            this.elt[i].disabled = false;\n            this.elt[i].selected = false;\n          }\n        }\n      } else {\n        this.elt.disabled = false;\n        for (let i = 0; i < this.elt.length; i++) {\n          this.elt[i].disabled = false;\n          this.elt[i].selected = false;\n        }\n      }\n      return this;\n    };\n\n    return self;\n  };\n\n  /**\n   * Creates a radio button element.\n   *\n   * The parameter is optional. If a string is passed, as in\n   * `let myRadio = createSelect('food')`, then each radio option will\n   * have `\"food\"` as its `name` parameter: `&lt;input name=\"food\"&gt;&lt;/input&gt;`.\n   * If an existing `&lt;div&gt;&lt;/div&gt;` or `&lt;span&gt;&lt;/span&gt;`\n   * element is passed, as in `let myRadio = createSelect(container)`, it will\n   * become the radio button's parent element.\n   *\n   * Radio buttons extend the <a href=\"#/p5.Element\">p5.Element</a> class with a few\n   * helpful methods for managing options:\n   * - `myRadio.option(value, [label])` adds an option to the menu. The first paremeter, `value`, is a string that sets the option's value and label. The second parameter, `label`, is optional. If provided, it sets the label displayed for the `value`. If an option with `value` already exists, its label is changed and its value is returned.\n   * - `myRadio.value()` returns the currently-selected option's value.\n   * - `myRadio.selected()` returns the currently-selected option.\n   * - `myRadio.selected(value)` selects the given option and returns it as an <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement\" target=\"_blank\">`HTMLInputElement`</a>.\n   * - `myRadio.disable(shouldDisable)` enables the entire radio button if `true` is passed and disables it if `false` is passed.\n   *\n   * @method createRadio\n   * @param  {Object} [containerElement] container HTML Element, either a `&lt;div&gt;&lt;/div&gt;`\n   * or `&lt;span&gt;&lt;/span&gt;`.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let style = document.createElement('style');\n   * style.innerHTML = `\n   * .p5-radio label {\n   *    display: flex;\n   *    align-items: center;\n   *  }\n   *  .p5-radio input {\n   *    margin-right: 5px;\n   *  }\n   *  `;\n   * document.head.appendChild(style);\n   *\n   * let myRadio;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a radio button element and place it\n   *   // in the top-left corner.\n   *   myRadio = createRadio();\n   *   myRadio.position(0, 0);\n   *   myRadio.class('p5-radio');\n   *   myRadio.size(60);\n   *\n   *   // Add a few color options.\n   *   myRadio.option('red');\n   *   myRadio.option('yellow');\n   *   myRadio.option('blue');\n   *\n   *   // Choose a default option.\n   *   myRadio.selected('yellow');\n   *\n   *   describe('A yellow square with three color options listed, \"red\", \"yellow\", and \"blue\". The square changes color when the user selects a new option.');\n   * }\n   *\n   * function draw() {\n   *   // Set the background color using the radio button.\n   *   let g = myRadio.value();\n   *   background(g);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myRadio;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a radio button element and place it\n   *   // in the top-left corner.\n   *   myRadio = createRadio();\n   *   myRadio.position(0, 0);\n   *   myRadio.size(50);\n   *\n   *   // Add a few color options.\n   *   // Color values are labeled with\n   *   // emotions they evoke.\n   *   myRadio.option('red', 'love');\n   *   myRadio.option('yellow', 'joy');\n   *   myRadio.option('blue', 'trust');\n   *\n   *   // Choose a default option.\n   *   myRadio.selected('yellow');\n   *\n   *   describe('A yellow square with three options listed, \"love\", \"joy\", and \"trust\". The square changes color when the user selects a new option.');\n   * }\n   *\n   * function draw() {\n   *   // Set the background color using the radio button.\n   *   let c = myRadio.value();\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myRadio;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a radio button element and place it\n   *   // in the top-left corner.\n   *   myRadio = createRadio();\n   *   myRadio.position(0, 0);\n   *   myRadio.size(50);\n   *\n   *   // Add a few color options.\n   *   myRadio.option('red');\n   *   myRadio.option('yellow');\n   *   myRadio.option('blue');\n   *\n   *   // Choose a default option.\n   *   myRadio.selected('yellow');\n   *\n   *   // Create a button and place it beneath the canvas.\n   *   let btn = createButton('disable');\n   *   btn.position(0, 100);\n   *\n   *   // Call disableRadio() when btn is pressed.\n   *   btn.mousePressed(disableRadio);\n   *\n   *   describe('A yellow square with three options listed, \"red\", \"yellow\", and \"blue\". The square changes color when the user selects a new option. A \"disable\" button beneath the canvas disables the color options when pressed.');\n   * }\n   *\n   * function draw() {\n   *   // Set the background color using the radio button.\n   *   let c = myRadio.value();\n   *   background(c);\n   * }\n   *\n   * // Disable myRadio.\n   * function disableRadio() {\n   *   myRadio.disable(true);\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method createRadio\n   * @param {String} [name] name parameter assigned to each option's `&lt;input&gt;&lt;/input&gt;` element.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   */\n  /**\n   * @method createRadio\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   */\n  //counter for unique names on radio button\n  let counter = 0;\n  fn.createRadio = function (...args) {\n    // Creates a div, adds each option as an individual input inside it.\n    // If already given with a containerEl, will search for all input[radio]\n    // it, create a p5.Element out of it, add options to it and return the p5.Element.\n\n    let self;\n    let radioElement;\n    let name;\n    const arg0 = args[0];\n    if (\n      arg0 instanceof Element &&\n      (arg0.elt instanceof HTMLDivElement || arg0.elt instanceof HTMLSpanElement)\n    ) {\n      // If given argument is p5.Element of div/span type\n      self = arg0;\n      this.elt = arg0.elt;\n    } else if (\n      // If existing radio Element is provided as argument 0\n      arg0 instanceof HTMLDivElement ||\n      arg0 instanceof HTMLSpanElement\n    ) {\n      self = addElement(arg0, this);\n      this.elt = arg0;\n      radioElement = arg0;\n      if (typeof args[1] === 'string') name = args[1];\n    } else {\n      if (typeof arg0 === 'string') name = arg0;\n      radioElement = document.createElement('div');\n      self = addElement(radioElement, this);\n      this.elt = radioElement;\n    }\n    self._name = name || `radioOption_${counter++}`;\n\n    // setup member functions\n    const isRadioInput = el =>\n      el instanceof HTMLInputElement && el.type === 'radio';\n    const isLabelElement = el => el instanceof HTMLLabelElement;\n    const isSpanElement = el => el instanceof HTMLSpanElement;\n\n    self._getOptionsArray = function () {\n      return Array.from(this.elt.children)\n        .filter(\n          el =>\n            isRadioInput(el) ||\n            (isLabelElement(el) && isRadioInput(el.firstElementChild))\n        )\n        .map(el => (isRadioInput(el) ? el : el.firstElementChild));\n    };\n\n    self.option = function (value, label) {\n      // return an option with this value, create if not exists.\n      let optionEl;\n      for (const option of self._getOptionsArray()) {\n        if (option.value === value) {\n          optionEl = option;\n          break;\n        }\n      }\n\n      // Create a new option, add it to radioElement and return it.\n      if (optionEl === undefined) {\n        optionEl = document.createElement('input');\n        optionEl.setAttribute('type', 'radio');\n        optionEl.setAttribute('value', value);\n      }\n      optionEl.setAttribute('name', self._name);\n\n      // Check if label element exists, else create it\n      let labelElement;\n      if (!isLabelElement(optionEl.parentElement)) {\n        labelElement = document.createElement('label');\n        labelElement.insertAdjacentElement('afterbegin', optionEl);\n      } else {\n        labelElement = optionEl.parentElement;\n      }\n\n      // Check if span element exists, else create it\n      let spanElement;\n      if (!isSpanElement(labelElement.lastElementChild)) {\n        spanElement = document.createElement('span');\n        optionEl.insertAdjacentElement('afterend', spanElement);\n      } else {\n        spanElement = labelElement.lastElementChild;\n      }\n\n      // Set the innerHTML of span element as the label text\n      spanElement.innerHTML = label === undefined ? value : label;\n\n      // Append the label element, which includes option element and\n      // span element to the radio container element\n      this.elt.appendChild(labelElement);\n\n      return optionEl;\n    };\n\n    self.remove = function (value) {\n      for (const optionEl of self._getOptionsArray()) {\n        if (optionEl.value === value) {\n          if (isLabelElement(optionEl.parentElement)) {\n            // Remove parent label which also removes children elements\n            optionEl.parentElement.remove();\n          } else {\n            // Remove the option input if parent label does not exist\n            optionEl.remove();\n          }\n          return;\n        }\n      }\n    };\n\n    self.value = function () {\n      let result = '';\n      for (const option of self._getOptionsArray()) {\n        if (option.checked) {\n          result = option.value;\n          break;\n        }\n      }\n      return result;\n    };\n\n    self.selected = function (value) {\n      let result = null;\n      if (value === undefined) {\n        for (const option of self._getOptionsArray()) {\n          if (option.checked) {\n            result = option;\n            break;\n          }\n        }\n      } else {\n        // forEach loop to uncheck all radio buttons before\n        // setting any one as checked.\n        self._getOptionsArray().forEach(option => {\n          option.checked = false;\n          option.removeAttribute('checked');\n        });\n\n        for (const option of self._getOptionsArray()) {\n          if (option.value === value) {\n            option.setAttribute('checked', true);\n            option.checked = true;\n            result = option;\n          }\n        }\n      }\n      return result;\n    };\n\n    self.disable = function (shouldDisable = true) {\n      for (const radioInput of self._getOptionsArray()) {\n        radioInput.setAttribute('disabled', shouldDisable);\n      }\n    };\n\n    return self;\n  };\n\n  /**\n   * Creates a color picker element.\n   *\n   * The parameter, `value`, is optional. If a color string or\n   * <a href=\"#/p5.Color\">p5.Color</a> object is passed, it will set the default\n   * color.\n   *\n   * Color pickers extend the <a href=\"#/p5.Element\">p5.Element</a> class with a\n   * couple of helpful methods for managing colors:\n   * - `myPicker.value()` returns the current color as a hex string in the format `'#rrggbb'`.\n   * - `myPicker.color()` returns the current color as a <a href=\"#/p5.Color\">p5.Color</a> object.\n   *\n   * @method createColorPicker\n   * @param {String|p5.Color} [value] default color as a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/color\" target=\"_blank\">CSS color string</a>.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myPicker;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a color picker and set its position.\n   *   myPicker = createColorPicker('deeppink');\n   *   myPicker.position(0, 100);\n   *\n   *   describe('A pink square with a color picker beneath it. The square changes color when the user picks a new color.');\n   * }\n   *\n   * function draw() {\n   *   // Use the color picker to paint the background.\n   *   let c = myPicker.color();\n   *   background(c);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myPicker;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create a color picker and set its position.\n   *   myPicker = createColorPicker('deeppink');\n   *   myPicker.position(0, 100);\n   *\n   *   describe('A number with the format \"#rrggbb\" is displayed on a pink canvas. The background color and number change when the user picks a new color.');\n   * }\n   *\n   * function draw() {\n   *   // Use the color picker to paint the background.\n   *   let c = myPicker.value();\n   *   background(c);\n   *\n   *   // Display the current color as a hex string.\n   *   text(c, 25, 55);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createColorPicker = function (value) {\n    // p5._validateParameters('createColorPicker', arguments);\n    // TODO: This implementation needs to be rechecked or reimplemented\n    // The way it worked with color is a bit too complex\n    const elt = document.createElement('input');\n    let self;\n    elt.type = 'color';\n    if (value) {\n      if (value instanceof p5.Color) {\n        elt.value = value.toString('#rrggbb');\n      } else {\n        this.push();\n        this.colorMode('rgb');\n        elt.value = this.color(value).toString('#rrggbb');\n        this.pop();\n      }\n    } else {\n      elt.value = '#000000';\n    }\n    self = addElement(elt, this);\n    // Method to return a p5.Color object for the given color.\n    const inst = this;\n    self.color = function () {\n      inst.push();\n      if (value) {\n        if (value.mode) {\n          inst.colorMode(value.mode, ...(value?.maxes ? value.maxes[value.mode] || [] : []));\n        }\n      }\n      const c = inst.color(this.elt.value);\n      inst.pop();\n      return c;\n    };\n    return self;\n  };\n\n  /**\n   * Creates a text `&lt;input&gt;&lt;/input&gt;` element.\n   *\n   * Call `myInput.size()` to set the length of the text box.\n   *\n   * The first parameter, `value`, is optional. It's a string that sets the\n   * input's default value. The input is blank by default.\n   *\n   * The second parameter, `type`, is also optional. It's a string that\n   * specifies the type of text being input. See MDN for a full\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Input\" target=\"_blank\">list of options</a>.\n   * The default is `'text'`.\n   *\n   * @method createInput\n   * @param {String} [value] default value of the input box. Defaults to an empty string `''`.\n   * @param {String} [type] type of input. Defaults to `'text'`.\n   * @return {p5.Element} new <a href=\"#/p5.Element\">p5.Element</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let myInput;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create an input element and place it\n   *   // beneath the canvas.\n   *   myInput = createInput();\n   *   myInput.position(0, 100);\n   *\n   *   describe('A gray square with a text box beneath it. The text in the square changes when the user types something new in the input bar.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Use the input to display a message.\n   *   let msg = myInput.value();\n   *   text(msg, 25, 55);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let myInput;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create an input element and place it\n   *   // beneath the canvas. Set its default\n   *   // text to \"hello!\".\n   *   myInput = createInput('hello!');\n   *   myInput.position(0, 100);\n   *\n   *   describe('The text \"hello!\" written at the center of a gray square. A text box beneath the square also says \"hello!\". The text in the square changes when the user types something new in the input bar.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Use the input to display a message.\n   *   let msg = myInput.value();\n   *   text(msg, 25, 55);\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method createInput\n   * @param {String} [value]\n   * @return {p5.Element}\n   */\n  fn.createInput = function (value = '', type = 'text') {\n    // p5._validateParameters('createInput', arguments);\n    let elt = document.createElement('input');\n    elt.setAttribute('value', value);\n    elt.setAttribute('type', type);\n    return addElement(elt, this);\n  };\n\n  /**\n   * Creates an `&lt;input&gt;&lt;/input&gt;` element of type `'file'`.\n   *\n   * `createFileInput()` allows users to select local files for use in a sketch.\n   * It returns a <a href=\"#/p5.File\">p5.File</a> object.\n   *\n   * The first parameter, `callback`, is a function that's called when the file\n   * loads. The callback function should have one parameter, `file`, that's a\n   * <a href=\"#/p5.File\">p5.File</a> object.\n   *\n   * The second parameter, `multiple`, is optional. It's a boolean value that\n   * allows loading multiple files if set to `true`. If `true`, `callback`\n   * will be called once per file.\n   *\n   * @method createFileInput\n   * @param  {Function} callback function to call once the file loads.\n   * @param  {Boolean} [multiple] allow multiple files to be selected.\n   * @return {p5.File} new <a href=\"#/p5.File\">p5.File</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Use the file input to select an image to\n   * // load and display.\n   * let input;\n   * let img;\n   *\n   * function setup() {\n   *   createCanvas(200, 200);\n   *\n   *   // Create a file input and place it beneath\n   *   // the canvas.\n   *   input = createFileInput(handleImage);\n   *   input.position(0, 100);\n   *\n   *   describe('A gray square with a file input beneath it. If the user selects an image file to load, it is displayed on the square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the image if loaded.\n   *   if (img) {\n   *     image(img, 0, 0, width, height);\n   *   }\n   * }\n   *\n   * // Create an image if the file is an image.\n   * function handleImage(file) {\n   *   if (file.type === 'image') {\n   *     img = createImg(file.data, '');\n   *     img.hide();\n   *   } else {\n   *     img = null;\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Use the file input to select multiple images\n   * // to load and display.\n   * let input;\n   * let images = [];\n   *\n   * function setup() {\n   *   // Create a file input and place it beneath\n   *   // the canvas. Allow it to load multiple files.\n   *   input = createFileInput(handleImage, true);\n   *   input.position(0, 100);\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the images if loaded. Each image\n   *   // is drawn 20 pixels lower than the\n   *   // previous image.\n   *   for (let i = 0; i < images.length; i += 1) {\n   *     // Calculate the y-coordinate.\n   *     let y = i * 20;\n   *\n   *     // Draw the image.\n   *     image(images[i], 0, y, 100, 100);\n   *   }\n   *\n   *   describe('A gray square with a file input beneath it. If the user selects multiple image files to load, they are displayed on the square.');\n   * }\n   *\n   * // Create an image if the file is an image,\n   * // then add it to the images array.\n   * function handleImage(file) {\n   *   if (file.type === 'image') {\n   *     let img = createImg(file.data, '');\n   *     img.hide();\n   *     images.push(img);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createFileInput = function (callback, multiple = false) {\n    // p5._validateParameters('createFileInput', arguments);\n\n    const handleFileSelect = function (event) {\n      for (const file of event.target.files) {\n        File._load(file, callback);\n      }\n    };\n\n    // If File API's are not supported, throw Error\n    if (!(window.File && window.FileReader && window.FileList && window.Blob)) {\n      console.log(\n        'The File APIs are not fully supported in this browser. Cannot create element.'\n      );\n      return;\n    }\n\n    const fileInput = document.createElement('input');\n    fileInput.setAttribute('type', 'file');\n    if (multiple) fileInput.setAttribute('multiple', true);\n    fileInput.addEventListener('change', handleFileSelect, false);\n    return addElement(fileInput, this);\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  dom(p5, p5.prototype);\n}\n\nexport { dom as default };\n","/**\n * @module Events\n * @submodule Acceleration\n * @for p5\n * @requires core\n * @main Events\n */\n\nfunction acceleration(p5, fn){\n  /**\n   * The system variable deviceOrientation always contains the orientation of\n   * the device. The value of this variable will either be set 'landscape'\n   * or 'portrait'. If no data is available it will be set to 'undefined'.\n   * either LANDSCAPE or PORTRAIT.\n   *\n   * @property {(LANDSCAPE|PORTRAIT)} deviceOrientation\n   * @readOnly\n   */\n  fn.deviceOrientation =\n    window.innerWidth / window.innerHeight > 1.0 ? 'landscape' : 'portrait';\n\n  /**\n   * The system variable accelerationX always contains the acceleration of the\n   * device along the x axis. Value is represented as meters per second squared.\n   *\n   * @property {Number} accelerationX\n   * @readOnly\n   * @example\n   * <div>\n   * <code>\n   * // Move a touchscreen device to register\n   * // acceleration changes.\n   * function draw() {\n   *   background(220, 50);\n   *   fill('magenta');\n   *   ellipse(width / 2, height / 2, accelerationX);\n   *   describe('Magnitude of device acceleration is displayed as ellipse size.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.accelerationX = 0;\n\n  /**\n   * The system variable accelerationY always contains the acceleration of the\n   * device along the y axis. Value is represented as meters per second squared.\n   *\n   * @property {Number} accelerationY\n   * @readOnly\n   * @example\n   * <div>\n   * <code>\n   * // Move a touchscreen device to register\n   * // acceleration changes.\n   * function draw() {\n   *   background(220, 50);\n   *   fill('magenta');\n   *   ellipse(width / 2, height / 2, accelerationY);\n   *   describe('Magnitude of device acceleration is displayed as ellipse size');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.accelerationY = 0;\n\n  /**\n   * The system variable accelerationZ always contains the acceleration of the\n   * device along the z axis. Value is represented as meters per second squared.\n   *\n   * @property {Number} accelerationZ\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Move a touchscreen device to register\n   * // acceleration changes.\n   * function draw() {\n   *   background(220, 50);\n   *   fill('magenta');\n   *   ellipse(width / 2, height / 2, accelerationZ);\n   *   describe('Magnitude of device acceleration is displayed as ellipse size');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.accelerationZ = 0;\n\n  /**\n   * The system variable pAccelerationX always contains the acceleration of the\n   * device along the x axis in the frame previous to the current frame. Value\n   * is represented as meters per second squared.\n   *\n   * @property {Number} pAccelerationX\n   * @readOnly\n   */\n  fn.pAccelerationX = 0;\n\n  /**\n   * The system variable pAccelerationY always contains the acceleration of the\n   * device along the y axis in the frame previous to the current frame. Value\n   * is represented as meters per second squared.\n   *\n   * @property {Number} pAccelerationY\n   * @readOnly\n   */\n  fn.pAccelerationY = 0;\n\n  /**\n   * The system variable pAccelerationZ always contains the acceleration of the\n   * device along the z axis in the frame previous to the current frame. Value\n   * is represented as meters per second squared.\n   *\n   * @property {Number} pAccelerationZ\n   * @readOnly\n   */\n  fn.pAccelerationZ = 0;\n\n  /**\n   * _updatePAccelerations updates the pAcceleration values\n   *\n   * @private\n   */\n  fn._updatePAccelerations = function () {\n    this.pAccelerationX = this.accelerationX;\n    this.pAccelerationY = this.accelerationY;\n    this.pAccelerationZ = this.accelerationZ;\n  };\n\n  /**\n   * The system variable rotationX always contains the rotation of the\n   * device along the x axis. If the sketch <a href=\"#/p5/angleMode\">\n   * angleMode()</a> is set to DEGREES, the value will be -180 to 180. If\n   * it is set to RADIANS, the value will be -PI to PI.\n   *\n   * Note: The order the rotations are called is important, ie. if used\n   * together, it must be called in the order Z-X-Y or there might be\n   * unexpected behaviour.\n   *\n   * @property {Number} rotationX\n   * @readOnly\n   * @example\n   * <div>\n   * <code>\n   * let rotationX = 0;            // Angle in degrees\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);   // Create 3D canvas\n   * }\n   *\n   * function draw() {\n   *   background(220);                 // Set light gray background\n   *   rotateX(radians(rotationX));     // Rotate around X-axis\n   *   normalMaterial();                // Apply simple shaded material\n   *   box(60);                         // Draw 3D cube (60 units wide)\n   *   rotationX = (rotationX + 2) % 360; // Increment rotation (2 per frame)\n   * }\n   * </code>\n   * </div>\n   */\n  fn.rotationX = 0;\n\n  /**\n   * The system variable rotationY always contains the rotation of the\n   * device along the y axis. If the sketch <a href=\"#/p5/angleMode\">\n   * angleMode()</a> is set to DEGREES, the value will be -90 to 90. If\n   * it is set to RADIANS, the value will be -PI/2 to PI/2.\n   *\n   * Note: The order the rotations are called is important, ie. if used\n   * together, it must be called in the order Z-X-Y or there might be\n   * unexpected behaviour.\n   *\n   * @property {Number} rotationY\n   * @readOnly\n   * @example\n   * <div>\n   * <code>\n   * let rotationY = 0;            // Angle in degrees\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);   // Create 3D canvas\n   * }\n   *\n   * function draw() {\n   *   background(220);                 // Set light gray background\n   *   rotateY(radians(rotationY));     // Rotate around Y-axis (vertical)\n   *   normalMaterial();                // Apply simple shaded material\n   *   box(60);                         // Draw 3D cube (60 units wide)\n   *   rotationY = (rotationY + 2) % 360; // Increment rotation (2 per frame)\n   * }\n   * </code>\n   * </div>\n   */\n  fn.rotationY = 0;\n\n  /**\n   * The system variable rotationZ always contains the rotation of the\n   * device along the z axis. If the sketch <a href=\"#/p5/angleMode\">\n   * angleMode()</a> is set to DEGREES, the value will be 0 to 360. If\n   * it is set to RADIANS, the value will be 0 to 2*PI.\n   *\n   * Unlike rotationX and rotationY, this variable is available for devices\n   * with a built-in compass only.\n   *\n   * Note: The order the rotations are called is important, ie. if used\n   * together, it must be called in the order Z-X-Y or there might be\n   * unexpected behaviour.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let rotationZ = 0;          // Angle in degrees\n   *\n   * function setup() {\n   *   createCanvas(200, 200, WEBGL);   // Create 3D canvas\n   * }\n   *\n   * function draw() {\n   *   background(220);\n   *   rotateZ(radians(rotationZ));     // Rotate around Z-axis\n   *   normalMaterial();                // Apply simple shaded material\n   *   box(60);                         // Draw 3D cube\n   *   rotationZ = (rotationZ + 2) % 360; // Increment rotation angle\n   * }\n   * </code>\n   * </div>\n   *\n   * @property {Number} rotationZ\n   * @readOnly\n   */\n  fn.rotationZ = 0;\n\n  /**\n   * The system variable pRotationX always contains the rotation of the\n   * device along the x axis in the frame previous to the current frame.\n   * If the sketch <a href=\"#/p5/angleMode\"> angleMode()</a> is set to DEGREES,\n   * the value will be -180 to 180. If it is set to RADIANS, the value will\n   * be -PI to PI.\n   *\n   * pRotationX can also be used with rotationX to determine the rotate\n   * direction of the device along the X-axis.\n   * @example\n   * <div class='norender'>\n   * <code>\n   * // A simple if statement looking at whether\n   * // rotationX - pRotationX < 0 is true or not will be\n   * // sufficient for determining the rotate direction\n   * // in most cases.\n   *\n   * // Some extra logic is needed to account for cases where\n   * // the angles wrap around.\n   * let rotateDirection = 'clockwise';\n   *\n   * // Simple range conversion to make things simpler.\n   * // This is not absolutely necessary but the logic\n   * // will be different in that case.\n   *\n   * let rX = rotationX + 180;\n   * let pRX = pRotationX + 180;\n   *\n   * if ((rX - pRX > 0 && rX - pRX < 270) || rX - pRX < -270) {\n   *   rotateDirection = 'clockwise';\n   * } else if (rX - pRX < 0 || rX - pRX > 270) {\n   *   rotateDirection = 'counter-clockwise';\n   * }\n   *\n   * print(rotateDirection);\n   * describe('no image to display.');\n   * </code>\n   * </div>\n   *\n   * @property {Number} pRotationX\n   * @readOnly\n   */\n  fn.pRotationX = 0;\n\n  /**\n   * The system variable pRotationY always contains the rotation of the\n   * device along the y axis in the frame previous to the current frame.\n   * If the sketch <a href=\"#/p5/angleMode\"> angleMode()</a> is set to DEGREES,\n   * the value will be -90 to 90. If it is set to RADIANS, the value will\n   * be -PI/2 to PI/2.\n   *\n   * pRotationY can also be used with rotationY to determine the rotate\n   * direction of the device along the Y-axis.\n   * @example\n   * <div class='norender'>\n   * <code>\n   * // A simple if statement looking at whether\n   * // rotationY - pRotationY < 0 is true or not will be\n   * // sufficient for determining the rotate direction\n   * // in most cases.\n   *\n   * // Some extra logic is needed to account for cases where\n   * // the angles wrap around.\n   * let rotateDirection = 'clockwise';\n   *\n   * // Simple range conversion to make things simpler.\n   * // This is not absolutely necessary but the logic\n   * // will be different in that case.\n   *\n   * let rY = rotationY + 180;\n   * let pRY = pRotationY + 180;\n   *\n   * if ((rY - pRY > 0 && rY - pRY < 270) || rY - pRY < -270) {\n   *   rotateDirection = 'clockwise';\n   * } else if (rY - pRY < 0 || rY - pRY > 270) {\n   *   rotateDirection = 'counter-clockwise';\n   * }\n   * print(rotateDirection);\n   * describe('no image to display.');\n   * </code>\n   * </div>\n   *\n   * @property {Number} pRotationY\n   * @readOnly\n   */\n  fn.pRotationY = 0;\n\n  /**\n   * The system variable pRotationZ always contains the rotation of the\n   * device along the z axis in the frame previous to the current frame.\n   * If the sketch <a href=\"#/p5/angleMode\"> angleMode()</a> is set to DEGREES,\n   * the value will be 0 to 360. If it is set to RADIANS, the value will\n   * be 0 to 2*PI.\n   *\n   * pRotationZ can also be used with rotationZ to determine the rotate\n   * direction of the device along the Z-axis.\n   * @example\n   * <div class='norender'>\n   * <code>\n   * // A simple if statement looking at whether\n   * // rotationZ - pRotationZ < 0 is true or not will be\n   * // sufficient for determining the rotate direction\n   * // in most cases.\n   *\n   * // Some extra logic is needed to account for cases where\n   * // the angles wrap around.\n   * let rotateDirection = 'clockwise';\n   *\n   * if (\n   *   (rotationZ - pRotationZ > 0 && rotationZ - pRotationZ < 270) ||\n   *   rotationZ - pRotationZ < -270\n   * ) {\n   *   rotateDirection = 'clockwise';\n   * } else if (rotationZ - pRotationZ < 0 || rotationZ - pRotationZ > 270) {\n   *   rotateDirection = 'counter-clockwise';\n   * }\n   * print(rotateDirection);\n   * describe('no image to display.');\n   * </code>\n   * </div>\n   *\n   * @property {Number} pRotationZ\n   * @readOnly\n   */\n  fn.pRotationZ = 0;\n\n  let startAngleX = 0;\n  let startAngleY = 0;\n  let startAngleZ = 0;\n\n  let rotateDirectionX = 'clockwise';\n  let rotateDirectionY = 'clockwise';\n  let rotateDirectionZ = 'clockwise';\n\n  fn.pRotateDirectionX = undefined;\n  fn.pRotateDirectionY = undefined;\n  fn.pRotateDirectionZ = undefined;\n\n  fn._updatePRotations = function () {\n    this.pRotationX = this.rotationX;\n    this.pRotationY = this.rotationY;\n    this.pRotationZ = this.rotationZ;\n  };\n\n  /**\n   * When a device is rotated, the axis that triggers the <a href=\"#/p5/deviceTurned\">deviceTurned()</a>\n   * method is stored in the turnAxis variable. The turnAxis variable is only defined within\n   * the scope of deviceTurned().\n   * @property {String} turnAxis\n   * @readOnly\n   * @example\n   * <div>\n   * <code>\n   * // Run this example on a mobile device\n   * // Rotate the device by 90 degrees in the\n   * // X-axis to change the value.\n   *\n   * let value = 0;\n   * function draw() {\n   *   fill(value);\n   *   rect(25, 25, 50, 50);\n   *   describe(`50-by-50 black rect in center of canvas.\n   *     turns white on mobile when device turns`);\n   *   describe(`50-by-50 black rect in center of canvas.\n   *     turns white on mobile when x-axis turns`);\n   * }\n   * function deviceTurned() {\n   *   if (turnAxis === 'X') {\n   *     if (value === 0) {\n   *       value = 255;\n   *     } else if (value === 255) {\n   *       value = 0;\n   *     }\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.turnAxis = undefined;\n\n  let move_threshold = 0.5;\n  let shake_threshold = 30;\n\n  /**\n   * The <a href=\"#/p5/setMoveThreshold\">setMoveThreshold()</a> function is used to set the movement threshold for\n   * the <a href=\"#/p5/deviceMoved\">deviceMoved()</a> function. The default threshold is set to 0.5.\n   *\n   * @method setMoveThreshold\n   * @param {Number} value The threshold value\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * // Run this example on a mobile device\n   * // You will need to move the device incrementally further\n   * // the closer the square's color gets to white in order to change the value.\n   *\n   * let value = 0;\n   * let threshold = 0.5;\n   * function setup() {\n   *   setMoveThreshold(threshold);\n   * }\n   * function draw() {\n   *   fill(value);\n   *   rect(25, 25, 50, 50);\n   *   describe(`50-by-50 black rect in center of canvas.\n   *     turns white on mobile when device moves`);\n   * }\n   * function deviceMoved() {\n   *   value = value + 5;\n   *   threshold = threshold + 0.1;\n   *   if (value > 255) {\n   *     value = 0;\n   *     threshold = 30;\n   *   }\n   *   setMoveThreshold(threshold);\n   * }\n   * </code>\n   * </div>\n   */\n\n  fn.setMoveThreshold = function (val) {\n    // p5._validateParameters('setMoveThreshold', arguments);\n    move_threshold = val;\n  };\n\n  /**\n   * The <a href=\"#/p5/setShakeThreshold\">setShakeThreshold()</a> function is used to set the movement threshold for\n   * the <a href=\"#/p5/deviceShaken\">deviceShaken()</a> function. The default threshold is set to 30.\n   *\n   * @method setShakeThreshold\n   * @param {Number} value The threshold value\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * // Run this example on a mobile device\n   * // You will need to shake the device more firmly\n   * // the closer the box's fill gets to white in order to change the value.\n   *\n   * let value = 0;\n   * let threshold = 30;\n   * function setup() {\n   *   setShakeThreshold(threshold);\n   * }\n   * function draw() {\n   *   fill(value);\n   *   rect(25, 25, 50, 50);\n   *   describe(`50-by-50 black rect in center of canvas.\n   *     turns white on mobile when device is being shaked`);\n   * }\n   * function deviceMoved() {\n   *   value = value + 5;\n   *   threshold = threshold + 5;\n   *   if (value > 255) {\n   *     value = 0;\n   *     threshold = 30;\n   *   }\n   *   setShakeThreshold(threshold);\n   * }\n   * </code>\n   * </div>\n   */\n\n  fn.setShakeThreshold = function (val) {\n    // p5._validateParameters('setShakeThreshold', arguments);\n    shake_threshold = val;\n  };\n\n  /**\n   * The <a href=\"#/p5/deviceMoved\">deviceMoved()</a> function is called when the device is moved by more than\n   * the threshold value along X, Y or Z axis. The default threshold is set to 0.5.\n   * The threshold value can be changed using <a href=\"https://p5js.org/reference/p5/setMoveThreshold\">setMoveThreshold()</a>.\n   *\n   * @method deviceMoved\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * // Run this example on a mobile device\n   * // Move the device around\n   * // to change the value.\n   *\n   * let value = 0;\n   * function draw() {\n   *   fill(value);\n   *   rect(25, 25, 50, 50);\n   *   describe(`50-by-50 black rect in center of canvas.\n   *     turns white on mobile when device moves`);\n   * }\n   * function deviceMoved() {\n   *   value = value + 5;\n   *   if (value > 255) {\n   *     value = 0;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The <a href=\"#/p5/deviceTurned\">deviceTurned()</a> function is called when the device rotates by\n   * more than 90 degrees continuously.\n   *\n   * The axis that triggers the <a href=\"#/p5/deviceTurned\">deviceTurned()</a> method is stored in the turnAxis\n   * variable. The <a href=\"#/p5/deviceTurned\">deviceTurned()</a> method can be locked to trigger on any axis:\n   * X, Y or Z by comparing the turnAxis variable to 'X', 'Y' or 'Z'.\n   *\n   * @method deviceTurned\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * // Run this example on a mobile device\n   * // Rotate the device by 90 degrees\n   * // to change the value.\n   *\n   * let value = 0;\n   * function draw() {\n   *   fill(value);\n   *   rect(25, 25, 50, 50);\n   *   describe(`50-by-50 black rect in center of canvas.\n   *     turns white on mobile when device turns`);\n   * }\n   * function deviceTurned() {\n   *   if (value === 0) {\n   *     value = 255;\n   *   } else if (value === 255) {\n   *     value = 0;\n   *   }\n   * }\n   * </code>\n   * </div>\n   * <div>\n   * <code>\n   * // Run this example on a mobile device\n   * // Rotate the device by 90 degrees in the\n   * // X-axis to change the value.\n   *\n   * let value = 0;\n   * function draw() {\n   *   fill(value);\n   *   rect(25, 25, 50, 50);\n   *   describe(`50-by-50 black rect in center of canvas.\n   *     turns white on mobile when x-axis turns`);\n   * }\n   * function deviceTurned() {\n   *   if (turnAxis === 'X') {\n   *     if (value === 0) {\n   *       value = 255;\n   *     } else if (value === 255) {\n   *       value = 0;\n   *     }\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * The <a href=\"#/p5/deviceShaken\">deviceShaken()</a> function is called when the device total acceleration\n   * changes of accelerationX and accelerationY values is more than\n   * the threshold value. The default threshold is set to 30.\n   * The threshold value can be changed using <a href=\"https://p5js.org/reference/p5/setShakeThreshold\">setShakeThreshold()</a>.\n   *\n   * @method deviceShaken\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * // Run this example on a mobile device\n   * // Shake the device to change the value.\n   *\n   * let value = 0;\n   * function draw() {\n   *   fill(value);\n   *   rect(25, 25, 50, 50);\n   *   describe(`50-by-50 black rect in center of canvas.\n   *     turns white on mobile when device shakes`);\n   * }\n   * function deviceShaken() {\n   *   value = value + 5;\n   *   if (value > 255) {\n   *     value = 0;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n\n  fn._ondeviceorientation = function (e) {\n    this._updatePRotations();\n\n    // Convert from degrees into current angle mode\n    this.rotationX = this._fromDegrees(e.beta);\n    this.rotationY = this._fromDegrees(e.gamma);\n    this.rotationZ = this._fromDegrees(e.alpha);\n    this._handleMotion();\n  };\n  fn._ondevicemotion = function (e) {\n    this._updatePAccelerations();\n    this.accelerationX = e.acceleration.x * 2;\n    this.accelerationY = e.acceleration.y * 2;\n    this.accelerationZ = e.acceleration.z * 2;\n    this._handleMotion();\n  };\n  fn._handleMotion = function () {\n    if (window.orientation === 90 || window.orientation === -90) {\n      this.deviceOrientation = 'landscape';\n    } else if (window.orientation === 0) {\n      this.deviceOrientation = 'portrait';\n    } else if (window.orientation === undefined) {\n      this.deviceOrientation = 'undefined';\n    }\n    const context = this._isGlobal ? window : this;\n    if (typeof context.deviceMoved === 'function') {\n      if (\n        Math.abs(this.accelerationX - this.pAccelerationX) > move_threshold ||\n        Math.abs(this.accelerationY - this.pAccelerationY) > move_threshold ||\n        Math.abs(this.accelerationZ - this.pAccelerationZ) > move_threshold\n      ) {\n        context.deviceMoved();\n      }\n    }\n\n    if (typeof context.deviceTurned === 'function') {\n      // The angles given by rotationX etc is from range [-180 to 180].\n      // The following will convert them to [0 to 360] for ease of calculation\n      // of cases when the angles wrapped around.\n      // _startAngleX will be converted back at the end and updated.\n\n      // Rotations are converted to degrees and all calculations are done in degrees\n      const wRX = this._toDegrees(this.rotationX) + 180;\n      const wPRX = this._toDegrees(this.pRotationX) + 180;\n      let wSAX = startAngleX + 180;\n      if ((wRX - wPRX > 0 && wRX - wPRX < 270) || wRX - wPRX < -270) {\n        rotateDirectionX = 'clockwise';\n      } else if (wRX - wPRX < 0 || wRX - wPRX > 270) {\n        rotateDirectionX = 'counter-clockwise';\n      }\n      if (rotateDirectionX !== this.pRotateDirectionX) {\n        wSAX = wRX;\n      }\n      if (Math.abs(wRX - wSAX) > 90 && Math.abs(wRX - wSAX) < 270) {\n        wSAX = wRX;\n        this.turnAxis = 'X';\n        context.deviceTurned();\n      }\n      this.pRotateDirectionX = rotateDirectionX;\n      startAngleX = wSAX - 180;\n\n      // Y-axis is identical to X-axis except for changing some names.\n      const wRY = this._toDegrees(this.rotationY) + 180;\n      const wPRY = this._toDegrees(this.pRotationY) + 180;\n      let wSAY = startAngleY + 180;\n      if ((wRY - wPRY > 0 && wRY - wPRY < 270) || wRY - wPRY < -270) {\n        rotateDirectionY = 'clockwise';\n      } else if (wRY - wPRY < 0 || wRY - this.pRotationY > 270) {\n        rotateDirectionY = 'counter-clockwise';\n      }\n      if (rotateDirectionY !== this.pRotateDirectionY) {\n        wSAY = wRY;\n      }\n      if (Math.abs(wRY - wSAY) > 90 && Math.abs(wRY - wSAY) < 270) {\n        wSAY = wRY;\n        this.turnAxis = 'Y';\n        context.deviceTurned();\n      }\n      this.pRotateDirectionY = rotateDirectionY;\n      startAngleY = wSAY - 180;\n\n      // Z-axis is already in the range 0 to 360\n      // so no conversion is needed.\n      const rotZ = this._toDegrees(this.rotationZ);\n      const pRotZ = this._toDegrees(this.pRotationZ);\n      if (\n        (rotZ - pRotZ > 0 && rotZ - pRotZ < 270) ||\n        rotZ - pRotZ < -270\n      ) {\n        rotateDirectionZ = 'clockwise';\n      } else if (\n        rotZ - pRotZ < 0 ||\n        rotZ - pRotZ > 270\n      ) {\n        rotateDirectionZ = 'counter-clockwise';\n      }\n      if (rotateDirectionZ !== this.pRotateDirectionZ) {\n        startAngleZ = rotZ;\n      }\n      if (\n        Math.abs(rotZ - startAngleZ) > 90 &&\n        Math.abs(rotZ - startAngleZ) < 270\n      ) {\n        startAngleZ = rotZ;\n        this.turnAxis = 'Z';\n        context.deviceTurned();\n      }\n      this.pRotateDirectionZ = rotateDirectionZ;\n      this.turnAxis = undefined;\n    }\n    if (typeof context.deviceShaken === 'function') {\n      let accelerationChangeX;\n      let accelerationChangeY;\n      // Add accelerationChangeZ if acceleration change on Z is needed\n      if (this.pAccelerationX !== null) {\n        accelerationChangeX = Math.abs(this.accelerationX - this.pAccelerationX);\n        accelerationChangeY = Math.abs(this.accelerationY - this.pAccelerationY);\n      }\n      if (accelerationChangeX + accelerationChangeY > shake_threshold) {\n        context.deviceShaken();\n      }\n    }\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  acceleration(p5, p5.prototype);\n}\n\nexport { acceleration as default };\n","/**\n * @module Events\n * @submodule Keyboard\n * @for p5\n * @requires core\n */\nfunction isCode(input) {\n  const leftRightKeys = [\n    'Alt',\n    'Shift',\n    'Control',\n    'Meta',\n  ];\n  if (leftRightKeys.includes(input)) {\n    return false;\n  }\n  if (typeof input !== 'string') {\n    return false;\n  }\n  return input.length > 1;\n}\nfunction keyboard(p5, fn){\n  /**\n   * A `Boolean` system variable that's `true` if any key is currently pressed\n   * and `false` if not.\n   *\n   * @property {Boolean} keyIsPressed\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a white square at its center. The white square turns black when the user presses a key.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   if (keyIsPressed === true) {\n   *     fill(0);\n   *   } else {\n   *     fill(255);\n   *   }\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a white square at its center. The white square turns black when the user presses a key.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   if (keyIsPressed) {\n   *     fill(0);\n   *   } else {\n   *     fill(255);\n   *   }\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with the word \"false\" at its center. The word switches to \"true\" when the user presses a key.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the value of keyIsPressed.\n   *   text(keyIsPressed, 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n\n  fn.keyIsPressed = false;\n\n  /**\n   * A `String` system variable that contains the value of the last key typed.\n   *\n   * The key variable is helpful for checking whether an\n   * <a href=\"https://en.wikipedia.org/wiki/ASCII#Printable_characters\" target=\"_blank\">ASCII</a>\n   * key has been typed. For example, the expression `key === \"a\"` evaluates to\n   * `true` if the `a` key was typed and `false` if not. `key` doesnt update\n   * for special keys such as `LEFT_ARROW` and `ENTER`. Use keyCode instead for\n   * special keys. The <a href=\"#/p5/keyIsDown\">keyIsDown()</a> function should\n   * be used to check for multiple different key presses at the same time.\n   *\n   * @property {String} key\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square. The last key pressed is displayed at the center.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the last key pressed.\n   *   text(key, 50, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let x = 50;\n   * let y = 50;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe(\n   *     'A gray square with a black circle at its center. The circle moves when the user presses the keys \"w\", \"a\", \"s\", or \"d\". It leaves a trail as it moves.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   // Update x and y if a key is pressed.\n   *   if (keyIsPressed === true) {\n   *     if (key === 'w') {\n   *       y -= 1;\n   *     } else if (key === 's') {\n   *       y += 1;\n   *     } else if (key === 'a') {\n   *       x -= 1;\n   *     } else if (key === 'd') {\n   *       x += 1;\n   *     }\n   *   }\n   *\n   *   // Style the circle.\n   *   fill(0);\n   *\n   *   // Draw the circle at (x, y).\n   *   circle(x, y, 5);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.key = '';\n\n  /**\n   * The `code` property represents a physical key on the keyboard (as opposed \n   * to the character generated by pressing the key). In other words, this \n   * property returns a value that isn't altered by keyboard layout or the state \n   * of the modifier keys.\n   * \n   * This property is useful when you want to handle keys based on their \n   * physical positions on the input device rather than the characters associated \n   * with those keys;\n   *\n   * Unlike <a href=\"#/p5/key\">key</a>, the `code` property differentiates between \n   * physical keys that generate the same characterfor example, `CtrlLeft` and \n   * `CtrlRight`so each can be handled independently.\n   * Here's the MDN docs for <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/code\" target=\"_blank\">KeyboardEvent.code</a>\n\n   * \n   * Pressing the key physically labeled A always yields `KeyA`, regardless \n   * of the current keyboard layout (QWERTY, Dvorak, AZERTY, etc.) or the character \n   * that appears in a text field.\n   * \n   * The code property returns a plain string (e.g., 'ArrowRight'). You can \n   * compare it directly with string literals:\n   * ```js\n   * if (keyIsDown(RIGHT_ARROW)) {\n   *   // \n   * }\n   * // The line above is equivalent to:\n   * if (code === 'ArrowRight') {\n   *   // \n   * }\n   * if (key  === 'ArrowRight') { \n   * // \n   * }\n   * ```\n   * \n   * The system variables `BACKSPACE`, `DELETE`, `ENTER`, `RETURN`, `TAB`,\n   * `ESCAPE`, `SHIFT`, `CONTROL`, `OPTION`, `ALT`, `UP_ARROW`, `DOWN_ARROW`,\n   * `LEFT_ARROW`, and `RIGHT_ARROW` are all helpful shorthands the key codes of\n   * special keys.\n   * These are simply shorthands for the same string values:\n   * ```js\n   * if (code === RIGHT_ARROW) {\n   * // ..\n   * }\n   * ```\n   * \n   *\n   * <p>The table below summarizes how the main keyboard-related system variables changed between p5.js 1.x and 2.x.</p>\n   * <table>\n   *   <thead>\n   *     <tr>\n   *       <th>Variable</th>\n   *       <th>p5.js 1.x </th>\n   *       <th>p5.js 2.x </th>\n   *     </tr>\n   *   </thead>\n   *   <tbody>\n   *     <tr>\n   *       <td><code>key</code></td>\n   *       <td>Text string (e.g., <code>\"ArrowUp\"</code>).</td>\n   *       <td>Text string (e.g., <code>\"ArrowUp\"</code>, <code>\"f\"</code> or <code>\"F\"</code>).</td>\n   *     </tr>\n   *     <tr>\n   *       <td><code>code</code></td>\n   *       <td><em>Not supported.</em></td>\n   *       <td>Text String (e.g., <code>\"ArrowUp\"</code>, <code>\"KeyF\"</code>).</td>\n   *     </tr>\n   *     <tr>\n   *       <td><code>keyCode</code></td>\n   *       <td>Number (e.g., <code>70</code>).</td>\n   *       <td>Number (unchanged; e.g., <code>70</code>).</td>\n   *     </tr>\n   *     <tr>\n   *       <td>System variables (<code>BACKSPACE</code>, <code>UP_ARROW</code>, )</td>\n   *       <td>Number</td>\n   *       <td>Text String (e.g., <code>\"ArrowUp\"</code>).</td>\n   *     </tr>\n   *   </tbody>\n   * </table>\n   *\n   *\n   * @property {String} code\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square. The last key pressed is displayed at the center.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the last key pressed.\n   *   text(code, 50, 50);\n   * }\n   * </code>\n   * </div>\n   * <div>\n   * <code>\n   * \n   * function setup() {\n   *   createCanvas(100, 100);\n   * }\n   *\n   * function draw() {\n   *   background(220);\n   *   fill(\"black\");\n   *   if (keyIsDown(BACKSPACE) || keyIsDown(ENTER) ||\n   *       keyIsDown(DELETE) || keyIsDown(RETURN) ||\n   *       keyIsDown(TAB) || keyIsDown(ESCAPE) ||\n   *       keyIsDown(CONTROL) || keyIsDown(OPTION) ||\n   *       keyIsDown(UP_ARROW) || keyIsDown(LEFT_ARROW) ||\n   *       keyIsDown(RIGHT_ARROW) || keyIsDown(DOWN_ARROW) ||\n   *       keyIsDown(SHIFT)) {\n   *     fill(\"red\");\n   *     text(\"System Variable\", 7, 75);\n   *   }\n   *\n   *   text(key, 30, 25);\n   *   text(keyCode, 7, 25);\n   *   text(code || \" \", 30, 50);\n   * }\n   * </div>\n   * </code>\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let x = 50;\n   * let y = 50;\n   *  \n   * function setup() {\n   *   createCanvas(100, 100);\n   *  \n   *   background(200);\n   *  \n   *   describe(\n   *     'A gray square with a black circle at its center. The circle moves when the user presses an arrow key. It leaves a trail as it moves.'\n   *   );\n   * }\n   *  \n   * function draw() {\n   *   // Update x and y if an arrow key is pressed.\n   *   if (keyIsPressed){\n   *     if (keyIsDown(LEFT_ARROW)){\n   *       x -= 1;\n   *     }\n   *  \n   *     if (keyIsDown(RIGHT_ARROW)) {\n   *       x += 1;\n   *     }\n   *  \n   *     if (keyIsDown(UP_ARROW)) {\n   *       y -= 1;\n   *     }\n   *  \n   *     if (keyIsDown(DOWN_ARROW)) {\n   *       y += 1;\n   *     }\n   *   }\n   *  \n   *   // Style the circle.\n   *   fill(0);\n   *  \n   *   // Draw the circle.\n   *   circle(x, y, 5);\n   * }\n   *\n   * </code>\n   * </div>\n   */\n  fn.code = '';\n\n  /**\n   * A `Number` system variable that contains the code of the last key pressed.\n   *\n   * Every key has a numeric key code. For example, the letter `a` key has the key code 65.\n   * Use this key code to determine which key was pressed by comparing it to the numeric value\n   * of the desired key.\n   *\n   * For example, to detect when the Enter key is pressed:\n   *\n   * ```js\n   * if (keyCode === 13) { // Enter key\n   *   // Code to run if the Enter key was pressed.\n   * }\n   * ```\n   *\n   * Alternatively, you can use the <a href=\"#/p5/key\">key</a> function to directly compare the key value:\n   *\n   * ```js\n   * if (key === 'Enter') { // Enter key\n   *   // Code to run if the Enter key was pressed.\n   * }\n   * ```\n   *\n   * Use the following numeric codes for the arrow keys:\n   *\n   *   Up Arrow: 38  \n   *   Down Arrow: 40  \n   *   Left Arrow: 37  \n   *   Right Arrow: 39\n   *\n   * More key codes can be found at websites such as \n   * <a href=\"http://keycode.info/\">keycode.info</a>.\n   *\n   * @property {Integer} keyCode\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square. The last key pressed and its code are displayed at the center.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the last key pressed and its code.\n   *   text(`${key} : ${keyCode}`, 50, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let x = 50;\n   * let y = 50;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe(\n   *     'A gray square with a black circle at its center. The circle moves when the user presses an arrow key. It leaves a trail as it moves.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   // Update x and y if an arrow key is pressed.\n   *   if (keyIsPressed === true) {\n   *     if (keyCode === 38) { // Up arrow key\n   *       y -= 1;\n   *     } else if (keyCode === 40) { // Down arrow key\n   *       y += 1;\n   *     } else if (keyCode === 37) { // Left arrow key\n   *       x -= 1;\n   *     } else if (keyCode === 39) { // Right arrow key\n   *       x += 1;\n   *     }\n   *   }\n   *\n   *   // Style the circle.\n   *   fill(0);\n   *\n   *   // Draw the circle at (x, y).\n   *   circle(x, y, 5);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.keyCode = 0;\n\n  /**\n   * A function that's called once when any key is pressed.\n   *\n   * Declaring the function `keyPressed()` sets a code block to run once\n   * automatically when the user presses any key:\n   *\n   * ```js\n   * function keyPressed() {\n   *   // Code to run.\n   * }\n   * ```\n   *\n   * The <a href=\"#/p5/key\">key</a> and <a href=\"#/p5/keyCode\">keyCode</a>\n   * variables will be updated with the most recently typed value when\n   * `keyPressed()` is called by p5.js:\n   *\n   * ```js\n   * function keyPressed() {\n   *   if (key === 'c') {\n   *     // Code to run.\n   *   }\n   *\n   *   if (keyCode === 13) { // Enter key\n   *     // Code to run.\n   *   }\n   * }\n   * ```\n   *\n   * The parameter, `event`, is optional. `keyPressed()` is always passed a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent\" target=\"_blank\">KeyboardEvent</a>\n   * object with properties that describe the key press event:\n   *\n   * ```js\n   * function keyPressed(event) {\n   *   // Code to run that uses the event.\n   *   console.log(event);\n   * }\n   * ```\n   *\n   * Browsers may have default behaviors attached to various key events. For\n   * example, some browsers may jump to the bottom of a web page when the\n   * `SPACE` key is pressed. To prevent any default behavior for this event, add\n   * `return false;` to the end of the function.\n   *\n   * @method keyPressed\n   * @param  {KeyboardEvent} [event] optional `KeyboardEvent` callback argument.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black square at its center. The inner square changes color when the user presses a key.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * // Toggle the background color when the user presses a key.\n   * function keyPressed() {\n   *   if (value === 0) {\n   *     value = 255;\n   *   } else {\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a white square at its center. The inner square turns black when the user presses the \"b\" key. It turns white when the user presses the \"a\" key.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * // Reassign value when the user presses the 'a' or 'b' key.\n   * function keyPressed() {\n   *   if (key === 'a') {\n   *     value = 255;\n   *   } else if (key === 'b') {\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black square at its center. The inner square turns white when the user presses the left arrow key. It turns black when the user presses the right arrow key.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * // Toggle the background color when the user presses an arrow key.\n   * function keyPressed() {\n   *   if (keyCode === 37) { // Left arrow key\n   *     value = 255;\n   *   } else if (keyCode === 39) { // Right arrow key\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   */\n  fn._onkeydown = function(e) {\n    if (this._downKeys[e.code]) {\n      return;\n    }\n\n    this.keyIsPressed = true;\n    this.keyCode = e.which;\n    this.key = e.key;\n    this.code = e.code;\n    this._downKeyCodes[e.code] = true;\n    this._downKeys[e.key] = true;\n\n    const context = this._isGlobal ? window : this;\n    if (typeof context.keyPressed === 'function' && !e.charCode) {\n      const executeDefault = context.keyPressed(e);\n      if (executeDefault === false) {\n        e.preventDefault();\n      }\n    }\n  };\n\n  /**\n   * A function that's called once when any key is released.\n   *\n   * Declaring the function `keyReleased()` sets a code block to run once\n   * automatically when the user releases any key:\n   *\n   * ```js\n   * function keyReleased() {\n   *   // Code to run.\n   * }\n   * ```\n   *\n   * The <a href=\"#/p5/key\">key</a> and <a href=\"#/p5/keyCode\">keyCode</a>\n   * variables will be updated with the most recently released value when\n   * `keyReleased()` is called by p5.js:\n   *\n   * ```js\n   * function keyReleased() {\n   *   if (key === 'c') {\n   *     // Code to run.\n   *   }\n   *\n   *   if (keyCode === 13) { // Enter key\n   *     // Code to run.\n   *   }\n   * }\n   * ```\n   *\n   * The parameter, `event`, is optional. `keyReleased()` is always passed a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent\" target=\"_blank\">KeyboardEvent</a>\n   * object with properties that describe the key press event:\n   *\n   * ```js\n   * function keyReleased(event) {\n   *   // Code to run that uses the event.\n   *   console.log(event);\n   * }\n   * ```\n   *\n   * Browsers may have default behaviors attached to various key events. To\n   * prevent any default behavior for this event, add `return false;` to the end\n   * of the function.\n   *\n   * @method keyReleased\n   * @param  {KeyboardEvent} [event] optional `KeyboardEvent` callback argument.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black square at its center. The inner square changes color when the user releases a key.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * // Toggle value when the user releases a key.\n   * function keyReleased() {\n   *   if (value === 0) {\n   *     value = 255;\n   *   } else {\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black square at its center. The inner square becomes white when the user releases the \"w\" key.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * // Set value to 255 the user releases the 'w' key.\n   * function keyReleased() {\n   *   if (key === 'w') {\n   *     value = 255;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black square at its center. The inner square turns white when the user presses and releases the left arrow key. It turns black when the user presses and releases the right arrow key.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * // Toggle the background color when the user releases an arrow key.\n   * function keyReleased() {\n   *   if (keyCode === 37) { // Left arrow key\n   *     value = 255;\n   *   } else if (keyCode === 39) { // Right arrow key\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   */\n  fn._onkeyup = function(e) {\n\n    const context = this._isGlobal ? window : this;\n    if (typeof context.keyReleased === 'function') {\n      const executeDefault = context.keyReleased(e);\n      if (executeDefault === false) {\n        e.preventDefault();\n      }\n    }\n    \n    delete this._downKeyCodes[e.code];\n    delete this._downKeys[e.key];\n\n\n    if (!this._areDownKeys()) {\n      this.keyIsPressed = false;\n      this.key = '';\n      this.code = '';\n    } else {\n      // If other keys are still pressed, update code to the last pressed key\n      const lastPressedCode = Object.keys(this._downKeyCodes).pop();\n      this.code = lastPressedCode;\n      const lastPressedKey = Object.keys(this._downKeys).pop();\n      this.key = lastPressedKey;\n    }\n\n  };\n\n  /**\n   * A function that's called once when keys with printable characters are pressed.\n   *\n   * Declaring the function `keyTyped()` sets a code block to run once\n   * automatically when the user presses any key with a printable character such\n   * as `a` or 1. Modifier keys such as `SHIFT`, `CONTROL`, and the arrow keys\n   * will be ignored:\n   *\n   * ```js\n   * function keyTyped() {\n   *   // Code to run.\n   * }\n   * ```\n   *\n   * The <a href=\"#/p5/key\">key</a> and <a href=\"#/p5/keyCode\">keyCode</a>\n   * variables will be updated with the most recently released value when\n   * `keyTyped()` is called by p5.js:\n   *\n   * ```js\n   * function keyTyped() {\n   *   // Check for the \"c\" character using key.\n   *   if (key === 'c') {\n   *     // Code to run.\n   *   }\n   *\n   *   // Check for \"c\" using keyCode.\n   *   if (keyCode === 67) { // 67 is the ASCII code for 'c'\n   *     // Code to run.\n   *   }\n   * }\n   * ```\n   *\n   * The parameter, `event`, is optional. `keyTyped()` is always passed a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent\" target=\"_blank\">KeyboardEvent</a>\n   * object with properties that describe the key press event:\n   *\n   * ```js\n   * function keyReleased(event) {\n   *   // Code to run that uses the event.\n   *   console.log(event);\n   * }\n   * ```\n   *\n   * Note: Use the <a href=\"#/p5/keyPressed\">keyPressed()</a> function and\n   * <a href=\"#/p5/keyCode\">keyCode</a> system variable to respond to modifier\n   * keys such as `ALT`.\n   *\n   * Browsers may have default behaviors attached to various key events. To\n   * prevent any default behavior for this event, add `return false;` to the end\n   * of the function.\n   *\n   * @method keyTyped\n   * @param  {KeyboardEvent} [event] optional `KeyboardEvent` callback argument.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   * // Note: Pressing special keys such as SPACE have no effect.\n   *\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a white square at its center. The inner square changes color when the user presses a key.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * // Toggle the square's color when the user types a printable key.\n   * function keyTyped() {\n   *   if (value === 0) {\n   *     value = 255;\n   *   } else {\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a white square at its center. The inner square turns black when the user types the \"b\" key. It turns white when the user types the \"a\" key.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * // Reassign value when the user types the 'a' or 'b' key.\n   * function keyTyped() {\n   *   if (key === 'a') {\n   *     value = 255;\n   *   } else if (key === 'b') {\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   */\n  fn._onkeypress = function(e) {\n    if (e.which === this._lastKeyCodeTyped && e.repeat) {\n      // prevent multiple firings\n      return;\n    }\n    this._lastKeyCodeTyped = e.which; // track last keyCode\n    this.key = e.key || String.fromCharCode(e.which) || e.which;\n\n    const context = this._isGlobal ? window : this;\n    if (typeof context.keyTyped === 'function') {\n      const executeDefault = context.keyTyped(e);\n      if (executeDefault === false) {\n        e.preventDefault();\n      }\n    }\n  };\n  /**\n   * The onblur function is called when the user is no longer focused\n   * on the p5 element. Because the keyup events will not fire if the user is\n   * not focused on the element we must assume all keys currently down have\n   * been released.\n   */\n  fn._onblur = function(e) {\n    this._downKeys = {};\n  };\n\n  /**\n   * Returns `true` if the key its checking is pressed and `false` if not.\n   *\n   * `keyIsDown()` is helpful when checking for multiple different key presses.\n   * For example, `keyIsDown()` can be used to check if both `LEFT_ARROW` and\n   * `UP_ARROW` are pressed:\n   *\n   * ```js\n   * if (keyIsDown(LEFT_ARROW) && keyIsDown(UP_ARROW)) {\n   *   // Move diagonally.\n   * }\n   * ```\n   *\n   * `keyIsDown()` can check for key presses using strings based on\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key\" target=\"_blank\">KeyboardEvent.key</a>\n   * or <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/code\" target=\"_blank\">KeyboardEvent.code</a> values,\n   * such as `keyIsDown('x')` or `keyIsDown('ArrowLeft')`.\n   *\n   * Note: In p5.js 2.0 and newer, numeric keycodes (such as 88 for 'X') are no longer supported.\n   * This is a breaking change from previous versions.\n   *\n   * You can still use the p5 constants like `LEFT_ARROW` which now map to string values\n   * internally rather than numeric codes.\n   *\n   * @method keyIsDown\n   * @param {Number|String}   code key to check.\n   * @return {Boolean}        whether the key is down or not.\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let x = 50;\n   * let y = 50;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe(\n   *     'A gray square with a black circle at its center. The circle moves when the user presses an arrow key. It leaves a trail as it moves.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   // Update x and y if an arrow key is pressed.\n   *   if (keyIsDown(LEFT_ARROW) === true) {\n   *     x -= 1;\n   *   }\n   *\n   *   if (keyIsDown(RIGHT_ARROW) === true) {\n   *     x += 1;\n   *   }\n   *\n   *   if (keyIsDown(UP_ARROW) === true) {\n   *     y -= 1;\n   *   }\n   *\n   *   if (keyIsDown(DOWN_ARROW) === true) {\n   *     y += 1;\n   *   }\n   *\n   *   // Style the circle.\n   *   fill(0);\n   *\n   *   // Draw the circle.\n   *   circle(x, y, 5);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click on the canvas to begin detecting key presses.\n   *\n   * let x = 50;\n   * let y = 50;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe(\n   *     'A gray square with a black circle at its center. The circle moves when the user presses an arrow key. It leaves a trail as it moves.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   // Update x and y if an arrow key is pressed.\n   *   if (keyIsDown('ArrowLeft') === true) {\n   *     x -= 1;\n   *   }\n   *\n   *   if (keyIsDown('ArrowRight') === true) {\n   *     x += 1;\n   *   }\n   *\n   *   if (keyIsDown('ArrowUp') === true) {\n   *     y -= 1;\n   *   }\n   *\n   *   if (keyIsDown('ArrowDown') === true) {\n   *     y += 1;\n   *   }\n   *\n   *   // Style the circle.\n   *   fill(0);\n   *\n   *   // Draw the circle.\n   *   circle(x, y, 5);\n   * }\n   * </code>\n   * </div>\n   */\n\n  fn.keyIsDown = function(input) {\n    if (isCode(input)) {\n      return this._downKeyCodes[input] || this._downKeys[input] || false;\n    } else {\n      return this._downKeys[input] || this._downKeyCodes[input] || false;\n    }\n  };\n  /**\n   * The _areDownKeys function returns a boolean true if any keys pressed\n   * and a false if no keys are currently pressed.\n\n   * Helps avoid instances where multiple keys are pressed simultaneously and\n   * releasing a single key will then switch the\n   * keyIsPressed property to true.\n   * @private\n  **/\n  fn._areDownKeys = function() {\n    for (const key in this._downKeys) {\n      if (this._downKeys.hasOwnProperty(key) && this._downKeys[key] === true) {\n        return true;\n      }\n    }\n    return false;\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  keyboard(p5, p5.prototype);\n}\n\nexport { keyboard as default, isCode };\n","/**\n * @module Events\n * @submodule Pointer\n * @for p5\n * @requires core\n * @requires constants\n */\n\n\nfunction pointer(p5, fn){\n  /**\n   * A `Number` system variable that tracks the mouse's horizontal movement.\n   *\n   * `movedX` tracks how many pixels the mouse moves left or right between\n   * frames. `movedX` will have a negative value if the mouse moves left between\n   * frames and a positive value if it moves right. `movedX` can be calculated\n   * as `mouseX - pmouseX`.\n   *\n   * Note: `movedX` continues updating even when\n   * <a href=\"#/p5/requestPointerLock\">requestPointerLock()</a> is active.\n   *\n   * @property {Number} movedX\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square. The text \">>\" appears when the user moves the mouse to the right. The text \"<<\" appears when the user moves the mouse to the left.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display >> when movedX is positive and\n   *   // << when it's negative.\n   *   if (movedX > 0) {\n   *     text('>>', 50, 50);\n   *   } else if (movedX < 0) {\n   *     text('<<', 50, 50);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.movedX = 0;\n\n  /**\n   * A `Number` system variable that tracks the mouse's vertical movement.\n   *\n   * `movedY` tracks how many pixels the mouse moves up or down between\n   * frames. `movedY` will have a negative value if the mouse moves up between\n   * frames and a positive value if it moves down. `movedY` can be calculated\n   * as `mouseY - pmouseY`.\n   *\n   * Note: `movedY` continues updating even when\n   * <a href=\"#/p5/requestPointerLock\">requestPointerLock()</a> is active.\n   *\n   * @property {Number} movedY\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square. The text \"\" appears when the user moves the mouse upward. The text \"\" appears when the user moves the mouse downward.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display  when movedY is positive and\n   *   //  when it's negative.\n   *   if (movedY > 0) {\n   *     text('', 50, 50);\n   *   } else if (movedY < 0) {\n   *     text('', 50, 50);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.movedY = 0;\n  /*\n   * This is a flag which is false until the first time\n   * we receive a mouse event. The pmouseX and pmouseY\n   * values will match the mouseX and mouseY values until\n   * this interaction takes place.\n   */\n  fn._hasMouseInteracted = false;\n\n  /**\n   * A `Number` system variable that tracks the mouse's horizontal position.\n   *\n   * `mouseX` keeps track of the mouse's position relative to the\n   * top-left corner of the canvas. For example, if the mouse is 50 pixels from\n   * the left edge of the canvas, then `mouseX` will be 50.\n   *\n   * If touch is used instead of the mouse, then `mouseX` will hold the\n   * x-coordinate of the most recent touch point.\n   *\n   * @property {Number} mouseX\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\"A vertical black line moves left and right following the mouse's x-position.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a vertical line that follows the mouse's x-coordinate.\n   *   line(mouseX, 0, mouseX, 100);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\"A gray square. The mouse's x- and y-coordinates are displayed as the user moves the mouse.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the mouse's coordinates.\n   *   text(`x: ${int(mouseX)} y: ${int(mouseY)}`, 50, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\"A vertical black line moves left and right following the mouse's x-position.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Adjust coordinates for WebGL mode.\n   *   // The origin (0, 0) is at the center of the canvas.\n   *   let mx = mouseX - 50;\n   *\n   *   // Draw the line.\n   *   line(mx, -50, mx, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font for WebGL mode.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     \"A gray square. The mouse's x- and y-coordinates are displayed as the user moves the mouse.\"\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Display the mouse's coordinates.\n   *   text(`x: ${int(mouseX)} y: ${int(mouseY)}`, 0, 0);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.mouseX = 0;\n\n  /**\n   * A `Number` system variable that tracks the mouse's vertical position.\n   *\n   * `mouseY` keeps track of the mouse's position relative to the\n   * top-left corner of the canvas. For example, if the mouse is 50 pixels from\n   * the top edge of the canvas, then `mouseY` will be 50.\n   *\n   * If touch is used instead of the mouse, then `mouseY` will hold the\n   * y-coordinate of the most recent touch point.\n   *\n   * @property {Number} mouseY\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\"A horizontal black line moves up and down following the mouse's y-position.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a horizontal line that follows the mouse's y-coordinate.\n   *   line(0, mouseY, 100, mouseY);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\"A gray square. The mouse's x- and y-coordinates are displayed as the user moves the mouse.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the mouse's coordinates.\n   *   text(`x: ${int(mouseX)} y: ${int(mouseY)}`, 50, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\"A horizontal black line moves up and down following the mouse's y-position.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Adjust coordinates for WebGL mode.\n   *   // The origin (0, 0) is at the center of the canvas.\n   *   let my = mouseY - 50;\n   *\n   *   // Draw the line.\n   *   line(-50, my, 50, my);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let font;\n   *\n   * async function setup() {\n   *   // Load a font for WebGL mode.\n   *   font = await loadFont('assets/inconsolata.otf');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe(\n   *     \"A gray square. The mouse's x- and y-coordinates are displayed as the user moves the mouse.\"\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *   textFont(font);\n   *   fill(0);\n   *\n   *   // Display the mouse's coordinates.\n   *   text(`x: ${int(mouseX)} y: ${int(mouseY)}`, 0, 0);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.mouseY = 0;\n\n  /**\n   * A `Number` system variable that tracks the mouse's previous horizontal\n   * position.\n   *\n   * `pmouseX` keeps track of the mouse's position relative to the\n   * top-left corner of the canvas. Its value is\n   * <a href=\"#/p5/mouseX\">mouseX</a> from the previous frame. For example, if\n   * the mouse was 50 pixels from the left edge of the canvas during the last\n   * frame, then `pmouseX` will be 50.\n   *\n   * If touch is used instead of the mouse, then `pmouseX` will hold the\n   * x-coordinate of the last touch point.\n   *\n   * Note: `pmouseX` is reset to the current <a href=\"#/p5/mouseX\">mouseX</a>\n   * value at the start of each touch event.\n   *\n   * @property {Number} pmouseX\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(10);\n   *\n   *   describe('A line follows the mouse as it moves. The line grows longer with faster movements.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   line(pmouseX, pmouseY, mouseX, mouseY);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A line follows the mouse as it moves. The line grows longer with faster movements.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Adjust coordinates for WebGL mode.\n   *   // The origin (0, 0) is at the center of the canvas.\n   *   let pmx = pmouseX - 50;\n   *   let pmy = pmouseY - 50;\n   *   let mx = mouseX - 50;\n   *   let my = mouseY - 50;\n   *\n   *   // Draw the line.\n   *   line(pmx, pmy, mx, my);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.pmouseX = 0;\n\n  /**\n   * A `Number` system variable that tracks the mouse's previous vertical\n   * position.\n   *\n   * `pmouseY` keeps track of the mouse's position relative to the\n   * top-left corner of the canvas. Its value is\n   * <a href=\"#/p5/mouseY\">mouseY</a> from the previous frame. For example, if\n   * the mouse was 50 pixels from the top edge of the canvas during the last\n   * frame, then `pmouseY` will be 50.\n   *\n   * If touch is used instead of the mouse, then `pmouseY` will hold the\n   * y-coordinate of the last touch point.\n   *\n   * Note: `pmouseY` is reset to the current <a href=\"#/p5/mouseY\">mouseY</a>\n   * value at the start of each touch event.\n   *\n   * @property {Number} pmouseY\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(10);\n   *\n   *   describe('A line follows the mouse as it moves. The line grows longer with faster movements.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   line(pmouseX, pmouseY, mouseX, mouseY);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A line follows the mouse as it moves. The line grows longer with faster movements.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Adjust coordinates for WebGL mode.\n   *   // The origin (0, 0) is at the center of the canvas.\n   *   let pmx = pmouseX - 50;\n   *   let pmy = pmouseY - 50;\n   *   let mx = mouseX - 50;\n   *   let my = mouseY - 50;\n   *\n   *   // Draw the line.\n   *   line(pmx, pmy, mx, my);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.pmouseY = 0;\n\n  /**\n   * A `Number` variable that tracks the mouse's horizontal position within the\n   * browser.\n   *\n   * `winMouseX` keeps track of the mouse's position relative to the top-left\n   * corner of the browser window. For example, if the mouse is 50 pixels from\n   * the left edge of the browser, then `winMouseX` will be 50.\n   *\n   * On a touchscreen device, `winMouseX` will hold the x-coordinate of the most\n   * recent touch point.\n   *\n   * Note: Use <a href=\"#/p5/mouseX\">mouseX</a> to track the mouses\n   * x-coordinate within the canvas.\n   *\n   * @property {Number} winMouseX\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\"A gray square. The mouse's x- and y-coordinates are displayed as the user moves the mouse.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the mouse's coordinates within the browser window.\n   *   text(`x: ${int(winMouseX)} y: ${int(winMouseY)}`, 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.winMouseX = 0;\n\n  /**\n   * A `Number` variable that tracks the mouse's vertical position within the\n   * browser.\n   *\n   * `winMouseY` keeps track of the mouse's position relative to the top-left\n   * corner of the browser window. For example, if the mouse is 50 pixels from\n   * the top edge of the browser, then `winMouseY` will be 50.\n   *\n   * On a touchscreen device, `winMouseY` will hold the y-coordinate of the most\n   * recent touch point.\n   *\n   * Note: Use <a href=\"#/p5/mouseY\">mouseY</a> to track the mouses\n   * y-coordinate within the canvas.\n   *\n   * @property {Number} winMouseY\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\"A gray square. The mouse's x- and y-coordinates are displayed as the user moves the mouse.\");\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the mouse's coordinates within the browser window.\n   *   text(`x: ${int(winMouseX)} y: ${int(winMouseY)}`, 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.winMouseY = 0;\n\n  /**\n   * A `Number` variable that tracks the mouse's previous horizontal position\n   * within the browser.\n   *\n   * `pwinMouseX` keeps track of the mouse's position relative to the top-left\n   * corner of the browser window. Its value is\n   * <a href=\"#/p5/winMouseX\">winMouseX</a> from the previous frame. For\n   * example, if the mouse was 50 pixels from\n   * the left edge of the browser during the last frame, then `pwinMouseX` will\n   * be 50.\n   *\n   * On a touchscreen device, `pwinMouseX` will hold the x-coordinate of the most\n   * recent touch point. `pwinMouseX` is reset to the current\n   * <a href=\"#/p5/winMouseX\">winMouseX</a> value at the start of each touch\n   * event.\n   *\n   * Note: Use <a href=\"#/p5/pmouseX\">pmouseX</a> to track the mouses previous\n   * x-coordinate within the canvas.\n   *\n   * @property {Number} pwinMouseX\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(10);\n   *\n   *   describe('A gray square. A white circle at its center grows larger when the mouse moves horizontally.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the circle's diameter.\n   *   let d = winMouseX - pwinMouseX;\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, d);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create the canvas and set its position.\n   *   let cnv = createCanvas(100, 100);\n   *   cnv.position(20, 20);\n   *\n   *   describe('A gray square with a number at its center. The number changes as the user moves the mouse vertically.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display pwinMouseX.\n   *   text(pwinMouseX, 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.pwinMouseX = 0;\n\n  /**\n   * A `Number` variable that tracks the mouse's previous vertical position\n   * within the browser.\n   *\n   * `pwinMouseY` keeps track of the mouse's position relative to the top-left\n   * corner of the browser window. Its value is\n   * <a href=\"#/p5/winMouseY\">winMouseY</a> from the previous frame. For\n   * example, if the mouse was 50 pixels from\n   * the top edge of the browser during the last frame, then `pwinMouseY` will\n   * be 50.\n   *\n   * On a touchscreen device, `pwinMouseY` will hold the y-coordinate of the most\n   * recent touch point. `pwinMouseY` is reset to the current\n   * <a href=\"#/p5/winMouseY\">winMouseY</a> value at the start of each touch\n   * event.\n   *\n   * Note: Use <a href=\"#/p5/pmouseY\">pmouseY</a> to track the mouses previous\n   * y-coordinate within the canvas.\n   *\n   * @property {Number} pwinMouseY\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(10);\n   *\n   *   describe('A gray square. A white circle at its center grows larger when the mouse moves vertically.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the circle's diameter.\n   *   let d = winMouseY - pwinMouseY;\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, d);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   // Create the canvas and set its position.\n   *   let cnv = createCanvas(100, 100);\n   *   cnv.position(20, 20);\n   *\n   *   describe('A gray square with a number at its center. The number changes as the user moves the mouse vertically.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display pwinMouseY.\n   *   text(pwinMouseY, 50, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.pwinMouseY = 0;\n\n  /**\n   * An object that tracks the current state of mouse buttons, showing which\n   * buttons are pressed at any given moment.\n   *\n   * The `mouseButton` object has three properties:\n   * - `left`: A boolean indicating whether the left mouse button is pressed.\n   * - `right`: A boolean indicating whether the right mouse button is pressed.\n   * - `center`: A boolean indicating whether the middle mouse button (scroll wheel button) is pressed.\n   *\n   * Note: Different browsers may track `mouseButton` differently. See\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons\" target=\"_blank\">MDN</a>\n   * for more information.\n   *\n   * @property {Object} mouseButton\n   * @property {boolean} mouseButton.left - Whether the left mouse button is pressed.\n   * @property {boolean} mouseButton.right - Whether the right mouse button is pressed.\n   * @property {boolean} mouseButton.center - Whether the middle mouse button is pressed.\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(200, 200);\n   *\n   *   describe(\n   *     'A gray square with black text at its center. The text changes from 0 to either \"left\" or \"right\" when the user clicks a mouse button.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the mouse button.\n   *   text(`Left: ${mouseButton.left}`, width / 2, height / 2 - 20);\n   *   text(`Right: ${mouseButton.right}`, width / 2, height / 2);\n   *   text(`Center: ${mouseButton.center}`, width / 2, height / 2 + 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     \"A gray square. Different shapes appear at its center depending on the mouse button that's clicked.\"\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   if (mouseIsPressed === true) {\n   *     if (mouseButton.left) {\n   *       circle(50, 50, 50);\n   *     }\n   *     if (mouseButton.right) {\n   *       square(25, 25, 50);\n   *     }\n   *     if (mouseButton.center) {\n   *       triangle(23, 75, 50, 20, 78, 75);\n   *     }\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.mouseButton = {\n    left: false,\n    right: false,\n    center: false\n  };\n\n   /**\n   * An `Array` of all the current touch points on a touchscreen device.\n   *\n   * The `touches` array is empty by default. When the user touches their\n   * screen, a new touch point is tracked and added to the array. Touch points\n   * are `Objects` with the following properties:\n   *\n   * ```js\n   * // Iterate over the touches array.\n   * for (let touch of touches) {\n   *   // x-coordinate relative to the top-left\n   *   // corner of the canvas.\n   *   console.log(touch.x);\n   *\n   *   // y-coordinate relative to the top-left\n   *   // corner of the canvas.\n   *   console.log(touch.y);\n   *\n   *   // x-coordinate relative to the top-left\n   *   // corner of the browser.\n   *   console.log(touch.winX);\n   *\n   *   // y-coordinate relative to the top-left\n   *   // corner of the browser.\n   *   console.log(touch.winY);\n   *\n   *   // ID number\n   *   console.log(touch.id);\n   * }\n   * ```\n   *\n   * @property {Object[]} touches\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * // On a touchscreen device, touch the canvas using one or more fingers\n   * // at the same time.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square. White circles appear where the user touches the square.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a circle at each touch point.\n   *   for (let touch of touches) {\n   *     circle(touch.x, touch.y, 40);\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // On a touchscreen device, touch the canvas using one or more fingers\n   * // at the same time.\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square. Labels appear where the user touches the square, displaying the coordinates.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw a label above each touch point.\n   *   for (let touch of touches) {\n   *     text(`${touch.x}, ${touch.y}`, touch.x, touch.y - 40);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n   fn.touches = [];\n   fn._activePointers = new Map();\n\n  /**\n   * A `Boolean` system variable that's `true` if the mouse is pressed and\n   * `false` if not.\n   *\n   * @property {Boolean} mouseIsPressed\n   * @readOnly\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with the word \"false\" at its center. The word changes to \"true\" when the user presses a mouse button.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the mouseIsPressed variable.\n   *   text(mouseIsPressed, 25, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a white square at its center. The inner square turns black when the user presses the mouse.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   if (mouseIsPressed === true) {\n   *     fill(0);\n   *   } else {\n   *     fill(255);\n   *   }\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.mouseIsPressed = false;\n\n  fn._updatePointerCoords = function (e) {\n    if (this._curElement !== null) {\n      const canvas = this._curElement.elt;\n      const sx = canvas.scrollWidth / this.width || 1;\n      const sy = canvas.scrollHeight / this.height || 1;\n\n      if (e.pointerType == 'touch') {\n          const touches = [];\n          for (const touch of this._activePointers.values()) {\n            touches.push(getTouchInfo(canvas, sx, sy, touch));\n          }\n          this.touches = touches;\n      } \n\n      const mousePos = getMouseInfo(canvas, sx, sy, e);\n      this.movedX = e.movementX || 0;\n      this.movedY = e.movementY || 0;\n      this.mouseX = mousePos.x;\n      this.mouseY = mousePos.y;\n      this.winMouseX = mousePos.winX;\n      this.winMouseY = mousePos.winY;\n\n       if (!this._hasMouseInteracted) {\n          this._updateMouseCoords();\n          this._hasMouseInteracted = true;\n       }\n    }\n };\n\n  fn._updateMouseCoords = function() {\n    this.pmouseX = this.mouseX;\n    this.pmouseY = this.mouseY;\n    this.pwinMouseX = this.winMouseX;\n    this.pwinMouseY = this.winMouseY;\n    this._pmouseWheelDeltaY = this._mouseWheelDeltaY;\n  };\n\n  function getMouseInfo(canvas, sx, sy, evt) {\n    const rect = canvas.getBoundingClientRect();\n    return {\n       x: (evt.clientX - rect.left) / sx,\n       y: (evt.clientY - rect.top) / sy,\n       winX: evt.clientX,\n       winY: evt.clientY,\n    };\n }\n\n function getTouchInfo(canvas, sx, sy, touch) {\n  const rect = canvas.getBoundingClientRect();\n  return {\n     x: (touch.clientX - rect.left) / sx,\n     y: (touch.clientY - rect.top) / sy,\n     winX: touch.clientX,\n     winY: touch.clientY,\n     id: touch.pointerId,\n  };\n}\n\nfn._setMouseButton = function(e) {\n  // Check all active touches to determine button states\n  this.mouseButton.left = Array.from(this._activePointers.values()).some(touch => \n    (touch.buttons & 1) !== 0\n  );\n  this.mouseButton.center = Array.from(this._activePointers.values()).some(touch =>\n    (touch.buttons & 4) !== 0\n  );\n  this.mouseButton.right = Array.from(this._activePointers.values()).some(touch =>\n    (touch.buttons & 2) !== 0\n  );\n};\n\n  /**\n   * A function that's called when the mouse moves.\n   *\n   * Declaring the function `mouseMoved()` sets a code block to run\n   * automatically when the user moves the mouse without clicking any mouse\n   * buttons:\n   *\n   * ```js\n   * function mouseMoved() {\n   *   // Code to run.\n   * }\n   * ```\n   *\n   * The mouse system variables, such as <a href=\"#/p5/mouseX\">mouseX</a> and\n   * <a href=\"#/p5/mouseY\">mouseY</a>, will be updated with their most recent\n   * value when `mouseMoved()` is called by p5.js:\n   *\n   * ```js\n   * function mouseMoved() {\n   *   if (mouseX < 50) {\n   *     // Code to run if the mouse is on the left.\n   *   }\n   *\n   *   if (mouseY > 50) {\n   *     // Code to run if the mouse is near the bottom.\n   *   }\n   * }\n   * ```\n   *\n   * The parameter, `event`, is optional. `mouseMoved()` is always passed a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\" target=\"_blank\">MouseEvent</a>\n   * object with properties that describe the mouse move event:\n   *\n   * ```js\n   * function mouseMoved(event) {\n   *   // Code to run that uses the event.\n   *   console.log(event);\n   * }\n   * ```\n   *\n   * Browsers may have default behaviors attached to various mouse events. For\n   * example, some browsers highlight text when the user moves the mouse while\n   * pressing a mouse button. To prevent any default behavior for this event,\n   * add `return false;` to the end of the function.\n   *\n   * @method mouseMoved\n   * @param  {MouseEvent} [event] optional `MouseEvent` argument.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black square at its center. The inner square becomes lighter as the mouse moves.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * function mouseMoved() {\n   *   // Update the grayscale value.\n   *   value += 5;\n   *\n   *   // Reset the grayscale value.\n   *   if (value > 255) {\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * A function that's called when the mouse moves while a button is pressed.\n   *\n   * Declaring the function `mouseDragged()` sets a code block to run\n   * automatically when the user clicks and drags the mouse:\n   *\n   * ```js\n   * function mouseDragged() {\n   *   // Code to run.\n   * }\n   * ```\n   *\n   * The mouse system variables, such as <a href=\"#/p5/mouseX\">mouseX</a> and\n   * <a href=\"#/p5/mouseY\">mouseY</a>, will be updated with their most recent\n   * value when `mouseDragged()` is called by p5.js:\n   *\n   * ```js\n   * function mouseDragged() {\n   *   if (mouseX < 50) {\n   *     // Code to run if the mouse is on the left.\n   *   }\n   *\n   *   if (mouseY > 50) {\n   *     // Code to run if the mouse is near the bottom.\n   *   }\n   * }\n   * ```\n   *\n   * The parameter, `event`, is optional. `mouseDragged()` is always passed a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\" target=\"_blank\">MouseEvent</a>\n   * object with properties that describe the mouse drag event:\n   *\n   * ```js\n   * function mouseDragged(event) {\n   *   // Code to run that uses the event.\n   *   console.log(event);\n   * }\n   * ```\n   *\n   * On touchscreen devices, `mouseDragged()` will run when a user moves a touch\n   * point.\n   *\n   * Browsers may have default behaviors attached to various mouse events. For\n   * example, some browsers highlight text when the user moves the mouse while\n   * pressing a mouse button. To prevent any default behavior for this event,\n   * add `return false;` to the end of the function.\n   *\n   * @method mouseDragged\n   * @param  {MouseEvent} [event] optional `MouseEvent` argument.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black square at its center. The inner square becomes lighter as the user drags the mouse.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * function mouseDragged() {\n   *   // Update the grayscale value.\n   *   value += 5;\n   *\n   *   // Reset the grayscale value.\n   *   if (value > 255) {\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   */\n  fn._onpointermove = function(e) {\n    const context = this._isGlobal ? window : this;\n    let executeDefault;\n    this._updatePointerCoords(e);\n    this._activePointers.set(e.pointerId, e);\n    this._setMouseButton(e);\n    \n\n      if (!this.mouseIsPressed && typeof context.mouseMoved === 'function') {\n        executeDefault = context.mouseMoved(e);\n        if (executeDefault === false) {\n          e.preventDefault();\n        }\n      } else if (this.mouseIsPressed && typeof context.mouseDragged === 'function') {\n        executeDefault = context.mouseDragged(e);\n        if (executeDefault === false) {\n          e.preventDefault();\n        }\n      }\n  };\n\n  /**\n   * A function that's called once when a mouse button is pressed.\n   *\n   * Declaring the function `mousePressed()` sets a code block to run\n   * automatically when the user presses a mouse button:\n   *\n   * ```js\n   * function mousePressed() {\n   *   // Code to run.\n   * }\n   * ```\n   *\n   * The mouse system variables, such as <a href=\"#/p5/mouseX\">mouseX</a> and\n   * <a href=\"#/p5/mouseY\">mouseY</a>, will be updated with their most recent\n   * value when `mousePressed()` is called by p5.js:\n   *\n   * ```js\n   * function mousePressed() {\n   *   if (mouseX < 50) {\n   *     // Code to run if the mouse is on the left.\n   *   }\n   *\n   *   if (mouseY > 50) {\n   *     // Code to run if the mouse is near the bottom.\n   *   }\n   * }\n   * ```\n   *\n   * The parameter, `event`, is optional. `mousePressed()` is always passed a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\" target=\"_blank\">MouseEvent</a>\n   * object with properties that describe the mouse press event:\n   *\n   * ```js\n   * function mousePressed(event) {\n   *   // Code to run that uses the event.\n   *   console.log(event);\n   * }\n   * ```\n   *\n   * On touchscreen devices, `mousePressed()` will run when a users touch\n   * begins.\n   *\n   * Browsers may have default behaviors attached to various mouse events. For\n   * example, some browsers highlight text when the user moves the mouse while\n   * pressing a mouse button. To prevent any default behavior for this event,\n   * add `return false;` to the end of the function.\n   *\n   * Note: `mousePressed()`, <a href=\"#/p5/mouseReleased\">mouseReleased()</a>,\n   * and <a href=\"#/p5/mouseClicked\">mouseClicked()</a> are all related.\n   * `mousePressed()` runs as soon as the user clicks the mouse.\n   * <a href=\"#/p5/mouseReleased\">mouseReleased()</a> runs as soon as the user\n   * releases the mouse click. <a href=\"#/p5/mouseClicked\">mouseClicked()</a>\n   * runs immediately after <a href=\"#/p5/mouseReleased\">mouseReleased()</a>.\n   *\n   * @method mousePressed\n   * @param  {MouseEvent} [event] optional `MouseEvent` argument.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black square at its center. The inner square becomes lighter when the user presses a mouse button.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * function mousePressed() {\n   *   // Update the grayscale value.\n   *   value += 5;\n   *\n   *   // Reset the grayscale value.\n   *   if (value > 255) {\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Style the circle.\n   *   fill('orange');\n   *   stroke('royalblue');\n   *   strokeWeight(10);\n   *\n   *   describe(\n   *     'An orange circle with a thick, blue border drawn on a gray background. When the user presses and holds the mouse, the border becomes thin and pink. When the user releases the mouse, the border becomes thicker and changes color to blue.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(220);\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, 20);\n   * }\n   *\n   * // Set the stroke color and weight as soon as the user clicks.\n   * function mousePressed() {\n   *   stroke('deeppink');\n   *   strokeWeight(3);\n   * }\n   *\n   * // Set the stroke and fill colors as soon as the user releases\n   * // the mouse.\n   * function mouseReleased() {\n   *   stroke('royalblue');\n   *\n   *   // This is never visible because fill() is called\n   *   // in mouseClicked() which runs immediately after\n   *   // mouseReleased();\n   *   fill('limegreen');\n   * }\n   *\n   * // Set the fill color and stroke weight after\n   * // mousePressed() and mouseReleased() are called.\n   * function mouseClicked() {\n   *   fill('orange');\n   *   strokeWeight(10);\n   * }\n   * </code>\n   * </div>\n   */\n  fn._onpointerdown = function(e) {\n    const context = this._isGlobal ? window : this;\n    let executeDefault;\n    this.mouseIsPressed = true;\n\n    this._activePointers.set(e.pointerId, e);\n    this._setMouseButton(e);\n    this._updatePointerCoords(e);\n\n    if (typeof context.mousePressed === 'function') {\n      executeDefault = context.mousePressed(e);\n      if (executeDefault === false) {\n        e.preventDefault();\n      }\n    } \n  };\n\n  /**\n   * A function that's called once when a mouse button is released.\n   *\n   * Declaring the function `mouseReleased()` sets a code block to run\n   * automatically when the user releases a mouse button after having pressed\n   * it:\n   *\n   * ```js\n   * function mouseReleased() {\n   *   // Code to run.\n   * }\n   * ```\n   *\n   * The mouse system variables, such as <a href=\"#/p5/mouseX\">mouseX</a> and\n   * <a href=\"#/p5/mouseY\">mouseY</a>, will be updated with their most recent\n   * value when `mouseReleased()` is called by p5.js:\n   *\n   * ```js\n   * function mouseReleased() {\n   *   if (mouseX < 50) {\n   *     // Code to run if the mouse is on the left.\n   *   }\n   *\n   *   if (mouseY > 50) {\n   *     // Code to run if the mouse is near the bottom.\n   *   }\n   * }\n   * ```\n   *\n   * The parameter, `event`, is optional. `mouseReleased()` is always passed a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\" target=\"_blank\">MouseEvent</a>\n   * object with properties that describe the mouse release event:\n   *\n   * ```js\n   * function mouseReleased(event) {\n   *   // Code to run that uses the event.\n   *   console.log(event);\n   * }\n   * ```\n   *\n   * On touchscreen devices, `mouseReleased()` will run when a users touch\n   * ends.\n   *\n   * Browsers may have default behaviors attached to various mouse events. For\n   * example, some browsers highlight text when the user moves the mouse while\n   * pressing a mouse button. To prevent any default behavior for this event,\n   * add `return false;` to the end of the function.\n   *\n   * Note: <a href=\"#/p5/mousePressed\">mousePressed()</a>, `mouseReleased()`,\n   * and <a href=\"#/p5/mouseClicked\">mouseClicked()</a> are all related.\n   * <a href=\"#/p5/mousePressed\">mousePressed()</a> runs as soon as the user\n   * clicks the mouse. `mouseReleased()` runs as soon as the user releases the\n   * mouse click. <a href=\"#/p5/mouseClicked\">mouseClicked()</a> runs\n   * immediately after `mouseReleased()`.\n   *\n   * @method mouseReleased\n   * @param  {MouseEvent} [event] optional `MouseEvent` argument.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black square at its center. The inner square becomes lighter when the user presses and releases a mouse button.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * function mouseReleased() {\n   *   // Update the grayscale value.\n   *   value += 5;\n   *\n   *   // Reset the grayscale value.\n   *   if (value > 255) {\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Style the circle.\n   *   fill('orange');\n   *   stroke('royalblue');\n   *   strokeWeight(10);\n   *\n   *   describe(\n   *     'An orange circle with a thick, blue border drawn on a gray background. When the user presses and holds the mouse, the border becomes thin and pink. When the user releases the mouse, the border becomes thicker and changes color to blue.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(220);\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, 20);\n   * }\n   *\n   * // Set the stroke color and weight as soon as the user clicks.\n   * function mousePressed() {\n   *   stroke('deeppink');\n   *   strokeWeight(3);\n   * }\n   *\n   * // Set the stroke and fill colors as soon as the user releases\n   * // the mouse.\n   * function mouseReleased() {\n   *   stroke('royalblue');\n   *\n   *   // This is never visible because fill() is called\n   *   // in mouseClicked() which runs immediately after\n   *   // mouseReleased();\n   *   fill('limegreen');\n   * }\n   *\n   * // Set the fill color and stroke weight after\n   * // mousePressed() and mouseReleased() are called.\n   * function mouseClicked() {\n   *   fill('orange');\n   *   strokeWeight(10);\n   * }\n   * </code>\n   * </div>\n   */\n  fn._onpointerup = function(e) {\n    const context = this._isGlobal ? window : this;\n    let executeDefault;\n    this.mouseIsPressed = false;\n\n    this._activePointers.delete(e.pointerId);\n    this._setMouseButton(e);\n\n    this._updatePointerCoords(e);\n   \n    if (typeof context.mouseReleased === 'function') {\n      executeDefault = context.mouseReleased(e);\n      if (executeDefault === false) {\n        e.preventDefault();\n      }\n    }\n  };\n\n  fn._ondragend = fn._onpointerup;\n  fn._ondragover = fn._onpointermove;\n\n  /**\n   * A function that's called once after a mouse button is pressed and released.\n   *\n   * Declaring the function `mouseClicked()` sets a code block to run\n   * automatically when the user releases a mouse button after having pressed\n   * it:\n   *\n   * ```js\n   * function mouseClicked() {\n   *   // Code to run.\n   * }\n   * ```\n   *\n   * The mouse system variables, such as <a href=\"#/p5/mouseX\">mouseX</a> and\n   * <a href=\"#/p5/mouseY\">mouseY</a>, will be updated with their most recent\n   * value when `mouseClicked()` is called by p5.js:\n   *\n   * ```js\n   * function mouseClicked() {\n   *   if (mouseX < 50) {\n   *     // Code to run if the mouse is on the left.\n   *   }\n   *\n   *   if (mouseY > 50) {\n   *     // Code to run if the mouse is near the bottom.\n   *   }\n   * }\n   * ```\n   *\n   * The parameter, `event`, is optional. `mouseClicked()` is always passed a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\" target=\"_blank\">MouseEvent</a>\n   * object with properties that describe the mouse click event:\n   *\n   * ```js\n   * function mouseClicked(event) {\n   *   // Code to run that uses the event.\n   *   console.log(event);\n   * }\n   * ```\n   *\n   * On touchscreen devices, `mouseClicked()` will run when a users touch\n   * ends.\n   *\n   * Browsers may have default behaviors attached to various mouse events. For\n   * example, some browsers highlight text when the user moves the mouse while\n   * pressing a mouse button. To prevent any default behavior for this event,\n   * add `return false;` to the end of the function.\n   *\n   * Note: <a href=\"#/p5/mousePressed\">mousePressed()</a>,\n   * <a href=\"#/p5/mouseReleased\">mouseReleased()</a>,\n   * and `mouseClicked()` are all related.\n   * <a href=\"#/p5/mousePressed\">mousePressed()</a> runs as soon as the user\n   * clicks the mouse. <a href=\"#/p5/mouseReleased\">mouseReleased()</a> runs as\n   * soon as the user releases the mouse click. `mouseClicked()` runs\n   * immediately after <a href=\"#/p5/mouseReleased\">mouseReleased()</a>.\n   *\n   * @method mouseClicked\n   * @param  {MouseEvent} [event] optional `MouseEvent` argument.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black square at its center. The inner square changes color when the user presses and releases a mouse button.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * // Toggle the square's color when the user clicks.\n   * function mouseClicked() {\n   *   if (value === 0) {\n   *     value = 255;\n   *   } else {\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Style the circle.\n   *   fill('orange');\n   *   stroke('royalblue');\n   *   strokeWeight(10);\n   *\n   *   describe(\n   *     'An orange circle with a thick, blue border drawn on a gray background. When the user presses and holds the mouse, the border becomes thin and pink. When the user releases the mouse, the border becomes thicker and changes color to blue.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(220);\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, 20);\n   * }\n   *\n   * // Set the stroke color and weight as soon as the user clicks.\n   * function mousePressed() {\n   *   stroke('deeppink');\n   *   strokeWeight(3);\n   * }\n   *\n   * // Set the stroke and fill colors as soon as the user releases\n   * // the mouse.\n   * function mouseReleased() {\n   *   stroke('royalblue');\n   *\n   *   // This is never visible because fill() is called\n   *   // in mouseClicked() which runs immediately after\n   *   // mouseReleased();\n   *   fill('limegreen');\n   * }\n   *\n   * // Set the fill color and stroke weight after\n   * // mousePressed() and mouseReleased() are called.\n   * function mouseClicked() {\n   *   fill('orange');\n   *   strokeWeight(10);\n   * }\n   * </code>\n   * </div>\n   */\n  fn._onclick = function(e) {\n    const context = this._isGlobal ? window : this;\n    if (typeof context.mouseClicked === 'function') {\n      const executeDefault = context.mouseClicked(e);\n      if (executeDefault === false) {\n        e.preventDefault();\n      }\n    }\n  };\n\n  /**\n   * A function that's called once when a mouse button is clicked twice quickly.\n   *\n   * Declaring the function `doubleClicked()` sets a code block to run\n   * automatically when the user presses and releases the mouse button twice\n   * quickly:\n   *\n   * ```js\n   * function doubleClicked() {\n   *   // Code to run.\n   * }\n   * ```\n   *\n   * The mouse system variables, such as <a href=\"#/p5/mouseX\">mouseX</a> and\n   * <a href=\"#/p5/mouseY\">mouseY</a>, will be updated with their most recent\n   * value when `doubleClicked()` is called by p5.js:\n   *\n   * ```js\n   * function doubleClicked() {\n   *   if (mouseX < 50) {\n   *     // Code to run if the mouse is on the left.\n   *   }\n   *\n   *   if (mouseY > 50) {\n   *     // Code to run if the mouse is near the bottom.\n   *   }\n   * }\n   * ```\n   *\n   * The parameter, `event`, is optional. `doubleClicked()` is always passed a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\" target=\"_blank\">MouseEvent</a>\n   * object with properties that describe the double-click event:\n   *\n   * ```js\n   * function doubleClicked(event) {\n   *   // Code to run that uses the event.\n   *   console.log(event);\n   * }\n   * ```\n   *\n   * On touchscreen devices, code placed in `doubleClicked()` will run after two\n   * touches that occur within a short time.\n   *\n   * Browsers may have default behaviors attached to various mouse events. For\n   * example, some browsers highlight text when the user moves the mouse while\n   * pressing a mouse button. To prevent any default behavior for this event,\n   * add `return false;` to the end of the function.\n   *\n   * @method doubleClicked\n   * @param  {MouseEvent} [event] optional `MouseEvent` argument.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black square at its center. The inner square changes color when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the square.\n   *   fill(value);\n   *\n   *   // Draw the square.\n   *   square(25, 25, 50);\n   * }\n   *\n   * // Toggle the square's color when the user double-clicks.\n   * function doubleClicked() {\n   *   if (value === 0) {\n   *     value = 255;\n   *   } else {\n   *     value = 0;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let value = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a black circle at its center. When the user double-clicks on the circle, it changes color to white.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the circle.\n   *   fill(value);\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, 80);\n   * }\n   *\n   * // Reassign value to 255 when the user double-clicks on the circle.\n   * function doubleClicked() {\n   *   if (dist(50, 50, mouseX, mouseY) < 40) {\n   *     value = 255;\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   */\n\n  fn._ondblclick = function(e) {\n    const context = this._isGlobal ? window : this;\n    if (typeof context.doubleClicked === 'function') {\n      const executeDefault = context.doubleClicked(e);\n      if (executeDefault === false) {\n        e.preventDefault();\n      }\n    }\n  };\n\n  /**\n   * For use with WebGL orbitControl.\n   * @property {Number} _mouseWheelDeltaY\n   * @readOnly\n   * @private\n   */\n  fn._mouseWheelDeltaY = 0;\n\n  /**\n   * For use with WebGL orbitControl.\n   * @property {Number} _pmouseWheelDeltaY\n   * @readOnly\n   * @private\n   */\n  fn._pmouseWheelDeltaY = 0;\n\n  /**\n   * A function that's called once when the mouse wheel moves.\n   *\n   * Declaring the function `mouseWheel()` sets a code block to run\n   * automatically when the user scrolls with the mouse wheel:\n   *\n   * ```js\n   * function mouseWheel() {\n   *   // Code to run.\n   * }\n   * ```\n   *\n   * The mouse system variables, such as <a href=\"#/p5/mouseX\">mouseX</a> and\n   * <a href=\"#/p5/mouseY\">mouseY</a>, will be updated with their most recent\n   * value when `mouseWheel()` is called by p5.js:\n   *\n   * ```js\n   * function mouseWheel() {\n   *   if (mouseX < 50) {\n   *     // Code to run if the mouse is on the left.\n   *   }\n   *\n   *   if (mouseY > 50) {\n   *     // Code to run if the mouse is near the bottom.\n   *   }\n   * }\n   * ```\n   *\n   * The parameter, `event`, is optional. `mouseWheel()` is always passed a\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent\" target=\"_blank\">MouseEvent</a>\n   * object with properties that describe the mouse scroll event:\n   *\n   * ```js\n   * function mouseWheel(event) {\n   *   // Code to run that uses the event.\n   *   console.log(event);\n   * }\n   * ```\n   *\n   * The `event` object has many properties including `delta`, a `Number`\n   * containing the distance that the user scrolled. For example, `event.delta`\n   * might have the value 5 when the user scrolls up. `event.delta` is positive\n   * if the user scrolls up and negative if they scroll down. The signs are\n   * opposite on macOS with \"natural\" scrolling enabled.\n   *\n   * Browsers may have default behaviors attached to various mouse events. For\n   * example, some browsers highlight text when the user moves the mouse while\n   * pressing a mouse button. To prevent any default behavior for this event,\n   * add `return false;` to the end of the function.\n   *\n   * Note: On Safari, `mouseWheel()` may only work as expected if\n   * `return false;` is added at the end of the function.\n   *\n   * @method mouseWheel\n   * @param  {WheelEvent} [event] optional `WheelEvent` argument.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let circleSize = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square. A white circle at its center grows up when the user scrolls the mouse wheel.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the circle\n   *   circle(circleSize, 50, 50);\n   * }\n   *\n   * // Increment circleSize when the user scrolls the mouse wheel.\n   * function mouseWheel() {\n   *   circleSize += 1;\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let direction = '';\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square. An arrow at its center points up when the user scrolls up. The arrow points down when the user scrolls down.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Draw an arrow that points where\n   *   // the mouse last scrolled.\n   *   text(direction, 50, 50);\n   * }\n   *\n   * // Change direction when the user scrolls the mouse wheel.\n   * function mouseWheel(event) {\n   *   if (event.delta > 0) {\n   *     direction = '';\n   *   } else {\n   *     direction = '';\n   *   }\n   *   // Uncomment to prevent any default behavior.\n   *   // return false;\n   * }\n   * </code>\n   * </div>\n   */\n  fn._onwheel = function(e) {\n    const context = this._isGlobal ? window : this;\n    this._mouseWheelDeltaY = e.deltaY;\n    if (typeof context.mouseWheel === 'function') {\n      e.delta = e.deltaY;\n      const executeDefault = context.mouseWheel(e);\n      if (executeDefault === false) {\n        e.preventDefault();\n      }\n    }\n  };\n\n  /**\n   * Locks the mouse pointer to its current position and makes it invisible.\n   *\n   * `requestPointerLock()` allows the mouse to move forever without leaving the\n   * screen. Calling `requestPointerLock()` locks the values of\n   * <a href=\"#/p5/mouseX\">mouseX</a>, <a href=\"#/p5/mouseY\">mouseY</a>,\n   * <a href=\"#/p5/pmouseX\">pmouseX</a>, and <a href=\"#/p5/pmouseY\">pmouseY</a>.\n   * <a href=\"#/p5/movedX\">movedX</a> and <a href=\"#/p5/movedY\">movedY</a>\n   * continue updating and can be used to get the distance the mouse moved since\n   * the last frame was drawn. Calling\n   * <a href=\"#/p5/exitPointerLock\">exitPointerLock()</a> resumes updating the\n   * mouse system variables.\n   *\n   * Note: Most browsers require an input, such as a click, before calling\n   * `requestPointerLock()`. Its recommended to call `requestPointerLock()` in\n   * an event function such as <a href=\"#/p5/doubleClicked\">doubleClicked()</a>.\n   *\n   * @method requestPointerLock\n   *\n   * @example\n   * <div>\n   * <code>\n   * let score = 0;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with the text \"Score: X\" at its center. The score increases when the user moves the mouse upward. It decreases when the user moves the mouse downward.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Update the score.\n   *   score -= movedY;\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the score.\n   *   text(`Score: ${score}`, 50, 50);\n   * }\n   *\n   * // Lock the pointer when the user double-clicks.\n   * function doubleClicked() {\n   *   requestPointerLock();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.requestPointerLock = function() {\n    // pointer lock object forking for cross browser\n    const canvas = this._curElement.elt;\n    canvas.requestPointerLock =\n      canvas.requestPointerLock || canvas.mozRequestPointerLock;\n    if (!canvas.requestPointerLock) {\n      console.log('requestPointerLock is not implemented in this browser');\n      return false;\n    }\n    canvas.requestPointerLock();\n    return true;\n  };\n\n  /**\n   * Exits a pointer lock started with\n   * <a href=\"#/p5/requestPointerLock\">requestPointerLock</a>.\n   *\n   * Calling `requestPointerLock()` locks the values of\n   * <a href=\"#/p5/mouseX\">mouseX</a>, <a href=\"#/p5/mouseY\">mouseY</a>,\n   * <a href=\"#/p5/pmouseX\">pmouseX</a>, and <a href=\"#/p5/pmouseY\">pmouseY</a>.\n   * Calling `exitPointerLock()` resumes updating the mouse system variables.\n   *\n   * Note: Most browsers require an input, such as a click, before calling\n   * `requestPointerLock()`. Its recommended to call `requestPointerLock()` in\n   * an event function such as <a href=\"#/p5/doubleClicked\">doubleClicked()</a>.\n   *\n   * @method exitPointerLock\n   *\n   * @example\n   * <div>\n   * <code>\n   * let isLocked = false;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe(\n   *     'A gray square with a word at its center. The word changes between \"Unlocked\" and \"Locked\" when the user double-clicks.'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Tell the user whether the pointer is locked.\n   *   if (isLocked === true) {\n   *     text('Locked', 50, 50);\n   *   } else {\n   *     text('Unlocked', 50, 50);\n   *   }\n   * }\n   *\n   * // Toggle the pointer lock when the user double-clicks.\n   * function doubleClicked() {\n   *   if (isLocked === true) {\n   *     exitPointerLock();\n   *     isLocked = false;\n   *   } else {\n   *     requestPointerLock();\n   *     isLocked = true;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.exitPointerLock = function() {\n    document.exitPointerLock();\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  pointer(p5, p5.prototype);\n}\n\nexport { pointer as default };\n","import { stringify } from './csv.js';\n\n/**\n * @module IO\n * @submodule Table\n * @requires core\n */\n\n\nclass Table {\n  constructor(rows) {\n    this.columns = [];\n    this.rows = [];\n  }\n\n  toString(separator=',') {\n    let rows = this.rows.map((row) => row.arr);\n\n    if(!this.columns.some((column) => column === null)){\n      rows = [this.columns, ...rows,];\n    }\n\n    return stringify(rows, {\n      separator\n    });\n  }\n\n  /**\n   *  Use <a href=\"/reference/p5.Table/addRow/\">addRow()</a> to add a new row of data to a <a href=\"#/p5.Table\">p5.Table</a> object. By default,\n   *  an empty row is created. Typically, you would store a reference to\n   *  the new row in a TableRow object (see newRow in the example above),\n   *  and then set individual values using <a href=\"#/p5/set\">set()</a>.\n   *\n   *  If a <a href=\"#/p5.TableRow\">p5.TableRow</a> object is included as a parameter, then that row is\n   *  duplicated and added to the table.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param   {p5.TableRow} [row] row to be added to the table\n   *  @return  {p5.TableRow} the row that was added\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Given the CSV file \"mammals.csv\"\n   * // in the project's \"assets\" folder:\n   * //\n   * // id,species,name\n   * // 0,Capra hircus,Goat\n   * // 1,Panthera pardus,Leopard\n   * // 2,Equus zebra,Zebra\n   *\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 300x300 canvas\n   *   createCanvas(300, 300);\n   *\n   *   // Load the CSV file from the assets folder with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Add a new row for \"Wolf\"\n   *   let newRow = table.addRow();\n   *   newRow.setString('id', table.getRowCount() - 1);\n   *   newRow.setString('species', 'Canis Lupus');\n   *     newRow.setString('name', 'Wolf');\n   *\n   *   // Set text properties\n   *   fill(0);       // Text color: black\n   *    textSize(12);  // Adjust text size as needed\n   *\n   *   // Display the table data on the canvas\n   *   // Each cell is positioned based on its row and column\n   *   for (let r = 0; r < table.getRowCount(); r++) {\n   *     for (let c = 0; c < table.getColumnCount(); c++) {\n   *       let x = c * 50 + 10;  // Horizontal spacing for each column\n   *       let y = r * 30 + 20;  // Vertical spacing for each row\n   *       text(table.getString(r, c), x * c, y);\n   *     }\n   *   }\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  addRow (row) {\n  // make sure it is a valid TableRow\n    const r = row || new p5.TableRow();\n\n    if (typeof r.arr === 'undefined' || typeof r.obj === 'undefined') {\n    //r = new p5.prototype.TableRow(r);\n      throw new Error(`invalid TableRow: ${r}`);\n    }\n    r.table = this;\n    this.rows.push(r);\n    return r;\n  }\n\n  /**\n   * Removes a row from the table object.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param   {Integer} id ID number of the row to remove\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas and set a white background\n   *   createCanvas(200, 200);\n   *   background(255);\n   *\n   *   // Load the CSV file with a header row\n   *    table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Remove the first row from the table\n   *   table.removeRow(0);\n   *\n   *   // Set text properties for drawing on the canvas\n   *   fill(0);      // Set text color to black\n   *   textSize(12); // Adjust text size as needed\n   *\n   *   // Display the table values on the canvas:\n   *   // Each row's cell values are joined into a single string and drawn on a new line.\n   *   let y = 20; // Starting vertical position\n   *   for (let r = 0; r < table.getRowCount(); r++) {\n   *     let rowText = \"\";\n   *     for (let c = 0; c < table.getColumnCount(); c++) {\n   *       rowText += table.getString(r, c) + \" \";\n   *     }\n   *     text(rowText, 18, y * 3);\n   *     y += 20;\n   *   }\n   * \n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  removeRow (id) {\n    this.rows[id].table = null; // remove reference to table\n    const chunk = this.rows.splice(id + 1, this.rows.length);\n    this.rows.pop();\n    this.rows = this.rows.concat(chunk);\n  }\n\n  /**\n   * Returns a reference to the specified <a href=\"#/p5.TableRow\">p5.TableRow</a>. The reference\n   * can then be used to get and set values of the selected row.\n   *\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param  {Integer}   rowID ID number of the row to get\n   * @return {p5.TableRow} <a href=\"#/p5.TableRow\">p5.TableRow</a> object\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas\n   *   createCanvas(200, 200);\n   *   background(255); // Set background to white\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Get the row at index 1 (second row)\n   *   let row = table.getRow(1);\n   * \n   *   // Set text properties for drawing on the canvas\n   *   fill(0);      // Set text color to black\n   *   textSize(12); // Set the text size\n   *\n   *   // Loop over each column in the row and display its value on the canvas\n   *   for (let c = 0; c < table.getColumnCount(); c++) {\n   *     text(row.getString(c), 10, 20 + c * 50 + 20);\n   *   }\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  getRow (r) {\n    return this.rows[r];\n  }\n\n  /**\n   *  Gets all rows from the table. Returns an array of <a href=\"#/p5.TableRow\">p5.TableRow</a>s.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @return {p5.TableRow[]}   Array of <a href=\"#/p5.TableRow\">p5.TableRow</a>s\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas and set a white background\n   *   createCanvas(200, 200);\n   *   background(255);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   let rows = table.getRows();\n   *\n   *   // Warning: rows is an array of objects.\n   *   // Set the 'name' of each row to 'Unicorn'\n   *   for (let r = 0; r < rows.length; r++) {\n   *     rows[r].set('name', 'Unicorn');\n   *   }\n   *\n   *   // Set text properties\n   *   fill(0);      // Set text color to black\n   *   textSize(12); // Adjust text size as needed\n   *\n   *   // Display the modified table values on the canvas\n   *   // We'll join each row's values with a space and display each row on a new line.\n   *   let y = 20; // Starting y position\n   *   for (let r = 0; r < table.getRowCount(); r++) {\n   *     let rowText = \"\";\n   *     for (let c = 0; c < table.getColumnCount(); c++) {\n   *       rowText += table.getString(r, c) + \" \";\n   *     }\n   *     text(rowText, 10, y * 2);\n   *     y += 20; // Move to next line\n   *   }\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  getRows () {\n    return this.rows;\n  }\n\n  /**\n   *  Finds the first row in the Table that contains the value\n   *  provided, and returns a reference to that row. Even if\n   *  multiple rows are possible matches, only the first matching\n   *  row is returned. The column to search may be specified by\n   *  either its ID or title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param  {String} value  The value to match\n   *  @param  {Integer|String} column ID number or title of the\n   *                                 column to search\n   *  @return {p5.TableRow}\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 100x100 canvas\n   *   createCanvas(100, 100);\n   *   background(255); // Set background to white\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *    // Find the row with the animal named \"Zebra\"\n   *   let row = table.findRow('Zebra', 'name');\n   *\n   *   // Get the species from the found row\n   *   let species = row.getString('species');\n   *\n   *   // Set text properties and display the species on the canvas\n   *   fill(0);      // Set text color to black\n   *   textSize(12); // Adjust text size as needed\n   *   text(species, 10, 30);\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  findRow (value, column) {\n  // try the Object\n    if (typeof column === 'string') {\n      for (let i = 0; i < this.rows.length; i++) {\n        if (this.rows[i].obj[this.columns.indexOf(column)] === value) {\n          return this.rows[i];\n        }\n      }\n    } else {\n    // try the Array\n      for (let j = 0; j < this.rows.length; j++) {\n        if (this.rows[j].arr[column] === value) {\n          return this.rows[j];\n        }\n      }\n    }\n    // otherwise...\n    return null;\n  }\n\n  /**\n   *  Finds the rows in the Table that contain the value\n   *  provided, and returns references to those rows. Returns an\n   *  Array, so for must be used to iterate through all the rows,\n   *  as shown in the example above. The column to search may be\n   *  specified by either its ID or title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param  {String} value  The value to match\n   *  @param  {Integer|String} column ID number or title of the\n   *                                 column to search\n   *  @return {p5.TableRow[]}        An Array of TableRow objects\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas\n   *   createCanvas(200, 200);\n   *   background(255); // Set background to white\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Add another goat entry\n   *   let newRow = table.addRow();\n   *   newRow.setString('id', table.getRowCount() - 1);\n   *   newRow.setString('species', 'Scape Goat');\n   *   newRow.setString('name', 'Goat');\n   *\n   *   // Find rows where the name is \"Goat\"\n   *   let rows = table.findRows('Goat', 'name');\n   *\n   *   // Set text properties\n   *   fill(0);      // Set text color to black\n   *   textSize(12); // Adjust text size as needed\n   *\n   *   // Display the result on the canvas\n   *   text(rows.length + ' Goats found', 10, 30);\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  findRows (value, column) {\n    const ret = [];\n    if (typeof column === 'string') {\n      for (let i = 0; i < this.rows.length; i++) {\n        if (this.rows[i].obj[this.columns.indexOf(column)] === value) {\n          ret.push(this.rows[i]);\n        }\n      }\n    } else {\n    // try the Array\n      for (let j = 0; j < this.rows.length; j++) {\n        if (this.rows[j].arr[column] === value) {\n          ret.push(this.rows[j]);\n        }\n      }\n    }\n    return ret;\n  }\n\n  /**\n   * Finds the first row in the Table that matches the regular\n   * expression provided, and returns a reference to that row.\n   * Even if multiple rows are possible matches, only the first\n   * matching row is returned. The column to search may be\n   * specified by either its ID or title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param  {String|RegExp} regexp The regular expression to match\n   * @param  {String|Integer} column The column ID (number) or\n   *                                  title (string)\n   * @return {p5.TableRow}        TableRow object\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas\n   *   createCanvas(200, 200);\n   *   background(255); // Set background to white\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Search using the specified regex on column index 1 (species)\n   *   let mammal = table.matchRow(new RegExp('ant'), 1);\n   *   let species = mammal.getString(1);  // \"Panthera pardus\"\n   *\n   *   // Set text properties for drawing on the canvas\n   *   fill(0);       // Text color: black\n   *   textSize(12);  // Adjust text size as needed\n   *   \n   *   // Display the species on the canvas\n   *   text(species, 10, 30);\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  matchRow (regexp, column) {\n    if (typeof column === 'number') {\n      for (let j = 0; j < this.rows.length; j++) {\n        if (this.rows[j].arr[column].match(regexp)) {\n          return this.rows[j];\n        }\n      }\n    } else {\n      for (let i = 0; i < this.rows.length; i++) {\n        if (this.rows[i].obj[this.columns.indexOf(column)].match(regexp)) {\n          return this.rows[i];\n        }\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Finds the rows in the Table that match the regular expression provided,\n   * and returns references to those rows. Returns an array, so for must be\n   * used to iterate through all the rows, as shown in the example. The\n   * column to search may be specified by either its ID or title.\n   *\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param  {String} regexp The regular expression to match\n   * @param  {String|Integer} [column] The column ID (number) or\n   *                                  title (string)\n   * @return {p5.TableRow[]}          An Array of TableRow objects\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * function setup() {\n   *   // Create a 200x200 canvas and set a white background\n   *   createCanvas(200, 200);\n   *   background(255);\n   *\n   *   // Create a new p5.Table and add columns\n   *   table = new p5.Table();\n   *   table.addColumn('name');\n   *   table.addColumn('type');\n   *\n   *   // Add rows to the table\n   *    let newRow = table.addRow();\n   *   newRow.setString('name', 'Lion');\n   *    newRow.setString('type', 'Mammal');\n   *\n   *   newRow = table.addRow();\n   *   newRow.setString('name', 'Snake');\n   *   newRow.setString('type', 'Reptile');\n   *\n   *    newRow = table.addRow();\n   *   newRow.setString('name', 'Mosquito');\n   *   newRow.setString('type', 'Insect');\n   *\n   *   newRow = table.addRow();\n   *   newRow.setString('name', 'Lizard');\n   *   newRow.setString('type', 'Reptile');\n   *\n   *   // Search for rows where the \"type\" starts with \"R\"\n   *   let rows = table.matchRows('R.*', 'type');\n   *\n   *   // Set text properties for drawing on the canvas\n   *   fill(0);       // Text color: black\n   *   textSize(12);  // Text size\n   *\n   *   // Display each matching row on the canvas\n   *   let y = 20;\n   *   for (let i = 0; i < rows.length; i++) {\n   *     let output = rows[i].getString('name') + ': ' + rows[i].getString('type');\n   *     text(output, 10, y);\n   *     y += 20;\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  matchRows (regexp, column) {\n    const ret = [];\n    if (typeof column === 'number') {\n      for (let j = 0; j < this.rows.length; j++) {\n        if (this.rows[j].arr[column].match(regexp)) {\n          ret.push(this.rows[j]);\n        }\n      }\n    } else {\n      for (let i = 0; i < this.rows.length; i++) {\n        if (this.rows[i].obj[this.columns.indexOf(column)].match(regexp)) {\n          ret.push(this.rows[i]);\n        }\n      }\n    }\n    return ret;\n  }\n\n  /**\n   *  Retrieves all values in the specified column, and returns them\n   *  as an array. The column may be specified by either its ID or title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param  {String|Number} column String or Number of the column to return\n   *  @return {Array}       Array of column values\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * // Given the CSV file \"mammals.csv\"\n   * // in the project's \"assets\" folder:\n   * //\n   * // id,species,name\n   * // 0,Capra hircus,Goat\n   * // 1,Panthera pardus,Leopard\n   * // 2,Equus zebra,Zebra\n   *\n   * let table;\n   **\n   * async function setup() {\n   *   // The table is comma separated value \"csv\"\n   *   // and has a header specifying the columns labels.\n   *   table = await loadTable('assets/mammals.csv', 'csv', 'header');\n   *\n   *   //getColumn returns an array that can be printed directly\n   *   print(table.getColumn('species'));\n   *   //outputs [\"Capra hircus\", \"Panthera pardus\", \"Equus zebra\"]\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  getColumn (value) {\n    const ret = [];\n    if (typeof value === 'string') {\n      for (let i = 0; i < this.rows.length; i++) {\n        ret.push(this.rows[i].obj[this.columns.indexOf(value)]);    \n        }\n    } else {\n      for (let j = 0; j < this.rows.length; j++) {\n        ret.push(this.rows[j].arr[value]);\n      }\n    }\n    return ret;\n  }\n\n  /**\n   *  Removes all rows from a Table. While all rows are removed,\n   *  columns and column titles are maintained.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Given the CSV file \"mammals.csv\"\n   * // in the project's \"assets\" folder:\n   * //\n   * // id,species,name\n   * // 0,Capra hircus,Goat\n   * // 1,Panthera pardus,Leopard\n   * // 2,Equus zebra,Zebra\n   *\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas\n   *   createCanvas(200, 200);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n  *\n   *   // Clear all rows from the table\n   *   table.clearRows();\n   *\n   *   // Set text properties\n   *   fill(0);       // Text color: black\n   *   textSize(12);  // Adjust text size as needed\n   *\n   *   // Display the number of rows and columns on the canvas\n   *   text(table.getRowCount() + ' total rows in table', 10, 30);\n   *   text(table.getColumnCount() + ' total columns in table', 10, 60);\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  clearRows () {\n    delete this.rows;\n    this.rows = [];\n  }\n\n  /**\n   *  Use <a href=\"/reference/p5.Table/addColumn/\">addColumn()</a> to add a new column to a <a href=\"#/p5.Table\">Table</a> object.\n   *  Typically, you will want to specify a title, so the column\n   *  may be easily referenced later by name. (If no title is\n   *  specified, the new column's title will be null.)\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param {String} [title] title of the given column\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   createCanvas(300, 300);\n   *   table = await loadTable('/assets/mammals.csv', ',', 'header');\n   *\n   *   table.addColumn('carnivore');\n   *   table.set(0, 'carnivore', 'no');\n   *   table.set(1, 'carnivore', 'yes');\n   *   table.set(2, 'carnivore', 'no');\n   *\n   *   fill(0);      // Set text color to black\n   *   textSize(11); // Adjust text size as needed\n   *\n   *   for (let r = 0; r < table.getRowCount(); r++) {\n   *     for (let c = 0; c < table.getColumnCount(); c++) {\n   *       // Keep column spacing consistent (e.g. 80 pixels apart).\n   *       let x = c * 80 + 10;\n   *       let y = r * 30 + 20;\n   *       // Use x directly, rather than multiplying by c again\n   *       text(table.getString(r, c), x, y);\n   *     }\n   *   }\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  addColumn (title) {\n    const t = title || null;\n    this.columns.push(t);\n  }\n\n  /**\n   *  Returns the total number of columns in a Table.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @return {Integer} Number of columns in this table\n   * @example\n   * <div>\n   * <code>\n   * // given the cvs file \"blobs.csv\" in /assets directory\n   * // ID, Name, Flavor, Shape, Color\n   * // Blob1, Blobby, Sweet, Blob, Pink\n   * // Blob2, Saddy, Savory, Blob, Blue\n   *\n   * let table;\n   *\n   * async function setup() {\n   *   table = await loadTable('assets/blobs.csv');\n   *\n   *   createCanvas(200, 100);\n   *   textAlign(CENTER);\n   *   background(255);\n   * }\n   *\n   * function draw() {\n   *   let numOfColumn = table.getColumnCount();\n   *   text('There are ' + numOfColumn + ' columns in the table.', 100, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  getColumnCount () {\n    return this.columns.length;\n  }\n\n  /**\n   *  Returns the total number of rows in a Table.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @return {Integer} Number of rows in this table\n   * @example\n   * <div>\n   * <code>\n   * // given the cvs file \"blobs.csv\" in /assets directory\n   * //\n   * // ID, Name, Flavor, Shape, Color\n   * // Blob1, Blobby, Sweet, Blob, Pink\n   * // Blob2, Saddy, Savory, Blob, Blue\n   *\n   * let table;\n   *\n   * async function setup() {\n   *   table = await loadTable('assets/blobs.csv');\n   *\n   *   createCanvas(200, 100);\n   *   textAlign(CENTER);\n   *   background(255);\n   * }\n   *\n   * function draw() {\n   *   text('There are ' + table.getRowCount() + ' rows in the table.', 100, 50);\n   * }\n   * </code>\n   * </div>\n   */\n  getRowCount () {\n    return this.rows.length;\n  }\n\n  /**\n   *  Removes any of the specified characters (or \"tokens\").\n   *\n   *  If no column is specified, then the values in all columns and\n   *  rows are processed. A specific column may be referenced by\n   *  either its ID or title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param  {String} chars  String listing characters to be removed\n   *  @param  {String|Integer} [column] Column ID (number)\n   *                                   or name (string)\n   *\n   * @example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *   let table = new p5.Table();\n   *\n   *   table.addColumn('name');\n   *   table.addColumn('type');\n   *\n   *   let newRow = table.addRow();\n   *   newRow.setString('name', '   $Lion  ,');\n   *   newRow.setString('type', ',,,Mammal');\n   *\n   *   newRow = table.addRow();\n   *   newRow.setString('name', '$Snake  ');\n   *   newRow.setString('type', ',,,Reptile');\n   *\n   *   table.removeTokens(',$ ');\n   *   print(table.getArray());\n   * }\n   *\n   * // prints:\n   * //  0  \"Lion\"   \"Mamal\"\n   * //  1  \"Snake\"  \"Reptile\"\n   * </code></div>\n   */\n  removeTokens (chars, column) {\n    const escape = s => s.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n    const charArray = [];\n    for (let i = 0; i < chars.length; i++) {\n      charArray.push(escape(chars.charAt(i)));\n    }\n    const regex = new RegExp(charArray.join('|'), 'g');\n\n    if (typeof column === 'undefined') {\n      for (let c = 0; c < this.columns.length; c++) {\n        for (let d = 0; d < this.rows.length; d++) {\n          let s = this.rows[d].arr[c];\n          s = s.replace(regex, '');\n          this.rows[d].arr[c] = s;\n          this.rows[d].obj[this.columns[c]] = s;\n        }\n      }\n    } else if (typeof column === 'string') {\n      for (let j = 0; j < this.rows.length; j++) {\n        let val = this.rows[j].obj[column];\n        val = val.replace(regex, '');\n        this.rows[j].obj[column] = val;\n        const pos = this.columns.indexOf(column);\n        this.rows[j].arr[pos] = val;\n      }\n    } else {\n      for (let k = 0; k < this.rows.length; k++) {\n        let str = this.rows[k].arr[column];\n        str = str.replace(regex, '');\n        this.rows[k].arr[column] = str;\n        this.rows[k].obj[this.columns[column]] = str;\n      }\n    }\n  }\n\n  /**\n   *  Trims leading and trailing whitespace, such as spaces and tabs,\n   *  from String table values. If no column is specified, then the\n   *  values in all columns and rows are trimmed. A specific column\n   *  may be referenced by either its ID or title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param  {String|Integer} [column] Column ID (number)\n   *                                   or name (string)\n   * @example\n   * <div class=\"norender\"><code>\n   * function setup() {\n   *   let table = new p5.Table();\n   *\n   *   table.addColumn('name');\n   *   table.addColumn('type');\n   *\n   *   let newRow = table.addRow();\n   *   newRow.setString('name', '   Lion  ,');\n   *   newRow.setString('type', ' Mammal  ');\n   *\n   *   newRow = table.addRow();\n   *   newRow.setString('name', '  Snake  ');\n   *   newRow.setString('type', '  Reptile  ');\n   *\n   *   table.trim();\n   *   print(table.getArray());\n   * }\n   *\n   * // prints:\n   * //  0  \"Lion\"   \"Mamal\"\n   * //  1  \"Snake\"  \"Reptile\"\n   * </code></div>\n   */\n  trim (column) {\n    const regex = new RegExp(' ', 'g');\n\n    if (typeof column === 'undefined') {\n      for (let c = 0; c < this.columns.length; c++) {\n        for (let d = 0; d < this.rows.length; d++) {\n          let s = this.rows[d].arr[c];\n          s = s.replace(regex, '');\n          this.rows[d].arr[c] = s;\n          this.rows[d].obj[this.columns[c]] = s;\n        }\n      }\n    } else if (typeof column === 'string') {\n      for (let j = 0; j < this.rows.length; j++) {\n        let val = this.rows[j].obj[column];\n        val = val.replace(regex, '');\n        this.rows[j].obj[column] = val;\n        const pos = this.columns.indexOf(column);\n        this.rows[j].arr[pos] = val;\n      }\n    } else {\n      for (let k = 0; k < this.rows.length; k++) {\n        let str = this.rows[k].arr[column];\n        str = str.replace(regex, '');\n        this.rows[k].arr[column] = str;\n        this.rows[k].obj[this.columns[column]] = str;\n      }\n    }\n  }\n\n  /**\n   *  Use <a href=\"/reference/p5.Table/removeColumn/\">removeColumn()</a> to remove an existing column from a Table\n   *  object. The column to be removed may be identified by either\n   *  its title (a String) or its index value (an int).\n   *  removeColumn(0) would remove the first column, removeColumn(1)\n   *  would remove the second column, and so on.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param  {String|Integer} column columnName (string) or ID (number)\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 100x100 canvas\n   *   createCanvas(100, 100);\n   *   background(255); // Set background to white\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *    // Remove the \"id\" column\n   *    table.removeColumn('id');\n   *\n   *   // Get the remaining column count\n   *   let colCount = table.getColumnCount();\n   *\n   *   // Set text properties\n   *   fill(0);      // Text color: black\n   *   textSize(12); // Adjust text size as needed\n   *\n   *   // Display the column count on the canvas\n   *   text(colCount, 40, 50);\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  removeColumn (c) {\n    let cString;\n    let cNumber;\n    if (typeof c === 'string') {\n    // find the position of c in the columns\n      cString = c;\n      cNumber = this.columns.indexOf(c);\n    } else {\n      cNumber = c;\n      cString = this.columns[c];\n    }\n\n    const chunk = this.columns.splice(cNumber + 1, this.columns.length);\n    this.columns.pop();\n    this.columns = this.columns.concat(chunk);\n\n    for (let i = 0; i < this.rows.length; i++) {\n      const tempR = this.rows[i].arr;\n      const chip = tempR.splice(cNumber + 1, tempR.length);\n      tempR.pop();\n      this.rows[i].arr = tempR.concat(chip);\n      delete this.rows[i].obj[cString];\n    }\n  }\n\n  /**\n   * Stores a value in the Table's specified row and column.\n   * The row is specified by its ID, while the column may be specified\n   * by either its ID or title.\n   *\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param {Integer} row row ID\n   * @param {String|Integer} column column ID (Number)\n   *                               or title (String)\n   * @param {String|Number} value  value to assign\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas and set a white background\n   *   createCanvas(200, 200);\n   *   background(255);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Update the first row: change species to \"Canis Lupus\" and name to \"Wolf\"\n   *   table.set(0, 'species', 'Canis Lupus');\n   *   table.set(0, 'name', 'Wolf');\n   *\n   *   // Set text properties for drawing on the canvas\n   *   fill(0);      // Text color: black\n   *    textSize(12); // Adjust text size as needed\n   *\n   *   // Display the table values on the canvas:\n   *   // Each row's values are concatenated into a single string and displayed on a new line.\n   *   let y = 20; // Starting vertical position\n   *   for (let r = 0; r < table.getRowCount(); r++) {\n   *     let rowText = \"\";\n   *     for (let c = 0; c < table.getColumnCount(); c++) {\n   *       rowText += table.getString(r, c) + \" \";\n   *     }\n   *     text(rowText, 10, y * 2.5);\n   *     y += 20;\n   *   }\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  set (row, column, value) {\n    this.rows[row].set(column, value);\n  }\n\n  /**\n   * Stores a Float value in the Table's specified row and column.\n   * The row is specified by its ID, while the column may be specified\n   * by either its ID or title.\n   *\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param {Integer} row row ID\n   * @param {String|Integer} column column ID (Number)\n   *                               or title (String)\n   * @param {Number} value  value to assign\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 100x100 canvas and set a white background\n   *   createCanvas(100, 100);\n   *   background(255);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Set the value in row 1, column \"id\" to the number 1\n   *   table.setNum(1, 'id', 1);\n   *\n   *   // Get the first column as an array and join its values into a string for display.\n   *   let col0 = table.getColumn(0);  // Expected output: [\"0\", 1, \"2\"]\n   *   let output = col0.join(\", \");\n   *\n   *   // Set text properties and display the output on the canvas\n   *   fill(0);      // Text color: black\n   *   textSize(12); // Adjust text size as needed\n   *   text(output, 30, 50);\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  setNum (row, column, value) {\n    this.rows[row].setNum(column, value);\n  }\n\n  /**\n   * Stores a String value in the Table's specified row and column.\n   * The row is specified by its ID, while the column may be specified\n   * by either its ID or title.\n   *\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param {Integer} row row ID\n   * @param {String|Integer} column column ID (Number)\n   *                               or title (String)\n   * @param {String} value  value to assign\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas and set a white background\n   *   createCanvas(200, 200);\n   *   background(255);\n   *\n   *   // Load the CSV file from the assets folder with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Add a new row with the new animal data\n   *   let newRow = table.addRow();\n   *   newRow.setString('id', table.getRowCount() - 1);\n   *   newRow.setString('species', 'Canis Lupus');\n   *   newRow.setString('name', 'Wolf');\n   *\n   *   // Convert the table to a 2D array\n   *   let tableArray = table.getArray();\n   *\n   *   // Set text properties\n   *   fill(0);       // Set text color to black\n   *   textSize(12);  // Adjust text size as needed\n   *\n   *   // Display each row of the table on the canvas\n   *   let y = 20;  // Starting y position\n   *   for (let i = 0; i < tableArray.length; i++) {\n   *     // Join the values of each row with a comma separator\n   *     let rowText = tableArray[i].join(', ');\n   *     text(rowText, 15, y * 2);\n   *     y += 20;  // Increment y position for the next row\n   *   }\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  setString (row, column, value) {\n    this.rows[row].setString(column, value);\n  }\n\n  /**\n   * Retrieves a value from the Table's specified row and column.\n   * The row is specified by its ID, while the column may be specified by\n   * either its ID or title.\n   *\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param {Integer} row row ID\n   * @param  {String|Integer} column columnName (string) or\n   *                                   ID (number)\n   * @return {String|Number}\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 100x100 canvas\n   *   createCanvas(100, 100);\n   *   background(255); // Set background to white\n   *\n   *   // Load the CSV file from the assets folder with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Set text properties for drawing on the canvas\n   *   fill(0);      // Text color: black\n   *   textSize(12); // Adjust text size as needed\n   *\n   *   // Get the values from the table\n   *   let value1 = table.get(0, 1);       // Using column index (1) => \"Capra hircus\"\n   *   let value2 = table.get(0, 'species'); // Using column name => \"Capra hircus\"\n   *\n   *   // Display the values on the canvas\n   *   text(value1, 10, 30);\n   *   text(value2, 10, 60);\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  get (row, column) {\n    if(typeof column === 'string'){\n      return this.rows[row].get(this.columns.indexOf(column));\n    } else {\n      return this.rows[row].get(column);\n    }\n  }\n\n  /**\n   * Retrieves a Float value from the Table's specified row and column.\n   * The row is specified by its ID, while the column may be specified by\n   * either its ID or title.\n   *\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param {Integer} row row ID\n   * @param  {String|Integer} column columnName (string) or\n   *                                   ID (number)\n   * @return {Number}\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 100x100 canvas\n   *   createCanvas(100, 100);\n   *   background(255); // Set background to white\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Compute the result: id at row 1, column 0 plus 100 (i.e. 1 + 100 = 101)\n   *   let result = table.getNum(1, 0) + 100;\n   *   \n   *   // Set text properties and display the result on the canvas\n   *   fill(0);      // Set text color to black\n   *   textSize(12); // Adjust text size as needed\n   *   text(result, 10, 30);  // Display the result at position (10, 30)\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  getNum (row, column) {\n    return this.rows[row].getNum(column);\n  }\n\n  /**\n   * Retrieves a String value from the Table's specified row and column.\n   * The row is specified by its ID, while the column may be specified by\n   * either its ID or title.\n   *\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param {Integer} row row ID\n   * @param  {String|Integer} column columnName (string) or\n   *                                   ID (number)\n   * @return {String}\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas\n   *   createCanvas(200, 200);\n   *   background(255); // Set background to white\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Set text properties\n   *   fill(0);      // Text color: black\n   *   textSize(12); // Adjust text size as needed\n   *\n   *   // Display each table cell value on the canvas one below the other.\n   *   // We use a variable 'y' to increment the vertical position.\n   *   let y = 20;\n   *   text(table.getString(0, 0), 10, y); // 0\n   *   y += 20;\n   *   text(table.getString(0, 1), 10, y); // Capra hircus\n   *   y += 20;\n   *   text(table.getString(0, 2), 10, y); // Goat\n   *   y += 20;\n   *   text(table.getString(1, 0), 10, y); // 1\n   *   y += 20;\n   *   text(table.getString(1, 1), 10, y); // Panthera pardus\n   *   y += 20;\n   *   text(table.getString(1, 2), 10, y); // Leopard\n   *   y += 20;\n   *   text(table.getString(2, 0), 10, y); // 2\n   *   y += 20;\n   *   text(table.getString(2, 1), 10, y); // Equus zebra\n   *   y += 20;\n   *   text(table.getString(2, 2), 10, y); // Zebra\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  getString (row, column) {\n    return this.rows[row].getString(column);\n  }\n\n  /**\n   * Retrieves all table data and returns as an object. If a column name is\n   * passed in, each row object will be stored with that attribute as its\n   * title.\n   *\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param {String} [headerColumn] Name of the column which should be used to\n   *                              title each row object (optional)\n   * @return {Object}\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * // Given the CSV file \"mammals.csv\"\n   * // in the project's \"assets\" folder:\n   * //\n   * // id,species,name\n   * // 0,Capra hircus,Goat\n   * // 1,Panthera pardus,Leopard\n   * // 2,Equus zebra,Zebra\n   *\n   * let table;\n   *\n   * async function setup() {\n   *   // The table is comma separated value \"csv\"\n   *   // and has a header specifying the columns labels.\n   *   table = await loadTable('assets/mammals.csv', 'csv', 'header');\n   *\n   *   let tableObject = table.getObject();\n   *\n   *   print(tableObject);\n   *   //outputs an object\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  getObject (headerColumn) {\n    const tableObject = {};\n    let obj, cPos, index;\n\n    for (let i = 0; i < this.rows.length; i++) {\n      obj = this.rows[i].obj;\n\n      if (typeof headerColumn === 'string') {\n        cPos = this.columns.indexOf(headerColumn); // index of columnID\n        if (cPos >= 0) {\n          index = obj[headerColumn];\n          tableObject[index] = obj;\n        } else {\n          throw new Error(`This table has no column named \"${headerColumn}\"`);\n        }\n      } else {\n        tableObject[i] = this.rows[i].obj;\n      }\n    }\n    return tableObject;\n  }\n\n  /**\n   * Retrieves all table data and returns it as a multidimensional array.\n   *\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @return {Array}\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas and set a white background\n   *   createCanvas(200, 200);\n   *   background(255);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Get the CSV data as a 2D array\n   *   let tableArray = table.getArray();\n   *\n   *   // Set text properties\n   *   fill(0);      // Set text color to black\n   *   textSize(12); // Adjust text size as needed\n   *\n   *   // Display each row of the CSV on the canvas\n   *   // Each row is displayed on a separate line\n   *   for (let i = 0; i < tableArray.length; i++) {\n   *     let rowText = tableArray[i].join(\", \");\n   *     text(rowText, 10, 20 + i * 50 + 30);\n   *   }\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  getArray () {\n    const tableArray = [];\n    for (let i = 0; i < this.rows.length; i++) {\n      tableArray.push(this.rows[i].arr);\n    }\n    return tableArray;\n  }\n}\nfunction table(p5, fn){\n  /**\n   *  Table Options\n   *  Generic class for handling tabular data, typically from a\n   *  CSV, TSV, or other sort of spreadsheet file.\n   *  CSV files are\n   *  <a href=\"http://en.wikipedia.org/wiki/Comma-separated_values\">\n   *  comma separated values</a>, often with the data in quotes. TSV\n   *  files use tabs as separators, and usually don't bother with the\n   *  quotes.\n   *  File names should end with .csv if they're comma separated.\n   *  A rough \"spec\" for CSV can be found\n   *  <a href=\"http://tools.ietf.org/html/rfc4180\">here</a>.\n   *  To load files, use the <a href=\"#/p5/loadTable\">loadTable</a> method.\n   *  To save tables to your computer, use the <a href=\"#/p5/save\">save</a> method\n   *   or the <a href=\"#/p5/saveTable\">saveTable</a> method.\n   *\n   *  Possible options include:\n   *  <ul>\n   *  <li>csv - parse the table as comma-separated values\n   *  <li>tsv - parse the table as tab-separated values\n   *  <li>header - this table has a header (title) row\n   *  </ul>\n   */\n\n  /**\n   *  <a href=\"#/p5.Table\">Table</a> objects store data with multiple rows and columns, much\n   *  like in a traditional spreadsheet. Tables can be generated from\n   *  scratch, dynamically, or using data from an existing file.\n   *\n   *  @class p5.Table\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param  {p5.TableRow[]}     [rows] An array of p5.TableRow objects\n   */\n  p5.Table = Table;\n\n  /**\n   * An array containing the names of the columns in the table, if the \"header\" the table is\n   * loaded with the \"header\" parameter.\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @type {String[]}\n   * @property columns\n   * @for p5.Table\n   * @name columns\n   * @example\n   * <div >\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas\n   *   createCanvas(200, 200);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Set text properties for drawing on the canvas\n   *   fill(0);       // Set text color to black\n   *   textSize(12);  // Adjust text size as needed\n   *\n   *   // Display the column names on the canvas\n   *   for (let c = 0; c < table.getColumnCount(); c++) {\n   *     text('column ' + c + ' is named ' + table.columns[c], 10, 30 + c * 20);\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * An array containing the <a href=\"#/p5.Table\">p5.TableRow</a> objects that make up the\n   * rows of the table. The same result as calling <a href=\"/reference/p5.Table/getRows/\">getRows()</a>\n   * @type {p5.TableRow[]}\n   * @property rows\n   * @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @for p5.Table\n   * @name rows\n  */\n}\n\nif(typeof p5 !== 'undefined'){\n  table(p5, p5.prototype);\n}\n\nexport { table as default };\n","/**\n * @module IO\n * @submodule Table\n * @requires core\n */\n\nclass TableRow {\n  constructor(row=[]){\n    let arr = row;\n\n    this.arr = arr;\n    this.obj = Object.fromEntries(arr.entries());\n    this.table = null;\n  }\n\n  /**\n   *  Stores a value in the TableRow's specified column.\n   *  The column may be specified by either its ID or title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param {String|Integer} column Column ID (Number)\n   *                                or Title (String)\n   *  @param {String|Number} value  The value to be stored\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas and set a white background\n   *   createCanvas(200, 200);\n   *   background(255);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Set every row's \"name\" to \"Unicorn\"\n   *    let rows = table.getRows();\n   *   for (let r = 0; r < rows.length; r++) {\n   *     rows[r].set('name', 'Unicorn');\n   *   }\n   *\n   *   // Convert the table to an array\n   *   let tableArray = table.getArray();\n   *\n   *   // Set text properties\n   *   fill(0);      // Set text color to black\n   *   textSize(12); // Set text size\n   *\n   *   // Display each row of the table on the canvas\n   *   let y = 20; // Starting y position\n   *   for (let i = 0; i < tableArray.length; i++) {\n   *     let rowText = tableArray[i].join(', ');\n   *     text(rowText, 10, y * 2.5);\n   *     y += 20; // Increment y position for the next row\n   *   }\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  set(column, value) {\n  // if typeof column is string, use .obj\n    if (typeof column === 'string') {\n      const cPos = this.table.columns.indexOf(column); // index of columnID\n      if (cPos >= 0) {\n        this.obj[column] = value;\n        this.arr[cPos] = value;\n      } else {\n        throw new Error(`This table has no column named \"${column}\"`);\n      }\n    } else {\n    // if typeof column is number, use .arr\n      if (column < this.table.columns.length) {\n        this.arr[column] = value;\n        const cTitle = this.table.columns[column];\n        this.obj[cTitle] = value;\n      } else {\n        throw new Error(`Column #${column} is out of the range of this table`);\n      }\n    }\n  }\n\n  /**\n   *  Stores a Float value in the TableRow's specified column.\n   *  The column may be specified by either its ID or title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param {String|Integer} column Column ID (Number)\n   *                                or Title (String)\n   *  @param {Number|String} value  The value to be stored\n   *                                as a Float\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x200 canvas and set a white background\n   *   createCanvas(200, 200);\n   *   background(255);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Update each row's \"id\" to (row index + 10)\n   *   let rows = table.getRows();\n   *   for (let r = 0; r < rows.length; r++) {\n   *     rows[r].setNum('id', r + 10);\n   *   }\n   *\n   *   // Convert the table to a 2D array for display\n   *   let tableArray = table.getArray();\n   *\n   *   // Set text properties\n   *   fill(0);      // Text color: black\n   *   textSize(12); // Adjust text size as needed\n   *\n   *   // Display each row of the table on the canvas\n   *   let y = 20;   // Starting y position\n   *   for (let i = 0; i < tableArray.length; i++) {\n   *     // Join each row's values with a comma separator\n   *     let rowText = tableArray[i].join(', ');\n   *     text(rowText, 10, y * 2.5);\n   *     y += 20;  // Increment y for the next row\n   *   }\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  setNum(column, value) {\n    const floatVal = parseFloat(value);\n    this.set(column, floatVal);\n  }\n\n  /**\n   *  Stores a String value in the TableRow's specified column.\n   *  The column may be specified by either its ID or title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param {String|Integer} column Column ID (Number)\n   *                                or Title (String)\n   *  @param {String|Number|Boolean|Object} value  The value to be stored\n   *                                as a String\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 300x200 canvas and set a white background\n   *   createCanvas(300, 200);\n   *   background(255);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Update each row's \"name\" field\n   *   let rows = table.getRows();\n   *   for (let r = 0; r < rows.length; r++) {\n   *     let name = rows[r].getString('name');\n   *     rows[r].setString('name', 'A ' + name + ' named George');\n   *   }\n   *\n   *   // Convert the table to a 2D array for display\n   *   let tableArray = table.getArray();\n   *\n   *   // Set text properties\n   *   fill(0);      // Text color: black\n   *   textSize(12); // Adjust text size as needed\n   *\n   *   // Display each row of the table on the canvas\n   *   let y = 20;   // Starting y position\n   *   for (let i = 0; i < tableArray.length; i++) {\n   *     let rowText = tableArray[i].join(', ');\n   *     text(rowText, 10, y * 2.5);\n   *     y += 20;    // Increment y for the next row\n   *   }\n   *\n   *   // describe('no image displayed');\n   * }\n   * </code>\n   */\n  setString(column, value) {\n    const stringVal = value.toString();\n    this.set(column, stringVal);\n  }\n\n  /**\n   *  Retrieves a value from the TableRow's specified column.\n   *  The column may be specified by either its ID or title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param  {String|Integer} column columnName (string) or\n   *                                   ID (number)\n   *  @return {String|Number}\n   *\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x100 canvas and set a white background\n   *   createCanvas(200, 100);\n   *   background(255);\n   *\n   *   // Load the CSV file with a header row\n   *    table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   // Extract the names from each row and store them in an array\n   *   let names = [];\n   *   let rows = table.getRows();\n   *   for (let r = 0; r < rows.length; r++) {\n   *     names.push(rows[r].get('name'));\n   *   }\n   *\n   *   // Set text properties and display the names on the canvas\n   *   fill(0);      // Set text color to black\n   *   textSize(12); // Set text size\n   *\n   *   // Join names into a single string separated by commas\n   *   let namesText = names.join(', ');\n   *   text(namesText, 35, 50);\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  get(column) {\n    if (typeof column === 'string') {\n      return this.obj[this.table.columns.indexOf(column)];\n    } else {\n      return this.arr[column];\n    }\n  }\n\n  /**\n   *  Retrieves a Float value from the TableRow's specified\n   *  column. The column may be specified by either its ID or\n   *  title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @param  {String|Integer} column columnName (string) or\n   *                                   ID (number)\n   *  @return {Number}  Float Floating point number\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 300x100 canvas and set a white background\n   *   createCanvas(300, 100);\n   *   background(255);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   let rows = table.getRows();\n   *   let minId = Infinity;\n   *   let maxId = -Infinity;\n   *   \n   *   for (let r = 0; r < rows.length; r++) {\n   *     let id = rows[r].getNum('id');\n   *     minId = min(minId, id);\n   *     maxId = max(maxId, id);\n   *    }\n   * \n   *   let result = 'minimum id = ' + minId + ', maximum id = ' + maxId;\n   *\n   *   // Set text properties and display the result on the canvas\n   *   fill(0);      // Set text color to black\n   *   textSize(12); // Set text size\n   *   text(result, 10, 50);\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  getNum(column) {\n    let ret;\n    if (typeof column === 'string') {\n      ret = parseFloat(this.obj[this.table.columns.indexOf(column)]);\n    } else {\n      ret = parseFloat(this.arr[column]);\n    }\n\n    if (ret.toString() === 'NaN') {\n      throw `Error: ${this.obj[column]} is NaN (Not a Number)`;\n    }\n    return ret;\n  }\n\n  /**\n   *  Retrieves an String value from the TableRow's specified\n   *  column. The column may be specified by either its ID or\n   *  title.\n   *\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n\n   *  @param  {String|Integer} column columnName (string) or\n   *                                   ID (number)\n   *  @return {String}  String\n   * @example\n   * <div>\n   * <code>\n   * let table;\n   *\n   * async function setup() {\n   *   // Create a 200x100 canvas and set a white background\n   *   createCanvas(200, 100);\n   *   background(255);\n   *\n   *   // Load the CSV file with a header row\n   *   table = await loadTable('assets/mammals.csv', ',', 'header');\n   *\n   *   let rows = table.getRows();\n   *   let longest = '';\n   *   for (let r = 0; r < rows.length; r++) {\n   *      let species = rows[r].getString('species');\n   *      if (longest.length < species.length) {\n   *       longest = species;\n   *     }\n   *   }\n   *\n   *   let result = 'longest: ' + longest;\n   *\n   *   // Set text properties and display the result on the canvas\n   *   fill(0);      // Set text color to black\n   *   textSize(12); // Set text size\n   *   text(result, 30, 50);\n   *\n   *   describe('no image displayed');\n   * }\n   * </code>\n   * </div>\n   */\n  getString(column) {\n    if (typeof column === 'string') {\n      return this.obj[this.table.columns.indexOf(column)].toString();\n    } else {\n      return this.arr[column].toString();\n    }\n  }\n}\nfunction tableRow(p5, fn){\n  /**\n   *  A TableRow object represents a single row of data values,\n   *  stored in columns, from a table.\n   *\n   *  A Table Row contains both an ordered array, and an unordered\n   *  JSON object.\n   *\n   *  @class p5.TableRow\n   *  @deprecated p5.Table will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   *  @constructor\n   *  @param {any[]} row         optional: populate the row with an\n   *                              array of values\n   */\n  p5.TableRow = TableRow;\n}\n\nif(typeof p5 !== 'undefined'){\n  tableRow(p5, p5.prototype);\n}\n\nexport { tableRow as default };\n","/**\n * @module Math\n * @submodule Calculation\n * @for p5\n * @requires core\n */\n\nfunction calculation(p5, fn){\n  /**\n   * Calculates the absolute value of a number.\n   *\n   * A number's absolute value is its distance from zero on the number line.\n   * -5 and 5 are both five units away from zero, so calling `abs(-5)` and\n   * `abs(5)` both return 5. The absolute value of a number is always positive.\n   *\n   * @method abs\n   * @param  {Number} n number to compute.\n   * @return {Number}   absolute value of given number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A gray square with a vertical black line that divides it in half. A white rectangle gets taller when the user moves the mouse away from the line.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Divide the canvas.\n   *   line(50, 0, 50, 100);\n   *\n   *   // Calculate the mouse's distance from the middle.\n   *   let h = abs(mouseX - 50);\n   *\n   *   // Draw a rectangle based on the mouse's distance\n   *   // from the middle.\n   *   rect(0, 100 - h, 100, h);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.abs = Math.abs;\n\n  /**\n   * Calculates the closest integer value that is greater than or equal to a\n   * number.\n   *\n   * For example, calling `ceil(9.03)` and `ceil(9.97)` both return the value\n   * 10.\n   *\n   * @method ceil\n   * @param  {Number} n number to round up.\n   * @return {Integer}   rounded up number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Use RGB color with values from 0 to 1.\n   *   colorMode(RGB, 1);\n   *\n   *   noStroke();\n   *\n   *   // Draw the left rectangle.\n   *   let r = 0.3;\n   *   fill(r, 0, 0);\n   *   rect(0, 0, 50, 100);\n   *\n   *   // Round r up to 1.\n   *   r = ceil(r);\n   *\n   *   // Draw the right rectangle.\n   *   fill(r, 0, 0);\n   *   rect(50, 0, 50, 100);\n   *\n   *   describe('Two rectangles. The one on the left is dark red and the one on the right is bright red.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.ceil = Math.ceil;\n\n  /**\n   * Constrains a number between a minimum and maximum value.\n   *\n   * @method constrain\n   * @param  {Number} n    number to constrain.\n   * @param  {Number} low  minimum limit.\n   * @param  {Number} high maximum limit.\n   * @return {Number}      constrained number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A black dot drawn on a gray square follows the mouse from left to right. Its movement is constrained to the middle third of the square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   let x = constrain(mouseX, 33, 67);\n   *   let y = 50;\n   *\n   *   strokeWeight(5);\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Two vertical lines. Two circles move horizontally with the mouse. One circle stops at the vertical lines.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Set boundaries and draw them.\n   *   let leftWall = 25;\n   *   let rightWall = 75;\n   *   line(leftWall, 0, leftWall, 100);\n   *   line(rightWall, 0, rightWall, 100);\n   *\n   *   // Draw a circle that follows the mouse freely.\n   *   fill(255);\n   *   circle(mouseX, 33, 9);\n   *\n   *   // Draw a circle that's constrained.\n   *   let xc = constrain(mouseX, leftWall, rightWall);\n   *   fill(0);\n   *   circle(xc, 67, 9);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.constrain = function(n, low, high) {\n    // p5._validateParameters('constrain', arguments);\n    return Math.max(Math.min(n, high), low);\n  };\n\n  /**\n   * Calculates the distance between two points.\n   *\n   * The version of `dist()` with four parameters calculates distance in two\n   * dimensions.\n   *\n   * The version of `dist()` with six parameters calculates distance in three\n   * dimensions.\n   *\n   * Use <a href=\"#/p5.Vector/dist\">p5.Vector.dist()</a> to calculate the\n   * distance between two <a href=\"#/p5.Vector\">p5.Vector</a> objects.\n   *\n   * @method dist\n   * @param  {Number} x1 x-coordinate of the first point.\n   * @param  {Number} y1 y-coordinate of the first point.\n   * @param  {Number} x2 x-coordinate of the second point.\n   * @param  {Number} y2 y-coordinate of the second point.\n   * @return {Number}    distance between the two points.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the coordinates.\n   *   let x1 = 10;\n   *   let y1 = 50;\n   *   let x2 = 90;\n   *   let y2 = 50;\n   *\n   *   // Draw the points and a line connecting them.\n   *   line(x1, y1, x2, y2);\n   *   strokeWeight(5);\n   *   point(x1, y1);\n   *   point(x2, y2);\n   *\n   *   // Calculate the distance.\n   *   let d = dist(x1, y1, x2, y2);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the distance.\n   *   text(d, 43, 40);\n   *\n   *   describe('Two dots connected by a horizontal line. The number 80 is written above the center of the line.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method dist\n   * @param  {Number} x1\n   * @param  {Number} y1\n   * @param  {Number} z1 z-coordinate of the first point.\n   * @param  {Number} x2\n   * @param  {Number} y2\n   * @param  {Number} z2 z-coordinate of the second point.\n   * @return {Number}    distance between the two points.\n   */\n  fn.dist = function(...args) {\n    // p5._validateParameters('dist', args);\n    if (args.length === 4) {\n      //2D\n      return Math.hypot(args[2] - args[0], args[3] - args[1]);\n    } else if (args.length === 6) {\n      //3D\n      return Math.hypot(\n        args[3] - args[0], args[4] - args[1], args[5] - args[2]\n      );\n    }\n  };\n\n  /**\n   * Calculates the value of Euler's number e (2.71828...) raised to the power\n   * of a number.\n   *\n   * @method exp\n   * @param  {Number} n exponent to raise.\n   * @return {Number}   e^n\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top-left.\n   *   let d = exp(1);\n   *   circle(10, 10, d);\n   *\n   *   // Left-center.\n   *   d = exp(2);\n   *   circle(20, 20, d);\n   *\n   *   // Right-center.\n   *   d = exp(3);\n   *   circle(40, 40, d);\n   *\n   *   // Bottom-right.\n   *   d = exp(4);\n   *   circle(80, 80, d);\n   *\n   *   describe('A series of circles that grow exponentially from top left to bottom right.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A series of black dots that grow exponentially from left to right.');\n   * }\n   *\n   * function draw() {\n   *   // Invert the y-axis.\n   *   scale(1, -1);\n   *   translate(0, -100);\n   *\n   *   // Calculate the coordinates.\n   *   let x = frameCount;\n   *   let y = 0.005 * exp(x * 0.1);\n   *\n   *   // Draw a point.\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.exp = Math.exp;\n\n  /**\n   * Calculates the closest integer value that is less than or equal to the\n   * value of a number.\n   *\n   * @method floor\n   * @param  {Number} n number to round down.\n   * @return {Integer}  rounded down number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Use RGB color with values from 0 to 1.\n   *   colorMode(RGB, 1);\n   *\n   *   noStroke();\n   *\n   *   // Draw the left rectangle.\n   *   let r = 0.8;\n   *   fill(r, 0, 0);\n   *   rect(0, 0, 50, 100);\n   *\n   *   // Round r down to 0.\n   *   r = floor(r);\n   *\n   *   // Draw the right rectangle.\n   *   fill(r, 0, 0);\n   *   rect(50, 0, 50, 100);\n   *\n   *   describe('Two rectangles. The one on the left is bright red and the one on the right is black.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.floor = Math.floor;\n\n  /**\n   * Calculates a number between two numbers at a specific increment.\n   *\n   * The `amt` parameter is the amount to interpolate between the two numbers.\n   * 0.0 is equal to the first number, 0.1 is very near the first number, 0.5 is\n   * half-way in between, and 1.0 is equal to the second number. The `lerp()`\n   * function is convenient for creating motion along a straight path and for\n   * drawing dotted lines.\n   *\n   * If the value of `amt` is less than 0 or more than 1, `lerp()` will return a\n   * number outside of the original interval. For example, calling\n   * `lerp(0, 10, 1.5)` will return 15.\n   *\n   * @method lerp\n   * @param  {Number} start first value.\n   * @param  {Number} stop  second value.\n   * @param  {Number} amt   number.\n   * @return {Number}       lerped value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Declare variables for coordinates.\n   *   let a = 20;\n   *   let b = 80;\n   *   let c = lerp(a, b, 0.2);\n   *   let d = lerp(a, b, 0.5);\n   *   let e = lerp(a, b, 0.8);\n   *\n   *   strokeWeight(5);\n   *\n   *   // Draw the original points in black.\n   *   stroke(0);\n   *   point(a, 50);\n   *   point(b, 50);\n   *\n   *   // Draw the lerped points in gray.\n   *   stroke(100);\n   *   point(c, 50);\n   *   point(d, 50);\n   *   point(e, 50);\n   *\n   *   describe('Five points in a horizontal line. The outer points are black and the inner points are gray.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let x = 50;\n   * let y = 50;\n   * let targetX = 50;\n   * let targetY = 50;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A white circle at the center of a gray canvas. The circle moves to where the user clicks, then moves smoothly back to the center.');\n   * }\n   *\n   * function draw() {\n   *   background(220);\n   *\n   *   // Move x and y toward the target.\n   *   x = lerp(x, targetX, 0.05);\n   *   y = lerp(y, targetY, 0.05);\n   *\n   *   // Draw the circle.\n   *   circle(x, y, 20);\n   * }\n   *\n   * // Set x and y when the user clicks the mouse.\n   * function mouseClicked() {\n   *   x = mouseX;\n   *   y = mouseY;\n   * }\n   * </code>\n   * </div>\n   */\n  fn.lerp = function(start, stop, amt) {\n    // p5._validateParameters('lerp', arguments);\n    return amt * (stop - start) + start;\n  };\n\n  /**\n   * Calculates the natural logarithm (the base-e logarithm) of a number.\n   *\n   * `log()` expects the `n` parameter to be a value greater than 0 because\n   * the natural logarithm is defined that way.\n   *\n   * @method log\n   * @param  {Number} n number greater than 0.\n   * @return {Number}   natural logarithm of n.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top-left.\n   *   let d = log(50);\n   *   circle(33, 33, d);\n   *\n   *   // Bottom-right.\n   *   d = log(500000000);\n   *   circle(67, 67, d);\n   *\n   *   describe('Two white circles. The circle at the top-left is small. The circle at the bottom-right is about five times larger.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A series of black dots that get higher slowly from left to right.');\n   * }\n   *\n   * function draw() {\n   *   // Invert the y-axis.\n   *   scale(1, -1);\n   *   translate(0, -100);\n   *\n   *   // Calculate coordinates.\n   *   let x = frameCount;\n   *   let y = 15 * log(x);\n   *\n   *   // Draw a point.\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.log = Math.log;\n\n  /**\n   * Calculates the magnitude, or length, of a vector.\n   *\n   * A vector can be thought of in different ways. In one view, a vector is a\n   * point in space. The vector's components, `x` and `y`, are the point's\n   * coordinates `(x, y)`. A vector's magnitude is the distance from the origin\n   * `(0, 0)` to `(x, y)`. `mag(x, y)` is a shortcut for calling\n   * `dist(0, 0, x, y)`.\n   *\n   * A vector can also be thought of as an arrow pointing in space. This view is\n   * helpful for programming motion. See <a href=\"#/p5.Vector\">p5.Vector</a> for\n   * more details.\n   *\n   * Use <a href=\"#/p5.Vector/mag\">p5.Vector.mag()</a> to calculate the\n   * magnitude of a <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   *\n   * @method mag\n   * @param  {Number} x first component.\n   * @param  {Number} y second component.\n   * @return {Number}   magnitude of vector.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the vector's components.\n   *   let x = 30;\n   *   let y = 40;\n   *\n   *   // Calculate the magnitude.\n   *   let m = mag(x, y);\n   *\n   *   // Style the text.\n   *   textSize(16);\n   *\n   *   // Display the vector and its magnitude.\n   *   line(0, 0, x, y);\n   *   text(m, x, y);\n   *\n   *   describe('A diagonal line is drawn from the top left of the canvas. The number 50 is written at the end of the line.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.mag = function(x, y) {\n    // p5._validateParameters('mag', arguments);\n    return Math.hypot(x, y);\n  };\n\n  /**\n   * Re-maps a number from one range to another.\n   *\n   * For example, calling `map(2, 0, 10, 0, 100)` returns 20. The first three\n   * arguments set the original value to 2 and the original range from 0 to 10.\n   * The last two arguments set the target range from 0 to 100. 20's position\n   * in the target range [0, 100] is proportional to 2's position in the\n   * original range [0, 10].\n   *\n   * The sixth parameter, `withinBounds`, is optional. By default, `map()` can\n   * return values outside of the target range. For example,\n   * `map(11, 0, 10, 0, 100)` returns 110. Passing `true` as the sixth parameter\n   * constrains the remapped value to the target range. For example,\n   * `map(11, 0, 10, 0, 100, true)` returns 100.\n   *\n   * @method map\n   * @param  {Number} value  the value to be remapped.\n   * @param  {Number} start1 lower bound of the value's current range.\n   * @param  {Number} stop1  upper bound of the value's current range.\n   * @param  {Number} start2 lower bound of the value's target range.\n   * @param  {Number} stop2  upper bound of the value's target range.\n   * @param  {Boolean} [withinBounds] constrain the value to the newly mapped range.\n   * @return {Number}        remapped number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('Two horizontal lines. The top line grows horizontally as the mouse moves to the right. The bottom line also grows horizontally but is scaled to stay on the left half of the canvas.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Draw the top line.\n   *   line(0, 25, mouseX, 25);\n   *\n   *   // Remap mouseX from [0, 100] to [0, 50].\n   *   let x = map(mouseX, 0, 100, 0, 50);\n   *\n   *   // Draw the bottom line.\n   *   line(0, 75, 0, x);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A circle changes color from black to white as the mouse moves from left to right.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Remap mouseX from [0, 100] to [0, 255]\n   *   let c = map(mouseX, 0, 100, 0, 255);\n   *\n   *   // Style the circle.\n   *   fill(c);\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, 20);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.map = function(n, start1, stop1, start2, stop2, withinBounds) {\n    // p5._validateParameters('map', arguments);\n    const newval = (n - start1) / (stop1 - start1) * (stop2 - start2) + start2;\n    if (!withinBounds) {\n      return newval;\n    }\n    if (start2 < stop2) {\n      return this.constrain(newval, start2, stop2);\n    } else {\n      return this.constrain(newval, stop2, start2);\n    }\n  };\n\n  /**\n   * Returns the largest value in a sequence of numbers.\n   *\n   * The version of `max()` with one parameter interprets it as an array of\n   * numbers and returns the largest number.\n   *\n   * The version of `max()` with two or more parameters interprets them as\n   * individual numbers and returns the largest number.\n   *\n   * @method max\n   * @param  {Number} n0 first number to compare.\n   * @param  {Number} n1 second number to compare.\n   * @return {Number}             maximum number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Calculate the maximum of 10, 5, and 20.\n   *   let m = max(10, 5, 20);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the max.\n   *   text(m, 50, 50);\n   *\n   *   describe('The number 20 written in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of numbers.\n   *   let numbers = [10, 5, 20];\n   *\n   *   // Calculate the maximum of the array.\n   *   let m = max(numbers);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the max.\n   *   text(m, 50, 50);\n   *\n   *   describe('The number 20 written in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method max\n   * @param  {Number[]} nums numbers to compare.\n   * @return {Number}\n   */\n  fn.max = function(...args) {\n    const findMax = arr => {\n      let max = -Infinity;\n      for (let x of arr) {\n        max = Math.max(max, x);\n      }\n      return max;\n    };\n\n    if (args[0] instanceof Array) {\n      return findMax(args[0]);\n    } else {\n      return findMax(args);\n    }\n  };\n\n  /**\n   * Returns the smallest value in a sequence of numbers.\n   *\n   * The version of `min()` with one parameter interprets it as an array of\n   * numbers and returns the smallest number.\n   *\n   * The version of `min()` with two or more parameters interprets them as\n   * individual numbers and returns the smallest number.\n   *\n   * @method min\n   * @param  {Number} n0 first number to compare.\n   * @param  {Number} n1 second number to compare.\n   * @return {Number}             minimum number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Calculate the minimum of 10, 5, and 20.\n   *   let m = min(10, 5, 20);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the min.\n   *   text(m, 50, 50);\n   *\n   *   describe('The number 5 written in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of numbers.\n   *   let numbers = [10, 5, 20];\n   *\n   *   // Calculate the minimum of the array.\n   *   let m = min(numbers);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the min.\n   *   text(m, 50, 50);\n   *\n   *   describe('The number 5 written in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method min\n   * @param  {Number[]} nums numbers to compare.\n   * @return {Number}\n   */\n  fn.min = function(...args) {\n    const findMin = arr => {\n      let min = Infinity;\n      for (let x of arr) {\n        min = Math.min(min, x);\n      }\n      return min;\n    };\n\n    if (args[0] instanceof Array) {\n      return findMin(args[0]);\n    } else {\n      return findMin(args);\n    }\n  };\n\n  /**\n   * Maps a number from one range to a value between 0 and 1.\n   *\n   * For example, `norm(2, 0, 10)` returns 0.2. 2's position in the original\n   * range [0, 10] is proportional to 0.2's position in the range [0, 1]. This\n   * is the same as calling `map(2, 0, 10, 0, 1)`.\n   *\n   * Numbers outside of the original range are not constrained between 0 and 1.\n   * Out-of-range values are often intentional and useful.\n   *\n   * @method norm\n   * @param  {Number} value incoming value to be normalized.\n   * @param  {Number} start lower bound of the value's current range.\n   * @param  {Number} stop  upper bound of the value's current range.\n   * @return {Number}       normalized number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Use RGB color with values from 0 to 1.\n   *   colorMode(RGB, 1);\n   *\n   *   describe('A square changes color from black to red as the mouse moves from left to right.');\n   * }\n   *\n   * function draw() {\n   *   // Calculate the redValue.\n   *   let redValue = norm(mouseX, 0, 100);\n   *\n   *   // Paint the background.\n   *   background(redValue, 0, 0);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.norm = function(n, start, stop) {\n    // p5._validateParameters('norm', arguments);\n    return this.map(n, start, stop, 0, 1);\n  };\n\n  /**\n   * Calculates exponential expressions such as <var>2<sup>3</sup></var>.\n   *\n   * For example, `pow(2, 3)` evaluates the expression\n   * 2 &times; 2 &times; 2. `pow(2, -3)` evaluates 1 &#247;\n   * (2 &times; 2 &times; 2).\n   *\n   * @method pow\n   * @param  {Number} n base of the exponential expression.\n   * @param  {Number} e power by which to raise the base.\n   * @return {Number}   n^e.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the base of the exponent.\n   *   let base = 3;\n   *\n   *   // Top-left.\n   *   let d = pow(base, 1);\n   *   circle(10, 10, d);\n   *\n   *   // Left-center.\n   *   d = pow(base, 2);\n   *   circle(20, 20, d);\n   *\n   *   // Right-center.\n   *   d = pow(base, 3);\n   *   circle(40, 40, d);\n   *\n   *   // Bottom-right.\n   *   d = pow(base, 4);\n   *   circle(80, 80, d);\n   *\n   *   describe('A series of circles that grow exponentially from top left to bottom right.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.pow = Math.pow;\n\n  /**\n   * Calculates the integer closest to a number.\n   *\n   * For example, `round(133.8)` returns the value 134.\n   *\n   * The second parameter, `decimals`, is optional. It sets the number of\n   * decimal places to use when rounding. For example, `round(12.34, 1)` returns\n   * 12.3. `decimals` is 0 by default.\n   *\n   * @method round\n   * @param  {Number} n number to round.\n   * @param  {Number} [decimals] number of decimal places to round to, default is 0.\n   * @return {Integer}  rounded number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Round a number.\n   *   let x = round(4.2);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the rounded number.\n   *   text(x, 50, 50);\n   *\n   *   describe('The number 4 written in middle of the canvas.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Round a number to 2 decimal places.\n   *   let x = round(12.782383, 2);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Display the rounded number.\n   *   text(x, 50, 50);\n   *\n   *   describe('The number 12.78 written in middle of canvas.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.round = function(n, decimals) {\n    if (!decimals) {\n      return Math.round(n);\n    }\n    const multiplier = Math.pow(10, decimals);\n    return Math.round(n * multiplier) / multiplier;\n  };\n\n  /**\n   * Calculates the square of a number.\n   *\n   * Squaring a number means multiplying the number by itself. For example,\n   * `sq(3)` evaluates 3 &times; 3 which is 9. `sq(-3)` evaluates -3 &times; -3\n   * which is also 9. Multiplying two negative numbers produces a positive\n   * number. The value returned by `sq()` is always positive.\n   *\n   * @method sq\n   * @param  {Number} n number to square.\n   * @return {Number}   squared number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top-left.\n   *   let d = sq(3);\n   *   circle(33, 33, d);\n   *\n   *   // Bottom-right.\n   *   d = sq(6);\n   *   circle(67, 67, d);\n   *\n   *   describe('Two white circles. The circle at the top-left is small. The circle at the bottom-right is four times larger.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A series of black dots that get higher quickly from left to right.');\n   * }\n   *\n   * function draw() {\n   *   // Invert the y-axis.\n   *   scale(1, -1);\n   *   translate(0, -100);\n   *\n   *   // Calculate the coordinates.\n   *   let x = frameCount;\n   *   let y = 0.01 * sq(x);\n   *\n   *   // Draw the point.\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.sq = n => n * n;\n\n  /**\n   * Calculates the square root of a number.\n   *\n   * A number's square root can be multiplied by itself to produce the original\n   * number. For example, `sqrt(9)` returns 3 because 3 &times; 3 = 9. `sqrt()`\n   * always returns a positive value. `sqrt()` doesn't work with negative arguments\n   * such as `sqrt(-9)`.\n   *\n   * @method sqrt\n   * @param  {Number} n non-negative number to square root.\n   * @return {Number}   square root of number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top-left.\n   *   let d = sqrt(16);\n   *   circle(33, 33, d);\n   *\n   *   // Bottom-right.\n   *   d = sqrt(1600);\n   *   circle(67, 67, d);\n   *\n   *   describe('Two white circles. The circle at the top-left is small. The circle at the bottom-right is ten times larger.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A series of black dots that get higher slowly from left to right.');\n   * }\n   *\n   * function draw() {\n   *   // Invert the y-axis.\n   *   scale(1, -1);\n   *   translate(0, -100);\n   *\n   *   // Calculate the coordinates.\n   *   let x = frameCount;\n   *   let y = 5 * sqrt(x);\n   *\n   *   // Draw the point.\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.sqrt = Math.sqrt;\n\n  /**\n   * Calculates the fractional part of a number.\n   *\n   * A number's fractional part includes its decimal values. For example,\n   * `fract(12.34)` returns 0.34.\n   *\n   * @method fract\n   * @param {Number} n number whose fractional part will be found.\n   * @returns {Number} fractional part of n.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(16);\n   *\n   *   // Original number.\n   *   let n = 56.78;\n   *   text(n, 50, 33);\n   *\n   *   // Fractional part.\n   *   let f = fract(n);\n   *   text(f, 50, 67);\n   *\n   *   describe('The number 56.78 written above the number 0.78.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.fract = function(toConvert) {\n    // p5._validateParameters('fract', arguments);\n    let sign = 0;\n    let num = Number(toConvert);\n    if (isNaN(num) || Math.abs(num) === Infinity) {\n      return num;\n    } else if (num < 0) {\n      num = -num;\n      sign = 1;\n    }\n    if (String(num).includes('.') && !String(num).includes('e')) {\n      let toFract = String(num);\n      toFract = Number('0' + toFract.slice(toFract.indexOf('.')));\n      return Math.abs(sign - toFract);\n    } else if (num < 1) {\n      return Math.abs(sign - num);\n    } else {\n      return 0;\n    }\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  calculation(p5, p5.prototype);\n}\n\nexport { calculation as default };\n","//////////////////////////////////////////////////////////////\n\n// http://mrl.nyu.edu/~perlin/noise/\n// Adapting from PApplet.java\n// which was adapted from toxi\n// which was adapted from the german demo group farbrausch\n// as used in their demo \"art\": http://www.farb-rausch.de/fr010src.zip\n\n// someday we might consider using \"improved noise\"\n// http://mrl.nyu.edu/~perlin/paper445.pdf\n// See: https://github.com/shiffman/The-Nature-of-Code-Examples-p5.js/\n//      blob/main/introduction/Noise1D/noise.js\n\n/**\n * @module Math\n * @submodule Noise\n * @for p5\n * @requires core\n */\nfunction noise(p5, fn){\n  const PERLIN_YWRAPB = 4;\n  const PERLIN_YWRAP = 1 << PERLIN_YWRAPB;\n  const PERLIN_ZWRAPB = 8;\n  const PERLIN_ZWRAP = 1 << PERLIN_ZWRAPB;\n  const PERLIN_SIZE = 4095;\n\n  let perlin_octaves = 4; // default to medium smooth\n  let perlin_amp_falloff = 0.5; // 50% reduction/octave\n\n  const scaled_cosine = i => 0.5 * (1.0 - Math.cos(i * Math.PI));\n\n  let perlin; // will be initialized lazily by noise() or noiseSeed()\n\n  /**\n   * Returns random numbers that can be tuned to feel organic.\n   *\n   * Values returned by <a href=\"#/p5/random\">random()</a> and\n   * <a href=\"#/p5/randomGaussian\">randomGaussian()</a> can change by large\n   * amounts between function calls. By contrast, values returned by `noise()`\n   * can be made \"smooth\". Calls to `noise()` with similar inputs will produce\n   * similar outputs. `noise()` is used to create textures, motion, shapes,\n   * terrains, and so on. Ken Perlin invented `noise()` while animating the\n   * original <em>Tron</em> film in the 1980s.\n   *\n   * `noise()` always returns values between 0 and 1. It returns the same value\n   * for a given input while a sketch is running. `noise()` produces different\n   * results each time a sketch runs. The\n   * <a href=\"#/p5/noiseSeed\">noiseSeed()</a> function can be used to generate\n   * the same sequence of Perlin noise values each time a sketch runs.\n   *\n   * The character of the noise can be adjusted in two ways. The first way is to\n   * scale the inputs. `noise()` interprets inputs as coordinates. The sequence\n   * of noise values will be smoother when the input coordinates are closer. The\n   * second way is to use the <a href=\"#/p5/noiseDetail\">noiseDetail()</a>\n   * function.\n   *\n   * The version of `noise()` with one parameter computes noise values in one\n   * dimension. This dimension can be thought of as space, as in `noise(x)`, or\n   * time, as in `noise(t)`.\n   *\n   * The version of `noise()` with two parameters computes noise values in two\n   * dimensions. These dimensions can be thought of as space, as in\n   * `noise(x, y)`, or space and time, as in `noise(x, t)`.\n   *\n   * The version of `noise()` with three parameters computes noise values in\n   * three dimensions. These dimensions can be thought of as space, as in\n   * `noise(x, y, z)`, or space and time, as in `noise(x, y, t)`.\n   *\n   * @method noise\n   * @param  {Number} x   x-coordinate in noise space.\n   * @param  {Number} [y] y-coordinate in noise space.\n   * @param  {Number} [z] z-coordinate in noise space.\n   * @return {Number}     Perlin noise value at specified coordinates.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A black dot moves randomly on a gray square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Calculate the coordinates.\n   *   let x = 100 * noise(0.005 * frameCount);\n   *   let y = 100 * noise(0.005 * frameCount + 10000);\n   *\n   *   // Draw the point.\n   *   strokeWeight(5);\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A black dot moves randomly on a gray square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Set the noise level and scale.\n   *   let noiseLevel = 100;\n   *   let noiseScale = 0.005;\n   *\n   *   // Scale the input coordinate.\n   *   let nt = noiseScale * frameCount;\n   *\n   *   // Compute the noise values.\n   *   let x = noiseLevel * noise(nt);\n   *   let y = noiseLevel * noise(nt + 10000);\n   *\n   *   // Draw the point.\n   *   strokeWeight(5);\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A hilly terrain drawn in gray against a black sky.');\n   * }\n   *\n   * function draw() {\n   *   // Set the noise level and scale.\n   *   let noiseLevel = 100;\n   *   let noiseScale = 0.02;\n   *\n   *   // Scale the input coordinate.\n   *   let x = frameCount;\n   *   let nx = noiseScale * x;\n   *\n   *   // Compute the noise value.\n   *   let y = noiseLevel * noise(nx);\n   *\n   *   // Draw the line.\n   *   line(x, 0, x, y);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A calm sea drawn in gray against a black sky.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Set the noise level and scale.\n   *   let noiseLevel = 100;\n   *   let noiseScale = 0.002;\n   *\n   *   // Iterate from left to right.\n   *   for (let x = 0; x < 100; x += 1) {\n   *     // Scale the input coordinates.\n   *     let nx = noiseScale * x;\n   *     let nt = noiseScale * frameCount;\n   *\n   *     // Compute the noise value.\n   *     let y = noiseLevel * noise(nx, nt);\n   *\n   *     // Draw the line.\n   *     line(x, 0, x, y);\n   *   }\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the noise level and scale.\n   *   let noiseLevel = 255;\n   *   let noiseScale = 0.01;\n   *\n   *   // Iterate from top to bottom.\n   *   for (let y = 0; y < 100; y += 1) {\n   *     // Iterate from left to right.\n   *     for (let x = 0; x < 100; x += 1) {\n   *       // Scale the input coordinates.\n   *       let nx = noiseScale * x;\n   *       let ny = noiseScale * y;\n   *\n   *       // Compute the noise value.\n   *       let c = noiseLevel * noise(nx, ny);\n   *\n   *       // Draw the point.\n   *       stroke(c);\n   *       point(x, y);\n   *     }\n   *   }\n   *\n   *   describe('A gray cloudy pattern.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A gray cloudy pattern that changes.');\n   * }\n   *\n   * function draw() {\n   *   // Set the noise level and scale.\n   *   let noiseLevel = 255;\n   *   let noiseScale = 0.009;\n   *\n   *   // Iterate from top to bottom.\n   *   for (let y = 0; y < 100; y += 1) {\n   *     // Iterate from left to right.\n   *     for (let x = 0; x < width; x += 1) {\n   *       // Scale the input coordinates.\n   *       let nx = noiseScale * x;\n   *       let ny = noiseScale * y;\n   *       let nt = noiseScale * frameCount;\n   *\n   *       // Compute the noise value.\n   *       let c = noiseLevel * noise(nx, ny, nt);\n   *\n   *       // Draw the point.\n   *       stroke(c);\n   *       point(x, y);\n   *     }\n   *   }\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noise = function(x, y = 0, z = 0) {\n    if (perlin == null) {\n      perlin = new Array(PERLIN_SIZE + 1);\n      for (let i = 0; i < PERLIN_SIZE + 1; i++) {\n        perlin[i] = Math.random();\n      }\n    }\n\n    if (x < 0) {\n      x = -x;\n    }\n    if (y < 0) {\n      y = -y;\n    }\n    if (z < 0) {\n      z = -z;\n    }\n\n    let xi = Math.floor(x),\n      yi = Math.floor(y),\n      zi = Math.floor(z);\n    let xf = x - xi;\n    let yf = y - yi;\n    let zf = z - zi;\n    let rxf, ryf;\n    let r = 0;\n    let ampl = 0.5;\n    let n1, n2, n3;\n\n    for (let o = 0; o < perlin_octaves; o++) {\n      let of = xi + (yi << PERLIN_YWRAPB) + (zi << PERLIN_ZWRAPB);\n\n      rxf = scaled_cosine(xf);\n      ryf = scaled_cosine(yf);\n\n      n1 = perlin[of & PERLIN_SIZE];\n      n1 += rxf * (perlin[(of + 1) & PERLIN_SIZE] - n1);\n      n2 = perlin[(of + PERLIN_YWRAP) & PERLIN_SIZE];\n      n2 += rxf * (perlin[(of + PERLIN_YWRAP + 1) & PERLIN_SIZE] - n2);\n      n1 += ryf * (n2 - n1);\n\n      of += PERLIN_ZWRAP;\n      n2 = perlin[of & PERLIN_SIZE];\n      n2 += rxf * (perlin[(of + 1) & PERLIN_SIZE] - n2);\n      n3 = perlin[(of + PERLIN_YWRAP) & PERLIN_SIZE];\n      n3 += rxf * (perlin[(of + PERLIN_YWRAP + 1) & PERLIN_SIZE] - n3);\n      n2 += ryf * (n3 - n2);\n\n      n1 += scaled_cosine(zf) * (n2 - n1);\n\n      r += n1 * ampl;\n      ampl *= perlin_amp_falloff;\n      xi <<= 1;\n      xf *= 2;\n      yi <<= 1;\n      yf *= 2;\n      zi <<= 1;\n      zf *= 2;\n\n      if (xf >= 1.0) {\n        xi++;\n        xf--;\n      }\n      if (yf >= 1.0) {\n        yi++;\n        yf--;\n      }\n      if (zf >= 1.0) {\n        zi++;\n        zf--;\n      }\n    }\n    return r;\n  };\n\n  /**\n   * Adjusts the character of the noise produced by the\n   * <a href=\"#/p5/noise\">noise()</a> function.\n   *\n   * Perlin noise values are created by adding layers of noise together. The\n   * noise layers, called octaves, are similar to harmonics in music. Lower\n   * octaves contribute more to the output signal. They define the overall\n   * intensity of the noise. Higher octaves create finer-grained details.\n   *\n   * By default, noise values are created by combining four octaves. Each higher\n   * octave contributes half as much (50% less) compared to its predecessor.\n   * `noiseDetail()` changes the number of octaves and the falloff amount. For\n   * example, calling `noiseDetail(6, 0.25)` ensures that\n   * <a href=\"#/p5/noise\">noise()</a> will use six octaves. Each higher octave\n   * will contribute 25% as much (75% less) compared to its predecessor. Falloff\n   * values between 0 and 1 are valid. However, falloff values greater than 0.5\n   * might result in noise values greater than 1.\n   *\n   * @method noiseDetail\n   * @param {Number} lod number of octaves to be used by the noise.\n   * @param {Number} falloff falloff factor for each octave.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Set the noise level and scale.\n   *   let noiseLevel = 255;\n   *   let noiseScale = 0.02;\n   *\n   *   // Iterate from top to bottom.\n   *   for (let y = 0; y < 100; y += 1) {\n   *     // Iterate from left to right.\n   *     for (let x = 0; x < 50; x += 1) {\n   *       // Scale the input coordinates.\n   *       let nx = noiseScale * x;\n   *       let ny = noiseScale * y;\n   *\n   *       // Compute the noise value with six octaves\n   *       // and a low falloff factor.\n   *       noiseDetail(6, 0.25);\n   *       let c = noiseLevel * noise(nx, ny);\n   *\n   *       // Draw the left side.\n   *       stroke(c);\n   *       point(x, y);\n   *\n   *       // Compute the noise value with four octaves\n   *       // and a high falloff factor.\n   *       noiseDetail(4, 0.5);\n   *       c = noiseLevel * noise(nx, ny);\n   *\n   *       // Draw the right side.\n   *       stroke(c);\n   *       point(x + 50, y);\n   *     }\n   *   }\n   *\n   *   describe('Two gray cloudy patterns. The pattern on the right is cloudier than the pattern on the left.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noiseDetail = function(lod, falloff) {\n    if (lod > 0) {\n      perlin_octaves = lod;\n    }\n    if (falloff > 0) {\n      perlin_amp_falloff = falloff;\n    }\n  };\n\n  /**\n   * Sets the seed value for the <a href=\"#/p5/noise\">noise()</a> function.\n   *\n   * By default, <a href=\"#/p5/noise\">noise()</a> produces different results\n   * each time a sketch is run. Calling `noiseSeed()` with a constant argument,\n   * such as `noiseSeed(99)`, makes <a href=\"#/p5/noise\">noise()</a> produce the\n   * same results each time a sketch is run.\n   *\n   * @method noiseSeed\n   * @param {Number} seed   seed value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Set the noise seed for consistent results.\n   *   noiseSeed(99);\n   *\n   *   describe('A black rectangle that grows randomly, first to the right and then to the left.');\n   * }\n   *\n   * function draw() {\n   *   // Set the noise level and scale.\n   *   let noiseLevel = 100;\n   *   let noiseScale = 0.005;\n   *\n   *   // Scale the input coordinate.\n   *   let nt = noiseScale * frameCount;\n   *\n   *   // Compute the noise value.\n   *   let x = noiseLevel * noise(nt);\n   *\n   *   // Draw the line.\n   *   line(x, 0, x, height);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noiseSeed = function(seed) {\n    // Linear Congruential Generator\n    // Variant of a Lehman Generator\n    const lcg = (() => {\n      // Set to values from http://en.wikipedia.org/wiki/Numerical_Recipes\n      // m is basically chosen to be large (as it is the max period)\n      // and for its relationships to a and c\n      const m = 4294967296;\n      // a - 1 should be divisible by m's prime factors\n      const a = 1664525;\n      // c and m should be co-prime\n      const c = 1013904223;\n      let seed, z;\n      return {\n        setSeed(val) {\n          // pick a random seed if val is undefined or null\n          // the >>> 0 casts the seed to an unsigned 32-bit integer\n          z = seed = (val == null ? Math.random() * m : val) >>> 0;\n        },\n        getSeed() {\n          return seed;\n        },\n        rand() {\n          // define the recurrence relationship\n          z = (a * z + c) % m;\n          // return a float in [0, 1)\n          // if z = m then z / m = 0 therefore (z % m) / m < 1 always\n          return z / m;\n        }\n      };\n    })();\n\n    lcg.setSeed(seed);\n    perlin = new Array(PERLIN_SIZE + 1);\n    for (let i = 0; i < PERLIN_SIZE + 1; i++) {\n      perlin[i] = lcg.rand();\n    }\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  noise(p5, p5.prototype);\n}\n\nexport { noise as default };\n","/**\n * @module Math\n * @submodule Random\n * @for p5\n * @requires core\n */\n\nfunction random(p5, fn){\n  // variables used for random number generators\n  const randomStateProp = '_lcg_random_state';\n  // Set to values from http://en.wikipedia.org/wiki/Numerical_Recipes\n  // m is basically chosen to be large (as it is the max period)\n  // and for its relationships to a and c\n  const m = 4294967296;\n  // a - 1 should be divisible by m's prime factors\n  const a = 1664525;\n  // c and m should be co-prime\n  const c = 1013904223;\n  let y2 = 0;\n\n  // Linear Congruential Generator that stores its state at instance[stateProperty]\n  fn._lcg = function(stateProperty) {\n    // define the recurrence relationship\n    this[stateProperty] = (a * this[stateProperty] + c) % m;\n    // return a float in [0, 1)\n    // we've just used % m, so / m is always < 1\n    return this[stateProperty] / m;\n  };\n\n  fn._lcgSetSeed = function(stateProperty, val) {\n    // pick a random seed if val is undefined or null\n    // the >>> 0 casts the seed to an unsigned 32-bit integer\n    this[stateProperty] = (val == null ? Math.random() * m : val) >>> 0;\n  };\n\n  /**\n   * Sets the seed value for the <a href=\"#/p5/random\">random()</a> and\n   * <a href=\"#/p5/randomGaussian\">randomGaussian()</a> functions.\n   *\n   * By default, <a href=\"#/p5/random\">random()</a> and\n   * <a href=\"#/p5/randomGaussian\">randomGaussian()</a> produce different\n   * results each time a sketch is run. Calling `randomSeed()` with a constant\n   * argument, such as `randomSeed(99)`, makes these functions produce the same\n   * results each time a sketch is run.\n   *\n   * @method randomSeed\n   * @param {Number} seed   seed value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get random coordinates.\n   *   let x = random(0, 100);\n   *   let y = random(0, 100);\n   *\n   *   // Draw the white circle.\n   *   circle(x, y, 10);\n   *\n   *   // Set a random seed for consistency.\n   *   randomSeed(99);\n   *\n   *   // Get random coordinates.\n   *   x = random(0, 100);\n   *   y = random(0, 100);\n   *\n   *   // Draw the black circle.\n   *   fill(0);\n   *   circle(x, y, 10);\n   *\n   *   describe('A white circle appears at a random position. A black circle appears at (27.4, 25.8).');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.randomSeed = function(seed) {\n    this._lcgSetSeed(randomStateProp, seed);\n    this._gaussian_previous = false;\n  };\n\n  /**\n   * Returns a random number or a random element from an array.\n   *\n   * `random()` follows uniform distribution, which means that all outcomes are\n   * equally likely. When `random()` is used to generate numbers, all\n   * numbers in the output range are equally likely to be returned. When\n   * `random()` is used to select elements from an array, all elements are\n   * equally likely to be chosen.\n   *\n   * By default, `random()` produces different results each time a sketch runs.\n   * The <a href=\"#/p5/randomSeed\">randomSeed()</a> function can be used to\n   * generate the same sequence of numbers or choices each time a sketch runs.\n   *\n   * The version of `random()` with no parameters returns a random number from 0\n   * up to but not including 1.\n   *\n   * The version of `random()` with one parameter works one of two ways. If the\n   * argument passed is a number, `random()` returns a random number from 0 up\n   * to but not including the number. For example, calling `random(5)` returns\n   * values between 0 and 5. If the argument passed is an array, `random()`\n   * returns a random element from that array. For example, calling\n   * `random(['', '', ''])` returns either a lion, tiger, or bear emoji.\n   *\n   * The version of `random()` with two parameters returns a random number from\n   * a given range. The arguments passed set the range's lower and upper bounds.\n   * For example, calling `random(-5, 10.2)` returns values from -5 up to but\n   * not including 10.2.\n   *\n   * @method random\n   * @param  {Number} [min]   lower bound (inclusive).\n   * @param  {Number} [max]   upper bound (exclusive).\n   * @return {Number} random number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get random coordinates between 0 and 100.\n   *   let x = random(0, 100);\n   *   let y = random(0, 100);\n   *\n   *   // Draw a point.\n   *   strokeWeight(5);\n   *   point(x, y);\n   *\n   *   describe('A black dot appears in a random position on a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get random coordinates between 0 and 100.\n   *   let x = random(100);\n   *   let y = random(100);\n   *\n   *   // Draw the point.\n   *   strokeWeight(5);\n   *   point(x, y);\n   *\n   *   describe('A black dot appears in a random position on a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of emoji strings.\n   *   let animals = ['', '', ''];\n   *\n   *   // Choose a random element from the array.\n   *   let choice = random(animals);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER);\n   *   textSize(20);\n   *\n   *   // Display the emoji.\n   *   text(choice, 50, 50);\n   *\n   *   describe('An animal face is displayed at random. Either a lion, tiger, or bear.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(5);\n   *\n   *   describe('A black dot moves around randomly on a gray square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Get random coordinates between 0 and 100.\n   *   let x = random(100);\n   *   let y = random(100);\n   *\n   *   // Draw the point.\n   *   strokeWeight(5);\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Slow the frame rate.\n   *   frameRate(5);\n   *\n   *   describe('A black dot moves around randomly in the middle of a gray square.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Get random coordinates between 45 and 55.\n   *   let x = random(45, 55);\n   *   let y = random(45, 55);\n   *\n   *   // Draw the point.\n   *   strokeWeight(5);\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let x = 50;\n   * let y = 50;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('A black dot moves around randomly leaving a trail.');\n   * }\n   *\n   * function draw() {\n   *   // Update x and y randomly.\n   *   x += random(-1, 1);\n   *   y += random(-1, 1);\n   *\n   *   // Draw the point.\n   *   point(x, y);\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method random\n   * @param  {Array} choices   array to choose from.\n   * @return {*} random element from the array.\n   */\n  fn.random = function(min, max) {\n    // p5._validateParameters('random', arguments);\n    let rand;\n\n    if (this[randomStateProp] != null) {\n      rand = this._lcg(randomStateProp);\n    } else {\n      rand = Math.random();\n    }\n    if (typeof min === 'undefined') {\n      return rand;\n    } else if (typeof max === 'undefined') {\n      if (min instanceof Array) {\n        return min[Math.floor(rand * min.length)];\n      } else {\n        return rand * min;\n      }\n    } else {\n      if (min > max) {\n        const tmp = min;\n        min = max;\n        max = tmp;\n      }\n\n      return rand * (max - min) + min;\n    }\n  };\n\n  /**\n   * Returns a random number fitting a Gaussian, or normal, distribution.\n   *\n   * Normal distributions look like bell curves when plotted. Values from a\n   * normal distribution cluster around a central value called the mean. The\n   * cluster's standard deviation describes its spread.\n   *\n   * By default, `randomGaussian()` produces different results each time a\n   * sketch runs. The <a href=\"#/p5/randomSeed\">randomSeed()</a> function can be\n   * used to generate the same sequence of numbers each time a sketch runs.\n   *\n   * There's no minimum or maximum value that `randomGaussian()` might return.\n   * Values far from the mean are very unlikely and values near the mean are\n   * very likely.\n   *\n   * The version of `randomGaussian()` with no parameters returns values with a\n   * mean of 0 and standard deviation of 1.\n   *\n   * The version of `randomGaussian()` with one parameter interprets the\n   * argument passed as the mean. The standard deviation is 1.\n   *\n   * The version of `randomGaussian()` with two parameters interprets the first\n   * argument passed as the mean and the second as the standard deviation.\n   *\n   * @method randomGaussian\n   * @param  {Number} [mean]  mean.\n   * @param  {Number} [sd]    standard deviation.\n   * @return {Number} random number.\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   describe('Three horizontal black lines are filled in randomly. The top line spans entire canvas. The middle line is very short. The bottom line spans two-thirds of the canvas.');\n   * }\n   *\n   * function draw() {\n   *   // Style the circles.\n   *   noStroke();\n   *   fill(0, 10);\n   *\n   *   // Uniform distribution between 0 and 100.\n   *   let x = random(100);\n   *   let y = 25;\n   *   circle(x, y, 5);\n   *\n   *   // Gaussian distribution with a mean of 50 and sd of 1.\n   *   x = randomGaussian(50);\n   *   y = 50;\n   *   circle(x, y, 5);\n   *\n   *   // Gaussian distribution with a mean of 50 and sd of 10.\n   *   x = randomGaussian(50, 10);\n   *   y = 75;\n   *   circle(x, y, 5);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.randomGaussian = function(mean, sd = 1) {\n    let y1, x1, x2, w;\n    if (this._gaussian_previous) {\n      y1 = y2;\n      this._gaussian_previous = false;\n    } else {\n      do {\n        x1 = this.random(2) - 1;\n        x2 = this.random(2) - 1;\n        w = x1 * x1 + x2 * x2;\n      } while (w >= 1);\n      w = Math.sqrt(-2 * Math.log(w) / w);\n      y1 = x1 * w;\n      y2 = x2 * w;\n      this._gaussian_previous = true;\n    }\n\n    const m = mean || 0;\n    return y1 * sd + m;\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  random(p5, p5.prototype);\n}\n\nexport { random as default };\n","/**\n * @module Math\n * @for p5\n * @requires core\n */\n\nfunction math(p5, fn) {\n  /**\n   * Creates a new <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   *\n   * A vector can be thought of in different ways. In one view, a vector is like\n   * an arrow pointing in space. Vectors have both magnitude (length) and\n   * direction. This view is helpful for programming motion.\n   *\n   * A vector's components determine its magnitude and direction. For example,\n   * calling `createVector(3, 4)` creates a new\n   * <a href=\"#/p5.Vector\">p5.Vector</a> object with an x-component of 3 and a\n   * y-component of 4. From the origin, this vector's tip is 3 units to the\n   * right and 4 units down.\n   *\n   * You can also pass N dimensions to the `createVector` function. For example,\n   * calling `createVector(1, 2, 3, 4)` creates a vector with four components.\n   * This allows for flexibility in representing vectors in higher-dimensional\n   * spaces.\n   *\n   * <a href=\"#/p5.Vector\">p5.Vector</a> objects are often used to program\n   * motion because they simplify the math. For example, a moving ball has a\n   * position and a velocity. Position describes where the ball is in space. The\n   * ball's position vector extends from the origin to the ball's center.\n   * Velocity describes the ball's speed and the direction it's moving. If the\n   * ball is moving straight up, its velocity vector points straight up. Adding\n   * the ball's velocity vector to its position vector moves it, as in\n   * `pos.add(vel)`. Vector math relies on methods inside the\n   * <a href=\"#/p5.Vector\">p5.Vector</a> class.\n   *\n   * @method createVector\n   * @param {...Number} x Zero or more numbers, representing each component of the vector.\n   * @return {p5.Vector} new <a href=\"#/p5.Vector\">p5.Vector</a> object.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create p5.Vector objects.\n   *   let p1 = createVector(25, 25);\n   *   let p2 = createVector(50, 50);\n   *   let p3 = createVector(75, 75);\n   *\n   *   // Draw the dots.\n   *   strokeWeight(5);\n   *   point(p1);\n   *   point(p2);\n   *   point(p3);\n   *\n   *   describe('Three black dots form a diagonal line from top left to bottom right.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let pos;\n   * let vel;\n   *\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   // Create p5.Vector objects.\n   *   pos = createVector(50, 100);\n   *   vel = createVector(0, -1);\n   *\n   *   describe('A black dot moves from bottom to top on a gray square. The dot reappears at the bottom when it reaches the top.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Add velocity to position.\n   *   pos.add(vel);\n   *\n   *   // If the dot reaches the top of the canvas,\n   *   // restart from the bottom.\n   *   if (pos.y < 0) {\n   *     pos.y = 100;\n   *   }\n   *\n   *   // Draw the dot.\n   *   strokeWeight(5);\n   *   point(pos);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createVector = function (x, y, z) {\n    if (this instanceof p5) {\n      return new p5.Vector(\n        this._fromRadians.bind(this),\n        this._toRadians.bind(this),\n        ...arguments\n      );\n    } else {\n      return new p5.Vector(x, y, z);\n    }\n  };\n\n  /**\n   * Creates a new <a href=\"#/p5.Matrix\">p5.Matrix</a> object.\n   *\n   * A matrix is a mathematical concept that is useful in many fields, including\n   * computer graphics. In p5.js, matrices are used to perform transformations\n   * on shapes and images. The `createMatrix` method can take a column-major\n   * array representation of a square matrix as an argument. In the current implementation we only use squared matrices.\n   *\n   * @private\n   * @method createMatrix\n   * @param {Array<Number>} components Column-major array representation of the square matrix.\n   *\n   * @return {p5.Matrix} new <a href=\"#/p5.Matrix\">p5.Matrix</a> object.\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * function setup() {\n   *   let matrix = createMatrix([1, 2, 3, 4, 5, 6, 7, 8, 9]);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.createMatrix = function (...args) {\n    return new p5.Matrix(...args);\n  };\n}\n\nif (typeof p5 !== \"undefined\") {\n  math(p5, p5.prototype);\n}\n\nexport { math as default };\n","/**\n * @module Data\n * @submodule Conversion\n * @for p5\n * @requires core\n */\n\nfunction conversion(p5, fn){\n  /**\n   * Converts a `String` to a floating point (decimal) `Number`.\n   *\n   * `float()` converts strings that resemble numbers, such as `'12.34'`, into\n   * numbers.\n   *\n   * The parameter, `str`, is the string value to convert. For example, calling\n   * `float('12.34')` returns the number `12.34`.  If an array of strings is\n   * passed, as in `float(['12.34', '56.78'])`, then an array of numbers will be\n   * returned.\n   *\n   * Note: If a string can't be converted to a number, as in `float('giraffe')`,\n   * then the value `NaN` (not a number) will be returned.\n   *\n   * @method float\n   * @param {String}  str string to convert.\n   * @return {Number} converted number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a string variable.\n   *   let original = '12.3';\n   *\n   *   // Convert the string to a number.\n   *   let converted = float(original);\n   *\n   *   // Double the converted value.\n   *   let twice = converted * 2;\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(12);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original}  2 = ${twice}`, 50, 50);\n   *\n   *   describe('The text \"12.3  2 = 24.6\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of strings.\n   *   let original = ['60', '30', '15'];\n   *\n   *   // Convert the strings to numbers.\n   *   let diameters = float(original);\n   *\n   *   for (let d of diameters) {\n   *     // Draw a circle.\n   *     circle(50, 50, d);\n   *   }\n   *\n   *   describe('Three white, concentric circles on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method float\n   * @param {String[]} ns array of strings to convert.\n   * @return {Number[]} converted numbers.\n   */\n  fn.float = function(str) {\n    if (str instanceof Array) {\n      return str.map(parseFloat);\n    }\n    return parseFloat(str);\n  };\n\n  /**\n   * Converts a `Boolean`, `String`, or decimal `Number` to an integer.\n   *\n   * `int()` converts values to integers. Integers are positive or negative\n   * numbers without decimals. If the original value has decimals, as in -34.56,\n   * they're removed to produce an integer such as -34.\n   *\n   * The parameter, `n`, is the value to convert. If `n` is a Boolean, as in\n   * `int(false)` or `int(true)`, then the number 0 (`false`) or 1 (`true`) will\n   * be returned. If `n` is a string or number, as in `int('45')` or\n   * `int(67.89)`, then an integer will be returned. If an array is passed, as\n   * in `int([12.34, 56.78])`, then an array of integers will be returned.\n   *\n   * Note: If a value can't be converted to a number, as in `int('giraffe')`,\n   * then the value `NaN` (not a number) will be returned.\n   *\n   * @method int\n   * @param {String|Boolean|Number} n value to convert.\n   * @return {Number} converted number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a Boolean variable.\n   *   let original = false;\n   *\n   *   // Convert the Boolean to an integer.\n   *   let converted = int(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} : ${converted}`, 50, 50);\n   *\n   *   describe('The text \"false : 0\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a string variable.\n   *   let original = '12.34';\n   *\n   *   // Convert the string to an integer.\n   *   let converted = int(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(14);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original}  ${converted}`, 50, 50);\n   *\n   *   describe('The text \"12.34  12\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a decimal number variable.\n   *   let original = 12.34;\n   *\n   *   // Convert the decimal number to an integer.\n   *   let converted = int(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(14);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original}  ${converted}`, 50, 50);\n   *\n   *   describe('The text \"12.34  12\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of strings.\n   *   let original = ['60', '30', '15'];\n   *\n   *   // Convert the strings to integers.\n   *   let diameters = int(original);\n   *\n   *   for (let d of diameters) {\n   *     // Draw a circle.\n   *     circle(50, 50, d);\n   *   }\n   *\n   *   describe('Three white, concentric circles on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method int\n   * @param {Array} ns values to convert.\n   * @return {Number[]} converted numbers.\n   */\n  fn.int = function(n, radix = 10) {\n    if (n === Infinity || n === 'Infinity') {\n      return Infinity;\n    } else if (n === -Infinity || n === '-Infinity') {\n      return -Infinity;\n    } else if (typeof n === 'string') {\n      return parseInt(n, radix);\n    } else if (typeof n === 'number') {\n      return n | 0;\n    } else if (typeof n === 'boolean') {\n      return n ? 1 : 0;\n    } else if (n instanceof Array) {\n      return n.map(n => fn.int(n, radix));\n    }\n  };\n\n  /**\n   * Converts a `Boolean` or `Number` to `String`.\n   *\n   * `str()` converts values to strings. See the\n   * <a href=\"#/p5/String\">String</a> reference page for guidance on using\n   * template literals instead.\n   *\n   * The parameter, `n`, is the value to convert. If `n` is a Boolean, as in\n   * `str(false)` or `str(true)`, then the value will be returned as a string,\n   * as in `'false'` or `'true'`. If `n` is a number, as in `str(123)`, then its\n   * value will be returned as a string, as in `'123'`. If an array is passed,\n   * as in `str([12.34, 56.78])`, then an array of strings will be returned.\n   *\n   * @method str\n   * @param {String|Boolean|Number} n value to convert.\n   * @return {String} converted string.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a Boolean variable.\n   *   let original = false;\n   *\n   *   // Convert the Boolean to a string.\n   *   let converted = str(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} : ${converted}`, 50, 50);\n   *\n   *   describe('The text \"false : false\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a number variable.\n   *   let original = 123;\n   *\n   *   // Convert the number to a string.\n   *   let converted = str(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} = ${converted}`, 50, 50);\n   *\n   *   describe('The text \"123 = 123\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of numbers.\n   *   let original = [12, 34, 56];\n   *\n   *   // Convert the numbers to strings.\n   *   let strings = str(original);\n   *\n   *   // Create an empty string variable.\n   *   let final = '';\n   *\n   *   // Concatenate all the strings.\n   *   for (let s of strings) {\n   *     final += s;\n   *   }\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the concatenated string.\n   *   text(final, 50, 50);\n   *\n   *   describe('The text \"123456\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  fn.str = function(n) {\n    if (n instanceof Array) {\n      return n.map(fn.str);\n    } else {\n      return String(n);\n    }\n  };\n\n  /**\n   * Converts a `String` or `Number` to a `Boolean`.\n   *\n   * `boolean()` converts values to `true` or `false`.\n   *\n   * The parameter, `n`, is the value to convert. If `n` is a string, then\n   * `boolean('true')` will return `true` and every other string value will\n   * return `false`. If `n` is a number, then `boolean(0)` will return `false`\n   * and every other numeric value will return `true`. If an array is passed, as\n   * `in boolean([0, 1, 'true', 'blue'])`, then an array of Boolean values will\n   * be returned.\n   *\n   * @method boolean\n   * @param {String|Boolean|Number} n value to convert.\n   * @return {Boolean} converted Boolean value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a number variable.\n   *   let original = 0;\n   *\n   *   // Convert the number to a Boolean value.\n   *   let converted = boolean(original);\n   *\n   *   // Style the circle based on the converted value.\n   *   if (converted === true) {\n   *     fill('blue');\n   *   } else {\n   *     fill('red');\n   *   }\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, 40);\n   *\n   *   describe('A red circle on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a string variable.\n   *   let original = 'true';\n   *\n   *   // Convert the string to a Boolean value.\n   *   let converted = boolean(original);\n   *\n   *   // Style the circle based on the converted value.\n   *   if (converted === true) {\n   *     fill('blue');\n   *   } else {\n   *     fill('red');\n   *   }\n   *\n   *   // Draw the circle.\n   *   circle(50, 50, 40);\n   *\n   *   describe('A blue circle on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of values.\n   *   let original = [0, 'hi', 123, 'true'];\n   *\n   *   // Convert the array to a Boolean values.\n   *   let converted = boolean(original);\n   *\n   *   // Iterate over the array of converted Boolean values.\n   *   for (let i = 0; i < converted.length; i += 1) {\n   *\n   *     // Style the circle based on the converted value.\n   *     if (converted[i] === true) {\n   *       fill('blue');\n   *     } else {\n   *       fill('red');\n   *     }\n   *\n   *     // Calculate the x-coordinate.\n   *     let x = (i + 1) * 20;\n   *\n   *     // Draw the circle.\n   *     circle(x, 50, 15);\n   *   }\n   *\n   *   describe(\n   *     'A row of circles on a gray background. The two circles on the left are red and the two on the right are blue.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method boolean\n   * @param {Array} ns values to convert.\n   * @return {Boolean[]} converted Boolean values.\n   */\n  fn.boolean = function(n) {\n    if (typeof n === 'number') {\n      return n !== 0;\n    } else if (typeof n === 'string') {\n      return n.toLowerCase() === 'true';\n    } else if (typeof n === 'boolean') {\n      return n;\n    } else if (n instanceof Array) {\n      return n.map(fn.boolean);\n    }\n  };\n\n  /**\n   * Converts a `Boolean`, `String`, or `Number` to its byte value.\n   *\n   * `byte()` converts a value to an integer (whole number) between -128 and\n   * 127. Values greater than 127 wrap around while negative values are\n   * unchanged. For example, 128 becomes -128 and -129 remains the same.\n   *\n   * The parameter, `n`, is the value to convert. If `n` is a Boolean, as in\n   * `byte(false)` or `byte(true)`, the number 0 (`false`) or 1 (`true`) will be\n   * returned. If `n` is a string or number, as in `byte('256')` or `byte(256)`,\n   * then the byte value will be returned. Decimal values are ignored. If an\n   * array is passed, as in `byte([true, 123, '456'])`, then an array of byte\n   * values will be returned.\n   *\n   * Note: If a value can't be converted to a number, as in `byte('giraffe')`,\n   * then the value `NaN` (not a number) will be returned.\n   *\n   * @method byte\n   * @param {String|Boolean|Number} n value to convert.\n   * @return {Number} converted byte value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a Boolean variable.\n   *   let original = true;\n   *\n   *   // Convert the Boolean to its byte value.\n   *   let converted = byte(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} : ${converted}`, 50, 50);\n   *\n   *   describe('The text \"true : 1\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a string variable.\n   *   let original = '256';\n   *\n   *   // Convert the string to its byte value.\n   *   let converted = byte(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} : ${converted}`, 50, 50);\n   *\n   *   describe('The text \"256 : 0\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a number variable.\n   *   let original = 256;\n   *\n   *   // Convert the number to its byte value.\n   *   let converted = byte(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} : ${converted}`, 50, 50);\n   *\n   *   describe('The text \"256 : 0\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of values.\n   *   let original = [false, '64', 383];\n   *\n   *   // Convert the array elements to their byte values.\n   *   let converted = byte(original);\n   *\n   *   // Iterate over the converted array elements.\n   *   for (let i = 0; i < converted.length; i += 1) {\n   *\n   *     // Style the circle.\n   *     fill(converted[i]);\n   *\n   *     // Calculate the x-coordinate.\n   *     let x = (i + 1) * 25;\n   *\n   *     // Draw the circle.\n   *     circle(x, 50, 20);\n   *   }\n   *\n   *   describe(\n   *     'Three gray circles on a gray background. The circles get lighter from left to right.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method byte\n   * @param {Array} ns values to convert.\n   * @return {Number[]} converted byte values.\n   */\n  fn.byte = function(n) {\n    const nn = fn.int(n, 10);\n    if (typeof nn === 'number') {\n      return (nn + 128) % 256 - 128;\n    } else if (nn instanceof Array) {\n      return nn.map(fn.byte);\n    }\n  };\n\n  /**\n   * Converts a `Number` or `String` to a single-character `String`.\n   *\n   * `char()` converts numbers to their single-character string representations.\n   *\n   * The parameter, `n`, is the value to convert. If a number is passed, as in\n   * `char(65)`, the corresponding single-character string is returned. If a\n   * string is passed, as in `char('65')`, the string is converted to an integer\n   * (whole number) and the corresponding single-character string is returned.\n   * If an array is passed, as in `char([65, 66, 67])`, an array of\n   * single-character strings is returned.\n   *\n   * See <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/fromCharCode\" target=\"_blank\">MDN</a>\n   * for more information about conversions.\n   *\n   * @method char\n   * @param {String|Number} n value to convert.\n   * @return {String} converted single-character string.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a number variable.\n   *   let original = 65;\n   *\n   *   // Convert the number to a char.\n   *   let converted = char(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} : ${converted}`, 50, 50);\n   *\n   *   describe('The text \"65 : A\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a string variable.\n   *   let original = '65';\n   *\n   *   // Convert the string to a char.\n   *   let converted = char(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} : ${converted}`, 50, 50);\n   *\n   *   describe('The text \"65 : A\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of numbers.\n   *   let original = ['65', 66, '67'];\n   *\n   *   // Convert the string to a char.\n   *   let converted = char(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Iterate over elements of the converted array.\n   *   for (let i = 0; i < converted.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 25;\n   *\n   *     // Display the original and converted values.\n   *     text(`${original[i]} : ${converted[i]}`, 50, y);\n   *   }\n   *\n   *   describe(\n   *     'The text \"65 : A\", \"66 : B\", and \"67 : C\" written on three separate lines. The text is in black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method char\n   * @param {Array} ns values to convert.\n   * @return {String[]} converted single-character strings.\n   */\n  fn.char = function(n) {\n    if (typeof n === 'number' && !isNaN(n)) {\n      return String.fromCharCode(n);\n    } else if (n instanceof Array) {\n      return n.map(fn.char);\n    } else if (typeof n === 'string') {\n      return fn.char(parseInt(n, 10));\n    }\n  };\n\n  /**\n   * Converts a single-character `String` to a `Number`.\n   *\n   * `unchar()` converts single-character strings to their corresponding\n   * integer (whole number).\n   *\n   * The parameter, `n`, is the character to convert. For example,\n   * `unchar('A')`, returns the number 65. If an array is passed, as in\n   * `unchar(['A', 'B', 'C'])`, an array of integers is returned.\n   *\n   * @method unchar\n   * @param {String} n value to convert.\n   * @return {Number} converted number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a string variable.\n   *   let original = 'A';\n   *\n   *   // Convert the string to a number.\n   *   let converted = unchar(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} : ${converted}`, 50, 50);\n   *\n   *   describe('The text \"A : 65\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of characters.\n   *   let original = ['A', 'B', 'C'];\n   *\n   *   // Convert the string to a number.\n   *   let converted = unchar(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Iterate over elements of the converted array.\n   *   for (let i = 0; i < converted.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 25;\n   *\n   *     // Display the original and converted values.\n   *     text(`${original[i]} : ${converted[i]}`, 50, y);\n   *   }\n   *\n   *   describe(\n   *     'The text \"A : 65\", \"B : 66\", and \"C :67\" written on three separate lines. The text is in black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method unchar\n   * @param {String[]} ns values to convert.\n   * @return {Number[]} converted numbers.\n   */\n  fn.unchar = function(n) {\n    if (typeof n === 'string' && n.length === 1) {\n      return n.charCodeAt(0);\n    } else if (n instanceof Array) {\n      return n.map(fn.unchar);\n    }\n  };\n\n  /**\n   * Converts a `Number` to a `String` with its hexadecimal value.\n   *\n   * `hex()` converts a number to a string with its hexadecimal number value.\n   * Hexadecimal (hex) numbers are base-16, which means there are 16 unique\n   * digits. Hex extends the numbers 09 with the letters AF. For example, the\n   * number `11` (eleven) in base-10 is written as the letter `B` in hex.\n   *\n   * The first parameter, `n`, is the number to convert. For example, `hex(20)`,\n   * returns the string `'00000014'`. If an array is passed, as in\n   * `hex([1, 10, 100])`, an array of hexadecimal strings is returned.\n   *\n   * The second parameter, `digits`, is optional. If a number is passed, as in\n   * `hex(20, 2)`, it sets the number of hexadecimal digits to display. For\n   * example, calling `hex(20, 2)` returns the string `'14'`.\n   *\n   * @method hex\n   * @param {Number} n value to convert.\n   * @param {Number} [digits] number of digits to include.\n   * @return {String} converted hexadecimal value.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a number variable.\n   *   let original = 20;\n   *\n   *   // Convert the number to a hex string.\n   *   let converted = hex(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(14);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} = ${converted}`, 50, 50);\n   *\n   *   describe('The text \"20 = 00000014\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a number variable.\n   *   let original = 20;\n   *\n   *   // Convert the number to a hex string.\n   *   // Only display two hex digits.\n   *   let converted = hex(original, 2);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} = ${converted}`, 50, 50);\n   *\n   *   describe('The text \"20 = 14\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of numbers.\n   *   let original = [1, 10, 100];\n   *\n   *   // Convert the numbers to hex strings.\n   *   // Only use two hex digits.\n   *   let converted = hex(original, 2);\n   *\n   *   // Style the text.\n   *   textAlign(RIGHT, CENTER);\n   *   textSize(16);\n   *\n   *   // Iterate over the converted values.\n   *   for (let i = 0; i < converted.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 25;\n   *\n   *     // Display the original and converted values.\n   *     text(`${ original[i]} = ${converted[i]}`, 75, y);\n   *   }\n   *\n   *   describe(\n   *     'The text \"1 = 01\", \"10 = 0A\", and \"100 = 64\" written on three separate lines. The text is in black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method hex\n   * @param {Number[]} ns values to convert.\n   * @param {Number} [digits]\n   * @return {String[]} converted hexadecimal values.\n   */\n  fn.hex = function(n, digits) {\n    digits = digits === undefined || digits === null ? (digits = 8) : digits;\n    if (n instanceof Array) {\n      return n.map(n => fn.hex(n, digits));\n    } else if (n === Infinity || n === -Infinity) {\n      const c = n === Infinity ? 'F' : '0';\n      return c.repeat(digits);\n    } else if (typeof n === 'number') {\n      if (n < 0) {\n        n = 0xffffffff + n + 1;\n      }\n      let hex = Number(n)\n        .toString(16)\n        .toUpperCase();\n      while (hex.length < digits) {\n        hex = `0${hex}`;\n      }\n      if (hex.length >= digits) {\n        hex = hex.substring(hex.length - digits, hex.length);\n      }\n      return hex;\n    }\n  };\n\n  /**\n   * Converts a `String` with a hexadecimal value to a  `Number`.\n   *\n   * `unhex()` converts a string with its hexadecimal number value to a number.\n   * Hexadecimal (hex) numbers are base-16, which means there are 16 unique\n   * digits. Hex extends the numbers 09 with the letters AF. For example, the\n   * number `11` (eleven) in base-10 is written as the letter `B` in hex.\n   *\n   * The first parameter, `n`, is the hex string to convert. For example,\n   * `unhex('FF')`, returns the number 255. If an array is passed, as in\n   * `unhex(['00', '80', 'FF'])`, an array of numbers is returned.\n   *\n   * @method unhex\n   * @param {String} n value to convert.\n   * @return {Number} converted number.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a a hex string variable\n   *   let original = 'FF';\n   *\n   *   // Convert the hex string to a number.\n   *   let converted = unhex(original);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(16);\n   *\n   *   // Display the original and converted values.\n   *   text(`${original} = ${converted}`, 50, 50);\n   *\n   *   describe('The text \"FF = 255\" written in black on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of numbers.\n   *   let original = ['00', '80', 'FF'];\n   *\n   *   // Convert the numbers to hex strings.\n   *   // Only use two hex digits.\n   *   let converted = unhex(original, 2);\n   *\n   *   // Style the text.\n   *   textAlign(RIGHT, CENTER);\n   *   textSize(16);\n   *\n   *   // Iterate over the converted values.\n   *   for (let i = 0; i < converted.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 25;\n   *\n   *     // Display the original and converted values.\n   *     text(`${ original[i]} = ${converted[i]}`, 80, y);\n   *   }\n   *\n   *   describe(\n   *     'The text \"00 = 0\", \"80 = 128\", and \"FF = 255\" written on three separate lines. The text is in black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method unhex\n   * @param {String[]} ns values to convert.\n   * @return {Number[]} converted numbers.\n   */\n  fn.unhex = function(n) {\n    if (n instanceof Array) {\n      return n.map(fn.unhex);\n    } else {\n      return parseInt(`0x${n}`, 16);\n    }\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  conversion(p5, p5.prototype);\n}\n\nexport { conversion as default };\n","/**\n * @module Data\n * @submodule Utility Functions\n * @for p5\n * @requires core\n */\n\nfunction utilityFunctions(p5, fn){\n  /**\n   * Converts a `Number` into a `String` with a given number of digits.\n   *\n   * `nf()` converts numbers such as `123.45` into strings formatted with a set\n   * number of digits, as in `'123.4500'`.\n   *\n   * The first parameter, `num`, is the number to convert to a string. For\n   * example, calling `nf(123.45)` returns the string `'123.45'`. If an array of\n   * numbers is passed, as in `nf([123.45, 67.89])`, an array of formatted\n   * strings will be returned.\n   *\n   * The second parameter, `left`, is optional. If a number is passed, as in\n   * `nf(123.45, 4)`, it sets the minimum number of digits to include to the\n   * left of the decimal place. If `left` is larger than the number of digits in\n   * `num`, then unused digits will be set to 0. For example, calling\n   * `nf(123.45, 4)` returns the string `'0123.45'`.\n   *\n   * The third parameter, `right`, is also optional. If a number is passed, as\n   * in `nf(123.45, 4, 1)`, it sets the minimum number of digits to include to\n   * the right of the decimal place. If `right` is smaller than the number of\n   * decimal places in `num`, then `num` will be rounded to the given number of\n   * decimal places. For example, calling `nf(123.45, 4, 1)` returns the string\n   * `'0123.5'`. If right is larger than the number of decimal places in `num`,\n   * then unused decimal places will be set to 0. For example, calling\n   * `nf(123.45, 4, 3)` returns the string `'0123.450'`.\n   *\n   * When the number is negative, for example, calling `nf(-123.45, 5, 2)`\n   * returns the string `'-00123.45'`.\n   *\n   * @method nf\n   * @param {Number|String} num number to format.\n   * @param {Integer|String} [left] number of digits to include to the left of\n   *                                the decimal point.\n   * @param {Integer|String} [right] number of digits to include to the right\n   *                                 of the decimal point.\n   * @return {String} formatted string.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textSize(16);\n   *\n   *   // Create a number variable.\n   *   let number = 123.45;\n   *\n   *   // Display the number as a string.\n   *   let formatted = nf(number);\n   *   text(formatted, 20, 20);\n   *\n   *   let negative = nf(-number, 4, 2);\n   *   text(negative, 20, 40);\n   *\n   *   // Display the number with four digits\n   *   // to the left of the decimal.\n   *   let left = nf(number, 4);\n   *   text(left, 20, 60);\n   *\n   *   // Display the number with four digits\n   *   // to the left of the decimal and one\n   *   // to the right.\n   *   let right = nf(number, 4, 1);\n   *   text(right, 20, 80);\n   *\n   *   describe(\n   *     'The numbers \"123.45\", \"-0123.45\", \"0123.45\", and \"0123.5\" written on four separate lines. The text is in black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method nf\n   * @param {Number[]} nums numbers to format.\n   * @param {Integer|String} [left]\n   * @param {Integer|String} [right]\n   * @return {String[]} formatted strings.\n   */\n  fn.nf = function(nums, left, right) {\n    // p5._validateParameters('nf', arguments);\n    if (nums instanceof Array) {\n      return nums.map(x => doNf(x, left, right));\n    } else {\n      const typeOfFirst = Object.prototype.toString.call(nums);\n      if (typeOfFirst === '[object Arguments]') {\n        if (nums.length === 3) {\n          return this.nf(nums[0], nums[1], nums[2]);\n        } else if (nums.length === 2) {\n          return this.nf(nums[0], nums[1]);\n        } else {\n          return this.nf(nums[0]);\n        }\n      } else {\n        return doNf(nums, left, right);\n      }\n    }\n  };\n\n  function doNf(num, left, right) {\n    let isNegative = num < 0;\n    num = Math.abs(num);\n    let [leftPart, rightPart] = num.toString().split('.');\n\n    if (typeof right === 'undefined') {\n      leftPart = leftPart.padStart(left, '0');\n      let result = rightPart ? leftPart + '.' + rightPart : leftPart;\n      return isNegative ? '-' + result : result;\n    } else {\n      let roundedOff = num.toFixed(right);\n      [leftPart, rightPart] = roundedOff.toString().split('.');\n      leftPart = leftPart.padStart(left, '0');\n      let result = typeof rightPart === 'undefined' ? leftPart : leftPart + '.' + rightPart;\n      return isNegative ? '-' + result : result;\n    }\n  }\n\n  /**\n   * Converts a `Number` into a `String` with commas to mark units of 1,000.\n   *\n   * `nfc()` converts numbers such as 12345 into strings formatted with commas\n   * to mark the thousands place, as in `'12,345'`.\n   *\n   * The first parameter, `num`, is the number to convert to a string. For\n   * example, calling `nfc(12345)` returns the string `'12,345'`.\n   *\n   * The second parameter, `right`, is optional. If a number is passed, as in\n   * `nfc(12345, 1)`, it sets the minimum number of digits to include to the\n   * right of the decimal place. If `right` is smaller than the number of\n   * decimal places in `num`, then `num` will be rounded to the given number of\n   * decimal places. For example, calling `nfc(12345.67, 1)` returns the string\n   * `'12,345.7'`. If `right` is larger than the number of decimal places in\n   * `num`, then unused decimal places will be set to 0. For example, calling\n   * `nfc(12345.67, 3)` returns the string `'12,345.670'`.\n   *\n   * @method nfc\n   * @param  {Number|String} num number to format.\n   * @param  {Integer|String} [right] number of digits to include to the right\n   *                                  of the decimal point.\n   * @return {String} formatted string.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textSize(16);\n   *\n   *   // Create a number variable.\n   *   let number = 12345;\n   *\n   *   // Display the number as a string.\n   *   let commas = nfc(number);\n   *   text(commas, 15, 33);\n   *\n   *   // Display the number with four digits\n   *   // to the left of the decimal.\n   *   let decimals = nfc(number, 2);\n   *   text(decimals, 15, 67);\n   *\n   *   describe(\n   *     'The numbers \"12,345\" and \"12,345.00\" written on separate lines. The text is in black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of numbers.\n   *   let numbers = [12345, 6789];\n   *\n   *   // Convert the numbers to formatted strings.\n   *   let formatted = nfc(numbers);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(14);\n   *\n   *   // Iterate over the array.\n   *   for (let i = 0; i < formatted.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 33;\n   *\n   *     // Display the original and formatted numbers.\n   *     text(`${numbers[i]} : ${formatted[i]}`, 50, y);\n   *   }\n   *\n   *   describe(\n   *     'The text \"12345 : 12,345\" and \"6789 : 6,789\" written on two separate lines. The text is in black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method nfc\n   * @param  {Number[]} nums numbers to format.\n   * @param  {Integer|String} [right]\n   * @return {String[]} formatted strings.\n   */\n  fn.nfc = function(num, right) {\n    // p5._validateParameters('nfc', arguments);\n    if (num instanceof Array) {\n      return num.map(x => doNfc(x, right));\n    } else {\n      return doNfc(num, right);\n    }\n  };\n  function doNfc(num, right) {\n    num = num.toString();\n    const dec = num.indexOf('.');\n    let rem = dec !== -1 ? num.substring(dec) : '';\n    let n = dec !== -1 ? num.substring(0, dec) : num;\n    n = n.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n    if (right === 0) {\n      rem = '';\n    } else if (typeof right !== 'undefined') {\n      if (right > rem.length) {\n        rem += dec === -1 ? '.' : '';\n        const len = right - rem.length + 1;\n        for (let i = 0; i < len; i++) {\n          rem += '0';\n        }\n      } else {\n        rem = rem.substring(0, right + 1);\n      }\n    }\n    return n + rem;\n  }\n\n  /**\n   * Converts a `Number` into a `String` with a plus or minus sign.\n   *\n   * `nfp()` converts numbers such as 123 into strings formatted with a `+` or\n   * `-` symbol to mark whether they're positive or negative, as in `'+123'`.\n   *\n   * The first parameter, `num`, is the number to convert to a string. For\n   * example, calling `nfp(123.45)` returns the string `'+123.45'`. If an array\n   * of numbers is passed, as in `nfp([123.45, -6.78])`, an array of formatted\n   * strings will be returned.\n   *\n   * The second parameter, `left`, is optional. If a number is passed, as in\n   * `nfp(123.45, 4)`, it sets the minimum number of digits to include to the\n   * left of the decimal place. If `left` is larger than the number of digits in\n   * `num`, then unused digits will be set to 0. For example, calling\n   * `nfp(123.45, 4)` returns the string `'+0123.45'`.\n   *\n   * The third parameter, `right`, is also optional. If a number is passed, as\n   * in `nfp(123.45, 4, 1)`, it sets the minimum number of digits to include to\n   * the right of the decimal place. If `right` is smaller than the number of\n   * decimal places in `num`, then `num` will be rounded to the given number of\n   * decimal places.  For example, calling `nfp(123.45, 4, 1)` returns the\n   * string `'+0123.5'`. If `right` is larger than the number of decimal places\n   * in `num`, then unused decimal places will be set to 0.  For example,\n   * calling `nfp(123.45, 4, 3)` returns the string `'+0123.450'`.\n   *\n   * @method nfp\n   * @param {Number} num number to format.\n   * @param {Integer} [left] number of digits to include to the left of the\n   *                         decimal point.\n   * @param {Integer} [right] number of digits to include to the right of the\n   *                          decimal point.\n   * @return {String} formatted string.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create number variables.\n   *   let positive = 123;\n   *   let negative = -123;\n   *\n   *   // Convert the positive number to a formatted string.\n   *   let p = nfp(positive);\n   *\n   *   // Convert the negative number to a formatted string\n   *   // with four digits to the left of the decimal\n   *   // and two digits to the right of the decimal.\n   *   let n = nfp(negative, 4, 2);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(14);\n   *\n   *   // Display the original and formatted numbers.\n   *   text(`${positive} : ${p}`, 50, 33);\n   *   text(`${negative} : ${n}`, 50, 67);\n   *\n   *   describe(\n   *     'The text \"123 : +123\" and \"-123 : -123.00\" written on separate lines. The text is in black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create number variables.\n   *   let numbers = [123, -4.56];\n   *\n   *   // Convert the numbers to formatted strings\n   *   // with four digits to the left of the decimal\n   *   // and one digit to the right of the decimal.\n   *   let formatted = nfp(numbers, 4, 1);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textSize(14);\n   *\n   *   // Iterate over the array.\n   *   for (let i = 0; i < formatted.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 33;\n   *\n   *     // Display the original and formatted numbers.\n   *     text(`${numbers[i]} : ${formatted[i]}`, 50, y);\n   *   }\n   *\n   *   describe(\n   *     'The text \"123 : +0123.0\" and \"-4.56 : 00-4.6\" written on separate lines. The text is in black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method nfp\n   * @param {Number[]} nums numbers to format.\n   * @param {Integer} [left]\n   * @param {Integer} [right]\n   * @return {String[]} formatted strings.\n   */\n  fn.nfp = function(...args) {\n    // p5._validateParameters('nfp', args);\n    const nfRes = fn.nf.apply(this, args);\n    if (nfRes instanceof Array) {\n      return nfRes.map(addNfp);\n    } else {\n      return addNfp(nfRes);\n    }\n  };\n\n  function addNfp(num) {\n    return parseFloat(num) > 0 ? `+${num.toString()}` : num.toString();\n  }\n\n  /**\n   * Converts a positive `Number` into a `String` with an extra space in front.\n   *\n   * `nfs()` converts positive numbers such as 123.45 into strings formatted\n   * with an extra space in front, as in ' 123.45'. Doing so can be helpful for\n   * aligning positive and negative numbers.\n   *\n   * The first parameter, `num`, is the number to convert to a string. For\n   * example, calling `nfs(123.45)` returns the string `' 123.45'`.\n   *\n   * The second parameter, `left`, is optional. If a number is passed, as in\n   * `nfs(123.45, 4)`, it sets the minimum number of digits to include to the\n   * left of the decimal place. If `left` is larger than the number of digits in\n   * `num`, then unused digits will be set to 0. For example, calling\n   * `nfs(123.45, 4)` returns the string `' 0123.45'`.\n   *\n   * The third parameter, `right`, is also optional. If a number is passed, as\n   * in `nfs(123.45, 4, 1)`, it sets the minimum number of digits to include to\n   * the right of the decimal place. If `right` is smaller than the number of\n   * decimal places in `num`, then `num` will be rounded to the given number of\n   * decimal places.  For example, calling `nfs(123.45, 4, 1)` returns the\n   * string `' 0123.5'`. If `right` is larger than the number of decimal places\n   * in `num`, then unused decimal places will be set to 0.  For example,\n   * calling `nfs(123.45, 4, 3)` returns the string `' 0123.450'`.\n   *\n   * @method nfs\n   * @param {Number} num number to format.\n   * @param {Integer} [left] number of digits to include to the left of the\n   *                         decimal point.\n   * @param {Integer} [right] number of digits to include to the right of the\n   *                          decimal point.\n   * @return {String} formatted string.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create number variables.\n   *   let positive = 123;\n   *   let negative = -123;\n   *\n   *   // Convert the positive number to a formatted string.\n   *   let formatted = nfs(positive);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(16);\n   *\n   *   // Display the negative number and the formatted positive number.\n   *   text(negative, 50, 33);\n   *   text(formatted, 50, 67);\n   *\n   *   describe(\n   *     'The numbers -123 and 123 written on separate lines. The numbers align vertically. The text is in black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a number variable.\n   *   let number = 123.45;\n   *\n   *   // Convert the positive number to a formatted string.\n   *   // Use four digits to the left of the decimal and\n   *   // one digit to the right.\n   *   let formatted = nfs(number, 4, 1);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(16);\n   *\n   *   // Display a negative version of the number and\n   *   // the formatted positive version.\n   *   text('-0123.5', 50, 33);\n   *   text(formatted, 50, 67);\n   *\n   *   describe(\n   *     'The numbers \"-0123.5\" and \"0123.5\" written on separate lines. The numbers align vertically. The text is in black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method nfs\n   * @param {Array} nums numbers to format.\n   * @param {Integer} [left]\n   * @param {Integer} [right]\n   * @return {String[]} formatted strings.\n   */\n  fn.nfs = function(...args) {\n    // p5._validateParameters('nfs', args);\n    const nfRes = fn.nf.apply(this, args);\n    if (nfRes instanceof Array) {\n      return nfRes.map(addNfs);\n    } else {\n      return addNfs(nfRes);\n    }\n  };\n\n  function addNfs(num) {\n    return parseFloat(num) >= 0 ? ` ${num.toString()}` : num.toString();\n  }\n\n  /**\n   * Splits a `String` into pieces and returns an array containing the pieces.\n   *\n   * `splitTokens()` is an enhanced version of\n   * <a href=\"#/p5/split\">split()</a>. It can split a string when any characters\n   * from a list are detected.\n   *\n   * The first parameter, `value`, is the string to split.\n   *\n   * The second parameter, `delim`, is optional. It sets the character(s) that\n   * should be used to split the string. `delim` can be a single string, as in\n   * `splitTokens('rock...paper...scissors...shoot', '...')`, or an array of\n   * strings, as in\n   * `splitTokens('rock;paper,scissors...shoot, [';', ',', '...'])`. By default,\n   * if no `delim` characters are specified, then any whitespace character is\n   * used to split. Whitespace characters include tab (`\\t`), line feed (`\\n`),\n   * carriage return (`\\r`), form feed (`\\f`), and space.\n   *\n   * @method splitTokens\n   * @deprecated This will be removed in a future version of p5.js to make way for a new, friendlier version :)\n   * @param  {String} value string to split.\n   * @param  {String} [delim] character(s) to use for splitting the string.\n   * @return {String[]} separated strings.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a string variable.\n   *   let string = 'rock paper scissors shoot';\n   *\n   *   // Split the string at each space.\n   *   let words = splitTokens(string);\n   *\n   *   // Print the array to the console.\n   *   print(words);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Iterate over the words array.\n   *   for (let i = 0; i < words.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 20;\n   *\n   *     // Display the word.\n   *     text(words[i], 50, y);\n   *   }\n   *\n   *   describe(\n   *     'The words \"rock\", \"paper\", \"scissors\", and \"shoot\" written on separate lines. The text is black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a string variable.\n   *   let string = 'rock...paper...scissors...shoot';\n   *\n   *   // Split the string at each ...\n   *   let words = splitTokens(string, '...');\n   *\n   *   // Print the array to the console.\n   *   print(words);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Iterate over the words array.\n   *   for (let i = 0; i < words.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 20;\n   *\n   *     // Display the word.\n   *     text(words[i], 50, y);\n   *   }\n   *\n   *   describe(\n   *     'The words \"rock\", \"paper\", \"scissors\", and \"shoot\" written on separate lines. The text is black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='notest'>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create a string variable.\n   *   let string = 'rock;paper,scissors...shoot';\n   *\n   *   // Split the string at each semicolon, comma, or ...\n   *   let words = splitTokens(string, [';', ',', '...']);\n   *\n   *   // Print the array to the console.\n   *   print(words);\n   *\n   *   // Style the text.\n   *   textAlign(CENTER, CENTER);\n   *   textFont('Courier New');\n   *   textSize(12);\n   *\n   *   // Iterate over the words array.\n   *   for (let i = 0; i < words.length; i += 1) {\n   *\n   *     // Calculate the y-coordinate.\n   *     let y = (i + 1) * 20;\n   *\n   *     // Display the word.\n   *     text(words[i], 50, y);\n   *   }\n   *\n   *   describe(\n   *     'The words \"rock\", \"paper\", \"scissors\", and \"shoot\" written on separate lines. The text is black on a gray background.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  fn.splitTokens = function(value, delims) {\n    // p5._validateParameters('splitTokens', arguments);\n    let d;\n    if (typeof delims !== 'undefined') {\n      let str = delims;\n      const sqc = /\\]/g.exec(str);\n      let sqo = /\\[/g.exec(str);\n      if (sqo && sqc) {\n        str = str.slice(0, sqc.index) + str.slice(sqc.index + 1);\n        sqo = /\\[/g.exec(str);\n        str = str.slice(0, sqo.index) + str.slice(sqo.index + 1);\n        d = new RegExp(`[\\\\[${str}\\\\]]`, 'g');\n      } else if (sqc) {\n        str = str.slice(0, sqc.index) + str.slice(sqc.index + 1);\n        d = new RegExp(`[${str}\\\\]]`, 'g');\n      } else if (sqo) {\n        str = str.slice(0, sqo.index) + str.slice(sqo.index + 1);\n        d = new RegExp(`[${str}\\\\[]`, 'g');\n      } else {\n        d = new RegExp(`[${str}]`, 'g');\n      }\n    } else {\n      d = /\\s/g;\n    }\n    return value.split(d).filter(n => n);\n  };\n\n  /**\n   * Shuffles the elements of an array.\n   *\n   * The first parameter, `array`, is the array to be shuffled. For example,\n   * calling `shuffle(myArray)` will shuffle the elements of `myArray`. By\n   * default, the original array wont be modified. Instead, a copy will be\n   * created, shuffled, and returned.\n   *\n   * The second parameter, `modify`, is optional. If `true` is passed, as in\n   * `shuffle(myArray, true)`, then the array will be shuffled in place without\n   * making a copy.\n   *\n   * @method shuffle\n   * @param  {Array} array array to shuffle.\n   * @param  {Boolean} [bool] if `true`, shuffle the original array in place. Defaults to `false`.\n   * @return {Array} shuffled array.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of colors.\n   *   let colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet'];\n   *\n   *   // Create a shuffled copy of the array.\n   *   let shuffledColors = shuffle(colors);\n   *\n   *   // Draw  a row of circles using the original array.\n   *   for (let i = 0; i < colors.length; i += 1) {\n   *     // Calculate the x-coordinate.\n   *     let x = (i + 1) * 12.5;\n   *\n   *     // Style the circle.\n   *     let c = colors[i];\n   *     fill(c);\n   *\n   *     // Draw the circle.\n   *     circle(x, 33, 10);\n   *   }\n   *\n   *   // Draw  a row of circles using the original array.\n   *   for (let i = 0; i < shuffledColors.length; i += 1) {\n   *     // Calculate the x-coordinate.\n   *     let x = (i + 1) * 12.5;\n   *\n   *     // Style the circle.\n   *     let c = shuffledColors[i];\n   *     fill(c);\n   *\n   *     // Draw the circle.\n   *     circle(x, 67, 10);\n   *   }\n   *\n   *   describe(\n   *     'Two rows of circles on a gray background. The top row follows the color sequence ROYGBIV. The bottom row has all the same colors but they are shuffled.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Create an array of colors.\n   *   let colors = ['red', 'orange', 'yellow', 'green', 'blue', 'indigo', 'violet'];\n   *\n   *   // Shuffle the array.\n   *   shuffle(colors, true);\n   *\n   *   // Draw  a row of circles using the original array.\n   *   for (let i = 0; i < colors.length; i += 1) {\n   *     // Calculate the x-coordinate.\n   *     let x = (i + 1) * 12.5;\n   *\n   *     // Style the circle.\n   *     let c = colors[i];\n   *     fill(c);\n   *\n   *     // Draw the circle.\n   *     circle(x, 50, 10);\n   *   }\n   *\n   *   describe(\n   *     'A row of colorful circles on a gray background. Their sequence changes each time the sketch runs.'\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  fn.shuffle = function (arr, bool) {\n    const isView = ArrayBuffer && ArrayBuffer.isView && ArrayBuffer.isView(arr);\n    arr = bool || isView ? arr : arr.slice();\n\n    let rnd,\n      tmp,\n      idx = arr.length;\n    while (idx > 1) {\n      rnd = (this.random(0, 1) * idx) | 0;\n\n      tmp = arr[--idx];\n      arr[idx] = arr[rnd];\n      arr[rnd] = tmp;\n    }\n\n    return arr;\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  utilityFunctions(p5, p5.prototype);\n}\n\nexport { utilityFunctions as default };\n","/**\n * @module IO\n * @submodule Time & Date\n * @for p5\n * @requires core\n */\n\nfunction timeDate(p5, fn){\n  /**\n   * Returns the current day as a number from 131.\n   *\n   * @method day\n   * @return {Integer} current day between 1 and 31.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the current day.\n   *   let d = day();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textSize(12);\n   *   textFont('Courier New');\n   *\n   *   // Display the day.\n   *   text(`Current day: ${d}`, 20, 50, 60);\n   *\n   *   describe(`The text 'Current day: ${d}' written in black on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.day = function() {\n    return new Date().getDate();\n  };\n\n  /**\n   * Returns the current hour as a number from 023.\n   *\n   * @method hour\n   * @return {Integer} current hour between 0 and 23.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the current hour.\n   *   let h = hour();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textSize(12);\n   *   textFont('Courier New');\n   *\n   *   // Display the hour.\n   *   text(`Current hour: ${h}`, 20, 50, 60);\n   *\n   *   describe(`The text 'Current hour: ${h}' written in black on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.hour = function() {\n    return new Date().getHours();\n  };\n\n  /**\n   * Returns the current minute as a number from 059.\n   *\n   * @method minute\n   * @return {Integer} current minute between 0 and 59.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the current minute.\n   *   let m = minute();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textSize(12);\n   *   textFont('Courier New');\n   *\n   *   // Display the minute.\n   *   text(`Current minute: ${m}`, 10, 50, 80);\n   *\n   *   describe(`The text 'Current minute: ${m}' written in black on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.minute = function() {\n    return new Date().getMinutes();\n  };\n\n  /**\n   * Returns the number of milliseconds since a sketch started running.\n   *\n   * `millis()` keeps track of how long a sketch has been running in\n   * milliseconds (thousandths of a second). This information is often\n   * helpful for timing events and animations.\n   *\n   * If a sketch has a\n   * <a href=\"#/p5/setup\">setup()</a> function, then `millis()` begins tracking\n   * time before the code in <a href=\"#/p5/setup\">setup()</a> runs.  If a\n   * sketch includes asynchronous loading using `async`/`await`, then\n   * `millis()` begins tracking time as soon as the asynchronous code\n   * starts running.\n   * @method millis\n   * @return {Number} number of milliseconds since starting the sketch.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the number of milliseconds the sketch has run.\n   *   let ms = millis();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textSize(10);\n   *   textFont('Courier New');\n   *\n   *   // Display how long it took setup() to be called.\n   *   text(`Startup time: ${round(ms, 2)} ms`, 5, 50, 90);\n   *\n   *   describe(\n   *     `The text 'Startup time: ${round(ms, 2)} ms' written in black on a gray background.`\n   *   );\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('The text \"Running time: S sec\" written in black on a gray background. The number S increases as the sketch runs.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Get the number of seconds the sketch has run.\n   *   let s = millis() / 1000;\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textSize(10);\n   *   textFont('Courier New');\n   *\n   *   // Display how long the sketch has run.\n   *   text(`Running time: ${nf(s, 1, 1)} sec`, 5, 50, 90);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   describe('A white circle oscillates left and right on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Get the number of seconds the sketch has run.\n   *   let s = millis() / 1000;\n   *\n   *   // Calculate an x-coordinate.\n   *   let x = 30 * sin(s) + 50;\n   *\n   *   // Draw the circle.\n   *   circle(x, 50, 30);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * async function setup() {\n   *   // Load the GeoJSON.\n   *   await loadJSON('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson');\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the number of milliseconds the sketch has run.\n   *   let ms = millis();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textFont('Courier New');\n   *   textSize(11);\n   *\n   *   // Display how long it took to load the data.\n   *   text(`It took ${round(ms, 2)} ms to load the data`, 5, 50, 100);\n   *\n   *   describe(\n   *     `The text \"It took ${round(ms, 2)} ms to load the data\" written in black on a gray background.`\n   *   );\n   * }\n   * </code>\n   * </div>\n   */\n  fn.millis = function() {\n    if (this._millisStart === -1) {\n      // Sketch has not started\n      return 0;\n    } else {\n      return window.performance.now() - this._millisStart;\n    }\n  };\n\n  /**\n   * Returns the current month as a number from 112.\n   *\n   * @method month\n   * @return {Integer} current month between 1 and 12.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the current month.\n   *   let m = month();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textSize(12);\n   *   textFont('Courier New');\n   *\n   *   // Display the month.\n   *   text(`Current month: ${m}`, 10, 50, 80);\n   *\n   *   describe(`The text 'Current month: ${m}' written in black on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.month = function() {\n    //January is 0!\n    return new Date().getMonth() + 1;\n  };\n\n  /**\n   * Returns the current second as a number from 059.\n   *\n   * @method second\n   * @return {Integer} current second between 0 and 59.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the current second.\n   *   let s = second();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textSize(12);\n   *   textFont('Courier New');\n   *\n   *   // Display the second.\n   *   text(`Current second: ${s}`, 10, 50, 80);\n   *\n   *   describe(`The text 'Current second: ${s}' written in black on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.second = function() {\n    return new Date().getSeconds();\n  };\n\n  /**\n   * Returns the current year as a number such as 1999.\n   *\n   * @method year\n   * @return {Integer} current year.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Get the current year.\n   *   let y = year();\n   *\n   *   // Style the text.\n   *   textAlign(LEFT, CENTER);\n   *   textSize(12);\n   *   textFont('Courier New');\n   *\n   *   // Display the year.\n   *   text(`Current year: ${y}`, 10, 50, 80);\n   *\n   *   describe(`The text 'Current year: ${y}' written in black on a gray background.`);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.year = function() {\n    return new Date().getFullYear();\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  timeDate(p5, p5.prototype);\n}\n\nexport { timeDate as default };\n","import { G as GRID, A as AXES } from '../constants-8IpwyBct.js';\nimport { Vector } from '../math/p5.Vector.js';\n\n/**\n * @module 3D\n * @submodule Interaction\n * @for p5\n * @requires core\n */\n\n\nfunction interaction(p5, fn){\n  /**\n   * Allows the user to orbit around a 3D sketch using a mouse, trackpad, or\n   * touchscreen.\n   *\n   * 3D sketches are viewed through an imaginary camera. Calling\n   * `orbitControl()` within the <a href=\"#/p5/draw\">draw()</a> function allows\n   * the user to change the cameras position:\n   *\n   * ```js\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Rest of sketch.\n   * }\n   * ```\n   *\n   * Left-clicking and dragging or swipe motion will rotate the camera position\n   * about the center of the sketch. Right-clicking and dragging or multi-swipe\n   * will pan the camera position without rotation. Using the mouse wheel\n   * (scrolling) or pinch in/out will move the camera further or closer from the\n   * center of the sketch.\n   *\n   * The first three parameters, `sensitivityX`, `sensitivityY`, and\n   * `sensitivityZ`, are optional. Theyre numbers that set the sketchs\n   * sensitivity to movement along each axis. For example, calling\n   * `orbitControl(1, 2, -1)` keeps movement along the x-axis at its default\n   * value, makes the sketch twice as sensitive to movement along the y-axis,\n   * and reverses motion along the z-axis. By default, all sensitivity values\n   * are 1.\n   *\n   * The fourth parameter, `options`, is also optional. Its an object that\n   * changes the behavior of orbiting. For example, calling\n   * `orbitControl(1, 1, 1, options)` keeps the default sensitivity values while\n   * changing the behaviors set with `options`. The object can have the\n   * following properties:\n   *\n   * ```js\n   * let options = {\n   *   // Setting this to false makes mobile interactions smoother by\n   *   // preventing accidental interactions with the page while orbiting.\n   *   // By default, it's true.\n   *   disableTouchActions: true,\n   *\n   *   // Setting this to true makes the camera always rotate in the\n   *   // direction the mouse/touch is moving.\n   *   // By default, it's false.\n   *   freeRotation: false\n   * };\n   *\n   * orbitControl(1, 1, 1, options);\n   * ```\n   *\n   * @method orbitControl\n   * @for p5\n   * @param  {Number} [sensitivityX] sensitivity to movement along the x-axis. Defaults to 1.\n   * @param  {Number} [sensitivityY] sensitivity to movement along the y-axis. Defaults to 1.\n   * @param  {Number} [sensitivityZ] sensitivity to movement along the z-axis. Defaults to 1.\n   * @param  {Object} [options] object with two optional properties, `disableTouchActions`\n   *                            and `freeRotation`. Both are `Boolean`s. `disableTouchActions`\n   *                            defaults to `true` and `freeRotation` defaults to `false`.\n   * @chainable\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A multicolor box on a gray background. The camera angle changes when the user interacts using a mouse, trackpad, or touchscreen.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the box.\n   *   normalMaterial();\n   *\n   *   // Draw the box.\n   *   box(30, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A multicolor box on a gray background. The camera angle changes when the user interacts using a mouse, trackpad, or touchscreen.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   // Make the interactions 3X sensitive.\n   *   orbitControl(3, 3, 3);\n   *\n   *   // Style the box.\n   *   normalMaterial();\n   *\n   *   // Draw the box.\n   *   box(30, 50);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A multicolor box on a gray background. The camera angle changes when the user interacts using a mouse, trackpad, or touchscreen.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Create an options object.\n   *   let options = {\n   *     disableTouchActions: false,\n   *     freeRotation: true\n   *   };\n   *\n   *   // Enable orbiting with the mouse.\n   *   // Prevent accidental touch actions on touchscreen devices\n   *   // and enable free rotation.\n   *   orbitControl(1, 1, 1, options);\n   *\n   *   // Style the box.\n   *   normalMaterial();\n   *\n   *   // Draw the box.\n   *   box(30, 50);\n   * }\n   * </code>\n   * </div>\n   */\n\n  // implementation based on three.js 'orbitControls':\n  // https://github.com/mrdoob/three.js/blob/6afb8595c0bf8b2e72818e42b64e6fe22707d896/examples/jsm/controls/OrbitControls.js#L22\n  fn.orbitControl = function(\n    sensitivityX,\n    sensitivityY,\n    sensitivityZ,\n    options\n  ) {\n    this._assert3d('orbitControl');\n    // p5._validateParameters('orbitControl', arguments);\n\n    const cam = this._renderer.states.curCamera;\n\n    if (typeof sensitivityX === 'undefined') {\n      sensitivityX = 1;\n    }\n    if (typeof sensitivityY === 'undefined') {\n      sensitivityY = sensitivityX;\n    }\n    if (typeof sensitivityZ === 'undefined') {\n      sensitivityZ = 1;\n    }\n    if (typeof options !== 'object') {\n      options = {};\n    }\n\n    // default right-mouse and mouse-wheel behaviors (context menu and scrolling,\n    // respectively) are disabled here to allow use of those events for panning and\n    // zooming. However, whether or not to disable touch actions is an option.\n\n    // disable context menu for canvas element and add 'contextMenuDisabled'\n    // flag to p5 instance\n    if (this.contextMenuDisabled !== true) {\n      this.canvas.oncontextmenu = () => false;\n      this.contextMenuDisabled = true;\n    }\n\n    // disable default scrolling behavior on the canvas element and add\n    // 'wheelDefaultDisabled' flag to p5 instance\n    if (this.wheelDefaultDisabled !== true) {\n      this.canvas.onwheel = () => false;\n      this.wheelDefaultDisabled = true;\n    }\n\n    // disable default touch behavior on the canvas element and add\n    // 'touchActionsDisabled' flag to p5 instance\n    const { disableTouchActions = true } = options;\n    if (this.touchActionsDisabled !== true && disableTouchActions) {\n      this.canvas.style['touch-action'] = 'none';\n      this.touchActionsDisabled = true;\n    }\n\n    // If option.freeRotation is true, the camera always rotates freely in the direction\n    // the pointer moves. default value is false (normal behavior)\n    const { freeRotation = false } = options;\n\n    // get moved touches.\n    const movedTouches = [];\n\n    this.touches.forEach(curTouch => {\n      this._renderer.prevTouches.forEach(prevTouch => {\n        if (curTouch.id === prevTouch.id) {\n          const movedTouch = {\n            x: curTouch.x,\n            y: curTouch.y,\n            px: prevTouch.x,\n            py: prevTouch.y\n          };\n          movedTouches.push(movedTouch);\n        }\n      });\n    });\n\n    this._renderer.prevTouches = this.touches;\n\n    // The idea of using damping is based on the following website. thank you.\n    // https://github.com/freshfork/p5.EasyCam/blob/9782964680f6a5c4c9bee825c475d9f2021d5134/p5.easycam.js#L1124\n\n    // variables for interaction\n    let deltaRadius = 0;\n    let deltaTheta = 0;\n    let deltaPhi = 0;\n    let moveDeltaX = 0;\n    let moveDeltaY = 0;\n    // constants for dampingProcess\n    const damping = 0.85;\n    const rotateAccelerationFactor = 0.6;\n    const moveAccelerationFactor = 0.15;\n    // For touches, the appropriate scale is different\n    // because the distance difference is multiplied.\n    const mouseZoomScaleFactor = 0.01;\n    const touchZoomScaleFactor = 0.0004;\n    const scaleFactor = this.height < this.width ? this.height : this.width;\n    // Flag whether the mouse or touch pointer is inside the canvas\n    let pointersInCanvas = false;\n\n    // calculate and determine flags and variables.\n    if (movedTouches.length > 0) {\n      /* for touch */\n      // if length === 1, rotate\n      // if length > 1, zoom and move\n\n      // for touch, it is calculated based on one moved touch pointer position.\n      pointersInCanvas =\n        movedTouches[0].x > 0 && movedTouches[0].x < this.width &&\n        movedTouches[0].y > 0 && movedTouches[0].y < this.height;\n\n      if (movedTouches.length === 1) {\n        const t = movedTouches[0];\n        deltaTheta = -sensitivityX * (t.x - t.px) / scaleFactor;\n        deltaPhi = sensitivityY * (t.y - t.py) / scaleFactor;\n      } else {\n        const t0 = movedTouches[0];\n        const t1 = movedTouches[1];\n        const distWithTouches = Math.hypot(t0.x - t1.x, t0.y - t1.y);\n        const prevDistWithTouches = Math.hypot(t0.px - t1.px, t0.py - t1.py);\n        const changeDist = distWithTouches - prevDistWithTouches;\n        // move the camera farther when the distance between the two touch points\n        // decreases, move the camera closer when it increases.\n        deltaRadius = -changeDist * sensitivityZ * touchZoomScaleFactor;\n        // Move the center of the camera along with the movement of\n        // the center of gravity of the two touch points.\n        moveDeltaX = 0.5 * (t0.x + t1.x) - 0.5 * (t0.px + t1.px);\n        moveDeltaY = 0.5 * (t0.y + t1.y) - 0.5 * (t0.py + t1.py);\n      }\n      if (this.touches.length > 0) {\n        if (pointersInCanvas) {\n          // Initiate an interaction if touched in the canvas\n          this._renderer.executeRotateAndMove = true;\n          this._renderer.executeZoom = true;\n        }\n      } else {\n        // End an interaction when the touch is released\n        this._renderer.executeRotateAndMove = false;\n        this._renderer.executeZoom = false;\n      }\n    } else {\n      /* for mouse */\n      // if wheelDeltaY !== 0, zoom\n      // if mouseLeftButton is down, rotate\n      // if mouseRightButton is down, move\n\n      // For mouse, it is calculated based on the mouse position.\n      pointersInCanvas =\n        (this.mouseX > 0 && this.mouseX < this.width) &&\n        (this.mouseY > 0 && this.mouseY < this.height);\n\n      if (this._mouseWheelDeltaY !== 0) {\n        // zoom the camera depending on the value of _mouseWheelDeltaY.\n        // move away if positive, move closer if negative\n        deltaRadius = Math.sign(this._mouseWheelDeltaY) * sensitivityZ;\n        deltaRadius *= mouseZoomScaleFactor;\n        this._mouseWheelDeltaY = 0;\n        // start zoom when the mouse is wheeled within the canvas.\n        if (pointersInCanvas) this._renderer.executeZoom = true;\n      } else {\n        // quit zoom when you stop wheeling.\n        this._renderer.executeZoom = false;\n      }\n      if (this.mouseIsPressed) {\n        if (this.mouseButton.left) {\n          deltaTheta = -sensitivityX * this.movedX / scaleFactor;\n          deltaPhi = sensitivityY * this.movedY / scaleFactor;\n        } else if (this.mouseButton.right) {\n          moveDeltaX = this.movedX;\n          moveDeltaY =  this.movedY * cam.yScale;\n        }\n        // start rotate and move when mouse is pressed within the canvas.\n        if (pointersInCanvas) this._renderer.executeRotateAndMove = true;\n      } else {\n        // quit rotate and move if mouse is released.\n        this._renderer.executeRotateAndMove = false;\n      }\n    }\n\n    // interactions\n\n    // zoom process\n    if (deltaRadius !== 0 && this._renderer.executeZoom) {\n      // accelerate zoom velocity\n      this._renderer.zoomVelocity += deltaRadius;\n    }\n    if (Math.abs(this._renderer.zoomVelocity) > 0.001) {\n      // if freeRotation is true, we use _orbitFree() instead of _orbit()\n      if (freeRotation) {\n        cam._orbitFree(\n          0, 0, this._renderer.zoomVelocity\n        );\n      } else {\n        cam._orbit(\n          0, 0, this._renderer.zoomVelocity\n        );\n      }\n      // In orthogonal projection, the scale does not change even if\n      // the distance to the gaze point is changed, so the projection matrix\n      // needs to be modified.\n      if (cam.projMatrix.mat4[15] !== 0) {\n        cam.projMatrix.mat4[0] *= Math.pow(\n          10, -this._renderer.zoomVelocity\n        );\n        cam.projMatrix.mat4[5] *= Math.pow(\n          10, -this._renderer.zoomVelocity\n        );\n        // modify uPMatrix\n        this._renderer.states.setValue('uPMatrix', this._renderer.states.uPMatrix.clone());\n        this._renderer.states.uPMatrix.mat4[0] = cam.projMatrix.mat4[0];\n        this._renderer.states.uPMatrix.mat4[5] = cam.projMatrix.mat4[5];\n      }\n      // damping\n      this._renderer.zoomVelocity *= damping;\n    } else {\n      this._renderer.zoomVelocity = 0;\n    }\n\n    // rotate process\n    if ((deltaTheta !== 0 || deltaPhi !== 0) &&\n    this._renderer.executeRotateAndMove) {\n      // accelerate rotate velocity\n      this._renderer.rotateVelocity.add(\n        deltaTheta * rotateAccelerationFactor,\n        deltaPhi * rotateAccelerationFactor\n      );\n    }\n    if (this._renderer.rotateVelocity.magSq() > 0.000001) {\n      // if freeRotation is true, the camera always rotates freely in the direction the pointer moves\n      if (freeRotation) {\n        cam._orbitFree(\n          -this._renderer.rotateVelocity.x,\n          this._renderer.rotateVelocity.y,\n          0\n        );\n      } else {\n        cam._orbit(\n          this._renderer.rotateVelocity.x,\n          this._renderer.rotateVelocity.y,\n          0\n        );\n      }\n      // damping\n      this._renderer.rotateVelocity.mult(damping);\n    } else {\n      this._renderer.rotateVelocity.set(0, 0);\n    }\n\n    // move process\n    if ((moveDeltaX !== 0 || moveDeltaY !== 0) &&\n    this._renderer.executeRotateAndMove) {\n      // Normalize movement distance\n      const ndcX = moveDeltaX * 2/this.width;\n      const ndcY = -moveDeltaY * 2/this.height;\n      // accelerate move velocity\n      this._renderer.moveVelocity.add(\n        ndcX * moveAccelerationFactor,\n        ndcY * moveAccelerationFactor\n      );\n    }\n    if (this._renderer.moveVelocity.magSq() > 0.000001) {\n      // Translate the camera so that the entire object moves\n      // perpendicular to the line of sight when the mouse is moved\n      // or when the centers of gravity of the two touch pointers move.\n      const local = cam._getLocalAxes();\n\n      // Calculate the z coordinate in the view coordinates of\n      // the center, that is, the distance to the view point\n      const diffX = cam.eyeX - cam.centerX;\n      const diffY = cam.eyeY - cam.centerY;\n      const diffZ = cam.eyeZ - cam.centerZ;\n      const viewZ = Math.sqrt(diffX * diffX + diffY * diffY + diffZ * diffZ);\n\n      // position vector of the center.\n      let cv = new Vector(cam.centerX, cam.centerY, cam.centerZ);\n\n      // Calculate the normalized device coordinates of the center.\n      cv = cam.cameraMatrix.multiplyPoint(cv);\n      cv = this._renderer.states.uPMatrix.multiplyAndNormalizePoint(cv);\n\n      // Move the center by this distance\n      // in the normalized device coordinate system.\n      cv.x -= this._renderer.moveVelocity.x;\n      cv.y -= this._renderer.moveVelocity.y;\n\n      // Calculate the translation vector\n      // in the direction perpendicular to the line of sight of center.\n      let dx, dy;\n      const uP = this._renderer.states.uPMatrix.mat4;\n\n      if (uP[15] === 0) {\n        dx = ((uP[8] + cv.x)/uP[0]) * viewZ;\n        dy = ((uP[9] + cv.y)/uP[5]) * viewZ;\n      } else {\n        dx = (cv.x - uP[12])/uP[0];\n        dy = (cv.y - uP[13])/uP[5];\n      }\n\n      // translate the camera.\n      cam.setPosition(\n        cam.eyeX + dx * local.x[0] + dy * local.y[0],\n        cam.eyeY + dx * local.x[1] + dy * local.y[1],\n        cam.eyeZ + dx * local.x[2] + dy * local.y[2]\n      );\n      // damping\n      this._renderer.moveVelocity.mult(damping);\n    } else {\n      this._renderer.moveVelocity.set(0, 0);\n    }\n\n    return this;\n  };\n\n\n  /**\n   * Adds a grid and an axes icon to clarify orientation in 3D sketches.\n   *\n   * `debugMode()` adds a grid that shows where the ground is in a sketch. By\n   * default, the grid will run through the origin `(0, 0, 0)` of the sketch\n   * along the XZ plane. `debugMode()` also adds an axes icon that points along\n   * the positive x-, y-, and z-axes. Calling `debugMode()` displays the grid\n   * and axes icon with their default size and position.\n   *\n   * There are four ways to call `debugMode()` with optional parameters to\n   * customize the debugging environment.\n   *\n   * The first way to call `debugMode()` has one parameter, `mode`. If the\n   * system constant `GRID` is passed, as in `debugMode(GRID)`, then the grid\n   * will be displayed and the axes icon will be hidden. If the constant `AXES`\n   * is passed, as in `debugMode(AXES)`, then the axes icon will be displayed\n   * and the grid will be hidden.\n   *\n   * The second way to call `debugMode()` has six parameters. The first\n   * parameter, `mode`, selects either `GRID` or `AXES` to be displayed. The\n   * next five parameters, `gridSize`, `gridDivisions`, `xOff`, `yOff`, and\n   * `zOff` are optional. Theyre numbers that set the appearance of the grid\n   * (`gridSize` and `gridDivisions`) and the placement of the axes icon\n   * (`xOff`, `yOff`, and `zOff`). For example, calling\n   * `debugMode(20, 5, 10, 10, 10)` sets the `gridSize` to 20 pixels, the number\n   * of `gridDivisions` to 5, and offsets the axes icon by 10 pixels along the\n   * x-, y-, and z-axes.\n   *\n   * The third way to call `debugMode()` has five parameters. The first\n   * parameter, `mode`, selects either `GRID` or `AXES` to be displayed. The\n   * next four parameters, `axesSize`, `xOff`, `yOff`, and `zOff` are optional.\n   * Theyre numbers that set the appearance of the size of the axes icon\n   * (`axesSize`) and its placement (`xOff`, `yOff`, and `zOff`).\n   *\n   * The fourth way to call `debugMode()` has nine optional parameters. The\n   * first five parameters, `gridSize`, `gridDivisions`, `gridXOff`, `gridYOff`,\n   * and `gridZOff` are numbers that set the appearance of the grid. For\n   * example, calling `debugMode(100, 5, 0, 0, 0)` sets the `gridSize` to 100,\n   * the number of `gridDivisions` to 5, and sets all the offsets to 0 so that\n   * the grid is centered at the origin. The next four parameters, `axesSize`,\n   * `xOff`, `yOff`, and `zOff` are numbers that set the appearance of the size\n   * of the axes icon (`axesSize`) and its placement (`axesXOff`, `axesYOff`,\n   * and `axesZOff`). For example, calling\n   * `debugMode(100, 5, 0, 0, 0, 50, 10, 10, 10)` sets the `gridSize` to 100,\n   * the number of `gridDivisions` to 5, and sets all the offsets to 0 so that\n   * the grid is centered at the origin. It then sets the `axesSize` to 50 and\n   * offsets the icon 10 pixels along each axis.\n   *\n   * @method debugMode\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Enable debug mode.\n   *   debugMode();\n   *\n   *   describe('A multicolor box on a gray background. A grid and axes icon are displayed near the box.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the box.\n   *   normalMaterial();\n   *\n   *   // Draw the box.\n   *   box(20, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Enable debug mode.\n   *   // Only display the axes icon.\n   *   debugMode(AXES);\n   *\n   *   describe('A multicolor box on a gray background. A grid and axes icon are displayed near the box.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the box.\n   *   normalMaterial();\n   *\n   *   // Draw the box.\n   *   box(20, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Enable debug mode.\n   *   // Only display the grid and customize it:\n   *   // - size: 50\n   *   // - divisions: 10\n   *   // - offsets: 0, 20, 0\n   *   debugMode(GRID, 50, 10, 0, 20, 0);\n   *\n   *   describe('A multicolor box on a gray background. A grid is displayed below the box.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the box.\n   *   normalMaterial();\n   *\n   *   // Draw the box.\n   *   box(20, 40);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Enable debug mode.\n   *   // Display the grid and axes icon and customize them:\n   *   // Grid\n   *   // ----\n   *   // - size: 50\n   *   // - divisions: 10\n   *   // - offsets: 0, 20, 0\n   *   // Axes\n   *   // ----\n   *   // - size: 50\n   *   // - offsets: 0, 0, 0\n   *   debugMode(50, 10, 0, 20, 0, 50, 0, 0, 0);\n   *\n   *   describe('A multicolor box on a gray background. A grid is displayed below the box. An axes icon is displayed at the center of the box.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the box.\n   *   normalMaterial();\n   *\n   *   // Draw the box.\n   *   box(20, 40);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * @method debugMode\n   * @param {(GRID|AXES)} mode either GRID or AXES\n   */\n\n  /**\n   * @method debugMode\n   * @param {(GRID|AXES)} mode\n   * @param {Number} [gridSize] side length of the grid.\n   * @param {Number} [gridDivisions] number of divisions in the grid.\n   * @param {Number} [xOff] offset from origin along the x-axis.\n   * @param {Number} [yOff] offset from origin along the y-axis.\n   * @param {Number} [zOff] offset from origin along the z-axis.\n   */\n\n  /**\n   * @method debugMode\n   * @param {(GRID|AXES)} mode\n   * @param {Number} [axesSize] length of axes icon markers.\n   * @param {Number} [xOff]\n   * @param {Number} [yOff]\n   * @param {Number} [zOff]\n   */\n\n  /**\n   * @method debugMode\n   * @param {Number} [gridSize]\n   * @param {Number} [gridDivisions]\n   * @param {Number} [gridXOff] grid offset from the origin along the x-axis.\n   * @param {Number} [gridYOff] grid offset from the origin along the y-axis.\n   * @param {Number} [gridZOff] grid offset from the origin along the z-axis.\n   * @param {Number} [axesSize]\n   * @param {Number} [axesXOff] axes icon offset from the origin along the x-axis.\n   * @param {Number} [axesYOff] axes icon offset from the origin along the y-axis.\n   * @param {Number} [axesZOff] axes icon offset from the origin along the z-axis.\n   */\n\n  fn.debugMode = function(...args) {\n    this._assert3d('debugMode');\n    // p5._validateParameters('debugMode', args);\n\n    // start by removing existing 'post' registered debug methods\n    for (let i = p5.lifecycleHooks.postdraw.length - 1; i >= 0; i--) {\n      // test for equality...\n      if (\n        p5.lifecycleHooks.postdraw[i].toString() === this._grid().toString() ||\n        p5.lifecycleHooks.postdraw[i].toString() === this._axesIcon().toString()\n      ) {\n        p5.lifecycleHooks.postdraw.splice(i, 1);\n      }\n    }\n\n    // then add new debugMode functions according to the argument list\n    if (args[0] === GRID) {\n      p5.lifecycleHooks.postdraw.push(\n        this._grid(args[1], args[2], args[3], args[4], args[5])\n      );\n    } else if (args[0] === AXES) {\n      p5.lifecycleHooks.postdraw.push(\n        this._axesIcon(args[1], args[2], args[3], args[4])\n      );\n    } else {\n      p5.lifecycleHooks.postdraw.push(\n        this._grid(args[0], args[1], args[2], args[3], args[4])\n      );\n      p5.lifecycleHooks.postdraw.push(\n        this._axesIcon(args[5], args[6], args[7], args[8])\n      );\n    }\n  };\n\n  /**\n   * Turns off <a href=\"#/p5/debugMode\">debugMode()</a> in a 3D sketch.\n   *\n   * @method noDebugMode\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Enable debug mode.\n   *   debugMode();\n   *\n   *   describe('A multicolor box on a gray background. A grid and axes icon are displayed near the box. They disappear when the user double-clicks.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Style the box.\n   *   normalMaterial();\n   *\n   *   // Draw the box.  box(20, 40);\n   * }\n   *\n   * // Disable debug mode when the user double-clicks.\n   * function doubleClicked() {\n   *   noDebugMode();\n   * }\n   * </code>\n   * </div>\n   */\n  fn.noDebugMode = function() {\n    this._assert3d('noDebugMode');\n\n    // start by removing existing 'post' registered debug methods\n    for (let i = p5.lifecycleHooks.postdraw.length - 1; i >= 0; i--) {\n      // test for equality...\n      if (\n        p5.lifecycleHooks.postdraw[i].toString() === this._grid().toString() ||\n        p5.lifecycleHooks.postdraw[i].toString() === this._axesIcon().toString()\n      ) {\n        p5.lifecycleHooks.postdraw.splice(i, 1);\n      }\n    }\n  };\n\n  /**\n   * For use with debugMode\n   * @private\n   * @method _grid\n   * @param {Number} [size] size of grid sides\n   * @param {Number} [div] number of grid divisions\n   * @param {Number} [xOff] offset of grid center from origin in X axis\n   * @param {Number} [yOff] offset of grid center from origin in Y axis\n   * @param {Number} [zOff] offset of grid center from origin in Z axis\n   */\n  fn._grid = function(size, numDivs, xOff, yOff, zOff) {\n    if (typeof size === 'undefined') {\n      size = this.width / 2;\n    }\n    if (typeof numDivs === 'undefined') {\n      // ensure at least 2 divisions\n      numDivs = Math.round(size / 30) < 4 ? 4 : Math.round(size / 30);\n    }\n    if (typeof xOff === 'undefined') {\n      xOff = 0;\n    }\n    if (typeof yOff === 'undefined') {\n      yOff = 0;\n    }\n    if (typeof zOff === 'undefined') {\n      zOff = 0;\n    }\n\n    const spacing = size / numDivs;\n    const halfSize = size / 2;\n\n    return function() {\n      this.push();\n      this.stroke(\n        this._renderer.states.curStrokeColor[0] * 255,\n        this._renderer.states.curStrokeColor[1] * 255,\n        this._renderer.states.curStrokeColor[2] * 255\n      );\n      this._renderer.states.setValue('uModelMatrix', this._renderer.states.uModelMatrix.clone());\n      this._renderer.states.uModelMatrix.reset();\n\n      // Lines along X axis\n      for (let q = 0; q <= numDivs; q++) {\n        this.beginShape(this.LINES);\n        this.vertex(-halfSize + xOff, yOff, q * spacing - halfSize + zOff);\n        this.vertex(+halfSize + xOff, yOff, q * spacing - halfSize + zOff);\n        this.endShape();\n      }\n\n      // Lines along Z axis\n      for (let i = 0; i <= numDivs; i++) {\n        this.beginShape(this.LINES);\n        this.vertex(i * spacing - halfSize + xOff, yOff, -halfSize + zOff);\n        this.vertex(i * spacing - halfSize + xOff, yOff, +halfSize + zOff);\n        this.endShape();\n      }\n\n      this.pop();\n    };\n  };\n\n  /**\n   * For use with debugMode\n   * @private\n   * @method _axesIcon\n   * @param {Number} [size] size of axes icon lines\n   * @param {Number} [xOff] offset of icon from origin in X axis\n   * @param {Number} [yOff] offset of icon from origin in Y axis\n   * @param {Number} [zOff] offset of icon from origin in Z axis\n   */\n  fn._axesIcon = function(size, xOff, yOff, zOff) {\n    if (typeof size === 'undefined') {\n      size = this.width / 20 > 40 ? this.width / 20 : 40;\n    }\n    if (typeof xOff === 'undefined') {\n      xOff = -this.width / 4;\n    }\n    if (typeof yOff === 'undefined') {\n      yOff = xOff;\n    }\n    if (typeof zOff === 'undefined') {\n      zOff = xOff;\n    }\n\n    return () => {\n      this.push();\n      this._renderer.states.setValue('uModelMatrix', this._renderer.states.uModelMatrix.clone());\n      this._renderer.states.uModelMatrix.reset();\n\n      // X axis\n      this.strokeWeight(2);\n      this.stroke(255, 0, 0);\n      this.beginShape(this.LINES);\n      this.vertex(xOff, yOff, zOff);\n      this.vertex(xOff + size, yOff, zOff);\n      this.endShape();\n      // Y axis\n      this.stroke(0, 255, 0);\n      this.beginShape(this.LINES);\n      this.vertex(xOff, yOff, zOff);\n      this.vertex(xOff, yOff + size, zOff);\n      this.endShape();\n      // Z axis\n      this.stroke(0, 0, 255);\n      this.beginShape(this.LINES);\n      this.vertex(xOff, yOff, zOff);\n      this.vertex(xOff, yOff, zOff + size);\n      this.endShape();\n      this.pop();\n    };\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  interaction(p5, p5.prototype);\n}\n\nexport { interaction as default };\n","import { Geometry } from './p5.Geometry.js';\nimport { Vector } from '../math/p5.Vector.js';\nimport { a as request } from '../rendering-BELwvfI6.js';\nimport '../constants-8IpwyBct.js';\nimport './p5.DataArray.js';\nimport '../io/utilities.js';\nimport 'file-saver';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../dom/p5.Element.js';\nimport '../dom/p5.File.js';\nimport '../io/p5.XML.js';\nimport '../p5.Renderer-DoDzbpcT.js';\nimport '../image/filters.js';\nimport '../shape/custom_shapes.js';\nimport '../core/States.js';\nimport '../dom/p5.MediaElement.js';\nimport '../shape/2d_primitives.js';\nimport '../core/helpers.js';\nimport '../shape/attributes.js';\nimport '../shape/curves.js';\nimport '../shape/vertex.js';\nimport '../color/setting.js';\nimport 'omggif';\nimport '../io/csv.js';\nimport 'gifenc';\nimport '../image/pixels.js';\nimport '../core/transform.js';\nimport './GeometryBuilder.js';\nimport '../math/p5.Matrix.js';\nimport '../math/Matrices/Matrix.js';\nimport '../math/Matrices/MatrixInterface.js';\nimport './p5.Quat.js';\nimport './p5.RenderBuffer.js';\nimport './ShapeBuilder.js';\nimport 'libtess';\nimport './GeometryBufferCache.js';\nimport '../image/const.js';\nimport '../math/trigonometry.js';\n\n/**\n * @module Shape\n * @submodule 3D Models\n * @for p5\n * @requires core\n * @requires p5.Geometry\n */\n\n\nasync function fileExists(url) {\n  try {\n    const response = await fetch(url, { method: 'HEAD' });\n    return response.ok;\n  } catch (error) {\n    return false;\n  }\n}\n\nfunction loading(p5, fn){\n  /**\n   * Loads a 3D model to create a\n   * <a href=\"#/p5.Geometry\">p5.Geometry</a> object.\n   *\n   * `loadModel()` can load 3D models from OBJ and STL files. Once the model is\n   * loaded, it can be displayed with the\n   * <a href=\"#/p5/model\">model()</a> function, as in `model(shape)`.\n   *\n   * There are three ways to call `loadModel()` with optional parameters to help\n   * process the model.\n   *\n   * The first parameter, `path`, is a `String` with the path to the file. Paths\n   * to local files should be relative, as in `loadModel('assets/model.obj')`.\n   * URLs such as `'https://example.com/model.obj'` may be blocked due to browser\n   * security. The `path` parameter can also be defined as a [`Request`](https://developer.mozilla.org/en-US/docs/Web/API/Request)\n   * object for more advanced usage.\n   * Note: When loading a `.obj` file that references materials stored in\n   * `.mtl` files, p5.js will attempt to load and apply those materials.\n   * To ensure that the `.obj` file reads the `.mtl` file correctly include the\n   * `.mtl` file alongside it.\n   *\n   * The first way to call `loadModel()` has three optional parameters after the\n   * file path. The first optional parameter, `successCallback`, is a function\n   * to call once the model loads. For example,\n   * `loadModel('assets/model.obj', handleModel)` will call the `handleModel()`\n   * function once the model loads. The second optional parameter,\n   * `failureCallback`, is a function to call if the model fails to load. For\n   * example, `loadModel('assets/model.obj', handleModel, handleFailure)` will\n   * call the `handleFailure()` function if an error occurs while loading. The\n   * third optional parameter, `fileType`, is the models file extension as a\n   * string. For example,\n   * `loadModel('assets/model', handleModel, handleFailure, '.obj')` will try to\n   * load the file model as a `.obj` file.\n   *\n   * The second way to call `loadModel()` has four optional parameters after the\n   * file path. The first optional parameter is a `Boolean` value. If `true` is\n   * passed, as in `loadModel('assets/model.obj', true)`, then the model will be\n   * resized to ensure it fits the canvas. The next three parameters are\n   * `successCallback`, `failureCallback`, and `fileType` as described above.\n   *\n   * The third way to call `loadModel()` has one optional parameter after the\n   * file path. The optional parameter, `options`, is an `Object` with options,\n   * as in `loadModel('assets/model.obj', options)`. The `options` object can\n   * have the following properties:\n   *\n   * ```js\n   * let options = {\n   *   // Enables standardized size scaling during loading if set to true.\n   *   normalize: true,\n   *\n   *   // Function to call once the model loads.\n   *   successCallback: handleModel,\n   *\n   *   // Function to call if an error occurs while loading.\n   *   failureCallback: handleError,\n   *\n   *   // Model's file extension.\n   *   fileType: '.stl',\n   *\n   *   // Flips the U texture coordinates of the model.\n   *   flipU: false,\n   *\n   *   // Flips the V texture coordinates of the model.\n   *   flipV: false\n   * };\n   *\n   * // Pass the options object to loadModel().\n   * loadModel('assets/model.obj', options);\n   * ```\n   *\n   * This function returns a `Promise` and should be used in an `async` setup with\n   * `await`. See the examples for the usage syntax.\n   *\n   * Note: Theres no support for colored STL files. STL files with color will\n   * be rendered without color.\n   *\n   * @method loadModel\n   * @param  {String|Request} path      path of the model to be loaded.\n   * @param  {String} [fileType]          models file extension. Either `'.obj'` or `'.stl'`.\n   * @param  {Boolean} normalize        if `true`, scale the model to fit the canvas.\n   * @param  {function(p5.Geometry)} [successCallback] function to call once the model is loaded. Will be passed\n   *                                                   the <a href=\"#/p5.Geometry\">p5.Geometry</a> object.\n   * @param  {function(Event)} [failureCallback] function to call if the model fails to load. Will be passed an `Error` event object.\n   * @return {Promise<p5.Geometry>} the <a href=\"#/p5.Geometry\">p5.Geometry</a> object\n   *\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   *\n   * // Load the file and create a p5.Geometry object.\n   * async function setup() {\n   *   shape = await loadModel('assets/teapot.obj');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white teapot drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the shape.\n   *   model(shape);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   *\n   * // Load the file and create a p5.Geometry object.\n   * // Normalize the geometry's size to fit the canvas.\n   * async function setup() {\n   *   shape = await loadModel('assets/teapot.obj', true);\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white teapot drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the shape.\n   *   model(shape);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   *\n   * // Load the file and create a p5.Geometry object.\n   * async function setup() {\n   *   await loadModel('assets/teapot.obj', true, handleModel);\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white teapot drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the shape.\n   *   model(shape);\n   * }\n   *\n   * // Set the shape variable and log the geometry's\n   * // ID to the console.\n   * function handleModel(data) {\n   *   shape = data;\n   *   console.log(shape.gid);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div class='notest'>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   *\n   * // Load the file and create a p5.Geometry object.\n   * async function setup() {\n   *   await loadModel('assets/teapot.obj', true, handleModel, handleError);\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white teapot drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the shape.\n   *   model(shape);\n   * }\n   *\n   * // Set the shape variable and print the geometry's\n   * // ID to the console.\n   * function handleModel(data) {\n   *   shape = data;\n   *   console.log(shape.gid);\n   * }\n   *\n   * // Print an error message if the file doesn't load.\n   * function handleError(error) {\n   *   console.error('Oops!', error);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   *\n   * // Load the file and create a p5.Geometry object.\n   * async function setup() {\n   *   await loadModel('assets/teapot.obj', '.obj', true, handleModel, handleError);\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white teapot drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the shape.\n   *   model(shape);\n   * }\n   *\n   * // Set the shape variable and print the geometry's\n   * // ID to the console.\n   * function handleModel(data) {\n   *   shape = data;\n   *   console.log(shape.gid);\n   * }\n   *\n   * // Print an error message if the file doesn't load.\n   * function handleError(error) {\n   *   console.error('Oops!', error);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   * let options = {\n   *   fileType: '.obj',\n   *   normalize: true,\n   *   successCallback: handleModel,\n   *   failureCallback: handleError\n   * };\n   *\n   * // Load the file and create a p5.Geometry object.\n   * async function setup() {\n   *   await loadModel('assets/teapot.obj', options);\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white teapot drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the shape.\n   *   model(shape);\n   * }\n   *\n   * // Set the shape variable and print the geometry's\n   * // ID to the console.\n   * function handleModel(data) {\n   *   shape = data;\n   *   console.log(shape.gid);\n   * }\n   *\n   * // Print an error message if the file doesn't load.\n   * function handleError(error) {\n   *   console.error('Oops!', error);\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method loadModel\n   * @param  {String|Request} path\n   * @param  {String} [fileType]\n   * @param  {function(p5.Geometry)} [successCallback]\n   * @param  {function(Event)} [failureCallback]\n   * @return {Promise<p5.Geometry>} new <a href=\"#/p5.Geometry\">p5.Geometry</a> object.\n   */\n  /**\n   * @method loadModel\n   * @param  {String|Request} path\n   * @param  {Object} [options] loading options.\n   * @param  {String} [options.fileType]\n   * @param  {function(p5.Geometry)} [options.successCallback]\n   * @param  {function(Event)} [options.failureCallback]\n   * @param  {Boolean} [options.normalize]\n   * @param  {Boolean} [options.flipU]\n   * @param  {Boolean} [options.flipV]\n   * @return {Promise<p5.Geometry>} new <a href=\"#/p5.Geometry\">p5.Geometry</a> object.\n   */\n  fn.loadModel = async function (path, fileType, normalize, successCallback, failureCallback) {\n    // p5._validateParameters('loadModel', arguments);\n\n    let flipU = false;\n    let flipV = false;\n\n    if (typeof fileType === 'object') {\n      // Passing in options object\n      normalize = fileType.normalize || false;\n      successCallback = fileType.successCallback;\n      failureCallback = fileType.failureCallback;\n      fileType = fileType.fileType || fileType;\n      flipU = fileType.flipU || false;\n      flipV = fileType.flipV || false;\n\n    } else {\n      // Passing in individual parameters\n      if(typeof arguments[arguments.length-1] === 'function'){\n        if(typeof arguments[arguments.length-2] === 'function'){\n          successCallback = arguments[arguments.length-2];\n          failureCallback = arguments[arguments.length-1];\n        }else {\n          successCallback = arguments[arguments.length-1];\n        }\n      }\n\n      if (typeof fileType === 'string') {\n        if(typeof normalize !== 'boolean') normalize = false;\n\n      } else if (typeof fileType === 'boolean') {\n        normalize = fileType;\n        fileType = path.slice(-4);\n\n      } else {\n        fileType = path.slice(-4);\n        normalize = false;\n      }\n    }\n\n    if (fileType.toLowerCase() !== '.obj' && fileType.toLowerCase() !== '.stl') {\n      fileType = '.obj';\n    }\n\n    const model = new Geometry(undefined, undefined, undefined, this._renderer);\n    model.gid = `${path}|${normalize}`;\n\n    async function getMaterials(lines) {\n      const parsedMaterialPromises = [];\n\n      for (let line of lines) {\n        const mtllibMatch = line.match(/^mtllib (.+)/);\n\n        if (mtllibMatch) {\n          // Object has material\n          let mtlPath = '';\n          const mtlFilename = mtllibMatch[1];\n          const objPathParts = path.split('/');\n          if (objPathParts.length > 1) {\n            objPathParts.pop();\n            const objFolderPath = objPathParts.join('/');\n            mtlPath = objFolderPath + '/' + mtlFilename;\n          } else {\n            mtlPath = mtlFilename;\n          }\n\n          parsedMaterialPromises.push(\n            fileExists(mtlPath).then(exists => {\n              if (exists) {\n                return parseMtl(mtlPath);\n              } else {\n                console.warn(`MTL file not found or error in parsing; proceeding without materials: ${mtlPath}`);\n                return {};\n\n              }\n            }).catch(error => {\n              console.warn(`Error loading MTL file: ${mtlPath}`, error);\n              return {};\n            })\n          );\n        }\n      }\n\n      try {\n        const parsedMaterials = await Promise.all(parsedMaterialPromises);\n        const materials = Object.assign({}, ...parsedMaterials);\n        return materials;\n      } catch (error) {\n        return {};\n      }\n    }\n\n    try{\n      if (fileType.match(/\\.stl$/i)) {\n        const { data } = await request(path, 'arrayBuffer');\n        parseSTL(model, data);\n\n        if (normalize) {\n          model.normalize();\n        }\n\n        if (flipU) {\n          model.flipU();\n        }\n\n        if (flipV) {\n          model.flipV();\n        }\n        model._makeTriangleEdges();\n\n        if (successCallback) {\n          return successCallback(model);\n        } else {\n          return model;\n        }\n\n      } else if (fileType.match(/\\.obj$/i)) {\n        const { data } = await request(path, 'text');\n        const lines = data.split('\\n');\n\n        const parsedMaterials = await getMaterials(lines);\n        parseObj(model, lines, parsedMaterials);\n\n        if (normalize) {\n          model.normalize();\n        }\n        if (flipU) {\n          model.flipU();\n        }\n        if (flipV) {\n          model.flipV();\n        }\n        model._makeTriangleEdges();\n\n        if (successCallback) {\n          return successCallback(model);\n        } else {\n          return model;\n        }\n      }\n    } catch(err) {\n      p5._friendlyFileLoadError(3, path);\n      if(failureCallback) {\n        return failureCallback(err);\n      } else {\n        throw err;\n      }\n    }\n  };\n\n  /**\n   * @private\n   */\n  async function parseMtl(mtlPath) {\n    let currentMaterial = null;\n    let materials = {};\n\n    const { data } = await request(mtlPath, \"text\");\n    const lines = data.split('\\n');\n\n    for (let line = 0; line < lines.length; ++line) {\n      const tokens = lines[line].trim().split(/\\s+/);\n      if (tokens[0] === 'newmtl') {\n        const materialName = tokens[1];\n        currentMaterial = materialName;\n        materials[currentMaterial] = {};\n      } else if (tokens[0] === 'Kd') {\n        //Diffuse color\n        materials[currentMaterial].diffuseColor = [\n          parseFloat(tokens[1]),\n          parseFloat(tokens[2]),\n          parseFloat(tokens[3])\n        ];\n      } else if (tokens[0] === 'Ka') {\n        //Ambient Color\n        materials[currentMaterial].ambientColor = [\n          parseFloat(tokens[1]),\n          parseFloat(tokens[2]),\n          parseFloat(tokens[3])\n        ];\n      } else if (tokens[0] === 'Ks') {\n        //Specular color\n        materials[currentMaterial].specularColor = [\n          parseFloat(tokens[1]),\n          parseFloat(tokens[2]),\n          parseFloat(tokens[3])\n        ];\n\n      } else if (tokens[0] === 'map_Kd') {\n        //Texture path\n        materials[currentMaterial].texturePath = tokens[1];\n      }\n    }\n\n    return materials;\n  }\n\n  /**\n   * @private\n   * Parse OBJ lines into model. For reference, this is what a simple model of a\n   * square might look like:\n   *\n   * v -0.5 -0.5 0.5\n   * v -0.5 -0.5 -0.5\n   * v -0.5 0.5 -0.5\n   * v -0.5 0.5 0.5\n   *\n   * f 4 3 2 1\n   */\n  function parseObj(model, lines, materials = {}) {\n    // OBJ allows a face to specify an index for a vertex (in the above example),\n    // but it also allows you to specify a custom combination of vertex, UV\n    // coordinate, and vertex normal. So, \"3/4/3\" would mean, \"use vertex 3 with\n    // UV coordinate 4 and vertex normal 3\". In WebGL, every vertex with different\n    // parameters must be a different vertex, so loadedVerts is used to\n    // temporarily store the parsed vertices, normals, etc., and indexedVerts is\n    // used to map a specific combination (keyed on, for example, the string\n    // \"3/4/3\"), to the actual index of the newly created vertex in the final\n    // object.\n    const loadedVerts = {\n      v: [],\n      vt: [],\n      vn: []\n    };\n\n\n    // Map from source index  Map of material  destination index\n    const usedVerts = {}; // Track colored vertices\n    let currentMaterial = null;\n    let hasColoredVertices = false;\n    let hasColorlessVertices = false;\n    for (let line = 0; line < lines.length; ++line) {\n      // Each line is a separate object (vertex, face, vertex normal, etc)\n      // For each line, split it into tokens on whitespace. The first token\n      // describes the type.\n      const tokens = lines[line].trim().split(/\\b\\s+/);\n\n      if (tokens.length > 0) {\n        if (tokens[0] === 'usemtl') {\n          // Switch to a new material\n          currentMaterial = tokens[1];\n        } else if (tokens[0] === 'v' || tokens[0] === 'vn') {\n          // Check if this line describes a vertex or vertex normal.\n          // It will have three numeric parameters.\n          const vertex = new Vector(\n            parseFloat(tokens[1]),\n            parseFloat(tokens[2]),\n            parseFloat(tokens[3])\n          );\n          loadedVerts[tokens[0]].push(vertex);\n        } else if (tokens[0] === 'vt') {\n          // Check if this line describes a texture coordinate.\n          // It will have two numeric parameters U and V (W is omitted).\n          // Because of WebGL texture coordinates rendering behaviour, the V\n          // coordinate is inversed.\n          const texVertex = [parseFloat(tokens[1]), 1 - parseFloat(tokens[2])];\n          loadedVerts[tokens[0]].push(texVertex);\n        } else if (tokens[0] === 'f') {\n          // Check if this line describes a face.\n          // OBJ faces can have more than three points. Triangulate points.\n          for (let tri = 3; tri < tokens.length; ++tri) {\n            const face = [];\n            const vertexTokens = [1, tri - 1, tri];\n\n            for (let tokenInd = 0; tokenInd < vertexTokens.length; ++tokenInd) {\n              // Now, convert the given token into an index\n              const vertString = tokens[vertexTokens[tokenInd]];\n              let vertParts = vertString.split('/');\n\n              // TODO: Faces can technically use negative numbers to refer to the\n              // previous nth vertex. I haven't seen this used in practice, but\n              // it might be good to implement this in the future.\n\n              for (let i = 0; i < vertParts.length; i++) {\n                vertParts[i] = parseInt(vertParts[i]) - 1;\n              }\n\n              if (!usedVerts[vertString]) {\n                usedVerts[vertString] = {};\n              }\n\n              if (usedVerts[vertString][currentMaterial] === undefined) {\n                const vertIndex = model.vertices.length;\n                model.vertices.push(loadedVerts.v[vertParts[0]].copy());\n                model.uvs.push(loadedVerts.vt[vertParts[1]] ?\n                  loadedVerts.vt[vertParts[1]].slice() : [0, 0]);\n                model.vertexNormals.push(loadedVerts.vn[vertParts[2]] ?\n                  loadedVerts.vn[vertParts[2]].copy() : new Vector());\n\n                usedVerts[vertString][currentMaterial] = vertIndex;\n                face.push(vertIndex);\n                if (currentMaterial\n                  && materials[currentMaterial]\n                  && materials[currentMaterial].diffuseColor) {\n                  hasColoredVertices = true;\n                  const materialDiffuseColor =\n                    materials[currentMaterial].diffuseColor;\n                  model.vertexColors.push(materialDiffuseColor[0]);\n                  model.vertexColors.push(materialDiffuseColor[1]);\n                  model.vertexColors.push(materialDiffuseColor[2]);\n                  model.vertexColors.push(1);\n                } else {\n                  hasColorlessVertices = true;\n                }\n              } else {\n                face.push(usedVerts[vertString][currentMaterial]);\n              }\n            }\n\n            if (\n              face[0] !== face[1] &&\n              face[0] !== face[2] &&\n              face[1] !== face[2]\n            ) {\n              model.faces.push(face);\n            }\n          }\n        }\n      }\n    }\n    // If the model doesn't have normals, compute the normals\n    if (model.vertexNormals.length === 0) {\n      model.computeNormals();\n    }\n    if (hasColoredVertices === hasColorlessVertices) {\n      // If both are true or both are false, throw an error because the model is inconsistent\n      throw new Error('Model coloring is inconsistent. Either all vertices should have colors or none should.');\n    }\n\n    return model;\n  }\n\n  /**\n   * @private\n   * STL files can be of two types, ASCII and Binary,\n   *\n   * We need to convert the arrayBuffer to an array of strings,\n   * to parse it as an ASCII file.\n   */\n  function parseSTL(model, buffer) {\n    if (isBinary(buffer)) {\n      parseBinarySTL(model, buffer);\n    } else {\n      const reader = new DataView(buffer);\n\n      if (!('TextDecoder' in window)) {\n        console.warn(\n          'Sorry, ASCII STL loading only works in browsers that support TextDecoder (https://caniuse.com/#feat=textencoder)'\n        );\n        return model;\n      }\n\n      const decoder = new TextDecoder('utf-8');\n      const lines = decoder.decode(reader);\n      const lineArray = lines.split('\\n');\n      parseASCIISTL(model, lineArray);\n    }\n    return model;\n  }\n\n  /**\n   * @private\n   * This function checks if the file is in ASCII format or in Binary format\n   *\n   * It is done by searching keyword `solid` at the start of the file.\n   *\n   * An ASCII STL data must begin with `solid` as the first six bytes.\n   * However, ASCII STLs lacking the SPACE after the `d` are known to be\n   * plentiful. So, check the first 5 bytes for `solid`.\n   *\n   * Several encodings, such as UTF-8, precede the text with up to 5 bytes:\n   * https://en.wikipedia.org/wiki/Byte_order_mark#Byte_order_marks_by_encoding\n   * Search for `solid` to start anywhere after those prefixes.\n   */\n  function isBinary(data) {\n    const reader = new DataView(data);\n\n    // US-ASCII ordinal values for `s`, `o`, `l`, `i`, `d`\n    const solid = [115, 111, 108, 105, 100];\n    for (let off = 0; off < 5; off++) {\n      // If \"solid\" text is matched to the current offset, declare it to be an ASCII STL.\n      if (matchDataViewAt(solid, reader, off)) return false;\n    }\n\n    // Couldn't find \"solid\" text at the beginning; it is binary STL.\n    return true;\n  }\n\n  /**\n   * @private\n   * This function matches the `query` at the provided `offset`\n   */\n  function matchDataViewAt(query, reader, offset) {\n    // Check if each byte in query matches the corresponding byte from the current offset\n    for (let i = 0, il = query.length; i < il; i++) {\n      if (query[i] !== reader.getUint8(offset + i, false)) return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * @private\n   * This function parses the Binary STL files.\n   * https://en.wikipedia.org/wiki/STL_%28file_format%29#Binary_STL\n   *\n   * Currently there is no support for the colors provided in STL files.\n   */\n  function parseBinarySTL(model, buffer) {\n    const reader = new DataView(buffer);\n\n    // Number of faces is present following the header\n    const faces = reader.getUint32(80, true);\n    let r,\n      g,\n      b,\n      hasColors = false,\n      colors;\n    let defaultR, defaultG, defaultB;\n\n    // Binary files contain 80-byte header, which is generally ignored.\n    for (let index = 0; index < 80 - 10; index++) {\n      // Check for `COLOR=`\n      if (\n        reader.getUint32(index, false) === 0x434f4c4f /*COLO*/ &&\n        reader.getUint8(index + 4) === 0x52 /*'R'*/ &&\n        reader.getUint8(index + 5) === 0x3d /*'='*/\n      ) {\n        hasColors = true;\n        colors = [];\n\n        defaultR = reader.getUint8(index + 6) / 255;\n        defaultG = reader.getUint8(index + 7) / 255;\n        defaultB = reader.getUint8(index + 8) / 255;\n        // To be used when color support is added\n        // alpha = reader.getUint8(index + 9) / 255;\n      }\n    }\n    const dataOffset = 84;\n    const faceLength = 12 * 4 + 2;\n\n    // Iterate the faces\n    for (let face = 0; face < faces; face++) {\n      const start = dataOffset + face * faceLength;\n      const normalX = reader.getFloat32(start, true);\n      const normalY = reader.getFloat32(start + 4, true);\n      const normalZ = reader.getFloat32(start + 8, true);\n\n      if (hasColors) {\n        const packedColor = reader.getUint16(start + 48, true);\n\n        if ((packedColor & 0x8000) === 0) {\n          // facet has its own unique color\n          r = (packedColor & 0x1f) / 31;\n          g = ((packedColor >> 5) & 0x1f) / 31;\n          b = ((packedColor >> 10) & 0x1f) / 31;\n        } else {\n          r = defaultR;\n          g = defaultG;\n          b = defaultB;\n        }\n      }\n      const newNormal = new Vector(normalX, normalY, normalZ);\n\n      for (let i = 1; i <= 3; i++) {\n        const vertexstart = start + i * 12;\n\n        const newVertex = new Vector(\n          reader.getFloat32(vertexstart, true),\n          reader.getFloat32(vertexstart + 4, true),\n          reader.getFloat32(vertexstart + 8, true)\n        );\n\n        model.vertices.push(newVertex);\n        model.vertexNormals.push(newNormal);\n\n        if (hasColors) {\n          colors.push(r, g, b);\n        }\n      }\n\n      model.faces.push([3 * face, 3 * face + 1, 3 * face + 2]);\n      model.uvs.push([0, 0], [0, 0], [0, 0]);\n    }\n    return model;\n  }\n\n  /**\n   * @private\n   * ASCII STL file starts with `solid 'nameOfFile'`\n   * Then contain the normal of the face, starting with `facet normal`\n   * Next contain a keyword indicating the start of face vertex, `outer loop`\n   * Next comes the three vertex, starting with `vertex x y z`\n   * Vertices ends with `endloop`\n   * Face ends with `endfacet`\n   * Next face starts with `facet normal`\n   * The end of the file is indicated by `endsolid`\n   */\n  function parseASCIISTL(model, lines) {\n    let state = '';\n    let curVertexIndex = [];\n    let newNormal, newVertex;\n\n    for (let iterator = 0; iterator < lines.length; ++iterator) {\n      const line = lines[iterator].trim();\n      const parts = line.split(' ');\n\n      for (let partsiterator = 0; partsiterator < parts.length; ++partsiterator) {\n        if (parts[partsiterator] === '') {\n          // Ignoring multiple whitespaces\n          parts.splice(partsiterator, 1);\n        }\n      }\n\n      if (parts.length === 0) {\n        // Remove newline\n        continue;\n      }\n\n      switch (state) {\n        case '': // First run\n          if (parts[0] !== 'solid') {\n            // Invalid state\n            console.error(line);\n            console.error(`Invalid state \"${parts[0]}\", should be \"solid\"`);\n            return;\n          } else {\n            state = 'solid';\n          }\n          break;\n\n        case 'solid': // First face\n          if (parts[0] !== 'facet' || parts[1] !== 'normal') {\n            // Invalid state\n            console.error(line);\n            console.error(\n              `Invalid state \"${parts[0]}\", should be \"facet normal\"`\n            );\n            return;\n          } else {\n            // Push normal for first face\n            newNormal = new Vector(\n              parseFloat(parts[2]),\n              parseFloat(parts[3]),\n              parseFloat(parts[4])\n            );\n            model.vertexNormals.push(newNormal, newNormal, newNormal);\n            state = 'facet normal';\n          }\n          break;\n\n        case 'facet normal': // After normal is defined\n          if (parts[0] !== 'outer' || parts[1] !== 'loop') {\n            // Invalid State\n            console.error(line);\n            console.error(`Invalid state \"${parts[0]}\", should be \"outer loop\"`);\n            return;\n          } else {\n            // Next should be vertices\n            state = 'vertex';\n          }\n          break;\n\n        case 'vertex':\n          if (parts[0] === 'vertex') {\n            //Vertex of triangle\n            newVertex = new Vector(\n              parseFloat(parts[1]),\n              parseFloat(parts[2]),\n              parseFloat(parts[3])\n            );\n            model.vertices.push(newVertex);\n            model.uvs.push([0, 0]);\n            curVertexIndex.push(model.vertices.indexOf(newVertex));\n          } else if (parts[0] === 'endloop') {\n            // End of vertices\n            model.faces.push(curVertexIndex);\n            curVertexIndex = [];\n            state = 'endloop';\n          } else {\n            // Invalid State\n            console.error(line);\n            console.error(\n              `Invalid state \"${parts[0]}\", should be \"vertex\" or \"endloop\"`\n            );\n            return;\n          }\n          break;\n\n        case 'endloop':\n          if (parts[0] !== 'endfacet') {\n            // End of face\n            console.error(line);\n            console.error(`Invalid state \"${parts[0]}\", should be \"endfacet\"`);\n            return;\n          } else {\n            state = 'endfacet';\n          }\n          break;\n\n        case 'endfacet':\n          if (parts[0] === 'endsolid') ; else if (parts[0] === 'facet' && parts[1] === 'normal') {\n            // Next face\n            newNormal = new Vector(\n              parseFloat(parts[2]),\n              parseFloat(parts[3]),\n              parseFloat(parts[4])\n            );\n            model.vertexNormals.push(newNormal, newNormal, newNormal);\n            state = 'facet normal';\n          } else {\n            // Invalid State\n            console.error(line);\n            console.error(\n              `Invalid state \"${parts[0]\n              }\", should be \"endsolid\" or \"facet normal\"`\n            );\n            return;\n          }\n          break;\n\n        default:\n          console.error(`Invalid state \"${state}\"`);\n          break;\n      }\n    }\n    return model;\n  }\n\n  /**\n   * Draws a <a href=\"#/p5.Geometry\">p5.Geometry</a> object to the canvas.\n   *\n   * The parameter, `model`, is the\n   * <a href=\"#/p5.Geometry\">p5.Geometry</a> object to draw.\n   * <a href=\"#/p5.Geometry\">p5.Geometry</a> objects can be built with\n   * <a href=\"#/p5/buildGeometry\">buildGeometry()</a>, or\n   * <a href=\"#/p5/beginGeometry\">beginGeometry()</a> and\n   * <a href=\"#/p5/endGeometry\">endGeometry()</a>. They can also be loaded from\n   * a file with <a href=\"#/p5/loadGeometry\">loadGeometry()</a>.\n   *\n   * Note: `model()` can only be used in WebGL mode.\n   *\n   * @method model\n   * @param  {p5.Geometry} model 3D shape to be drawn.\n   *\n   * @param {Number} [count=1] number of instances to draw.\n   * @example\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the p5.Geometry object.\n   *   shape = buildGeometry(createShape);\n   *\n   *   describe('A white cone drawn on a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(shape);\n   * }\n   *\n   * // Create p5.Geometry object from a single cone.\n   * function createShape() {\n   *   cone();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   // Create the p5.Geometry object.\n   *   shape = buildGeometry(createArrow);\n   *\n   *   describe('Two white arrows drawn on a gray background. The arrow on the right rotates slowly.');\n   * }\n   *\n   * function draw() {\n   *   background(50);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Turn on the lights.\n   *   lights();\n   *\n   *   // Style the arrows.\n   *   noStroke();\n   *\n   *   // Draw the p5.Geometry object.\n   *   model(shape);\n   *\n   *   // Translate and rotate the coordinate system.\n   *   translate(30, 0, 0);\n   *   rotateZ(frameCount * 0.01);\n   *\n   *   // Draw the p5.Geometry object again.\n   *   model(shape);\n   * }\n   *\n   * function createArrow() {\n   *   // Add shapes to the p5.Geometry object.\n   *   push();\n   *   rotateX(PI);\n   *   cone(10);\n   *   translate(0, -10, 0);\n   *   cylinder(3, 20);\n   *   pop();\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * // Click and drag the mouse to view the scene from different angles.\n   *\n   * let shape;\n   *\n   * async function setup() {\n   *   shape = await loadModel('assets/octahedron.obj');\n   *\n   *   createCanvas(100, 100, WEBGL);\n   *\n   *   describe('A white octahedron drawn against a gray background.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *\n   *   // Enable orbiting with the mouse.\n   *   orbitControl();\n   *\n   *   // Draw the shape.\n   *   model(shape);\n   * }\n   * </code>\n   * </div>\n   */\n  fn.model = function (model, count = 1) {\n    this._assert3d('model');\n    // p5._validateParameters('model', arguments);\n    this._renderer.model(model, count);\n  };\n\n  /**\n   * Load a 3d model from an OBJ or STL string.\n   *\n   * OBJ and STL files lack a built-in sense of scale, causing models exported from different programs to vary in size.\n   * If your model doesn't display correctly, consider using `loadModel()` with `normalize` set to `true` to standardize its size.\n   * Further adjustments can be made using the `scale()` function.\n   *\n   * Also, the support for colored STL files is not present. STL files with color will be\n   * rendered without color properties.\n   *\n   * * Options can include:\n   * - `modelString`: Specifies the plain text string of either an stl or obj file to be loaded.\n   * - `fileType`: Defines the file extension of the model.\n   * - `normalize`: Enables standardized size scaling during loading if set to true.\n   * - `successCallback`: Callback for post-loading actions with the 3D model object.\n   * - `failureCallback`: Handles errors if model loading fails, receiving an event error.\n   * - `flipU`: Flips the U texture coordinates of the model.\n   * - `flipV`: Flips the V texture coordinates of the model.\n   *\n   *\n   * @method createModel\n   * @param  {String} modelString         String of the object to be loaded\n   * @param  {String} [fileType]          The file extension of the model\n   *                                      (<code>.stl</code>, <code>.obj</code>).\n   * @param  {Boolean} normalize        If true, scale the model to a\n   *                                      standardized size when loading\n   * @param  {function(p5.Geometry)} [successCallback] Function to be called\n   *                                     once the model is loaded. Will be passed\n   *                                     the 3D model object.\n   * @param  {function(Event)} [failureCallback] called with event error if\n   *                                         the model fails to load.\n   * @return {p5.Geometry} the <a href=\"#/p5.Geometry\">p5.Geometry</a> object\n   *\n   * @example\n   * <div>\n   * <code>\n   * const octahedron_model = `\n   * v 0.000000E+00 0.000000E+00 40.0000\n   * v 22.5000 22.5000 0.000000E+00\n   * v 22.5000 -22.5000 0.000000E+00\n   * v -22.5000 -22.5000 0.000000E+00\n   * v -22.5000 22.5000 0.000000E+00\n   * v 0.000000E+00 0.000000E+00 -40.0000\n   * f     1 2 3\n   * f     1 3 4\n   * f     1 4 5\n   * f     1 5 2\n   * f     6 5 4\n   * f     6 4 3\n   * f     6 3 2\n   * f     6 2 5\n   * `;\n   * //draw a spinning octahedron\n   * let octahedron;\n   *\n   * function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *   octahedron = createModel(octahedron_model, '.obj');\n   *   describe('Vertically rotating 3D octahedron.');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *   rotateX(frameCount * 0.01);\n   *   rotateY(frameCount * 0.01);\n   *   model(octahedron);\n   *}\n   * </code>\n   * </div>\n   */\n  /**\n   * @method createModel\n   * @param  {String} modelString\n   * @param  {String} [fileType]\n   * @param  {function(p5.Geometry)} [successCallback]\n   * @param  {function(Event)} [failureCallback]\n   * @return {p5.Geometry} the <a href=\"#/p5.Geometry\">p5.Geometry</a> object\n   */\n  /**\n   * @method createModel\n   * @param  {String} modelString\n   * @param  {String} [fileType]\n   * @param  {Object} [options]\n   * @param  {function(p5.Geometry)} [options.successCallback]\n   * @param  {function(Event)} [options.failureCallback]\n   * @param  {boolean} [options.normalize]\n   * @param  {boolean} [options.flipU]\n   * @param  {boolean} [options.flipV]\n   * @return {p5.Geometry} the <a href=\"#/p5.Geometry\">p5.Geometry</a> object\n   */\n  let modelCounter = 0;\n  fn.createModel = function(modelString, fileType=' ', options) {\n    // p5._validateParameters('createModel', arguments);\n    let normalize= false;\n    let successCallback;\n    let failureCallback;\n    let flipU = false;\n    let flipV = false;\n    if (options && typeof options === 'object') {\n      normalize = options.normalize || false;\n      successCallback = options.successCallback;\n      failureCallback = options.failureCallback;\n      flipU = options.flipU || false;\n      flipV = options.flipV || false;\n    } else if (typeof options === 'boolean') {\n      normalize = options;\n      successCallback = arguments[3];\n      failureCallback = arguments[4];\n    } else {\n      successCallback = typeof arguments[2] === 'function' ? arguments[2] : undefined;\n      failureCallback = arguments[3];\n    }\n    const model = new p5.Geometry();\n    model.gid = `${fileType}|${normalize}|${modelCounter++}`;\n\n    if (fileType.match(/\\.stl$/i)) {\n      try {\n        let uint8array = new TextEncoder().encode(modelString);\n        let arrayBuffer = uint8array.buffer;\n        parseSTL(model, arrayBuffer);\n      } catch (error) {\n        if (failureCallback) {\n          failureCallback(error);\n        } else {\n          p5._friendlyError('Error during parsing: ' + error.message);\n        }\n        return;\n      }\n    } else if (fileType.match(/\\.obj$/i)) {\n      try {\n        const lines = modelString.split('\\n');\n        parseObj(model, lines);\n      } catch (error) {\n        if (failureCallback) {\n          failureCallback(error);\n        } else {\n          p5._friendlyError('Error during parsing: ' + error.message);\n        }\n        return;\n      }\n    } else {\n      p5._friendlyFileLoadError(3, modelString);\n      if (failureCallback) {\n        failureCallback();\n      } else {\n        p5._friendlyError(\n          'Sorry, the file type is invalid. Only OBJ and STL files are supported.'\n        );\n      }\n    }\n    if (normalize) {\n      model.normalize();\n    }\n\n    if (flipU) {\n      model.flipU();\n    }\n\n    if (flipV) {\n      model.flipV();\n    }\n\n    model._makeTriangleEdges();\n\n    if (typeof successCallback === 'function') {\n      successCallback(model);\n    }\n\n    return model;\n  };\n}\n\nif(typeof p5 !== 'undefined'){\n  loading(p5, p5.prototype);\n}\n\nexport { loading as default };\n","import { R as Renderer } from '../p5.Renderer-DoDzbpcT.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../constants-8IpwyBct.js';\nimport '../image/filters.js';\nimport '../math/p5.Vector.js';\nimport '../shape/custom_shapes.js';\nimport '../core/States.js';\nimport '../io/utilities.js';\nimport 'file-saver';\n\n/**\n * @module Typography\n * @requires core\n */\n\n\nconst textCoreConstants = {\n  IDEOGRAPHIC: 'ideographic',\n  RIGHT_TO_LEFT: 'rtl',\n  LEFT_TO_RIGHT: 'ltr',\n  _CTX_MIDDLE: 'middle',\n  _TEXT_BOUNDS: '_textBoundsSingle',\n  _FONT_BOUNDS: '_fontBoundsSingle',\n  HANGING: 'hanging',\n  START: 'start',\n  END: 'end',\n};\n\nfunction textCore(p5, fn) {\n  const LeadingScale = 1.275;\n  const DefaultFill = '#000000';\n  const LinebreakRe = /\\r?\\n/g;\n  const CommaDelimRe = /,\\s+/;\n  const QuotedRe = /^\".*\"$/;\n  const TabsRe = /\\t/g;\n\n  const FontVariationSettings = 'fontVariationSettings';\n  const VariableAxes = ['wght', 'wdth', 'ital', 'slnt', 'opsz'];\n  const VariableAxesRe = new RegExp(`(?:${VariableAxes.join('|')})`);\n\n  const textFunctions = [\n    'text',\n    'textAlign',\n    'textAscent',\n    'textDescent',\n    'textLeading',\n    'textMode',\n    'textFont',\n    'textSize',\n    'textStyle',\n    'textWidth',\n    'textWrap',\n    'textBounds',\n    'textDirection',\n    'textProperty',\n    'textProperties',\n    'fontBounds',\n    'fontWidth',\n    'fontAscent',\n    'fontDescent',\n    'textWeight'\n  ];\n\n  /**\n   * Draws text to the canvas.\n   *\n   * The first parameter, `str`, is the text to be drawn. The second and third\n   * parameters, `x` and `y`, set the coordinates of the text's bottom-left\n   * corner. See <a href=\"#/p5/textAlign\">textAlign()</a> for other ways to\n   * align text.\n   *\n   * The fourth and fifth parameters, `maxWidth` and `maxHeight`, are optional.\n   * They set the dimensions of the invisible rectangle containing the text. By\n   * default, they set its  maximum width and height. See\n   * <a href=\"#/p5/rectMode\">rectMode()</a> for other ways to define the\n   * rectangular text box. Text will wrap to fit within the text box. Text\n   * outside of the box won't be drawn.\n   *\n   * Text can be styled a few ways. Call the <a href=\"#/p5/fill\">fill()</a>\n   * function to set the text's fill color. Call\n   * <a href=\"#/p5/stroke\">stroke()</a> and\n   * <a href=\"#/p5/strokeWeight\">strokeWeight()</a> to set the text's outline.\n   * Call <a href=\"#/p5/textSize\">textSize()</a> and\n   * <a href=\"#/p5/textFont\">textFont()</a> to set the text's size and font,\n   * respectively.\n   *\n   * Note: `WEBGL` mode only supports fonts loaded with\n   * <a href=\"#/p5/loadFont\">loadFont()</a>. Calling\n   * <a href=\"#/p5/stroke\">stroke()</a> has no effect in `WEBGL` mode.\n   *\n   * @method text\n   * @param {String|Object|Array|Number|Boolean} str text to be displayed.\n   * @param {Number} x          x-coordinate of the text box.\n   * @param {Number} y          y-coordinate of the text box.\n   * @param {Number} [maxWidth] maximum width of the text box. See\n   *                            <a href=\"#/p5/rectMode\">rectMode()</a> for\n   *                            other options.\n   * @param {Number} [maxHeight] maximum height of the text box. See\n   *                            <a href=\"#/p5/rectMode\">rectMode()</a> for\n   *                            other options.\n   *\n   * @for p5\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(200);\n   *   text('hi', 50, 50);\n   *\n   *   describe('The text \"hi\" written in black in the middle of a gray square.');\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background('skyblue');\n   *   textSize(100);\n   *   text('', 0, 100);\n   *\n   *   describe('A rainbow in a blue sky.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   textSize(32);\n   *   fill(255);\n   *   stroke(0);\n   *   strokeWeight(4);\n   *   text('hi', 50, 50);\n   *\n   *   describe('The text \"hi\" written in white with a black outline.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background('black');\n   *   textSize(22);\n   *   fill('yellow');\n   *   text('rainbows', 6, 20);\n   *   fill('cornflowerblue');\n   *   text('rainbows', 6, 45);\n   *   fill('tomato');\n   *   text('rainbows', 6, 70);\n   *   fill('limegreen');\n   *   text('rainbows', 6, 95);\n   *\n   *   describe('The text \"rainbows\" written on several lines, each in a different color.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(200);\n   *   let s = 'The quick brown fox jumps over the lazy dog.';\n   *   text(s, 10, 10, 70, 80);\n   *\n   *   describe('The sample text \"The quick brown fox...\" written in black across several lines.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(200);\n   *   rectMode(CENTER);\n   *   let s = 'The quick brown fox jumps over the lazy dog.';\n   *   text(s, 50, 50, 70, 80);\n   *\n   *   describe('The sample text \"The quick brown fox...\" written in black across several lines.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div modernizr='webgl'>\n   * <code>\n   * let font;\n   *\n   * async function setup() {\n   *   createCanvas(100, 100, WEBGL);\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   textFont(font);\n   *   textSize(32);\n   *   textAlign(CENTER, CENTER);\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *   rotateY(frameCount / 30);\n   *   text('p5*js', 0, 0);\n   *\n   *   describe('The text \"p5*js\" written in white and spinning in 3D.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * Sets the way text is aligned when <a href=\"#/p5/text\">text()</a> is called.\n   *\n   * By default, calling `text('hi', 10, 20)` places the bottom-left corner of\n   * the text's bounding box at (10, 20).\n   *\n   * The first parameter, `horizAlign`, changes the way\n   * <a href=\"#/p5/text\">text()</a> interprets x-coordinates. By default, the\n   * x-coordinate sets the left edge of the bounding box. `textAlign()` accepts\n   * the following values for `horizAlign`: `LEFT`, `CENTER`, or `RIGHT`.\n   *\n   * The second parameter, `vertAlign`, is optional. It changes the way\n   * <a href=\"#/p5/text\">text()</a> interprets y-coordinates. By default, the\n   * y-coordinate sets the bottom edge of the bounding box. `textAlign()`\n   * accepts the following values for `vertAlign`: `TOP`, `BOTTOM`, `CENTER`,\n   * or `BASELINE`.\n   *\n   * @method textAlign\n   * @for p5\n   * @param {LEFT|CENTER|RIGHT} horizAlign horizontal alignment\n   * @param {TOP|BOTTOM|CENTER|BASELINE} [vertAlign] vertical alignment\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Draw a vertical line.\n   *   strokeWeight(0.5);\n   *   line(50, 0, 50, 100);\n   *\n   *   // Top line.\n   *   textSize(16);\n   *   textAlign(RIGHT);\n   *   text('ABCD', 50, 30);\n   *\n   *   // Middle line.\n   *   textAlign(CENTER);\n   *   text('EFGH', 50, 50);\n   *\n   *   // Bottom line.\n   *   textAlign(LEFT);\n   *   text('IJKL', 50, 70);\n   *\n   *   describe('The letters ABCD displayed at top-left, EFGH at center, and IJKL at bottom-right. A vertical line divides the canvas in half.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   strokeWeight(0.5);\n   *\n   *   // First line.\n   *   line(0, 12, width, 12);\n   *   textAlign(CENTER, TOP);\n   *   text('TOP', 50, 12);\n   *\n   *   // Second line.\n   *   line(0, 37, width, 37);\n   *   textAlign(CENTER, CENTER);\n   *   text('CENTER', 50, 37);\n   *\n   *   // Third line.\n   *   line(0, 62, width, 62);\n   *   textAlign(CENTER, BASELINE);\n   *   text('BASELINE', 50, 62);\n   *\n   *   // Fourth line.\n   *   line(0, 97, width, 97);\n   *   textAlign(CENTER, BOTTOM);\n   *   text('BOTTOM', 50, 97);\n   *\n   *   describe('The words \"TOP\", \"CENTER\", \"BASELINE\", and \"BOTTOM\" each drawn relative to a horizontal line. Their positions demonstrate different vertical alignments.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * Returns the ascent of the text.\n   *\n   * The `textAscent()` function calculates the distance from the baseline to the\n   * highest point of the current font. This value represents the ascent, which is essential\n   * for determining the overall height of the text along with `textDescent()`. If\n   * a text string is provided as an argument, the ascent is calculated based on that specific\n   * string; otherwise, the ascent of the current font is returned.\n   *\n   * @method textAscent\n   * @for p5\n   *\n   * @param {String} [txt] - (Optional) The text string for which to calculate the ascent.\n   *                         If omitted, the function returns the ascent for the current font.\n   * @returns {Number} The ascent value in pixels.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(400, 300);\n   *   background(220);\n   *\n   *   textSize(48);\n   *   textAlign(LEFT, BASELINE);\n   *   textFont('Georgia');\n   *\n   *   let s = \"Hello, p5.js!\";\n   *   let x = 50, y = 150;\n   *\n   *   fill(0);\n   *   text(s, x, y);\n   *\n   *   // Get the ascent of the current font\n   *   let asc = textAscent();\n   *\n   *   // Draw a red line at the baseline and a blue line at the ascent position\n   *   stroke('red');\n   *   line(x, y, x + 200, y); // Baseline\n   *   stroke('blue');\n   *   line(x, y - asc, x + 200, y - asc); // Ascent (top of text)\n   *\n   *   noStroke();\n   *   fill(0);\n   *   textSize(16);\n   *   text(\"textAscent: \" + asc.toFixed(2) + \" pixels\", x, y - asc - 10);\n   * }\n   * </code>\n   * </div>\n   *\n   *\n   * @example\n   * <div>\n   * <code>\n   * let font;\n   *\n   * async function setup()  {\n   *   font = await loadFont('assets/inconsolata.otf');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textFont(font);\n   *\n   *   // Different for each font.\n   *   let fontScale = 0.8;\n   *\n   *   let baseY = 75;\n   *   strokeWeight(0.5);\n   *\n   *   // Draw small text.\n   *   textSize(24);\n   *   text('dp', 0, baseY);\n   *\n   *   // Draw baseline and ascent.\n   *   let a = textAscent() * fontScale;\n   *   line(0, baseY, 23, baseY);\n   *   line(23, baseY - a, 23, baseY);\n   *\n   *   // Draw large text.\n   *   textSize(48);\n   *   text('dp', 45, baseY);\n   *\n   *   // Draw baseline and ascent.\n   *   a = textAscent() * fontScale;\n   *   line(45, baseY, 91, baseY);\n   *   line(91, baseY - a, 91, baseY);\n   *\n   *   describe('The letters \"dp\" written twice in different sizes. Each version has a horizontal baseline. A vertical line extends upward from each baseline to the top of the \"d\".');\n   * }\n   * </code>\n   * </div>\n   */\n\n\n  /**\n   * Returns the descent of the text.\n   *\n   * The `textDescent()` function calculates the distance from the baseline to the\n   * lowest point of the current font. This value represents the descent, which, when combined\n   * with the ascent (from `textAscent()`), determines the overall vertical span of the text.\n   * If a text string is provided as an argument, the descent is calculated based on that specific string;\n   * otherwise, the descent of the current font is returned.\n   *\n   * @method textDescent\n   * @for p5\n   *\n   * @param {String} [txt] - (Optional) The text string for which to calculate the descent.\n   *                         If omitted, the function returns the descent for the current font.\n   * @returns {Number} The descent value in pixels.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(400, 300);\n   *   background(220);\n   *\n   *   textSize(48);\n   *   textAlign(LEFT, BASELINE);\n   *   textFont('Georgia');\n   *\n   *   let s = \"Hello, p5.js!\";\n   *   let x = 50, y = 150;\n   *\n   *   fill(0);\n   *   text(s, x, y);\n   *\n   *   // Get the descent of the current font\n   *   let desc = textDescent();\n   *\n   *   // Draw a red line at the baseline and a blue line at the bottom of the text\n   *   stroke('red');\n   *   line(x, y, x + 200, y); // Baseline\n   *   stroke('blue');\n   *   line(x, y + desc, x + 200, y + desc); // Descent (bottom of text)\n   *\n   *   noStroke();\n   *   fill(0);\n   *   textSize(16);\n   *   text(\"textDescent: \" + desc.toFixed(2) + \" pixels\", x, y + desc + 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * let font;\n   *\n   * async function setup()  {\n   *   font = await loadFont('assets/inconsolata.otf');\n   *\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the font.\n   *   textFont(font);\n   *\n   *   // Different for each font.\n   *   let fontScale = 0.9;\n   *\n   *   let baseY = 75;\n   *   strokeWeight(0.5);\n   *\n   *   // Draw small text.\n   *   textSize(24);\n   *   text('dp', 0, baseY);\n   *\n   *   // Draw baseline and descent.\n   *   let d = textDescent() * fontScale;\n   *   line(0, baseY, 23, baseY);\n   *   line(23, baseY, 23, baseY + d);\n   *\n   *   // Draw large text.\n   *   textSize(48);\n   *   text('dp', 45, baseY);\n   *\n   *   // Draw baseline and descent.\n   *   d = textDescent() * fontScale;\n   *   line(45, baseY, 91, baseY);\n   *   line(91, baseY, 91, baseY + d);\n   *\n   *   describe('The letters \"dp\" written twice in different sizes. Each version has a horizontal baseline. A vertical line extends downward from each baseline to the bottom of the \"p\".');\n   * }\n   * </code>\n   * </div>\n   */\n\n/**\n * Sets the spacing between lines of text when\n * <a href=\"#/p5/text\">text()</a> is called.\n *\n * Note: Spacing is measured in pixels.\n *\n * Calling `textLeading()` without an argument returns the current spacing.\n *\n * @method textLeading\n * @for p5\n * @param {Number} leading The new text leading to apply, in pixels\n * @returns {Number} If no arguments are provided, the current text leading\n *\n * @example\n * <div>\n * <code>\n * function setup() {\n *   createCanvas(100, 100);\n *\n *   background(200);\n *\n *   // \"\\n\" starts a new line of text.\n *   let lines = 'one\\ntwo';\n *\n *   // Left.\n *   text(lines, 10, 25);\n *\n *   // Right.\n *   textLeading(30);\n *   text(lines, 70, 25);\n *\n *   describe('The words \"one\" and \"two\" written on separate lines twice. The words on the left have less vertical spacing than the words on the right.');\n * }\n * </code>\n * </div>\n */\n /*\n  * @method textLeading\n  * @for p5\n  */\n\n  /**\n   * Sets the font used by the <a href=\"#/p5/text\">text()</a> function.\n   *\n   * The first parameter, `font`, sets the font. `textFont()` recognizes either\n   * a <a href=\"#/p5.Font\">p5.Font</a> object or a string with the name of a\n   * system font. For example, `'Courier New'`.\n   *\n   * The second parameter, `size`, is optional. It sets the font size in pixels.\n   * This has the same effect as calling <a href=\"#/p5/textSize\">textSize()</a>.\n   *\n   * Note: `WEBGL` mode only supports fonts loaded with\n   * <a href=\"#/p5/loadFont\">loadFont()</a>.\n   *\n   * @method textFont\n   * @param {p5.Font|String|Object} font The font to apply\n   * @param {Number} [size] An optional text size to apply.\n   * @for p5\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(200);\n   *   textFont('Courier New');\n   *   textSize(24);\n   *   text('hi', 35, 55);\n   *\n   *   describe('The text \"hi\" written in a black, monospace font on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background('black');\n   *   fill('palegreen');\n   *   textFont('Courier New', 10);\n   *   text('You turn to the left and see a door. Do you enter?', 5, 5, 90, 90);\n   *   text('>', 5, 70);\n   *\n   *   describe('A text prompt from a game is written in a green, monospace font on a black background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   background(200);\n   *   textFont('Verdana');\n   *   let currentFont = textFont();\n   *   text(currentFont, 25, 50);\n   *\n   *   describe('The text \"Verdana\" written in a black, sans-serif font on a gray background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * let fontRegular;\n   * let fontItalic;\n   * let fontBold;\n   *\n   * async function setup() {\n   *   createCanvas(100, 100);\n   *   fontRegular = await loadFont('assets/Regular.otf');\n   *   fontItalic = await loadFont('assets/Italic.ttf');\n   *   fontBold = await loadFont('assets/Bold.ttf');\n   *\n   *   background(200);\n   *   textFont(fontRegular);\n   *   text('I am Normal', 10, 30);\n   *   textFont(fontItalic);\n   *   text('I am Italic', 10, 50);\n   *   textFont(fontBold);\n   *   text('I am Bold', 10, 70);\n   *\n   *   describe('The statements \"I am Normal\", \"I am Italic\", and \"I am Bold\" written in black on separate lines. The statements have normal, italic, and bold fonts, respectively.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * Sets or gets the current text size.\n   *\n   * The `textSize()` function is used to specify the size of the text\n   * that will be rendered on the canvas. When called with an argument, it sets the\n   * text size to the specified value (which can be a number representing pixels or a\n   * CSS-style string, e.g., '32px', '2em'). When called without an argument, it\n   * returns the current text size in pixels.\n   *\n   * @method textSize\n   * @for p5\n   *\n   * @param {Number} size - The size to set for the text.\n   * @returns {Number} If no arguments are provided, the current text size in pixels.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(600, 200);\n   *   background(240);\n   *\n   *   // Set the text size to 48 pixels\n   *   textSize(48);\n   *   textAlign(CENTER, CENTER);\n   *   textFont(\"Georgia\");\n   *\n   *   // Draw text using the current text size\n   *   fill(0);\n   *   text(\"Hello, p5.js!\", width / 2, height / 2);\n   *\n   *   // Retrieve and display the current text size\n   *   let currentSize = textSize();\n   *   fill(50);\n   *   textSize(16);\n   *   text(\"Current text size: \" + currentSize, width / 2, height - 20);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Top.\n   *   textSize(12);\n   *   text('Font Size 12', 10, 30);\n   *\n   *   // Middle.\n   *   textSize(14);\n   *   text('Font Size 14', 10, 60);\n   *\n   *   // Bottom.\n   *   textSize(16);\n   *   text('Font Size 16', 10, 90);\n   *\n   *   describe('The text \"Font Size 12\" drawn small, \"Font Size 14\" drawn medium, and \"Font Size 16\" drawn large.');\n   * }\n   * </code>\n   * </div>\n   */\n   /**\n    * @method textSize\n    * @for p5\n    * @returns {Number} The current text size in pixels.\n    */\n\n  /**\n   * Sets the style for system fonts when\n   * <a href=\"#/p5/text\">text()</a> is called.\n   *\n   * The parameter, `style`, can be either `NORMAL`, `ITALIC`, `BOLD`, or\n   * `BOLDITALIC`.\n   *\n   * `textStyle()` may be overridden by CSS styling. This function doesn't\n   * affect fonts loaded with <a href=\"#/p5/loadFont\">loadFont()</a>.\n   *\n   * @method textStyle\n   * @for p5\n   * @param {NORMAL|ITALIC|BOLD|BOLDITALIC} style The style to use\n   * @returns {NORMAL|ITALIC|BOLD|BOLDITALIC} If no arguments are provided, the current style\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textSize(12);\n   *   textAlign(CENTER);\n   *\n   *   // First row.\n   *   textStyle(NORMAL);\n   *   text('Normal', 50, 15);\n   *\n   *   // Second row.\n   *   textStyle(ITALIC);\n   *   text('Italic', 50, 40);\n   *\n   *   // Third row.\n   *   textStyle(BOLD);\n   *   text('Bold', 50, 65);\n   *\n   *   // Fourth row.\n   *   textStyle(BOLDITALIC);\n   *   text('Bold Italic', 50, 90);\n   *\n   *   describe('The words \"Normal\" displayed normally, \"Italic\" in italic, \"Bold\" in bold, and \"Bold Italic\" in bold italics.');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method textStyle\n   * @for p5\n   * @returns {NORMAL|BOLD|ITALIC|BOLDITALIC}\n   */\n\n\n  /**\n   * Calculates the width of the given text string in pixels.\n   *\n   * The `textWidth()` function processes the provided text string to determine its tight bounding box\n   * based on the current text properties such as font, textSize, and textStyle. Internally, it splits\n   * the text into individual lines (if line breaks are present) and computes the bounding box for each\n   * line using the renderers measurement functions. The final width is determined as the maximum width\n   * among all these lines.\n   *\n   * For example, if the text contains multiple lines due to wrapping or explicit line breaks, textWidth()\n   * will return the width of the longest line.\n   *\n   * @method textWidth\n   * @for p5\n   * @param {String} text The text to measure\n   * @returns {Number} The width of the text\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(200, 200);\n   *   background(220);\n   *\n   *   // Set text size and alignment\n   *   textSize(48);\n   *   textAlign(LEFT, TOP);\n   *\n   *   let myText = \"Hello\";\n   *\n   *   // Calculate the width of the text\n   *   let tw = textWidth(myText);\n   *\n   *   // Draw the text on the canvas\n   *   fill(0);\n   *   text(myText, 50, 50);\n   *\n   *   // Display the text width below\n   *   noStroke();\n   *   fill(0);\n   *   textSize(20);\n   *   text(\"Text width: \" + tw, 10, 150);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textSize(28);\n   *   strokeWeight(0.5);\n   *\n   *   // Calculate the text width.\n   *   let s = 'yoyo';\n   *   let w = textWidth(s);\n   *\n   *   // Display the text.\n   *   text(s, 22, 55);\n   *\n   *   // Underline the text.\n   *   line(22, 55, 22 + w, 55);\n   *\n   *   describe('The word \"yoyo\" underlined.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textSize(28);\n   *   strokeWeight(0.5);\n   *\n   *   // Calculate the text width.\n   *   // \"\\n\" starts a new line.\n   *   let s = 'yo\\nyo';\n   *   let w = textWidth(s);\n   *\n   *   // Display the text.\n   *   text(s, 22, 55);\n   *\n   *   // Underline the text.\n   *   line(22, 55, 22 + w, 55);\n   *\n   *   describe('The word \"yo\" written twice, one copy beneath the other. The words are divided by a horizontal line.');\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * Sets the style for wrapping text when\n   * <a href=\"#/p5/text\">text()</a> is called.\n   *\n   * The parameter, `style`, can be one of the following values:\n   *\n   * `WORD` starts new lines of text at spaces. If a string of text doesn't\n   * have spaces, it may overflow the text box and the canvas. This is the\n   * default style.\n   *\n   * `CHAR` starts new lines as needed to stay within the text box.\n   *\n   * `textWrap()` only works when the maximum width is set for a text box. For\n   * example, calling `text('Have a wonderful day', 0, 10, 100)` sets the\n   * maximum width to 100 pixels.\n   *\n   * Calling `textWrap()` without an argument returns the current style.\n   *\n   * @method textWrap\n   * @for p5\n   *\n   * @param {WORD|CHAR} style The wrapping style to use\n   * @returns {CHAR|WORD} If no arguments are provided, the current wrapping style\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textSize(20);\n   *   textWrap(WORD);\n   *\n   *   // Display the text.\n   *   text('Have a wonderful day', 0, 10, 100);\n   *\n   *   describe('The text \"Have a wonderful day\" written across three lines.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textSize(20);\n   *   textWrap(CHAR);\n   *\n   *   // Display the text.\n   *   text('Have a wonderful day', 0, 10, 100);\n   *\n   *   describe('The text \"Have a wonderful day\" written across two lines.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *\n   *   background(200);\n   *\n   *   // Style the text.\n   *   textSize(20);\n   *   textWrap(CHAR);\n   *\n   *   // Display the text.\n   *   text('', 0, 10, 100);\n   *\n   *   describe('The text \"\" written across two lines.');\n   * }\n   * </code>\n   * </div>\n   */\n   /**\n    * @method textWrap\n    * @for p5\n    * @returns {CHAR|WORD} The current wrapping style\n    */\n\n\n  /**\n   * Computes the tight bounding box for a block of text.\n   *\n   * The `textBounds()` function calculates the precise pixel boundaries that enclose\n   * the rendered text based on the current text properties (such as font, textSize, textStyle, and\n   * alignment). If the text spans multiple lines (due to line breaks or wrapping), the function\n   * measures each line individually and then aggregates these measurements into a single bounding box.\n   * The resulting object contains the x and y coordinates along with the width (w) and height (h)\n   * of the text block.\n   *\n   * @method textBounds\n   * @for p5\n   *\n   * @param {String} str - The text string to measure.\n   * @param {Number} x - The x-coordinate where the text is drawn.\n   * @param {Number} y - The y-coordinate where the text is drawn.\n   * @param {Number} [width] - (Optional) The maximum width available for the text block.\n   *                           When specified, the text may be wrapped to fit within this width.\n   * @param {Number} [height] - (Optional) The maximum height available for the text block.\n   *                            Any lines exceeding this height will be truncated.\n   * @returns {Object} An object with properties `x`, `y`, `w`, and `h` that represent the tight\n   *                   bounding box of the rendered text.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(300, 200);\n   *   background(220);\n   *\n   *   // Set up text properties for clarity\n   *   textSize(32);\n   *   textAlign(LEFT, TOP);\n   *\n   *   let txt = \"Hello, World!\";\n   *   // Compute the bounding box for the text starting at (50, 50)\n   *   let bounds = textBounds(txt, 50, 50);\n   *\n   *   // Draw the text\n   *   fill(0);\n   *   text(txt, 50, 50);\n   *\n   *   // Draw the computed bounding box in red to visualize the measured area\n   *   noFill();\n   *   stroke('red');\n   *   rect(bounds.x, bounds.y, bounds.w, bounds.h);\n   * }\n   * </code>\n   * </div>\n   */\n\n\n  /**\n   * Sets or gets the text drawing direction.\n   *\n   * The <code>textDirection()</code> function allows you to specify the direction in which text is\n   * rendered on the canvas. When provided with a <code>direction</code> parameter (such as \"ltr\" for\n   * left-to-right, \"rtl\" for right-to-left, or \"inherit\"), it updates the renderer's state with that\n   * value and applies the new setting. When called without any arguments, it returns the current text\n   * direction. This function is particularly useful for rendering text in languages with different\n   * writing directions.\n   *\n   * @method textDirection\n   * @for p5\n   *\n   * @param {String} direction - The text direction to set (\"ltr\", \"rtl\", or \"inherit\").\n   * @returns {String} If no arguments are provided, the current text direction, either \"ltr\", \"rtl\", or \"inherit\"\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(300, 300);\n   *   background(240);\n   *\n   *   textSize(32);\n   *   textFont(\"Georgia\");\n   *   textAlign(LEFT, TOP);\n   *\n   *   // Set text direction to right-to-left and draw Arabic text.\n   *   textDirection(\"rtl\");\n   *   fill(0);\n   *   text(\"!\", 50, 50);\n   *\n   *   // Set text direction to left-to-right and draw English text.\n   *   textDirection(\"ltr\");\n   *   text(\"Hello, p5.js!\", 50, 150);\n   *\n   *   // Display the current text direction.\n   *   textSize(16);\n   *   fill(50);\n   *   textAlign(LEFT, TOP);\n   *   text(\"Current textDirection: \" + textDirection(), 50, 250);\n   * }\n   * </code>\n   * </div>\n   */\n   /**\n    * @method textDirection\n    * @for p5\n    * @returns {String} The current text direction, either \"ltr\", \"rtl\", or \"inherit\"\n    */\n\n  /**\n   * Sets or gets a single text property for the renderer.\n   *\n   * The `textProperty()` function allows you to set or retrieve a single text-related property,\n   * such as `textAlign`, `textBaseline`, `fontStyle`, or any other property\n   * that may be part of the renderer's state, its drawing context, or the canvas style.\n   *\n   * When called with a `prop` and a `value`, the function sets the property by checking\n   * for its existence in the renderer's state, the drawing context, or the canvas style. If the property is\n   * successfully modified, the function applies the updated text properties. If called with only the\n   * `prop` parameter, the function returns the current value of that property.\n   *\n   * @method textProperty\n   * @for p5\n   *\n   * @param {String} prop - The name of the text property to set or get.\n   * @param value - The value to set for the specified text property. If omitted, the current\n   *                      value of the property is returned\n   * @returns If no arguments are provided, the current value of the specified text property\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(300, 300);\n   *   background(240);\n   *\n   *   // Set the text alignment to CENTER and the baseline to TOP using textProperty.\n   *   textProperty(\"textAlign\", CENTER);\n   *   textProperty(\"textBaseline\", TOP);\n   *\n   *   // Set additional text properties and draw the text.\n   *   textSize(32);\n   *   textFont(\"Georgia\");\n   *   fill(0);\n   *   text(\"Hello, World!\", width / 2, 50);\n   *\n   *   // Retrieve and display the current text properties.\n   *   let currentAlign = textProperty(\"textAlign\");\n   *   let currentBaseline = textProperty(\"textBaseline\");\n   *\n   *   textSize(16);\n   *   textAlign(LEFT, TOP);\n   *   fill(50);\n   *   text(\"Current textAlign: \" + currentAlign, 50, 150);\n   *   text(\"Current textBaseline: \" + currentBaseline, 50, 170);\n   * }\n   * </code>\n   * </div>\n   */\n   /**\n    * @method textProperty\n    * @for p5\n    * @param {String} prop - The name of the text property to set or get.\n    * @returns The current value of the specified text property\n    */\n\n  /**\n   * Gets or sets text properties in batch, similar to calling `textProperty()`\n   * multiple times.\n   *\n   * If an object is passed in, `textProperty(key, value)` will be called for you\n   * on every key/value pair in the object.\n   *\n   * If no arguments are passed in, an object will be returned with all the current\n   * properties.\n   *\n   * @method textProperties\n   * @for p5\n   * @param {Object} properties An object whose keys are properties to set, and whose\n   *                            values are what they should be set to.\n   */\n  /**\n   * @method textProperties\n   * @for p5\n   * @returns {Object} An object with all the possible properties and their current values.\n   */\n\n  /**\n   * Computes a generic (non-tight) bounding box for a block of text.\n   *\n   * The `fontBounds()` function calculates the bounding box for the text based on the\n   * font's intrinsic metrics (such as `fontBoundingBoxAscent` and\n   * `fontBoundingBoxDescent`). Unlike `textBounds()`, which measures the exact\n   * pixel boundaries of the rendered text, `fontBounds()` provides a looser measurement\n   * derived from the fonts default spacing. This measurement is useful for layout purposes where\n   * a consistent approximation of the text's dimensions is desired.\n   *\n   * @method fontBounds\n   * @for p5\n   *\n   * @param {String} str - The text string to measure.\n   * @param {Number} x - The x-coordinate where the text is drawn.\n   * @param {Number} y - The y-coordinate where the text is drawn.\n   * @param {Number} [width] - (Optional) The maximum width available for the text block.\n   *                           When specified, the text may be wrapped to fit within this width.\n   * @param {Number} [height] - (Optional) The maximum height available for the text block.\n   *                            Any lines exceeding this height will be truncated.\n   * @returns {Object} An object with properties `x`, `y`, `w`, and `h` representing the loose\n   *                   bounding box of the text based on the font's intrinsic metrics.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(300, 200);\n   *   background(240);\n   *\n   *   textSize(32);\n   *   textAlign(LEFT, TOP);\n   *   textFont('Georgia');\n   *\n   *   let txt = \"Hello, World!\";\n   *   // Compute the bounding box based on the font's intrinsic metrics\n   *   let bounds = fontBounds(txt, 50, 50);\n   *\n   *   fill(0);\n   *   text(txt, 50, 50);\n   *\n   *   noFill();\n   *   stroke('green');\n   *   rect(bounds.x, bounds.y, bounds.w, bounds.h);\n   *\n   *   noStroke();\n   *   fill(50);\n   *   textSize(15);\n   *   text(\"Font Bounds: x=\" + bounds.x.toFixed(1) + \", y=\" + bounds.y.toFixed(1) +\n   *        \", w=\" + bounds.w.toFixed(1) + \", h=\" + bounds.h.toFixed(1), 8, 100);\n   * }\n   * </code>\n   * </div>\n   */\n\n\n  /**\n   * Returns the loose width of a text string based on the current font.\n   *\n   * The `fontWidth()` function measures the width of the provided text string using\n   * the font's default measurement (i.e., the width property from the text metrics returned by\n   * the browser). Unlike `textWidth()`, which calculates the tight pixel boundaries\n   * of the text glyphs, `fontWidth()` uses the font's intrinsic spacing, which may include\n   * additional space for character spacing and kerning. This makes it useful for scenarios where\n   * an approximate width is sufficient for layout and positioning.\n   *\n   * @method fontWidth\n   * @for p5\n   *\n   * @param {String} theText - The text string to measure.\n   * @returns {Number} The loose width of the text in pixels.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(300, 200);\n   *   background(240);\n   *\n   *   textSize(32);\n   *   textAlign(LEFT, TOP);\n   *   textFont('Georgia');\n   *\n   *   let s = \"Hello, World!\";\n   *   let fw = fontWidth(s);\n   *\n   *   fill(0);\n   *   text(s, 50, 50);\n   *\n   *   stroke('blue');\n   *   line(50, 90, 50 + fw, 90);\n   *\n   *   noStroke();\n   *   fill(50);\n   *   textSize(16);\n   *   text(\"Font width: \" + fw.toFixed(2) + \" pixels\", 50, 100);\n   * }\n   * </code>\n   * </div>\n   */\n\n\n  /**\n   * Returns the loose ascent of the text based on the font's intrinsic metrics.\n   *\n   * The `fontAscent()` function calculates the ascent of the text using the font's\n   * intrinsic metrics (e.g., `fontBoundingBoxAscent`). This value represents the space\n   * above the baseline that the font inherently occupies, and is useful for layout purposes when\n   * an approximate vertical measurement is required.\n   *\n   * @method fontAscent\n   * @for p5\n   *\n   * @returns {Number} The loose ascent value in pixels.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(300, 300);\n   *   background(220);\n   *\n   *   textSize(35);\n   *   textAlign(LEFT, BASELINE);\n   *   textFont('Georgia');\n   *\n   *   let s = \"Hello, p5.js!\";\n   *   let x = 50, y = 150;\n   *\n   *   fill(0);\n   *   text(s, x, y);\n   *\n   *   // Get the font descent of the current font\n   *   let fasc = fontAscent();\n   *\n   *   // Draw a red line at the baseline and a blue line at the ascent position\n   *   stroke('red');\n   *   line(x, y, x + 200, y); // Baseline\n   *   stroke('blue');\n   *   line(x, y - fasc, x + 200, y - fasc); // Font ascent position\n   *\n   *   noStroke();\n   *   fill(0);\n   *   textSize(16);\n   *   text(\"fontAscent: \" + fasc.toFixed(2) + \" pixels\", x, y + fdesc + 20);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   * Returns the loose descent of the text based on the font's intrinsic metrics.\n   *\n   * The `fontDescent()` function calculates the descent of the text using the font's\n   * intrinsic metrics (e.g., `fontBoundingBoxDescent`). This value represents the space\n   * below the baseline that the font inherently occupies, and is useful for layout purposes when\n   * an approximate vertical measurement is required.\n   *\n   * @method fontDescent\n   * @for p5\n   *\n   * @returns {Number} The loose descent value in pixels.\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(300, 300);\n   *   background(220);\n   *\n   *   textSize(48);\n   *   textAlign(LEFT, BASELINE);\n   *   textFont('Georgia');\n   *\n   *   let s = \"Hello, p5.js!\";\n   *   let x = 50, y = 150;\n   *\n   *   fill(0);\n   *   text(s, x, y);\n   *\n   *   // Get the font descent of the current font\n   *   let fdesc = fontDescent();\n   *\n   *   // Draw a red line at the baseline and a blue line at the descent position\n   *   stroke('red');\n   *   line(x, y, x + 200, y); // Baseline\n   *   stroke('blue');\n   *   line(x, y + fdesc, x + 200, y + fdesc); // Font descent position\n   *\n   *   noStroke();\n   *   fill(0);\n   *   textSize(16);\n   *   text(\"fontDescent: \" + fdesc.toFixed(2) + \" pixels\", x, y + fdesc + 20);\n   * }\n   * </code>\n   * </div>\n   */\n\n  /**\n   *\n   * Sets or gets the current font weight.\n   *\n   * The <code>textWeight()</code> function is used to specify the weight (thickness) of the text.\n   * When a numeric value is provided, it sets the font weight to that value and updates the\n   * rendering properties accordingly (including the \"font-variation-settings\" on the canvas style).\n   * When called without an argument, it returns the current font weight setting.\n   *\n   * @method textWeight\n   * @for p5\n   *\n   * @param {Number} weight - The numeric weight value to set for the text.\n   * @returns {Number} If no arguments are provided, the current font weight\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(300, 200);\n   *   background(240);\n   *\n   *   // Set text alignment, size, and font\n   *   textAlign(LEFT, TOP);\n   *   textSize(20);\n   *   textFont(\"Georgia\");\n   *\n   *   // Draw text with a normal weight (lighter appearance)\n   *   push();\n   *   textWeight(400);  // Set font weight to 400\n   *   fill(0);\n   *   text(\"Normal\", 50, 50);\n   *   let normalWeight = textWeight();  // Should return 400\n   *   pop();\n   *\n   *   // Draw text with a bold weight (heavier appearance)\n   *   push();\n   *   textWeight(900);  // Set font weight to 900\n   *   fill(0);\n   *   text(\"Bold\", 50, 100);\n   *   let boldWeight = textWeight();  // Should return 900\n   *   pop();\n   *\n   *   // Display the current font weight values on the canvas\n   *   textSize(16);\n   *   fill(50);\n   *   text(\"Normal Weight: \" + normalWeight, 150, 52);\n   *   text(\"Bold Weight: \" + boldWeight, 150, 100);\n   * }\n   * </code>\n   * </div>\n   *\n   * <div>\n   * <code>\n   * let font;\n   *\n   * async function setup() {\n   *   createCanvas(100, 100);\n   *   font = await loadFont(\n   *     'https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap'\n   *   );\n   * }\n   *\n   * function draw() {\n   *   background(255);\n   *   textFont(font);\n   *   textAlign(LEFT, TOP);\n   *   textSize(35);\n   *   textWeight(sin(millis() * 0.002) * 200 + 400);\n   *   text('p5*js', 0, 10);\n   *   describe('The text p5*js pulsing its weight over time');\n   * }\n   * </code>\n   * </div>\n   */\n  /**\n   * @method textWeight\n   * @for p5\n   * @returns {Number} The current font weight\n   */\n\n  // attach each text func to p5, delegating to the renderer\n  textFunctions.forEach(func => {\n    fn[func] = function (...args) {\n      if (!(func in Renderer.prototype)) {\n        throw Error(`Renderer2D.prototype.${func} is not defined.`);\n      }\n      return this._renderer[func](...args);\n    };\n    // attach also to p5.Graphics.prototype\n    p5.Graphics.prototype[func] = function (...args) {\n      return this._renderer[func](...args);\n    };\n  });\n\n  const RendererTextProps = {\n    textAlign: { default: fn.LEFT, type: 'Context2d' },\n    textBaseline: { default: fn.BASELINE, type: 'Context2d' },\n    textFont: { default: { family: 'sans-serif' } },\n    textLeading: { default: 15 },\n    textSize: { default: 12 },\n    textWrap: { default: fn.WORD },\n    fontStretch: { default: fn.NORMAL, isShorthand: true },  // font-stretch: { default:  normal | ultra-condensed | extra-condensed | condensed | semi-condensed | semi-expanded | expanded | extra-expanded | ultra-expanded }\n    fontWeight: { default: fn.NORMAL, isShorthand: true },   // font-stretch: { default:  normal | ultra-condensed | extra-condensed | condensed | semi-condensed | semi-expanded | expanded | extra-expanded | ultra-expanded }\n    lineHeight: { default: fn.NORMAL, isShorthand: true },   // line-height: { default:  normal | number | length | percentage }\n    fontVariant: { default: fn.NORMAL, isShorthand: true },  // font-variant: { default:  normal | small-caps }\n    fontStyle: { default: fn.NORMAL, isShorthand: true },    // font-style: { default:  normal | italic | oblique } [was 'textStyle' in v1]\n    direction: { default: 'inherit' }, // direction: { default: inherit | ltr | rtl }\n  };\n\n  // note: font must be first here otherwise it may reset other properties\n  const ContextTextProps = ['font', 'direction', 'fontKerning', 'fontStretch', 'fontVariantCaps', 'letterSpacing', 'textAlign', 'textBaseline', 'textRendering', 'wordSpacing'];\n\n  // shorthand font properties that can be set with context2d.font\n  const ShorthandFontProps = Object.keys(RendererTextProps).filter(p => RendererTextProps[p].isShorthand);\n\n  // allowable values for font-stretch property for context2d.font\n  const FontStretchKeys = [\"ultra-condensed\", \"extra-condensed\", \"condensed\", \"semi-condensed\", \"normal\", \"semi-expanded\", \"expanded\", \"extra-expanded\", \"ultra-expanded\"];\n\n  let contextQueue, cachedDiv; // lazy\n\n  ////////////////////////////// start API ///////////////////////////////\n\n  Renderer.prototype.text = function (str, x, y, width, height) {\n\n    let setBaseline = this.textDrawingContext().textBaseline; // store baseline\n\n    // adjust {x,y,w,h} properties based on rectMode\n    ({ x, y, width, height } = this._handleRectMode(x, y, width, height));\n\n    // parse the lines according to width, height & linebreaks\n    let lines = this._processLines(str, width, height);\n\n    // add the adjusted positions [x,y] to each line\n    lines = this._positionLines(x, y, width, height, lines);\n\n    // render each line at the adjusted position\n    lines.forEach(line => this._renderText(line.text, line.x, line.y));\n\n    this.textDrawingContext().textBaseline = setBaseline; // restore baseline\n  };\n\n  /**\n   * Computes the precise (tight) bounding box for a block of text\n   * @param {String} str - the text to measure\n   * @param {Number} x - the x-coordinate of the text\n   * @param {Number} y - the y-coordinate of the text\n   * @param {Number} width - the max width of the text block\n   * @param {Number} height - the max height of the text block\n   * @returns - a bounding box object for the text block: {x,y,w,h}\n   * @private\n   */\n  Renderer.prototype.textBounds = function (str, x, y, width, height) {\n    // delegate to _textBoundsSingle for measuring\n    return this._computeBounds(textCoreConstants._TEXT_BOUNDS, str, x, y, width, height).bounds;\n  };\n\n  /**\n   * Computes a generic (non-tight) bounding box for a block of text\n   * @param {String} str - the text to measure\n   * @param {Number} x - the x-coordinate of the text\n   * @param {Number} y - the y-coordinate of the text\n   * @param {Number} width - the max width of the text block\n   * @param {Number} height - the max height of the text block\n   * @returns - a bounding box object for the text block: {x,y,w,h}\n   * @private\n   */\n  Renderer.prototype.fontBounds = function (str, x, y, width, height) {\n    // delegate to _fontBoundsSingle for measuring\n    return this._computeBounds(textCoreConstants._FONT_BOUNDS, str, x, y, width, height).bounds;\n  };\n\n  /**\n   * Get the width of a text string in pixels (tight bounds)\n   * @param {String} theText\n   * @returns - the width of the text in pixels\n   * @private\n   */\n  Renderer.prototype.textWidth = function (theText) {\n    let lines = this._processLines(theText);\n    // return the max width of the lines (using tight bounds)\n    return Math.max(...lines.map(l => this._textWidthSingle(l)));\n  };\n\n  /**\n   * Get the width of a text string in pixels (loose bounds)\n   * @param {String} theText\n   * @returns - the width of the text in pixels\n   * @private\n   */\n  Renderer.prototype.fontWidth = function (theText) {\n    // return the max width of the lines (using loose bounds)\n    let lines = this._processLines(theText);\n    return Math.max(...lines.map(l => this._fontWidthSingle(l)));\n  };\n\n  /**\n   * @param {*} txt - optional text to measure, if provided will be\n   * used to compute the ascent, otherwise the font's ascent will be used\n   * @returns - the ascent of the text\n   * @private\n   */\n  Renderer.prototype.textAscent = function (txt = '') {\n    if (!txt.length) return this.fontAscent();\n    return this.textDrawingContext().measureText(txt).actualBoundingBoxAscent;\n  };\n\n  /**\n   * @returns - returns the ascent for the current font\n   * @private\n   */\n  Renderer.prototype.fontAscent = function () {\n    return this.textDrawingContext().measureText('_').fontBoundingBoxAscent;\n  };\n\n  /**\n   * @param {*} txt - optional text to measure, if provided will\n   * be used to compute the descent, otherwise the font's descent will be used\n   * @returns - the descent of the text\n   * @private\n   */\n  Renderer.prototype.textDescent = function (txt = '') {\n    if (!txt.length) return this.fontDescent();\n    return this.textDrawingContext().measureText(txt).actualBoundingBoxDescent;\n  };\n\n  Renderer.prototype.fontDescent = function () {\n    return this.textDrawingContext().measureText('_').fontBoundingBoxDescent;\n  };\n\n\n  // setters/getters for text properties //////////////////////////\n\n  Renderer.prototype.textAlign = function (h, v) {\n\n    // the setter\n    if (typeof h !== 'undefined') {\n      this.states.setValue('textAlign', h);\n      if (typeof v !== 'undefined') {\n        if (v === fn.CENTER) {\n          v = textCoreConstants._CTX_MIDDLE;\n        }\n        this.states.setValue('textBaseline', v);\n      }\n      return this._applyTextProperties();\n    }\n    // the getter\n    return {\n      horizontal: this.states.textAlign,\n      vertical: this.states.textBaseline\n    };\n  };\n\n  Renderer.prototype._currentTextFont = function () {\n    return this.states.textFont.font || this.states.textFont.family;\n  };\n\n  /**\n   * Set the font and [size] and [options] for rendering text\n   * @param {p5.Font | string} font - the font to use for rendering text\n   * @param {Number} size - the size of the text, can be a number or a css-style string\n   * @param {Object} options - additional options for rendering text, see FontProps\n   * @private\n   */\n  Renderer.prototype.textFont = function (font, size, options) {\n\n    if (arguments.length === 0) {\n      return this._currentTextFont();\n    }\n\n    let family = font;\n\n    // do we have a custon loaded font ?\n    if (font instanceof p5.Font) {\n      family = font.face.family;\n    }\n    else if (font.data instanceof Uint8Array) {\n      family = font.name.fontFamily;\n      if (font.name?.fontSubfamily) {\n        family += '-' + font.name.fontSubfamily;\n      }\n    }\n    else if (typeof font === 'string') {\n      // direct set the font-string if it contains size\n      if (typeof size === 'undefined' && /[.0-9]+(%|em|p[xt])/.test(family)) {\n        //console.log('direct set font-string: ', family);\n        ({ family, size } = this._directSetFontString(family));\n      }\n    }\n\n    if (typeof family !== 'string') throw Error('null font in textFont()');\n\n    // handle two-arg case: textFont(font, options)\n    if (arguments.length === 2 && typeof size === 'object') {\n      options = size;\n      size = undefined;\n    }\n\n    // update font properties in this.states\n    this.states.setValue('textFont', { font, family, size });\n\n    // convert/update the size in this.states\n    if (typeof size !== 'undefined') {\n      this._setTextSize(size);\n    }\n\n    // apply any options to this.states\n    if (typeof options === 'object') {\n      this.textProperties(options);\n    }\n\n    return this._applyTextProperties();\n  };\n\n  Renderer.prototype._directSetFontString = function (font, debug = 0) {\n    if (debug) console.log('_directSetFontString\"' + font + '\"');\n\n    let defaults = ShorthandFontProps.reduce((props, p) => {\n      props[p] = RendererTextProps[p].default;\n      return props;\n    }, {});\n\n    let el = this._cachedDiv(defaults);\n    el.style.font = font;\n    let style = getComputedStyle(el);\n    ShorthandFontProps.forEach(prop => {\n      this.states[prop] = style[prop];\n      if (debug) console.log('  this.states.' + prop + '=\"' + style[prop] + '\"');\n    });\n\n    return { family: style.fontFamily, size: style.fontSize };\n  };\n\n  Renderer.prototype.textLeading = function (leading) {\n    // the setter\n    if (typeof leading === 'number') {\n      this.states.setValue('leadingSet', true);\n      this.states.setValue('textLeading', leading);\n      return this._applyTextProperties();\n    }\n    // the getter\n    return this.states.textLeading;\n  };\n\n  Renderer.prototype.textWeight = function (weight) {\n    // the setter\n    if (typeof weight === 'number') {\n      this.states.setValue('fontWeight', weight);\n      this._applyTextProperties();\n\n      // Safari works without weight set in the canvas style attribute, and actually\n      // has buggy behavior if it is present, using the wrong weight when drawing\n      // multiple times with different weights\n      if (!p5.prototype._isSafari()) {\n        this._setCanvasStyleProperty('font-variation-settings', `\"wght\" ${weight}`);\n      }\n      return;\n    }\n    // the getter\n    return this.states.fontWeight;\n  };\n\n  /**\n   * @param {*} size - the size of the text, can be a number or a css-style string\n   * @private\n   */\n  Renderer.prototype.textSize = function (size) {\n\n    // the setter\n    if (typeof size !== 'undefined') {\n      this._setTextSize(size);\n      return this._applyTextProperties();\n    }\n    // the getter\n    return this.states.textSize;\n  };\n\n  Renderer.prototype.textStyle = function (style) {\n\n    // the setter\n    if (typeof style !== 'undefined') {\n      this.states.setValue('fontStyle', style);\n      return this._applyTextProperties();\n    }\n    // the getter\n    return this.states.fontStyle;\n  };\n\n  Renderer.prototype.textWrap = function (wrapStyle) {\n\n    if (wrapStyle === fn.WORD || wrapStyle === fn.CHAR) {\n      this.states.setValue('textWrap', wrapStyle);\n      // no need to apply text properties here as not a context property\n      return this._pInst;\n    }\n    return this.states.textWrap;\n  };\n\n  Renderer.prototype.textDirection = function (direction) {\n\n    if (typeof direction !== 'undefined') {\n      this.states.setValue('direction', direction);\n      return this._applyTextProperties();\n    }\n    return this.states.direction;\n  };\n\n  /**\n   * Sets/gets a single text property for the renderer (eg. fontStyle, fontStretch, etc.)\n   * The property to be set can be a mapped or unmapped property on `this.states` or a property\n   * on `this.textDrawingContext()` or on `this.canvas.style`\n   * The property to get can exist in `this.states` or `this.textDrawingContext()` or `this.canvas.style`\n   * @private\n   */\n  Renderer.prototype.textProperty = function (prop, value, opts) {\n\n    let modified = false, debug = opts?.debug || false;\n\n    // getter: return option from this.states or this.textDrawingContext()\n    if (typeof value === 'undefined') {\n      let props = this.textProperties();\n      if (prop in props) return props[prop];\n      throw Error('Unknown text option \"' + prop + '\"'); // FES?\n    }\n\n    // set the option in this.states if it exists\n    if (prop in this.states && this.states[prop] !== value) {\n      this.states[prop] = value;\n      modified = true;\n      if (debug) {\n        console.log('this.states.' + prop + '=\"' + options[prop] + '\"');\n      }\n    }\n    // does it exist in CanvasRenderingContext2D ?\n    else if (prop in this.textDrawingContext()) {\n      this._setContextProperty(prop, value, debug);\n      modified = true;\n    }\n    // does it exist in the canvas.style ?\n    else if (prop in this.textCanvas().style) {\n      this._setCanvasStyleProperty(prop, value, debug);\n      modified = true;\n    }\n    else {\n      console.warn('Ignoring unknown text option: \"' + prop + '\"\\n'); // FES?\n    }\n\n    return modified ? this._applyTextProperties() : this._pInst;\n  };\n\n  /**\n   * Batch set/get text properties for the renderer.\n   * The properties can be either on `states` or `drawingContext`\n   * @private\n   */\n  Renderer.prototype.textProperties = function (properties) {\n\n    // setter\n    if (typeof properties !== 'undefined') {\n      Object.keys(properties).forEach(opt => {\n        this.textProperty(opt, properties[opt]);\n      });\n      return this._pInst;\n    }\n\n    // getter: get props from drawingContext\n    let context = this.textDrawingContext();\n    properties = ContextTextProps.reduce((props, p) => {\n      props[p] = context[p];\n      return props;\n    }, {});\n\n    // add renderer props\n    Object.keys(RendererTextProps).forEach(p => {\n      if (RendererTextProps[p]?.type === 'Context2d') {\n        properties[p] = context[p];\n      }\n      else { // a renderer.states property\n        if (p === 'textFont') {\n          // avoid circular ref. inside textFont\n          let current = this._currentTextFont();\n          if (typeof current === 'object' && '_pInst' in current) {\n            current = Object.assign({}, current);\n            delete current._pInst;\n          }\n          properties[p] = current;\n        }\n        else {\n          properties[p] = this.states[p];\n        }\n      }\n    });\n\n    return properties;\n  };\n\n  Renderer.prototype.textMode = function () { /* no-op for processing api */ };\n\n  /////////////////////////////// end API ////////////////////////////////\n\n  Renderer.prototype._currentTextFont = function () {\n    return this.states.textFont.font || this.states.textFont.family;\n  };\n\n  /*\n    Compute the bounds for a block of text based on the specified\n    measure function, either _textBoundsSingle or _fontBoundsSingle\n   * @private\n  */\n  Renderer.prototype._computeBounds = function (type, str, x, y, width, height, opts) {\n\n    let context = this.textDrawingContext();\n    let setBaseline = context.textBaseline;\n    let { textLeading, textAlign } = this.states;\n\n    // adjust width, height based on current rectMode\n    ({ width, height } = this._rectModeAdjust(x, y, width, height));\n\n    // parse the lines according to the width & linebreaks\n    let lines = this._processLines(str, width, height);\n\n    // get the adjusted positions [x,y] for each line\n    let boxes = lines.map((line, i) => this[type].bind(this)\n      (line, x, y + i * textLeading));\n\n    // adjust the bounding boxes based on horiz. text alignment\n    if (lines.length > 1) {\n      // Call the 2D mode version: the WebGL mode version does additional\n      // alignment adjustments to account for how WebGL renders text.\n      boxes.forEach(bb => bb.x += p5.Renderer2D.prototype._xAlignOffset.call(this, textAlign, width));\n    }\n\n    // adjust the bounding boxes based on vert. text alignment\n    if (typeof height !== 'undefined') {\n      // Call the 2D mode version: the WebGL mode version does additional\n      // alignment adjustments to account for how WebGL renders text.\n      p5.Renderer2D.prototype._yAlignOffset.call(this, boxes, height);\n    }\n\n    // get the bounds for the text block\n    let bounds = boxes[0];\n    if (lines.length > 1) {\n\n      // get the bounds for the multi-line text block\n      bounds = this._aggregateBounds(boxes);\n\n      // align the multi-line bounds\n      if (!opts?.ignoreRectMode) {\n        this._rectModeAlign(bounds, width || 0, height || 0);\n      }\n    }\n\n    context.textBaseline = setBaseline; // restore baseline\n\n    return { bounds, lines };\n  };\n\n  /*\n    Adjust width, height of bounds based on current rectMode\n   * @private\n  */\n  Renderer.prototype._rectModeAdjust = function (x, y, width, height) {\n\n    if (typeof width !== 'undefined') {\n      switch (this.states.rectMode) {\n        case fn.CENTER:\n          break;\n        case fn.CORNERS:\n          width -= x;\n          height -= y;\n          break;\n        case fn.RADIUS:\n          width *= 2;\n          height *= 2;\n          break;\n      }\n    }\n    return { x, y, width, height };\n  };\n\n  /*\n    Attempts to set a property directly on the canvas.style object\n   * @private\n  */\n  Renderer.prototype._setCanvasStyleProperty = function (opt, val, debug) {\n\n    let value = val.toString(); // ensure its a string\n\n    if (debug) console.log('canvas.style.' + opt + '=\"' + value + '\"');\n\n    // handle variable fonts options\n    if (opt === FontVariationSettings) {\n      this._handleFontVariationSettings(value);\n    }\n\n    // lets try to set it on the canvas style\n    this.textCanvas().style[opt] = value;\n\n    // check if the value was set successfully\n    if (this.textCanvas().style[opt] !== value) ;\n  };\n\n  /*\n    Parses the fontVariationSettings string and sets the font properties, only font-weight\n    working consistently across browsers at present\n   * @private\n  */\n  Renderer.prototype._handleFontVariationSettings = function (value, debug = false) {\n    // check if the value is a string or an object\n    if (typeof value === 'object') {\n      value = Object.keys(value).map(k => k + ' ' + value[k]).join(', ');\n    }\n    let values = value.split(CommaDelimRe);\n    values.forEach(v => {\n      v = v.replace(/[\"']/g, ''); // remove quotes\n      let matches = VariableAxesRe.exec(v);\n      //console.log('matches: ', matches);\n      if (matches && matches.length) {\n        let axis = matches[0];\n        // get the value to 3 digits of precision with no trailing zeros\n        let val = parseFloat(parseFloat(v.replace(axis, '').trim()).toFixed(3));\n        switch (axis) {\n          case 'wght':\n            if (debug) console.log('setting font-weight=' + val);\n            // manually set the font-weight via the font string\n            if (this.states.fontWeight !== val) this.textWeight(val);\n            return val;\n          case 'wdth':\n            break;\n          case 'ital':\n            if (debug) console.log('setting font-style=' + (val ? 'italic' : 'normal'));\n            break;\n          case 'slnt':\n            if (debug) console.log('setting font-style=' + (val ? 'oblique' : 'normal'));\n            break;\n          case 'opsz':\n            if (debug) console.log('setting font-optical-size=' + val);\n            break;\n        }\n      }\n    });\n  };\n\n\n\n\n  /*\n    For properties not directly managed by the renderer in this.states\n      we check if it has a mapping to a property in this.states\n    Otherwise, add the property to the context-queue for later application\n  */\n  Renderer.prototype._setContextProperty = function (prop, val, debug = false) {\n\n    // check if the value is actually different, else short-circuit\n    if (this.textDrawingContext()[prop] === val) {\n      return this._pInst;\n    }\n\n    // otherwise, we will set the property directly on the `this.textDrawingContext()`\n    // by adding [property, value] to context-queue for later application\n    (contextQueue ??= []).push([prop, val]);\n\n    if (debug) console.log('queued context2d.' + prop + '=\"' + val + '\"');\n  };\n\n  /*\n     Adjust parameters (x,y,w,h) based on current rectMode\n  */\n  Renderer.prototype._handleRectMode = function (x, y, width, height) {\n\n    let rectMode = this.states.rectMode;\n\n    if (typeof width !== 'undefined') {\n      switch (rectMode) {\n        case fn.RADIUS:\n          width *= 2;\n          x -= width / 2;\n          if (typeof height !== 'undefined') {\n            height *= 2;\n            y -= height / 2;\n          }\n          break;\n        case fn.CENTER:\n          x -= width / 2;\n          if (typeof height !== 'undefined') {\n            y -= height / 2;\n          }\n          break;\n        case fn.CORNERS:\n          width -= x;\n          if (typeof height !== 'undefined') {\n            height -= y;\n          }\n          break;\n      }\n    }\n    return { x, y, width, height };\n  };\n\n  /*\n    Get the computed font-size in pixels for a given size string\n    @param {String} size - the font-size string to compute\n    @returns {number} - the computed font-size in pixels\n   * @private\n   */\n  Renderer.prototype._fontSizePx = function (theSize, { family } = this.states.textFont) {\n\n    const isNumString = (num) => !isNaN(num) && num.trim() !== '';\n\n    // check for a number in a string, eg '12'\n    if (isNumString(theSize)) {\n      return parseFloat(theSize);\n    }\n    let ele = this._cachedDiv({ fontSize: theSize });\n    ele.style.fontSize = theSize;\n    ele.style.fontFamily = family;\n    let fontSizeStr = getComputedStyle(ele).fontSize;\n    let fontSize = parseFloat(fontSizeStr);\n    if (typeof fontSize !== 'number') {\n      throw Error('textSize: invalid font-size');\n    }\n    return fontSize;\n  };\n\n  Renderer.prototype._cachedDiv = function (props) {\n    if (typeof cachedDiv === 'undefined') {\n      let ele = document.createElement('div');\n      ele.ariaHidden = 'true';\n      ele.style.display = 'none';\n      Object.entries(props).forEach(([prop, val]) => {\n        ele.style[prop] = val;\n      });\n      this.textCanvas().appendChild(ele);\n      cachedDiv = ele;\n    }\n    return cachedDiv;\n  };\n\n\n  /*\n    Aggregate the bounding boxes of multiple lines of text\n    @param {Array} bboxes - the bounding boxes to aggregate\n    @returns {object} - the aggregated bounding box\n   * @private\n  */\n  Renderer.prototype._aggregateBounds = function (bboxes) {\n    // loop over the bounding boxes to get the min/max x/y values\n    let minX = Math.min(...bboxes.map(b => b.x));\n    let minY = Math.min(...bboxes.map(b => b.y));\n    let maxY = Math.max(...bboxes.map(b => b.y + b.h));\n    let maxX = Math.max(...bboxes.map(b => b.x + b.w));\n    return { x: minX, y: minY, w: maxX - minX, h: maxY - minY };\n  };\n\n  // Renderer.prototype._aggregateBounds = function (tx, ty, bboxes) {\n  //   let x = Math.min(...bboxes.map(b => b.x));\n  //   let y = Math.min(...bboxes.map(b => b.y));\n  //   // the width is the max of the x-offset + the box width\n  //   let w = Math.max(...bboxes.map(b => (b.x - tx) + b.w));\n  //   let h = bboxes[bboxes.length - 1].y - bboxes[0].y + bboxes[bboxes.length - 1].h;\n\n\n  //   return { x, y, w, h };\n  // };\n\n  /*\n    Process the text string to handle line-breaks and text wrapping\n    @param {String} str - the text to process\n    @param {Number} width - the width to wrap the text to\n    @returns {array} - the processed lines of text\n   * @private\n  */\n  Renderer.prototype._processLines = function (str, width, height) {\n\n    if (typeof width !== 'undefined') { // only for text with bounds\n      let drawingContext = this.textDrawingContext();\n      if (drawingContext.textBaseline === fn.BASELINE) {\n        this.drawingContext.textBaseline = fn.TOP;\n      }\n    }\n\n    let lines = this._splitOnBreaks(str.toString());\n    let hasLineBreaks = lines.length > 1;\n    let hasWidth = typeof width !== 'undefined';\n    let exceedsWidth = hasWidth && lines.some(l => this._textWidthSingle(l) > width);\n    let { textLeading: leading, textWrap } = this.states;\n\n    //if (!hasLineBreaks && !exceedsWidth) return lines; // a single-line\n    if (hasLineBreaks || exceedsWidth) {\n      if (hasWidth) lines = this._lineate(textWrap, lines, width);\n    }\n\n    // handle height truncation\n    if (hasWidth && typeof height !== 'undefined') {\n\n      if (typeof leading === 'undefined') {\n        throw Error('leading is required if height is specified');\n      }\n\n      // truncate lines that exceed the height\n      for (let i = 0; i < lines.length; i++) {\n        let lh = leading * (i + 1);\n        if (lh > height) {\n          //console.log('TRUNCATING: ', i, '-', lines.length, '\"' + lines.slice(i) + '\"');\n          lines = lines.slice(0, i);\n          break;\n        }\n      }\n    }\n\n    return lines;\n  };\n\n  /*\n    Get the x-offset for text given the width and textAlign property\n  */\n  Renderer.prototype._xAlignOffset = function (textAlign, width) {\n    switch (textAlign) {\n      case fn.LEFT:\n        return 0;\n      case fn.CENTER:\n        return width / 2;\n      case fn.RIGHT:\n        return width;\n      case textCoreConstants.START:\n        return 0;\n      case textCoreConstants.END:\n        throw new Error('textBounds: END not yet supported for textAlign');\n      default:\n        return 0;\n    }\n  };\n\n  /*\n    Align the bounding box based on the current rectMode setting\n  */\n  Renderer.prototype._rectModeAlign = function (bb, width, height) {\n    if (typeof width !== 'undefined') {\n\n      switch (this.states.rectMode) {\n        case fn.CENTER:\n          bb.x -= (width - bb.w) / 2;\n          bb.y -= (height - bb.h) / 2;\n          break;\n        case fn.CORNERS:\n          bb.w += bb.x;\n          bb.h += bb.y;\n          break;\n        case fn.RADIUS:\n          bb.x -= (width - bb.w) / 2;\n          bb.y -= (height - bb.h) / 2;\n          bb.w /= 2;\n          bb.h /= 2;\n          break;\n      }\n      return bb;\n    }\n  };\n\n  Renderer.prototype._rectModeAlignRevert = function (bb, width, height) {\n    if (typeof width !== 'undefined') {\n\n      switch (this.states.rectMode) {\n        case fn.CENTER:\n          bb.x += (width - bb.w) / 2;\n          bb.y += (height - bb.h) / 2;\n          break;\n        case fn.CORNERS:\n          bb.w -= bb.x;\n          bb.h -= bb.y;\n          break;\n        case fn.RADIUS:\n          bb.x += (width - bb.w) / 2;\n          bb.y += (height - bb.h) / 2;\n          bb.w *= 2;\n          bb.h *= 2;\n          break;\n      }\n      return bb;\n    }\n  };\n\n  /*\n    Get the (tight) width of a single line of text\n  */\n  Renderer.prototype._textWidthSingle = function (s) {\n    let metrics = this.textDrawingContext().measureText(s);\n    let abl = metrics.actualBoundingBoxLeft;\n    let abr = metrics.actualBoundingBoxRight;\n    return abr + abl;\n  };\n\n  /*\n    Get the (loose) width of a single line of text as specified by the font\n  */\n  Renderer.prototype._fontWidthSingle = function (s) {\n    return this.textDrawingContext().measureText(s).width;\n  };\n\n  /*\n    Get the (tight) bounds of a single line of text based on its actual bounding box\n  */\n  Renderer.prototype._textBoundsSingle = function (s, x = 0, y = 0) {\n\n    let metrics = this.textDrawingContext().measureText(s);\n    let asc = metrics.actualBoundingBoxAscent;\n    let desc = metrics.actualBoundingBoxDescent;\n    let abl = metrics.actualBoundingBoxLeft;\n    let abr = metrics.actualBoundingBoxRight;\n    return { x: x - abl, y: y - asc, w: abr + abl, h: asc + desc };\n  };\n\n  /*\n    Get the (loose) bounds of a single line of text based on its font's bounding box\n  */\n  Renderer.prototype._fontBoundsSingle = function (s, x = 0, y = 0) {\n\n    let metrics = this.textDrawingContext().measureText(s);\n    let asc = metrics.fontBoundingBoxAscent;\n    let desc = metrics.fontBoundingBoxDescent;\n    x -= this._xAlignOffset(this.states.textAlign, metrics.width);\n    return { x, y: y - asc, w: metrics.width, h: asc + desc };  };\n\n  /*\n    Set the textSize property in `this.states` if it has changed\n    @param {number | string} theSize - the font-size to set\n    @returns {boolean} - true if the size was changed, false otherwise\n   */\n  Renderer.prototype._setTextSize = function (theSize) {\n\n    if (typeof theSize === 'string') {\n      // parse the size string via computed style, eg '2em'\n      theSize = this._fontSizePx(theSize);\n    }\n\n    // should be a number now\n    if (typeof theSize === 'number') {\n\n      // set it in `this.states` if its been changed\n      if (this.states.textSize !== theSize) {\n        this.states.setValue('textSize', theSize);\n\n        // handle leading here, if not set otherwise\n        if (!this.states.leadingSet) {\n          this.states.setValue('textLeading', this.states.textSize * LeadingScale);\n        }\n        return true; // size was changed\n      }\n    }\n    else {\n      console.warn('textSize: invalid size: ' + theSize);\n    }\n\n    return false;\n  };\n\n  /*\n    Split the lines of text based on the width and the textWrap property\n    @param {Array} lines - the lines of text to split\n    @param {Number} maxWidth - the maximum width of the lines\n    @param {Object} opts - additional options for splitting the lines\n    @returns {array} - the split lines of text\n   * @private\n  */\n  Renderer.prototype._lineate = function (textWrap, lines, maxWidth = Infinity, opts = {}) {\n\n    let splitter = opts.splitChar ?? (textWrap === fn.WORD ? ' ' : '');\n    let line, testLine, testWidth, words, newLines = [];\n\n    for (let lidx = 0; lidx < lines.length; lidx++) {\n      line = '';\n      words = lines[lidx].split(splitter);\n      for (let widx = 0; widx < words.length; widx++) {\n        testLine = `${line + words[widx]}` + splitter;\n        testWidth = this._textWidthSingle(testLine);\n        if (line.length > 0 && testWidth > maxWidth) {\n          newLines.push(line.trim());\n          line = `${words[widx]}` + splitter;\n        } else {\n          line = testLine;\n        }\n      }\n      newLines.push(line.trim());\n    }\n    return newLines;\n  };\n\n  /*\n    Split the text into lines based on line-breaks and tabs\n  */\n  Renderer.prototype._splitOnBreaks = function (s) {\n    if (!s || s.length === 0) return [''];\n    return s.replace(TabsRe, '  ').split(LinebreakRe);\n  };\n\n  /*\n    Parse the font-family string to handle complex names, fallbacks, etc.\n  */\n  Renderer.prototype._parseFontFamily = function (familyStr) {\n\n    let parts = familyStr.split(CommaDelimRe);\n    let family = parts.map(part => {\n      part = part.trim();\n      if (part.indexOf(' ') > -1 && !QuotedRe.test(part)) {\n        part = `\"${part}\"`; // quote font names with spaces\n      }\n      return part;\n    }).join(', ');\n\n    return family;\n  };\n\n  Renderer.prototype._applyFontString = function () {\n    /*\n      Create the font-string according to the CSS font-string specification:\n      If font is specified as a shorthand for several font-related properties, then:\n      - it must include values for: <font-size> and <font-family>\n      - it may optionally include values for:\n          [<font-style>, <font-variant>, <font-weight>, <font-stretch>, <line-height>]\n      Format:\n      - font-style, font-variant and font-weight must precede font-size\n      - font-variant may only specify the values defined in CSS 2.1, that is 'normal' and 'small-caps'.\n      - font-stretch may only be a single keyword value.\n      - line-height must immediately follow font-size, preceded by \"/\", eg 16px/3.\n      - font-family must be the last value specified.\n    */\n    let { textFont, textSize, lineHeight, fontStyle, fontWeight, fontVariant } = this.states;\n    let drawingContext = this.textDrawingContext();\n\n    let family = this._parseFontFamily(textFont.family);\n    let style = fontStyle !== fn.NORMAL ? `${fontStyle} ` : '';\n    let weight = fontWeight !== fn.NORMAL ? `${fontWeight} ` : '';\n    let variant = fontVariant !== fn.NORMAL ? `${fontVariant} ` : '';\n    let fsize = `${textSize}px` + (lineHeight !== fn.NORMAL ? `/${lineHeight} ` : ' ');\n    let fontString = `${style}${variant}${weight}${fsize}${family}`.trim();\n    //console.log('fontString=\"' + fontString + '\"');\n\n    // set the font string on the context\n    drawingContext.font = fontString;\n\n    // verify that it was set successfully\n    if (drawingContext.font !== fontString) {\n      let expected = fontString;\n      let actual = drawingContext.font;\n      if (expected !== actual) {\n        //console.warn(`Unable to set font property on context2d. It may not be supported.`);\n        //console.log('Expected \"' + expected + '\" but got: \"' + actual + '\"'); // TMP\n        return false;\n      }\n    }\n    return true;\n  };\n\n  /*\n    Apply the text properties in `this.states` to the `this.textDrawingContext()`\n    Then apply any properties in the context-queue\n   */\n  Renderer.prototype._applyTextProperties = function (debug = false) {\n\n    this._applyFontString();\n\n    // set these after the font so they're not overridden\n    let context = this.textDrawingContext();\n    context.direction = this.states.direction;\n    context.textAlign = this.states.textAlign;\n    context.textBaseline = this.states.textBaseline;\n\n    // set manually as (still) not fully supported as part of font-string\n    let stretch = this.states.fontStretch;\n    if (FontStretchKeys.includes(stretch) && context.fontStretch !== stretch) {\n      context.fontStretch = stretch;\n    }\n\n    // apply each property in queue after the font so they're not overridden\n    while (contextQueue?.length) {\n\n      let [prop, val] = contextQueue.shift();\n      if (debug) console.log('apply context property \"' + prop + '\" = \"' + val + '\"');\n      context[prop] = val;\n\n      // check if the value was set successfully\n      if (context[prop] !== val) {\n        console.warn(`Unable to set '${prop}' property on context2d. It may not be supported.`); // FES?\n        console.log('Expected \"' + val + '\" but got: \"' + context[prop] + '\"');\n      }\n    }\n\n    return this._pInst;\n  };\n\n  if (p5.Renderer2D) {\n    p5.Renderer2D.prototype.textCanvas = function () {\n      return this.canvas;\n    };\n    p5.Renderer2D.prototype.textDrawingContext = function () {\n      return this.drawingContext;\n    };\n\n    p5.Renderer2D.prototype._renderText = function (text, x, y, maxY, minY) {\n      let states = this.states;\n      let context = this.textDrawingContext();\n\n      if (y < minY || y >= maxY) {\n        return; // don't render lines beyond minY/maxY\n      }\n\n      this.push();\n\n      // no stroke unless specified by user\n      if (states.strokeColor && states.strokeSet) {\n        context.strokeText(text, x, y);\n      }\n\n      if (!this._clipping && states.fillColor) {\n\n        // if fill hasn't been set by user, use default text fill\n        if (!states.fillSet) {\n          this._setFill(DefaultFill);\n        }\n        context.fillText(text, x, y);\n      }\n\n      this.pop();\n    };\n\n    /*\n      Position the lines of text based on their textAlign/textBaseline properties\n    */\n    p5.Renderer2D.prototype._positionLines = function (x, y, width, height, lines) {\n\n      let { textLeading, textAlign } = this.states;\n      let adjustedX, lineData = new Array(lines.length);\n      let adjustedW = typeof width === 'undefined' ? 0 : width;\n      let adjustedH = typeof height === 'undefined' ? 0 : height;\n\n      for (let i = 0; i < lines.length; i++) {\n        switch (textAlign) {\n          case textCoreConstants.START:\n            throw new Error('textBounds: START not yet supported for textAlign'); // default to LEFT\n          case fn.LEFT:\n            adjustedX = x;\n            break;\n          case fn.CENTER:\n            adjustedX = x + adjustedW / 2;\n            break;\n          case fn.RIGHT:\n            adjustedX = x + adjustedW;\n            break;\n          case textCoreConstants.END:\n            throw new Error('textBounds: END not yet supported for textAlign');\n        }\n        lineData[i] = { text: lines[i], x: adjustedX, y: y + i * textLeading };\n      }\n\n      return this._yAlignOffset(lineData, adjustedH);\n    };\n\n    /*\n      Get the y-offset for text given the height, leading, line-count and textBaseline property\n    */\n    p5.Renderer2D.prototype._yAlignOffset = function (dataArr, height) {\n\n      if (typeof height === 'undefined') {\n        throw Error('_yAlignOffset: height is required');\n      }\n\n      let { textLeading, textBaseline } = this.states;\n      let yOff = 0, numLines = dataArr.length;\n      let ydiff = height - (textLeading * (numLines - 1));\n      switch (textBaseline) { // drawingContext ?\n        case fn.TOP:\n          break; // ??\n        case fn.BASELINE:\n          break;\n        case textCoreConstants._CTX_MIDDLE:\n          yOff = ydiff / 2;\n          break;\n        case fn.BOTTOM:\n          yOff = ydiff;\n          break;\n        case textCoreConstants.IDEOGRAPHIC:\n          console.warn('textBounds: IDEOGRAPHIC not yet supported for textBaseline'); // FES?\n          break;\n        case textCoreConstants.HANGING:\n          console.warn('textBounds: HANGING not yet supported for textBaseline'); // FES?\n          break;\n      }\n      dataArr.forEach(ele => ele.y += yOff);\n      return dataArr;\n    };\n  }\n\n  if (p5.RendererGL) {\n    p5.RendererGL.prototype.textCanvas = function() {\n      if (!this._textCanvas) {\n        this._textCanvas = document.createElement('canvas');\n        this._textCanvas.width = 1;\n        this._textCanvas.height = 1;\n        this._textCanvas.style.display = 'none';\n        // Has to be added to the DOM for measureText to work properly!\n        this.canvas.parentElement.insertBefore(this._textCanvas, this.canvas);\n      }\n      return this._textCanvas;\n    };\n    p5.RendererGL.prototype.textDrawingContext = function() {\n      if (!this._textDrawingContext) {\n        const textCanvas = this.textCanvas();\n        this._textDrawingContext = textCanvas.getContext('2d');\n      }\n      return this._textDrawingContext;\n    };\n    const oldRemove = p5.RendererGL.prototype.remove;\n    p5.RendererGL.prototype.remove = function() {\n      if (this._textCanvas) {\n        this._textCanvas.parentElement.removeChild(this._textCanvas);\n      }\n      oldRemove.call(this);\n    };\n\n    p5.RendererGL.prototype._positionLines = function (x, y, width, height, lines) {\n\n      let { textLeading, textAlign } = this.states;\n      const widths = lines.map((line) => this._fontWidthSingle(line));\n      let adjustedX, lineData = new Array(lines.length);\n      let adjustedW = typeof width === 'undefined' ? Math.max(0, ...widths) : width;\n      let adjustedH = typeof height === 'undefined' ? 0 : height;\n\n      for (let i = 0; i < lines.length; i++) {\n        switch (textAlign) {\n          case textCoreConstants.START:\n            throw new Error('textBounds: START not yet supported for textAlign'); // default to LEFT\n          case fn.LEFT:\n            adjustedX = x;\n            break;\n          case fn.CENTER:\n            adjustedX = x + (adjustedW - widths[i]) / 2 - adjustedW / 2 + (width || 0) / 2;\n            break;\n          case fn.RIGHT:\n            adjustedX = x + adjustedW - widths[i] - adjustedW + (width || 0);\n            break;\n          case textCoreConstants.END:\n            throw new Error('textBounds: END not yet supported for textAlign');\n        }\n        lineData[i] = { text: lines[i], x: adjustedX, y: y + i * textLeading };\n      }\n\n      return this._yAlignOffset(lineData, adjustedH);\n    };\n\n    p5.RendererGL.prototype._yAlignOffset = function (dataArr, height) {\n\n      if (typeof height === 'undefined') {\n        throw Error('_yAlignOffset: height is required');\n      }\n\n      let { textLeading, textBaseline, textSize, textFont } = this.states;\n      let yOff = 0, numLines = dataArr.length;\n      let totalHeight = textSize * numLines + ((textLeading - textSize) * (numLines - 1));\n      switch (textBaseline) { // drawingContext ?\n        case fn.TOP:\n          yOff = textSize;\n          break;\n        case fn.BASELINE:\n          break;\n        case textCoreConstants._CTX_MIDDLE:\n          yOff = -totalHeight / 2 + textSize + (height || 0) / 2;\n          break;\n        case fn.BOTTOM:\n          yOff = -(totalHeight - textSize) + (height || 0);\n          break;\n        default:\n          console.warn(`${textBaseline} is not supported in WebGL mode.`); // FES?\n          break;\n      }\n      yOff += this.states.textFont.font?._verticalAlign(textSize) || 0; // Does this function exist?\n      dataArr.forEach(ele => ele.y += yOff);\n      return dataArr;\n    };\n  }\n}\n\nif (typeof p5 !== 'undefined') {\n  textCore(p5, p5.prototype);\n}\n\nexport { textCore as default, textCoreConstants };\n","// From https://github.com/radiovisual/unicode-range-json,\n// with decimal ranges removed to save space, and with category\n// names converted to lowercase ahead of time\nconst unicodeRanges = [\n  {\n    category: \"control character\",\n    hexrange: [\"0000\", \"001f\"],\n  },\n  {\n    category: \"basic latin\",\n    hexrange: [\"0000\", \"007f\"],\n  },\n  {\n    category: \"latin-1 supplement\",\n    hexrange: [\"0080\", \"00ff\"],\n  },\n  {\n    category: \"latin extended-a\",\n    hexrange: [\"0100\", \"017f\"],\n  },\n  {\n    category: \"latin extended-b\",\n    hexrange: [\"0180\", \"024f\"],\n  },\n  {\n    category: \"ipa extensions\",\n    hexrange: [\"0250\", \"02af\"],\n  },\n  {\n    category: \"spacing modifier letters\",\n    hexrange: [\"02b0\", \"02ff\"],\n  },\n  {\n    category: \"combining diacritical marks\",\n    hexrange: [\"0300\", \"036f\"],\n  },\n  {\n    category: \"greek and coptic\",\n    hexrange: [\"0370\", \"03ff\"],\n  },\n  {\n    category: \"cyrillic\",\n    hexrange: [\"0400\", \"04ff\"],\n  },\n  {\n    category: \"cyrillic supplement\",\n    hexrange: [\"0500\", \"052f\"],\n  },\n  {\n    category: \"armenian\",\n    hexrange: [\"0530\", \"058f\"],\n  },\n  {\n    category: \"hebrew\",\n    hexrange: [\"0590\", \"05ff\"],\n  },\n  {\n    category: \"arabic\",\n    hexrange: [\"0600\", \"06ff\"],\n  },\n  {\n    category: \"syriac\",\n    hexrange: [\"0700\", \"074f\"],\n  },\n  {\n    category: \"arabic supplement\",\n    hexrange: [\"0750\", \"077f\"],\n  },\n  {\n    category: \"thaana\",\n    hexrange: [\"0780\", \"07bf\"],\n  },\n  {\n    category: \"nko\",\n    hexrange: [\"07c0\", \"07ff\"],\n  },\n  {\n    category: \"samaritan\",\n    hexrange: [\"0800\", \"083f\"],\n  },\n  {\n    category: \"mandaic\",\n    hexrange: [\"0840\", \"085f\"],\n  },\n  {\n    category: \"syriac supplement\",\n    hexrange: [\"0860\", \"086f\"],\n  },\n  {\n    category: \"arabic extended-b\",\n    hexrange: [\"0870\", \"089f\"],\n  },\n  {\n    category: \"arabic extended-a\",\n    hexrange: [\"08a0\", \"08ff\"],\n  },\n  {\n    category: \"devanagari\",\n    hexrange: [\"0900\", \"097f\"],\n  },\n  {\n    category: \"bengali\",\n    hexrange: [\"0980\", \"09ff\"],\n  },\n  {\n    category: \"gurmukhi\",\n    hexrange: [\"0a00\", \"0a7f\"],\n  },\n  {\n    category: \"gujarati\",\n    hexrange: [\"0a80\", \"0aff\"],\n  },\n  {\n    category: \"oriya\",\n    hexrange: [\"0b00\", \"0b7f\"],\n  },\n  {\n    category: \"tamil\",\n    hexrange: [\"0b80\", \"0bff\"],\n  },\n  {\n    category: \"telugu\",\n    hexrange: [\"0c00\", \"0c7f\"],\n  },\n  {\n    category: \"kannada\",\n    hexrange: [\"0c80\", \"0cff\"],\n  },\n  {\n    category: \"malayalam\",\n    hexrange: [\"0d00\", \"0d7f\"],\n  },\n  {\n    category: \"sinhala\",\n    hexrange: [\"0d80\", \"0dff\"],\n  },\n  {\n    category: \"thai\",\n    hexrange: [\"0e00\", \"0e7f\"],\n  },\n  {\n    category: \"lao\",\n    hexrange: [\"0e80\", \"0eff\"],\n  },\n  {\n    category: \"tibetan\",\n    hexrange: [\"0f00\", \"0fff\"],\n  },\n  {\n    category: \"myanmar\",\n    hexrange: [\"1000\", \"109f\"],\n  },\n  {\n    category: \"georgian\",\n    hexrange: [\"10a0\", \"10ff\"],\n  },\n  {\n    category: \"hangul jamo\",\n    hexrange: [\"1100\", \"11ff\"],\n  },\n  {\n    category: \"ethiopic\",\n    hexrange: [\"1200\", \"137f\"],\n  },\n  {\n    category: \"ethiopic supplement\",\n    hexrange: [\"1380\", \"139f\"],\n  },\n  {\n    category: \"cherokee\",\n    hexrange: [\"13a0\", \"13ff\"],\n  },\n  {\n    category: \"unified canadian aboriginal syllabics\",\n    hexrange: [\"1400\", \"167f\"],\n  },\n  {\n    category: \"ogham\",\n    hexrange: [\"1680\", \"169f\"],\n  },\n  {\n    category: \"runic\",\n    hexrange: [\"16a0\", \"16ff\"],\n  },\n  {\n    category: \"tagalog\",\n    hexrange: [\"1700\", \"171f\"],\n  },\n  {\n    category: \"hanunoo\",\n    hexrange: [\"1720\", \"173f\"],\n  },\n  {\n    category: \"buhid\",\n    hexrange: [\"1740\", \"175f\"],\n  },\n  {\n    category: \"tagbanwa\",\n    hexrange: [\"1760\", \"177f\"],\n  },\n  {\n    category: \"khmer\",\n    hexrange: [\"1780\", \"17ff\"],\n  },\n  {\n    category: \"mongolian\",\n    hexrange: [\"1800\", \"18af\"],\n  },\n  {\n    category: \"unified canadian aboriginal syllabics extended\",\n    hexrange: [\"18b0\", \"18ff\"],\n  },\n  {\n    category: \"limbu\",\n    hexrange: [\"1900\", \"194f\"],\n  },\n  {\n    category: \"tai le\",\n    hexrange: [\"1950\", \"197f\"],\n  },\n  {\n    category: \"new tai lue\",\n    hexrange: [\"1980\", \"19df\"],\n  },\n  {\n    category: \"khmer symbols\",\n    hexrange: [\"19e0\", \"19ff\"],\n  },\n  {\n    category: \"buginese\",\n    hexrange: [\"1a00\", \"1a1f\"],\n  },\n  {\n    category: \"tai tham\",\n    hexrange: [\"1a20\", \"1aaf\"],\n  },\n  {\n    category: \"combining diacritical marks extended\",\n    hexrange: [\"1ab0\", \"1aff\"],\n  },\n  {\n    category: \"balinese\",\n    hexrange: [\"1b00\", \"1b7f\"],\n  },\n  {\n    category: \"sundanese\",\n    hexrange: [\"1b80\", \"1bbf\"],\n  },\n  {\n    category: \"batak\",\n    hexrange: [\"1bc0\", \"1bff\"],\n  },\n  {\n    category: \"lepcha\",\n    hexrange: [\"1c00\", \"1c4f\"],\n  },\n  {\n    category: \"ol chiki\",\n    hexrange: [\"1c50\", \"1c7f\"],\n  },\n  {\n    category: \"cyrillic extended-c\",\n    hexrange: [\"1c80\", \"1c8f\"],\n  },\n  {\n    category: \"georgian extended\",\n    hexrange: [\"1c90\", \"1cbf\"],\n  },\n  {\n    category: \"sundanese supplement\",\n    hexrange: [\"1cc0\", \"1ccf\"],\n  },\n  {\n    category: \"vedic extensions\",\n    hexrange: [\"1cd0\", \"1cff\"],\n  },\n  {\n    category: \"phonetic extensions\",\n    hexrange: [\"1d00\", \"1d7f\"],\n  },\n  {\n    category: \"phonetic extensions supplement\",\n    hexrange: [\"1d80\", \"1dbf\"],\n  },\n  {\n    category: \"combining diacritical marks supplement\",\n    hexrange: [\"1dc0\", \"1dff\"],\n  },\n  {\n    category: \"latin extended additional\",\n    hexrange: [\"1e00\", \"1eff\"],\n  },\n  {\n    category: \"greek extended\",\n    hexrange: [\"1f00\", \"1fff\"],\n  },\n  {\n    category: \"general punctuation\",\n    hexrange: [\"2000\", \"206f\"],\n  },\n  {\n    category: \"superscripts and subscripts\",\n    hexrange: [\"2070\", \"209f\"],\n  },\n  {\n    category: \"currency symbols\",\n    hexrange: [\"20a0\", \"20cf\"],\n  },\n  {\n    category: \"combining diacritical marks for symbols\",\n    hexrange: [\"20d0\", \"20ff\"],\n  },\n  {\n    category: \"letterlike symbols\",\n    hexrange: [\"2100\", \"214f\"],\n  },\n  {\n    category: \"number forms\",\n    hexrange: [\"2150\", \"218f\"],\n  },\n  {\n    category: \"arrows\",\n    hexrange: [\"2190\", \"21ff\"],\n  },\n  {\n    category: \"mathematical operators\",\n    hexrange: [\"2200\", \"22ff\"],\n  },\n  {\n    category: \"miscellaneous technical\",\n    hexrange: [\"2300\", \"23ff\"],\n  },\n  {\n    category: \"control pictures\",\n    hexrange: [\"2400\", \"243f\"],\n  },\n  {\n    category: \"optical character recognition\",\n    hexrange: [\"2440\", \"245f\"],\n  },\n  {\n    category: \"enclosed alphanumerics\",\n    hexrange: [\"2460\", \"24ff\"],\n  },\n  {\n    category: \"box drawing\",\n    hexrange: [\"2500\", \"257f\"],\n  },\n  {\n    category: \"block elements\",\n    hexrange: [\"2580\", \"259f\"],\n  },\n  {\n    category: \"geometric shapes\",\n    hexrange: [\"25a0\", \"25ff\"],\n  },\n  {\n    category: \"miscellaneous symbols\",\n    hexrange: [\"2600\", \"26ff\"],\n  },\n  {\n    category: \"dingbats\",\n    hexrange: [\"2700\", \"27bf\"],\n  },\n  {\n    category: \"miscellaneous mathematical symbols-a\",\n    hexrange: [\"27c0\", \"27ef\"],\n  },\n  {\n    category: \"supplemental arrows-a\",\n    hexrange: [\"27f0\", \"27ff\"],\n  },\n  {\n    category: \"braille patterns\",\n    hexrange: [\"2800\", \"28ff\"],\n  },\n  {\n    category: \"supplemental arrows-b\",\n    hexrange: [\"2900\", \"297f\"],\n  },\n  {\n    category: \"miscellaneous mathematical symbols-b\",\n    hexrange: [\"2980\", \"29ff\"],\n  },\n  {\n    category: \"supplemental mathematical operators\",\n    hexrange: [\"2a00\", \"2aff\"],\n  },\n  {\n    category: \"miscellaneous symbols and arrows\",\n    hexrange: [\"2b00\", \"2bff\"],\n  },\n  {\n    category: \"glagolitic\",\n    hexrange: [\"2c00\", \"2c5f\"],\n  },\n  {\n    category: \"latin extended-c\",\n    hexrange: [\"2c60\", \"2c7f\"],\n  },\n  {\n    category: \"coptic\",\n    hexrange: [\"2c80\", \"2cff\"],\n  },\n  {\n    category: \"georgian supplement\",\n    hexrange: [\"2d00\", \"2d2f\"],\n  },\n  {\n    category: \"tifinagh\",\n    hexrange: [\"2d30\", \"2d7f\"],\n  },\n  {\n    category: \"ethiopic extended\",\n    hexrange: [\"2d80\", \"2ddf\"],\n  },\n  {\n    category: \"cyrillic extended-a\",\n    hexrange: [\"2de0\", \"2dff\"],\n  },\n  {\n    category: \"supplemental punctuation\",\n    hexrange: [\"2e00\", \"2e7f\"],\n  },\n  {\n    category: \"cjk radicals supplement\",\n    hexrange: [\"2e80\", \"2eff\"],\n  },\n  {\n    category: \"kangxi radicals\",\n    hexrange: [\"2f00\", \"2fdf\"],\n  },\n  {\n    category: \"ideographic description characters\",\n    hexrange: [\"2ff0\", \"2fff\"],\n  },\n  {\n    category: \"cjk symbols and punctuation\",\n    hexrange: [\"3000\", \"303f\"],\n  },\n  {\n    category: \"hiragana\",\n    hexrange: [\"3040\", \"309f\"],\n  },\n  {\n    category: \"katakana\",\n    hexrange: [\"30a0\", \"30ff\"],\n  },\n  {\n    category: \"bopomofo\",\n    hexrange: [\"3100\", \"312f\"],\n  },\n  {\n    category: \"hangul compatibility jamo\",\n    hexrange: [\"3130\", \"318f\"],\n  },\n  {\n    category: \"kanbun\",\n    hexrange: [\"3190\", \"319f\"],\n  },\n  {\n    category: \"bopomofo extended\",\n    hexrange: [\"31a0\", \"31bf\"],\n  },\n  {\n    category: \"cjk strokes\",\n    hexrange: [\"31c0\", \"31ef\"],\n  },\n  {\n    category: \"katakana phonetic extensions\",\n    hexrange: [\"31f0\", \"31ff\"],\n  },\n  {\n    category: \"enclosed cjk letters and months\",\n    hexrange: [\"3200\", \"32ff\"],\n  },\n  {\n    category: \"cjk compatibility\",\n    hexrange: [\"3300\", \"33ff\"],\n  },\n  {\n    category: \"cjk unified ideographs extension a\",\n    hexrange: [\"3400\", \"4dbf\"],\n  },\n  {\n    category: \"yijing hexagram symbols\",\n    hexrange: [\"4dc0\", \"4dff\"],\n  },\n  {\n    category: \"cjk unified ideographs\",\n    hexrange: [\"4e00\", \"9fff\"],\n  },\n  {\n    category: \"yi syllables\",\n    hexrange: [\"a000\", \"a48f\"],\n  },\n  {\n    category: \"yi radicals\",\n    hexrange: [\"a490\", \"a4cf\"],\n  },\n  {\n    category: \"lisu\",\n    hexrange: [\"a4d0\", \"a4ff\"],\n  },\n  {\n    category: \"vai\",\n    hexrange: [\"a500\", \"a63f\"],\n  },\n  {\n    category: \"cyrillic extended-b\",\n    hexrange: [\"a640\", \"a69f\"],\n  },\n  {\n    category: \"bamum\",\n    hexrange: [\"a6a0\", \"a6ff\"],\n  },\n  {\n    category: \"modifier tone letters\",\n    hexrange: [\"a700\", \"a71f\"],\n  },\n  {\n    category: \"latin extended-d\",\n    hexrange: [\"a720\", \"a7ff\"],\n  },\n  {\n    category: \"syloti nagri\",\n    hexrange: [\"a800\", \"a82f\"],\n  },\n  {\n    category: \"common indic number forms\",\n    hexrange: [\"a830\", \"a83f\"],\n  },\n  {\n    category: \"phags-pa\",\n    hexrange: [\"a840\", \"a87f\"],\n  },\n  {\n    category: \"saurashtra\",\n    hexrange: [\"a880\", \"a8df\"],\n  },\n  {\n    category: \"devanagari extended\",\n    hexrange: [\"a8e0\", \"a8ff\"],\n  },\n  {\n    category: \"kayah li\",\n    hexrange: [\"a900\", \"a92f\"],\n  },\n  {\n    category: \"rejang\",\n    hexrange: [\"a930\", \"a95f\"],\n  },\n  {\n    category: \"hangul jamo extended-a\",\n    hexrange: [\"a960\", \"a97f\"],\n  },\n  {\n    category: \"javanese\",\n    hexrange: [\"a980\", \"a9df\"],\n  },\n  {\n    category: \"myanmar extended-b\",\n    hexrange: [\"a9e0\", \"a9ff\"],\n  },\n  {\n    category: \"cham\",\n    hexrange: [\"aa00\", \"aa5f\"],\n  },\n  {\n    category: \"myanmar extended-a\",\n    hexrange: [\"aa60\", \"aa7f\"],\n  },\n  {\n    category: \"tai viet\",\n    hexrange: [\"aa80\", \"aadf\"],\n  },\n  {\n    category: \"meetei mayek extensions\",\n    hexrange: [\"aae0\", \"aaff\"],\n  },\n  {\n    category: \"ethiopic extended-a\",\n    hexrange: [\"ab00\", \"ab2f\"],\n  },\n  {\n    category: \"latin extended-e\",\n    hexrange: [\"ab30\", \"ab6f\"],\n  },\n  {\n    category: \"cherokee supplement\",\n    hexrange: [\"ab70\", \"abbf\"],\n  },\n  {\n    category: \"meetei mayek\",\n    hexrange: [\"abc0\", \"abff\"],\n  },\n  {\n    category: \"hangul syllables\",\n    hexrange: [\"ac00\", \"d7af\"],\n  },\n  {\n    category: \"hangul jamo extended-b\",\n    hexrange: [\"d7b0\", \"d7ff\"],\n  },\n  {\n    category: \"high surrogates\",\n    hexrange: [\"d800\", \"db7f\"],\n  },\n  {\n    category: \"high private use surrogates\",\n    hexrange: [\"db80\", \"dbff\"],\n  },\n  {\n    category: \"low surrogates\",\n    hexrange: [\"dc00\", \"dfff\"],\n  },\n  {\n    category: \"private use area\",\n    hexrange: [\"e000\", \"f8ff\"],\n  },\n  {\n    category: \"cjk compatibility ideographs\",\n    hexrange: [\"f900\", \"faff\"],\n  },\n  {\n    category: \"alphabetic presentation forms\",\n    hexrange: [\"fb00\", \"fb4f\"],\n  },\n  {\n    category: \"arabic presentation forms-a\",\n    hexrange: [\"fb50\", \"fdff\"],\n  },\n  {\n    category: \"variation selectors\",\n    hexrange: [\"fe00\", \"fe0f\"],\n  },\n  {\n    category: \"vertical forms\",\n    hexrange: [\"fe10\", \"fe1f\"],\n  },\n  {\n    category: \"combining half marks\",\n    hexrange: [\"fe20\", \"fe2f\"],\n  },\n  {\n    category: \"cjk compatibility forms\",\n    hexrange: [\"fe30\", \"fe4f\"],\n  },\n  {\n    category: \"small form variants\",\n    hexrange: [\"fe50\", \"fe6f\"],\n  },\n  {\n    category: \"arabic presentation forms-b\",\n    hexrange: [\"fe70\", \"feff\"],\n  },\n  {\n    category: \"halfwidth and fullwidth forms\",\n    hexrange: [\"ff00\", \"ffef\"],\n  },\n  {\n    category: \"specials\",\n    hexrange: [\"fff0\", \"ffff\"],\n  },\n  {\n    category: \"linear b syllabary\",\n    hexrange: [\"10000\", \"1007f\"],\n  },\n  {\n    category: \"linear b ideograms\",\n    hexrange: [\"10080\", \"100ff\"],\n  },\n  {\n    category: \"aegean numbers\",\n    hexrange: [\"10100\", \"1013f\"],\n  },\n  {\n    category: \"ancient greek numbers\",\n    hexrange: [\"10140\", \"1018f\"],\n  },\n  {\n    category: \"ancient symbols\",\n    hexrange: [\"10190\", \"101cf\"],\n  },\n  {\n    category: \"phaistos disc\",\n    hexrange: [\"101d0\", \"101ff\"],\n  },\n  {\n    category: \"lycian\",\n    hexrange: [\"10280\", \"1029f\"],\n  },\n  {\n    category: \"carian\",\n    hexrange: [\"102a0\", \"102df\"],\n  },\n  {\n    category: \"coptic epact numbers\",\n    hexrange: [\"102e0\", \"102ff\"],\n  },\n  {\n    category: \"old italic\",\n    hexrange: [\"10300\", \"1032f\"],\n  },\n  {\n    category: \"gothic\",\n    hexrange: [\"10330\", \"1034f\"],\n  },\n  {\n    category: \"old permic\",\n    hexrange: [\"10350\", \"1037f\"],\n  },\n  {\n    category: \"ugaritic\",\n    hexrange: [\"10380\", \"1039f\"],\n  },\n  {\n    category: \"old persian\",\n    hexrange: [\"103a0\", \"103df\"],\n  },\n  {\n    category: \"deseret\",\n    hexrange: [\"10400\", \"1044f\"],\n  },\n  {\n    category: \"shavian\",\n    hexrange: [\"10450\", \"1047f\"],\n  },\n  {\n    category: \"osmanya\",\n    hexrange: [\"10480\", \"104af\"],\n  },\n  {\n    category: \"osage\",\n    hexrange: [\"104b0\", \"104ff\"],\n  },\n  {\n    category: \"elbasan\",\n    hexrange: [\"10500\", \"1052f\"],\n  },\n  {\n    category: \"caucasian albanian\",\n    hexrange: [\"10530\", \"1056f\"],\n  },\n  {\n    category: \"vithkuqi\",\n    hexrange: [\"10570\", \"105bf\"],\n  },\n  {\n    category: \"linear a\",\n    hexrange: [\"10600\", \"1077f\"],\n  },\n  {\n    category: \"latin extended-f\",\n    hexrange: [\"10780\", \"107bf\"],\n  },\n  {\n    category: \"cypriot syllabary\",\n    hexrange: [\"10800\", \"1083f\"],\n  },\n  {\n    category: \"imperial aramaic\",\n    hexrange: [\"10840\", \"1085f\"],\n  },\n  {\n    category: \"palmyrene\",\n    hexrange: [\"10860\", \"1087f\"],\n  },\n  {\n    category: \"nabataean\",\n    hexrange: [\"10880\", \"108af\"],\n  },\n  {\n    category: \"hatran\",\n    hexrange: [\"108e0\", \"108ff\"],\n  },\n  {\n    category: \"phoenician\",\n    hexrange: [\"10900\", \"1091f\"],\n  },\n  {\n    category: \"lydian\",\n    hexrange: [\"10920\", \"1093f\"],\n  },\n  {\n    category: \"meroitic hieroglyphs\",\n    hexrange: [\"10980\", \"1099f\"],\n  },\n  {\n    category: \"meroitic cursive\",\n    hexrange: [\"109a0\", \"109ff\"],\n  },\n  {\n    category: \"kharoshthi\",\n    hexrange: [\"10a00\", \"10a5f\"],\n  },\n  {\n    category: \"old south arabian\",\n    hexrange: [\"10a60\", \"10a7f\"],\n  },\n  {\n    category: \"old north arabian\",\n    hexrange: [\"10a80\", \"10a9f\"],\n  },\n  {\n    category: \"manichaean\",\n    hexrange: [\"10ac0\", \"10aff\"],\n  },\n  {\n    category: \"avestan\",\n    hexrange: [\"10b00\", \"10b3f\"],\n  },\n  {\n    category: \"inscriptional parthian\",\n    hexrange: [\"10b40\", \"10b5f\"],\n  },\n  {\n    category: \"inscriptional pahlavi\",\n    hexrange: [\"10b60\", \"10b7f\"],\n  },\n  {\n    category: \"psalter pahlavi\",\n    hexrange: [\"10b80\", \"10baf\"],\n  },\n  {\n    category: \"old turkic\",\n    hexrange: [\"10c00\", \"10c4f\"],\n  },\n  {\n    category: \"old hungarian\",\n    hexrange: [\"10c80\", \"10cff\"],\n  },\n  {\n    category: \"hanifi rohingya\",\n    hexrange: [\"10d00\", \"10d3f\"],\n  },\n  {\n    category: \"rumi numeral symbols\",\n    hexrange: [\"10e60\", \"10e7f\"],\n  },\n  {\n    category: \"yezidi\",\n    hexrange: [\"10e80\", \"10ebf\"],\n  },\n  {\n    category: \"arabic extended-c\",\n    hexrange: [\"10ec0\", \"10eff\"],\n  },\n  {\n    category: \"old sogdian\",\n    hexrange: [\"10f00\", \"10f2f\"],\n  },\n  {\n    category: \"sogdian\",\n    hexrange: [\"10f30\", \"10f6f\"],\n  },\n  {\n    category: \"old uyghur\",\n    hexrange: [\"10f70\", \"10faf\"],\n  },\n  {\n    category: \"chorasmian\",\n    hexrange: [\"10fb0\", \"10fdf\"],\n  },\n  {\n    category: \"elymaic\",\n    hexrange: [\"10fe0\", \"10fff\"],\n  },\n  {\n    category: \"brahmi\",\n    hexrange: [\"11000\", \"1107f\"],\n  },\n  {\n    category: \"kaithi\",\n    hexrange: [\"11080\", \"110cf\"],\n  },\n  {\n    category: \"sora sompeng\",\n    hexrange: [\"110d0\", \"110ff\"],\n  },\n  {\n    category: \"chakma\",\n    hexrange: [\"11100\", \"1114f\"],\n  },\n  {\n    category: \"mahajani\",\n    hexrange: [\"11150\", \"1117f\"],\n  },\n  {\n    category: \"sharada\",\n    hexrange: [\"11180\", \"111df\"],\n  },\n  {\n    category: \"sinhala archaic numbers\",\n    hexrange: [\"111e0\", \"111ff\"],\n  },\n  {\n    category: \"khojki\",\n    hexrange: [\"11200\", \"1124f\"],\n  },\n  {\n    category: \"multani\",\n    hexrange: [\"11280\", \"112af\"],\n  },\n  {\n    category: \"khudawadi\",\n    hexrange: [\"112b0\", \"112ff\"],\n  },\n  {\n    category: \"grantha\",\n    hexrange: [\"11300\", \"1137f\"],\n  },\n  {\n    category: \"newa\",\n    hexrange: [\"11400\", \"1147f\"],\n  },\n  {\n    category: \"tirhuta\",\n    hexrange: [\"11480\", \"114df\"],\n  },\n  {\n    category: \"siddham\",\n    hexrange: [\"11580\", \"115ff\"],\n  },\n  {\n    category: \"modi\",\n    hexrange: [\"11600\", \"1165f\"],\n  },\n  {\n    category: \"mongolian supplement\",\n    hexrange: [\"11660\", \"1167f\"],\n  },\n  {\n    category: \"takri\",\n    hexrange: [\"11680\", \"116cf\"],\n  },\n  {\n    category: \"ahom\",\n    hexrange: [\"11700\", \"1174f\"],\n  },\n  {\n    category: \"dogra\",\n    hexrange: [\"11800\", \"1184f\"],\n  },\n  {\n    category: \"warang citi\",\n    hexrange: [\"118a0\", \"118ff\"],\n  },\n  {\n    category: \"dives akuru\",\n    hexrange: [\"11900\", \"1195f\"],\n  },\n  {\n    category: \"nandinagari\",\n    hexrange: [\"119a0\", \"119ff\"],\n  },\n  {\n    category: \"zanabazar square\",\n    hexrange: [\"11a00\", \"11a4f\"],\n  },\n  {\n    category: \"soyombo\",\n    hexrange: [\"11a50\", \"11aaf\"],\n  },\n  {\n    category: \"unified canadian aboriginal syllabics extended-a\",\n    hexrange: [\"11ab0\", \"11abf\"],\n  },\n  {\n    category: \"pau cin hau\",\n    hexrange: [\"11ac0\", \"11aff\"],\n  },\n  {\n    category: \"devanagari extended-a\",\n    hexrange: [\"11b00\", \"11b5f\"],\n  },\n  {\n    category: \"bhaiksuki\",\n    hexrange: [\"11c00\", \"11c6f\"],\n  },\n  {\n    category: \"marchen\",\n    hexrange: [\"11c70\", \"11cbf\"],\n  },\n  {\n    category: \"masaram gondi\",\n    hexrange: [\"11d00\", \"11d5f\"],\n  },\n  {\n    category: \"gunjala gondi\",\n    hexrange: [\"11d60\", \"11daf\"],\n  },\n  {\n    category: \"makasar\",\n    hexrange: [\"11ee0\", \"11eff\"],\n  },\n  {\n    category: \"kawi\",\n    hexrange: [\"11f00\", \"11f5f\"],\n  },\n  {\n    category: \"lisu supplement\",\n    hexrange: [\"11fb0\", \"11fbf\"],\n  },\n  {\n    category: \"tamil supplement\",\n    hexrange: [\"11fc0\", \"11fff\"],\n  },\n  {\n    category: \"cuneiform\",\n    hexrange: [\"12000\", \"123ff\"],\n  },\n  {\n    category: \"cuneiform numbers and punctuation\",\n    hexrange: [\"12400\", \"1247f\"],\n  },\n  {\n    category: \"early dynastic cuneiform\",\n    hexrange: [\"12480\", \"1254f\"],\n  },\n  {\n    category: \"cypro-minoan\",\n    hexrange: [\"12f90\", \"12fff\"],\n  },\n  {\n    category: \"egyptian hieroglyphs\",\n    hexrange: [\"13000\", \"1342f\"],\n  },\n  {\n    category: \"egyptian hieroglyph format controls\",\n    hexrange: [\"13430\", \"1345f\"],\n  },\n  {\n    category: \"anatolian hieroglyphs\",\n    hexrange: [\"14400\", \"1467f\"],\n  },\n  {\n    category: \"bamum supplement\",\n    hexrange: [\"16800\", \"16a3f\"],\n  },\n  {\n    category: \"mro\",\n    hexrange: [\"16a40\", \"16a6f\"],\n  },\n  {\n    category: \"tangsa\",\n    hexrange: [\"16a70\", \"16acf\"],\n  },\n  {\n    category: \"bassa vah\",\n    hexrange: [\"16ad0\", \"16aff\"],\n  },\n  {\n    category: \"pahawh hmong\",\n    hexrange: [\"16b00\", \"16b8f\"],\n  },\n  {\n    category: \"medefaidrin\",\n    hexrange: [\"16e40\", \"16e9f\"],\n  },\n  {\n    category: \"miao\",\n    hexrange: [\"16f00\", \"16f9f\"],\n  },\n  {\n    category: \"ideographic symbols and punctuation\",\n    hexrange: [\"16fe0\", \"16fff\"],\n  },\n  {\n    category: \"tangut\",\n    hexrange: [\"17000\", \"187ff\"],\n  },\n  {\n    category: \"tangut components\",\n    hexrange: [\"18800\", \"18aff\"],\n  },\n  {\n    category: \"khitan small script\",\n    hexrange: [\"18b00\", \"18cff\"],\n  },\n  {\n    category: \"tangut supplement\",\n    hexrange: [\"18d00\", \"18d7f\"],\n  },\n  {\n    category: \"kana extended-b\",\n    hexrange: [\"1aff0\", \"1afff\"],\n  },\n  {\n    category: \"kana supplement\",\n    hexrange: [\"1b000\", \"1b0ff\"],\n  },\n  {\n    category: \"kana extended-a\",\n    hexrange: [\"1b100\", \"1b12f\"],\n  },\n  {\n    category: \"small kana extension\",\n    hexrange: [\"1b130\", \"1b16f\"],\n  },\n  {\n    category: \"nushu\",\n    hexrange: [\"1b170\", \"1b2ff\"],\n  },\n  {\n    category: \"duployan\",\n    hexrange: [\"1bc00\", \"1bc9f\"],\n  },\n  {\n    category: \"shorthand format controls\",\n    hexrange: [\"1bca0\", \"1bcaf\"],\n  },\n  {\n    category: \"znamenny musical notation\",\n    hexrange: [\"1cf00\", \"1cfcf\"],\n  },\n  {\n    category: \"byzantine musical symbols\",\n    hexrange: [\"1d000\", \"1d0ff\"],\n  },\n  {\n    category: \"musical symbols\",\n    hexrange: [\"1d100\", \"1d1ff\"],\n  },\n  {\n    category: \"ancient greek musical notation\",\n    hexrange: [\"1d200\", \"1d24f\"],\n  },\n  {\n    category: \"kaktovik numerals\",\n    hexrange: [\"1d2c0\", \"1d2df\"],\n  },\n  {\n    category: \"mayan numerals\",\n    hexrange: [\"1d2e0\", \"1d2ff\"],\n  },\n  {\n    category: \"tai xuan jing symbols\",\n    hexrange: [\"1d300\", \"1d35f\"],\n  },\n  {\n    category: \"counting rod numerals\",\n    hexrange: [\"1d360\", \"1d37f\"],\n  },\n  {\n    category: \"mathematical alphanumeric symbols\",\n    hexrange: [\"1d400\", \"1d7ff\"],\n  },\n  {\n    category: \"sutton signwriting\",\n    hexrange: [\"1d800\", \"1daaf\"],\n  },\n  {\n    category: \"latin extended-g\",\n    hexrange: [\"1df00\", \"1dfff\"],\n  },\n  {\n    category: \"glagolitic supplement\",\n    hexrange: [\"1e000\", \"1e02f\"],\n  },\n  {\n    category: \"cyrillic extended-d\",\n    hexrange: [\"1e030\", \"1e08f\"],\n  },\n  {\n    category: \"nyiakeng puachue hmong\",\n    hexrange: [\"1e100\", \"1e14f\"],\n  },\n  {\n    category: \"toto\",\n    hexrange: [\"1e290\", \"1e2bf\"],\n  },\n  {\n    category: \"wancho\",\n    hexrange: [\"1e2c0\", \"1e2ff\"],\n  },\n  {\n    category: \"nag mundari\",\n    hexrange: [\"1e4d0\", \"1e4ff\"],\n  },\n  {\n    category: \"ethiopic extended-b\",\n    hexrange: [\"1e7e0\", \"1e7ff\"],\n  },\n  {\n    category: \"mende kikakui\",\n    hexrange: [\"1e800\", \"1e8df\"],\n  },\n  {\n    category: \"adlam\",\n    hexrange: [\"1e900\", \"1e95f\"],\n  },\n  {\n    category: \"indic siyaq numbers\",\n    hexrange: [\"1ec70\", \"1ecbf\"],\n  },\n  {\n    category: \"ottoman siyaq numbers\",\n    hexrange: [\"1ed00\", \"1ed4f\"],\n  },\n  {\n    category: \"arabic mathematical alphabetic symbols\",\n    hexrange: [\"1ee00\", \"1eeff\"],\n  },\n  {\n    category: \"mahjong tiles\",\n    hexrange: [\"1f000\", \"1f02f\"],\n  },\n  {\n    category: \"domino tiles\",\n    hexrange: [\"1f030\", \"1f09f\"],\n  },\n  {\n    category: \"playing cards\",\n    hexrange: [\"1f0a0\", \"1f0ff\"],\n  },\n  {\n    category: \"enclosed alphanumeric supplement\",\n    hexrange: [\"1f100\", \"1f1ff\"],\n  },\n  {\n    category: \"enclosed ideographic supplement\",\n    hexrange: [\"1f200\", \"1f2ff\"],\n  },\n  {\n    category: \"miscellaneous symbols and pictographs\",\n    hexrange: [\"1f300\", \"1f5ff\"],\n  },\n  {\n    category: \"emoticons (emoji)\",\n    hexrange: [\"1f600\", \"1f64f\"],\n  },\n  {\n    category: \"ornamental dingbats\",\n    hexrange: [\"1f650\", \"1f67f\"],\n  },\n  {\n    category: \"transport and map symbols\",\n    hexrange: [\"1f680\", \"1f6ff\"],\n  },\n  {\n    category: \"alchemical symbols\",\n    hexrange: [\"1f700\", \"1f77f\"],\n  },\n  {\n    category: \"geometric shapes extended\",\n    hexrange: [\"1f780\", \"1f7ff\"],\n  },\n  {\n    category: \"supplemental arrows-c\",\n    hexrange: [\"1f800\", \"1f8ff\"],\n  },\n  {\n    category: \"supplemental symbols and pictographs\",\n    hexrange: [\"1f900\", \"1f9ff\"],\n  },\n  {\n    category: \"chess symbols\",\n    hexrange: [\"1fa00\", \"1fa6f\"],\n  },\n  {\n    category: \"symbols and pictographs extended-a\",\n    hexrange: [\"1fa70\", \"1faff\"],\n  },\n  {\n    category: \"symbols for legacy computing\",\n    hexrange: [\"1fb00\", \"1fbff\"],\n  },\n  {\n    category: \"cjk unified ideographs extension b\",\n    hexrange: [\"20000\", \"2a6df\"],\n  },\n  {\n    category: \"cjk unified ideographs extension c\",\n    hexrange: [\"2a700\", \"2b73f\"],\n  },\n  {\n    category: \"cjk unified ideographs extension d\",\n    hexrange: [\"2b740\", \"2b81f\"],\n  },\n  {\n    category: \"cjk unified ideographs extension e\",\n    hexrange: [\"2b820\", \"2ceaf\"],\n  },\n  {\n    category: \"cjk unified ideographs extension f\",\n    hexrange: [\"2ceb0\", \"2ebef\"],\n  },\n  {\n    category: \"cjk unified ideographs extension i\",\n    hexrange: [\"2ebf0\", \"2ee5f\"],\n  },\n  {\n    category: \"cjk compatibility ideographs supplement\",\n    hexrange: [\"2f800\", \"2fa1f\"],\n  },\n  {\n    category: \"cjk unified ideographs extension g\",\n    hexrange: [\"30000\", \"3134f\"],\n  },\n  {\n    category: \"cjk unified ideographs extension h\",\n    hexrange: [\"31350\", \"323af\"],\n  },\n  {\n    category: \"tags\",\n    hexrange: [\"e0000\", \"e007f\"],\n  },\n  {\n    category: \"variation selectors supplement\",\n    hexrange: [\"e0100\", \"e01ef\"],\n  },\n  {\n    category: \"supplementary private use area-a\",\n    hexrange: [\"f0000\", \"fffff\"],\n  },\n  {\n    category: \"supplementary private use area-b\",\n    hexrange: [\"100000\", \"10ffff\"],\n  },\n];\n\nexport { unicodeRanges };\n","import { inflate } from 'pako';\n\n// Mocking the pako module to just have inflate for a smaller package size\nconst pako = { inflate };\n\nvar Typr = {};\n\nTypr[\"parse\"] = function (buff) {\n  var bin = Typr[\"B\"];\n\n  var readFont = function (data, idx, offset, tmap) {\n    var T = Typr[\"T\"];\n    var prsr = {\n      \"cmap\": T.cmap,\n      \"head\": T.head,\n      \"hhea\": T.hhea,\n      \"maxp\": T.maxp,\n      \"hmtx\": T.hmtx,\n      \"name\": T.name,\n      \"OS/2\": T.OS2,\n      \"post\": T.post,\n\n      \"loca\": T.loca,\n      \"kern\": T.kern,\n      \"glyf\": T.glyf,\n\n      \"CFF \": T.CFF,\n      /*\n      \"GPOS\",\n      \"GSUB\",\n      \"GDEF\",*/\n      \"GSUB\": T.GSUB,\n      \"CBLC\": T.CBLC,\n      \"CBDT\": T.CBDT,\n\n      \"SVG \": T.SVG,\n      \"COLR\": T.colr,\n      \"CPAL\": T.cpal,\n      \"sbix\": T.sbix,\n\n      \"fvar\": T.fvar,\n      \"gvar\": T.gvar,\n      \"avar\": T.avar,\n      \"HVAR\": T.HVAR\n      //\"VORG\",\n    };\n    var obj = { \"_data\": data, \"_index\": idx, \"_offset\": offset };\n\n    for (var t in prsr) {\n      var tab = Typr[\"findTable\"](data, t, offset);\n      if (tab) {\n        var off = tab[0], tobj = tmap[off];\n        if (tobj == null) tobj = prsr[t].parseTab(data, off, tab[1], obj);\n        obj[t] = tmap[off] = tobj;\n      }\n    }\n    return obj;\n  };\n\n  function woffToOtf(data) {\n    var numTables = bin.readUshort(data, 12);\n    var totalSize = bin.readUint(data, 16);\n\n    var otf = new Uint8Array(totalSize), toff = 12 + numTables * 16;\n\n    bin.writeASCII(otf, 0, \"OTTO\");\n    bin.writeUshort(otf, 4, numTables);\n\n    var off = 44;\n    for (var i = 0; i < numTables; i++) {\n      var tag = bin.readASCII(data, off, 4);\n      var tof = bin.readUint(data, off + 4);\n      var cLe = bin.readUint(data, off + 8);\n      var oLe = bin.readUint(data, off + 12);\n      off += 20;\n      //console.log(i, \":::\", tag,tof,oLe);\n\n      var tab = data.slice(tof, tof + cLe);\n      if (cLe != oLe) tab = pako[\"inflate\"](tab);\n\n      var to = 12 + i * 16;\n      bin.writeASCII(otf, to, tag);\n      bin.writeUint(otf, to + 8, toff);\n      bin.writeUint(otf, to + 12, oLe);\n\n      otf.set(tab, toff); toff += oLe;\n    }\n    //console.log(otf);\n    return otf;\n  }\n\n\n  var data = new Uint8Array(buff);\n  // PATCHED: keep around the compressed data if we inflate it\n  let compressedData;\n  if (data[0] == 0x77) {\n    compressedData = data;\n    data = woffToOtf(data);\n  }\n\n  var tmap = {};\n  var tag = bin.readASCII(data, 0, 4);\n  if (tag == \"ttcf\") {\n    var offset = 4;\n    bin.readUshort(data, offset); offset += 2;\n    bin.readUshort(data, offset); offset += 2;\n    var numF = bin.readUint(data, offset); offset += 4;\n    var fnts = [];\n    for (var i = 0; i < numF; i++) {\n      var foff = bin.readUint(data, offset); offset += 4;\n      fnts.push(readFont(data, i, foff, tmap));\n    }\n    return fnts;\n  }\n  var fnt = readFont(data, 0, 0, tmap);  //console.log(fnt);  throw \"e\";\n  fnt._compressedData = compressedData; // PATCH: make compressed data accessible\n  var fvar = fnt[\"fvar\"];\n  if (fvar) {\n    var out = [fnt];\n    for (var i = 0; i < fvar[1].length; i++) {\n      var fv = fvar[1][i];\n      var obj = {}; out.push(obj); for (var p in fnt) obj[p] = fnt[p];\n      obj[\"_index\"] = i;\n      var name = obj[\"name\"] = JSON.parse(JSON.stringify(obj[\"name\"]));\n      name[\"fontSubfamily\"] = fv[0];\n      if (fv[3] == null) fv[3] = (name[\"fontFamily\"] + \"-\" + name[\"fontSubfamily\"])[\"replaceAll\"](\" \", \"\");\n      name[\"postScriptName\"] = fv[3];\n    }\n    return out;\n  }\n\n  return [fnt];\n};\n\n\nTypr[\"findTable\"] = function (data, tab, foff) {\n  var bin = Typr[\"B\"];\n  var numTables = bin.readUshort(data, foff + 4);\n  var offset = foff + 12;\n  for (var i = 0; i < numTables; i++) {\n    var tag = bin.readASCII(data, offset, 4);   //console.log(tag);\n    bin.readUint(data, offset + 4);\n    var toffset = bin.readUint(data, offset + 8);\n    var length = bin.readUint(data, offset + 12);\n    if (tag == tab) return [toffset, length];\n    offset += 16;\n  }\n  return null;\n};\n/*\nTypr[\"splitBy\"] = function(data,tag) {\n  data = new Uint8Array(data);  console.log(data.slice(0,64));\n  var bin = Typr[\"B\"];\n  var ttcf = bin.readASCII(data, 0, 4);  if(ttcf!=\"ttcf\") return {};\n\n  var offset = 8;\n  var numF = bin.readUint  (data, offset);  offset+=4;\n  var colls = [], used={};\n  for(var i=0; i<numF; i++) {\n    var foff = bin.readUint  (data, offset);  offset+=4;\n    var toff = Typr[\"findTable\"](data,tag,foff)[0];\n    if(used[toff]==null) used[toff] = [];\n    used[toff].push([foff,bin.readUshort(data,foff+4)]);  // font offset, numTables\n  }\n  for(var toff in used) {\n    var offs = used[toff];\n    var hlen = 12+4*offs.length;\n    var out = new Uint8Array(hlen);\n    for(var i=0; i<8; i++) out[i]=data[i];\n    bin.writeUint(out,8,offs.length);\n\n    for(var i=0; i<offs.length; i++) hlen += 12+offs[i][1]*16;\n\n    var hdrs = [out], tabs = [], hoff=out.length, toff=hlen, noffs={};\n    for(var i=0; i<offs.length; i++) {\n      bin.writeUint(out, 12+i*4, hoff);  hoff+=12+offs[i][1]*16;\n      toff = Typr[\"_cutFont\"](data, offs[i][0], hdrs, tabs, toff, noffs);\n    }\n    colls.push(Typr[\"_joinArrs\"](hdrs.concat(tabs)));\n  }\n  return colls;\n}\n\nTypr[\"splitFonts\"] = function(data) {\n  data = new Uint8Array(data);\n  var bin = Typr[\"B\"];\n  var ttcf = bin.readASCII(data, 0, 4);  if(ttcf!=\"ttcf\") return {};\n\n  var offset = 8;\n  var numF = bin.readUint  (data, offset);  offset+=4;\n  var fnts = [];\n  for(var i=0; i<numF; i++) {\n    var foff = bin.readUint  (data, offset);  offset+=4;\n    fnts.push(Typr._cutFont(data, foff));\n    break;\n  }\n  return fnts;\n}\n\nTypr[\"_cutFont\"] = function(data,foff,hdrs,tabs,toff, noffs) {\n  var bin = Typr[\"B\"];\n  var numTables = bin.readUshort(data, foff+4);\n\n  var out = new Uint8Array(12+numTables*16);  hdrs.push(out);\n  for(var i=0; i<12; i++) out[i]=data[foff+i];  //console.log(out);\n\n  var off = 12;\n  for(var i=0; i<numTables; i++)\n  {\n    var tag      = bin.readASCII(data, foff+off, 4);\n    var checkSum = bin.readUint (data, foff+off+ 4);\n    var toffset  = bin.readUint (data, foff+off+ 8);\n    var length   = bin.readUint (data, foff+off+12);\n\n    while((length&3)!=0) length++;\n\n    for(var j=0; j<16; j++) out[off+j]=data[foff+off+j];\n\n    if(noffs[toffset]!=null) bin.writeUint(out,off+8,noffs[toffset]);\n    else {\n      noffs[toffset] = toff;\n      bin.writeUint(out, off+8, toff);\n      tabs.push(new Uint8Array(data.buffer, toffset, length));  toff+=length;\n    }\n    off+=16;\n  }\n  return toff;\n}\nTypr[\"_joinArrs\"] = function(tabs) {\n  var len = 0;\n  for(var i=0; i<tabs.length; i++) len+=tabs[i].length;\n  var out = new Uint8Array(len), ooff=0;\n  for(var i=0; i<tabs.length; i++) {\n    var tab = tabs[i];\n    for(var j=0; j<tab.length; j++) out[ooff+j]=tab[j];\n    ooff+=tab.length;\n  }\n  return out;\n}\n*/\n\nTypr[\"T\"] = {};\n\n\n\n\n\nTypr[\"B\"] = {\n  readFixed: function (data, o) {\n    return ((data[o] << 8) | data[o + 1]) + (((data[o + 2] << 8) | data[o + 3]) / (256 * 256 + 4));\n  },\n  readF2dot14: function (data, o) {\n    var num = Typr[\"B\"].readShort(data, o);\n    return num / 16384;\n  },\n  readInt: function (buff, p) {\n    //if(p>=buff.length) throw \"error\";\n    var a = Typr[\"B\"].t.uint8;\n    a[0] = buff[p + 3];\n    a[1] = buff[p + 2];\n    a[2] = buff[p + 1];\n    a[3] = buff[p];\n    return Typr[\"B\"].t.int32[0];\n  },\n\n  readInt8: function (buff, p) {\n    //if(p>=buff.length) throw \"error\";\n    var a = Typr[\"B\"].t.uint8;\n    a[0] = buff[p];\n    return Typr[\"B\"].t.int8[0];\n  },\n  readShort: function (buff, p) {\n    //if(p>=buff.length) throw \"error\";\n    var a = Typr[\"B\"].t.uint16;\n    a[0] = (buff[p] << 8) | buff[p + 1];\n    return Typr[\"B\"].t.int16[0];\n  },\n  readUshort: function (buff, p) {\n    //if(p>=buff.length) throw \"error\";\n    return (buff[p] << 8) | buff[p + 1];\n  },\n  writeUshort: function (buff, p, n) {\n    buff[p] = (n >> 8) & 255; buff[p + 1] = n & 255;\n  },\n  readUshorts: function (buff, p, len) {\n    var arr = [];\n    for (var i = 0; i < len; i++) {\n      var v = Typr[\"B\"].readUshort(buff, p + i * 2);  //if(v==932) console.log(p+i*2);\n      arr.push(v);\n    }\n    return arr;\n  },\n  readUint: function (buff, p) {\n    //if(p>=buff.length) throw \"error\";\n    var a = Typr[\"B\"].t.uint8;\n    a[3] = buff[p]; a[2] = buff[p + 1]; a[1] = buff[p + 2]; a[0] = buff[p + 3];\n    return Typr[\"B\"].t.uint32[0];\n  },\n  writeUint: function (buff, p, n) {\n    buff[p] = (n >> 24) & 255; buff[p + 1] = (n >> 16) & 255; buff[p + 2] = (n >> 8) & 255; buff[p + 3] = (n >> 0) & 255;\n  },\n  readUint64: function (buff, p) {\n    //if(p>=buff.length) throw \"error\";\n    return (Typr[\"B\"].readUint(buff, p) * (0xffffffff + 1)) + Typr[\"B\"].readUint(buff, p + 4);\n  },\n  readASCII: function (buff, p, l)\t// l : length in Characters (not Bytes)\n  {\n    //if(p>=buff.length) throw \"error\";\n    var s = \"\";\n    for (var i = 0; i < l; i++) s += String.fromCharCode(buff[p + i]);\n    return s;\n  },\n  writeASCII: function (buff, p, s)\t// l : length in Characters (not Bytes)\n  {\n    for (var i = 0; i < s.length; i++)\n      buff[p + i] = s.charCodeAt(i);\n  },\n  readUnicode: function (buff, p, l) {\n    //if(p>=buff.length) throw \"error\";\n    var s = \"\";\n    for (var i = 0; i < l; i++) {\n      var c = (buff[p++] << 8) | buff[p++];\n      s += String.fromCharCode(c);\n    }\n    return s;\n  },\n  _tdec: window[\"TextDecoder\"] ? new window[\"TextDecoder\"]() : null,\n  readUTF8: function (buff, p, l) {\n    var tdec = Typr[\"B\"]._tdec;\n    if (tdec && p == 0 && l == buff.length) return tdec[\"decode\"](buff);\n    return Typr[\"B\"].readASCII(buff, p, l);\n  },\n  readBytes: function (buff, p, l) {\n    //if(p>=buff.length) throw \"error\";\n    var arr = [];\n    for (var i = 0; i < l; i++) arr.push(buff[p + i]);\n    return arr;\n  },\n  readASCIIArray: function (buff, p, l)\t// l : length in Characters (not Bytes)\n  {\n    //if(p>=buff.length) throw \"error\";\n    var s = [];\n    for (var i = 0; i < l; i++)\n      s.push(String.fromCharCode(buff[p + i]));\n    return s;\n  },\n  t: function () {\n    var ab = new ArrayBuffer(8);\n    return {\n      buff: ab,\n      int8: new Int8Array(ab),\n      uint8: new Uint8Array(ab),\n      int16: new Int16Array(ab),\n      uint16: new Uint16Array(ab),\n      int32: new Int32Array(ab),\n      uint32: new Uint32Array(ab)\n    }\n  }()\n};\n\n\n\n\n\n\nTypr[\"T\"].CFF = {\n  parseTab: function (data, offset, length) {\n    var bin = Typr[\"B\"];\n    var CFF = Typr[\"T\"].CFF;\n\n    data = new Uint8Array(data.buffer, offset, length);\n    offset = 0;\n\n    // Header\n    data[offset]; offset++;\n    data[offset]; offset++;\n    data[offset]; offset++;\n    data[offset]; offset++;\n    //console.log(major, minor, hdrSize, offsize);\n\n    // Name INDEX\n    var ninds = [];\n    offset = CFF.readIndex(data, offset, ninds);\n    var names = [];\n\n    for (var i = 0; i < ninds.length - 1; i++) names.push(bin.readASCII(data, offset + ninds[i], ninds[i + 1] - ninds[i]));\n    offset += ninds[ninds.length - 1];\n\n\n    // Top DICT INDEX\n    var tdinds = [];\n    offset = CFF.readIndex(data, offset, tdinds);  //console.log(tdinds);\n    // Top DICT Data\n    var topDicts = [];\n    for (var i = 0; i < tdinds.length - 1; i++) topDicts.push(CFF.readDict(data, offset + tdinds[i], offset + tdinds[i + 1]));\n    offset += tdinds[tdinds.length - 1];\n    var topdict = topDicts[0];\n    //console.log(topdict);\n\n    // String INDEX\n    var sinds = [];\n    offset = CFF.readIndex(data, offset, sinds);\n    // String Data\n    var strings = [];\n    for (var i = 0; i < sinds.length - 1; i++) strings.push(bin.readASCII(data, offset + sinds[i], sinds[i + 1] - sinds[i]));\n    offset += sinds[sinds.length - 1];\n\n    // Global Subr INDEX  (subroutines)\n    CFF.readSubrs(data, offset, topdict);\n\n    // charstrings\n\n    if (topdict[\"CharStrings\"]) topdict[\"CharStrings\"] = CFF.readBytes(data, topdict[\"CharStrings\"]);\n\n    // CID font\n    if (topdict[\"ROS\"]) {\n      offset = topdict[\"FDArray\"];\n      var fdind = [];\n      offset = CFF.readIndex(data, offset, fdind);\n\n      topdict[\"FDArray\"] = [];\n      for (var i = 0; i < fdind.length - 1; i++) {\n        var dict = CFF.readDict(data, offset + fdind[i], offset + fdind[i + 1]);\n        CFF._readFDict(data, dict, strings);\n        topdict[\"FDArray\"].push(dict);\n      }\n      offset += fdind[fdind.length - 1];\n\n      offset = topdict[\"FDSelect\"];\n      topdict[\"FDSelect\"] = [];\n      var fmt = data[offset]; offset++;\n      if (fmt == 3) {\n        var rns = bin.readUshort(data, offset); offset += 2;\n        for (var i = 0; i < rns + 1; i++) {\n          topdict[\"FDSelect\"].push(bin.readUshort(data, offset), data[offset + 2]); offset += 3;\n        }\n      }\n      else throw fmt;\n    }\n\n    // Encoding\n    //if(topdict[\"Encoding\"]) topdict[\"Encoding\"] = CFF.readEncoding(data, topdict[\"Encoding\"], topdict[\"CharStrings\"].length);\n\n    // charset\n    if (topdict[\"charset\"]) topdict[\"charset\"] = CFF.readCharset(data, topdict[\"charset\"], topdict[\"CharStrings\"].length);\n\n    CFF._readFDict(data, topdict, strings);\n    return topdict;\n  },\n\n  _readFDict: function (data, dict, ss) {\n    var CFF = Typr[\"T\"].CFF;\n    var offset;\n    if (dict[\"Private\"]) {\n      offset = dict[\"Private\"][1];\n      dict[\"Private\"] = CFF.readDict(data, offset, offset + dict[\"Private\"][0]);\n      if (dict[\"Private\"][\"Subrs\"]) CFF.readSubrs(data, offset + dict[\"Private\"][\"Subrs\"], dict[\"Private\"]);\n    }\n    for (var p in dict) if ([\"FamilyName\", \"FontName\", \"FullName\", \"Notice\", \"version\", \"Copyright\"].indexOf(p) != -1) dict[p] = ss[dict[p] - 426 + 35];\n  },\n\n  readSubrs: function (data, offset, obj) {\n    obj[\"Subrs\"] = Typr[\"T\"].CFF.readBytes(data, offset);\n\n    var bias, nSubrs = obj[\"Subrs\"].length + 1;\n    if (nSubrs < 1240) bias = 107;\n    else if (nSubrs < 33900) bias = 1131;\n    else bias = 32768;\n    obj[\"Bias\"] = bias;\n  },\n  readBytes: function (data, offset) {\n    Typr[\"B\"];\n    var arr = [];\n    offset = Typr[\"T\"].CFF.readIndex(data, offset, arr);\n\n    var subrs = [], arl = arr.length - 1, no = data.byteOffset + offset;\n    for (var i = 0; i < arl; i++) {\n      var ari = arr[i];\n      subrs.push(new Uint8Array(data.buffer, no + ari, arr[i + 1] - ari));\n    }\n    return subrs;\n  },\n\n  tableSE: [\n    0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0,\n    1, 2, 3, 4, 5, 6, 7, 8,\n    9, 10, 11, 12, 13, 14, 15, 16,\n    17, 18, 19, 20, 21, 22, 23, 24,\n    25, 26, 27, 28, 29, 30, 31, 32,\n    33, 34, 35, 36, 37, 38, 39, 40,\n    41, 42, 43, 44, 45, 46, 47, 48,\n    49, 50, 51, 52, 53, 54, 55, 56,\n    57, 58, 59, 60, 61, 62, 63, 64,\n    65, 66, 67, 68, 69, 70, 71, 72,\n    73, 74, 75, 76, 77, 78, 79, 80,\n    81, 82, 83, 84, 85, 86, 87, 88,\n    89, 90, 91, 92, 93, 94, 95, 0,\n    0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0,\n    0, 96, 97, 98, 99, 100, 101, 102,\n    103, 104, 105, 106, 107, 108, 109, 110,\n    0, 111, 112, 113, 114, 0, 115, 116,\n    117, 118, 119, 120, 121, 122, 0, 123,\n    0, 124, 125, 126, 127, 128, 129, 130,\n    131, 0, 132, 133, 0, 134, 135, 136,\n    137, 0, 0, 0, 0, 0, 0, 0,\n    0, 0, 0, 0, 0, 0, 0, 0,\n    0, 138, 0, 139, 0, 0, 0, 0,\n    140, 141, 142, 143, 0, 0, 0, 0,\n    0, 144, 0, 0, 0, 145, 0, 0,\n    146, 147, 148, 149, 0, 0, 0, 0\n  ],\n\n  glyphByUnicode: function (cff, code) {\n    for (var i = 0; i < cff[\"charset\"].length; i++) if (cff[\"charset\"][i] == code) return i;\n    return -1;\n  },\n\n  glyphBySE: function (cff, charcode)\t// glyph by standard encoding\n  {\n    if (charcode < 0 || charcode > 255) return -1;\n    return Typr[\"T\"].CFF.glyphByUnicode(cff, Typr[\"T\"].CFF.tableSE[charcode]);\n  },\n\n  /*readEncoding : function(data, offset, num)\n  {\n    var bin = Typr[\"B\"];\n\n    var array = ['.notdef'];\n    var format = data[offset];  offset++;\n    //console.log(\"Encoding\");\n    //console.log(format);\n\n    if(format==0)\n    {\n      var nCodes = data[offset];  offset++;\n      for(var i=0; i<nCodes; i++)  array.push(data[offset+i]);\n    }\n    /*\n    else if(format==1 || format==2)\n    {\n      while(charset.length<num)\n      {\n        var first = bin.readUshort(data, offset);  offset+=2;\n        var nLeft=0;\n        if(format==1) {  nLeft = data[offset];  offset++;  }\n        else          {  nLeft = bin.readUshort(data, offset);  offset+=2;  }\n        for(var i=0; i<=nLeft; i++)  {  charset.push(first);  first++;  }\n      }\n    }\n\n    else throw \"error: unknown encoding format: \" + format;\n\n    return array;\n  },*/\n\n  readCharset: function (data, offset, num) {\n    var bin = Typr[\"B\"];\n\n    var charset = ['.notdef'];\n    var format = data[offset]; offset++;\n\n    if (format == 0) {\n      for (var i = 0; i < num; i++) {\n        var first = bin.readUshort(data, offset); offset += 2;\n        charset.push(first);\n      }\n    }\n    else if (format == 1 || format == 2) {\n      while (charset.length < num) {\n        var first = bin.readUshort(data, offset); offset += 2;\n        var nLeft = 0;\n        if (format == 1) { nLeft = data[offset]; offset++; }\n        else { nLeft = bin.readUshort(data, offset); offset += 2; }\n        for (var i = 0; i <= nLeft; i++) { charset.push(first); first++; }\n      }\n    }\n    else throw \"error: format: \" + format;\n\n    return charset;\n  },\n\n  readIndex: function (data, offset, inds) {\n    var bin = Typr[\"B\"];\n\n    var count = bin.readUshort(data, offset) + 1; offset += 2;\n    var offsize = data[offset]; offset++;\n\n    if (offsize == 1) for (var i = 0; i < count; i++) inds.push(data[offset + i]);\n    else if (offsize == 2) for (var i = 0; i < count; i++) inds.push(bin.readUshort(data, offset + i * 2));\n    else if (offsize == 3) for (var i = 0; i < count; i++) inds.push(bin.readUint(data, offset + i * 3 - 1) & 0x00ffffff);\n    else if (offsize == 4) for (var i = 0; i < count; i++) inds.push(bin.readUint(data, offset + i * 4));\n    else if (count != 1) throw \"unsupported offset size: \" + offsize + \", count: \" + count;\n\n    offset += count * offsize;\n    return offset - 1;\n  },\n\n  getCharString: function (data, offset, o) {\n    var bin = Typr[\"B\"];\n\n    var b0 = data[offset], b1 = data[offset + 1]; data[offset + 2]; data[offset + 3]; data[offset + 4];\n    var vs = 1;\n    var op = null, val = null;\n    // operand\n    if (b0 <= 20) { op = b0; vs = 1; }\n    if (b0 == 12) { op = b0 * 100 + b1; vs = 2; }\n    //if(b0==19 || b0==20) { op = b0/*+\" \"+b1*/;  vs=2; }\n    if (21 <= b0 && b0 <= 27) { op = b0; vs = 1; }\n    if (b0 == 28) { val = bin.readShort(data, offset + 1); vs = 3; }\n    if (29 <= b0 && b0 <= 31) { op = b0; vs = 1; }\n    if (32 <= b0 && b0 <= 246) { val = b0 - 139; vs = 1; }\n    if (247 <= b0 && b0 <= 250) { val = (b0 - 247) * 256 + b1 + 108; vs = 2; }\n    if (251 <= b0 && b0 <= 254) { val = -(b0 - 251) * 256 - b1 - 108; vs = 2; }\n    if (b0 == 255) { val = bin.readInt(data, offset + 1) / 0xffff; vs = 5; }\n\n    o.val = val != null ? val : \"o\" + op;\n    o.size = vs;\n  },\n\n  readCharString: function (data, offset, length) {\n    var end = offset + length;\n    var bin = Typr[\"B\"];\n    var arr = [];\n\n    while (offset < end) {\n      var b0 = data[offset], b1 = data[offset + 1]; data[offset + 2]; data[offset + 3]; data[offset + 4];\n      var vs = 1;\n      var op = null, val = null;\n      // operand\n      if (b0 <= 20) { op = b0; vs = 1; }\n      if (b0 == 12) { op = b0 * 100 + b1; vs = 2; }\n      if (b0 == 19 || b0 == 20) { op = b0/*+\" \"+b1*/; vs = 2; }\n      if (21 <= b0 && b0 <= 27) { op = b0; vs = 1; }\n      if (b0 == 28) { val = bin.readShort(data, offset + 1); vs = 3; }\n      if (29 <= b0 && b0 <= 31) { op = b0; vs = 1; }\n      if (32 <= b0 && b0 <= 246) { val = b0 - 139; vs = 1; }\n      if (247 <= b0 && b0 <= 250) { val = (b0 - 247) * 256 + b1 + 108; vs = 2; }\n      if (251 <= b0 && b0 <= 254) { val = -(b0 - 251) * 256 - b1 - 108; vs = 2; }\n      if (b0 == 255) { val = bin.readInt(data, offset + 1) / 0xffff; vs = 5; }\n\n      arr.push(val != null ? val : \"o\" + op);\n      offset += vs;\n\n      //var cv = arr[arr.length-1];\n      //if(cv==undefined) throw \"error\";\n      //console.log()\n    }\n    return arr;\n  },\n\n  readDict: function (data, offset, end) {\n    var bin = Typr[\"B\"];\n    //var dict = [];\n    var dict = {};\n    var carr = [];\n\n    while (offset < end) {\n      var b0 = data[offset], b1 = data[offset + 1]; data[offset + 2]; data[offset + 3]; data[offset + 4];\n      var vs = 1;\n      var key = null, val = null;\n      // operand\n      if (b0 == 28) { val = bin.readShort(data, offset + 1); vs = 3; }\n      if (b0 == 29) { val = bin.readInt(data, offset + 1); vs = 5; }\n      if (32 <= b0 && b0 <= 246) { val = b0 - 139; vs = 1; }\n      if (247 <= b0 && b0 <= 250) { val = (b0 - 247) * 256 + b1 + 108; vs = 2; }\n      if (251 <= b0 && b0 <= 254) { val = -(b0 - 251) * 256 - b1 - 108; vs = 2; }\n      if (b0 == 255) { val = bin.readInt(data, offset + 1) / 0xffff; vs = 5; throw \"unknown number\"; }\n\n      if (b0 == 30) {\n        var nibs = [];\n        vs = 1;\n        while (true) {\n          var b = data[offset + vs]; vs++;\n          var nib0 = b >> 4, nib1 = b & 0xf;\n          if (nib0 != 0xf) nibs.push(nib0); if (nib1 != 0xf) nibs.push(nib1);\n          if (nib1 == 0xf) break;\n        }\n        var s = \"\";\n        var chars = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, \".\", \"e\", \"e-\", \"reserved\", \"-\", \"endOfNumber\"];\n        for (var i = 0; i < nibs.length; i++) s += chars[nibs[i]];\n        //console.log(nibs);\n        val = parseFloat(s);\n      }\n\n      if (b0 <= 21)\t// operator\n      {\n        var keys = [\"version\", \"Notice\", \"FullName\", \"FamilyName\", \"Weight\", \"FontBBox\", \"BlueValues\", \"OtherBlues\", \"FamilyBlues\", \"FamilyOtherBlues\",\n          \"StdHW\", \"StdVW\", \"escape\", \"UniqueID\", \"XUID\", \"charset\", \"Encoding\", \"CharStrings\", \"Private\", \"Subrs\",\n          \"defaultWidthX\", \"nominalWidthX\"];\n\n        key = keys[b0]; vs = 1;\n        if (b0 == 12) {\n          var keys = [\"Copyright\", \"isFixedPitch\", \"ItalicAngle\", \"UnderlinePosition\", \"UnderlineThickness\", \"PaintType\", \"CharstringType\", \"FontMatrix\", \"StrokeWidth\", \"BlueScale\",\n            \"BlueShift\", \"BlueFuzz\", \"StemSnapH\", \"StemSnapV\", \"ForceBold\", \"\", \"\", \"LanguageGroup\", \"ExpansionFactor\", \"initialRandomSeed\",\n            \"SyntheticBase\", \"PostScript\", \"BaseFontName\", \"BaseFontBlend\", \"\", \"\", \"\", \"\", \"\", \"\",\n            \"ROS\", \"CIDFontVersion\", \"CIDFontRevision\", \"CIDFontType\", \"CIDCount\", \"UIDBase\", \"FDArray\", \"FDSelect\", \"FontName\"];\n          key = keys[b1]; vs = 2;\n        }\n      }\n\n      if (key != null) { dict[key] = carr.length == 1 ? carr[0] : carr; carr = []; }\n      else carr.push(val);\n\n      offset += vs;\n    }\n    return dict;\n  }\n};\n\n\nTypr[\"T\"].cmap = {\n  parseTab: function (data, offset, length) {\n    var obj = { tables: [], ids: {}, off: offset };\n    data = new Uint8Array(data.buffer, offset, length);\n    offset = 0;\n    var bin = Typr[\"B\"], rU = bin.readUshort, cmap = Typr[\"T\"].cmap;\n    rU(data, offset); offset += 2;\n    var numTables = rU(data, offset); offset += 2;\n\n    //console.log(version, numTables);\n\n    var offs = [];\n\n\n    for (var i = 0; i < numTables; i++) {\n      var platformID = rU(data, offset); offset += 2;\n      var encodingID = rU(data, offset); offset += 2;\n      var noffset = bin.readUint(data, offset); offset += 4;\n\n      var id = \"p\" + platformID + \"e\" + encodingID;\n\n      //console.log(\"cmap subtable\", platformID, encodingID, noffset);\n\n\n      var tind = offs.indexOf(noffset);\n\n      if (tind == -1) {\n        tind = obj.tables.length;\n        var subt = {};\n        offs.push(noffset);\n        //var time = Date.now();\n        var format = subt.format = rU(data, noffset);\n        if (format == 0) subt = cmap.parse0(data, noffset, subt);\n        //else if(format== 2) subt.off = noffset;\n        else if (format == 4) subt = cmap.parse4(data, noffset, subt);\n        else if (format == 6) subt = cmap.parse6(data, noffset, subt);\n        else if (format == 12) subt = cmap.parse12(data, noffset, subt);\n        //console.log(format, Date.now()-time);\n        //else console.log(\"unknown format: \"+format, platformID, encodingID, noffset);\n        obj.tables.push(subt);\n      }\n\n      if (obj.ids[id] != null) console.log(\"multiple tables for one platform+encoding: \" + id);\n      obj.ids[id] = tind;\n    }\n    return obj;\n  },\n\n  parse0: function (data, offset, obj) {\n    var bin = Typr[\"B\"];\n    offset += 2;\n    var len = bin.readUshort(data, offset); offset += 2;\n    bin.readUshort(data, offset); offset += 2;\n    obj.map = [];\n    for (var i = 0; i < len - 6; i++) obj.map.push(data[offset + i]);\n    return obj;\n  },\n\n  parse4: function (data, offset, obj) {\n    var bin = Typr[\"B\"], rU = bin.readUshort, rUs = bin.readUshorts;\n    var offset0 = offset;\n    offset += 2;\n    var length = rU(data, offset); offset += 2;\n    rU(data, offset); offset += 2;\n    var segCountX2 = rU(data, offset); offset += 2;\n    var segCount = segCountX2 >>> 1;\n    obj.searchRange = rU(data, offset); offset += 2;\n    obj.entrySelector = rU(data, offset); offset += 2;\n    obj.rangeShift = rU(data, offset); offset += 2;\n    obj.endCount = rUs(data, offset, segCount); offset += segCount * 2;\n    offset += 2;\n    obj.startCount = rUs(data, offset, segCount); offset += segCount * 2;\n    obj.idDelta = [];\n    for (var i = 0; i < segCount; i++) { obj.idDelta.push(bin.readShort(data, offset)); offset += 2; }\n    obj.idRangeOffset = rUs(data, offset, segCount); offset += segCount * 2;\n    obj.glyphIdArray = rUs(data, offset, ((offset0 + length) - offset) >> 1);  //offset += segCount*2;\n    return obj;\n  },\n\n  parse6: function (data, offset, obj) {\n    var bin = Typr[\"B\"];\n    offset += 2;\n    bin.readUshort(data, offset); offset += 2;\n    bin.readUshort(data, offset); offset += 2;\n    obj.firstCode = bin.readUshort(data, offset); offset += 2;\n    var entryCount = bin.readUshort(data, offset); offset += 2;\n    obj.glyphIdArray = [];\n    for (var i = 0; i < entryCount; i++) { obj.glyphIdArray.push(bin.readUshort(data, offset)); offset += 2; }\n\n    return obj;\n  },\n\n  parse12: function (data, offset, obj) {\n    var bin = Typr[\"B\"], rU = bin.readUint;\n    offset += 4;\n    rU(data, offset); offset += 4;\n    rU(data, offset); offset += 4;\n    var nGroups = rU(data, offset) * 3; offset += 4;\n\n    var gps = obj.groups = new Uint32Array(nGroups);//new Uint32Array(data.slice(offset, offset+nGroups*12).buffer);\n\n    for (var i = 0; i < nGroups; i += 3) {\n      gps[i] = rU(data, offset + (i << 2));\n      gps[i + 1] = rU(data, offset + (i << 2) + 4);\n      gps[i + 2] = rU(data, offset + (i << 2) + 8);\n    }\n    return obj;\n  }\n};\n\nTypr[\"T\"].CBLC = {\n  parseTab: function (data, offset, length) {\n    var bin = Typr[\"B\"], ooff = offset;\n\n    bin.readUshort(data, offset); offset += 2;\n    bin.readUshort(data, offset); offset += 2;\n\n    var numSizes = bin.readUint(data, offset); offset += 4;\n\n    var out = [];\n    for (var i = 0; i < numSizes; i++) {\n      var off = bin.readUint(data, offset); offset += 4;  // indexSubTableArrayOffset\n      bin.readUint(data, offset); offset += 4;  // indexTablesSize\n      bin.readUint(data, offset); offset += 4;  // numberOfIndexSubTables\n      offset += 4;\n\n      offset += 2 * 12;\n\n      bin.readUshort(data, offset); offset += 2;\n      bin.readUshort(data, offset); offset += 2;\n\n      //console.log(off,siz,num, sGlyph, eGlyph);\n\n      offset += 4;\n\n      var coff = ooff + off;\n      for (var j = 0; j < 3; j++) {\n        var fgI = bin.readUshort(data, coff); coff += 2;\n        var lgI = bin.readUshort(data, coff); coff += 2;\n        var nxt = bin.readUint(data, coff); coff += 4;\n        var gcnt = lgI - fgI + 1;\n        //console.log(fgI, lgI, nxt);   //if(nxt==0) break;\n\n        var ioff = ooff + off + nxt;\n\n        var inF = bin.readUshort(data, ioff); ioff += 2; if (inF != 1) throw inF;\n        var imF = bin.readUshort(data, ioff); ioff += 2;\n        var imgo = bin.readUint(data, ioff); ioff += 4;\n\n        var oarr = [];\n        for (var gi = 0; gi < gcnt; gi++) {\n          var sbitO = bin.readUint(data, ioff + gi * 4); oarr.push(imgo + sbitO);\n          //console.log(\"--\",sbitO);\n        }\n        out.push([fgI, lgI, imF, oarr]);\n      }\n    }\n    return out;\n  }\n};\n\nTypr[\"T\"].CBDT = {\n  parseTab: function (data, offset, length) {\n    Typr[\"B\"];\n\n    //var maj = bin.readUshort(data,offset);  offset+=2;\n    //var min = bin.readUshort(data,offset);  offset+=2;\n\n    return new Uint8Array(data.buffer, data.byteOffset + offset, length);\n  }\n};\n\nTypr[\"T\"].glyf = {\n  parseTab: function (data, offset, length, font) {\n    var obj = [], ng = font[\"maxp\"][\"numGlyphs\"];\n    for (var g = 0; g < ng; g++) obj.push(null);\n    return obj;\n  },\n\n  _parseGlyf: function (font, g) {\n    var bin = Typr[\"B\"];\n    var data = font[\"_data\"], loca = font[\"loca\"];\n\n    if (loca[g] == loca[g + 1]) return null;\n\n    var offset = Typr[\"findTable\"](data, \"glyf\", font[\"_offset\"])[0] + loca[g];\n\n    var gl = {};\n\n    gl.noc = bin.readShort(data, offset); offset += 2;\t\t// number of contours\n    gl.xMin = bin.readShort(data, offset); offset += 2;\n    gl.yMin = bin.readShort(data, offset); offset += 2;\n    gl.xMax = bin.readShort(data, offset); offset += 2;\n    gl.yMax = bin.readShort(data, offset); offset += 2;\n\n    if (gl.xMin >= gl.xMax || gl.yMin >= gl.yMax) return null;\n\n    if (gl.noc > 0) {\n      gl.endPts = [];\n      for (var i = 0; i < gl.noc; i++) { gl.endPts.push(bin.readUshort(data, offset)); offset += 2; }\n\n      var instructionLength = bin.readUshort(data, offset); offset += 2;\n      if ((data.length - offset) < instructionLength) return null;\n      gl.instructions = bin.readBytes(data, offset, instructionLength); offset += instructionLength;\n\n      var crdnum = gl.endPts[gl.noc - 1] + 1;\n      gl.flags = [];\n      for (var i = 0; i < crdnum; i++) {\n        var flag = data[offset]; offset++;\n        gl.flags.push(flag);\n        if ((flag & 8) != 0) {\n          var rep = data[offset]; offset++;\n          for (var j = 0; j < rep; j++) { gl.flags.push(flag); i++; }\n        }\n      }\n      gl.xs = [];\n      for (var i = 0; i < crdnum; i++) {\n        var i8 = ((gl.flags[i] & 2) != 0), same = ((gl.flags[i] & 16) != 0);\n        if (i8) { gl.xs.push(same ? data[offset] : -data[offset]); offset++; }\n        else {\n          if (same) gl.xs.push(0);\n          else { gl.xs.push(bin.readShort(data, offset)); offset += 2; }\n        }\n      }\n      gl.ys = [];\n      for (var i = 0; i < crdnum; i++) {\n        var i8 = ((gl.flags[i] & 4) != 0), same = ((gl.flags[i] & 32) != 0);\n        if (i8) { gl.ys.push(same ? data[offset] : -data[offset]); offset++; }\n        else {\n          if (same) gl.ys.push(0);\n          else { gl.ys.push(bin.readShort(data, offset)); offset += 2; }\n        }\n      }\n      var x = 0, y = 0;\n      for (var i = 0; i < crdnum; i++) { x += gl.xs[i]; y += gl.ys[i]; gl.xs[i] = x; gl.ys[i] = y; }\n      //console.log(endPtsOfContours, instructionLength, instructions, flags, xCoordinates, yCoordinates);\n    }\n    else {\n      var ARG_1_AND_2_ARE_WORDS = 1 << 0;\n      var ARGS_ARE_XY_VALUES = 1 << 1;\n      var WE_HAVE_A_SCALE = 1 << 3;\n      var MORE_COMPONENTS = 1 << 5;\n      var WE_HAVE_AN_X_AND_Y_SCALE = 1 << 6;\n      var WE_HAVE_A_TWO_BY_TWO = 1 << 7;\n      var WE_HAVE_INSTRUCTIONS = 1 << 8;\n\n      gl.parts = [];\n      var flags;\n      do {\n        flags = bin.readUshort(data, offset); offset += 2;\n        var part = { m: { a: 1, b: 0, c: 0, d: 1, tx: 0, ty: 0 }, p1: -1, p2: -1 }; gl.parts.push(part);\n        part.glyphIndex = bin.readUshort(data, offset); offset += 2;\n        if (flags & ARG_1_AND_2_ARE_WORDS) {\n          var arg1 = bin.readShort(data, offset); offset += 2;\n          var arg2 = bin.readShort(data, offset); offset += 2;\n        } else {\n          var arg1 = bin.readInt8(data, offset); offset++;\n          var arg2 = bin.readInt8(data, offset); offset++;\n        }\n\n        if (flags & ARGS_ARE_XY_VALUES) { part.m.tx = arg1; part.m.ty = arg2; }\n        else { part.p1 = arg1; part.p2 = arg2; }\n        //part.m.tx = arg1;  part.m.ty = arg2;\n        //else { throw \"params are not XY values\"; }\n\n        if (flags & WE_HAVE_A_SCALE) {\n          part.m.a = part.m.d = bin.readF2dot14(data, offset); offset += 2;\n        } else if (flags & WE_HAVE_AN_X_AND_Y_SCALE) {\n          part.m.a = bin.readF2dot14(data, offset); offset += 2;\n          part.m.d = bin.readF2dot14(data, offset); offset += 2;\n        } else if (flags & WE_HAVE_A_TWO_BY_TWO) {\n          part.m.a = bin.readF2dot14(data, offset); offset += 2;\n          part.m.b = bin.readF2dot14(data, offset); offset += 2;\n          part.m.c = bin.readF2dot14(data, offset); offset += 2;\n          part.m.d = bin.readF2dot14(data, offset); offset += 2;\n        }\n      } while (flags & MORE_COMPONENTS)\n      if (flags & WE_HAVE_INSTRUCTIONS) {\n        var numInstr = bin.readUshort(data, offset); offset += 2;\n        gl.instr = [];\n        for (var i = 0; i < numInstr; i++) { gl.instr.push(data[offset]); offset++; }\n      }\n    }\n    return gl;\n  }\n};\n\nTypr[\"T\"].head = {\n  parseTab: function (data, offset, length) {\n    var bin = Typr[\"B\"];\n    var obj = {};\n    bin.readFixed(data, offset); offset += 4;\n\n    obj[\"fontRevision\"] = bin.readFixed(data, offset); offset += 4;\n    bin.readUint(data, offset); offset += 4;\n    bin.readUint(data, offset); offset += 4;\n    obj[\"flags\"] = bin.readUshort(data, offset); offset += 2;\n    obj[\"unitsPerEm\"] = bin.readUshort(data, offset); offset += 2;\n    obj[\"created\"] = bin.readUint64(data, offset); offset += 8;\n    obj[\"modified\"] = bin.readUint64(data, offset); offset += 8;\n    obj[\"xMin\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"yMin\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"xMax\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"yMax\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"macStyle\"] = bin.readUshort(data, offset); offset += 2;\n    obj[\"lowestRecPPEM\"] = bin.readUshort(data, offset); offset += 2;\n    obj[\"fontDirectionHint\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"indexToLocFormat\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"glyphDataFormat\"] = bin.readShort(data, offset); offset += 2;\n    return obj;\n  }\n};\n\nTypr[\"T\"].hhea = {\n  parseTab: function (data, offset, length) {\n    var bin = Typr[\"B\"];\n    var obj = {};\n    bin.readFixed(data, offset); offset += 4;\n\n    var keys = [\"ascender\", \"descender\", \"lineGap\",\n      \"advanceWidthMax\", \"minLeftSideBearing\", \"minRightSideBearing\", \"xMaxExtent\",\n      \"caretSlopeRise\", \"caretSlopeRun\", \"caretOffset\",\n      \"res0\", \"res1\", \"res2\", \"res3\",\n      \"metricDataFormat\", \"numberOfHMetrics\"];\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var func = (key == \"advanceWidthMax\" || key == \"numberOfHMetrics\") ? bin.readUshort : bin.readShort;\n      obj[key] = func(data, offset + i * 2);\n    }\n    return obj;\n  }\n};\n\n\nTypr[\"T\"].hmtx = {\n  parseTab: function (data, offset, length, font) {\n    var bin = Typr[\"B\"];\n    var aWidth = [];\n    var lsBearing = [];\n\n    var nG = font[\"maxp\"][\"numGlyphs\"], nH = font[\"hhea\"][\"numberOfHMetrics\"];\n    var aw = 0, lsb = 0, i = 0;\n    while (i < nH) { aw = bin.readUshort(data, offset + (i << 2)); lsb = bin.readShort(data, offset + (i << 2) + 2); aWidth.push(aw); lsBearing.push(lsb); i++; }\n    while (i < nG) { aWidth.push(aw); lsBearing.push(lsb); i++; }\n\n    return { aWidth: aWidth, lsBearing: lsBearing };\n  }\n};\n\n\nTypr[\"T\"].kern = {\n  parseTab: function (data, offset, length, font) {\n    var bin = Typr[\"B\"], kern = Typr[\"T\"].kern;\n\n    var version = bin.readUshort(data, offset);\n    if (version == 1) return kern.parseV1(data, offset, length, font);\n    var nTables = bin.readUshort(data, offset + 2); offset += 4;\n\n    var map = { glyph1: [], rval: [] };\n    for (var i = 0; i < nTables; i++) {\n      offset += 2;\t// skip version\n      var length = bin.readUshort(data, offset); offset += 2;\n      var coverage = bin.readUshort(data, offset); offset += 2;\n      var format = coverage >>> 8;\n\t\t\t/* I have seen format 128 once, that's why I do */ format &= 0xf;\n      if (format == 0) offset = kern.readFormat0(data, offset, map);\n      //else throw \"unknown kern table format: \"+format;\n    }\n    return map;\n  },\n\n  parseV1: function (data, offset, length, font) {\n    var bin = Typr[\"B\"], kern = Typr[\"T\"].kern;\n\n    bin.readFixed(data, offset);   // 0x00010000\n    var nTables = bin.readUint(data, offset + 4); offset += 8;\n\n    var map = { glyph1: [], rval: [] };\n    for (var i = 0; i < nTables; i++) {\n      bin.readUint(data, offset); offset += 4;\n      var coverage = bin.readUshort(data, offset); offset += 2;\n      bin.readUshort(data, offset); offset += 2;\n      var format = coverage & 0xff;\n      if (format == 0) offset = kern.readFormat0(data, offset, map);\n      //else throw \"unknown kern table format: \"+format;\n    }\n    return map;\n  },\n\n  readFormat0: function (data, offset, map) {\n    var bin = Typr[\"B\"], rUs = bin.readUshort;\n    var pleft = -1;\n    var nPairs = rUs(data, offset);\n    rUs(data, offset + 2);\n    rUs(data, offset + 4);\n    rUs(data, offset + 6); offset += 8;\n    for (var j = 0; j < nPairs; j++) {\n      var left = rUs(data, offset); offset += 2;\n      var right = rUs(data, offset); offset += 2;\n      var value = bin.readShort(data, offset); offset += 2;\n      if (left != pleft) { map.glyph1.push(left); map.rval.push({ glyph2: [], vals: [] }); }\n      var rval = map.rval[map.rval.length - 1];\n      rval.glyph2.push(right); rval.vals.push(value);\n      pleft = left;\n    }\n    return offset;\n  }\n};\n\n\nTypr[\"T\"].loca = {\n  parseTab: function (data, offset, length, font) {\n    var bin = Typr[\"B\"];\n    var obj = [];\n\n    var ver = font[\"head\"][\"indexToLocFormat\"];\n    var len = font[\"maxp\"][\"numGlyphs\"] + 1;\n\n    if (ver == 0) for (var i = 0; i < len; i++) obj.push(bin.readUshort(data, offset + (i << 1)) << 1);\n    if (ver == 1) for (var i = 0; i < len; i++) obj.push(bin.readUint(data, offset + (i << 2)));\n\n    return obj;\n  }\n};\n\n\nTypr[\"T\"].maxp = {\n  parseTab: function (data, offset, length) {\n    //console.log(data.length, offset, length);\n\n    var bin = Typr[\"B\"], rU = bin.readUshort;\n    var obj = {};\n\n    // both versions 0.5 and 1.0\n    bin.readUint(data, offset); offset += 4;\n\n    obj[\"numGlyphs\"] = rU(data, offset); offset += 2;\n\n    // only 1.0\n    /*\n    if(ver == 0x00010000) {\n      obj.maxPoints             = rU(data, offset);  offset += 2;\n      obj.maxContours           = rU(data, offset);  offset += 2;\n      obj.maxCompositePoints    = rU(data, offset);  offset += 2;\n      obj.maxCompositeContours  = rU(data, offset);  offset += 2;\n      obj.maxZones              = rU(data, offset);  offset += 2;\n      obj.maxTwilightPoints     = rU(data, offset);  offset += 2;\n      obj.maxStorage            = rU(data, offset);  offset += 2;\n      obj.maxFunctionDefs       = rU(data, offset);  offset += 2;\n      obj.maxInstructionDefs    = rU(data, offset);  offset += 2;\n      obj.maxStackElements      = rU(data, offset);  offset += 2;\n      obj.maxSizeOfInstructions = rU(data, offset);  offset += 2;\n      obj.maxComponentElements  = rU(data, offset);  offset += 2;\n      obj.maxComponentDepth     = rU(data, offset);  offset += 2;\n    }\n    */\n\n    return obj;\n  }\n};\nTypr[\"T\"].name = {\n  parseTab: function (data, offset, length) {\n    var bin = Typr[\"B\"];\n    var obj = {};\n    bin.readUshort(data, offset); offset += 2;\n    var count = bin.readUshort(data, offset); offset += 2;\n    var stringOffset = bin.readUshort(data, offset); offset += 2;\n\n    var ooo = offset - 6 + stringOffset;\n    //console.log(format,count);\n\n    var names = [\n      \"copyright\",\n      \"fontFamily\",\n      \"fontSubfamily\",\n      \"ID\",\n      \"fullName\",\n      \"version\",\n      \"postScriptName\",\n      \"trademark\",\n      \"manufacturer\",\n      \"designer\",\n      \"description\",\n      \"urlVendor\",\n      \"urlDesigner\",\n      \"licence\",\n      \"licenceURL\",\n      \"---\",\n      \"typoFamilyName\",\n      \"typoSubfamilyName\",\n      \"compatibleFull\",\n      \"sampleText\",\n      \"postScriptCID\",\n      \"wwsFamilyName\",\n      \"wwsSubfamilyName\",\n      \"lightPalette\",\n      \"darkPalette\"\n    ];\n\n    var rU = bin.readUshort;\n\n    for (var i = 0; i < count; i++) {\n      var platformID = rU(data, offset); offset += 2;\n      var encodingID = rU(data, offset); offset += 2;\n      var languageID = rU(data, offset); offset += 2;\n      var nameID = rU(data, offset); offset += 2;\n      var slen = rU(data, offset); offset += 2;\n      var noffset = rU(data, offset); offset += 2;\n      //console.log(platformID, encodingID, languageID.toString(16), nameID, length, noffset);\n\n\n      var soff = ooo + noffset;\n      var str;\n      if (platformID == 0) str = bin.readUnicode(data, soff, slen / 2);\n      else if (platformID == 3 && encodingID == 0) str = bin.readUnicode(data, soff, slen / 2);\n      else if (platformID == 1 && encodingID == 25) str = bin.readUnicode(data, soff, slen / 2);\n      else if (encodingID == 0) str = bin.readASCII(data, soff, slen);\n      else if (encodingID == 1) str = bin.readUnicode(data, soff, slen / 2);\n      else if (encodingID == 3) str = bin.readUnicode(data, soff, slen / 2);\n      else if (encodingID == 4) str = bin.readUnicode(data, soff, slen / 2);\n      else if (encodingID == 5) str = bin.readUnicode(data, soff, slen / 2);\n      else if (encodingID == 10) str = bin.readUnicode(data, soff, slen / 2);\n\n      else if (platformID == 1) { str = bin.readASCII(data, soff, slen); console.log(\"reading unknown MAC encoding \" + encodingID + \" as ASCII\"); }\n      else {\n        console.log(\"unknown encoding \" + encodingID + \", platformID: \" + platformID);\n        str = bin.readASCII(data, soff, slen);\n      }\n\n      var tid = \"p\" + platformID + \",\" + (languageID).toString(16);//Typr._platforms[platformID];\n      if (obj[tid] == null) obj[tid] = {};\n      var name = names[nameID]; if (name == null) name = \"_\" + nameID;\n      obj[tid][name] = str;\n      obj[tid][\"_lang\"] = languageID;\n      //console.log(tid, obj[tid]);\n    }\n    /*\n    if(format == 1)\n    {\n      var langTagCount = bin.readUshort(data, offset);  offset += 2;\n      for(var i=0; i<langTagCount; i++)\n      {\n        var length  = bin.readUshort(data, offset);  offset += 2;\n        var noffset = bin.readUshort(data, offset);  offset += 2;\n      }\n    }\n    */\n    var out = Typr[\"T\"].name.selectOne(obj), ff = \"fontFamily\";\n    if (out[ff] == null) for (var p in obj) if (obj[p][ff] != null) out[ff] = obj[p][ff];\n    return out;\n  },\n  selectOne: function (obj) {\n    //console.log(obj);\n    var psn = \"postScriptName\";\n\n    for (var p in obj) if (obj[p][psn] != null && obj[p][\"_lang\"] == 0x0409) return obj[p];\t\t// United States\n    for (var p in obj) if (obj[p][psn] != null && obj[p][\"_lang\"] == 0x0000) return obj[p];\t\t// Universal\n    for (var p in obj) if (obj[p][psn] != null && obj[p][\"_lang\"] == 0x0c0c) return obj[p];\t\t// Canada\n    for (var p in obj) if (obj[p][psn] != null) return obj[p];\n\n    var out;\n    for (var p in obj) { out = obj[p]; break; }\n    console.log(\"returning name table with languageID \" + out._lang);\n    if (out[psn] == null && out[\"ID\"] != null) out[psn] = out[\"ID\"];\n    return out;\n  }\n};\n\nTypr[\"T\"].OS2 = {\n  parseTab: function (data, offset, length) {\n    var bin = Typr[\"B\"];\n    var ver = bin.readUshort(data, offset); offset += 2;\n\n    var OS2 = Typr[\"T\"].OS2;\n\n    var obj = {};\n    if (ver == 0) OS2.version0(data, offset, obj);\n    else if (ver == 1) OS2.version1(data, offset, obj);\n    else if (ver == 2 || ver == 3 || ver == 4) OS2.version2(data, offset, obj);\n    else if (ver == 5) OS2.version5(data, offset, obj);\n    else throw \"unknown OS/2 table version: \" + ver;\n\n    return obj;\n  },\n\n  version0: function (data, offset, obj) {\n    var bin = Typr[\"B\"];\n    obj[\"xAvgCharWidth\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"usWeightClass\"] = bin.readUshort(data, offset); offset += 2;\n    obj[\"usWidthClass\"] = bin.readUshort(data, offset); offset += 2;\n    obj[\"fsType\"] = bin.readUshort(data, offset); offset += 2;\n    obj[\"ySubscriptXSize\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"ySubscriptYSize\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"ySubscriptXOffset\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"ySubscriptYOffset\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"ySuperscriptXSize\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"ySuperscriptYSize\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"ySuperscriptXOffset\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"ySuperscriptYOffset\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"yStrikeoutSize\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"yStrikeoutPosition\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"sFamilyClass\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"panose\"] = bin.readBytes(data, offset, 10); offset += 10;\n    obj[\"ulUnicodeRange1\"] = bin.readUint(data, offset); offset += 4;\n    obj[\"ulUnicodeRange2\"] = bin.readUint(data, offset); offset += 4;\n    obj[\"ulUnicodeRange3\"] = bin.readUint(data, offset); offset += 4;\n    obj[\"ulUnicodeRange4\"] = bin.readUint(data, offset); offset += 4;\n    obj[\"achVendID\"] = bin.readASCII(data, offset, 4); offset += 4;\n    obj[\"fsSelection\"] = bin.readUshort(data, offset); offset += 2;\n    obj[\"usFirstCharIndex\"] = bin.readUshort(data, offset); offset += 2;\n    obj[\"usLastCharIndex\"] = bin.readUshort(data, offset); offset += 2;\n    obj[\"sTypoAscender\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"sTypoDescender\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"sTypoLineGap\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"usWinAscent\"] = bin.readUshort(data, offset); offset += 2;\n    obj[\"usWinDescent\"] = bin.readUshort(data, offset); offset += 2;\n    return offset;\n  },\n\n  version1: function (data, offset, obj) {\n    var bin = Typr[\"B\"];\n    offset = Typr[\"T\"].OS2.version0(data, offset, obj);\n\n    obj[\"ulCodePageRange1\"] = bin.readUint(data, offset); offset += 4;\n    obj[\"ulCodePageRange2\"] = bin.readUint(data, offset); offset += 4;\n    return offset;\n  },\n\n  version2: function (data, offset, obj) {\n    var bin = Typr[\"B\"], rU = bin.readUshort;\n    offset = Typr[\"T\"].OS2.version1(data, offset, obj);\n\n    obj[\"sxHeight\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"sCapHeight\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"usDefault\"] = rU(data, offset); offset += 2;\n    obj[\"usBreak\"] = rU(data, offset); offset += 2;\n    obj[\"usMaxContext\"] = rU(data, offset); offset += 2;\n    return offset;\n  },\n\n  version5: function (data, offset, obj) {\n    var rU = Typr[\"B\"].readUshort;\n    offset = Typr[\"T\"].OS2.version2(data, offset, obj);\n\n    obj[\"usLowerOpticalPointSize\"] = rU(data, offset); offset += 2;\n    obj[\"usUpperOpticalPointSize\"] = rU(data, offset); offset += 2;\n    return offset;\n  }\n};\n\nTypr[\"T\"].post = {\n  parseTab: function (data, offset, length) {\n    var bin = Typr[\"B\"];\n    var obj = {};\n\n    obj[\"version\"] = bin.readFixed(data, offset); offset += 4;\n    obj[\"italicAngle\"] = bin.readFixed(data, offset); offset += 4;\n    obj[\"underlinePosition\"] = bin.readShort(data, offset); offset += 2;\n    obj[\"underlineThickness\"] = bin.readShort(data, offset); offset += 2;\n\n    return obj;\n  }\n};\nTypr[\"T\"].SVG = {\n  parseTab: function (data, offset, length) {\n    var bin = Typr[\"B\"];\n    var obj = { entries: [], svgs: [] };\n\n    var offset0 = offset;\n\n    bin.readUshort(data, offset); offset += 2;\n    var svgDocIndexOffset = bin.readUint(data, offset); offset += 4;\n    bin.readUint(data, offset); offset += 4;\n\n    offset = svgDocIndexOffset + offset0;\n\n    var numEntries = bin.readUshort(data, offset); offset += 2;\n\n    for (var i = 0; i < numEntries; i++) {\n      var startGlyphID = bin.readUshort(data, offset); offset += 2;\n      var endGlyphID = bin.readUshort(data, offset); offset += 2;\n      var svgDocOffset = bin.readUint(data, offset); offset += 4;\n      var svgDocLength = bin.readUint(data, offset); offset += 4;\n\n      var sbuf = new Uint8Array(data.buffer, offset0 + svgDocOffset + svgDocIndexOffset, svgDocLength);\n      if (sbuf[0] == 0x1f && sbuf[1] == 0x8b && sbuf[2] == 0x08) sbuf = pako[\"inflate\"](sbuf);\n      var svg = bin.readUTF8(sbuf, 0, sbuf.length);\n\n      for (var f = startGlyphID; f <= endGlyphID; f++) {\n        obj.entries[f] = obj.svgs.length;\n      }\n      obj.svgs.push(svg);\n    }\n    return obj;\n  }\n};\n\n\nTypr[\"T\"].sbix = {\n  parseTab: function (data, offset, length, obj) {\n    var numGlyphs = obj[\"maxp\"][\"numGlyphs\"];\n    var ooff = offset;\n    var bin = Typr[\"B\"];\n\n    //var ver = bin.readUshort(data,offset);  offset+=2;\n    //var flg = bin.readUshort(data,offset);  offset+=2;\n\n    var numStrikes = bin.readUint(data, offset + 4);\n\n    var out = [];\n    for (var si = numStrikes - 1; si < numStrikes; si++) {\n      var off = ooff + bin.readUint(data, offset + 8 + si * 4);\n\n      //var ppem = bin.readUshort(data,off);  off+=2;\n      //var ppi  = bin.readUshort(data,off);  off+=2;\n\n      for (var gi = 0; gi < numGlyphs; gi++) {\n        var aoff = bin.readUint(data, off + 4 + gi * 4);\n        var noff = bin.readUint(data, off + 4 + gi * 4 + 4); if (aoff == noff) { out[gi] = null; continue; }\n        var go = off + aoff;\n        //var ooX = bin.readUshort(data,go);\n        //var ooY = bin.readUshort(data,go+2);\n        var tag = bin.readASCII(data, go + 4, 4); if (tag != \"png \") throw tag;\n\n        out[gi] = new Uint8Array(data.buffer, data.byteOffset + go + 8, noff - aoff - 8);\n      }\n    }\n    return out;\n  }\n};\n\nTypr[\"T\"].colr = {\n  parseTab: function (data, offset, length) {\n    var bin = Typr[\"B\"];\n    var ooff = offset;\n    offset += 2;\n    var num = bin.readUshort(data, offset); offset += 2;\n\n    var boff = bin.readUint(data, offset); offset += 4;\n    var loff = bin.readUint(data, offset); offset += 4;\n\n    var lnum = bin.readUshort(data, offset); offset += 2;\n    //console.log(num,boff,loff,lnum);\n\n    var base = {};\n    var coff = ooff + boff;\n    for (var i = 0; i < num; i++) {\n      base[\"g\" + bin.readUshort(data, coff)] = [bin.readUshort(data, coff + 2), bin.readUshort(data, coff + 4)];\n      coff += 6;\n    }\n\n    var lays = [];\n    coff = ooff + loff;\n    for (var i = 0; i < lnum; i++) {\n      lays.push(bin.readUshort(data, coff), bin.readUshort(data, coff + 2)); coff += 4;\n    }\n    return [base, lays];\n  }\n};\n\nTypr[\"T\"].cpal = {\n  parseTab: function (data, offset, length) {\n    var bin = Typr[\"B\"];\n    var ooff = offset;\n    var vsn = bin.readUshort(data, offset); offset += 2;\n\n    if (vsn == 0) {\n      bin.readUshort(data, offset); offset += 2;\n      bin.readUshort(data, offset); offset += 2;\n      var tot = bin.readUshort(data, offset); offset += 2;\n\n      var fst = bin.readUint(data, offset); offset += 4;\n\n      return new Uint8Array(data.buffer, ooff + fst, tot * 4);\n      /*\n      var coff=ooff+fst;\n\n      for(var i=0; i<tot; i++) {\n        console.log(data[coff],data[coff+1],data[coff+2],data[coff+3]);\n        coff+=4;\n      }\n\n      console.log(ets,pts,tot); */\n    }\n    else throw vsn;//console.log(\"unknown color palette\",vsn);\n  }\n};\n\nTypr[\"T\"].GSUB = {\n  parseTab: function (data, offset, length, obj) {\n    //console.log(obj.name.ID);\n\n    var bin = Typr[\"B\"], rU = bin.readUshort; bin.readUint;\n\n\n    var off = offset;\n    rU(data, off); off += 2;\n    rU(data, off); off += 2;\n    rU(data, off); off += 2;\n    var flO = rU(data, off); off += 2;\n    rU(data, off); off += 2;\n\n    //console.log(maj,min,slO,flO,llO);\n\n    off = offset + flO;\n\n    var fmap = {};\n    var cnt = rU(data, off); off += 2;\n    for (var i = 0; i < cnt; i++) {\n      var tag = bin.readASCII(data, off, 4); off += 4;\n      rU(data, off); off += 2;\n      fmap[tag] = true;\n    }\n    //console.log(fmap);\n    return fmap;\n  }\n};\n\nTypr[\"T\"].fvar = {\n  parseTab: function (data, offset, length, obj) {\n    var name = obj[\"name\"];\n    var off = offset;\n    var bin = Typr[\"B\"];\n    var axes = [], inst = [];\n\n    off += 8;\n    var acnt = bin.readUshort(data, off); off += 2;\n    off += 2;\n    var icnt = bin.readUshort(data, off); off += 2;\n    var isiz = bin.readUshort(data, off); off += 2;\n\n    for (var i = 0; i < acnt; i++) {\n      var tag = bin.readASCII(data, off, 4);\n      var min = bin.readFixed(data, off + 4);\n      var def = bin.readFixed(data, off + 8);\n      var max = bin.readFixed(data, off + 12);\n      var flg = bin.readUshort(data, off + 16);\n      var nid = bin.readUshort(data, off + 18);\n      axes.push([tag, min, def, max, flg, name[\"_\" + nid]]);\n      //console.log(tag,min,def,max,flg,nid);\n      off += 20;\n    }\n    for (var i = 0; i < icnt; i++) {\n      var snid = bin.readUshort(data, off), pnid = null;\n      var flg = bin.readUshort(data, off + 2);\n      var crd = []; for (var j = 0; j < acnt; j++) crd.push(bin.readFixed(data, off + 4 + j * 4));\n      off += 4 + acnt * 4;\n      if ((isiz & 3) == 2) { pnid = bin.readUshort(data, off); off += 2; }\n      inst.push([name[\"_\" + snid], flg, crd, pnid]);\n      //console.log(snid,flg, crd);\n    }\n\n    return [axes, inst];\n  }\n};\n\nTypr[\"T\"].gvar = (function () {\n\n  var EMBEDDED_PEAK_TUPLE = 0x8000;\n  var INTERMEDIATE_REGION = 0x4000;\n  var PRIVATE_POINT_NUMBERS = 0x2000;\n\n  var DELTAS_ARE_ZERO = 0x80;\n  var DELTAS_ARE_WORDS = 0x40;\n\n  var POINTS_ARE_WORDS = 0x80;\n\n  var SHARED_POINT_NUMBERS = 0x8000;\n\n  var bin = Typr[\"B\"];\n\n  function readTuple(data, o, acnt) {\n    var tup = []; for (var j = 0; j < acnt; j++) tup.push(bin.readF2dot14(data, o + j * 2));\n    return tup;\n  }\n\n  function readTupleVarHeader(data, off, vcnt, acnt, eoff) {\n    var out = [];\n    for (var j = 0; j < vcnt; j++) {\n      var dsiz = bin.readUshort(data, off); off += 2;\n      var tind = bin.readUshort(data, off), flag = tind & 0xf000; tind = tind & 0xfff; off += 2;\n      //console.log(j, dsiz,tind, flag.toString(16));\n\n      var peak = null, start = null, end = null;\n      if (flag & EMBEDDED_PEAK_TUPLE) { peak = readTuple(data, off, acnt); off += acnt * 2; }\n      if (flag & INTERMEDIATE_REGION) { start = readTuple(data, off, acnt); off += acnt * 2; }\n      if (flag & INTERMEDIATE_REGION) { end = readTuple(data, off, acnt); off += acnt * 2; }\n      out.push([dsiz, tind, flag, start, peak, end]);\n    }\n    return out;\n  }\n\n  // Packed \"point\" numbers\n  function readPointNumbers(data, off, gid) {\n    var cnt = data[off]; off++; if (cnt == 0) return [[], off];\n    if (127 < cnt) { cnt = ((cnt & 127) << 8) | data[off++]; }\n\n    //if(gid==116) console.log(\"---\",cnt);\n    var pts = [], last = 0;  // point number data runs\n    while (pts.length < cnt) {\n      var v = data[off]; off++;\n      var wds = (v & POINTS_ARE_WORDS) != 0; v = (v & 127) + 1;\n      //if(gid==116) console.log(\"-\",v);\n      for (var i = 0; i < v; i++) {\n        var dif = 0;\n        if (wds) { dif = bin.readUshort(data, off); off += 2; }\n        else { dif = data[off]; off++; }\n        //if(gid==116) console.log(dif);\n        last += dif;\n        pts.push(last);\n      }\n    }\n    //console.log(pts);\n    return [pts, off];\n\n\n    //throw \"e\";\n  }\n\n\n  function parseTab(data, offset, length, obj) {\n    var off = offset + 4;\n    var acnt = bin.readUshort(data, off); off += 2;\n    var tcnt = bin.readUshort(data, off); off += 2;\n    var toff = bin.readUint(data, off); off += 4;\n    var gcnt = bin.readUshort(data, off); off += 2;\n    bin.readUshort(data, off); off += 2;\n\n    var goff = bin.readUint(data, off); off += 4;\n\n    // glyphVariationDataOffsets\n    var offs = []; for (var i = 0; i < gcnt + 1; i++) offs.push(bin.readUint(data, off + i * 4));\n\n\n    // sharedTuples\n    var tups = [], mins = [], maxs = []; off = offset + toff;\n    for (var i = 0; i < tcnt; i++) {\n      var peak = readTuple(data, off + i * acnt * 2, acnt), imin = [], imax = []; tups.push(peak); mins.push(imin); maxs.push(imax);\n      for (var k = 0; k < acnt; k++) {\n        imin[k] = Math.min(peak[k], 0);\n        imax[k] = Math.max(peak[k], 0);\n      }\n    }\n    //console.log(tups);\n\n    //console.log(acnt,stcnt,stoff,gcnt,flgs,goff);\n\n    var i8 = new Int8Array(data.buffer);\n\n    // GlyphVariationData table array\n    var tabs = [];\n    for (var i = 0; i < gcnt; i++) {\n      //console.log(\"-------\",i);\n      off = offset + goff + offs[i];\n      // tupleVariationCount\n      var vcnt = bin.readUshort(data, off); off += 2;  //if((vcnt>>>12)!=0) throw \"e\";\n\n      var snum = vcnt & SHARED_POINT_NUMBERS; vcnt &= 0xfff;\n      //  offset to the serialized data\n      var soff = bin.readUshort(data, off); off += 2;\n\n      var hdr = readTupleVarHeader(data, off, vcnt, acnt);\n\n      var tab = []; tabs.push(tab);\n      // Serialized Data\n      off = offset + goff + offs[i] + soff;\n\n      var sind = null;\n      if (snum) {\n        var oo = readPointNumbers(data, off);\n        sind = oo[0]; off = oo[1];\n      }\n\n      for (var j = 0; j < vcnt; j++) {\n        var vr = hdr[j], end = off + vr[0];  //console.log(vr);  console.log(data.slice(off,off+vr[0]));\n\n        var ind = sind;\n        if (vr[2] & PRIVATE_POINT_NUMBERS) {\n          var oo = readPointNumbers(data, off);\n          ind = oo[0]; off = oo[1];\n        }\n        // read packed deltas (delta runs)\n        var ds = [];\n        while (off < end) {\n          var cb = data[off++];  // control byte;\n          var cnt = (cb & 0x3f) + 1;\n          if (cb & DELTAS_ARE_ZERO) { for (var k = 0; k < cnt; k++) ds.push(0); }\n          else if (cb & DELTAS_ARE_WORDS) { for (var k = 0; k < cnt; k++) ds.push(bin.readShort(data, off + k * 2)); off += cnt * 2; }\n          else { for (var k = 0; k < cnt; k++) ds.push(i8[off + k]); off += cnt; }\n        }\n        //if(ind) console.log(ind, ds);\n        var ti = vr[1];\n\n        tab.push([[\n          vr[3] ? vr[3] : mins[ti],\n          vr[4] ? vr[4] : tups[ti],\n          vr[5] ? vr[5] : maxs[ti]\n        ], ds, ind.length == 0 ? null : ind]);\n\n        if (ind.length != 0 && ind.length * 2 != ds.length) throw \"e\";\n        //if(i==116) console.log(ind, ds);\n      }\n    }\n    return tabs;\n  }\n\n  return { parseTab: parseTab };\n})();\n\nTypr[\"T\"].avar = {\n  parseTab: function (data, offset, length, obj) {\n    var off = offset;\n    var bin = Typr[\"B\"], out = [];\n\n    off += 6;\n    var acnt = bin.readUshort(data, off); off += 2;\n\n    for (var ai = 0; ai < acnt; ai++) {\n      var cnt = bin.readUshort(data, off); off += 2;\n      var poly = []; out.push(poly);\n      for (var i = 0; i < cnt; i++) {\n        var x = bin.readF2dot14(data, off);\n        var y = bin.readF2dot14(data, off + 2); off += 4;\n        poly.push(x, y);\n      }\n    }\n\n    return out;\n  }\n};\n\nTypr[\"T\"].HVAR = {\n  parseTab: function (data, offset, length, obj) {\n    var off = offset, oo = offset;\n    var bin = Typr[\"B\"];\n\n    //console.log(data.slice(off));\n    off += 4;\n\n    var varO = bin.readUint(data, off); off += 4;\n    var advO = bin.readUint(data, off); off += 4;\n    var lsbO = bin.readUint(data, off); off += 4;\n    var rsbO = bin.readUint(data, off); off += 4;\n    if (lsbO != 0 || rsbO != 0) throw lsbO;\n\n    //console.log(varO,advO,lsbO,rsbO);\n\n    off = oo + varO;  // item variation store\n\n    // ItemVariationStore\n    var ioff = off;\n\n    var fmt = bin.readUshort(data, off); off += 2; if (fmt != 1) throw \"e\";\n    var vregO = bin.readUint(data, off); off += 4;\n    // itemVariationDataCount\n    var vcnt = bin.readUshort(data, off); off += 2;\n\n    var offs = []; for (var i = 0; i < vcnt; i++) offs.push(bin.readUint(data, off + i * 4)); off += vcnt * 4;  //if(offs.length!=1) throw \"e\";\n    //console.log(vregO,vcnt,offs);\n\n    off = ioff + vregO;\n    var acnt = bin.readUshort(data, off); off += 2;\n    var rcnt = bin.readUshort(data, off); off += 2;\n\n    var regs = [];\n    for (var i = 0; i < rcnt; i++) {\n      var crd = [[], [], []]; regs.push(crd);\n      for (var j = 0; j < acnt; j++) {\n        crd[0].push(bin.readF2dot14(data, off + 0));\n        crd[1].push(bin.readF2dot14(data, off + 2));\n        crd[2].push(bin.readF2dot14(data, off + 4));\n        off += 6;\n      }\n    }\n    //console.log(acnt, rcnt, regs);\n\n\n    var i8 = new Int8Array(data.buffer);\n    var varStore = [];\n    for (var i = 0; i < offs.length; i++) {\n      // ItemVariationData\n      off = oo + varO + offs[i]; var vdata = []; varStore.push(vdata);\n      var icnt = bin.readUshort(data, off); off += 2;  // itemCount\n      var dcnt = bin.readUshort(data, off); off += 2; if (dcnt & 0x8000) throw \"e\";\n      var rcnt = bin.readUshort(data, off); off += 2;\n      var ixs = []; for (var j = 0; j < rcnt; j++) ixs.push(bin.readUshort(data, off + j * 2)); off += rcnt * 2;\n      //console.log(icnt,dcnt,rcnt,ixs);\n      //console.log(data.slice(off));\n\n      for (var k = 0; k < icnt; k++) {  // deltaSets\n        var deltaData = [];  //vdata.push(deltaData);\n        for (var ri = 0; ri < rcnt; ri++) {\n          deltaData.push(ri < dcnt ? bin.readShort(data, off) : i8[off]);\n          off += ri < dcnt ? 2 : 1;\n\n        }\n        var dd = new Array(regs.length); dd.fill(0); vdata.push(dd);\n        for (var j = 0; j < ixs.length; j++) dd[ixs[j]] = deltaData[j];\n      }\n    }\n\n    //console.log(varStore);\n\n    // VariationRegionList\n\n\n\n    off = oo + advO;  // advance widths\n\n    // DeltaSetIndexMap\n\n    var fmt = data[off++]; if (fmt != 0) throw \"e\";\n    var entryFormat = data[off++];\n\n    var mapCount = bin.readUshort(data, off); off += 2;\n\n    var INNER_INDEX_BIT_COUNT_MASK = 0x0f;\n    var MAP_ENTRY_SIZE_MASK = 0x30;\n    var entrySize = ((entryFormat & MAP_ENTRY_SIZE_MASK) >> 4) + 1;  //if(entrySize!=1) throw entrySize;\n\n    //console.log(fmt, entryFormat, mapCount, entrySize);\n\n    var dfs = [];\n    for (var i = 0; i < mapCount; i++) {\n      var entry = 0;\n      if (entrySize == 1) entry = data[off++];\n      else { entry = bin.readUshort(data, off); off += 2; }\n      var outerIndex = entry >> ((entryFormat & INNER_INDEX_BIT_COUNT_MASK) + 1);\n      var innerIndex = entry & ((1 << ((entryFormat & INNER_INDEX_BIT_COUNT_MASK) + 1)) - 1);\n      //map.push(outerIndex,innerIndex);\n      dfs.push(varStore[outerIndex][innerIndex]);\n      //console.log(outerIndex,innerIndex);\n      //console.log(i,varStore[outerIndex][innerIndex]);\n    }\n\n    return [regs, dfs];\n  }\n};\n\nTypr[\"U\"] = function () {\n  var P = {\n    MoveTo: function (p, x, y) { p.cmds.push(\"M\"); p.crds.push(x, y); },\n    LineTo: function (p, x, y) { p.cmds.push(\"L\"); p.crds.push(x, y); },\n    CurveTo: function (p, a, b, c, d, e, f) { p.cmds.push(\"C\"); p.crds.push(a, b, c, d, e, f); },\n    qCurveTo: function (p, a, b, c, d) { p.cmds.push(\"Q\"); p.crds.push(a, b, c, d); },\n    ClosePath: function (p) { p.cmds.push(\"Z\"); }\n  };\n\n  function getGlyphPosition(font, gls, i1, ltr) {\n    var g1 = gls[i1], g2 = gls[i1 + 1], kern = font[\"kern\"];\n    if (kern) {\n      var ind1 = kern.glyph1.indexOf(g1);\n      if (ind1 != -1) {\n        var ind2 = kern.rval[ind1].glyph2.indexOf(g2);\n        if (ind2 != -1) return [0, 0, kern.rval[ind1].vals[ind2], 0];\n      }\n    }\n    //console.log(\"no kern\");\n    return [0, 0, 0, 0];\n  }\n  function shape(font, str, prm) {\n    if (prm == null) prm = {};\n    prm[\"ltr\"]; prm[\"fts\"]; var axs = prm[\"axs\"];\n    if (font[\"fvar\"] && axs == null) axs = font[\"fvar\"][1][font[\"_index\"]][2];\n\n    var HVAR = font[\"HVAR\"];  //console.log(HVAR);\n    if (axs && HVAR) { axs = _normalizeAxis(font, axs); }  //console.log(S,axs);\n    var gls = [];\n    for (var i = 0; i < str.length; i++) {\n      var cc = str.codePointAt(i); if (cc > 0xffff) i++;\n      gls.push(codeToGlyph(font, cc));\n    }\n    var shape = [];\n\n    for (var i = 0; i < gls.length; i++) {\n      var padj = getGlyphPosition(font, gls, i);\n      var gid = gls[i];  //console.log(gid);\n      var ax = font[\"hmtx\"].aWidth[gid] + padj[2];\n      if (HVAR && HVAR[1][gid]) { //ax+=S*HVAR[1][gid][0];\n        var difs = HVAR[1][gid];  //console.log(difs);\n        for (var j = 0; j < HVAR[0].length; j++) {\n          ax += _interpolate(HVAR[0][j], axs) * difs[j];\n        }\n      }\n      shape.push({ \"g\": gid, \"cl\": i, \"dx\": 0, \"dy\": 0, \"ax\": ax, \"ay\": 0 });\n    }\n    return shape;\n  }\n\n  function shapeToPath(font, shape, prm) {\n    var tpath = { cmds: [], crds: [] };\n    var x = 0, y = 0, clr, axs;\n    if (prm) { clr = prm[\"clr\"]; axs = prm[\"axs\"]; }\n\n    for (var i = 0; i < shape.length; i++) {\n      var it = shape[i];\n      var path = glyphToPath(font, it[\"g\"], false, axs), crds = path[\"crds\"];\n      for (var j = 0; j < crds.length; j += 2) {\n        tpath.crds.push(crds[j] + x + it[\"dx\"]);\n        tpath.crds.push(crds[j + 1] + y + it[\"dy\"]);\n      }\n      if (clr) tpath.cmds.push(clr);\n      for (var j = 0; j < path[\"cmds\"].length; j++) tpath.cmds.push(path[\"cmds\"][j]);\n      var clen = tpath.cmds.length;\n      if (clr) if (clen != 0 && tpath.cmds[clen - 1] != \"X\") tpath.cmds.push(\"X\");  // SVG fonts might contain \"X\". Then, nothing would stroke non-SVG glyphs.\n\n      x += it[\"ax\"]; y += it[\"ay\"];\n    }\n    return { \"cmds\": tpath.cmds, \"crds\": tpath.crds };\n  }\n\n\n  // find the greatest index with a value <=v\n  function arrSearch(arr, k, v) {\n    var l = 0, r = ~~(arr.length / k);\n    while (l + 1 != r) { var mid = l + ((r - l) >>> 1); if (arr[mid * k] <= v) l = mid; else r = mid; }\n\n    //var mi = 0;  for(var i=0; i<arr.length; i+=k) if(arr[i]<=v) mi=i;  if(mi!=l*k) throw \"e\";\n\n    return l * k;\n  }\n\n  var wha = [0x9, 0xa, 0xb, 0xc, 0xd, 0x20, 0x85, 0xa0, 0x1680, 0x180e, 0x2028, 0x2029, 0x202f, 0x2060, 0x3000, 0xfeff], whm = {};\n  for (var i = 0; i < wha.length; i++) whm[wha[i]] = 1;\n  for (var i = 0x2000; i <= 0x200d; i++) whm[i] = 1;\n\n  function codeToGlyph(font, code) {\n    //console.log(cmap);\n    // \"p3e10\" for NotoEmoji-Regular.ttf\n    //console.log(cmap);\n\n    if (font[\"_ctab\"] == null) {\n      var cmap = font[\"cmap\"];\n      var tind = -1, pps = [\"p3e10\", \"p0e4\", \"p3e1\", \"p1e0\", \"p0e3\", \"p0e1\"/*,\"p3e3\"*/, \"p3e0\" /*Hebrew*/, \"p3e5\" /*Korean*/];\n      for (var i = 0; i < pps.length; i++) if (cmap.ids[pps[i]] != null) { tind = cmap.ids[pps[i]]; break; }\n      if (tind == -1) throw \"no familiar platform and encoding!\";\n      font[\"_ctab\"] = cmap.tables[tind];\n    }\n\n    var tab = font[\"_ctab\"], fmt = tab.format, gid = -1;  //console.log(fmt); throw \"e\";\n\n    if (fmt == 0) {\n      if (code >= tab.map.length) gid = 0;\n      else gid = tab.map[code];\n    }\n    /*else if(fmt==2) {\n      var data=font[\"_data\"], off = cmap.off+tab.off+6, bin=Typr[\"B\"];\n      var shKey = bin.readUshort(data,off + 2*(code>>>8));\n      var shInd = off + 256*2 + shKey*8;\n\n      var firstCode = bin.readUshort(data,shInd);\n      var entryCount= bin.readUshort(data,shInd+2);\n      var idDelta   = bin.readShort (data,shInd+4);\n      var idRangeOffset = bin.readUshort(data,shInd+6);\n\n      if(firstCode<=code && code<=firstCode+entryCount) {\n        // not completely correct\n        gid = bin.readUshort(data, shInd+6+idRangeOffset + (code&255)*2);\n      }\n      else gid=0;\n      //if(code>256) console.log(code,(code>>>8),shKey,firstCode,entryCount,idDelta,idRangeOffset);\n\n      //throw \"e\";\n      //console.log(tab,  bin.readUshort(data,off));\n      //throw \"e\";\n    }*/\n    else if (fmt == 4) {\n      var ec = tab.endCount; gid = 0;\n      if (code <= ec[ec.length - 1]) {\n        // smallest index with code <= value\n        var sind = arrSearch(ec, 1, code);\n        if (ec[sind] < code) sind++;\n\n        if (code >= tab.startCount[sind]) {\n          var gli = 0;\n          if (tab.idRangeOffset[sind] != 0) gli = tab.glyphIdArray[(code - tab.startCount[sind]) + (tab.idRangeOffset[sind] >> 1) - (tab.idRangeOffset.length - sind)];\n          else gli = code + tab.idDelta[sind];\n          gid = (gli & 0xFFFF);\n        }\n      }\n    }\n    else if (fmt == 6) {\n      var off = code - tab.firstCode, arr = tab.glyphIdArray;\n      if (off < 0 || off >= arr.length) gid = 0;\n      else gid = arr[off];\n    }\n    else if (fmt == 12) {\n      var grp = tab.groups; gid = 0;  //console.log(grp);  throw \"e\";\n\n      if (code <= grp[grp.length - 2]) {\n        var i = arrSearch(grp, 3, code);\n        if (grp[i] <= code && code <= grp[i + 1]) { gid = grp[i + 2] + (code - grp[i]); }\n      }\n    }\n    else throw \"unknown cmap table format \" + tab.format;\n\n    //*\n    var SVG = font[\"SVG \"], loca = font[\"loca\"];\n    // if the font claims to have a Glyph for a character, but the glyph is empty, and the character is not \"white\", it is a lie!\n    if (gid != 0 && font[\"CFF \"] == null && (SVG == null || SVG.entries[gid] == null) && loca && loca[gid] == loca[gid + 1]  // loca not present in CFF or SVG fonts\n      && whm[code] == null) gid = 0;\n    //*/\n\n    return gid;\n  }\n  function glyphToPath(font, gid, noColor, axs) {\n    var path = { cmds: [], crds: [] };\n\n    if (font[\"fvar\"]) {\n      if (axs == null) axs = font[\"fvar\"][1][font[\"_index\"]][2];\n      axs = _normalizeAxis(font, axs);\n    }\n\n    var SVG = font[\"SVG \"], CFF = font[\"CFF \"], COLR = font[\"COLR\"], CBLC = font[\"CBLC\"], CBDT = font[\"CBDT\"], sbix = font[\"sbix\"], upng = window[\"UPNG\"];\n\n    var strike = null;\n    if (CBLC && upng) for (var i = 0; i < CBLC.length; i++) if (CBLC[i][0] <= gid && gid <= CBLC[i][1]) strike = CBLC[i];\n\n    if (strike || (sbix && sbix[gid])) {\n      if (strike && strike[2] != 17) throw \"not a PNG\";\n\n      if (font[\"__tmp\"] == null) font[\"__tmp\"] = {};\n      var cmd = font[\"__tmp\"][\"g\" + gid];\n      if (cmd == null) {\n        var bmp, len;\n        if (sbix) { bmp = sbix[gid]; len = bmp.length; }\n        else {\n          var boff = strike[3][gid - strike[0]] + 5;  // smallGlyphMetrics\n          len = (CBDT[boff + 1] << 16) | (CBDT[boff + 2] << 8) | CBDT[boff + 3]; boff += 4;\n          bmp = new Uint8Array(CBDT.buffer, CBDT.byteOffset + boff, len);\n        }\n        var str = \"\"; for (var i = 0; i < len; i++) str += String.fromCharCode(bmp[i]);\n        cmd = font[\"__tmp\"][\"g\" + gid] = \"data:image/png;base64,\" + btoa(str);\n      }\n\n      path.cmds.push(cmd);\n      var upe = font[\"head\"][\"unitsPerEm\"] * 1.15;\n      var gw = Math.round(upe), gh = Math.round(upe), dy = Math.round(-gh * 0.15);\n      path.crds.push(0, gh + dy, gw, gh + dy, gw, dy, 0, dy); //*/\n    }\n    else if (SVG && SVG.entries[gid]) {\n      var p = SVG.entries[gid];\n      if (p != null) {\n        if (typeof p == \"number\") {\n          var svg = SVG.svgs[p];\n          if (typeof svg == \"string\") {\n            var prsr = new DOMParser();\n            var doc = prsr[\"parseFromString\"](svg, \"image/svg+xml\");\n            svg = SVG.svgs[p] = doc.getElementsByTagName(\"svg\")[0];\n          }\n          p = Typr[\"U\"][\"SVG\"].toPath(svg, gid); SVG.entries[gid] = p;\n        }\n        path = p;\n      }\n    }\n    else if (noColor != true && COLR && COLR[0][\"g\" + gid] && COLR[0][\"g\" + gid][1] > 1) {\n\n      function toHex(n) { var o = n.toString(16); return (o.length == 1 ? \"0\" : \"\") + o; }\n\n      var CPAL = font[\"CPAL\"], gl = COLR[0][\"g\" + gid];\n      for (var i = 0; i < gl[1]; i++) {\n        var lid = gl[0] + i;\n        var cgl = COLR[1][2 * lid], pid = COLR[1][2 * lid + 1] * 4;\n        var pth = glyphToPath(font, cgl, cgl == gid);\n\n        var col = \"#\" + toHex(CPAL[pid + 2]) + toHex(CPAL[pid + 1]) + toHex(CPAL[pid + 0]);\n        path.cmds.push(col);\n\n        path.cmds = path.cmds.concat(pth[\"cmds\"]);\n        path.crds = path.crds.concat(pth[\"crds\"]);\n        //console.log(gid, cgl,pid,col);\n\n        path.cmds.push(\"X\");\n      }\n    }\n    else if (CFF) {\n      var pdct = CFF[\"Private\"];\n      var state = { x: 0, y: 0, stack: [], nStems: 0, haveWidth: false, width: pdct ? pdct[\"defaultWidthX\"] : 0, open: false };\n      if (CFF[\"ROS\"]) {\n        var gi = 0;\n        while (CFF[\"FDSelect\"][gi + 2] <= gid) gi += 2;\n        pdct = CFF[\"FDArray\"][CFF[\"FDSelect\"][gi + 1]][\"Private\"];\n      }\n      _drawCFF(CFF[\"CharStrings\"][gid], state, CFF, pdct, path);\n    }\n    else if (font[\"glyf\"]) { _drawGlyf(gid, font, path, axs); }\n    return { \"cmds\": path.cmds, \"crds\": path.crds };\n  }\n\n  function _drawGlyf(gid, font, path, axs) {\n    var gl = font[\"glyf\"][gid];\n\n    if (gl == null) gl = font[\"glyf\"][gid] = Typr[\"T\"].glyf._parseGlyf(font, gid);\n    if (gl != null) {\n      if (gl.noc > -1) _simpleGlyph(gl, font, gid, path, axs);\n      else _compoGlyph(gl, font, gid, path, axs);\n    }\n  }\n  function _interpolate(axs, v) {\n    v.length; var S = 1;\n    var s = axs[0];  // start\n    var p = axs[1];  // peak\n    var e = axs[2];  // end\n\n    for (var i = 0; i < v.length; i++) {\n      var AS = 1;\n      if (s[i] > p[i] || p[i] > e[i]) AS = 1;\n      else if (s[i] < 0 && e[i] > 0 && p[i] != 0) AS = 1;\n      else if (p[i] == 0) AS = 1;\n      else if (v[i] < s[i] || v[i] > e[i]) AS = 0;\n      else {\n        if (v[i] == p[i]) AS = 1;\n        else if (v[i] < p[i]) AS = (v[i] - s[i]) / (p[i] - s[i]);\n        else AS = (e[i] - v[i]) / (e[i] - p[i]);\n      }\n      S = S * AS;\n    }\n    return S;\n  }\n  function _normalizeAxis(font, vv) {\n    var fvar = font[\"fvar\"], avar = font[\"avar\"];\n    var fv = fvar ? fvar[0] : null;\n\n    var nv = [];\n    for (var i = 0; i < fv.length; i++) {\n      var min = fv[i][1], def = fv[i][2], max = fv[i][3], v = Math.max(min, Math.min(max, vv[i]));\n      if (v < def) nv[i] = (def - v) / (min - def);\n      else if (v > def) nv[i] = (v - def) / (max - def);\n      else nv[i] = 0;\n\n      if (avar && nv[i] != -1) {\n        var av = avar[i], j = 0;\n        for (; j < av.length; j += 2) if (av[j] >= nv[i]) break;\n        var f = (nv[i] - av[j - 2]) / (av[j] - av[j - 2]);\n        nv[i] = f * av[j + 1] + (1 - f) * av[j - 1];\n      }\n\n    }\n    return nv;\n  }\n  function interpolateDeltas(dfs, ind, xs, ys, endPts) {\n    var N = xs.length, ndfs = new Array(N * 2 + 8); ndfs.fill(0);\n    for (var i = 0; i < N; i++) {\n      var dx = 0, dy = 0, ii = ind.indexOf(i);\n      if (ii != -1) { dx = dfs[ii]; dy = dfs[ind.length + ii]; }\n      else {\n        var cmp = 0; while (endPts[cmp] < i) cmp++;\n        var cmp0 = cmp == 0 ? 0 : endPts[cmp - 1] + 1;\n        var cmp1 = endPts[cmp];\n\n        var i0 = -1, i1 = -1;\n\n        for (var j = 0; j < ind.length; j++) { var v = ind[j]; if (v < cmp0 || v > cmp1 || v >= N) continue; i0 = j; if (i1 == -1) i1 = j; }\n        for (var j = 0; j < ind.length; j++) { var v = ind[j]; if (v < cmp0 || v > cmp1 || v >= N) continue; if (v < i) i0 = j; if (i < v) { i1 = j; break; } }\n\n        //var i0 = ind.length-1, i1=0;  if(ind[i0]>=N) i0--;\n        //for(var j=0; j<ind.length; j++) {  var v=ind[j];  if(v<N) { if(v<i) i0=j;  if(i<v) {  i1=j;  break;  }  }  }\n        for (var ax = 0; ax < 2; ax++) {\n          var crd = ax == 0 ? xs : ys, ofs = ax * ind.length, dlt = 0;\n          var c0 = crd[ind[i0]], c1 = crd[ind[i1]], cC = crd[i];\n          var d0 = dfs[ofs + i0], d1 = dfs[ofs + i1];\n\n          if (c0 == c1) {\n            if (d0 == d1) dlt = d0;\n            else dlt = 0;\n          }\n          else {\n            if (cC <= Math.min(c0, c1)) {\n              if (c0 < c1) dlt = d0;\n              else dlt = d1;\n            }\n            else if (Math.max(c0, c1) <= cC) {\n              if (c0 < c1) dlt = d1;\n              else dlt = d0;\n            }\n            else {\n              var prop = (cC - c0) / (c1 - c0);  //if(prop<0) throw \"e\";\n              dlt = prop * d1 + (1 - prop) * d0;\n            }\n          }\n          if (ax == 0) dx = dlt; else dy = dlt;\n        }\n      }\n      ndfs[i] = dx; ndfs[N + 4 + i] = dy;\n    }\n    return ndfs;\n  }\n  function _simpleGlyph(gl, font, gid, p, axs) {\n    var xs = gl.xs, ys = gl.ys;\n    //*\n    if (font[\"fvar\"] && axs) {\n      xs = xs.slice(0); ys = ys.slice(0);\n      var gvar = font[\"gvar\"];\n      var gv = gvar ? gvar[gid] : null;\n\n      for (var vi = 0; vi < gv.length; vi++) {\n        var axv = gv[vi][0];  //console.log(axs);\n        var S = _interpolate(axv, axs); if (S < 1e-9) continue;\n        var dfs = gv[vi][1], ind = gv[vi][2];  //if(dfs.length!=2*xs.length+8) throw \"e\";\n        //console.log(vi,S,axv,ind,dfs);\n        if (ind) { dfs = gv[vi][1] = interpolateDeltas(dfs, ind, xs, ys, gl.endPts); gv[vi][2] = null; }\n        //if(ind==null)\n        if (dfs.length == xs.length * 2 + 8)\n          for (var i = 0; i < xs.length; i++) {\n            xs[i] += S * dfs[i];\n            ys[i] += S * dfs[i + xs.length + 4];\n          }\n      }\n    } //*/\n\n    for (var c = 0; c < gl.noc; c++) {\n      var i0 = (c == 0) ? 0 : (gl.endPts[c - 1] + 1);\n      var il = gl.endPts[c];\n\n      for (var i = i0; i <= il; i++) {\n        var pr = (i == i0) ? il : (i - 1);\n        var nx = (i == il) ? i0 : (i + 1);\n        var onCurve = gl.flags[i] & 1;\n        var prOnCurve = gl.flags[pr] & 1;\n        var nxOnCurve = gl.flags[nx] & 1;\n\n        var x = xs[i], y = ys[i];\n\n        if (i == i0) {\n          if (onCurve) {\n            if (prOnCurve) P.MoveTo(p, xs[pr], ys[pr]);\n            else { P.MoveTo(p, x, y); continue;  /*  will do CurveTo at il  */ }\n          }\n          else {\n            if (prOnCurve) P.MoveTo(p, xs[pr], ys[pr]);\n            else P.MoveTo(p, Math.floor((xs[pr] + x) * 0.5), Math.floor((ys[pr] + y) * 0.5));\n          }\n        }\n        if (onCurve) {\n          if (prOnCurve) P.LineTo(p, x, y);\n        }\n        else {\n          if (nxOnCurve) P.qCurveTo(p, x, y, xs[nx], ys[nx]);\n          else P.qCurveTo(p, x, y, Math.floor((x + xs[nx]) * 0.5), Math.floor((y + ys[nx]) * 0.5));\n        }\n      }\n      P.ClosePath(p);\n    }\n  }\n  function _compoGlyph(gl, font, gid, p, axs) {\n\n    var dx = [0, 0, 0, 0, 0, 0], dy = [0, 0, 0, 0, 0, 0], ccnt = gl.parts.length;\n\n    if (font[\"fvar\"] && axs) {\n      var gvar = font[\"gvar\"];\n      var gv = gvar ? gvar[gid] : null;\n      for (var vi = 0; vi < gv.length; vi++) {\n        var axv = gv[vi][0];  //console.log(axs);\n        var S = _interpolate(axv, axs); if (S < 1e-6) continue;\n        var dfs = gv[vi][1], ind = gv[vi][2];  //if(dfs.length!=2*ccnt+8) throw \"e\";\n        if (ind == null)\n          for (var i = 0; i < ccnt; i++) {\n            dx[i] += S * dfs[i];\n            dy[i] += S * dfs[i + ccnt + 4];\n          }\n        else\n          for (var j = 0; j < ind.length; j++) {\n            var i = ind[j];\n            dx[i] += S * dfs[0];\n            dy[i] += S * dfs[0 + ccnt];\n          }\n      }\n    }\n\n    for (var j = 0; j < ccnt; j++) {\n      var path = { cmds: [], crds: [] };\n      var prt = gl.parts[j];\n      _drawGlyf(prt.glyphIndex, font, path, axs);\n\n      var m = prt.m, tx = m.tx + dx[j], ty = m.ty + dy[j];\n      for (var i = 0; i < path.crds.length; i += 2) {\n        var x = path.crds[i], y = path.crds[i + 1];\n        p.crds.push(x * m.a + y * m.c + tx);   // not sure, probably right\n        p.crds.push(x * m.b + y * m.d + ty);\n      }\n      for (var i = 0; i < path.cmds.length; i++) p.cmds.push(path.cmds[i]);\n    }\n  }\n\n  function pathToSVG(path, prec) {\n    var cmds = path[\"cmds\"], crds = path[\"crds\"];\n    if (prec == null) prec = 5;\n    function num(v) { return parseFloat(v.toFixed(prec)); }\n    function merge(o) {\n      var no = [], lstF = false, lstC = \"\";\n      for (var i = 0; i < o.length; i++) {\n        var it = o[i], isF = (typeof it) == \"number\";\n        if (!isF) { if (it == lstC && it.length == 1 && it != \"m\") continue; lstC = it; }  // move should not be merged (it actually means lineTo)\n        if (lstF && isF && it >= 0) no.push(\" \");\n        no.push(it); lstF = isF;\n      }\n      return no.join(\"\");\n    }\n\n\n    var out = [], co = 0, lmap = { \"M\": 2, \"L\": 2, \"Q\": 4, \"C\": 6 };\n    var x = 0, y = 0, // perfect coords\n      //dx=0, dy=0, // relative perfect coords\n      //rx=0, ry=0, // relative rounded coords\n      ex = 0, ey = 0, // error between perfect and output coords\n      mx = 0, my = 0; // perfect coords of the last \"Move\"\n\n    for (var i = 0; i < cmds.length; i++) {\n      var cmd = cmds[i], cc = (lmap[cmd] ? lmap[cmd] : 0);\n\n      var o0 = [], dx, dy, rx, ry;  // o1=[], cx, cy, ax,ay;\n      if (cmd == \"L\") {\n        dx = crds[co] - x; dy = crds[co + 1] - y;\n        rx = num(dx + ex); ry = num(dy + ey);\n        // if this \"lineTo\" leads to the starting point, and \"Z\" follows, do not output anything.\n        if (cmds[i + 1] == \"Z\" && crds[co] == mx && crds[co + 1] == my) { rx = dx; ry = dy; }\n        else if (rx == 0 && ry == 0) ;\n        else if (rx == 0) o0.push(\"v\", ry);\n        else if (ry == 0) o0.push(\"h\", rx);\n        else { o0.push(\"l\", rx, ry); }\n      }\n      else {\n        o0.push(cmd.toLowerCase());\n        for (var j = 0; j < cc; j += 2) {\n          dx = crds[co + j] - x; dy = crds[co + j + 1] - y;\n          rx = num(dx + ex); ry = num(dy + ey);\n          o0.push(rx, ry);\n        }\n      }\n      if (cc != 0) { ex += dx - rx; ey += dy - ry; }\n\n      var ou = o0;\n      for (var j = 0; j < ou.length; j++) out.push(ou[j]);\n\n      if (cc != 0) { co += cc; x = crds[co - 2]; y = crds[co - 1]; }\n      if (cmd == \"M\") { mx = x; my = y; }\n      if (cmd == \"Z\") { x = mx; y = my; }\n    }\n\n    return merge(out);\n  }\n  function SVGToPath(d) {\n    var pth = { cmds: [], crds: [] };\n    Typr[\"U\"][\"SVG\"].svgToPath(d, pth);\n    return { \"cmds\": pth.cmds, \"crds\": pth.crds };\n  }\n\n  function mipmapB(buff, w, h, hlp) {\n    var nw = w >> 1, nh = h >> 1;\n    var nbuf = new Uint8Array(nw * nh * 4);\n    var sb32 = new Uint32Array(buff.buffer), nb32 = new Uint32Array(nbuf.buffer);\n    for (var y = 0; y < nh; y++)\n      for (var x = 0; x < nw; x++) {\n        var ti = (y * nw + x), si = ((y << 1) * w + (x << 1));\n        //nbuf[ti  ] = buff[si  ];  nbuf[ti+1] = buff[si+1];  nbuf[ti+2] = buff[si+2];  nbuf[ti+3] = buff[si+3];\n        //*\n        var c0 = sb32[si], c1 = sb32[si + 1], c2 = sb32[si + w], c3 = sb32[si + w + 1];\n\n        var a0 = (c0 >>> 24), a1 = (c1 >>> 24), a2 = (c2 >>> 24), a3 = (c3 >>> 24), a = (a0 + a1 + a2 + a3);\n\n        if (a == 1020) {\n          var r = (((c0 >>> 0) & 255) + ((c1 >>> 0) & 255) + ((c2 >>> 0) & 255) + ((c3 >>> 0) & 255) + 2) >>> 2;\n          var g = (((c0 >>> 8) & 255) + ((c1 >>> 8) & 255) + ((c2 >>> 8) & 255) + ((c3 >>> 8) & 255) + 2) >>> 2;\n          var b = (((c0 >>> 16) & 255) + ((c1 >>> 16) & 255) + ((c2 >>> 16) & 255) + ((c3 >>> 16) & 255) + 2) >>> 2;\n          nb32[ti] = (255 << 24) | (b << 16) | (g << 8) | r;\n        }\n        else if (a == 0) nb32[ti] = 0;\n        else {\n          var r = ((c0 >>> 0) & 255) * a0 + ((c1 >>> 0) & 255) * a1 + ((c2 >>> 0) & 255) * a2 + ((c3 >>> 0) & 255) * a3;\n          var g = ((c0 >>> 8) & 255) * a0 + ((c1 >>> 8) & 255) * a1 + ((c2 >>> 8) & 255) * a2 + ((c3 >>> 8) & 255) * a3;\n          var b = ((c0 >>> 16) & 255) * a0 + ((c1 >>> 16) & 255) * a1 + ((c2 >>> 16) & 255) * a2 + ((c3 >>> 16) & 255) * a3;\n\n          var ia = 1 / a; r = ~~(r * ia + 0.5); g = ~~(g * ia + 0.5); b = ~~(b * ia + 0.5);\n          nb32[ti] = (((a + 2) >>> 2) << 24) | (b << 16) | (g << 8) | r;\n        }\n      }\n    return { buff: nbuf, w: nw, h: nh };\n  }\n\n  var __cnv, __ct;\n  function pathToContext(path, ctx) {\n    var c = 0, cmds = path[\"cmds\"], crds = path[\"crds\"];\n\n    //ctx.translate(3500,500);  ctx.rotate(0.25);  ctx.scale(1,-1);\n\n    for (var j = 0; j < cmds.length; j++) {\n      var cmd = cmds[j];\n      if (cmd == \"M\") {\n        ctx.moveTo(crds[c], crds[c + 1]);\n        c += 2;\n      }\n      else if (cmd == \"L\") {\n        ctx.lineTo(crds[c], crds[c + 1]);\n        c += 2;\n      }\n      else if (cmd == \"C\") {\n        ctx.bezierCurveTo(crds[c], crds[c + 1], crds[c + 2], crds[c + 3], crds[c + 4], crds[c + 5]);\n        c += 6;\n      }\n      else if (cmd == \"Q\") {\n        ctx.quadraticCurveTo(crds[c], crds[c + 1], crds[c + 2], crds[c + 3]);\n        c += 4;\n      }\n      else if (cmd[0] == \"d\") {\n        var upng = window[\"UPNG\"];\n        var x0 = crds[c], y0 = crds[c + 1], x1 = crds[c + 2], y1 = crds[c + 3], x2 = crds[c + 4], y2 = crds[c + 5], x3 = crds[c + 6], y3 = crds[c + 7]; c += 8;\n        //y0+=400;  y1+=400;  y1+=600;\n        if (upng == null) {\n          ctx.moveTo(x0, y0); ctx.lineTo(x1, y1); ctx.lineTo(x2, y2); ctx.lineTo(x3, y3); ctx.closePath();\n          continue;\n        }\n        var dx0 = (x1 - x0), dy0 = (y1 - y0), dx1 = (x3 - x0), dy1 = (y3 - y0);\n        var sbmp = atob(cmd.slice(22));\n        var bmp = new Uint8Array(sbmp.length);\n        for (var i = 0; i < sbmp.length; i++) bmp[i] = sbmp.charCodeAt(i);\n\n        var img = upng[\"decode\"](bmp.buffer), w = img[\"width\"], h = img[\"height\"];  //console.log(img);\n\n        var nbmp = new Uint8Array(upng[\"toRGBA8\"](img)[0]);\n        var tr = ctx[\"getTransform\"]();\n        var scl = Math.sqrt(Math.abs(tr[\"a\"] * tr[\"d\"] - tr[\"b\"] * tr[\"c\"])) * Math.sqrt(dx1 * dx1 + dy1 * dy1) / h;\n        while (scl < 0.5) {\n          var nd = mipmapB(nbmp, w, h);\n          nbmp = nd.buff; w = nd.w; h = nd.h; scl *= 2;\n        }\n\n        if (__cnv == null) { __cnv = document.createElement(\"canvas\"); __ct = __cnv.getContext(\"2d\"); }\n        if (__cnv.width != w || __cnv.height != h) { __cnv.width = w; __cnv.height = h; }\n\n        __ct.putImageData(new ImageData(new Uint8ClampedArray(nbmp.buffer), w, h), 0, 0);\n        ctx.save();\n        ctx.transform(dx0, dy0, dx1, dy1, x0, y0);\n        ctx.scale(1 / w, 1 / h);\n        ctx.drawImage(__cnv, 0, 0); //*/\n        ctx.restore();\n      }\n      else if (cmd.charAt(0) == \"#\" || cmd.charAt(0) == \"r\") {\n        ctx.beginPath();\n        ctx.fillStyle = cmd;\n      }\n      else if (cmd.charAt(0) == \"O\" && cmd != \"OX\") {\n        ctx.beginPath();\n        var pts = cmd.split(\"-\");\n        ctx.lineWidth = parseFloat(pts[2]);\n        ctx.lineCap = [\"butt\", \"round\", \"square\"][parseFloat(pts[3])];\n        ctx.lineJoin = [\"miter\", \"round\", \"bevel\"][parseFloat(pts[4])];\n        ctx.miterLimit = parseFloat(pts[5]);\n        ctx.lineDashOffset = parseFloat(pts[6]);\n        ctx.setLineDash(pts[7].split(\",\").map(parseFloat));\n        ctx.strokeStyle = pts[1];\n      }\n      else if (cmd == \"Z\") {\n        ctx.closePath();\n      }\n      else if (cmd == \"X\") {\n        ctx.fill();\n      }\n      else if (cmd == \"OX\") {\n        ctx.stroke();\n      }\n    }\n  }\n\n\n  function _drawCFF(cmds, state, font, pdct, p) {\n    var stack = state.stack;\n    var nStems = state.nStems, haveWidth = state.haveWidth, width = state.width, open = state.open;\n    var i = 0;\n    var x = state.x, y = state.y, c1x = 0, c1y = 0, c2x = 0, c2y = 0, c3x = 0, c3y = 0, c4x = 0, c4y = 0, jpx = 0, jpy = 0;\n    var CFF = Typr[\"T\"].CFF;\n\n    var nominalWidthX = pdct[\"nominalWidthX\"];\n    var o = { val: 0, size: 0 };\n    //console.log(cmds);\n    while (i < cmds.length) {\n      CFF.getCharString(cmds, i, o);\n      var v = o.val;\n      i += o.size;\n\n      if (v == \"o1\" || v == \"o18\")  //  hstem || hstemhm\n      {\n        var hasWidthArg;\n\n        // The number of stem operators on the stack is always even.\n        // If the value is uneven, that means a width is specified.\n        hasWidthArg = stack.length % 2 !== 0;\n        if (hasWidthArg && !haveWidth) {\n          width = stack.shift() + nominalWidthX;\n        }\n\n        nStems += stack.length >> 1;\n        stack.length = 0;\n        haveWidth = true;\n      }\n      else if (v == \"o3\" || v == \"o23\")  // vstem || vstemhm\n      {\n        var hasWidthArg;\n\n        // The number of stem operators on the stack is always even.\n        // If the value is uneven, that means a width is specified.\n        hasWidthArg = stack.length % 2 !== 0;\n        if (hasWidthArg && !haveWidth) {\n          width = stack.shift() + nominalWidthX;\n        }\n\n        nStems += stack.length >> 1;\n        stack.length = 0;\n        haveWidth = true;\n      }\n      else if (v == \"o4\") {\n        if (stack.length > 1 && !haveWidth) {\n          width = stack.shift() + nominalWidthX;\n          haveWidth = true;\n        }\n        if (open) P.ClosePath(p);\n\n        y += stack.pop();\n        P.MoveTo(p, x, y); open = true;\n      }\n      else if (v == \"o5\") {\n        while (stack.length > 0) {\n          x += stack.shift();\n          y += stack.shift();\n          P.LineTo(p, x, y);\n        }\n      }\n      else if (v == \"o6\" || v == \"o7\")  // hlineto || vlineto\n      {\n        var count = stack.length;\n        var isX = (v == \"o6\");\n\n        for (var j = 0; j < count; j++) {\n          var sval = stack.shift();\n\n          if (isX) x += sval; else y += sval;\n          isX = !isX;\n          P.LineTo(p, x, y);\n        }\n      }\n      else if (v == \"o8\" || v == \"o24\")\t// rrcurveto || rcurveline\n      {\n        var count = stack.length;\n        var index = 0;\n        while (index + 6 <= count) {\n          c1x = x + stack.shift();\n          c1y = y + stack.shift();\n          c2x = c1x + stack.shift();\n          c2y = c1y + stack.shift();\n          x = c2x + stack.shift();\n          y = c2y + stack.shift();\n          P.CurveTo(p, c1x, c1y, c2x, c2y, x, y);\n          index += 6;\n        }\n        if (v == \"o24\") {\n          x += stack.shift();\n          y += stack.shift();\n          P.LineTo(p, x, y);\n        }\n      }\n      else if (v == \"o11\") break;\n      else if (v == \"o1234\" || v == \"o1235\" || v == \"o1236\" || v == \"o1237\")//if((v+\"\").slice(0,3)==\"o12\")\n      {\n        if (v == \"o1234\") {\n          c1x = x + stack.shift();    // dx1\n          c1y = y;                      // dy1\n          c2x = c1x + stack.shift();    // dx2\n          c2y = c1y + stack.shift();    // dy2\n          jpx = c2x + stack.shift();    // dx3\n          jpy = c2y;                    // dy3\n          c3x = jpx + stack.shift();    // dx4\n          c3y = c2y;                    // dy4\n          c4x = c3x + stack.shift();    // dx5\n          c4y = y;                      // dy5\n          x = c4x + stack.shift();      // dx6\n          P.CurveTo(p, c1x, c1y, c2x, c2y, jpx, jpy);\n          P.CurveTo(p, c3x, c3y, c4x, c4y, x, y);\n\n        }\n        if (v == \"o1235\") {\n          c1x = x + stack.shift();    // dx1\n          c1y = y + stack.shift();    // dy1\n          c2x = c1x + stack.shift();    // dx2\n          c2y = c1y + stack.shift();    // dy2\n          jpx = c2x + stack.shift();    // dx3\n          jpy = c2y + stack.shift();    // dy3\n          c3x = jpx + stack.shift();    // dx4\n          c3y = jpy + stack.shift();    // dy4\n          c4x = c3x + stack.shift();    // dx5\n          c4y = c3y + stack.shift();    // dy5\n          x = c4x + stack.shift();      // dx6\n          y = c4y + stack.shift();      // dy6\n          stack.shift();                // flex depth\n          P.CurveTo(p, c1x, c1y, c2x, c2y, jpx, jpy);\n          P.CurveTo(p, c3x, c3y, c4x, c4y, x, y);\n        }\n        if (v == \"o1236\") {\n          c1x = x + stack.shift();    // dx1\n          c1y = y + stack.shift();    // dy1\n          c2x = c1x + stack.shift();    // dx2\n          c2y = c1y + stack.shift();    // dy2\n          jpx = c2x + stack.shift();    // dx3\n          jpy = c2y;                    // dy3\n          c3x = jpx + stack.shift();    // dx4\n          c3y = c2y;                    // dy4\n          c4x = c3x + stack.shift();    // dx5\n          c4y = c3y + stack.shift();    // dy5\n          x = c4x + stack.shift();      // dx6\n          P.CurveTo(p, c1x, c1y, c2x, c2y, jpx, jpy);\n          P.CurveTo(p, c3x, c3y, c4x, c4y, x, y);\n        }\n        if (v == \"o1237\") {\n          c1x = x + stack.shift();    // dx1\n          c1y = y + stack.shift();    // dy1\n          c2x = c1x + stack.shift();    // dx2\n          c2y = c1y + stack.shift();    // dy2\n          jpx = c2x + stack.shift();    // dx3\n          jpy = c2y + stack.shift();    // dy3\n          c3x = jpx + stack.shift();    // dx4\n          c3y = jpy + stack.shift();    // dy4\n          c4x = c3x + stack.shift();    // dx5\n          c4y = c3y + stack.shift();    // dy5\n          if (Math.abs(c4x - x) > Math.abs(c4y - y)) {\n            x = c4x + stack.shift();\n          } else {\n            y = c4y + stack.shift();\n          }\n          P.CurveTo(p, c1x, c1y, c2x, c2y, jpx, jpy);\n          P.CurveTo(p, c3x, c3y, c4x, c4y, x, y);\n        }\n      }\n      else if (v == \"o14\") {\n        if (stack.length > 0 && stack.length != 4 && !haveWidth) {\n          width = stack.shift() + font[\"nominalWidthX\"];\n          haveWidth = true;\n        }\n        if (stack.length == 4) // seac = standard encoding accented character\n        {\n          var adx = stack.shift();\n          var ady = stack.shift();\n          var bchar = stack.shift();\n          var achar = stack.shift();\n\n\n          var bind = CFF.glyphBySE(font, bchar);\n          var aind = CFF.glyphBySE(font, achar);\n\n          //console.log(bchar, bind);\n          //console.log(achar, aind);\n          //state.x=x; state.y=y; state.nStems=nStems; state.haveWidth=haveWidth; state.width=width;  state.open=open;\n\n          _drawCFF(font[\"CharStrings\"][bind], state, font, pdct, p);\n          state.x = adx; state.y = ady;\n          _drawCFF(font[\"CharStrings\"][aind], state, font, pdct, p);\n\n          //x=state.x; y=state.y; nStems=state.nStems; haveWidth=state.haveWidth; width=state.width;  open=state.open;\n        }\n        if (open) { P.ClosePath(p); open = false; }\n      }\n      else if (v == \"o19\" || v == \"o20\") {\n        var hasWidthArg;\n\n        // The number of stem operators on the stack is always even.\n        // If the value is uneven, that means a width is specified.\n        hasWidthArg = stack.length % 2 !== 0;\n        if (hasWidthArg && !haveWidth) {\n          width = stack.shift() + nominalWidthX;\n        }\n\n        nStems += stack.length >> 1;\n        stack.length = 0;\n        haveWidth = true;\n\n        i += (nStems + 7) >> 3;\n      }\n\n      else if (v == \"o21\") {\n        if (stack.length > 2 && !haveWidth) {\n          width = stack.shift() + nominalWidthX;\n          haveWidth = true;\n        }\n\n        y += stack.pop();\n        x += stack.pop();\n\n        if (open) P.ClosePath(p);\n        P.MoveTo(p, x, y); open = true;\n      }\n      else if (v == \"o22\") {\n        if (stack.length > 1 && !haveWidth) {\n          width = stack.shift() + nominalWidthX;\n          haveWidth = true;\n        }\n\n        x += stack.pop();\n\n        if (open) P.ClosePath(p);\n        P.MoveTo(p, x, y); open = true;\n      }\n      else if (v == \"o25\") {\n        while (stack.length > 6) {\n          x += stack.shift();\n          y += stack.shift();\n          P.LineTo(p, x, y);\n        }\n\n        c1x = x + stack.shift();\n        c1y = y + stack.shift();\n        c2x = c1x + stack.shift();\n        c2y = c1y + stack.shift();\n        x = c2x + stack.shift();\n        y = c2y + stack.shift();\n        P.CurveTo(p, c1x, c1y, c2x, c2y, x, y);\n      }\n      else if (v == \"o26\") {\n        if (stack.length % 2) {\n          x += stack.shift();\n        }\n\n        while (stack.length > 0) {\n          c1x = x;\n          c1y = y + stack.shift();\n          c2x = c1x + stack.shift();\n          c2y = c1y + stack.shift();\n          x = c2x;\n          y = c2y + stack.shift();\n          P.CurveTo(p, c1x, c1y, c2x, c2y, x, y);\n        }\n\n      }\n      else if (v == \"o27\") {\n        if (stack.length % 2) {\n          y += stack.shift();\n        }\n\n        while (stack.length > 0) {\n          c1x = x + stack.shift();\n          c1y = y;\n          c2x = c1x + stack.shift();\n          c2y = c1y + stack.shift();\n          x = c2x + stack.shift();\n          y = c2y;\n          P.CurveTo(p, c1x, c1y, c2x, c2y, x, y);\n        }\n      }\n      else if (v == \"o10\" || v == \"o29\")\t// callsubr || callgsubr\n      {\n        var obj = (v == \"o10\" ? pdct : font);\n        if (stack.length == 0) { console.log(\"error: empty stack\"); }\n        else {\n          var ind = stack.pop();\n          var subr = obj[\"Subrs\"][ind + obj[\"Bias\"]];\n          state.x = x; state.y = y; state.nStems = nStems; state.haveWidth = haveWidth; state.width = width; state.open = open;\n          _drawCFF(subr, state, font, pdct, p);\n          x = state.x; y = state.y; nStems = state.nStems; haveWidth = state.haveWidth; width = state.width; open = state.open;\n        }\n      }\n      else if (v == \"o30\" || v == \"o31\")   // vhcurveto || hvcurveto\n      {\n        var count, count1 = stack.length;\n        var index = 0;\n        var alternate = v == \"o31\";\n\n        count = count1 & -3;\n        index += count1 - count;\n\n        while (index < count) {\n          if (alternate) {\n            c1x = x + stack.shift();\n            c1y = y;\n            c2x = c1x + stack.shift();\n            c2y = c1y + stack.shift();\n            y = c2y + stack.shift();\n            if (count - index == 5) { x = c2x + stack.shift(); index++; }\n            else x = c2x;\n            alternate = false;\n          }\n          else {\n            c1x = x;\n            c1y = y + stack.shift();\n            c2x = c1x + stack.shift();\n            c2y = c1y + stack.shift();\n            x = c2x + stack.shift();\n            if (count - index == 5) { y = c2y + stack.shift(); index++; }\n            else y = c2y;\n            alternate = true;\n          }\n          P.CurveTo(p, c1x, c1y, c2x, c2y, x, y);\n          index += 4;\n        }\n      }\n\n      else if ((v + \"\").charAt(0) == \"o\") { console.log(\"Unknown operation: \" + v, cmds); throw v; }\n      else stack.push(v);\n    }\n    //console.log(cmds);\n    state.x = x; state.y = y; state.nStems = nStems; state.haveWidth = haveWidth; state.width = width; state.open = open;\n  }\n\n  function initHB(hurl, resp) {\n    var codeLength = function (code) {\n      var len = 0;\n      if ((code & (0xffffffff - (1 << 7) + 1)) == 0) { len = 1; }\n      else if ((code & (0xffffffff - (1 << 11) + 1)) == 0) { len = 2; }\n      else if ((code & (0xffffffff - (1 << 16) + 1)) == 0) { len = 3; }\n      else if ((code & (0xffffffff - (1 << 21) + 1)) == 0) { len = 4; }\n      return len;\n    };\n\n    fetch(hurl)\n      .then(function (x) { return x[\"arrayBuffer\"](); })\n      .then(function (ab) { return WebAssembly[\"instantiate\"](ab); })\n      .then(function (res) {\n        console.log(\"HB ready\");\n        var exp = res[\"instance\"][\"exports\"], mem = exp[\"memory\"];\n        //mem[\"grow\"](30); // each page is 64kb in size\n        var heapu8, u32, i32, f32;\n        var __lastFnt, blob, blobPtr, face, font;\n\n        Typr[\"U\"][\"shapeHB\"] = (function () {\n\n          var toJson = function (ptr) {\n            var length = exp[\"hb_buffer_get_length\"](ptr);\n            var result = [];\n            var iPtr32 = exp[\"hb_buffer_get_glyph_infos\"](ptr, 0) >>> 2;\n            var pPtr32 = exp[\"hb_buffer_get_glyph_positions\"](ptr, 0) >>> 2;\n            for (var i = 0; i < length; ++i) {\n              var a = iPtr32 + i * 5, b = pPtr32 + i * 5;\n              result.push({\n                \"g\": u32[a + 0],\n                \"cl\": u32[a + 2],\n                \"ax\": i32[b + 0],\n                \"ay\": i32[b + 1],\n                \"dx\": i32[b + 2],\n                \"dy\": i32[b + 3]\n              });\n            }\n            //console.log(result);\n            return result;\n          };\n          var te;\n\n          return function (fnt, str, prm) {\n            var fdata = fnt[\"_data\"], fn = fnt[\"name\"][\"postScriptName\"];\n            var ltr = prm[\"ltr\"], fts = prm[\"fts\"], axs = prm[\"axs\"];\n            if (fnt[\"fvar\"] && axs == null) axs = fnt[\"fvar\"][1][fnt[\"_index\"]][2];\n\n            //var olen = mem.buffer.byteLength, nlen = 2*fdata.length+str.length*16 + 4e6;\n            //if(olen<nlen) mem[\"grow\"](((nlen-olen)>>>16)+4);  //console.log(\"growing\",nlen);\n\n            heapu8 = new Uint8Array(mem.buffer);\n            u32 = new Uint32Array(mem.buffer);\n            i32 = new Int32Array(mem.buffer);\n            f32 = new Float32Array(mem.buffer);\n\n            if (__lastFnt != fn) {\n              if (blob != null) {\n                exp[\"hb_blob_destroy\"](blob);\n                exp[\"free\"](blobPtr);\n                exp[\"hb_face_destroy\"](face);\n                exp[\"hb_font_destroy\"](font);\n              }\n              blobPtr = exp[\"malloc\"](fdata.byteLength); heapu8.set(fdata, blobPtr);\n              blob = exp[\"hb_blob_create\"](blobPtr, fdata.byteLength, 2, 0, 0);\n              face = exp[\"hb_face_create\"](blob, fnt[\"_index\"]);\n              font = exp[\"hb_font_create\"](face);\n              __lastFnt = fn;\n            }\n            if (window[\"TextEncoder\"] == null) { alert(\"Your browser is too old. Please, update it.\"); return; }\n            if (te == null) te = new window[\"TextEncoder\"](\"utf8\");\n\n            var buffer = exp[\"hb_buffer_create\"]();\n            var bytes = te[\"encode\"](str);\n            var len = bytes.length, strp = exp[\"malloc\"](len); heapu8.set(bytes, strp);\n            exp[\"hb_buffer_add_utf8\"](buffer, strp, len, 0, len);\n            exp[\"free\"](strp);\n\n            var bin = Typr[\"B\"];\n\n            var feat = 0;\n            if (fts) {\n              feat = exp[\"malloc\"](16 * fts.length);\n              for (var i = 0; i < fts.length; i++) {\n                var fe = fts[i];\n                var off = feat + i * 16, qo = off >>> 2;\n                bin.writeASCII(heapu8, off, fe[0].split(\"\").reverse().join(\"\"));\n                u32[qo + 1] = fe[1];\n                u32[qo + 2] = fe[2];\n                u32[qo + 3] = fe[3];\n              }\n              //console.log(fts);\n            }\n            var vdat = 0;\n            if (axs && fnt[\"fvar\"]) {\n              var axes = fnt[\"fvar\"][0];  //console.log(axes, axs);\n              vdat = exp[\"malloc\"](8 * axs.length);\n              for (var i = 0; i < axs.length; i++) {\n                var off = vdat + i * 8, qo = off >>> 2;\n                bin.writeASCII(heapu8, off, axes[i][0].split(\"\").reverse().join(\"\"));\n                f32[qo + 1] = axs[i];\n              }\n            }\n            //*/\n\n            if (axs) exp[\"hb_font_set_variations\"](font, vdat, axs.length);\n            exp[\"hb_buffer_set_direction\"](buffer, ltr ? 4 : 5);\n            exp[\"hb_buffer_guess_segment_properties\"](buffer);\n            exp[\"hb_shape\"](font, buffer, feat, fts ? fts.length : 0);\n            var json = toJson(buffer);//buffer[\"json\"]();\n            exp[\"hb_buffer_destroy\"](buffer);\n            if (fts) exp[\"free\"](feat);\n            if (axs) exp[\"free\"](vdat);\n\n            var arr = json.slice(0); if (!ltr) arr.reverse();\n            var ci = 0, bi = 0;  // character index, binary index\n            for (var i = 1; i < arr.length; i++) {\n              var gl = arr[i], cl = gl[\"cl\"];\n              while (true) {\n                var cpt = str.codePointAt(ci), cln = codeLength(cpt);\n                if (bi + cln <= cl) { bi += cln; ci += cpt <= 0xffff ? 1 : 2; }\n                else break;\n              }\n              //while(bi+codeLength(str.charCodeAt(ci)) <=cl) {  bi+=codeLength(str.charCodeAt(ci));  ci++;  }\n              gl[\"cl\"] = ci;\n            }\n            return json;\n          }\n        }());\n        resp();\n      });\n  }\n\n  return { \"shape\": shape, \"shapeToPath\": shapeToPath, \"codeToGlyph\": codeToGlyph, \"glyphToPath\": glyphToPath, \"pathToSVG\": pathToSVG, \"SVGToPath\": SVGToPath, \"pathToContext\": pathToContext, \"initHB\": initHB };\n}();\n\nexport { Typr as default };\n","import { textCoreConstants } from './textCore.js';\nimport { C as CENTER, R as RIGHT, a as RADIUS } from '../constants-8IpwyBct.js';\nimport { UnicodeRange } from '@japont/unicode-range';\nimport { unicodeRanges } from './unicodeRanges.js';\nimport Typr from './lib/Typr.js';\nimport { createFromCommands } from '@davepagurek/bezier-path';\nimport '../p5.Renderer-DoDzbpcT.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../image/filters.js';\nimport '../math/p5.Vector.js';\nimport '../shape/custom_shapes.js';\nimport '../core/States.js';\nimport '../io/utilities.js';\nimport 'file-saver';\nimport 'pako';\n\n/**\n * @module Typography\n */\n\n\nconst pathArgCounts = { M: 2, L: 2, C: 6, Q: 4 };\nconst validFontTypes = ['ttf', 'otf', 'woff'];//, 'woff2'];\nconst validFontTypesRe = new RegExp(`\\\\.(${validFontTypes.join('|')})`, 'i');\nconst extractFontNameRe = new RegExp(`([^/]+)(\\\\.(?:${validFontTypes.join('|')}))`, 'i');\nconst invalidFontError = 'Sorry, only TTF, OTF and WOFF files are supported.'; // and WOFF2\nconst fontFaceVariations = ['weight', 'stretch', 'style'];\n\n\nclass Font {\n  constructor(p, fontFace, name, path, data) {\n    if (!(fontFace instanceof FontFace)) {\n      throw Error('FontFace is required');\n    }\n    this._pInst = p;\n    this.name = name;\n    this.path = path;\n    this.data = data;\n    this.face = fontFace;\n  }\n\n  /**\n   * Checks whether a font has glyph point data and\n   * can thus be used for textToPoints(), WEBGL mode, etc.\n   * @private\n   */\n  static hasGlyphData(textFont) {\n    let { font } = textFont;\n    return typeof font === 'object' && typeof font.data !== 'undefined';\n  }\n\n  fontBounds(str, x, y, width, height, options) {\n    ({ width, height, options } = this._parseArgs(width, height, options));\n    let renderer = options?.graphics?._renderer || this._pInst._renderer;\n    if (!renderer) throw Error('p5 or graphics required for fontBounds()');\n    return renderer.fontBounds(str, x, y, width, height);\n  }\n\n  textBounds(str, x, y, width, height, options) {\n    ({ width, height, options } = this._parseArgs(width, height, options));\n    let renderer = options?.graphics?._renderer || this._pInst._renderer;\n    if (!renderer) throw Error('p5 or graphics required for fontBounds()');\n    return renderer.textBounds(str, x, y, width, height);\n  }\n\n  /**\n   * Returns a flat array of path commands that describe the outlines of a string of text.\n   *\n   * Each command is represented as an array of the form `[type, ...coords]`, where:\n   * - `type` is one of `'M'`, `'L'`, `'Q'`, `'C'`, or `'Z'`,\n   * - `coords` are the numeric values needed for that command.\n   *\n   * `'M'` indicates a \"move to\" (starting a new contour),\n   * `'L'` a line segment,\n   * `'Q'` a quadratic bezier,\n   * `'C'` a cubic bezier, and\n   * `'Z'` closes the current path.\n   *\n   * The first two parameters, `x` and `y`, specify the baseline origin for the text.\n   * Optionally, you can provide a `width` and `height` for text wrapping; if you don't need\n   * wrapping, you can omit them and directly pass `options` as the fourth parameter.\n   *\n   * @param  {String} str            The text to convert into path commands.\n   * @param  {Number} x              xcoordinate of the text baseline.\n   * @param  {Number} y              ycoordinate of the text baseline.\n   * @param  {Number} [width]        Optional width for text wrapping.\n   * @param  {Number} [height]       Optional height for text wrapping.\n   * @param  {Object} [options]      Configuration object for rendering text.\n   * @return {Array<Array>}          A flat array of path commands.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let font;\n   *\n   * async function setup() {\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   createCanvas(200, 200);\n   *   background(220);\n   *   noLoop();\n   * }\n   *\n   * function draw() {\n   *   background(220);\n   *   stroke(0);\n   *   noFill();\n   *   textSize(60);\n   *\n   *   // Get path commands for \"Hello\" (drawn at baseline x=50, y=100):\n   *   const pathCommands = font.textToPaths('Hello', 30, 110);\n   *\n   *   beginShape();\n   *   for (let i = 0; i < pathCommands.length; i++) {\n   *     const cmd = pathCommands[i];\n   *     const type = cmd[0];\n   *\n   *     switch (type) {\n   *       case 'M': {\n   *         // Move to (start a new contour)\n   *         const x = cmd[1];\n   *         const y = cmd[2];\n   *         endContour(); // In case we were already drawing\n   *         beginContour();\n   *         vertex(x, y);\n   *         break;\n   *       }\n   *       case 'L': {\n   *         // Line to\n   *         const x = cmd[1];\n   *         const y = cmd[2];\n   *         vertex(x, y);\n   *         break;\n   *       }\n   *       case 'Q': {\n   *         // Quadratic bezier\n   *         const cx = cmd[1];\n   *         const cy = cmd[2];\n   *         const x = cmd[3];\n   *         const y = cmd[4];\n   *         bezierOrder(2);\n   *         bezierVertex(cx, cy);\n   *         bezierVertex(x, y);\n   *         break;\n   *       }\n   *       case 'C': {\n   *         // Cubic bezier\n   *         const cx1 = cmd[1];\n   *         const cy1 = cmd[2];\n   *         const cx2 = cmd[3];\n   *         const cy2 = cmd[4];\n   *         const x = cmd[5];\n   *         const y = cmd[6];\n   *         bezierOrder(3);\n   *         bezierVertex(cx1, cy1);\n   *         bezierVertex(cx2, cy2);\n   *         bezierVertex(x, y);\n   *         break;\n   *       }\n   *       case 'Z': {\n   *         // Close path\n   *         endContour(CLOSE);\n   *         beginContour();\n   *         break;\n   *       }\n   *     }\n   *   }\n   *   endContour();\n   *   endShape();\n   * }\n   * </code>\n   * </div>\n   */\n\n  textToPaths(str, x, y, width, height, options) {\n\n    ({ width, height, options } = this._parseArgs(width, height, options));\n\n    if (!this.data) {\n      throw Error('No font data available for \"' + this.name\n        + '\"\\nTry downloading a local copy of the font file');\n    }\n\n    // lineate and get glyphs/paths for each line\n    let lines = this._lineateAndPathify(str, x, y, width, height, options);\n\n    // flatten into a single array containing all the glyphs\n    let glyphs = lines.map(o => o.glyphs).flat();\n\n    // flatten into a single array with all the path commands\n    return glyphs.map(g => g.path.commands).flat();\n  }\n\n  /**\n   * Returns an array of points outlining a string of text written using the\n   * font.\n   *\n   * Each point object in the array has three properties that describe the\n   * point's location and orientation, called its path angle. For example,\n   * `{ x: 10, y: 20, alpha: 450 }`.\n   *\n   * The first parameter, `str`, is a string of text. The second and third\n   * parameters, `x` and `y`, are the text's position. By default, they set the\n   * coordinates of the bounding box's bottom-left corner. See\n   * <a href=\"#/p5/textAlign\">textAlign()</a> for more ways to align text.\n   *\n   * The fourth parameter, `options`, is also optional. `font.textToPoints()`\n   * expects an object with the following properties:\n   *\n   * `sampleFactor` is the ratio of the text's path length to the number of\n   * samples. It defaults to 0.1. Higher values produce more points along the\n   * path and are more precise.\n   *\n   * `simplifyThreshold` removes collinear points if it's set to a number other\n   * than 0. The value represents the threshold angle to use when determining\n   * whether two edges are collinear.\n   *\n   * @param  {String} str        string of text.\n   * @param  {Number} x          x-coordinate of the text.\n   * @param  {Number} y          y-coordinate of the text.\n   * @param  {Object} [options]  object with sampleFactor and simplifyThreshold\n   *                             properties.\n   * @return {Array<Object>} array of point objects, each with `x`, `y`, and `alpha` (path angle) properties.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let font;\n   *\n   * async function setup() {\n   *   createCanvas(100, 100);\n   *   font = await loadFont('assets/inconsolata.otf');\n   *\n   *   background(200);\n   *   textSize(35);\n   *\n   *   // Get the point array.\n   *   let points = font.textToPoints('p5*js', 6, 60, { sampleFactor: 0.5 });\n   *\n   *   // Draw a dot at each point.\n   *   for (let p of points) {\n   *     point(p.x, p.y);\n   *   }\n   *\n   *   describe('A set of black dots outlining the text \"p5*js\" on a gray background.');\n   * }\n   * </code>\n   * </div>\n   */\n  textToPoints(str, x, y, width, height, options) {\n    // By segmenting per contour, pointAtLength becomes much faster\n    const contourPoints = this.textToContours(str, x, y, width, height, options);\n    return contourPoints.reduce((acc, next) => {\n      acc.push(...next);\n      return acc;\n    }, []);\n  }\n\n  /**\n   * Returns an array of arrays of points outlining a string of text written using the\n   * font. Each array represents a contour, so the letter O will have two outer arrays:\n   * one for the outer edge of the shape, and one for the inner edge of the hole.\n   *\n   * Each point object in a contour array has three properties that describe the\n   * point's location and orientation, called its path angle. For example,\n   * `{ x: 10, y: 20, alpha: 450 }`.\n   *\n   * The first parameter, `str`, is a string of text. The second and third\n   * parameters, `x` and `y`, are the text's position. By default, they set the\n   * coordinates of the bounding box's bottom-left corner. See\n   * <a href=\"#/p5/textAlign\">textAlign()</a> for more ways to align text.\n   *\n   * The fourth parameter, `options`, is also optional. `font.textToPoints()`\n   * expects an object with the following properties:\n   *\n   * `sampleFactor` is the ratio of the text's path length to the number of\n   * samples. It defaults to 0.1. Higher values produce more points along the\n   * path and are more precise.\n   *\n   * `simplifyThreshold` removes collinear points if it's set to a number other\n   * than 0. The value represents the threshold angle to use when determining\n   * whether two edges are collinear.\n   *\n   * @param  {String} str        string of text.\n   * @param  {Number} x          x-coordinate of the text.\n   * @param  {Number} y          y-coordinate of the text.\n   * @param  {Object} [options]  object with sampleFactor and simplifyThreshold\n   *                             properties.\n   * @return {Array<Array<Object>>} array of point objects, each with `x`, `y`, and `alpha` (path angle) properties.\n   *\n   * @example\n   * <div>\n   * <code>\n   * let font;\n   *\n   * async function setup() {\n   *   createCanvas(100, 100);\n   *   font = await loadFont('/assets/inconsolata.otf');\n   * }\n   *\n   * function draw() {\n   *   background(200);\n   *   textAlign(CENTER, CENTER);\n   *   textSize(30);\n   *\n   *   // Get the point array.\n   *   let contours = font.textToContours('p5*js', width/2, height/2, { sampleFactor: 0.5 });\n   *\n   *   beginShape();\n   *   for (const pts of contours) {\n   *     beginContour();\n   *     for (const pt of pts) {\n   *       vertex(pt.x + 5*sin(pt.y*0.1 + millis()*0.01), pt.y);\n   *     }\n   *     endContour(CLOSE);\n   *   }\n   *   endShape();\n   *\n   *   describe('The text p5*js wobbling over time');\n   * }\n   * </code>\n   * </div>\n   */\n  textToContours(str, x = 0, y = 0, width, height, options) {\n    ({ width, height, options } = this._parseArgs(width, height, options));\n\n    const cmds = this.textToPaths(str, x, y, width, height, options);\n    const cmdContours = [];\n    for (const cmd of cmds) {\n      if (cmd[0] === 'M') {\n        cmdContours.push([]);\n      }\n      cmdContours[cmdContours.length - 1].push(cmd);\n    }\n\n    return cmdContours.map((commands) => pathToPoints(commands, options, this));\n  }\n  /**\n      *\n      * Converts text into a 3D model that can be rendered in WebGL mode.\n      *\n      * This method transforms flat text into extruded 3D geometry, allowing\n      * for dynamic effects like depth, warping, and custom shading.\n      *\n      * It works by taking the outlines (contours) of each character in the\n      * provided text string and constructing a 3D shape from them.\n      *\n      * Once your 3D text is ready, you can rotate it in 3D space using <a href=\"#/p5/orbitControl\">orbitControl()</a>\n      *  just click and drag with your mouse to see it from all angles!\n      *\n      * Use the extrude slider to give your letters depth: slide it up, and your\n      * flat text turns into a solid, multi-dimensional object.\n      *\n      * You can also choose from various fonts such as \"Anton\", \"Montserrat\", or \"Source Serif\",\n      * much like selecting fancy fonts in a word processor,\n      *\n      * The generated model (a Geometry object) can be manipulated furtherrotated, scaled,\n      * or styled with shadersto create engaging, interactive visual art.\n      *\n      * @param {String} str The text string to convert into a 3D model.\n      * @param {Number} x The x-coordinate for the starting position of the text.\n      * @param {Number} y The y-coordinate for the starting position of the text.\n      * @param {Number} width Maximum width of the text block (wraps text if exceeded).\n      * @param {Number} height Maximum height of the text block.\n      * @param {Object} [options] Configuration options for the 3D text:\n      * @param {Number} [options.extrude=0] The depth to extrude the text. A value of 0 produces\n      * flat text; higher values create thicker, 3D models.\n      * @param {Number} [options.sampleFactor=1] A factor controlling the level of detail for the text contours.\n      *  Higher values result in smoother curves.\n      * @return {p5.Geometry} A geometry object representing the 3D model of the text.\n      *\n      * @example\n      * <div modernizr='webgl'>\n      * <code>\n      * let font;\n      * let geom;\n      *\n      * async function setup() {\n      *   createCanvas(200, 200, WEBGL);\n      *   font = await loadFont('https://fonts.gstatic.com/s/anton/v25/1Ptgg87LROyAm0K08i4gS7lu.ttf');\n      *\n      *   geom = font.textToModel(\"Hello\", 50, 0, { sampleFactor: 2 });\n      *   geom.clearColors();\n      *   geom.normalize();\n      * }\n      *\n      * function draw() {\n      *   background(255);\n      *   orbitControl();\n      *   fill(\"red\");\n      *   strokeWeight(4);\n      *   scale(min(width, height) / 300);\n      *   model(geom);\n      *   describe('A red non-extruded \"Hello\" in Anton on white canvas, rotatable via mouse.');\n      * }\n      * </code>\n      * </div>\n      *\n      * @example\n      * <div modernizr='webgl'>\n      * <code>\n      * let font;\n      * let geom;\n      *\n      * async function setup() {\n      *   createCanvas(200, 200, WEBGL);\n      *\n      *   // Alternative fonts:\n      *   // Anton: 'https://fonts.gstatic.com/s/anton/v25/1Ptgg87LROyAm0K08i4gS7lu.ttf'\n      *   // Montserrat: 'https://fonts.gstatic.com/s/montserrat/v29/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Ew-Y3tcoqK5.ttf'\n      *   // Source Serif: 'https://fonts.gstatic.com/s/sourceserif4/v8/vEFy2_tTDB4M7-auWDN0ahZJW3IX2ih5nk3AucvUHf6OAVIJmeUDygwjihdqrhxXD-wGvjU.ttf'\n      *\n      *   // Using Source Serif for this example:\n      *   font = await loadFont('https://fonts.gstatic.com/s/sourceserif4/v8/vEFy2_tTDB4M7-auWDN0ahZJW3IX2ih5nk3AucvUHf6OAVIJmeUDygwjihdqrhxXD-wGvjU.ttf');\n      *\n      *   geom = font.textToModel(\"Hello\", 50, 0, { sampleFactor: 2, extrude: 5 });\n      *   geom.clearColors();\n      *   geom.normalize();\n      * }\n      *\n      * function draw() {\n      *   background(255);\n      *   orbitControl();\n      *   fill(\"red\");\n      *   strokeWeight(4);\n      *   scale(min(width, height) / 300);\n      *   model(geom);\n      *   describe('3D red extruded \"Hello\" in Source Serif on white, rotatable via mouse.');\n      * }\n      * </code>\n      * </div>\n      *\n      * @example\n      * <div modernizr='webgl'>\n      * <code>\n      * let geom;\n      * let activeFont;\n      * let artShader;\n      * let lineShader;\n      *\n      * // Define parameters as simple variables\n      * let words = 'HELLO';\n      * let warp = 1;\n      * let extrude = 5;\n      * let palette = [\"#ffe03d\", \"#fe4830\", \"#d33033\", \"#6d358a\", \"#1c509e\", \"#00953c\"];\n      *\n      * async function setup() {\n      *   createCanvas(200, 200, WEBGL);\n      *\n      *   // Using Anton as the default font for this example:\n      *\n      *  // Alternative fonts:\n      *  // Anton: 'https://fonts.gstatic.com/s/anton/v25/1Ptgg87LROyAm0K08i4gS7lu.ttf'\n      *  // Montserrat: 'https://fonts.gstatic.com/s/montserrat/v29/JTUHjIg1_i6t8kCHKm4532VJOt5-QNFgpCtr6Ew-Y3tcoqK5.ttf'\n      *  // Source Serif: 'https://fonts.gstatic.com/s/sourceserif4/v8/vEFy2_tTDB4M7-auWDN0ahZJW3IX2ih5nk3AucvUHf6OAVIJmeUDygwjihdqrhxXD-wGvjU.ttf'\n      *   activeFont = await loadFont('https://fonts.gstatic.com/s/anton/v25/1Ptgg87LROyAm0K08i4gS7lu.ttf');\n      *\n      *   geom = activeFont.textToModel(words, 0, 50, { sampleFactor: 2, extrude });\n      *   geom.clearColors();\n      *   geom.normalize();\n      *\n      *   artShader = baseMaterialShader().modify({\n      *     uniforms: {\n      *       'float time': () => millis(),\n      *       'float warp': () => warp,\n      *       'float numColors': () => palette.length,\n      *       'vec3[6] colors': () => palette.flatMap((c) => [red(c)/255, green(c)/255, blue(c)/255]),\n      *     },\n      *     vertexDeclarations: 'out vec3 vPos;',\n      *     fragmentDeclarations: 'in vec3 vPos;',\n      *     'Vertex getObjectInputs': `(Vertex inputs) {\n      *       vPos = inputs.position;\n      *       inputs.position.x += 5. * warp * sin(inputs.position.y * 0.1 + time * 0.001) / (1. + warp);\n      *       inputs.position.y += 5. * warp * sin(inputs.position.x * 0.1 + time * 0.0009) / (1. + warp);\n      *       return inputs;\n      *     }`,\n      *     'vec4 getFinalColor': `(vec4 _c) {\n      *       float x = vPos.x * 0.005;\n      *       float a = floor(fract(x) * numColors);\n      *       float b = a == numColors - 1. ? 0. : a + 1.;\n      *       float t = fract(x * numColors);\n      *       vec3 c = mix(colors[int(a)], colors[int(b)], t);\n      *       return vec4(c, 1.);\n      *     }`\n      *   });\n      *\n      *   lineShader = baseStrokeShader().modify({\n      *     uniforms: {\n      *       'float time': () => millis(),\n      *       'float warp': () => warp,\n      *     },\n      *     'StrokeVertex getObjectInputs': `(StrokeVertex inputs) {\n      *       inputs.position.x += 5. * warp * sin(inputs.position.y * 0.1 + time * 0.001) / (1. + warp);\n      *       inputs.position.y += 5. * warp * sin(inputs.position.x * 0.1 + time * 0.0009) / (1. + warp);\n      *       return inputs;\n      *     }`,\n      *   });\n      * }\n      *\n      * function draw() {\n      *   background(255);\n      *   orbitControl();\n      *   shader(artShader);\n      *   strokeShader(lineShader);\n      *   strokeWeight(4);\n      *   scale(min(width, height) / 210);\n      *   model(geom);\n      *   describe('3D wavy with different color sets \"Hello\" in Anton on white canvas, rotatable via mouse.');\n      * }\n      * </code>\n      * </div>\n      */\n  textToModel(str, x, y, width, height, options) {\n    ({ width, height, options } = this._parseArgs(width, height, options));\n    const extrude = options?.extrude || 0;\n    const contours = this.textToContours(str, x, y, width, height, options);\n\n    const geom = this._pInst.buildGeometry(() => {\n      if (extrude === 0) {\n        const prevValidateFaces = this._pInst._renderer._validateFaces;\n        this._pInst._renderer._validateFaces = true;\n        this._pInst.beginShape();\n        this._pInst.normal(0, 0, 1);\n        for (const contour of contours) {\n          this._pInst.beginContour();\n          for (const { x, y } of contour) {\n            this._pInst.vertex(x, y);\n          }\n          this._pInst.endContour(this._pInst.CLOSE);\n        }\n        this._pInst.endShape();\n        this._pInst._renderer._validateFaces = prevValidateFaces;\n      } else {\n        const prevValidateFaces = this._pInst._renderer._validateFaces;\n        this._pInst._renderer._validateFaces = true;\n\n        // Draw front faces\n        for (const side of [1, -1]) {\n          this._pInst.beginShape();\n          for (const contour of contours) {\n            this._pInst.beginContour();\n            for (const { x, y } of contour) {\n              this._pInst.vertex(x, y, side * extrude * 0.5);\n            }\n            this._pInst.endContour(this._pInst.CLOSE);\n          }\n          this._pInst.endShape();\n        }\n        this._pInst._renderer._validateFaces = prevValidateFaces;\n\n        // Draw sides\n        for (const contour of contours) {\n          this._pInst.beginShape(this._pInst.QUAD_STRIP);\n          for (const v of contour) {\n            for (const side of [-1, 1]) {\n              this._pInst.vertex(v.x, v.y, side * extrude * 0.5);\n            }\n          }\n          this._pInst.endShape();\n        }\n      }\n    });\n    if (extrude !== 0) {\n      geom.computeNormals();\n      for (const face of geom.faces) {\n        if (face.every((idx) => geom.vertices[idx].z <= -extrude * 0.5 + 0.1)) {\n          for (const idx of face) geom.vertexNormals[idx].set(0, 0, -1);\n          face.reverse();\n        }\n      }\n    }\n    return geom;\n  }\n\n  variations() {\n    let vars = {};\n    if (this.data) {\n      let axes = this.face?.axes;\n      if (axes) {\n        axes.forEach(ax => {\n          vars[ax.tag] = ax.value;\n        });\n      }\n    }\n    fontFaceVariations.forEach(v => {\n      let val = this.face[v];\n      if (val !== 'normal') {\n        vars[v] = vars[v] || val;\n      }\n    });\n    return vars;\n  }\n\n  metadata() {\n    let meta = this.data?.name || {};\n    for (let p in this.face) {\n      if (!/^load/.test(p)) {\n        meta[p] = meta[p] || this.face[p];\n      }\n    }\n    return meta;\n  }\n\n  static async list(log = false) { // tmp\n    if (log) {\n      console.log('There are', document.fonts.size, 'font-faces\\n');\n      let loaded = 0;\n      for (let fontFace of document.fonts.values()) {\n        console.log('FontFace: {');\n        for (let property in fontFace) {\n          console.log('  ' + property + ': ' + fontFace[property]);\n        }\n        console.log('}\\n');\n        if (fontFace.status === 'loaded') {\n          loaded++;\n        }\n      }\n      console.log(loaded + ' loaded');\n    }\n    return await Array.from(document.fonts);\n  }\n\n  /////////////////////////////// HELPERS ////////////////////////////////\n\n  _verticalAlign(size) {\n    const { sCapHeight } = this.data?.['OS/2'] || {};\n    const { unitsPerEm = 1000 } = this.data?.head || {};\n    const { ascender = 0, descender = 0 } = this.data?.hhea || {};\n    const current = ascender / 2;\n    const target = (sCapHeight || (ascender + descender)) / 2;\n    const offset = target - current;\n    return offset * size / unitsPerEm;\n  }\n\n  /*\n    Returns an array of line objects, each containing { text, x, y, glyphs: [ {g, path} ] }\n  */\n  _lineateAndPathify(str, x, y, width, height, options = {}) {\n\n    let renderer = options?.graphics?._renderer || this._pInst._renderer;\n\n    // save the baseline\n    let setBaseline = renderer.drawingContext.textBaseline;\n\n    // lineate and compute bounds for the text\n    let { lines, bounds } = renderer._computeBounds\n      (textCoreConstants._FONT_BOUNDS, str, x, y, width, height,\n        { ignoreRectMode: true, ...options });\n\n    // compute positions for each of the lines\n    lines = this._position(renderer, lines, bounds, width, height);\n\n    // convert lines to paths\n    let uPE = this.data?.head?.unitsPerEm || 1000;\n    let scale = renderer.states.textSize / uPE;\n\n    const axs = this._currentAxes(renderer);\n    let pathsForLine = lines.map(l => this._lineToGlyphs(l, { scale, axs }));\n\n    // restore the baseline\n    renderer.drawingContext.textBaseline = setBaseline;\n\n    return pathsForLine;\n  }\n\n  _currentAxes(renderer) {\n    let axs;\n    if ((this.data?.fvar?.length ?? 0) > 0) {\n      const fontAxes = this.data.fvar[0];\n      axs = fontAxes.map(([tag, minVal, defaultVal, maxVal, flags, name]) => {\n        if (!renderer) return defaultVal;\n        if (tag === 'wght') {\n          return renderer.states.fontWeight;\n        } else if (tag === 'wdth') {\n          // TODO: map from keywords (normal, ultra-condensed, etc) to values\n          // return renderer.states.fontStretch\n          return 100;\n        } else if (renderer.textCanvas().style.fontVariationSettings) {\n          const match = new RegExp(`\\\\b${tag}\\s+(\\d+)`)\n            .exec(renderer.textCanvas().style.fontVariationSettings);\n          if (match) {\n            return parseInt(match[1]);\n          } else {\n            return defaultVal;\n          }\n        } else {\n          return defaultVal;\n        }\n      });\n    }\n    return axs;\n  }\n\n  _textToPathPoints(str, x, y, width, height, options) {\n\n    ({ width, height, options } = this._parseArgs(width, height, options));\n\n    // lineate and get the points for each line\n    let cmds = this.textToPaths(str, x, y, width, height, options);\n\n    // divide line-segments with intermediate points\n    const subdivide = (pts, pt1, pt2, md) => {\n      if (fn.dist(pt1.x, pt1.y, pt2.x, pt2.y) > md) {\n        let middle = { x: (pt1.x + pt2.x) / 2, y: (pt1.y + pt2.y) / 2 };\n        pts.push(middle);\n        subdivide(pts, pt1, middle, md);\n        subdivide(pts, middle, pt2, md);\n      }\n    };\n\n    // a point for each path-command plus line subdivisions\n    let pts = [];\n    let { textSize } = this._pInst._renderer.states;\n    let maxDist = (textSize / this.data.head.unitsPerEm) * 500;\n\n    for (let i = 0; i < cmds.length; i++) {\n      let { type, data: d } = cmds[i];\n      if (type !== 'Z') {\n        let pt = { x: d[d.length - 2], y: d[d.length - 1] };\n        if (type === 'L' && pts.length && !options?.nodivide > 0) {\n          subdivide(pts, pts[pts.length - 1], pt, maxDist);\n        }\n        pts.push(pt);\n      }\n    }\n\n    return pts;\n  }\n\n  _parseArgs(width, height, options = {}) {\n\n    if (typeof width === 'object') {\n      options = width;\n      width = height = undefined;\n    }\n    else if (typeof height === 'object') {\n      options = height;\n      height = undefined;\n    }\n    return { width, height, options };\n  }\n\n  _position(renderer, lines, bounds, width, height) {\n\n    let { textAlign, textLeading } = renderer.states;\n    let metrics = this._measureTextDefault(renderer, 'X');\n    let ascent = metrics.fontBoundingBoxAscent;\n\n    let coordify = (text, i) => {\n      let x = bounds.x;\n      let y = bounds.y + (i * textLeading) + ascent;\n      let lineWidth = renderer._fontWidthSingle(text);\n      if (textAlign === CENTER) {\n        x += (bounds.w - lineWidth) / 2;\n      }\n      else if (textAlign === RIGHT) {\n        x += (bounds.w - lineWidth);\n      }\n      if (typeof width !== 'undefined') {\n        switch (renderer.states.rectMode) {\n          case CENTER:\n            x -= width / 2;\n            y -= height / 2;\n            break;\n          case RADIUS:\n            x -= width;\n            y -= height;\n            break;\n        }\n      }\n      return { text, x, y };\n    };\n\n    return lines.map(coordify);\n  }\n\n  _lineToGlyphs(line, { scale = 1, axs } = {}) {\n\n    if (!this.data) {\n      throw Error('No font data available for \"' + this.name\n        + '\"\\nTry downloading a local copy of the font file');\n    }\n    let glyphShapes = Typr.U.shape(this.data, line.text, { axs });\n    line.glyphShapes = glyphShapes;\n\n    line.glyphs = this._shapeToPaths(glyphShapes, line, { scale, axs });\n\n    return line;\n  }\n\n  _positionGlyphs(text, options) {\n    let renderer = options?.graphics?._renderer || this._pInst._renderer;\n    const axs = this._currentAxes(renderer);\n    const glyphShapes = Typr.U.shape(this.data, text, { axs });\n    const positionedGlyphs = [];\n    let x = 0;\n    for (const glyph of glyphShapes) {\n      positionedGlyphs.push({ x, index: glyph.g, shape: glyph });\n      x += glyph.ax;\n    }\n    return positionedGlyphs;\n  }\n\n  _singleShapeToPath(shape, { scale = 1, x = 0, y = 0, lineX = 0, lineY = 0, axs } = {}) {\n    let font = this.data;\n    let crdIdx = 0;\n    let { g, ax, ay, dx, dy } = shape;\n    let { crds, cmds } = Typr.U.glyphToPath(font, g, true, axs);\n\n    // can get simple points for each glyph here, but we don't need them ?\n    let glyph = { /*g: line.text[i], points: [],*/ path: { commands: [] } };\n\n    for (let j = 0; j < cmds.length; j++) {\n      let type = cmds[j], command = [type];\n      if (type in pathArgCounts) {\n        let argCount = pathArgCounts[type];\n        for (let k = 0; k < argCount; k += 2) {\n          let gx = crds[k + crdIdx] + x + dx;\n          let gy = crds[k + crdIdx + 1] + y + dy;\n          let fx = lineX + gx * scale;\n          let fy = lineY + gy * -scale;\n          command.push(fx);\n          command.push(fy);\n          /*if (k === argCount - 2) {\n            glyph.points.push({ x: fx, y: fy });\n          }*/\n        }\n        crdIdx += argCount;\n      }\n      glyph.path.commands.push(command);\n    }\n\n    return { glyph, ax, ay };\n  }\n\n  _shapeToPaths(glyphs, line, { scale = 1, axs } = {}) {\n    let x = 0, y = 0, paths = [];\n\n    if (glyphs.length !== line.text.length) {\n      throw Error('Invalid shape data');\n    }\n\n    // iterate over the glyphs, converting each to a glyph object\n    // with a path property containing an array of commands\n    for (let i = 0; i < glyphs.length; i++) {\n      const { glyph, ax, ay } = this._singleShapeToPath(glyphs[i], {\n        scale,\n        x,\n        y,\n        lineX: line.x,\n        lineY: line.y,\n        axs,\n      });\n\n      paths.push(glyph);\n      x += ax; y += ay;\n    }\n\n    return paths;\n  }\n\n  _measureTextDefault(renderer, str) {\n    let { textAlign, textBaseline } = renderer.states;\n    let ctx = renderer.textDrawingContext();\n    ctx.textAlign = 'left';\n    ctx.textBaseline = 'alphabetic';\n    let metrics = ctx.measureText(str);\n    ctx.textAlign = textAlign;\n    ctx.textBaseline = textBaseline;\n    return metrics;\n  }\n\n  drawPaths(ctx, commands, opts) { // for debugging\n    ctx.strokeStyle = opts?.stroke || ctx.strokeStyle;\n    ctx.fillStyle = opts?.fill || ctx.fillStyle;\n    ctx.beginPath();\n    commands.forEach(([type, ...data]) => {\n      if (type === 'M') {\n        ctx.moveTo(...data);\n      } else if (type === 'L') {\n        ctx.lineTo(...data);\n      } else if (type === 'C') {\n        ctx.bezierCurveTo(...data);\n      } else if (type === 'Q') {\n        ctx.quadraticCurveTo(...data);\n      } else if (type === 'Z') {\n        ctx.closePath();\n      }\n    });\n    if (opts?.fill) ctx.fill();\n    if (opts?.stroke) ctx.stroke();\n  }\n\n  _pathsToCommands(paths, scale) {\n    let commands = [];\n    for (let i = 0; i < paths.length; i++) {\n      let pathData = paths[i];\n      let { x, y, path } = pathData;\n      let { crds, cmds } = path;\n\n      // iterate over the path, storing each non-control point\n      for (let c = 0, j = 0; j < cmds.length; j++) {\n        let cmd = cmds[j], obj = { type: cmd, data: [] };\n        if (cmd == \"M\" || cmd == \"L\") {\n          obj.data.push(x + crds[c] * scale, y + crds[c + 1] * -scale);\n          c += 2;\n        }\n        else if (cmd == \"C\") {\n          for (let i = 0; i < 6; i += 2) {\n            obj.data.push(x + crds[c + i] * scale, y + crds[c + i + 1] * -scale);\n          }\n          c += 6;\n        }\n        else if (cmd == \"Q\") {\n          for (let i = 0; i < 4; i += 2) {\n            obj.data.push(x + crds[c + i] * scale, y + crds[c + i + 1] * -scale);\n          }\n          c += 4;\n        }\n        commands.push(obj);\n      }\n    }\n\n    return commands;\n  }\n}\n\nasync function create(pInst, name, path, descriptors, rawFont) {\n\n  let face = createFontFace(name, path, descriptors, rawFont);\n\n  // load if we need to\n  if (face.status !== 'loaded') await face.load();\n\n  // add it to the document\n  document.fonts.add(face);\n\n  // ensure the font is ready to be rendered\n  await document.fonts.ready;\n\n  // return a new p5.Font\n  return new Font(pInst, face, name, path, rawFont);\n}\n\nfunction createFontFace(name, path, descriptors, rawFont) {\n\n  if (name.includes(' ')) name = \"'\" + name + \"'\"; // NOTE: must be single-quotes\n\n  let fontArg = rawFont?._compressedData ?? rawFont?._data;\n  if (!fontArg) {\n    if (!validFontTypesRe.test(path)) {\n      throw Error(invalidFontError);\n    }\n    if (!path.startsWith('url(')) {\n      path = 'url(' + path + ')';\n    }\n    fontArg = path;\n  }\n\n  if ((rawFont?.fvar?.length ?? 0) > 0) {\n    descriptors = descriptors || {};\n    for (const [tag, minVal, defaultVal, maxVal, flags, name] of rawFont.fvar[0]) {\n      if (tag === 'wght') {\n        descriptors.weight = `${minVal} ${maxVal}`;\n      } else if (tag === 'wdth') {\n        descriptors.stretch = `${minVal}% ${maxVal}%`;\n      }\n      // TODO add other descriptors\n    }\n  }\n\n  // create/return the FontFace object\n  let face = new FontFace(name, fontArg, descriptors);\n  if (face.status === 'error') {\n    throw Error('Failed to create FontFace for \"' + name + '\"');\n  }\n  return face;\n}\n\nfunction extractFontName(font, path) {\n  let result, meta = font?.name;\n\n  // use the metadata if we have it\n  if (meta) {\n    if (meta.fullName) {\n      return meta.fullName;\n    }\n    if (meta.familyName) {\n      result = meta.familyName;\n    }\n  }\n\n  if (!result) {\n\n    // if not, try to extract the name from the path\n    let matches = extractFontNameRe.exec(path);\n    if (matches && matches.length >= 3) {\n      result = matches[1];\n    }\n    else {\n      // give up and return the full path\n      result = path;\n    }\n  }\n\n  // replace spaces with underscores\n  if (result.includes(' ')) {\n    result = result.replace(/ /g, '_');\n  }\n\n  return result;\n}\nfunction pathToPoints(cmds, options, font) {\n\n  const parseOpts = (options, defaults) => {\n    if (typeof options !== 'object') {\n      options = defaults;\n    } else {\n      for (const key in defaults) {\n        if (typeof options[key] === 'undefined') {\n          options[key] = defaults[key];\n        }\n      }\n    }\n    return options;\n  };\n\n  const at = (v, i) => {\n    const s = v.length;\n    return v[i < 0 ? i % s + s : i % s];\n  };\n\n  const simplify = (pts, angle) => {\n    angle = angle || 0;\n    let num = 0;\n    for (let i = pts.length - 1; pts.length > 3 && i >= 0; --i) {\n      if (collinear(at(pts, i - 1), at(pts, i), at(pts, i + 1), angle)) {\n        pts.splice(i % pts.length, 1); // Remove middle point\n        num++;\n      }\n    }\n    return num;\n  };\n\n  const path = createFromCommands(arrayCommandsToObjects(cmds));\n  let opts = parseOpts(options, {\n    sampleFactor: 0.1,\n    simplifyThreshold: 0\n  });\n\n  const totalPoints = Math.max(1, Math.ceil(path.getTotalLength() * opts.sampleFactor));\n  let points = [];\n\n  const mode = font._pInst.angleMode();\n  const DEGREES = font._pInst.DEGREES;\n  for (let i = 0; i < totalPoints; i++) {\n    const length = path.getTotalLength() * (\n      totalPoints === 1\n        ? 0\n        : (i / (totalPoints - 1))\n    );\n    points.push({\n      ...path.getPointAtLength(length),\n      get angle() {\n        const angle = path.getAngleAtLength(length);\n        if (mode === DEGREES) {\n          return angle * 180 / Math.PI;\n        } else {\n          return angle;\n        }\n      },\n      // For backwards compatibility\n      get alpha() {\n        return this.angle;\n      }\n    });\n  }\n\n  if (opts.simplifyThreshold) {\n    simplify(points, opts.simplifyThreshold);\n  }\n\n  return points;\n}\n\nfunction unquote(name) {\n  // Unquote name from CSS\n  if ((name.startsWith('\"') || name.startsWith(\"'\")) && name.at(0) === name.at(-1)) {\n    return name.slice(1, -1).replace(/\\/(['\"])/g, '$1');\n  }\n  return name;\n}\n\nfunction parseCreateArgs(...args/*path, name, onSuccess, onError*/) {\n\n  // parse the path\n  let path = args.shift();\n  if (typeof path !== 'string' || path.length === 0) {\n    p5._friendlyError(invalidFontError, 'p5.loadFont'); // ?\n  }\n\n  // parse the name\n  let name;\n  if (typeof args[0] === 'string') {\n    name = args.shift();\n  }\n\n  // get the callbacks/descriptors if any\n  let success, error, options;\n  for (let i = 0; i < args.length; i++) {\n    const arg = args[i];\n    if (typeof arg === 'function') {\n      if (!success) {\n        success = arg;\n      } else {\n        error = arg;\n      }\n    }\n    else if (typeof arg === 'object') {\n      options = arg;\n    }\n  }\n\n  return { path, name, success, error, options };\n}\n\nfunction font(p5, fn) {\n\n  /**\n   * A class to describe fonts. Create through <a href=\"#/p5/loadFont\">`loadFont()`</a>.\n   *\n   * @class p5.Font\n   */\n  p5.Font = Font;\n\n  /**\n   * @private\n   */\n  fn.parseFontData = async function(pathOrData) {\n    // load the raw font bytes\n    let result = pathOrData instanceof Uint8Array\n      ? pathOrData\n      : await fn.loadBytes(pathOrData);\n    //console.log('result:', result);\n\n    if (!result) {\n      throw Error('Failed to load font data');\n    }\n\n    // parse the font data\n    let fonts = Typr.parse(result);\n\n    // TODO: generate descriptors from font in the future\n\n    if (fonts.length === 0 || fonts[0].cmap === undefined) {\n      throw Error('parsing font data');\n    }\n\n    return fonts[0];\n  };\n\n  /**\n   * Loads a font and creates a <a href=\"#/p5.Font\">p5.Font</a> object.\n   * `loadFont()` can load fonts in either .otf or .ttf format. Loaded fonts can\n   * be used to style text on the canvas and in HTML elements.\n   *\n   * The first parameter, `path`, is the path to a font file.\n   * Paths to local files should be relative. For example,\n   * `'assets/inconsolata.otf'`. The Inconsolata font used in the following\n   * examples can be downloaded for free\n   * <a href=\"https://www.fontsquirrel.com/fonts/inconsolata\" target=\"_blank\">here</a>.\n   * Paths to remote files should be URLs. For example,\n   * `'https://example.com/inconsolata.otf'`. URLs may be blocked due to browser\n   * security.\n   *\n   * In 2D mode, `path` can take on a few other forms. It could be a path to a CSS file,\n   * such as one from <a href=\"https://fonts.google.com/\">Google Fonts.</a> It could also\n   * be a string with a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face\">CSS `@font-face` declaration.</a>\n   *\n   * The second parameter, `successCallback`, is optional. If a function is\n   * passed, it will be called once the font has loaded. The callback function\n   * may use the new <a href=\"#/p5.Font\">p5.Font</a> object if needed.\n   *\n   * The third parameter, `failureCallback`, is also optional. If a function is\n   * passed, it will be called if the font fails to load. The callback function\n   * may use the error\n   * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Event\" target=\"_blank\">Event</a>\n   * object if needed.\n   *\n   * Fonts can take time to load. `await` the result of `loadFont()` in\n   * <a href=\"#/p5/setup\">setup()</a> before using the result.\n   *\n   * @method loadFont\n   * @for p5\n   * @param  {String}        path       path of the font or CSS file to be loaded, or a CSS `@font-face` string.\n   * @param  {String}        [name]            An alias that can be used for this font in `textFont()`. Defaults to the name in the font's metadata.\n   * @param  {Object}        [options]         An optional object with extra CSS font face descriptors, or p5.js font settings.\n   * @param  {String|Array<String>} [options.sets] (Experimental) An optional string of list of strings with Unicode character set names that should be included. When a CSS file is used as the font, it may contain multiple font files. The font best matching the requested character sets will be picked.\n   * @param  {Function}      [successCallback] function called with the\n   *                                           <a href=\"#/p5.Font\">p5.Font</a> object after it\n   *                                           loads.\n   * @param  {Function}      [failureCallback] function called with the error\n   *                                           <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Event\" target=\"_blank\">Event</a>\n   *                                           object if the font fails to load.\n   * @return {Promise<p5.Font>}                         <a href=\"#/p5.Font\">p5.Font</a> object.\n   * @example\n   * <div>\n   * <code>\n   * let font;\n   *\n   * async function setup() {\n   *   createCanvas(100, 100);\n   *   font = await loadFont('assets/inconsolata.otf');\n   *   fill('deeppink');\n   *   textFont(font);\n   *   textSize(36);\n   *   text('p5*js', 10, 50);\n   *\n   *   describe('The text \"p5*js\" written in pink on a white background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   loadFont('assets/inconsolata.otf', font => {\n   *     fill('deeppink');\n   *     textFont(font);\n   *     textSize(36);\n   *     text('p5*js', 10, 50);\n   *\n   *     describe('The text \"p5*js\" written in pink on a white background.');\n   *   });\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * function setup() {\n   *   createCanvas(100, 100);\n   *   loadFont('assets/inconsolata.otf', success, failure);\n   * }\n   *\n   * function success(font) {\n   *   fill('deeppink');\n   *   textFont(font);\n   *   textSize(36);\n   *   text('p5*js', 10, 50);\n   *\n   *   describe('The text \"p5*js\" written in pink on a white background.');\n   * }\n   *\n   * function failure(event) {\n   *   console.error('Oops!', event);\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div>\n   * <code>\n   * async function setup() {\n   *   createCanvas(100, 100);\n   *   await loadFont('assets/inconsolata.otf');\n   *   let p = createP('p5*js');\n   *   p.style('color', 'deeppink');\n   *   p.style('font-family', 'Inconsolata');\n   *   p.style('font-size', '36px');\n   *   p.position(10, 50);\n   *\n   *   describe('The text \"p5*js\" written in pink on a white background.');\n   * }\n   * </code>\n   * </div>\n   *\n   * @example\n   * <div class=\"norender\">\n   * <code>\n   * // Some other forms of loading fonts:\n   * loadFont(\"https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&display=swap\");\n   * loadFont(`@font-face { font-family: \"Bricolage Grotesque\", serif; font-optical-sizing: auto; font-weight: 400; font-style: normal; font-variation-settings: \"wdth\" 100; }`);\n   * </code>\n   * </div>\n   */\n  /**\n    * @method loadFont\n    * @for p5\n    * @param  {String}        path              path of the font to be loaded.\n    * @param  {Function}      [successCallback] function called with the\n    *                                           <a href=\"#/p5.Font\">p5.Font</a> object after it\n    *                                           loads.\n    * @param  {Function}      [failureCallback] function called with the error\n    *                                           <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Event\" target=\"_blank\">Event</a>\n    *                                           object if the font fails to load.\n    * @returns {Promise<p5.Font>} The font.\n    */\n  fn.loadFont = async function (...args/*path, name, onSuccess, onError, descriptors*/) {\n\n    let { path, name, success, error, options: { sets, ...descriptors } = {} } = parseCreateArgs(...args);\n\n    let isCSS = path.includes('@font-face');\n\n    if (!isCSS) {\n      const info = await fetch(path, { method: 'HEAD' });\n      const isCSSFile = info.headers.get('content-type')?.startsWith('text/css');\n      if (isCSSFile) {\n        isCSS = true;\n        path = await fetch(path).then((res) => res.text());\n      }\n    }\n\n    if (isCSS) {\n      const stylesheet = new CSSStyleSheet();\n      await stylesheet.replace(path);\n      const possibleFonts = [];\n      for (const rule of stylesheet.cssRules) {\n        if (rule instanceof CSSFontFaceRule) {\n          const style = rule.style;\n          let name = unquote(style.getPropertyValue('font-family'));\n          const src = style.getPropertyValue('src');\n          const fontDescriptors = { ...(descriptors || {}) };\n          for (const key of style) {\n            if (key === 'font-family' || key === 'src') continue;\n            const camelCaseKey = key\n              .replace(/^font-/, '')\n              .split('-')\n              .map((v, i) => i === 0 ? v : `${v[0].toUpperCase()}${v.slice(1)}`)\n              .join('');\n            fontDescriptors[camelCaseKey] = style.getPropertyValue(key);\n          }\n          possibleFonts.push({\n            name,\n            src,\n            fontDescriptors,\n            loadWithData: async () => {\n              let fontData;\n              try {\n                const urlMatch = /url\\(([^\\)]+)\\)/.exec(src);\n                if (urlMatch) {\n                  let url = urlMatch[1];\n                  if (/^['\"]/.exec(url) && url.at(0) === url.at(-1)) {\n                    url = url.slice(1, -1);\n                  }\n                  fontData = await fn.parseFontData(url);\n                }\n              } catch (_e) {}\n              return create(this, name, src, fontDescriptors, fontData)\n            },\n            loadWithoutData: () => create(this, name, src, fontDescriptors)\n          });\n        }\n      }\n\n      // TODO: handle multiple font faces?\n      sets = sets || ['latin']; // Default to latin for now if omitted\n      const requestedGroups = (sets instanceof Array ? sets : [sets])\n        .map(s => s.toLowerCase());\n      // Grab thr named groups with names that include the requested keywords\n      const requestedCategories = unicodeRanges\n        .filter((r) => requestedGroups.some(\n          g => r.category.includes(g) &&\n            // Only include extended character sets if specifically requested\n            r.category.includes('ext') === g.includes('ext')\n        ));\n      const requestedRanges = new Set(\n        UnicodeRange.parse(\n          requestedCategories.map((c) => `U+${c.hexrange[0]}-${c.hexrange[1]}`)\n        )\n      );\n      let closestRangeOverlap = 0;\n      let closestDescriptorOverlap = 0;\n      let closestMatch = undefined;\n      for (const font of possibleFonts) {\n        if (!font.fontDescriptors.unicodeRange) continue;\n        const fontRange = new Set(\n          UnicodeRange.parse(\n            font.fontDescriptors.unicodeRange.split(/,\\s*/g)\n          )\n        );\n        const rangeOverlap = [...fontRange.values()]\n          .filter(v => requestedRanges.has(v))\n          .length;\n\n        const targetDescriptors = {\n          // Default to normal style at regular weight\n          style: 'normal',\n          weight: 400,\n          // Override from anything else passed in\n          ...descriptors\n        };\n        const descriptorOverlap = Object.keys(font.fontDescriptors)\n          .filter(k => font.fontDescriptors[k] === targetDescriptors[k])\n          .length;\n\n        if (\n          descriptorOverlap > closestDescriptorOverlap ||\n          (descriptorOverlap === closestDescriptorOverlap && rangeOverlap >= closestRangeOverlap)\n        ) {\n          closestDescriptorOverlap = descriptorOverlap;\n          closestRangeOverlap = rangeOverlap;\n          closestMatch = font;\n        }\n      }\n      const picked = (closestMatch || possibleFonts.at(-1));\n      for (const font of possibleFonts) {\n        if (font !== picked) {\n          // Load without parsing data with Typr so that it still can be accessed\n          // via regular CSS by name\n          font.loadWithoutData();\n        }\n      }\n      return picked?.loadWithData();\n    }\n\n    let pfont;\n    try {\n      const fontData = await fn.parseFontData(path);\n\n      // make sure we have a valid name\n      name = name || extractFontName(fontData, path);\n\n      // create a FontFace object and pass it to the p5.Font constructor\n      pfont = await create(this, name, path, descriptors, fontData);\n\n    } catch (err) {\n      // failed to parse the font, load it as a simple FontFace\n      let ident = name || path\n        .substring(path.lastIndexOf('/') + 1)\n        .replace(/\\.[^/.]+$/, \"\");\n\n      console.warn(`WARN: No glyph data for '${ident}', retrying as FontFace`);\n\n      try {\n        // create a FontFace object and pass it to p5.Font\n        pfont = await create(this, ident, path, descriptors);\n      }\n      catch (err) {\n        if (error) return error(err);\n        throw err;\n      }\n    }\n    if (success) return success(pfont);\n\n    return pfont;\n  };\n}\n// Convert arrays to named objects\nconst arrayCommandsToObjects = (commands) => commands.map((command) => {\n  const type = command[0];\n  switch (type) {\n    case 'Z': {\n      return { type };\n    }\n    case 'M':\n    case 'L': {\n      const [, x, y] = command;\n      return { type, x, y };\n    }\n    case 'Q': {\n      const [, x1, y1, x, y] = command;\n      return { type, x1, y1, x, y };\n    }\n    case 'C': {\n      const [, x1, y1, x2, y2, x, y] = command;\n      return { type, x1, y1, x2, y2, x, y };\n    }\n    default: {\n      throw new Error(`Unexpected path command: ${type}`);\n    }\n  }\n});\n\nif (typeof p5 !== 'undefined') {\n  font(p5, p5.prototype);\n}\n\nexport { Font, arrayCommandsToObjects, font as default };\n","import { parse } from 'acorn';\nimport { ancestor } from 'acorn-walk';\nimport escodegen from 'escodegen';\n\nvar noiseGLSL = \"// Based on https://github.com/patriciogonzalezvivo/lygia/blob/main/generative/noise.glsl (MIT)\\n// Adapted for use in p5.strands\\n\\nvec2 random2(vec2 st) {\\n  st = vec2(dot(st, vec2(127.1, 311.7)),\\n            dot(st, vec2(269.5, 183.3)));\\n  return -1.0 + 2.0 * fract(sin(st) * 43758.5453123);\\n}\\n\\nfloat baseNoise(vec2 st) {\\n  vec2 i = floor(st);\\n  vec2 f = fract(st);\\n\\n  vec2 a = random2(i);\\n  vec2 b = random2(i + vec2(1.0, 0.0));\\n  vec2 c = random2(i + vec2(0.0, 1.0));\\n  vec2 d = random2(i + vec2(1.0, 1.0));\\n\\n  vec2 u = f * f * (3.0 - 2.0 * f);\\n\\n  return mix(mix(dot(a, f - vec2(0.0, 0.0)), \\n                 dot(b, f - vec2(1.0, 0.0)), u.x),\\n             mix(dot(c, f - vec2(0.0, 1.0)), \\n                 dot(d, f - vec2(1.0, 1.0)), u.x), u.y);\\n}\\n\\n// Fractal noise using 4 octaves\\nfloat noise(vec2 st) {\\n  float result = 0.0;\\n  float amplitude = 1.0;\\n  float frequency = 1.0;\\n\\n  for (int i = 0; i < 4; i++) {\\n    result += amplitude * baseNoise(st * frequency);\\n    frequency *= 2.0;\\n    amplitude *= 0.5;\\n  }\\n\\n  return result;\\n}\\n\";\n\n/**\n* @module 3D\n* @submodule ShaderGenerator\n* @for p5\n* @requires core\n*/\n\nfunction shadergenerator(p5, fn) {\n\n  let GLOBAL_SHADER;\n  let BRANCH;\n\n  const oldModify = p5.Shader.prototype.modify;\n\n  p5.Shader.prototype.modify = function(shaderModifier, scope = {}) {\n    if (shaderModifier instanceof Function) {\n      // TODO make this public. Currently for debugging only.\n      const options = { srcLocations: false };\n      let generatorFunction;\n      {\n        // #7955 Wrap function declaration code in brackets so anonymous functions are not top level statements, which causes an error in acorn when parsing\n        // https://github.com/acornjs/acorn/issues/1385\n        const sourceString = `(${shaderModifier.toString()})`;\n        const ast = parse(sourceString, {\n          ecmaVersion: 2021,\n          locations: options.srcLocations\n        });\n        ancestor(ast, ASTCallbacks, undefined, { varyings: {} });\n        const transpiledSource = escodegen.generate(ast);\n        const scopeKeys = Object.keys(scope);\n        const internalGeneratorFunction = new Function(\n          // Create a parameter called __p5, not just p5, because users of instance mode\n          // may pass in a variable called p5 as a scope variable. If we rely on a variable called\n          // p5, then the scope variable called p5 might accidentally override internal function\n          // calls to p5 static methods.\n          '__p5',\n          ...scopeKeys,\n          transpiledSource\n          .slice(\n            transpiledSource.indexOf('{') + 1,\n            transpiledSource.lastIndexOf('}')\n          ).replaceAll(';', '')\n        );\n        generatorFunction = () => internalGeneratorFunction(p5, ...scopeKeys.map(key => scope[key]));\n      }\n      const generator = new ShaderGenerator(generatorFunction, this, options.srcLocations);\n      const generatedModifyArgument = generator.generate();\n      return oldModify.call(this, generatedModifyArgument);\n    }\n    else {\n      return oldModify.call(this, shaderModifier)\n    }\n  };\n\n  // AST Transpiler Callbacks and helper functions\n  function replaceBinaryOperator(codeSource) {\n    switch (codeSource) {\n      case '+': return 'add';\n      case '-': return 'sub';\n      case '*': return 'mult';\n      case '/': return 'div';\n      case '%': return 'mod';\n      case '==':\n      case '===': return 'equalTo';\n      case '>': return 'greaterThan';\n      case '>=': return 'greaterThanEqualTo';\n      case '<': return 'lessThan';\n      case '&&': return 'and';\n      case '||': return 'or';\n    }\n  }\n\n  function nodeIsUniform(ancestor) {\n    return ancestor.type === 'CallExpression'\n      && (\n        (\n          // Global mode\n          ancestor.callee?.type === 'Identifier' &&\n          ancestor.callee?.name.startsWith('uniform')\n        ) || (\n          // Instance mode\n          ancestor.callee?.type === 'MemberExpression' &&\n          ancestor.callee?.property.name.startsWith('uniform')\n        )\n      );\n  }\n\n  const ASTCallbacks = {\n    UnaryExpression(node, _state, ancestors) {\n      if (ancestors.some(nodeIsUniform)) { return; }\n\n      const signNode = {\n        type: 'Literal',\n        value: node.operator,\n      };\n\n      const standardReplacement = (node) => {\n          node.type = 'CallExpression';\n          node.callee = {\n            type: 'Identifier',\n            name: '__p5.unaryNode',\n          };\n          node.arguments = [node.argument, signNode];\n      };\n\n      if (node.type === 'MemberExpression') {\n        const property = node.argument.property.name;\n        const swizzleSets = [\n          ['x', 'y', 'z', 'w'],\n          ['r', 'g', 'b', 'a'],\n          ['s', 't', 'p', 'q']\n        ];\n\n        let isSwizzle = swizzleSets.some(set =>\n          [...property].every(char => set.includes(char))\n        ) && node.argument.type === 'MemberExpression';\n\n        if (isSwizzle) {\n          node.type = 'MemberExpression';\n          node.object = {\n            type: 'CallExpression',\n            callee: {\n              type: 'Identifier',\n              name: '__p5.unaryNode'\n            },\n            arguments: [node.argument.object, signNode],\n          };\n          node.property = {\n            type: 'Identifier',\n            name: property\n          };\n        } else {\n          standardReplacement(node);\n        }\n      } else {\n        standardReplacement(node);\n      }\n      delete node.argument;\n      delete node.operator;\n    },\n    VariableDeclarator(node, _state, ancestors) {\n      if (ancestors.some(nodeIsUniform)) { return; }\n      if (nodeIsUniform(node.init)) {\n        const uniformNameLiteral = {\n          type: 'Literal',\n          value: node.id.name\n        };\n        node.init.arguments.unshift(uniformNameLiteral);\n      }\n      if (node.init.callee && node.init.callee.name?.startsWith('varying')) {\n        const varyingNameLiteral = {\n          type: 'Literal',\n          value: node.id.name\n        };\n        node.init.arguments.unshift(varyingNameLiteral);\n        _state.varyings[node.id.name] = varyingNameLiteral;\n      }\n    },\n    Identifier(node, _state, ancestors) {\n      if (ancestors.some(nodeIsUniform)) { return; }\n      if (_state.varyings[node.name]\n          && !_ancestors.some(a => a.type === 'AssignmentExpression' && a.left === node)) {\n        node.type = 'ExpressionStatement';\n        node.expression = {\n          type: 'CallExpression',\n          callee: {\n            type: 'MemberExpression',\n            object: {\n              type: 'Identifier',\n              name: node.name\n            },\n            property: {\n              type: 'Identifier',\n              name: 'getValue'\n            },\n          },\n          arguments: [],\n        };\n      }\n    },\n    // The callbacks for AssignmentExpression and BinaryExpression handle\n    // operator overloading including +=, *= assignment expressions\n    ArrayExpression(node, _state, ancestors) {\n      if (ancestors.some(nodeIsUniform)) { return; }\n      const original = JSON.parse(JSON.stringify(node));\n      node.type = 'CallExpression';\n      node.callee = {\n        type: 'Identifier',\n        name: '__p5.dynamicNode',\n      };\n      node.arguments = [original];\n    },\n    AssignmentExpression(node, _state, ancestors) {\n      if (ancestors.some(nodeIsUniform)) { return; }\n      if (node.operator !== '=') {\n        const methodName = replaceBinaryOperator(node.operator.replace('=',''));\n        const rightReplacementNode = {\n          type: 'CallExpression',\n          callee: {\n            type: 'MemberExpression',\n            object: node.left,\n            property: {\n              type: 'Identifier',\n              name: methodName,\n            },\n          },\n          arguments: [node.right]\n        };\n          node.operator = '=';\n          node.right = rightReplacementNode;\n        }\n        if (_state.varyings[node.left.name]) {\n          node.type = 'ExpressionStatement';\n          node.expression = {\n            type: 'CallExpression',\n            callee: {\n              type: 'MemberExpression',\n              object: {\n                type: 'Identifier',\n                name: node.left.name\n              },\n              property: {\n                type: 'Identifier',\n                name: 'bridge',\n              }\n            },\n            arguments: [node.right],\n          };\n        }\n      },\n    BinaryExpression(node, _state, ancestors) {\n      // Don't convert uniform default values to node methods, as\n      // they should be evaluated at runtime, not compiled.\n      if (ancestors.some(nodeIsUniform)) { return; }\n      // If the left hand side of an expression is one of these types,\n      // we should construct a node from it.\n      const unsafeTypes = ['Literal', 'ArrayExpression', 'Identifier'];\n      if (unsafeTypes.includes(node.left.type)) {\n        const leftReplacementNode = {\n          type: 'CallExpression',\n          callee: {\n            type: 'Identifier',\n            name: '__p5.dynamicNode',\n          },\n          arguments: [node.left]\n        };\n        node.left = leftReplacementNode;\n      }\n      // Replace the binary operator with a call expression\n      // in other words a call to BaseNode.mult(), .div() etc.\n      node.type = 'CallExpression';\n      node.callee = {\n        type: 'MemberExpression',\n        object: node.left,\n        property: {\n          type: 'Identifier',\n          name: replaceBinaryOperator(node.operator),\n        },\n      };\n      node.arguments = [node.right];\n    },\n  };\n\n  // Javascript Node API.\n  class BaseNode {\n    constructor(isInternal, type) {\n      if (new.target === BaseNode) {\n        throw new TypeError('Cannot construct BaseNode instances directly. This is an abstract class.');\n      }\n      this.type = type;\n      this.componentNames = [];\n      this.componentsChanged = false;\n      // For tracking recursion depth and creating temporary variables\n      this.isInternal = isInternal;\n      this.usedIn = [];\n      this.dependsOn = [];\n      this.srcLine = null;\n      this.usedInConditional = false;\n      // Stack Capture is used to get the original line of user code for Debug purposes\n      if (GLOBAL_SHADER.srcLocations === true && isInternal === false) {\n        try {\n          throw new Error('StackCapture');\n        } catch (e) {\n          const lines = e.stack.split('\\n');\n          let userSketchLineIndex = 5;\n          if (isBinaryExpressionNode(this)) { userSketchLineIndex--; }          this.srcLine = lines[userSketchLineIndex].trim();\n        }\n      }\n    }\n\n    addVectorComponents() {\n      if (this.type.startsWith('vec')) {\n        const vectorDimensions = parseInt(this.type.slice(3));\n        this.componentNames = ['x', 'y', 'z', 'w'].slice(0, vectorDimensions);\n        const proxy = this;\n        for (let componentName of this.componentNames) {\n          let value = new ComponentNode(proxy, componentName, 'float', true);\n          Object.defineProperty(this, componentName, {\n            get() {\n              return value;\n            },\n            set(newValue) {\n              this.componentsChanged = true;\n              if (isUnaryExpressionNode(this)) {\n                this.node.value = newValue;\n              } else {\n                value = newValue;\n              }\n            }\n          });\n        }\n      }\n    }\n\n    forceTemporaryVariable() {\n      if (!(isFloatNode(this) && isVectorNode(this.parent)) || !isVariableNode(this))\n      this.useTemp = true;\n    }\n\n    assertUsedInConditional(branch) {\n      this.usedInConditional = true;\n      this.usedIn.push(branch);\n      this.forceTemporaryVariable();\n    }\n\n    isUsedInConditional() {\n      return this.usedInConditional;\n    }\n\n    checkConditionalDependencies(context) {\n      context.ifs.forEach((statement) => {\n        const isUsedSatisfied = () => statement.usedInSatisfied.length >= 1;\n        const isDepsSatisfied = () => statement.dependsOn.length === statement.dependsOnSatisfied.length;\n        if (statement.insertionPoint > -1 || !statement.usedIn.length) return;\n        if (statement.dependsOn.some(d => d.node === this) && !statement.dependsOnSatisfied.includes(this)) {\n          statement.dependsOnSatisfied.push(this);\n        }\n        if (statement.usedIn.includes(this) && !statement.usedInSatisfied.includes(this)) {\n          statement.usedInSatisfied.push(this);\n        }\n        if (isDepsSatisfied() && isUsedSatisfied()) {\n          statement.saveState(context, isDepsSatisfied(), isUsedSatisfied());\n        }\n      });\n    }\n\n    // The base node implements a version of toGLSL which determines whether the generated code should be stored in a temporary variable.\n    toGLSLBase(context){\n      let result;\n      if (this.shouldUseTemporaryVariable()) {\n        let oldLength = context.declarations.length;\n        result = this.getTemporaryVariable(context);\n        let diff = context.declarations.length - 1 - oldLength;\n        diff = diff > 0 ? diff : undefined;\n        this.dependsOn.forEach(dependency => {\n          if (dependency.isVector) {\n            const dependencies = dependency.originalComponents.map((component, i) =>\n              component === dependency.currentComponents[i]\n            );\n            context.updateComponents(dependency.node, diff, dependencies);\n          } else {\n            context.updateComponents(dependency.node, diff);\n          }\n        });\n      } else {\n        result = this.toGLSL(context);\n      }\n      this.checkConditionalDependencies(context);\n      return result;\n    }\n\n    shouldUseTemporaryVariable() {\n      if (this.componentsChanged || hasTemporaryVariable(this) || this.useTemp) { return true; }\n      if (this.isInternal || isVariableNode(this) || isConditionalNode(this) || this.type === 'sampler2D') { return false; }\n\n      // return false;\n      // Swizzles must use temporary variables as otherwise they will not be registered\n      let score = 0;\n      score += isFunctionCallNode(this) * 2;\n      score += isBinaryExpressionNode(this) * 2;\n      score += isVectorType(this) * 3;\n      score += this.usedIn.length;\n      return score >= 4;\n    }\n\n    getTemporaryVariable(context) {\n      if (!this.temporaryVariable) {\n        this.temporaryVariable = `temp_${context.getNextID()}`;\n        let line = '';\n        if (this.srcLine) {\n          line += `\\n// From ${this.srcLine}\\n`;\n        }\n        line += '  ' + this.type + ' ' + this.temporaryVariable + ' = ' + this.toGLSL(context) + ';';\n        context.declarations.push(line);\n      }\n      return this.temporaryVariable;\n    };\n\n    // Binary Operators\n    add(other)  { return binaryExpressionNodeConstructor(this, this.enforceType(other), '+'); }\n    sub(other)  { return binaryExpressionNodeConstructor(this, this.enforceType(other), '-'); }\n    mult(other) { return binaryExpressionNodeConstructor(this, this.enforceType(other), '*'); }\n    div(other)  { return binaryExpressionNodeConstructor(this, this.enforceType(other), '/'); }\n    mod(other)  { return binaryExpressionNodeConstructor(this, this.enforceType(other), '%'); }\n\n    // Check that the types of the operands are compatible.\n    enforceType(other){\n      if (isShaderNode(other)){\n        if (!isGLSLNativeType(other.type)) {\n          throw new TypeError (`You've tried to perform an operation on a struct of type: ${other.type}. Try accessing a member on that struct with '.'`)\n        }\n        if (!isGLSLNativeType(other.type)) {\n          throw new TypeError (`You've tried to perform an operation on a struct of type: ${other.type}. Try accessing a member on that struct with '.'`)\n        }\n        if ((isFloatType(this) || isVectorType(this)) && isIntType(other)) {\n          return new FloatNode(other)\n        }\n        return other;\n      }\n      else if (typeof other === 'number') {\n        if (isIntType(this)) {\n          return new IntNode(other);\n        }\n        return new FloatNode(other);\n      }\n      else if (Array.isArray(other)) {\n        return nodeConstructors.dynamicVector(other);\n        // return nodeConstructors[`vec${other.length}`](other);\n      }\n      else {\n        return nodeConstructors[this.type](other);\n      }\n    }\n\n    toFloat() {\n      if (isFloatType(this)) {\n        return this;\n      } else if (isIntType(this)) {\n        return new FloatNode(this);\n      }\n    }\n\n    toGLSL(context){\n      throw new TypeError('Not supposed to call this function on BaseNode, which is an abstract class.');\n    }\n  }\n\n  // Primitive Types\n  class IntNode extends BaseNode {\n    constructor(x = 0, isInternal = false) {\n      super(isInternal, 'int');\n      this.x = x;\n    }\n\n    toGLSL(context) {\n      if (isShaderNode(this.x)) {\n        let code = this.x.toGLSLBase(context);\n        return isIntType(this.x.type) ? code : `int(${code})`;\n      }\n      else if (typeof this.x === 'number') {\n        return `${Math.floor(this.x)}`;\n      }\n      else {\n        return `int(${this.x})`;\n      }\n    }\n  }\n\n  class FloatNode extends BaseNode {\n    constructor(x = 0, isInternal = false, _parent = false){\n      super(isInternal, 'float');\n      if (Array.isArray(x)) {\n        x = x[0];\n      }\n      if (_parent) {\n        const { parent, name } = _parent;\n        this.name = name;\n        this.parent = parent;\n      }\n      this.x = x;\n    }\n\n    toGLSL(context) {\n      if (isShaderNode(this.x)) {\n        let code = this.x.toGLSLBase(context);\n        return isFloatType(this.x) ? code : `float(${code})`;\n      }\n      else if (typeof this.x === 'number') {\n        return `${this.x.toFixed(4)}`;\n      }\n      else {\n        return `float(${this.x})`;\n      }\n    }\n  }\n\n  class VectorNode extends BaseNode {\n    constructor(values, type, isInternal = false) {\n      super(isInternal, type);\n      this.originalValues = conformVectorParameters(values, parseInt(type.slice(3)));\n      this.componentNames = ['x', 'y', 'z', 'w'].slice(0, this.originalValues.length);\n    }\n\n    addVectorComponents() {\n      const values = this.originalValues;\n      this.componentsChanged = false;\n\n      this.componentNames.forEach((componentName, i) => {\n        const info = { name: componentName, parent: this };\n        let value = isFloatNode(values[i]) ? values[i] : new FloatNode(values[i], true, info);\n        Object.defineProperty(this, componentName, {\n          get() {\n            return value;\n          },\n          set(newValue) {\n            this.componentsChanged = true;\n            if (isUnaryExpressionNode(this)) {\n              this.node.value = newValue;\n            } else {\n              value = isFloatNode(newValue) ? newValue : new FloatNode(newValue, true, info);\n            }\n          }\n        });\n      });\n      this.originalValues = this.componentNames.map(name => this[name]);\n    }\n\n    toGLSL(context) {\n      if ((!this.componentsChanged || !this.defined) && !this.oldName) {\n        let glslArgs = this.componentNames.map((_name, i) => this.originalValues[i].toGLSLBase(context)).join(', ');\n        this.defined = true;\n        return `${this.type}(${glslArgs})`;\n      } else {\n        return this.temporaryVariable;\n      }\n    }\n  }\n\n  // Function Call Nodes\n  class FunctionCallNode extends BaseNode {\n    constructor(name, userArgs, properties, isInternal = false) {\n      let functionSignature;\n      const determineFunctionSignature = (props) => {\n        let genType;\n        let similarity = 0;\n\n        const valid = userArgs.every((userArg, i) => {\n          const userType = getType(userArg);\n          let expectedArgType = props.args[i];\n\n          if (expectedArgType === 'genType') {\n            // We allow conversions from float -> vec if one argument is a vector.\n            if (genType === undefined || (genType === 'float' && userType.startsWith('vec'))) {\n              genType = userType;\n            }            expectedArgType = genType;\n          }\n          similarity += (userType === expectedArgType);\n          return userType === expectedArgType || (userType === 'float' && expectedArgType.startsWith('vec'));\n        });\n\n        return { ...props, valid, similarity, genType }\n      };\n\n      if (Array.isArray(properties)) {\n        // Check if the right number of parameters were provided\n        let possibleOverloads = properties.filter(o => o.args.length === userArgs.length);\n        if (possibleOverloads.length === 0) {\n          const argsLengthSet = new Set();\n          const argsLengthArr = [];\n          properties.forEach((p) => argsLengthSet.add(p.args.length));\n          argsLengthSet.forEach((len) => argsLengthArr.push(`${len}`));\n          const argsLengthStr = argsLengthArr.join(' or ');\n          throw new Error(`Function '${name}' has ${properties.length} variants which expect ${argsLengthStr} arguments, but ${userArgs.length} arguments were provided.`);\n        }\n        const findBestOverload = function (best, current) {\n          current = determineFunctionSignature(current);\n          if (!current.valid) { return best; }\n          if (!best || current.similarity > best.similarity) {\n            best = current;\n          }\n          return best;\n        };\n        functionSignature = possibleOverloads.reduce(findBestOverload, null);\n      } else {\n        functionSignature = determineFunctionSignature(properties);\n      }\n\n      if (!functionSignature || !functionSignature.valid) {\n        const argsStrJoin = (args) => `(${args.map((arg) => arg).join(', ')})`;\n        const expectedArgsString = Array.isArray(properties) ?\n          properties.map(prop => argsStrJoin(prop.args)).join(' or ')\n          : argsStrJoin(properties.args);\n        const providedArgsString = argsStrJoin(userArgs.map((a)=>getType(a)));\n          throw new Error(`Function '${name}' was called with wrong arguments. Most likely, you provided mixed lengths vectors as arguments.\\nExpected argument types: ${expectedArgsString}\\nProvided argument types: ${providedArgsString}\\nAll of the arguments with expected type 'genType' should have a matching type. If one of those is different, try to find where it was created.\n        `);\n      }\n\n      if (userArgs.length !== functionSignature.args.length) {\n        throw new Error(`Function '${name}' expects ${functionSignature.args.length} arguments, but ${userArgs.length} were provided.`);\n      }\n\n      userArgs = userArgs.map((arg, i) => {\n        if (!isShaderNode(arg)) {\n          const typeName = functionSignature.args[i] === 'genType' ? functionSignature.genType : functionSignature.args[i];\n          arg = nodeConstructors[typeName](arg);\n        } else if (isFloatType(arg) && functionSignature.args[i] === 'genType' && functionSignature.genType !== 'float') {\n          arg = nodeConstructors[functionSignature.genType](arg);\n        }\n        return arg;\n      });\n\n      if (functionSignature.returnType === 'genType') {\n        functionSignature.returnType = functionSignature.genType;\n      }\n\n      super(isInternal, functionSignature.returnType);\n\n      this.name = name;\n      this.args = userArgs;\n      this.argumentTypes = functionSignature.args;\n    }\n\n    deconstructArgs(context) {\n      let argsString = this.args.map((argNode, i) => {\n        if (isIntType(argNode) && this.argumentTypes[i] != 'float') {\n          argNode = argNode.toFloat();\n        }\n        argNode.toGLSLBase(context);\n        return argNode.toGLSLBase(context);\n      }).join(', ');\n      return argsString;\n    }\n\n    toGLSL(context) {\n      return `${this.name}(${this.deconstructArgs(context)})`;\n    }\n  }\n\n  // Variables and member variable nodes\n  class VariableNode extends BaseNode {\n    constructor(name, type, isInternal = false) {\n      super(isInternal, type);\n      this.name = name;\n    }\n\n    toGLSL(context) {\n      return `${this.name}`;\n    }\n  }\n\n  class ComponentNode extends BaseNode {\n    constructor(parent, componentName, type, isInternal = false) {\n      super(isInternal, type);\n      this.parent = parent;\n      this.componentName = componentName;\n      this.type = type;\n    }\n    toGLSL(context) {\n      let parentName = this.parent.toGLSLBase(context);\n      if (!isVariableNode(this.parent) && !hasTemporaryVariable(this.parent)) {\n        parentName = `(${parentName})`;\n      }\n      return `${parentName}.${this.componentName}`;\n    }\n  }\n\n  //\n  class VaryingNode extends VariableNode {\n    constructor(name, type, isInternal = false) {\n      super(name, type, isInternal);\n      this.timesChanged = 0;\n      this.tempVars = 0;\n    }\n\n    getValue() {\n      const context = GLOBAL_SHADER.context;\n      if (!context.varyings[this.name] || !this.timesChanged) {\n        return this;\n      }\n\n      let values = context.varyings[this.name].splice(0, this.timesChanged);\n      let snapshot;\n      values.forEach((val, i) => {\n        let { value } = val;\n        context.declarations.push(`  ${this.name} = ${value.toGLSLBase(context)};`);\n        if (i === values.length - 1) {\n          const tempName = `${this.name}_${this.tempVars++}`;\n          snapshot = dynamicAddSwizzleTrap(new VariableNode(tempName, this.type, true));\n          context.declarations.push(`  ${this.type} ${tempName} = ${this.name};`);\n        }\n      });\n\n      this.timesChanged = 0;\n      return snapshot;\n    }\n\n    bridge(value) {\n      if (!isShaderNode(value) || this.type.startsWith('vec') && getType(value) === 'float') {\n        value = nodeConstructors[this.type](value);\n      }\n      GLOBAL_SHADER.registerVarying(this, value);\n      this.timesChanged += 1;\n    }\n  }\n\n  // Binary Operator Nodes\n  class BinaryExpressionNode extends BaseNode {\n    constructor(left, right, operator, isInternal = false) {\n      super(isInternal, null);\n      this.operator = operator;\n      this.left = left;\n      this.right = right;\n      for (const operand of [left, right]) {\n        operand.usedIn.push(this);\n      }\n      this.type = this.determineType();\n    }\n\n    // We know that both this.left and this.right are nodes because of BaseNode.enforceType\n    determineType() {\n      if (['==', '>', '>=', '<', '<=', '||', '!', '&&'].includes(this.operator)) {\n        return 'bool';\n      }\n      else if (this.left.type === this.right.type) {\n        return this.left.type;\n      }\n      else if (isVectorType(this.left) && isFloatType(this.right)) {\n        return this.left.type;\n      }\n      else if (isVectorType(this.right) && isFloatType(this.left)) {\n        return this.right.type;\n      }\n      else if (isFloatType(this.left) && isIntType(this.right)\n        || isIntType(this.left) && isFloatType(this.right)\n      ) {\n        return 'float';\n      }\n      else {\n        throw new Error('Incompatible types for binary operator');\n      }\n    }\n\n    processOperand(operand, context) {\n      if (operand.temporaryVariable) { return operand.temporaryVariable; }\n      let code = operand.toGLSLBase(context);\n      if (isBinaryExpressionNode(operand) && !operand.temporaryVariable) {\n        code = `(${code})`;\n      }\n      if (this.type === 'float' && isIntType(operand)) {\n        code = `float(${code})`;\n      }\n      return code;\n    }\n\n    toGLSL(context) {\n      const a = this.processOperand(this.left, context);\n      const b = this.processOperand(this.right, context);\n      return `${a} ${this.operator} ${b}`;\n    }\n  }\n\n  class ModulusNode extends BinaryExpressionNode {\n    constructor(a, b, isInternal) {\n      super(a, b, isInternal);\n    }\n    toGLSL(context) {\n      // Switch on type between % or mod()\n      if (isVectorType(this) || isFloatType(this)) {\n        return `mod(${this.left.toGLSLBase(context)}, ${this.right.toGLSLBase(context)})`;\n      }\n      return `${this.processOperand(context, this.left)} % ${this.processOperand(context, this.right)}`;\n    }\n  }\n\n  class UnaryExpressionNode extends BaseNode {\n    constructor(node, operator, isInternal = false) {\n      super(isInternal, node.type);\n      this.node = node;\n      this.operator = operator;\n    }\n\n    toGLSL(context) {\n      let mainStr = this.node.toGLSLBase(context);\n      if (!isVariableNode(this.node) && !hasTemporaryVariable(this.node) && !isPrimitiveNode(this.node)) {\n        mainStr = `(${mainStr})`;\n      }\n      return `${this.operator}${mainStr}`\n    }\n  }\n\n  // Conditions and logical modifiers\n  BaseNode.prototype.equalTo = function(other) {\n    return binaryExpressionNodeConstructor(this, this.enforceType(other), '==');\n  };\n\n  BaseNode.prototype.greaterThan = function(other) {\n    return binaryExpressionNodeConstructor(this, this.enforceType(other), '>');\n  };\n\n  BaseNode.prototype.greaterThanEqualTo = function(other) {\n    return binaryExpressionNodeConstructor(this, this.enforceType(other), '>=');\n  };\n\n  BaseNode.prototype.lessThan = function(other) {\n    return binaryExpressionNodeConstructor(this, this.enforceType(other), '<');\n  };\n\n  BaseNode.prototype.lessThanEqualTo = function(other) {\n    return binaryExpressionNodeConstructor(this, this.enforceType(other), '<='); };\n\n  BaseNode.prototype.not = function() {\n     return new UnaryExpressionNode(this.condition, '!', true);\n  };\n\n  BaseNode.prototype.or = function(other) {\n    return new binaryExpressionNodeConstructor(this, this.enforceType(other), '||', true);\n  };\n\n  BaseNode.prototype.and = function(other) {\n    return new binaryExpressionNodeConstructor(this, this.enforceType(other), '&&', true);\n  };\n\n  function branch(callback) {\n    const branch = new BranchNode();\n    callback();\n    BRANCH = null;\n    return branch;\n  }\n\n  class ConditionalNode {\n    constructor(condition, branchCallback) {\n      this.dependsOn = [];\n      this.usedIn = [];\n      this.dependsOnSatisfied = [];\n      this.usedInSatisfied = [];\n      this.states = [];\n      this.if(condition, branchCallback);\n      this.insertionPoint = -1;\n      this.elseIfs = [];\n      this.elseBranch = null;\n      GLOBAL_SHADER.context.ifs.push(this);\n    }\n\n    if(condition, branchCallback) {\n      this.condition = condition;\n      this.conditionString = condition.toGLSL(GLOBAL_SHADER.context);\n      this.ifBranch = branch(branchCallback);\n      this.ifBranch.parent = this;\n    }\n\n    elseIf(condition, branchCallback) {\n      let elseBranch = branch(branchCallback);\n      branchCallback.parent = this;\n      this.elseIfs.push({ condition, elseBranch });\n      return this;\n    }\n\n    else(branchCallback) {\n      this.elseBranch = branch(branchCallback);\n      this.elseBranch.parent = this;\n      return this;\n    }\n\n    thenDiscard() {\n      return new ConditionalDiscard(this.condition);\n    };\n\n    saveState(context, usedInSatisfied, dependsOnSatisfied) {\n      this.states.push({\n        line: context.declarations.length,\n        usedInSatisfied,\n        dependsOnSatisfied\n      });\n      this.insertionPoint = context.declarations.length - 1;\n    }\n\n    toGLSL(context) {\n      const oldLength = context.declarations.length;\n      this.dependsOn.forEach(dep => context.updateComponents(dep.node));\n      const newLength = context.declarations.length;\n      const diff = newLength - oldLength;\n      this.insertionPoint += diff;\n\n      let codelines = [\n        `\\n  if (${this.conditionString}) {`,\n        `\\n    ${this.ifBranch.toGLSL(context)}`,\n        `\\n  }`\n      ];\n\n      if (this.elseIfs.length) {\n        this.elseIfs.forEach((elif) => {\n          let { condition, elseBranch } = elif;\n          codelines.push(` else if (${condition.toGLSL(context)}) {`);\n          codelines.push(`\\n    ${elseBranch.toGLSL(context)}`);\n          codelines.push(`\\n  }`);\n        });\n      }\n\n      if (this.elseBranch) {\n        codelines.push(` else {`);\n        codelines.push(`\\n    ${this.elseBranch.toGLSL(context)}`);\n        codelines.push(`\\n  }\\n`);\n      }\n      codelines.push('\\n');\n      return codelines.flat().join('');\n    }\n  }\n  fn.assign = function(node, value) {\n    if (!BRANCH) {\n       throw new error('assign() is supposed to be used inside of conditional branchs. Use the \"=\" operator as normal otherwise.');\n    }\n    BRANCH.assign(node, value);\n  };\n\n  class BranchNode {\n    constructor() {\n      BRANCH = this;\n      this.statements = [];\n      this.assignments = [];\n      this.dependsOn = [];\n      this.declarations = [];\n      let parent = null;\n      Object.defineProperty(this, 'parent', {\n        get() {\n          return parent;\n        },\n        set(newParent) {\n          newParent.dependsOn.push(...this.dependsOn);\n          parent = newParent;\n        }\n      });\n    }\n\n    assign(node, value) {\n      if (!isShaderNode(value) || value.type !== node.type) {\n        value = nodeConstructors[node.type](value);\n        this.declarations.push(value);\n        this.assignments.push({ node });\n      } else {\n        this.assignments.push({ node, value });\n      }\n      node = node.parent ? node.parent : node;\n      value = value.parent ? value.parent : value;\n      if ([node, value].some(n => this.dependsOn.some(d=>d.node===n))) {\n        return;\n      }\n      node.assertUsedInConditional(this);\n      this.dependsOn.push(makeDependencyObject(node));\n      if (value.shouldUseTemporaryVariable()) {\n        value.assertUsedInConditional(this);\n        this.dependsOn.push(makeDependencyObject(value));\n      }\n    }\n\n    toGLSL(context) {\n      let declarationsIndex = 0;\n      this.assignments.forEach(({ node, value }) => {\n        let statement;\n        let result;\n\n        if (!value) {\n          let decl = this.declarations[declarationsIndex];\n          declarationsIndex++;\n          decl.temporaryVariable = `temp_${context.getNextID()}`;\n          this.statements.push(\n            `${decl.type} ${decl.temporaryVariable} = ${decl.toGLSL(context)};`\n          );\n          result = decl.toGLSLBase(context);\n        } else {\n          result = value.toGLSLBase(context);\n        }\n\n        if (isVariableNode(node) || hasTemporaryVariable(node)) {\n          statement = `${node.toGLSLBase(context)} = ${result};`;\n        }\n        else if (isFloatNode(node) && node.name) {\n            statement = `${node.parent.toGLSLBase(context)}.${node.name} = ${result};`;\n        }\n        else {\n          node.temporaryVariable = `temp_${context.getNextID()}`;\n          statement = `${node.type} ${node.toGLSLBase(context)} = ${result};`;\n        }\n\n        this.statements.push(statement);\n      });\n\n      return this.statements.join(`\\n    `);\n    }\n  }\n\n  class ConditionalDiscard {\n    constructor(condition){\n      this.condition = condition;\n    }\n    toGLSL(context) {\n      context.discardConditions.push(`if (${this.condition}{discard;})`);\n    }\n  }\n\n  // Node Helper functions\n  function getType(node) {\n    if (isShaderNode(node)) { return node.type; }\n    else if (Array.isArray(node) && node.length > 1) { return `vec${node.length}`; }\n    else if (typeof node === 'number' || (Array.isArray(node) && node.length === 1)) {\n      return 'float';\n    }\n    return undefined;\n  }\n\n  function computeVectorLength(values) {\n    let length = 0;\n    if (Array.isArray(values)) {\n      for(let val of values) {\n        if (isVectorType(val)) {\n          length += parseInt(val.type.slice(3));\n        }\n        else length += 1;\n      }\n    }\n    else if (isVectorType(values)) {\n      length += parseInt(val.type.slice(3));\n    }\n    if (![2, 3, 4].includes(length)) {\n      throw new Error(`You have attempted to construct a vector with ${length} values. Only vec2, vec3, and vec4 types are supported.`)\n    }\n    return length\n  }\n\n  p5.dynamicNode = function (input) {\n    if (isShaderNode(input)) {\n      return input;\n    }\n    else if (typeof input === 'number') {\n      return new FloatNode(input);\n    }\n    else if (Array.isArray(input)) {\n      return nodeConstructors.dynamicVector(input);\n    }\n  };\n\n  // For replacing unary expressions\n  p5.unaryNode = function(input, sign) {\n    input = p5.dynamicNode(input);\n    return dynamicAddSwizzleTrap(new UnaryExpressionNode(input, sign));\n  };\n\n  function isShaderNode(node) {\n    return (node instanceof BaseNode);\n  }\n\n  function isIntType(node) {\n    return (isShaderNode(node) && (node.type === 'int'));\n  }\n\n  function isFloatType(node) {\n    return (isShaderNode(node) && (node.type === 'float'));\n  }\n\n  function isFloatNode(node) {\n    return (node instanceof FloatNode);\n  }\n\n  function isVectorType(node) {\n    return (isShaderNode(node) && (node.type === 'vec2'|| node.type === 'vec3' || node.type === 'vec4'));\n  }\n\n  function isBinaryExpressionNode(node) {\n    return (node instanceof BinaryExpressionNode);\n  }\n\n  function isVariableNode(node) {\n    return (node instanceof VariableNode || node instanceof ComponentNode);\n  }\n\n  function isConditionalNode(node) {\n    return (node instanceof ConditionalNode || node instanceof BranchNode)\n  }\n\n  function hasTemporaryVariable(node) {\n    return (node.temporaryVariable);\n  }\n\n  function isPrimitiveNode(node) {\n    return (node instanceof FloatNode || node instanceof IntNode || node instanceof VectorNode);\n  }\n\n  function isFunctionCallNode(node) {\n    return (node instanceof FunctionCallNode);\n  }\n\n  function isVectorNode(node) {\n    return (node instanceof VectorNode)\n  }\n\n  function isUnaryExpressionNode(node) {\n    return (node instanceof UnaryExpressionNode)\n  }\n\n  // Helper function to check if a type is a user defined struct or native type\n  function isGLSLNativeType(typeName) {\n    // Supported types for now\n    const glslNativeTypes = ['int', 'float', 'vec2', 'vec3', 'vec4', 'sampler2D'];\n    return glslNativeTypes.includes(typeName);\n  }\n\n  // Shader Generator\n  // This class is responsible for converting the nodes into an object containing GLSL code, to be used by p5.Shader.modify\n\n  class ShaderGenerator {\n    constructor(userCallback, originalShader, srcLocations) {\n      GLOBAL_SHADER = this;\n      this.userCallback = userCallback;\n      this.srcLocations = srcLocations;\n      this.cleanup = () => {};\n      this.generateHookOverrides(originalShader);\n      this.output = {\n        vertexDeclarations: new Set(),\n        fragmentDeclarations: new Set(),\n        uniforms: {},\n      };\n      this.uniformNodes = [];\n      this.resetGLSLContext();\n      this.isGenerating = false;\n    }\n\n    generate() {\n      const prevFESDisabled = p5.disableFriendlyErrors;\n      // We need a custom error handling system within shader generation\n      p5.disableFriendlyErrors = true;\n\n      this.isGenerating = true;\n      this.userCallback();\n      this.output.vertexDeclarations = [...this.output.vertexDeclarations].join('\\n');\n      this.output.fragmentDeclarations = [...this.output.fragmentDeclarations].join('\\n');\n      this.isGenerating = false;\n\n      this.cleanup();\n      p5.disableFriendlyErrors = prevFESDisabled;\n      return this.output;\n    }\n\n    // This method generates the hook overrides which the user calls in their modify function.\n    generateHookOverrides(originalShader) {\n      const availableHooks = {\n        ...originalShader.hooks.vertex,\n        ...originalShader.hooks.fragment,\n      };\n\n      const windowOverrides = {};\n      const fnOverrides = {};\n\n      Object.keys(availableHooks).forEach((hookName) => {\n        const hookTypes = originalShader.hookTypes(hookName);\n\n        // These functions are where the user code is executed\n        this[hookTypes.name] = function(userCallback) {\n          // Create the initial nodes which are passed to the user callback\n          // Also generate a string of the arguments for the code generation\n          const argNodes = [];\n          const argsArray = [];\n\n          hookTypes.parameters.forEach((parameter) => {\n            // For hooks with structs as input we should pass an object populated with variable nodes\n            if (!isGLSLNativeType(parameter.type.typeName)) {\n              const structArg = {};\n              parameter.type.properties.forEach((property) => {\n                structArg[property.name] = variableConstructor(`${parameter.name}.${property.name}`, property.type.typeName, true);\n              });\n              argNodes.push(structArg);\n            } else {\n              argNodes.push(\n                variableConstructor(parameter.name, parameter.type.typeName, true)\n              );\n            }\n            const qualifiers = parameter.type.qualifiers.length > 0 ? parameter.type.qualifiers.join(' ') : '';\n            argsArray.push(`${qualifiers} ${parameter.type.typeName} ${parameter.name}`.trim());\n          });\n\n          let returnedValue = userCallback(...argNodes);\n          const expectedReturnType = hookTypes.returnType;\n          const toGLSLResults = {};\n\n          // If the expected return type is a struct we need to evaluate each of its properties\n          if (!isGLSLNativeType(expectedReturnType.typeName)) {\n            Object.entries(returnedValue).forEach(([propertyName, propertyNode]) => {\n              propertyNode = p5.dynamicNode(propertyNode);\n              toGLSLResults[propertyName] = propertyNode.toGLSLBase(this.context);\n              this.context.updateComponents(propertyNode);\n            });\n          } else {\n            if (!isShaderNode(returnedValue)) {\n              returnedValue = nodeConstructors[expectedReturnType.typeName](returnedValue);\n            } else if (isFloatType(returnedValue) && expectedReturnType.typeName.startsWith('vec')) {\n              returnedValue = nodeConstructors[expectedReturnType.typeName](returnedValue);\n            }\n            toGLSLResults['notAProperty'] = returnedValue.toGLSLBase(this.context);\n            this.context.updateComponents(returnedValue);\n          }\n\n          this.context.ifs.forEach((statement) => {\n            if (statement.usedIn.length === 0) { return; }\n            const lines = statement.toGLSL(this.context);\n            this.context.declarations.splice(statement.insertionPoint, 0, lines);\n          });\n          // Build the final GLSL string.\n          // The order of this code is a bit confusing, we need to call toGLSLBase\n          let codeLines = [\n            `(${argsArray.join(', ')}) {`,\n            ...this.context.declarations,\n            `\\n  ${hookTypes.returnType.typeName} finalReturnValue;`\n          ];\n\n          Object.entries(toGLSLResults).forEach(([propertyName, result]) => {\n            const propString = expectedReturnType.properties ? `.${propertyName}` : '';\n            codeLines.push(`  finalReturnValue${propString} = ${result};`);\n          });\n\n          this.context.declarations = [];\n          for (let key in this.context.varyings) {\n            const declArray = this.context.varyings[key];\n            const finalVaryingAssignments = [];\n            declArray.forEach(obj => {\n              const { node, value } = obj;\n              finalVaryingAssignments.push(`  ${node.name} = ${value.toGLSLBase(this.context)};`);\n              finalVaryingAssignments.unshift(...this.context.declarations);\n              node.timesChanged = 0;\n            });\n            codeLines.push(...finalVaryingAssignments);\n          }\n\n          codeLines.push('  return finalReturnValue;', '}');\n          this.output[hookName] = codeLines.join('\\n');\n          this.resetGLSLContext();\n        };\n        windowOverrides[hookTypes.name] = window[hookTypes.name];\n        fnOverrides[hookTypes.name] = fn[hookTypes.name];\n\n        // Expose the Functions to global scope for users to use\n        window[hookTypes.name] = function(userOverride) {\n          GLOBAL_SHADER[hookTypes.name](userOverride);\n        };\n        fn[hookTypes.name] = function(userOverride) {\n          GLOBAL_SHADER[hookTypes.name](userOverride);\n        };\n      });\n\n\n      this.cleanup = () => {\n        for (const key in windowOverrides) {\n          window[key] = windowOverrides[key];\n        }\n        for (const key in fnOverrides) {\n          fn[key] = fnOverrides[key];\n        }\n      };\n    }\n\n    registerVarying(node, value) {\n      if (!Array.isArray(this.context.varyings[node.name])) {\n        this.context.varyings[node.name] = [];\n      }\n      this.context.varyings[node.name].push({ node, value });\n      this.output.vertexDeclarations.add(`OUT ${node.type} ${node.name};`);\n      this.output.fragmentDeclarations.add(`IN ${node.type} ${node.name};`);\n    }\n\n    resetGLSLContext() {\n      this.uniformNodes.forEach((node) => {\n        node.usedIn = [];\n        node.temporaryVariable = undefined;\n      });\n      this.context = {\n        id: 0,\n        getNextID() { return this.id++ },\n        declarations: [],\n        varyings: [],\n        ifs: [],\n        updateComponents: function(node, _emplaceAt, _changedComponents) {\n          if (node.componentsChanged) {\n            if (!_changedComponents) {\n              _changedComponents = node.componentNames.map(() => true);\n            }\n            const lines = [];\n            if (isVectorNode(node)) {\n              node.componentNames.forEach((name, i) => {\n                if (!_changedComponents[i]) return;\n                if (node[name] !== node.originalValues[i]) {\n                  const replacement = nodeConstructors['float'](node[name]);\n                  const line = `  ${node.temporaryVariable}.${name} = ${replacement.toGLSLBase(this)};`;\n                  lines.push(line);\n                }\n              });\n            } else {\n              const components = node.componentNames.map((name) => {\n                return node[name]\n              });\n              const replacement = nodeConstructors[node.type](components);\n              const line = `  ${node.temporaryVariable} = ${replacement.toGLSLBase(this)};`;\n              lines.push(line);\n            }\n            if (_emplaceAt) {\n              this.declarations.splice(_emplaceAt, 0, ...lines);\n            } else {\n              this.declarations.push(...lines);\n            }\n            node.componentsChanged = false;\n          }\n        }\n      };\n      this.uniformNodes = [];\n    }\n  }\n\n  // User function helpers\n  function makeDependencyObject(dep) {\n    if (isVectorType(dep)) {\n      return {\n        node: dep,\n        isVector: true,\n        originalComponents: [...dep.componentNames.map(name => dep[name])],\n        get currentComponents() {\n          return dep.componentNames.map(name => dep[name]);\n        }\n      };\n    } else {\n      return {\n        node: dep,\n        isVector: false\n      };\n    }\n  }\n\n  function makeDependencyArray(dependencies) {\n    return dependencies.map(dep => makeDependencyObject(dep));\n  }\n\n  function conformVectorParameters(value, vectorDimensions) {\n    // Allow arguments as arrays or otherwise. The following are all equivalent:\n    // ([0,0,0,0]) (0,0,0,0) (0) ([0])\n    if (!Array.isArray(value)) {\n      value = [value];\n    }\n    value = value.flat();\n    value = value.map(val => {\n      if (isVectorType(val)) {\n        const componentArray = val.componentNames.map(comp => val[comp]);\n        return componentArray;\n      } else {\n        return val;\n      }\n    }).flat();\n    // Populate arguments so uniformVector3(0) becomes [0,0,0]\n    if (value.length === 1 && !isVectorNode(value[0])) {\n      value = Array(vectorDimensions).fill(value[0]);\n    }\n    return value;\n  }\n\n  function swizzleTrap(size) {\n    const swizzleSets = [\n      ['x', 'y', 'z', 'w'],\n      ['r', 'g', 'b', 'a'],\n      ['s', 't', 'p', 'q']\n    ].map(s => s.slice(0, size));\n    return {\n      get(target, property, receiver) {\n        if (property in target) {\n          return Reflect.get(...arguments);\n        } else {\n          for (const set of swizzleSets) {\n            if ([...property].every(char => set.includes(char))) {\n              if (property.length === 1) {\n                return target[swizzleSets[0][set.indexOf(property[0])]]\n              }\n              const components = [...property].map(char => {\n                const index = set.indexOf(char);\n                const mappedChar = swizzleSets[0][index];\n                return target[mappedChar];\n              });\n\n              const type = `vec${property.length}`;\n              return nodeConstructors[type](components);\n            }\n          }\n        }\n      },\n      set(target, property, value, receiver) {\n        for (const set of swizzleSets) {\n          const propertyCharArray = [...property];\n          if (propertyCharArray.every(char => set.includes(char))) {\n            const newValues = Array.isArray(value) ? value : Array(property.length).fill(value);\n            propertyCharArray.forEach((char, i) => {\n              const index = set.indexOf(char);\n              const realProperty = swizzleSets[0][index];\n              Reflect.set(target, realProperty, newValues[i], receiver);\n            });\n            return true;\n          }\n        }\n        return Reflect.set(...arguments);\n      }\n    }\n  }\n\n  // User functions\n  fn.If = function (condition, branch) {\n    return new ConditionalNode(condition, branch);\n  };\n\n  fn.instanceID = function() {\n    return variableConstructor('gl_InstanceID', 'int');\n  };\n\n  fn.getTexture = function(...userArgs) {\n    const props = { args: ['sampler2D', 'vec2'], returnType: 'vec4', isp5Function: true };\n    return fnNodeConstructor('getTexture', userArgs,  props);\n  };\n\n  // Generating uniformFloat, uniformVec, createFloat, etc functions\n  // Maps a GLSL type to the name suffix for method names\n  const GLSLTypesToIdentifiers = {\n    int:    'Int',\n    float:  'Float',\n    vec2:   'Vector2',\n    vec3:   'Vector3',\n    vec4:   'Vector4',\n    sampler2D: 'Texture',\n  };\n\n  function dynamicAddSwizzleTrap(node, _size) {\n    if (node.type.startsWith('vec') || _size) {\n      const size = parseInt(node.type.slice(3));\n      node =  new Proxy(node, swizzleTrap(size));\n      node.addVectorComponents();\n    }\n    return node;\n  }\n\n  function binaryExpressionNodeConstructor(a, b, operator, isInternal) {\n    let node;\n    if (operator === '%') {\n      node = new ModulusNode(a, b);\n    } else {\n      node = new BinaryExpressionNode(a, b, operator, isInternal);\n    }\n    return dynamicAddSwizzleTrap(node);\n  }\n\n  function variableConstructor(name, type, isInternal) {\n    const node = new VariableNode(name, type, isInternal);\n    return dynamicAddSwizzleTrap(node);\n  }\n\n  function fnNodeConstructor(name, userArgs, properties, isInternal) {\n    let node = new FunctionCallNode(name, userArgs, properties, isInternal);\n    node = dynamicAddSwizzleTrap(node);\n    node.dependsOn = makeDependencyArray(node.args);\n    const dependsOnConditionals = node.args.map(arg => {\n      const conditionals = arg.usedIn.filter(n => isConditionalNode(n)).map(c => {\n        if (c instanceof BranchNode) {\n          return c.parent;\n        } else {\n          return c;\n        }\n      });\n      return conditionals;\n    }).flat();\n    dependsOnConditionals.forEach(conditional => conditional.usedIn.push(node));\n\n    return node;\n  }\n\n  const nodeConstructors = {\n    int:   (value) => new IntNode(value),\n    float: (value) => new FloatNode(value),\n    vec2:  (value) => dynamicAddSwizzleTrap(new VectorNode(value, 'vec2')),\n    vec3:  (value) => dynamicAddSwizzleTrap(new VectorNode(value, 'vec3')),\n    vec4:  (value) => dynamicAddSwizzleTrap(new VectorNode(value, 'vec4')),\n    dynamicVector: function(value) {\n      const size = computeVectorLength(value);\n      return this[`vec${size}`](value);\n    },\n  };\n\n  for (const glslType in GLSLTypesToIdentifiers) {\n    // Generate uniform*() Methods for creating uniforms\n    const typeIdentifier = GLSLTypesToIdentifiers[glslType];\n    const uniformMethodName = `uniform${typeIdentifier}`;\n\n    ShaderGenerator.prototype[uniformMethodName] = function(...args) {\n      let [name, ...defaultValue] = args;\n      if (glslType.startsWith('vec') && !(defaultValue[0] instanceof Function)) {\n        defaultValue = conformVectorParameters(defaultValue, parseInt(glslType.slice(3)));\n        this.output.uniforms[`${glslType} ${name}`] = defaultValue;\n      }\n      else {\n        this.output.uniforms[`${glslType} ${name}`] = defaultValue[0];\n      }\n      const uniform = variableConstructor(name, glslType, false);\n      this.uniformNodes.push(uniform);\n      return uniform;\n    };\n\n    fn[uniformMethodName] = function (...args) {\n      return GLOBAL_SHADER[uniformMethodName](...args);\n    };\n\n\n    // We don't need a texture creation method.\n    if (glslType === 'sampler2D') { continue; }\n\n    const varyingMethodName = `varying${typeIdentifier}`;\n    ShaderGenerator.prototype[varyingMethodName] = function(name) {\n      return dynamicAddSwizzleTrap(new VaryingNode(name, glslType, false));\n    };\n\n    fn[varyingMethodName] = function (name) {\n      return GLOBAL_SHADER[varyingMethodName](name);\n    };\n\n    // Generate the creation methods for creating variables in shaders\n    const originalFn = fn[glslType];\n    fn[glslType] = function (...value) {\n      if (GLOBAL_SHADER?.isGenerating) {\n        if (glslType.startsWith('vec')) {\n          value = conformVectorParameters(value, parseInt(glslType.slice(3)));\n        } else {\n          value = value[0];\n        }\n        return nodeConstructors[glslType](value);\n      } else if (originalFn) {\n        return originalFn.apply(this, value);\n      } else {\n        p5._friendlyError(\n          `It looks like you've called ${glslType} outside of a shader's modify() function.`\n        );\n      }\n    };\n  }\n\n  // GLSL Built in functions\n  // Add a whole lot of these functions.\n  // https://docs.gl/el3/abs\n  const builtInGLSLFunctions = {\n    //////////// Trigonometry //////////\n    'acos': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'acosh': { args: ['genType'], returnType: 'genType', isp5Function: false},\n    'asin': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'asinh': { args: ['genType'], returnType: 'genType', isp5Function: false},\n    'atan': [\n      { args: ['genType'], returnType: 'genType', isp5Function: false},\n      { args: ['genType', 'genType'], returnType: 'genType', isp5Function: false},\n    ],\n    'atanh': { args: ['genType'], returnType: 'genType', isp5Function: false},\n    'cos': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'cosh': { args: ['genType'], returnType: 'genType', isp5Function: false},\n    'degrees': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'radians': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'sin': { args: ['genType'], returnType: 'genType' , isp5Function: true},\n    'sinh': { args: ['genType'], returnType: 'genType', isp5Function: false},\n    'tan': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'tanh': { args: ['genType'], returnType: 'genType', isp5Function: false},\n\n    ////////// Mathematics //////////\n    'abs': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'ceil': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'clamp': { args: ['genType', 'genType', 'genType'], returnType: 'genType', isp5Function: false},\n    'dFdx': { args: ['genType'], returnType: 'genType', isp5Function: false},\n    'dFdy': { args: ['genType'], returnType: 'genType', isp5Function: false},\n    'exp': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'exp2': { args: ['genType'], returnType: 'genType', isp5Function: false},\n    'floor': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'fma': { args: ['genType', 'genType', 'genType'], returnType: 'genType', isp5Function: false},\n    'fract': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'fwidth': { args: ['genType'], returnType: 'genType', isp5Function: false},\n    'inversesqrt': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    // 'isinf': {},\n    // 'isnan': {},\n    'log': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'log2': { args: ['genType'], returnType: 'genType', isp5Function: false},\n    'max': [\n      { args: ['genType', 'genType'], returnType: 'genType', isp5Function: true},\n      { args: ['genType', 'float'], returnType: 'genType', isp5Function: true},\n    ],\n    'min': [\n      { args: ['genType', 'genType'], returnType: 'genType', isp5Function: true},\n      { args: ['genType', 'float'], returnType: 'genType', isp5Function: true},\n    ],\n    'mix': [\n      { args: ['genType', 'genType', 'genType'], returnType: 'genType', isp5Function: false},\n      { args: ['genType', 'genType', 'float'], returnType: 'genType', isp5Function: false},\n    ],\n    // 'mod': {},\n    // 'modf': {},\n    'pow': { args: ['genType', 'genType'], returnType: 'genType', isp5Function: true},\n    'round': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'roundEven': { args: ['genType'], returnType: 'genType', isp5Function: false},\n    // 'sign': {},\n    'smoothstep': [\n      { args: ['genType', 'genType', 'genType'], returnType: 'genType', isp5Function: false},\n      { args: ['float', 'float', 'genType'], returnType: 'genType', isp5Function: false},\n    ],\n    'sqrt': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    'step': { args: ['genType', 'genType'], returnType: 'genType', isp5Function: false},\n    'trunc': { args: ['genType'], returnType: 'genType', isp5Function: false},\n\n    ////////// Vector //////////\n    'cross': { args: ['vec3', 'vec3'], returnType: 'vec3', isp5Function: true},\n    'distance': { args: ['genType', 'genType'], returnType: 'float', isp5Function: true},\n    'dot': { args: ['genType', 'genType'], returnType: 'float', isp5Function: true},\n    // 'equal': {},\n    'faceforward': { args: ['genType', 'genType', 'genType'], returnType: 'genType', isp5Function: false},\n    'length': { args: ['genType'], returnType: 'float', isp5Function: false},\n    'normalize': { args: ['genType'], returnType: 'genType', isp5Function: true},\n    // 'notEqual': {},\n    'reflect': { args: ['genType', 'genType'], returnType: 'genType', isp5Function: false},\n    'refract': { args: ['genType', 'genType', 'float'], returnType: 'genType', isp5Function: false},\n\n    ////////// Texture sampling //////////\n    'texture': {args: ['sampler2D', 'vec2'], returnType: 'vec4', isp5Function: true},\n  };\n\n  Object.entries(builtInGLSLFunctions).forEach(([functionName, properties]) => {\n    const isp5Function = Array.isArray(properties) ? properties[0].isp5Function : properties.isp5Function;\n    if (isp5Function) {\n      const originalFn = fn[functionName];\n      fn[functionName] = function (...args) {\n        if (GLOBAL_SHADER?.isGenerating) {\n          return fnNodeConstructor(functionName, args, properties)\n        } else {\n          return originalFn.apply(this, args);\n        }\n      };\n    } else {\n      fn[functionName] = function (...args) {\n        if (GLOBAL_SHADER?.isGenerating) {\n          return new fnNodeConstructor(functionName, args, properties);\n        } else {\n          p5._friendlyError(\n            `It looks like you've called ${functionName} outside of a shader's modify() function.`\n          );\n        }\n      };\n    }\n  });\n  // Alias GLSL's mix function as lerp in p5.strands\n  // Bridging p5.js lerp and GLSL mix for consistency in shader expressions\n  const originalLerp = fn.lerp;\n  fn.lerp = function (...args) {\n    if (GLOBAL_SHADER?.isGenerating) {\n      return this.mix(...args); // Use mix inside p5.strands\n    } else {\n      return originalLerp.apply(this, args); // Fallback to normal p5.js lerp\n    }\n  };\n  const originalNoise = fn.noise;\n  fn.noise = function (...args) {\n    if (!GLOBAL_SHADER?.isGenerating) {\n      return originalNoise.apply(this, args); // fallback to regular p5.js noise\n    }\n\n    GLOBAL_SHADER.output.vertexDeclarations.add(noiseGLSL);\n    GLOBAL_SHADER.output.fragmentDeclarations.add(noiseGLSL);\n    // Handle noise(x, y) as noise(vec2)\n    let nodeArgs;\n    if (args.length === 2) {\n      nodeArgs = [fn.vec2(args[0], args[1])];\n    } else {\n      nodeArgs = args;\n    }\n\n    return fnNodeConstructor('noise', nodeArgs, {\n      args: ['vec2'],\n      returnType: 'float'\n    });\n  };\n\n}\n\nif (typeof p5 !== 'undefined') {\n  p5.registerAddon(shadergenerator);\n}\n\nexport { shadergenerator as default };\n","import { p as p5 } from '../main-B3Z63C6j.js';\nimport { initialize } from './internationalization.js';\nimport '../constants-8IpwyBct.js';\nimport './transform.js';\nimport './structure.js';\nimport './environment.js';\nimport '../math/p5.Vector.js';\nimport '../rendering-BELwvfI6.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../dom/p5.Element.js';\nimport '../dom/p5.File.js';\nimport '../io/p5.XML.js';\nimport '../p5.Renderer-DoDzbpcT.js';\nimport '../image/filters.js';\nimport '../shape/custom_shapes.js';\nimport './States.js';\nimport '../io/utilities.js';\nimport 'file-saver';\nimport '../dom/p5.MediaElement.js';\nimport '../shape/2d_primitives.js';\nimport './helpers.js';\nimport '../shape/attributes.js';\nimport '../shape/curves.js';\nimport '../shape/vertex.js';\nimport '../color/setting.js';\nimport 'omggif';\nimport '../io/csv.js';\nimport 'gifenc';\nimport '../image/pixels.js';\nimport '../webgl/GeometryBuilder.js';\nimport '../math/p5.Matrix.js';\nimport '../math/Matrices/Matrix.js';\nimport '../math/Matrices/MatrixInterface.js';\nimport '../webgl/p5.Geometry.js';\nimport '../webgl/p5.DataArray.js';\nimport '../webgl/p5.Quat.js';\nimport '../webgl/p5.RenderBuffer.js';\nimport '../webgl/ShapeBuilder.js';\nimport 'libtess';\nimport '../webgl/GeometryBufferCache.js';\nimport '../image/const.js';\nimport '../math/trigonometry.js';\nimport '../image/filterRenderer2D.js';\nimport 'i18next';\nimport 'i18next-browser-languagedetector';\n\n/**\n * This file setup global mode automatic instantiation\n *\n * if sketch is on window\n * assume \"global\" mode\n * and instantiate p5 automatically\n * otherwise do nothing\n *\n * @private\n * @return {Undefined}\n */\nconst _globalInit = () => {\n  // Could have been any property defined within the p5 constructor.\n  // If that property is already a part of the global object,\n  // this code has already run before, likely due to a duplicate import\n  if (typeof window._setupDone !== 'undefined') {\n    console.warn(\n      'p5.js seems to have been imported multiple times. Please remove the duplicate import'\n    );\n    return;\n  }\n\n  if (!window.mocha) {\n    const p5ReadyEvent = new Event('p5Ready');\n    window.dispatchEvent(p5ReadyEvent);\n\n    // If there is a setup or draw function on the window\n    // then instantiate p5 in \"global\" mode\n    if (\n      ((window.setup && typeof window.setup === 'function') ||\n        (window.draw && typeof window.draw === 'function')) &&\n      !p5.instance\n    ) {\n      new p5();\n    }\n  }\n};\n\n// make a promise that resolves when the document is ready\nconst waitForDocumentReady = () =>\n  new Promise((resolve, reject) => {\n    // if the page is ready, initialize p5 immediately\n    if (document.readyState === 'complete') {\n      resolve();\n      // if the page is still loading, add an event listener\n      // and initialize p5 as soon as it finishes loading\n    } else {\n      window.addEventListener('load', resolve, false);\n    }\n  });\n\n// only load translations if we're using the full, un-minified library\nconst waitingForTranslator =\n  typeof IS_MINIFIED === 'undefined' ? initialize() :\n    Promise.resolve();\n\nexport { _globalInit, waitForDocumentReady, waitingForTranslator };\n","import primitives from './2d_primitives.js';\nimport attributes from './attributes.js';\nimport curves from './curves.js';\nimport vertex from './vertex.js';\nimport customShapes from './custom_shapes.js';\nimport '../constants-8IpwyBct.js';\nimport '../core/helpers.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../math/p5.Vector.js';\n\nfunction shape(p5){\n  p5.registerAddon(primitives);\n  p5.registerAddon(attributes);\n  p5.registerAddon(curves);\n  p5.registerAddon(vertex);\n  p5.registerAddon(customShapes);\n}\n\nexport { shape as default };\n","import { p as p5 } from './main-B3Z63C6j.js';\nimport shape from './shape/index.js';\nimport accessibility from './accessibility/index.js';\nimport color from './color/index.js';\nimport friendlyErrors from './core/friendly_errors/index.js';\nimport data from './data/index.js';\nimport dom from './dom/index.js';\nimport events from './events/index.js';\nimport image from './image/index.js';\nimport io from './io/index.js';\nimport math from './math/index.js';\nimport utilities from './utilities/index.js';\nimport webgl from './webgl/index.js';\nimport type from './type/index.js';\nimport { waitForDocumentReady, waitingForTranslator, _globalInit } from './core/init.js';\nimport './constants-8IpwyBct.js';\nimport './core/transform.js';\nimport './core/structure.js';\nimport './core/environment.js';\nimport './math/p5.Vector.js';\nimport './rendering-BELwvfI6.js';\nimport './creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport './color/color_spaces/hsb.js';\nimport './dom/p5.Element.js';\nimport './dom/p5.File.js';\nimport './io/p5.XML.js';\nimport './p5.Renderer-DoDzbpcT.js';\nimport './image/filters.js';\nimport './shape/custom_shapes.js';\nimport './core/States.js';\nimport './io/utilities.js';\nimport 'file-saver';\nimport './dom/p5.MediaElement.js';\nimport './shape/2d_primitives.js';\nimport './core/helpers.js';\nimport './shape/attributes.js';\nimport './shape/curves.js';\nimport './shape/vertex.js';\nimport './color/setting.js';\nimport 'omggif';\nimport './io/csv.js';\nimport 'gifenc';\nimport './image/pixels.js';\nimport './webgl/GeometryBuilder.js';\nimport './math/p5.Matrix.js';\nimport './math/Matrices/Matrix.js';\nimport './math/Matrices/MatrixInterface.js';\nimport './webgl/p5.Geometry.js';\nimport './webgl/p5.DataArray.js';\nimport './webgl/p5.Quat.js';\nimport './webgl/p5.RenderBuffer.js';\nimport './webgl/ShapeBuilder.js';\nimport 'libtess';\nimport './webgl/GeometryBufferCache.js';\nimport './image/const.js';\nimport './math/trigonometry.js';\nimport './image/filterRenderer2D.js';\nimport './accessibility/describe.js';\nimport './accessibility/gridOutput.js';\nimport './accessibility/textOutput.js';\nimport './accessibility/outputs.js';\nimport './accessibility/color_namer.js';\nimport './color/color_conversion.js';\nimport './core/friendly_errors/fes_core.js';\nimport './core/internationalization.js';\nimport 'i18next';\nimport 'i18next-browser-languagedetector';\nimport './core/friendly_errors/browser_errors.js';\nimport './core/friendly_errors/stacktrace.js';\nimport './core/friendly_errors/param_validator.js';\nimport 'zod/v4';\nimport './core/friendly_errors/sketch_verifier.js';\nimport 'acorn';\nimport 'acorn-walk';\nimport './core/friendly_errors/file_errors.js';\nimport './data/local_storage.js';\nimport './dom/dom.js';\nimport './events/acceleration.js';\nimport './events/keyboard.js';\nimport './events/pointer.js';\nimport './io/p5.Table.js';\nimport './io/p5.TableRow.js';\nimport './math/calculation.js';\nimport './math/noise.js';\nimport './math/random.js';\nimport './math/math.js';\nimport './utilities/conversion.js';\nimport './utilities/utility_functions.js';\nimport './utilities/time_date.js';\nimport './webgl/interaction.js';\nimport './webgl/loading.js';\nimport './webgl/text.js';\nimport './type/p5.Font.js';\nimport './type/textCore.js';\nimport '@japont/unicode-range';\nimport './type/unicodeRanges.js';\nimport './type/lib/Typr.js';\nimport 'pako';\nimport '@davepagurek/bezier-path';\nimport './webgl/ShaderGenerator.js';\nimport 'escodegen';\n\n// core\nshape(p5);\naccessibility(p5);\ncolor(p5);\nfriendlyErrors(p5);\ndata(p5);\ndom(p5);\nevents(p5);\nimage(p5);\nio(p5);\nmath(p5);\nutilities(p5);\nwebgl(p5);\ntype(p5);\nPromise.all([waitForDocumentReady(), waitingForTranslator]).then(_globalInit);\n\nexport { p5 as default };\n","import describe from './describe.js';\nimport gridOutput from './gridOutput.js';\nimport textOutput from './textOutput.js';\nimport outputs from './outputs.js';\nimport colorNamer from './color_namer.js';\nimport '../color/color_conversion.js';\nimport '../main-B3Z63C6j.js';\nimport '../constants-8IpwyBct.js';\nimport '../core/transform.js';\nimport '../core/structure.js';\nimport '../core/environment.js';\nimport '../math/p5.Vector.js';\nimport '../rendering-BELwvfI6.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../dom/p5.Element.js';\nimport '../dom/p5.File.js';\nimport '../io/p5.XML.js';\nimport '../p5.Renderer-DoDzbpcT.js';\nimport '../image/filters.js';\nimport '../shape/custom_shapes.js';\nimport '../core/States.js';\nimport '../io/utilities.js';\nimport 'file-saver';\nimport '../dom/p5.MediaElement.js';\nimport '../shape/2d_primitives.js';\nimport '../core/helpers.js';\nimport '../shape/attributes.js';\nimport '../shape/curves.js';\nimport '../shape/vertex.js';\nimport '../color/setting.js';\nimport 'omggif';\nimport '../io/csv.js';\nimport 'gifenc';\nimport '../image/pixels.js';\nimport '../webgl/GeometryBuilder.js';\nimport '../math/p5.Matrix.js';\nimport '../math/Matrices/Matrix.js';\nimport '../math/Matrices/MatrixInterface.js';\nimport '../webgl/p5.Geometry.js';\nimport '../webgl/p5.DataArray.js';\nimport '../webgl/p5.Quat.js';\nimport '../webgl/p5.RenderBuffer.js';\nimport '../webgl/ShapeBuilder.js';\nimport 'libtess';\nimport '../webgl/GeometryBufferCache.js';\nimport '../image/const.js';\nimport '../math/trigonometry.js';\nimport '../image/filterRenderer2D.js';\n\nfunction accessibility(p5){\n  p5.registerAddon(describe);\n  p5.registerAddon(gridOutput);\n  p5.registerAddon(textOutput);\n  p5.registerAddon(outputs);\n  p5.registerAddon(colorNamer);\n}\n\nexport { accessibility as default };\n","import { c as creatingReading, a as color$1 } from '../creating_reading-BdolPjuO.js';\nimport setting from './setting.js';\nimport 'colorjs.io/fn';\nimport './color_spaces/hsb.js';\nimport '../constants-8IpwyBct.js';\n\nfunction color(p5){\n  p5.registerAddon(creatingReading);\n  p5.registerAddon(color$1);\n  p5.registerAddon(setting);\n}\n\nexport { color as default };\n","import fesCore from './fes_core.js';\nimport stacktrace from './stacktrace.js';\nimport validateParams from './param_validator.js';\nimport sketchVerifier from './sketch_verifier.js';\nimport fileErrors from './file_errors.js';\nimport '../internationalization.js';\nimport 'i18next';\nimport 'i18next-browser-languagedetector';\nimport './browser_errors.js';\nimport '../../constants-8IpwyBct.js';\nimport 'zod/v4';\nimport 'acorn';\nimport 'acorn-walk';\n\nfunction friendlyErrors (p5) {\n  p5.registerAddon(fesCore);\n  p5.registerAddon(stacktrace);\n  p5.registerAddon(validateParams);\n  p5.registerAddon(sketchVerifier);\n  p5.registerAddon(fileErrors);\n}\n\nexport { friendlyErrors as default };\n","import storage from './local_storage.js';\n\nfunction data(p5){\n  p5.registerAddon(storage);\n}\n\nexport { data as default };\n","import dom$1 from './dom.js';\nimport element from './p5.Element.js';\nimport media from './p5.MediaElement.js';\nimport file from './p5.File.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../constants-8IpwyBct.js';\nimport '../io/p5.XML.js';\n\nfunction dom(p5){\n  p5.registerAddon(dom$1);\n  p5.registerAddon(element);\n  p5.registerAddon(media);\n  p5.registerAddon(file);\n}\n\nexport { dom as default };\n","import acceleration from './acceleration.js';\nimport keyboard from './keyboard.js';\nimport pointer from './pointer.js';\n\nfunction events(p5){\n  p5.registerAddon(acceleration);\n  p5.registerAddon(keyboard);\n  p5.registerAddon(pointer);\n}\n\nexport { events as default };\n","import { i as image$1, b as loadingDisplaying, s as shader, t as texture } from '../rendering-BELwvfI6.js';\nimport { i as image$2 } from '../p5.Renderer-DoDzbpcT.js';\nimport pixels from './pixels.js';\nimport '../constants-8IpwyBct.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../dom/p5.Element.js';\nimport '../dom/p5.File.js';\nimport '../io/p5.XML.js';\nimport '../dom/p5.MediaElement.js';\nimport '../shape/2d_primitives.js';\nimport '../core/helpers.js';\nimport '../shape/attributes.js';\nimport '../shape/curves.js';\nimport '../shape/vertex.js';\nimport '../color/setting.js';\nimport 'omggif';\nimport '../io/csv.js';\nimport '../io/utilities.js';\nimport 'file-saver';\nimport 'gifenc';\nimport '../core/transform.js';\nimport '../webgl/GeometryBuilder.js';\nimport '../math/p5.Matrix.js';\nimport '../math/Matrices/Matrix.js';\nimport '../math/p5.Vector.js';\nimport '../math/Matrices/MatrixInterface.js';\nimport '../webgl/p5.Geometry.js';\nimport '../webgl/p5.DataArray.js';\nimport '../webgl/p5.Quat.js';\nimport '../webgl/p5.RenderBuffer.js';\nimport '../webgl/ShapeBuilder.js';\nimport 'libtess';\nimport '../webgl/GeometryBufferCache.js';\nimport './const.js';\nimport '../shape/custom_shapes.js';\nimport '../math/trigonometry.js';\nimport './filters.js';\nimport '../core/States.js';\n\nfunction image(p5){\n  p5.registerAddon(image$1);\n  p5.registerAddon(loadingDisplaying);\n  p5.registerAddon(image$2);\n  p5.registerAddon(pixels);\n  p5.registerAddon(shader);\n  p5.registerAddon(texture);\n}\n\nexport { image as default };\n","import { d as files } from '../rendering-BELwvfI6.js';\nimport table from './p5.Table.js';\nimport tableRow from './p5.TableRow.js';\nimport xml from './p5.XML.js';\nimport '../constants-8IpwyBct.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../dom/p5.Element.js';\nimport '../dom/p5.File.js';\nimport '../p5.Renderer-DoDzbpcT.js';\nimport '../image/filters.js';\nimport '../math/p5.Vector.js';\nimport '../shape/custom_shapes.js';\nimport '../core/States.js';\nimport './utilities.js';\nimport 'file-saver';\nimport '../dom/p5.MediaElement.js';\nimport '../shape/2d_primitives.js';\nimport '../core/helpers.js';\nimport '../shape/attributes.js';\nimport '../shape/curves.js';\nimport '../shape/vertex.js';\nimport '../color/setting.js';\nimport 'omggif';\nimport './csv.js';\nimport 'gifenc';\nimport '../image/pixels.js';\nimport '../core/transform.js';\nimport '../webgl/GeometryBuilder.js';\nimport '../math/p5.Matrix.js';\nimport '../math/Matrices/Matrix.js';\nimport '../math/Matrices/MatrixInterface.js';\nimport '../webgl/p5.Geometry.js';\nimport '../webgl/p5.DataArray.js';\nimport '../webgl/p5.Quat.js';\nimport '../webgl/p5.RenderBuffer.js';\nimport '../webgl/ShapeBuilder.js';\nimport 'libtess';\nimport '../webgl/GeometryBufferCache.js';\nimport '../image/const.js';\nimport '../math/trigonometry.js';\n\nfunction io(p5){\n  p5.registerAddon(files);\n  p5.registerAddon(table);\n  p5.registerAddon(tableRow);\n  p5.registerAddon(xml);\n}\n\nexport { io as default };\n","import calculation from './calculation.js';\nimport noise from './noise.js';\nimport random from './random.js';\nimport trigonometry from './trigonometry.js';\nimport math$1 from './math.js';\nimport vector from './p5.Vector.js';\nimport '../constants-8IpwyBct.js';\n\nfunction math(p5){\n  p5.registerAddon(calculation);\n  p5.registerAddon(noise);\n  p5.registerAddon(random);\n  p5.registerAddon(trigonometry);\n  p5.registerAddon(math$1);\n  p5.registerAddon(vector);\n}\n\nexport { math as default };\n","import conversion from './conversion.js';\nimport utilityFunctions from './utility_functions.js';\nimport timeDate from './time_date.js';\n\nfunction utilities(p5){\n  p5.registerAddon(conversion);\n  p5.registerAddon(utilityFunctions);\n  p5.registerAddon(timeDate);\n}\n\nexport { utilities as default };\n","import { r as rendererGL, p as primitives3D, l as light, m as material, c as camera, f as framebuffer, s as shader, t as texture } from '../rendering-BELwvfI6.js';\nimport interaction from './interaction.js';\nimport loading from './loading.js';\nimport text from './text.js';\nimport renderBuffer from './p5.RenderBuffer.js';\nimport quat from './p5.Quat.js';\nimport matrix from '../math/p5.Matrix.js';\nimport geometry from './p5.Geometry.js';\nimport dataArray from './p5.DataArray.js';\nimport shadergenerator from './ShaderGenerator.js';\nimport '../constants-8IpwyBct.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../dom/p5.Element.js';\nimport '../dom/p5.File.js';\nimport '../io/p5.XML.js';\nimport '../p5.Renderer-DoDzbpcT.js';\nimport '../image/filters.js';\nimport '../math/p5.Vector.js';\nimport '../shape/custom_shapes.js';\nimport '../core/States.js';\nimport '../io/utilities.js';\nimport 'file-saver';\nimport '../dom/p5.MediaElement.js';\nimport '../shape/2d_primitives.js';\nimport '../core/helpers.js';\nimport '../shape/attributes.js';\nimport '../shape/curves.js';\nimport '../shape/vertex.js';\nimport '../color/setting.js';\nimport 'omggif';\nimport '../io/csv.js';\nimport 'gifenc';\nimport '../image/pixels.js';\nimport '../core/transform.js';\nimport './GeometryBuilder.js';\nimport '../math/Matrices/Matrix.js';\nimport '../math/Matrices/MatrixInterface.js';\nimport './ShapeBuilder.js';\nimport 'libtess';\nimport './GeometryBufferCache.js';\nimport '../image/const.js';\nimport '../math/trigonometry.js';\nimport '../type/p5.Font.js';\nimport '../type/textCore.js';\nimport '@japont/unicode-range';\nimport '../type/unicodeRanges.js';\nimport '../type/lib/Typr.js';\nimport 'pako';\nimport '@davepagurek/bezier-path';\nimport 'acorn';\nimport 'acorn-walk';\nimport 'escodegen';\n\nfunction webgl(p5){\n  rendererGL(p5, p5.prototype);\n  primitives3D(p5, p5.prototype);\n  interaction(p5, p5.prototype);\n  light(p5, p5.prototype);\n  loading(p5, p5.prototype);\n  material(p5, p5.prototype);\n  text(p5, p5.prototype);\n  renderBuffer(p5, p5.prototype);\n  quat(p5, p5.prototype);\n  matrix(p5, p5.prototype);\n  geometry(p5, p5.prototype);\n  camera(p5, p5.prototype);\n  framebuffer(p5, p5.prototype);\n  dataArray(p5, p5.prototype);\n  shader(p5, p5.prototype);\n  texture(p5, p5.prototype);\n  shadergenerator(p5, p5.prototype);\n}\n\nexport { webgl as default };\n","import { T as TEXTURE } from '../constants-8IpwyBct.js';\nimport { R as RendererGL } from '../rendering-BELwvfI6.js';\nimport { Vector } from '../math/p5.Vector.js';\nimport { Geometry } from './p5.Geometry.js';\nimport { Font, arrayCommandsToObjects } from '../type/p5.Font.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../dom/p5.Element.js';\nimport '../dom/p5.File.js';\nimport '../io/p5.XML.js';\nimport '../p5.Renderer-DoDzbpcT.js';\nimport '../image/filters.js';\nimport '../shape/custom_shapes.js';\nimport '../core/States.js';\nimport '../io/utilities.js';\nimport 'file-saver';\nimport '../dom/p5.MediaElement.js';\nimport '../shape/2d_primitives.js';\nimport '../core/helpers.js';\nimport '../shape/attributes.js';\nimport '../shape/curves.js';\nimport '../shape/vertex.js';\nimport '../color/setting.js';\nimport 'omggif';\nimport '../io/csv.js';\nimport 'gifenc';\nimport '../image/pixels.js';\nimport '../core/transform.js';\nimport './GeometryBuilder.js';\nimport '../math/p5.Matrix.js';\nimport '../math/Matrices/Matrix.js';\nimport '../math/Matrices/MatrixInterface.js';\nimport './p5.Quat.js';\nimport './p5.RenderBuffer.js';\nimport './p5.DataArray.js';\nimport './ShapeBuilder.js';\nimport 'libtess';\nimport './GeometryBufferCache.js';\nimport '../image/const.js';\nimport '../math/trigonometry.js';\nimport '../type/textCore.js';\nimport '@japont/unicode-range';\nimport '../type/unicodeRanges.js';\nimport '../type/lib/Typr.js';\nimport 'pako';\nimport '@davepagurek/bezier-path';\n\nfunction text(p5, fn) {\n  RendererGL.prototype.maxCachedGlyphs = function() {\n    // TODO: use more than vibes to find a good value for this\n    return 200;\n  };\n\n  Font.prototype._getFontInfo = function(axs) {\n    // For WebGL, a cache of font data to use on the GPU.\n    this._fontInfos = this._fontInfos || {};\n\n    const key = JSON.stringify(axs);\n    if (this._fontInfos[key]) {\n      const val = this._fontInfos[key];\n      return val;\n    } else {\n      const val = new FontInfo(this, { axs });\n      this._fontInfos[key] = val;\n      return val;\n    }\n  };\n\n  // Text/Typography (see src/type/textCore.js)\n  /*\n  RendererGL.prototype.textWidth = function(s) {\n    if (this._isOpenType()) {\n      return this.states.textFont.font._textWidth(s, this.states.textSize);\n    }\n\n    return 0; // TODO: error\n  };\n  */\n\n  // rendering constants\n\n  // the number of rows/columns dividing each glyph\n  const charGridWidth = 9;\n  const charGridHeight = charGridWidth;\n\n  // size of the image holding the bezier stroke info\n  const strokeImageWidth = 64;\n  const strokeImageHeight = 64;\n\n  // size of the image holding the stroke indices for each row/col\n  const gridImageWidth = 64;\n  const gridImageHeight = 64;\n\n  // size of the image holding the offset/length of each row/col stripe\n  const cellImageWidth = 64;\n  const cellImageHeight = 64;\n\n  /**\n   * @private\n   * @class ImageInfos\n   * @param {Integer} width\n   * @param {Integer} height\n   *\n   * the ImageInfos class holds a list of ImageDatas of a given size.\n   */\n  class ImageInfos {\n    constructor(width, height) {\n      this.width = width;\n      this.height = height;\n      this.infos = []; // the list of images\n    }\n    /**\n     *\n     * @param {Integer} space\n     * @return {Object} contains the ImageData, and pixel index into that\n     *                  ImageData where the free space was allocated.\n     *\n     * finds free space of a given size in the ImageData list\n     */\n    findImage(space) {\n      const imageSize = this.width * this.height;\n      if (space > imageSize)\n        throw new Error(\"font is too complex to render in 3D\");\n\n      // search through the list of images, looking for one with\n      // anough unused space.\n      let imageInfo, imageData;\n      for (let ii = this.infos.length - 1; ii >= 0; --ii) {\n        const imageInfoTest = this.infos[ii];\n        if (imageInfoTest.index + space < imageSize) {\n          // found one\n          imageInfo = imageInfoTest;\n          imageData = imageInfoTest.imageData;\n          break;\n        }\n      }\n\n      if (!imageInfo) {\n        try {\n          // create a new image\n          imageData = new ImageData(this.width, this.height);\n        } catch (err) {\n          // for browsers that don't support ImageData constructors (ie IE11)\n          // create an ImageData using the old method\n          let canvas = document.getElementsByTagName(\"canvas\")[0];\n          const created = !canvas;\n          if (!canvas) {\n            // create a temporary canvas\n            canvas = document.createElement(\"canvas\");\n            canvas.style.display = \"none\";\n            document.body.appendChild(canvas);\n          }\n          const ctx = canvas.getContext(\"2d\");\n          if (ctx) {\n            imageData = ctx.createImageData(this.width, this.height);\n          }\n          if (created) {\n            // distroy the temporary canvas, if necessary\n            document.body.removeChild(canvas);\n          }\n        }\n        // construct & dd the new image info\n        imageInfo = { index: 0, imageData };\n        this.infos.push(imageInfo);\n      }\n\n      const index = imageInfo.index;\n      imageInfo.index += space; // move to the start of the next image\n      imageData._dirty = true;\n      return { imageData, index };\n    }\n  }\n\n  /**\n   * @function setPixel\n   * @param {Object} imageInfo\n   * @param {Number} r\n   * @param {Number} g\n   * @param {Number} b\n   * @param {Number} a\n   *\n   * writes the next pixel into an indexed ImageData\n   */\n  function setPixel(imageInfo, r, g, b, a) {\n    const imageData = imageInfo.imageData;\n    const pixels = imageData.data;\n    let index = imageInfo.index++ * 4;\n    pixels[index++] = r;\n    pixels[index++] = g;\n    pixels[index++] = b;\n    pixels[index++] = a;\n  }\n\n  const SQRT3 = Math.sqrt(3);\n\n  /**\n   * @private\n   * @class FontInfo\n   * @param {Object} font an opentype.js font object\n   *\n   * contains cached images and glyph information for an opentype font\n   */\n  class FontInfo {\n    constructor(font, { axs } = {}) {\n      this.font = font;\n      this.axs = axs;\n      // the bezier curve coordinates\n      this.strokeImageInfos = new ImageInfos(\n        strokeImageWidth,\n        strokeImageHeight,\n      );\n      // lists of curve indices for each row/column slice\n      this.colDimImageInfos = new ImageInfos(gridImageWidth, gridImageHeight);\n      this.rowDimImageInfos = new ImageInfos(gridImageWidth, gridImageHeight);\n      // the offset & length of each row/col slice in the glyph\n      this.colCellImageInfos = new ImageInfos(cellImageWidth, cellImageHeight);\n      this.rowCellImageInfos = new ImageInfos(cellImageWidth, cellImageHeight);\n\n      // the cached information for each glyph\n      this.glyphInfos = {};\n    }\n    /**\n     * @param {Glyph} glyph the x positions of points in the curve\n     * @returns {Object} the glyphInfo for that glyph\n     *\n     * calculates rendering info for a glyph, including the curve information,\n     * row & column stripes compiled into textures.\n     */\n    getGlyphInfo(glyph) {\n      // check the cache\n      let gi = this.glyphInfos[glyph.index];\n      if (gi) return gi;\n\n      const axs = this.axs;\n      const {\n        glyph: {\n          path: { commands },\n        },\n      } = this.font._singleShapeToPath(glyph.shape, { axs });\n      let xMin = Infinity;\n      let xMax = -Infinity;\n      let yMin = Infinity;\n      let yMax = -Infinity;\n\n      for (const cmd of commands) {\n        for (let i = 1; i < cmd.length; i += 2) {\n          xMin = Math.min(xMin, cmd[i]);\n          xMax = Math.max(xMax, cmd[i]);\n          yMin = Math.min(yMin, cmd[i + 1]);\n          yMax = Math.max(yMax, cmd[i + 1]);\n        }\n      }\n\n      // don't bother rendering invisible glyphs\n      if (xMin >= xMax || yMin >= yMax || !commands.length) {\n        return (this.glyphInfos[glyph.index] = {});\n      }\n\n      const gWidth = xMax - xMin;\n      const gHeight = yMax - yMin;\n\n      // Convert arrays to named objects\n      const cmds = arrayCommandsToObjects(commands);\n\n      let i;\n      const strokes = []; // the strokes in this glyph\n      const rows = []; // the indices of strokes in each row\n      const cols = []; // the indices of strokes in each column\n      for (i = charGridWidth - 1; i >= 0; --i) cols.push([]);\n      for (i = charGridHeight - 1; i >= 0; --i) rows.push([]);\n\n      /**\n       * @function push\n       * @param {Number[]} xs the x positions of points in the curve\n       * @param {Number[]} ys the y positions of points in the curve\n       * @param {Object} v    the curve information\n       *\n       * adds a curve to the rows & columns that it intersects with\n       */\n      function push(xs, ys, v) {\n        const index = strokes.length; // the index of this stroke\n        strokes.push(v); // add this stroke to the list\n\n        /**\n         * @function minMax\n         * @param {Number[]} rg the list of values to compare\n         * @param {Number} min the initial minimum value\n         * @param {Number} max the initial maximum value\n         *\n         * find the minimum & maximum value in a list of values\n         */\n        function minMax(rg, min, max) {\n          for (let i = rg.length; i-- > 0; ) {\n            const v = rg[i];\n            if (min > v) min = v;\n            if (max < v) max = v;\n          }\n          return { min, max };\n        }\n\n        // Expand the bounding box of the glyph by the number of cells below\n        // before rounding. Curves only partially through a cell won't be added\n        // to adjacent cells, but ones that are close will be. This helps fix\n        // small visual glitches that occur when curves are close to grid cell\n        // boundaries.\n        const cellOffset = 0.5;\n\n        // loop through the rows & columns that the curve intersects\n        // adding the curve to those slices\n        const mmX = minMax(xs, 1, 0);\n        const ixMin = Math.max(\n          Math.floor(mmX.min * charGridWidth - cellOffset),\n          0,\n        );\n        const ixMax = Math.min(\n          Math.ceil(mmX.max * charGridWidth + cellOffset),\n          charGridWidth,\n        );\n        for (let iCol = ixMin; iCol < ixMax; ++iCol) cols[iCol].push(index);\n\n        const mmY = minMax(ys, 1, 0);\n        const iyMin = Math.max(\n          Math.floor(mmY.min * charGridHeight - cellOffset),\n          0,\n        );\n        const iyMax = Math.min(\n          Math.ceil(mmY.max * charGridHeight + cellOffset),\n          charGridHeight,\n        );\n        for (let iRow = iyMin; iRow < iyMax; ++iRow) rows[iRow].push(index);\n      }\n\n      /**\n       * @function clamp\n       * @param {Number} v the value to clamp\n       * @param {Number} min the minimum value\n       * @param {Number} max the maxmimum value\n       *\n       * clamps a value between a minimum & maximum value\n       */\n      function clamp(v, min, max) {\n        if (v < min) return min;\n        if (v > max) return max;\n        return v;\n      }\n\n      /**\n       * @function byte\n       * @param {Number} v the value to scale\n       *\n       * converts a floating-point number in the range 0-1 to a byte 0-255\n       */\n      function byte(v) {\n        return clamp(255 * v, 0, 255);\n      }\n\n      /**\n       * @private\n       * @class Cubic\n       * @param {Number} p0 the start point of the curve\n       * @param {Number} c0 the first control point\n       * @param {Number} c1 the second control point\n       * @param {Number} p1 the end point\n       *\n       * a cubic curve\n       */\n      class Cubic {\n        constructor(p0, c0, c1, p1) {\n          this.p0 = p0;\n          this.c0 = c0;\n          this.c1 = c1;\n          this.p1 = p1;\n        }\n        /**\n         * @return {Object} the quadratic approximation\n         *\n         * converts the cubic to a quadtratic approximation by\n         * picking an appropriate quadratic control point\n         */\n        toQuadratic() {\n          return {\n            x: this.p0.x,\n            y: this.p0.y,\n            x1: this.p1.x,\n            y1: this.p1.y,\n            cx: ((this.c0.x + this.c1.x) * 3 - (this.p0.x + this.p1.x)) / 4,\n            cy: ((this.c0.y + this.c1.y) * 3 - (this.p0.y + this.p1.y)) / 4,\n          };\n        }\n\n        /**\n         * @return {Number} the error\n         *\n         * calculates the magnitude of error of this curve's\n         * quadratic approximation.\n         */\n        quadError() {\n          return (\n            Vector.sub(\n              Vector.sub(this.p1, this.p0),\n              Vector.mult(Vector.sub(this.c1, this.c0), 3),\n            ).mag() / 2\n          );\n        }\n\n        /**\n         * @param {Number} t the value (0-1) at which to split\n         * @return {Cubic} the second part of the curve\n         *\n         * splits the cubic into two parts at a point 't' along the curve.\n         * this cubic keeps its start point and its end point becomes the\n         * point at 't'. the 'end half is returned.\n         */\n        split(t) {\n          const m1 = Vector.lerp(this.p0, this.c0, t);\n          const m2 = Vector.lerp(this.c0, this.c1, t);\n          const mm1 = Vector.lerp(m1, m2, t);\n\n          this.c1 = Vector.lerp(this.c1, this.p1, t);\n          this.c0 = Vector.lerp(m2, this.c1, t);\n          const pt = Vector.lerp(mm1, this.c0, t);\n          const part1 = new Cubic(this.p0, m1, mm1, pt);\n          this.p0 = pt;\n          return part1;\n        }\n\n        /**\n         * @return {Cubic[]} the non-inflecting pieces of this cubic\n         *\n         * returns an array containing 0, 1 or 2 cubics split resulting\n         * from splitting this cubic at its inflection points.\n         * this cubic is (potentially) altered and returned in the list.\n         */\n        splitInflections() {\n          const a = Vector.sub(this.c0, this.p0);\n          const b = Vector.sub(Vector.sub(this.c1, this.c0), a);\n          const c = Vector.sub(\n            Vector.sub(Vector.sub(this.p1, this.c1), a),\n            Vector.mult(b, 2),\n          );\n\n          const cubics = [];\n\n          // find the derivative coefficients\n          let A = b.x * c.y - b.y * c.x;\n          if (A !== 0) {\n            let B = a.x * c.y - a.y * c.x;\n            let C = a.x * b.y - a.y * b.x;\n            const disc = B * B - 4 * A * C;\n            if (disc >= 0) {\n              if (A < 0) {\n                A = -A;\n                B = -B;\n                C = -C;\n              }\n\n              const Q = Math.sqrt(disc);\n              const t0 = (-B - Q) / (2 * A); // the first inflection point\n              let t1 = (-B + Q) / (2 * A); // the second inflection point\n\n              // test if the first inflection point lies on the curve\n              if (t0 > 0 && t0 < 1) {\n                // split at the first inflection point\n                cubics.push(this.split(t0));\n                // scale t2 into the second part\n                t1 = 1 - (1 - t1) / (1 - t0);\n              }\n\n              // test if the second inflection point lies on the curve\n              if (t1 > 0 && t1 < 1) {\n                // split at the second inflection point\n                cubics.push(this.split(t1));\n              }\n            }\n          }\n\n          cubics.push(this);\n          return cubics;\n        }\n      }\n\n      /**\n       * @function cubicToQuadratics\n       * @param {Number} x0\n       * @param {Number} y0\n       * @param {Number} cx0\n       * @param {Number} cy0\n       * @param {Number} cx1\n       * @param {Number} cy1\n       * @param {Number} x1\n       * @param {Number} y1\n       * @returns {Cubic[]} an array of cubics whose quadratic approximations\n       *                    closely match the civen cubic.\n       *\n       * converts a cubic curve to a list of quadratics.\n       */\n      function cubicToQuadratics(x0, y0, cx0, cy0, cx1, cy1, x1, y1) {\n        // create the Cubic object and split it at its inflections\n        const cubics = new Cubic(\n          new Vector(x0, y0),\n          new Vector(cx0, cy0),\n          new Vector(cx1, cy1),\n          new Vector(x1, y1),\n        ).splitInflections();\n\n        const qs = []; // the final list of quadratics\n        const precision = 30 / SQRT3;\n\n        // for each of the non-inflected pieces of the original cubic\n        for (let cubic of cubics) {\n          // the cubic is iteratively split in 3 pieces:\n          // the first piece is accumulated in 'qs', the result.\n          // the last piece is accumulated in 'tail', temporarily.\n          // the middle piece is repeatedly split again, while necessary.\n          const tail = [];\n\n          let t3;\n          for (;;) {\n            // calculate this cubic's precision\n            t3 = precision / cubic.quadError();\n            if (t3 >= 0.5 * 0.5 * 0.5) {\n              break; // not too bad, we're done\n            }\n\n            // find a split point based on the error\n            const t = Math.pow(t3, 1.0 / 3.0);\n            // split the cubic in 3\n            const start = cubic.split(t);\n            const middle = cubic.split(1 - t / (1 - t));\n\n            qs.push(start); // the first part\n            tail.push(cubic); // the last part\n            cubic = middle; // iterate on the middle piece\n          }\n\n          if (t3 < 1) {\n            // a little excess error, split the middle in two\n            qs.push(cubic.split(0.5));\n          }\n          // add the middle piece to the result\n          qs.push(cubic);\n\n          // finally add the tail, reversed, onto the result\n          Array.prototype.push.apply(qs, tail.reverse());\n        }\n\n        return qs;\n      }\n\n      /**\n       * @function pushLine\n       * @param {Number} x0\n       * @param {Number} y0\n       * @param {Number} x1\n       * @param {Number} y1\n       *\n       * add a straight line to the row/col grid of a glyph\n       */\n      function pushLine(x0, y0, x1, y1) {\n        const mx = (x0 + x1) / 2;\n        const my = (y0 + y1) / 2;\n        push([x0, x1], [y0, y1], { x: x0, y: y0, cx: mx, cy: my });\n      }\n\n      /**\n       * @function samePoint\n       * @param {Number} x0\n       * @param {Number} y0\n       * @param {Number} x1\n       * @param {Number} y1\n       * @return {Boolean} true if the two points are sufficiently close\n       *\n       * tests if two points are close enough to be considered the same\n       */\n      function samePoint(x0, y0, x1, y1) {\n        return Math.abs(x1 - x0) < 0.00001 && Math.abs(y1 - y0) < 0.00001;\n      }\n\n      let x0, y0, xs, ys;\n\n      for (const cmd of cmds) {\n        // scale the coordinates to the range 0-1\n        const x1 = (cmd.x - xMin) / gWidth;\n        const y1 = (cmd.y - yMin) / gHeight;\n\n        // don't bother if this point is the same as the last\n        if (samePoint(x0, y0, x1, y1)) continue;\n\n        switch (cmd.type) {\n          case \"M\": {\n            // move\n            xs = x1;\n            ys = y1;\n            break;\n          }\n          case \"L\": {\n            // line\n            pushLine(x0, y0, x1, y1);\n            break;\n          }\n          case \"Q\": {\n            // quadratic\n            const cx = (cmd.x1 - xMin) / gWidth;\n            const cy = (cmd.y1 - yMin) / gHeight;\n            push([x0, x1, cx], [y0, y1, cy], { x: x0, y: y0, cx, cy });\n            break;\n          }\n          case \"Z\": {\n            // end\n            if (!samePoint(x0, y0, xs, ys)) {\n              // add an extra line closing the loop, if necessary\n              pushLine(x0, y0, xs, ys);\n              strokes.push({ x: xs, y: ys });\n            } else {\n              strokes.push({ x: x0, y: y0 });\n            }\n            break;\n          }\n          case \"C\": {\n            // cubic\n            const cx1 = (cmd.x1 - xMin) / gWidth;\n            const cy1 = (cmd.y1 - yMin) / gHeight;\n            const cx2 = (cmd.x2 - xMin) / gWidth;\n            const cy2 = (cmd.y2 - yMin) / gHeight;\n            const qs = cubicToQuadratics(x0, y0, cx1, cy1, cx2, cy2, x1, y1);\n            for (let iq = 0; iq < qs.length; iq++) {\n              const q = qs[iq].toQuadratic();\n              push([q.x, q.x1, q.cx], [q.y, q.y1, q.cy], q);\n            }\n            break;\n          }\n          default:\n            throw new Error(`unknown command type: ${cmd.type}`);\n        }\n        x0 = x1;\n        y0 = y1;\n      }\n\n      // allocate space for the strokes\n      const strokeCount = strokes.length;\n      const strokeImageInfo = this.strokeImageInfos.findImage(strokeCount);\n      const strokeOffset = strokeImageInfo.index;\n\n      // fill the stroke image\n      for (let il = 0; il < strokeCount; ++il) {\n        const s = strokes[il];\n        setPixel(strokeImageInfo, byte(s.x), byte(s.y), byte(s.cx), byte(s.cy));\n      }\n\n      /**\n       * @function layout\n       * @param {Number[][]} dim\n       * @param {ImageInfo[]} dimImageInfos\n       * @param {ImageInfo[]} cellImageInfos\n       * @return {Object}\n       *\n       * lays out the curves in a dimension (row or col) into two\n       * images, one for the indices of the curves themselves, and\n       * one containing the offset and length of those index spans.\n       */\n      function layout(dim, dimImageInfos, cellImageInfos) {\n        const dimLength = dim.length; // the number of slices in this dimension\n        const dimImageInfo = dimImageInfos.findImage(dimLength);\n        const dimOffset = dimImageInfo.index;\n        // calculate the total number of stroke indices in this dimension\n        let totalStrokes = 0;\n        for (let id = 0; id < dimLength; ++id) {\n          totalStrokes += dim[id].length;\n        }\n\n        // allocate space for the stroke indices\n        const cellImageInfo = cellImageInfos.findImage(totalStrokes);\n\n        // for each slice in the glyph\n        for (let i = 0; i < dimLength; ++i) {\n          const strokeIndices = dim[i];\n          const strokeCount = strokeIndices.length;\n          const cellLineIndex = cellImageInfo.index;\n\n          // write the offset and count into the glyph slice image\n          setPixel(\n            dimImageInfo,\n            cellLineIndex >> 7,\n            cellLineIndex & 0x7f,\n            strokeCount >> 7,\n            strokeCount & 0x7f,\n          );\n\n          // for each stroke index in that slice\n          for (let iil = 0; iil < strokeCount; ++iil) {\n            // write the stroke index into the slice's image\n            const strokeIndex = strokeIndices[iil] + strokeOffset;\n            setPixel(cellImageInfo, strokeIndex >> 7, strokeIndex & 0x7f, 0, 0);\n          }\n        }\n\n        return {\n          cellImageInfo,\n          dimOffset,\n          dimImageInfo,\n        };\n      }\n\n      // initialize the info for this glyph\n      gi = this.glyphInfos[glyph.index] = {\n        glyph,\n        uGlyphRect: [xMin, yMin, xMax, yMax],\n        strokeImageInfo,\n        strokes,\n        colInfo: layout(cols, this.colDimImageInfos, this.colCellImageInfos),\n        rowInfo: layout(rows, this.rowDimImageInfos, this.rowCellImageInfos),\n      };\n      gi.uGridOffset = [gi.colInfo.dimOffset, gi.rowInfo.dimOffset];\n      return gi;\n    }\n  }\n\n  RendererGL.prototype._renderText = function (line, x, y, maxY, minY) {\n    if (!this.states.textFont || typeof this.states.textFont === \"string\") {\n      console.log(\n        \"WEBGL: you must load and set a font before drawing text. See `loadFont` and `textFont` for more details.\",\n      );\n      return;\n    }\n    if (y >= maxY || !this.states.fillColor) {\n      return; // don't render lines beyond our maxY position\n    }\n\n    if (!p5.Font.hasGlyphData(this.states.textFont)) {\n      console.log(\n        \"WEBGL: only Opentype (.otf) and Truetype (.ttf) fonts with glyph data are supported\",\n      );\n      return;\n    }\n\n    this.push(); // fix to #803\n\n    // remember this state, so it can be restored later\n    const doStroke = this.states.strokeColor;\n    const drawMode = this.states.drawMode;\n\n    this.states.setValue(\"strokeColor\", null);\n    this.states.setValue(\"drawMode\", TEXTURE);\n\n    // get the cached FontInfo object\n    const { font } = this.states.textFont;\n    if (!font) {\n      throw new Error(\n        \"In WebGL mode, textFont() needs to be given the result of loadFont() instead of a font family name.\",\n      );\n    }\n    const axs = font._currentAxes(this);\n    let fontInfo = font._getFontInfo(axs);\n\n    // calculate the alignment and move/scale the view accordingly\n    // TODO: check this\n    const pos = { x, y }; // this.states.textFont._handleAlignment(this, line, x, y);\n    const fontSize = this.states.textSize;\n    const scale = fontSize / (font.data?.head?.unitsPerEm || 1000);\n    this.translate(pos.x, pos.y, 0);\n    this.scale(scale, scale, 1);\n\n    // initialize the font shader\n    const gl = this.GL;\n    const initializeShader = !this._defaultFontShader;\n    const sh = this._getFontShader();\n    sh.init();\n    sh.bindShader(); // first time around, bind the shader fully\n\n    if (initializeShader) {\n      // these are constants, really. just initialize them one-time.\n      sh.setUniform(\"uGridImageSize\", [gridImageWidth, gridImageHeight]);\n      sh.setUniform(\"uCellsImageSize\", [cellImageWidth, cellImageHeight]);\n      sh.setUniform(\"uStrokeImageSize\", [strokeImageWidth, strokeImageHeight]);\n      sh.setUniform(\"uGridSize\", [charGridWidth, charGridHeight]);\n    }\n\n    const curFillColor = this.states.fillSet\n      ? this.states.curFillColor\n      : [0, 0, 0, 255];\n\n    this._setGlobalUniforms(sh);\n    this._applyColorBlend(curFillColor);\n\n    let g = this.geometryBufferCache.getGeometryByID(\"glyph\");\n    if (!g) {\n      // create the geometry for rendering a quad\n      g = this._textGeom = new Geometry(\n        1,\n        1,\n        function () {\n          for (let i = 0; i <= 1; i++) {\n            for (let j = 0; j <= 1; j++) {\n              this.vertices.push(new Vector(j, i, 0));\n              this.uvs.push(j, i);\n            }\n          }\n        },\n        this,\n      );\n      g.gid = \"glyph\";\n      g.computeFaces().computeNormals();\n      this.geometryBufferCache.ensureCached(g);\n    }\n\n    // bind the shader buffers\n    for (const buff of this.buffers.text) {\n      buff._prepareBuffer(g, sh);\n    }\n    this._bindBuffer(\n      this.geometryBufferCache.cache.glyph.indexBuffer,\n      gl.ELEMENT_ARRAY_BUFFER,\n    );\n\n    // this will have to do for now...\n    sh.setUniform(\"uMaterialColor\", curFillColor);\n    gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n\n    this.glyphDataCache = this.glyphDataCache || new Set();\n\n    try {\n      // fetch the glyphs in the line of text\n      const glyphs = font._positionGlyphs(line);\n\n      for (const glyph of glyphs) {\n        const gi = fontInfo.getGlyphInfo(glyph);\n        if (gi.uGlyphRect) {\n          const rowInfo = gi.rowInfo;\n          const colInfo = gi.colInfo;\n\n          // Bump the resources for this glyph to the end of the cache list by deleting and re-adding\n          const glyphResources = [\n            gi.strokeImageInfo.imageData,\n            rowInfo.cellImageInfo.imageData,\n            rowInfo.dimImageInfo.imageData,\n            colInfo.cellImageInfo.imageData,\n            colInfo.dimImageInfo.imageData\n          ];\n          for (const resource of glyphResources) {\n            this.glyphDataCache.delete(resource);\n            this.glyphDataCache.add(resource);\n          }\n\n          // If we have too many glyph textures, remove the least recently used\n          // ones from GPU memory. The data still exists on the CPU and will be\n          // re-uploaded if it gets actively used again.\n          while (this.glyphDataCache.size > this.maxCachedGlyphs()) {\n            const data = this.glyphDataCache.values().next().value;\n            this.glyphDataCache.delete(data);\n            const tex = this.textures.get(data);\n            if (tex) {\n              tex.remove();\n              this.textures.delete(data);\n            }\n          }\n\n          sh.setUniform(\"uSamplerStrokes\", gi.strokeImageInfo.imageData);\n          sh.setUniform(\"uSamplerRowStrokes\", rowInfo.cellImageInfo.imageData);\n          sh.setUniform(\"uSamplerRows\", rowInfo.dimImageInfo.imageData);\n          sh.setUniform(\"uSamplerColStrokes\", colInfo.cellImageInfo.imageData);\n          sh.setUniform(\"uSamplerCols\", colInfo.dimImageInfo.imageData);\n          sh.setUniform(\"uGridOffset\", gi.uGridOffset);\n          sh.setUniform(\"uGlyphRect\", gi.uGlyphRect);\n          sh.setUniform(\"uGlyphOffset\", glyph.x);\n\n          sh.bindTextures(); // afterwards, only textures need updating\n\n          // draw it\n          gl.drawElements(gl.TRIANGLES, 6, this.GL.UNSIGNED_SHORT, 0);\n        }\n      }\n    } finally {\n      // clean up\n      sh.unbindShader();\n\n      this.states.setValue(\"strokeColor\", doStroke);\n      this.states.setValue(\"drawMode\", drawMode);\n      gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n\n      this.pop();\n    }\n  };\n}\n\nexport { text as default };\n","import textCore from './textCore.js';\nimport font from './p5.Font.js';\nimport '../p5.Renderer-DoDzbpcT.js';\nimport '../creating_reading-BdolPjuO.js';\nimport 'colorjs.io/fn';\nimport '../color/color_spaces/hsb.js';\nimport '../constants-8IpwyBct.js';\nimport '../image/filters.js';\nimport '../math/p5.Vector.js';\nimport '../shape/custom_shapes.js';\nimport '../core/States.js';\nimport '../io/utilities.js';\nimport 'file-saver';\nimport '@japont/unicode-range';\nimport './unicodeRanges.js';\nimport './lib/Typr.js';\nimport 'pako';\nimport '@davepagurek/bezier-path';\n\nfunction type(p5){\n  p5.registerAddon(textCore);\n  p5.registerAddon(font);\n}\n\nexport { type as default };\n"],"names":["_PI","Math","PI","VERSION","P2D","WEBGL","WEBGL2","ARROW","SIMPLE","FULL","CROSS","HAND","MOVE","TEXT","WAIT","HALF_PI","QUARTER_PI","TAU","TWO_PI","DEG_TO_RAD","RAD_TO_DEG","CORNER","CORNERS","RADIUS","RIGHT","LEFT","CENTER","BOTTOM","BASELINE","POINTS","LINES","TRIANGLES","QUADS","QUAD_STRIP","CLOSE","OPEN","CHORD","PIE","PROJECT","SQUARE","ROUND","BEVEL","MITER","AUTO","BLEND","REMOVE","ADD","DARKEST","LIGHTEST","DIFFERENCE","SUBTRACT","EXCLUSION","MULTIPLY","SCREEN","REPLACE","OVERLAY","HARD_LIGHT","SOFT_LIGHT","DODGE","BURN","THRESHOLD","GRAY","OPAQUE","INVERT","POSTERIZE","DILATE","ERODE","BLUR","NORMAL","WORD","LINEAR","FILL","TEXTURE","IMAGE","NEAREST","REPEAT","CLAMP","MIRROR","FLAT","SMOOTH","_DEFAULT_STROKE","_DEFAULT_FILL","GRID","AXES","CONTAIN","COVER","UNSIGNED_BYTE","UNSIGNED_INT","FLOAT","HALF_FLOAT","INCLUDE","Symbol","EXCLUDE","JOIN","constants","Object","freeze","__proto__","ALT","BACKSPACE","BEZIER","BOLD","BOLDITALIC","CHAR","CONTROL","CURVE","DELETE","DOWN_ARROW","EMPTY_PATH","ENTER","ESCAPE","FALLBACK","IMMEDIATE","ITALIC","LABEL","LANDSCAPE","LEFT_ARROW","LINE_LOOP","LINE_STRIP","OPTION","P2DHDR","PATH","PORTRAIT","QUADRATIC","RETURN","RIGHT_ARROW","SHIFT","STROKE","TAB","TESS","TOP","TRIANGLE_FAN","TRIANGLE_STRIP","UP_ARROW","_CTX_MIDDLE","_DEFAULT_LEADMULT","_DEFAULT_TEXT_FILL","transform","p5","fn","applyMatrix","isTypedArray","arguments","length","undefined","getPrototypeOf","Uint8Array","Array","isArray","this","_renderer","resetMatrix","rotate","angle","axis","_toRadians","rotateX","_assert3d","rotateY","rotateZ","scale","x","y","z","Vector","v","rg","isNaN","shearX","rad","tan","shearY","translate","isP3D","push","pop","structure","noLoop","_loop","loop","_setupDone","_draw","isLooping","redraw","async","n","_inUserDraw","numberOfRedraws","parseInt","context","_isGlobal","window","draw","setup","_pixelDensity","idxRedraw","_accessibleOutputs","grid","text","_updateAccsOutput","_update","frameCount","_runLifecycleHook","prototype","calculateRemainder2D","xComponent","yComponent","calculateRemainder3D","zComponent","constructor","_len","args","_key","values","map","arg","isPInst","_fromRadians","slice","dimensions","_values","newValues","getValue","index","_friendlyError","setValue","value","w","xVal","yVal","zVal","wVal","toString","concat","join","set","_len2","_key2","copy","add","_len3","_key3","forEach","rem","every","Number","isFinite","parseFloat","call","element","vectorComponents","sub","_len4","_key4","mult","maxLen","min","i","console","warn","arr","div","_len5","_key5","val","some","mag","sqrt","magSq","reduce","sum","component","dot","_len6","_key6","cross","dist","normalize","len","limit","max","mSq","setMag","heading","h","atan2","setHeading","a","m","cos","sin","newHeading","angleBetween","NaN","u","sign","lerp","amt","slerp","selfMag","vMag","axisMag","theta","ey","lerpedMagFactor","cosMultiplier","sinMultiplier","reflect","surfaceNormal","surfaceNormalCopy","array","equals","_len7","_key7","clampToZero","_clampToZero","abs","EPSILON","fromAngle","fromAngles","phi","cosPhi","sinPhi","cosTheta","sinTheta","random2D","random","random3D","vz","vzBase","vx","vy","v1","v2","target","vecT","incidentVector","vector","environment","standardCursors","_frameRate","_lastFrameTime","performance","now","_targetFrameRate","_windowPrint","print","windowPrintDisabled","getWindowWidth","innerWidth","document","documentElement","clientWidth","body","getWindowHeight","innerHeight","clientHeight","log","confirm","deltaTime","focused","hasFocus","cursor","type","canvas","_curElement","elt","includes","coords","substring","test","style","frameRate","fps","getFrameRate","setFrameRate","getTargetFrameRate","noCursor","webglVersion","displayWidth","screen","width","displayHeight","height","windowWidth","windowHeight","_onresize","e","executeDefault","windowResized","preventDefault","_updateWindowSize","defineProperty","get","fullscreen","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","Error","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","launchFullscreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","pixelDensity","returnValue","resizeCanvas","displayDensity","devicePixelRatio","getURL","location","href","getURLPath","pathname","split","filter","getURLParams","re","exec","search","lastIndex","worldToScreen","worldPosition","createVector","getWorldToScreenMatrix","multiplyAndNormalizePoint","screenToWorld","screenPosition","matrix","mat4","invert","HSBSpace","ColorSpace","id","name","refRange","s","range","b","base","sRGB","fromBase","rgb","chroma","hue","sat","red","green","blue","toBase","formats","default","serialize","alpha","ret","round","commans","lastAlpha","hsb","RGB","sector","floor","tint1","tint2","tint3","start1","stop1","start2","stop2","clamp","result","serializationMap","_Color_brand","WeakSet","Color","addColorMode","mode","definition","register","colorMap","_colorjsMaxes","_","acc","_grayscaleMap","fromGray","vals","colorMode","colorMaxes","_classPrivateMethodInitSpec","_defineProperty","_color","to","parse","entries","find","_ref2","key","spaceId","err","mappedVals","mapColorRange","alphaMaxes","space","error","color","_ref","origin","maxes","p5Maxes","colorjsMaxes","channel","unmapColorRange","_array","_getRGBA","spaceIndex","path","obj","format","colorString","setRed","new_red","colorjsMax","newval","RGBHDR","representation","setGreen","new_green","setBlue","new_blue","setAlpha","new_alpha","structuredClone","rangeMaxes","coord","_getMode","_getRed","_getGreen","_getBlue","_getAlpha","_getHue","HSB","HSL","_getSaturation","_getBrightness","_getLightness","lifecycles","P3","HSL$1","HWB$1","wbMax","nVal","white","black","Lab","LCH$1","OKLab","OKLCH$1","HWB","LAB","LCH","OKLAB","OKLCH","presetup","pInst","setMethods","method","setCopy","_pInst$_renderer","states","decorateGet","modes","getCopy","keys","_pInst$_renderer2","_pInst$_renderer3","defaultMode","RGBA","creatingReading","Renderer","clone","cloned","_objectSpread","c","saturation","brightness","lightness","lerpColor","c1","c2","paletteLerp","color_stops","first_color_stop","color_stop","prev_color_stop","XML","DOM","xmlDoc","implementation","createDocument","createElement","getParent","parentElement","getName","tagName","setName","content","innerHTML","attributes","newDOM","setAttribute","nodeName","nodeValue","hasChildren","children","listChildren","childNodes","getChildren","param","elementsToP5XML","getElementsByTagName","getChild","child","addChild","node","appendChild","removeChild","ind","getAttributeCount","listAttributes","attribute","hasAttribute","getNum","defaultValue","getString","String","getContent","str","textContent","replace","setContent","XMLSerializer","serializeToString","elements","xml","File","file","_pInst","typeList","subtype","size","data","_createLoader","theFile","callback","reader","FileReader","onload","p5file","JSON","DOMParser","parseFromString","_load","f","readAsText","URL","createObjectURL","readAsDataURL","Element","_pixelsState","_events","offsetWidth","offsetHeight","remove","stop","sources","srcObject","getTracks","track","sketch","_elements","indexOf","splice","ev","removeEventListener","parentNode","parent","p","getElementById","childNode","HTMLElement","html","insertAdjacentHTML","class","className","addClass","hasClass","removeClass","classList","contains","toggleClass","center","align","display","hidden","parentHidden","pos","offsetLeft","offsetTop","show","position","wOffset","hOffset","hide","positionType","left","top","aW","aH","AUTO$1","HTMLCanvasElement","j","k","getContext","prop","self","getComputedStyle","getPropertyValue","attrs","parts","trim","numVal","_translate","perspective","_rotate","attr","firstChild","getAttribute","removeAttribute","mousePressed","fxn","_adjustListener","event","mouseIsPressed","_activePointers","pointerId","_setMouseButton","_updatePointerCoords","doubleClicked","mouseWheel","mouseReleased","mouseClicked","mouseMoved","mouseOver","mouseOut","dragOver","dragLeave","changed","input","drop","FileList","Blob","_dragDisabled","evt","addEventListener","_attachListener","files","dataTransfer","draggable","elmMove","elmDrag","isTouch","px","py","dragMouseDownEvt","closeDragElementEvt","elementDragEvt","elementDrag","touches","changedTouches","clientX","clientY","closeDragElement","ctx","_detachListener","bind","Filters","_toPixels","ImageData","getImageData","gl","drawingBufferWidth","drawingBufferHeight","readPixels","_getARGB","offset","_setPixels","pixels","al","_toImageData","_createImageData","_tmpCanvas","_tmpCtx","createImageData","apply","func","filterParam","pixelsState","imageData","newImageData","putImageData","threshold","level","thresh","gray","opaque","posterize","levels1","rlevel","glevel","blevel","dilate","currIdx","maxIdx","out","Int32Array","currRowIdx","maxRowIdx","colOrig","colOut","currLum","idxRight","idxLeft","idxUp","idxDown","colRight","colLeft","colUp","colDown","lumRight","lumLeft","lumUp","lumDown","erode","blur","radius","numPackedPixels","argb","cr","cg","cb","ca","read","ri","ym","ymi","bk0","a2","r2","g2","b2","bm","yi","r","blurRadius","blurKernelSize","blurKernel","blurMult","l","bk","bki","bmi","radiusi","buildBlurKernel","blurARGB","polylineLength","vertices","Vertex","properties","ShapePrimitive","vertexCount","vertexCapacity","_firstInterpolatedVertex","startVertex","canOverrideAnchor","accept","visitor","addToShape","shape","lastContour","at","primitives","pushableVertices","remainingVertices","lastPrimitive","hasSameType","spareCapacity","_primitivesIndex","_contoursIndex","contours","_shape","_nextPrimitive","_belongsToShape","handlesClose","close","vertex","_kind","WeakMap","Contour","kind","_classPrivateFieldInitSpec","_classPrivateFieldSet","isEmpty","isPath","_classPrivateFieldGet","primitive","_vertexCapacity","Anchor","visitAnchor","getEndVertex","Segment","super","_previousPrimitive","getStartVertex","_vertexCapacity2","LineSegment","visitLineSegment","_order","_vertexCapacity3","_hullLength","BezierSegment","order","numericalOrder","hullLength","visitBezierSegment","_vertexCapacity4","SplineSegment","Infinity","ends","tightness","visitSplineSegment","_comesAfterSegment","_splineProperties","_chainedToSegment","interpolatedStartPosition","added","verticesPushed","interpolatedStart","predecessorEnd","array1","array2","message","getControlPoints","points","prevVertex","unshift","_vertexCapacity5","Point","visitPoint","_vertexCapacity6","Line","visitLine","_vertexCapacity7","Triangle","visitTriangle","_vertexCapacity8","Quad","visitQuad","_vertexCapacity9","TriangleFan","visitTriangleFan","_vertexCapacity0","TriangleStrip","visitTriangleStrip","_vertexCapacity1","QuadStrip","visitQuadStrip","PrimitiveShapeCreators","creators","Map","_len8","_key8","_len9","_key9","_len0","_key0","_len1","_key1","_len10","_key10","_len11","_key11","_len12","_key12","_len13","_key13","vertexKind","shapeKind","creator","clear","_vertexProperties","_initialVertexProperties","_primitiveShapeCreators","_bezierOrder","_Shape_brand","Shape","vertexProperties","primitiveShapeCreators","serializeToArray","Function","vertexToArray","userVertexProperties","fill","hydrateValue","queue","original","shift","arrayToVertex","arrayScale","arraySum","first","_len14","rest","_key14","arrayMinus","evaluateCubicBezier","t","d","pow","evaluateQuadraticBezier","catmullRomToBezier","bezArrays","bezB","bezC","bezD","contoursIndex","primitivesIndex","verticesIndex","contour","reset","vertexProperty","vertexPropertyKey","dataArray","vertexPropertyName","bezierOrder","_len15","_key15","splineProperty","splineProperties","textureCoordinates","isClosing","_assertClassBrand","_generalVertex","bezierVertex","splineVertex","arcVertex","beginContour","_this$at","endContour","closeMode","_index","anchorVertex","anchorHasPosition","hasOwn","lastSegment","prevVertexProperties","beginShape","endShape","_createVertex","_createPrimitiveShape","primitiveShapeCreator","_len17","_key17","lastContourKind","PrimitiveVisitor","anchor","lineSegment","bezierSegment","curveSegment","visitArcSegment","arcSegment","point","line","triangle","quad","triangleFan","triangleStrip","quadStrip","PrimitiveToPath2DConverter","_ref3","strokeWeight","Path2D","moveTo","closePath","lineTo","v3","quadraticCurveTo","bezierCurveTo","splineSegment","arrayVertices","bezierArrays","vertArr","flatMap","vert","x0","y0","x1","y1","v0","PrimitiveToVerticesConverter","curveDetail","next","numPoints","ceil","vertexArrays","bezierControls","PointAtLengthGetter","customShapes","_len16","_key16","property","States","initialState","_modified","getDiff","diff","getModified","applyDiff","prevModified","downloadFile","fName","extension","filename","_checkFileExtension","saveData","fileSaver","ext","Image","drawingContext","gifProperties","density","_animateGif","props","curTime","_lastRealFrameTime","lastChangeTime","playing","timeDisplayed","curDelay","frames","displayIndex","delay","skips","loopCount","numFrames","loopLimit","image","setModified","loadPixels","pd","updatePixels","_getPixel","region","drawImage","imgOrCol","save","setTransform","clearRect","restore","g","idx","resize","tempCanvas","nearestNeighbor","src","dst","srcX","srcPos","resizedImageData","srcImage","sx","sy","sw","sh","dx","dy","dw","dh","_copyHelper","dstImage","sxMod","syMod","noLights","blendMode","imageMode","mask","p5Image","currBlend","globalCompositeOperation","imgScaleFactor","maskScaleFactor","copyArgs","operation","blend","isModified","pImg","buffer","allFramesPixelColors","paletteFreqsAndFrames","paletteSet","Set","dataLength","pixelColors","Uint32Array","paletteStr","sort","freq","framesUsingGlobalPalette","palettesSortedByFreq","globalPalette","globalPaletteSet","difference","has","globalIndicesLookup","powof2","opts","palette","gifWriter","omggif","GifWriter","previousFrame","localPaletteRequired","pixelPaletteIndex","colorIndicesLookup","cannotBeTransparent","frameOpts","canBeTransparent","transparent","transparentIndex","disposal","addFrame","end","encodeAndDownloadGif","mimeType","htmlCanvas","toBlob","blob","Promise","resolve","timeSinceStart","getCurrentFrame","setFrame","play","pause","frame","ClonableObject","isMainCanvas","_isMainCanvas","strokeColor","fillColor","_pushPopStack","_pushPopDepth","_clipping","_clipInvert","_currentShape","currentShape","getCommonVertexProperties","modified","updateShapeVertexProperties","updateShapeProperties","getSupportedIndividualVertexProperties","drawShape","count","bezier","x2","y2","x3","y3","x4","y4","oldOrder","spline","z1","z2","z3","z4","beginClip","options","endClip","noFill","stroke","noStroke","_applyDefaults","strokeSet","fillSet","tint","rectMode","ellipseMode","textFont","family","textLeading","leadingSet","textSize","textAlign","textBaseline","textWrap","fontStyle","fontStretch","fontWeight","lineHeight","fontVariant","direction","MediaElement","crossOrigin","_prevTime","_cueIDCounter","_cues","_frameOnCanvas","firstChildSrc","srcVal","newValue","source","_onended","onended","promise","currentTime","duration","readyState","load","catch","IS_MINIFIED","_friendlyAutoplayError","_setupAutoplayFailDetection","timeout","setTimeout","clearTimeout","passive","once","autoplay","oldVal","setupAutoplayFailDetection","volume","speed","presetPlaybackRate","playbackRate","loadedmetadata","time","_ensureCanvas","needsRedraw","flipped","Renderer2D","connect","audioContext","mainOutput","getAudioContext","soundOut","destination","audioSourceNode","createMediaElementSource","disconnect","showControls","controls","hideControls","addCue","cue","Cue","ontimeupdate","_onTimeUpdate","removeCue","clearCues","playbackTime","callbackTime","media","addElement","_userNode","createMedia","mediaSource","sourceEl","mediaEl","videoWidth","videoHeight","callbackHandler","createVideo","createAudio","VIDEO","AUDIO","navigator","mediaDevices","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","reject","createCapture","DOMException","useVideo","useAudio","assign","videoConstraints","video","audio","domElement","then","stream","videoEl","modeAdjust","bbox","_normalizeArcAngles","start","correctForScaling","separation","atan","correspondToSamePoint","arc","detail","angles","ellipse","_accsOutput","detailX","_renderEllipse","circle","argss","rect","_renderRect","square","tl","tr","br","bl","noSmooth","setAttributes","imageSmoothingEnabled","smooth","strokeCap","cap","strokeJoin","curves","bezierPoint","adjustedT","bezierTangent","splinePoint","t3","t2","splineTangent","tt3","normal","attributeName","setting","clip","background","_r","_g","_b","_a","max1","max2","max3","maxA","erase","opacityFill","opacityStroke","noErase","valueEnd","typed","inferType","entry","reviver","row","col","entryEnd","output","escapeRegExp","getFilterGraphicsLayer","shader","useWebGL","Shader","parseFilterArgs","filterRenderer","setOperation","applyFilter","GLMAT_ARRAY_TYPE","isMatrixArray","Float32Array","_matrix","MatrixInterface","isPerfectSquare","from","_sqDimention","_Matrix_brand","Matrix","sqDimention","_createIdentityMatrix","mat3","setElement","inMatrix","refArray","diagonal","columnIndex","columnVector","column","rowIndex","rowVector","transpose","_transpose4x","_transpose3x","_transposeNxN","multMatrix","_src","_mult4x","_mult3x","_multNxN","multiplyVec","multVector","_invert4x","_invert3x","createSubMatrix3x3","inverseTranspose4x4","inverse","m0","m4","m8","m12","m1","m5","m9","m13","m2","m6","m10","m14","m3","m7","m11","m15","rotate4x4","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","sA","cA","tA","b00","b01","b02","b10","b11","b12","b20","b21","b22","fovy","aspect","near","far","nf","ortho","right","bottom","lr","bt","multiplyVec4","multiplyPoint","multiplyDirection","_ref4","multiplyVec3","dimension","identityMatrix","b0","b1","b3","a30","a31","a32","a33","b03","b04","b05","b06","b07","b08","b09","det","_Matrix","DataArray","initialLength","subArray","rescale","targetLength","log2","newData","subarray","ensureLength","Geometry","detailY","renderer","boundingBoxCache","lineVertices","lineTangentsIn","lineTangentsOut","lineSides","vertexNormals","faces","uvs","edges","vertexColors","vertexStrokeColors","lineVertexColors","dirtyFlags","_hasFillTransparency","_hasStrokeTransparency","gid","nextId","calculateBoundingBox","minVertex","MAX_VALUE","maxVertex","MIN_VALUE","propName","delete","hasFillTransparency","hasStrokeTransparency","clearColors","saveObj","fileName","objStr","face","faceStr","saveStl","modelOutput","binary","lastIndexOf","faceNormals","U","V","nx","ny","nz","bufferLength","arrayBuffer","ArrayBuffer","DataView","setUint32","norm","setFloat32","vertexIndex","setUint16","flipU","flat","flipV","computeFaces","sliceCount","_getFaceNormal","faceId","vA","vB","vC","ab","ac","ln","sinAlpha","asin","computeNormals","shadingType","roundToPrecision","iv","vertexIndices","uniqueVertices","power","rounded","getKey","fv","originalVertexIndex","originalVertex","edge","faceNormal","averageNormals","temp","averagePoleNormals","_makeTriangleEdges","makeEdgesFromFaces","_edgesToVertices","potentialCaps","connected","lastValidDir","_this$renderer","prevEdge","currEdge","begin","prevColor","fromColor","toColor","dir","dirOK","_addSegment","_simpleLines","_addJoin","existingCap","_addCap","_this$renderer2","dirArr","tangents","tangent","ptArray","tanInArray","tanOutArray","fromTangent","toTangent","maxPosition","minPosition","propertyName","_userVertexPropertyHelper","pushDirect","setCurrentData","pushCurrentData","dataSize","geometry","getCurrentData","currentData","getDataSize","getSrcName","getDstName","getSrcArray","srcName","resetSrcArray","GeometryBuilder","nextGeometryId","hasTransform","transformVertices","uModelMatrix","transformNormals","normals","scratchMat3","addGeometry","startIdx","inputUserVertexProps","builtUserVertexProps","numPreviousVertices","numMissingValues","missingValues","curFillColor","addImmediate","shapeMode","validateFaces","addRetained","finish","Quat","vec","fromAxisAngle","conjugate","multiply","quat","rotateVector","rotateBy","axesQuat","RenderBuffer","_prepareBuffer","GL","glBuffers","_getOrMakeCachedBuffers","createBuffer","bindBuffer","ARRAY_BUFFER","_bindBuffer","enableAttrib","loc","registerEnabled","disableVertexAttribArray","renderBuffer","INITIAL_BUFFER_STRIDES","INITIAL_VERTEX_SIZE","ShapeBuilder","contourIndices","_useUserVertexProperties","_bezierVertex","_quadraticVertex","_curveVertex","isProcessingVertices","_tessy","_initTessy","tessyVertexSize","bufferStrides","constructFromContours","_resetUserVertexProperties","shouldProcessEdges","userVertexPropertyHelpers","buffers","user","stride","_calculateEdges","geometryBuilder","_tesselateShape","textureMode","_tex","verts","res","contourStart","polyTriangles","_triangulate","originalVertices","colors","polyTriLength","newIndex","origIdx","orig","newVertIndex","findIndex","closestDist","closestIndex","dX","dY","dZ","tessy","libtess","gluTessCallback","GLU_TESS_VERTEX_DATA","polyVertArray","GLU_TESS_BEGIN","GL_TRIANGLES","GLU_TESS_ERROR","errno","GLU_TESS_COMBINE","combinecallback","weight","GLU_TESS_EDGE_FLAG","flag","gluTessProperty","GLU_TESS_WINDING_RULE","GLU_TESS_WINDING_NONZERO","allSameZ","gluTessNormal","triangleVerts","gluTessBeginPolygon","gluTessBeginContour","gluTessVertex","gluTessEndContour","gluTessEndPolygon","GeometryBufferCache","cache","numCached","isCached","getGeometryByID","_this$cache$gid","getCached","model","getCachedID","ensureCached","freeBuffers","indexBuffer","hasVertexIndicesOverMaxUInt16","Uint16Array","ELEMENT_ARRAY_BUFFER","indexBufferType","UNSIGNED_SHORT","deleteBuffer","defs","def","filterParamDefaults","trigonometry","DEGREES","RADIANS","_angleMode","acos","ratio","degrees","radians","angleMode","pRotationX","pRotationY","pRotationZ","_toDegrees","_fromDegrees","createImage","saveCanvas","temporaryGraphics","Framebuffer","framebuffer","createGraphics","saveFrames","_duration","_fps","makeFrame","_makeFrame","cnv","frameFactory","setInterval","clearInterval","_cnv","toLowerCase","toDataURL","thisFrame","HTTPError","request","fetch","ok","json","bytes","headers","statusText","status","response","TypeError","SyntaxError","escapeHelper","loadJSON","successCallback","errorCallback","_friendlyFileLoadError","loadStrings","loadTable","separator","header","Table","csv","create","delimiter","lexer","RegExp","isNewline","matches","match","state","columns","TableRow","addRow","loadXML","parser","parsedDOM","loadBytes","loadBlob","httpGet","datatype","httpDo","httpPost","reqData","contentType","stringify","requestOptions","req","Request","url","_pWriters","createWriter","newPW","PrintWriter","millis","write","writeFile","object","_filename","_options","Graphics","saveJSON","saveStrings","saveTable","SoundFile","saveSound","optimize","list","isCRLF","pWriter","item","table","sep","rows","htmlEntry","dataToDownload","_isSafari","userAgent","loadingDisplaying","_flipPixels","halfHeight","bytesPerRow","topOffset","bottomOffset","copyWithin","_imageFit","fit","xAlign","yAlign","adjusted_sw","adjusted_sh","_imageCover","adjusted_dw","adjusted_dh","_imageContain","_sAssign","sVal","iVal","loadImage","failureCallback","gifReader","framePixels","Uint8ClampedArray","loadGIFFrameIntoImage","frameNum","decodeAndBlitFrameRGBA","frameInfo","prevFrameData","frameDelay","_createGif","img","createImageBitmap","saveGif","units","silent","notificationDuration","notificationID","_recording","gifFrameDelay","nFrames","nFramesDelay","totalNumberOfFrames","frameIterator","lastPixelDensity","createP","RendererGL","gif","GIFEncoder","allColors","colorPalette","quantize","oneBitAlpha","_generateGlobalPalette","paletteCache","getIndexedFrame","nearestColorIndex","prevIndexedFrame","indexedFrame","originalIndexedFrame","writeFrame","dispose","bytesView","dWidth","dHeight","sWidth","sHeight","defW","defH","_dx","_dy","_dw","_dh","_sx","_sy","_sw","_sh","noTint","Camera","cameraType","useLinePerspective","cameraMatrix","projMatrix","yScale","defaultCameraFOV","cameraFOV","defaultAspectRatio","defaultCameraNear","defaultCameraFar","aspectRatio","cameraNear","cameraFar","_isActive","uPMatrix","fbo","tx","ty","tz","frustum","_rotateView","centerX","centerY","centerZ","eyeX","eyeY","eyeZ","rotation","rotatedCenter","camera","upX","upY","upZ","roll","amount","local","_getLocalAxes","newUpVector","pan","tilt","lookAt","defaultEyeX","defaultEyeY","defaultEyeZ","uViewMatrix","move","dz","setPosition","diffX","diffY","diffZ","cam","keyNamesOfThePropToCopy","keyName","cam0","cam1","eye0","eye1","center0","center1","dist0","dist1","lerpedDist","eyeDiff","diffDiff","divider","lerpedMedium","rotMat0","rotMat1","front0","front1","up0","up1","newFront","newUp","newEye","newCenter","deltaRot","diag","invOneMinusCosTheta","maxDiag","offDiagSum13","offDiagSum26","offDiagSum57","cosAngle","sinAngle","oneMinusCosAngle","bc","lerpedRotMat","_computeCameraDefaultSettings","defaultCenterX","defaultCenterY","defaultCenterZ","_setDefaultCamera","_resize","_cam","z0","eyeDist","xmag","ymag","_orbit","dTheta","dPhi","dRadius","camRadius","hypot","front","up","side","vertical","camPhi","camTheta","_orbitFree","down","directionAngle","rotAngle","dotFront","dotSide","ux","uy","uz","curCamera","linePerspective","enable","createCamera","setCamera","vertSrc","fragSrc","_vertSrc","_fragSrc","_vertShader","_fragShader","_glProgram","_loadedAttributes","_loadedUniforms","uniforms","_bound","samplers","hooks","declarations","helpers","fragment","hookTypes","hookName","fullSrc","nameParts","functionName","returnType","returnQualifiers","parameterMatch","structProperties","structName","structDefMatch","defSrc","typeName","names","typeProperties","qualifiers","parameters","paramString","shaderSrc","shaderType","main","preMain","postMain","defines","hookDef","hookType","version","inspectHooks","modify","newHooks","modifiedVertex","modifiedFragment","init","createShader","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","glError","getShaderInfoLog","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","_loadAttributes","_loadUniforms","setDefaultUniforms","initializer","setUniform","copyToContext","ensureCompiledOnContext","_context$_renderer","numAttributes","ACTIVE_ATTRIBUTES","attributeInfo","getActiveAttrib","getAttribLocation","numUniforms","ACTIVE_UNIFORMS","samplerIndex","uniformInfo","getActiveUniform","uniform","getUniformLocation","uniformName","_cachedData","SAMPLER_2D","FLOAT_MAT3","FLOAT_MAT4","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","INT_VEC2","INT_VEC4","INT_VEC3","compile","bindShader","useProgram","unbindShader","unbindTextures","bindTextures","empty","_getEmptyTexture","tex","texture","activeTexture","TEXTURE0","bindTexture","update","uniform1i","updateTextures","_uniform$texture","isFramebufferTexture","_curShader","_arraysEqual","BOOL","INT","uniform1iv","uniform1fv","uniform1f","uniformMatrix3fv","uniformMatrix4fv","uniform2fv","uniform2f","uniform3fv","uniform3f","uniform4fv","uniform4f","uniform2iv","uniform2i","uniform3iv","uniform3i","uniform4iv","uniform4i","TEXTURE31","Texture","getTexture","SAMPLER_CUBE","SAMPLER_3D","SAMPLER_2D_SHADOW","SAMPLER_2D_ARRAY","SAMPLER_2D_ARRAY_SHADOW","SAMPLER_CUBE_SHADOW","INT_SAMPLER_2D","INT_SAMPLER_3D","INT_SAMPLER_CUBE","INT_SAMPLER_2D_ARRAY","UNSIGNED_INT_SAMPLER_2D","UNSIGNED_INT_SAMPLER_3D","UNSIGNED_INT_SAMPLER_CUBE","UNSIGNED_INT_SAMPLER_2D_ARRAY","normalized","enableVertexAttribArray","vertexAttribPointer","disableRemainingAttributes","filterBaseVert","lightingShader","webgl2CompatibilityShader","filterBaseFrag","filterGrayFrag","filterErodeFrag","filterDilateFrag","filterBlurFrag","filterPosterizeFrag","filterOpaqueFrag","filterInvertFrag","filterThresholdFrag","filterShaderVert","STROKE_CAP_ENUM","STROKE_JOIN_ENUM","lineDefs","defineStrokeCapEnum","defineStrokeJoinEnum","defaultShaders","normalVert","normalFrag","basicFrag","sphereMappingFrag","lightVert","lightTextureFrag","phongVert","phongFrag","fontVert","fontFrag","lineVert","lineFrag","pointVert","pointFrag","imageLightVert","imageLightDiffusedFrag","imageLightSpecularFrag","sphereMapping","filterShaderFrags","_setAttributeDefaults","_initContext","wrappedElt","getOwnPropertyNames","_adjustDimensions","adjustedWidth","adjustedHeight","_origViewport","viewport","enableLighting","ambientLightColors","specularColors","directionalLightDirections","directionalLightDiffuseColors","directionalLightSpecularColors","pointLightPositions","pointLightDiffuseColors","pointLightSpecularColors","spotLightPositions","spotLightDirections","spotLightDiffuseColors","spotLightSpecularColors","spotLightAngle","spotLightConc","activeImageLight","curAmbientColor","curSpecularColor","curEmissiveColor","curStrokeColor","curBlendMode","_hasSetAmbient","_useSpecularMaterial","_useEmissiveMaterial","_useNormalMaterial","_useShininess","_useMetalness","constantAttenuation","linearAttenuation","quadraticAttenuation","_currentNormal","drawMode","textureWrapX","textureWrapY","_isErasing","_clipDepths","_isClipApplied","_stencilTestOn","mixedAmbientLight","mixedSpecularColor","diffusedTextures","specularTextures","preEraseBlend","_cachedBlendMode","_cachedFillStyle","_cachedStrokeStyle","blendExt","getExtension","_isBlending","_useLineColor","_useVertexColor","filterCamera","prevTouches","zoomVelocity","rotateVelocity","moveVelocity","executeZoom","executeRotateAndMove","_drawingFilter","_drawingImage","specularShader","diffusedShader","_baseFilterShader","_defaultLightShader","_defaultImmediateModeShader","_defaultNormalShader","_defaultColorShader","_defaultPointShader","userFillShader","userStrokeShader","userPointShader","userImageShader","shapeBuilder","_vToNArray","geometryBufferCache","curStrokeCap","curStrokeJoin","textures","framebuffers","activeFramebuffers","filterShader","filterLayer","filterLayerTemp","defaultFilterShaders","fontInfos","drawShapeCount","_userEnabledStencil","_internalEnable","_internalDisable","disable","STENCIL_TEST","_validateFaces","beginGeometry","prevFillColor","endGeometry","buildGeometry","_drawPoints","_drawGeometry","xorv","geometryInHash","_drawFills","_drawStrokes","_drawGeometryScaled","scaleX","scaleY","scaleZ","originalModelMatrix","_getFillShader","_setGlobalUniforms","_setFillUniforms","buff","_prepareUserAttributes","_applyColorBlend","_drawBuffers","_getStrokeShader","_setStrokeUniforms","drawArrays","drawArraysInstanced","vertexBuffer","pointShader","_getPointShader","_setPointUniforms","STATIC_DRAW","aPosition","Points","disableFriendlyErrors","adjustedLength","drawElements","drawElementsInstanced","defaults","depth","stencil","antialias","premultipliedAlpha","preserveDrawingBuffer","perPixelLighting","_glAttributes","_this$_pInst$_glAttri","DEPTH_TEST","depthFunc","LEQUAL","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","_viewport","getParameter","VIEWPORT","_getMaxTextureSize","MAX_TEXTURE_SIZE","_maxTextureSize","maxTextureSize","maxAllowedPixelDimensions","_resetContext","defaultId","isPGraphics","prevStyle","pg","clearStencil","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","_col","uMVMatrix","modelMatrix","viewMatrix","projectionMatrix","projectedToScreenMatrix","getFilterLayer","getFilterLayerTemp","matchSize","fboToMatch","filterParameter","activeFramebuffer","texelSize","tmp","plane","clearDepth","newDensity","_applyBlendMode","drawTarget","stencilFunc","ALWAYS","stencilOp","KEEP","resetShader","EQUAL","NOTEQUAL","_clearClip","readPixelWebGL","readPixelsWebGL","_getTempFramebuffer","_tempFramebuffer","useDepth","depthFormat","_canvasSizeChanged","savedKey","clearColor","COLOR_BUFFER_BIT","_applyStencilTestIfClipping","_getLineShader","_getSphereMapping","createFilterShader","_getLightShader","_getNormalShader","_getColorShader","isPointShader","baseMaterialShader","_webGL2CompatibilityPrefix","baseNormalShader","baseColorShader","baseStrokeShader","_defaultLineShader","_getFontShader","_defaultFontShader","baseFilterShader","floatPrecision","code","_emptyTexture","im","getDiffusedTexture","newFramebuffer","getSpecularTexture","levels","roughness","MipmapTexture","createFramebuffer","modelViewMatrix","uModelViewProjectionMatrix","modelViewProjectionMatrix","uNormalMatrix","uModelNormalMatrix","uCameraNormalMatrix","uCameraRotation","strokeShader","fillShader","_setImageLightUniforms","pointLightCount","directionalLightCount","ambientLightCount","ambientColors","mixing","spotLightCount","diffusedLight","specularLight","usage","bufferData","ai","_isTypedArray","Float64Array","Int16Array","rendererGL","unchanged","renderers","flipY","prevFramebuffer","FRAMEBUFFER_BINDING","bindFramebuffer","FRAMEBUFFER","channels","TypedArrayClass","tmpRow","primitives3D","strokeMode","freeGeometry","box","sphere","cylinder","bottomCap","topCap","cone","ellipsoid","radiusX","radiusY","radiusZ","torus","tubeRadius","_vertex","triGeom","orientation","arcGeom","toFixed","_x","_y","rectGeom","maxRounding","prevMode","prevOrder","addUVs","quadGeom","xRes","yRes","pctx","pcty","ptx","pty","ptz","pt0","pt1","pt2","pt3","vertexOrder","endVertex","curve","u0","u1","_truncatedCone","bottomRadius","topRadius","slant","sinSlant","cosSlant","yy","ii","jj","ringRadius","ur","sur","cur","vertexNormal","startIndex","nextjj","nextii","planeGeom","boxGeom","cubeIndex","octant","ellipsoidGeom","cylinderGeom","coneGeom","tubeRatio","toPrecision","torusGeom","light","ambientLight","specularColor","directionalLight","pointLight","imageLight","panorama","lights","lightFalloff","spotLight","concentration","_z","grayColor","material","loadShader","vertFilename","fragFilename","loadedShader","loadFilterShader","fragString","skipContextCheck","imageShader","textureWrap","wrapX","wrapY","setWrapMode","normalMaterial","ambientMaterial","emissiveMaterial","specularMaterial","shininess","shine","metalness","metallic","hasTransparency","isTexture","doBlend","depthMask","blendEquation","FUNC_ADD","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","ZERO","DST_COLOR","ONE_MINUS_SRC_COLOR","blendEquationSeparate","blendFuncSeparate","ONE_MINUS_DST_COLOR","FUNC_REVERSE_SUBTRACT","MIN","MIN_EXT","MAX","MAX_EXT","metalMix","exp","loading","_initializeInstanceVariables","_this$_renderer","_this$_renderer2","_this$_renderer3","_this$_renderer4","textLabel","gridLabel","_styles","_downKeys","settings","glTex","glTarget","TEXTURE_2D","glFormat","mipmaps","glMinFilter","minFilter","glMagFilter","magFilter","glWrapS","wrapS","CLAMP_TO_EDGE","glWrapT","wrapT","glDataType","dataType","support","checkWebGLCapabilities","halfFloat","halfFloatLinear","float","floatLinear","isSrcMediaElement","_videoPrevUpdateTime","isSrcHTMLElement","isSrcP5Image","isSrcP5Graphics","isSrcP5Renderer","isImageData","FramebufferTexture","textureData","_getTextureDataFromSource","deleteTexture","rawTexture","createTexture","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","tmpdata","texImage2D","updated","_dirty","unbindTexture","setInterpolation","downScale","upScale","glFilter","isPowerOfTwo","wrapWidth","wrapHeight","naturalWidth","naturalHeight","widthPowerOfTwo","heightPowerOfTwo","MIRRORED_REPEAT","TEXTURE_WRAP_S","TEXTURE_WRAP_T","LINEAR_MIPMAP_LINEAR","_filter","supportsFloat","supportsFloatLinear","supportsHalfFloat","constrain","low","high","FramebufferCamera","dirty","colorTexture","depthTexture","textureFiltering","antialiasSamples","_autoSized","_checkIfFormatsAvailable","useStencil","aaFramebuffer","_recreateTextures","prevCam","defaultCamera","_handleResize","autoSized","_updateSize","prevBoundTexture","TEXTURE_BINDING_2D","prevBoundFramebuffer","colorFormat","_glColorFormat","internalFormat","framebufferTexture2D","COLOR_ATTACHMENT0","_glDepthFormat","DEPTH_STENCIL_ATTACHMENT","DEPTH_ATTACHMENT","colorRenderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorageMultisample","MAX_SAMPLES","depthRenderbuffer","framebufferRenderbuffer","depthFilter","depthP5Texture","colorP5Texture","HALF_FLOAT_OES","RGBA32F","RGBA16F","RGBA8","RGB8","FLOAT_32_UNSIGNED_INT_24_8_REV","UNSIGNED_INT_24_8","UNSIGNED_INT_24_8_WEBGL","DEPTH_STENCIL","DEPTH_COMPONENT","DEPTH32F_STENCIL8","DEPTH24_STENCIL8","DEPTH_COMPONENT32F","DEPTH_COMPONENT24","oldColor","oldDepth","oldColorRenderbuffer","oldDepthRenderbuffer","_deleteTexture","deleteRenderbuffer","deleteFramebuffer","_beforeEnd","_beforeBegin","_framebufferToBind","READ_FRAMEBUFFER","DRAW_FRAMEBUFFER","partsToCopy","blitFramebuffer","activeFbo","rawData","fullData","rawDataIdx","rendering","createCanvas","selectedRenderer","Reflect","ownKeys","_defaultGraphicsCreated","_this$_renderer5","noRedraw","_addAccsOutput","noCanvas","FilterRenderer2D","filterShaderSources","filterShaders","customShader","_shader","texcoordBuffer","texcoords","_bindBufferData","_initializeShader","fragShaderSrc","newShader","canvasTexture","_canvasTexture","_renderPass","aTexCoord","styleEmpty","colorSpace","clipPath","filterGraphicsLayer","_setFill","_setStroke","lineCap","font","globalAlpha","_this$_pInst$_addAccs","_this$_pInst","_this$_pInst$_accsBac","_this$_pInst2","_accsBackground","newFill","fillRect","_this$_pInst$_addAccs2","_this$_pInst3","_this$_pInst$_accsCan","_this$_pInst4","_accsCanvasColors","_this$_pInst$_addAccs3","_this$_pInst5","_this$_pInst$_accsCan2","_this$_pInst6","fillStyle","strokeStyle","newStroke","tempBlendMode","addPath","_getTintedImageCanvas","tintCanvas","clipPa","createPieSlice","beginPath","doFill","doStroke","_getFill","_getStroke","lineWidth","absW","absH","hw","hh","roundRect","lineJoin","domMatrix","DOMMatrix","getTransform","toFloat32Array","_p5_brand","hitCriticalError","_requestAnimId","_startListener","pointerdown","pointerup","pointermove","dragend","dragover","click","dblclick","mouseover","mouseout","keydown","keyup","keypress","wheel","_millisStart","_lcg_random_state","_gaussian_previous","DeviceOrientationEvent","deviceorientation","DeviceMotionEvent","_isNodeWebkit","devicemotion","bindGlobal","configurable","enumerable","writable","_checkForUserDefinedFunctions","instance","protectedProperties","hasOwnProperty","focusHandler","blurHandler","lifecycleHooks","_start","registerAddon","addon","validLifecycles","requestAnimationFrameTimestamp","timeSinceLastFrame","_lastTargetFrameTime","targetTimeBetweenFrames","_updateMouseCoords","movedX","movedY","requestAnimationFrame","cancelAnimationFrame","elt_ev","p2","hook","_downKeyCodes","_setup","canvases","startsWith","touchAction","dataset","visibility","postsetup","predraw","postdraw","describe","descContainer","fallbackDescId","fallbackTableId","fallbackTableElId","labelContainer","labelDescId","labelTableId","labelTableElId","_descriptionText","endsWith","cnvId","dummyDOM","descriptions","fallback","_describeHTML","label","describeElement","elementName","_elementName","inner","fallbackElements","_describeElementHTML","labelElements","querySelector","tableRow","gridOutput","_updateGridOutput","idT","current","innerShapeDetails","ingredients","shapeDetails","shapes","totalShapes","shapeNum","area","numShapes","details","_gridShapeDetails","innerSummary","_gridSummary","innerMap","shapeNumber","cells","locY","locX","_gridMap","summary","textOutput","_updateTextOutput","innerList","shapeList","_line","listShapes","_shapeList","_textSummary","_shapeDetails","outputs","_canvasLocator","canvasWidth","canvasHeight","_createOutput","cIdT","container","pShapes","pBackground","query","backgroundRGBA","_rgbColorName","fillRGBA","strokeRGBA","include","middle","_getMiddle","p1","_getPos","_getArea","transformedX","transformedY","objectType","shapeArgs","objectArea","arcSizeInRadians","Ax","Ay","Bx","By","Cx","Cy","areaOfExtraTriangle","canvasCorners","DOMPoint","invertedTransform","tc","corner","matrixTransform","transformedCanvasArea","Proxy","construct","ColorConversion","_hsbaToHSLA","hsba","li","_hsbaToRGBA","_hslaToHSBA","hsla","_hslaToRGBA","zest","hzvToRGB","_rgbaToHSBA","rgba","_rgbaToHSLA","color_conversion","colorNamer","originalHSB","colorExceptions","colorLookUp","colortext","last","_calculateColor","fallbackResources","en","translation","fes","checkUserDefinedFns","fileLoadError","large","strings","suggestion","friendlyParamError","type_EMPTY_VAR","type_TOO_FEW_ARGUMENTS","type_TOO_MANY_ARGUMENTS","type_WRONG_TYPE","globalErrors","reference","cannotAccess","notDefined","stackSubseq","stackTop","syntax","badReturnOrYield","invalidToken","missingInitializer","redeclaredVariable","unexpectedToken","constAssign","notfunc","notfuncObj","readFromNull","readFromUndefined","libraryError","misspelling","misspelling_plural","misusedTopLevel","preloadDisabled","positions","p_1","p_10","p_11","p_12","p_2","p_3","p_4","p_5","p_6","p_7","p_8","p_9","pre","sketchReaderErrors","reservedConst","reservedFunc","welcome","wrongPreload","languages","P5_DEV_BUILD","completeResources","require","language","lng","ns","FetchResources","services","fetchWithTimeout","race","namespace","loadPath","interpolator","interpolate","loadUrl","translator","debug","i18next","ReferenceError","msg","browser","fesCore","typeColors","misusedAtTopLevelCode","defineMisusedAtTopLevelCode","FESError","_fesErrorMonitor","class2type","getType","entryPoints","mapToReference","msgWithReference","methodParts","referenceSection","funcName","_report","_fesLogger","_error","computeEditDistance","w1","w2","l1","l2","prev","a1","cost","isPreloadSupported","checkForUserDefinedFunctions","fnNames","preload","fxns","symbol","lowercase","actualName","handleMisspelling","errSym","distanceMap","matchedSymbols","parsed","_getErrorStackParser","locationObj","lineNumber","columnNumber","suggestions","printFriendlyStack","friendlyStack","stacktraceMsg","frameMsg","translationObj","processStack","stacktrace","p5FileName","currentEntryPoint","isInternal","testError","testStacktrace","splitted","frameIndex","_fesLogCache","_preloadMethods","fesErrorMonitor","reason","ErrorEvent","PromiseRejectionEvent","errList","matchedError","string","matched","splitSym","FAQ_URL","uniqueNamesFound","getSymbols","toUpperCase","helpForMisusedAtTopLevelCode","symbolName","symbolType","_helpForMisusedAtTopLevelCode","ErrorStackParser","FIREFOX_SAFARI_STACK_REGEXP","CHROME_IE_STACK_REGEXP","SAFARI_NATIVE_CODE_REGEXP","parseOpera","stack","parseV8OrIE","parseFFOrSafari","extractLocation","urlLike","sanitizedLine","tokens","locationParts","functionNameRegex","parseOpera9","parseOpera11","parseOpera10","lineRE","lines","argsRaw","functionCall","dataDoc","overloads","storeItem","getItem","clearStorage","removeItem","select","selectAll","removeElements","createDiv","createSpan","createImg","createA","createSlider","createButton","createCheckbox","createSelect","createRadio","createColorPicker","createInput","createFileInput","setMoveThreshold","setShakeThreshold","deviceMoved","deviceTurned","deviceShaken","keyPressed","keyReleased","keyTyped","keyIsDown","mouseDragged","requestPointerLock","exitPointerLock","sq","fract","noise","noiseDetail","noiseSeed","randomSeed","randomGaussian","loadFont","textAscent","textDescent","textStyle","textWidth","textBounds","textDirection","textProperty","textProperties","fontBounds","fontWidth","fontAscent","fontDescent","textWeight","int","boolean","byte","char","unchar","hex","unhex","day","hour","minute","month","second","year","nfc","nfp","nfs","splitTokens","shuffle","orbitControl","debugMode","noDebugMode","loadModel","createModel","removeRow","getRow","getRows","findRow","findRows","matchRow","matchRows","getColumn","clearRows","addColumn","getColumnCount","getRowCount","removeTokens","removeColumn","setNum","setString","getObject","getArray","textToPaths","textToPoints","textToContours","textToModel","validateParams","schemaRegistry","p5Constructors","constantsMap","schemaMap","webAPISchemas","globalThis","ordinals","extractFuncNameAndClass","ichDot","funcClass","validBracketNesting","generateZodSchemasForFunc","funcInfo","generateTypeSchema","baseType","typeSchema","types","overloadSchemas","overload","params","generateOverloadCombinations","combo","_params$at","_param","_param2","_param3","_param4","_param5","isOptional","isRest","schema","optional","generateParamSchema","combined","findClosestSchema","closestSchema","bestScore","score","printZodSchema","numArgs","schemaItems","items","numSchemaItems","numRequiredSchemaItems","paramSchema","safeParse","success","scoreSchema","zodErrorObj","isVersionError","currentError","issues","buildTypeMismatchMessage","actualType","expectedTypeStr","positionStr","actualTypeStr","expectedTypes","errors","issue","expected","_error$path","expectedTypesStr","processUnionError","minArgs","minimum","maxArgs","maximum","documentationLink","generateDocumentationLink","validate","funcSchemas","zodError","loadP5Constructors","disableParameterValidator","excludes","ignoreFunction","verifierUtils","fetchScript","script","extractUserDefinedVariablesAndFuncs","userDefinitions","variables","functions","ast","ecmaVersion","sourceType","locations","simple","VariableDeclarator","category","FunctionDeclaration","ClassDeclaration","checkForConstsAndFuncs","allDefinitions","generateFriendlyError","errorType","globalFunctions","getUserCode","scripts","querySelectorAll","userCodeScript","runFES","userCode","userDefinedVariablesAndFuncs","sketchVerifier","_fn","disableSketchChecker","fileErrors","filePath","fileLoadErrorCases","num","storage","localStorage","setItem","typeKey","dom","_getContainer","_wrapElement","converted","checked","tag","el","alt","step","checkbox","firstElementChild","span","HTMLSelectElement","option","opt","selected","selectedIndex","selectedOption","selectedOptions","disabled","counter","radioElement","arg0","HTMLDivElement","HTMLSpanElement","_name","isRadioInput","HTMLInputElement","isLabelElement","HTMLLabelElement","_getOptionsArray","optionEl","labelElement","spanElement","insertAdjacentElement","lastElementChild","shouldDisable","radioInput","inst","multiple","fileInput","acceleration","deviceOrientation","accelerationX","accelerationY","accelerationZ","pAccelerationX","pAccelerationY","pAccelerationZ","_updatePAccelerations","rotationX","rotationY","rotationZ","startAngleX","startAngleY","startAngleZ","rotateDirectionX","rotateDirectionY","rotateDirectionZ","pRotateDirectionX","pRotateDirectionY","pRotateDirectionZ","_updatePRotations","turnAxis","move_threshold","shake_threshold","_ondeviceorientation","beta","gamma","_handleMotion","_ondevicemotion","wRX","wPRX","wSAX","wRY","wPRY","wSAY","rotZ","pRotZ","accelerationChangeX","accelerationChangeY","keyboard","keyIsPressed","keyCode","_onkeydown","which","charCode","_onkeyup","_areDownKeys","lastPressedCode","lastPressedKey","_onkeypress","_lastKeyCodeTyped","repeat","fromCharCode","_onblur","isCode","pointer","getTouchInfo","touch","getBoundingClientRect","winX","winY","_hasMouseInteracted","mouseX","mouseY","pmouseX","pmouseY","winMouseX","winMouseY","pwinMouseX","pwinMouseY","mouseButton","scrollWidth","scrollHeight","pointerType","mousePos","getMouseInfo","movementX","movementY","_pmouseWheelDeltaY","_mouseWheelDeltaY","buttons","_onpointermove","_onpointerdown","_onpointerup","_ondragend","_ondragover","_onclick","_ondblclick","_onwheel","deltaY","delta","mozRequestPointerLock","replacer","eof","needsDelimiters","rIdx","cIdx","chunk","regexp","title","chars","escape","charArray","charAt","regex","cString","cNumber","tempR","chip","headerColumn","tableObject","cPos","tableArray","fromEntries","cTitle","floatVal","stringVal","calculation","withinBounds","findMax","findMin","decimals","multiplier","toConvert","toFract","PERLIN_SIZE","perlin_octaves","perlin_amp_falloff","scaled_cosine","perlin","rxf","ryf","n1","n2","n3","xi","zi","xf","yf","zf","ampl","o","of","lod","falloff","seed","lcg","setSeed","getSeed","rand","randomStateProp","_lcg","stateProperty","_lcgSetSeed","mean","sd","math","createMatrix","conversion","radix","nn","charCodeAt","digits","utilityFunctions","doNf","isNegative","leftPart","rightPart","padStart","roundedOff","doNfc","dec","addNfp","addNfs","nums","nfRes","delims","sqc","sqo","bool","isView","rnd","timeDate","Date","getDate","getHours","getMinutes","getMonth","getSeconds","getFullYear","interaction","sensitivityX","sensitivityY","sensitivityZ","contextMenuDisabled","oncontextmenu","wheelDefaultDisabled","onwheel","disableTouchActions","touchActionsDisabled","freeRotation","movedTouches","curTouch","prevTouch","movedTouch","deltaRadius","deltaTheta","deltaPhi","moveDeltaX","moveDeltaY","damping","scaleFactor","pointersInCanvas","t0","t1","ndcX","ndcY","viewZ","cv","uP","_grid","_axesIcon","numDivs","xOff","yOff","zOff","spacing","halfSize","q","fileExists","parseMtl","mtlPath","currentMaterial","materials","diffuseColor","ambientColor","texturePath","parseObj","loadedVerts","vt","vn","usedVerts","hasColoredVertices","hasColorlessVertices","texVertex","tri","vertexTokens","tokenInd","vertString","vertParts","vertIndex","materialDiffuseColor","parseSTL","solid","off","matchDataViewAt","isBinary","getUint32","defaultR","defaultG","defaultB","hasColors","getUint8","dataOffset","faceLength","normalX","getFloat32","normalY","normalZ","packedColor","getUint16","newNormal","vertexstart","newVertex","parseBinarySTL","curVertexIndex","iterator","partsiterator","parseASCIISTL","TextDecoder","decode","il","fileType","parsedMaterials","parsedMaterialPromises","mtllibMatch","mtlFilename","objPathParts","objFolderPath","exists","all","getMaterials","modelCounter","modelString","TextEncoder","encode","textCoreConstants","textCore","LinebreakRe","CommaDelimRe","QuotedRe","TabsRe","VariableAxesRe","RendererTextProps","isShorthand","ContextTextProps","ShorthandFontProps","FontStretchKeys","contextQueue","cachedDiv","setBaseline","textDrawingContext","_handleRectMode","_processLines","_positionLines","_renderText","_computeBounds","bounds","theText","_textWidthSingle","_fontWidthSingle","txt","measureText","actualBoundingBoxAscent","fontBoundingBoxAscent","actualBoundingBoxDescent","fontBoundingBoxDescent","_applyTextProperties","horizontal","_currentTextFont","Font","_font$name","fontFamily","fontSubfamily","_directSetFontString","_setTextSize","_cachedDiv","fontSize","leading","_setCanvasStyleProperty","wrapStyle","_setContextProperty","textCanvas","_RendererTextProps$p","textMode","_rectModeAdjust","boxes","bb","_xAlignOffset","_yAlignOffset","_aggregateBounds","ignoreRectMode","_rectModeAlign","_handleFontVariationSettings","_fontSizePx","theSize","ele","fontSizeStr","ariaHidden","bboxes","minX","minY","maxY","_splitOnBreaks","hasLineBreaks","hasWidth","exceedsWidth","_lineate","_rectModeAlignRevert","metrics","abl","actualBoundingBoxLeft","actualBoundingBoxRight","_textBoundsSingle","asc","desc","_fontBoundsSingle","_opts$splitChar","testLine","testWidth","words","maxWidth","splitter","splitChar","newLines","lidx","widx","_parseFontFamily","familyStr","part","_applyFontString","variant","fsize","fontString","stretch","_contextQueue","strokeText","fillText","adjustedX","lineData","adjustedW","adjustedH","dataArr","ydiff","_textCanvas","insertBefore","_textDrawingContext","oldRemove","widths","_this$states$textFont","numLines","totalHeight","_verticalAlign","unicodeRanges","hexrange","pako","inflate","Typr","bin","readFont","tmap","T","prsr","cmap","head","hhea","maxp","hmtx","OS2","post","loca","kern","glyf","CFF","GSUB","CBLC","CBDT","SVG","colr","cpal","sbix","fvar","gvar","avar","HVAR","tab","tobj","parseTab","compressedData","numTables","readUshort","totalSize","readUint","otf","toff","writeASCII","writeUshort","readASCII","tof","cLe","oLe","writeUint","woffToOtf","numF","fnts","foff","fnt","_compressedData","toffset","readFixed","readF2dot14","readShort","readInt","uint8","int32","readInt8","int8","uint16","int16","readUshorts","uint32","readUint64","readUnicode","_tdec","readUTF8","tdec","readBytes","readASCIIArray","Int8Array","ninds","readIndex","tdinds","topDicts","readDict","topdict","sinds","readSubrs","fdind","dict","_readFDict","fmt","rns","readCharset","ss","bias","nSubrs","subrs","arl","no","byteOffset","ari","tableSE","glyphByUnicode","cff","glyphBySE","charcode","charset","nLeft","inds","offsize","getCharString","vs","op","readCharString","carr","nibs","nib0","nib1","tables","ids","rU","offs","platformID","encodingID","noffset","tind","subt","parse0","parse4","parse6","parse12","rUs","offset0","segCountX2","segCount","searchRange","entrySelector","rangeShift","endCount","startCount","idDelta","idRangeOffset","glyphIdArray","firstCode","entryCount","nGroups","gps","groups","ooff","numSizes","coff","fgI","lgI","nxt","gcnt","ioff","inF","imF","imgo","oarr","gi","sbitO","ng","_parseGlyf","noc","xMin","yMin","xMax","yMax","endPts","instructionLength","instructions","crdnum","flags","rep","xs","i8","same","ys","glyphIndex","arg1","arg2","numInstr","instr","aWidth","lsBearing","nG","nH","aw","lsb","parseV1","nTables","glyph1","rval","coverage","readFormat0","pleft","nPairs","glyph2","ver","stringOffset","ooo","languageID","nameID","slen","soff","tid","selectOne","ff","psn","_lang","version0","version1","version2","version5","svgs","svgDocIndexOffset","numEntries","startGlyphID","endGlyphID","svgDocOffset","svgDocLength","sbuf","svg","numGlyphs","numStrikes","si","aoff","noff","go","boff","loff","lnum","lays","vsn","tot","fst","flO","fmap","cnt","axes","acnt","icnt","isiz","flg","nid","snid","pnid","crd","readTuple","tup","readTupleVarHeader","vcnt","eoff","dsiz","peak","readPointNumbers","pts","wds","dif","tcnt","goff","tups","mins","maxs","imin","imax","tabs","snum","hdr","sind","oo","vr","ds","ti","poly","varO","advO","lsbO","rsbO","vregO","rcnt","regs","varStore","vdata","dcnt","ixs","deltaData","dd","entryFormat","mapCount","entrySize","dfs","outerIndex","innerIndex","P","cmds","crds","getGlyphPosition","gls","i1","ltr","g1","ind1","ind2","arrSearch","mid","__cnv","__ct","wha","whm","codeToGlyph","pps","ec","grp","glyphToPath","noColor","axs","_normalizeAxis","COLR","upng","strike","cmd","bmp","btoa","upe","gw","gh","doc","toPath","toHex","CPAL","lid","cgl","pid","pth","pdct","nStems","haveWidth","open","_drawCFF","_drawGlyf","gv","vi","S","_interpolate","interpolateDeltas","i0","pr","onCurve","prOnCurve","nxOnCurve","_simpleGlyph","ccnt","prt","_compoGlyph","vv","nv","av","N","ndfs","cmp","cmp0","cmp1","ax","ofs","dlt","c0","cC","d0","d1","mipmapB","hlp","nw","nh","nbuf","sb32","nb32","c3","a0","a3","ia","c1x","c1y","c2x","c2y","c3x","c3y","c4x","c4y","jpx","jpy","nominalWidthX","isX","sval","adx","ady","bchar","achar","aind","subr","count1","alternate","prm","cc","codePointAt","padj","difs","clr","tpath","it","clen","prec","co","lmap","ex","mx","my","rx","ry","o0","ou","lstF","lstC","isF","merge","svgToPath","dx0","dy0","dx1","dy1","sbmp","atob","nbmp","scl","nd","miterLimit","lineDashOffset","setLineDash","hurl","resp","codeLength","WebAssembly","heapu8","u32","i32","f32","__lastFnt","blobPtr","mem","te","fdata","fts","byteLength","strp","feat","fe","qo","reverse","vdat","ptr","iPtr32","pPtr32","toJson","ci","bi","cl","cpt","cln","alert","pathArgCounts","M","L","C","Q","validFontTypes","validFontTypesRe","extractFontNameRe","invalidFontError","fontFaceVariations","fontFace","FontFace","hasGlyphData","_parseArgs","graphics","_options2","_lineateAndPathify","glyphs","commands","cmdContours","parseOpts","simplify","collinear","createFromCommands","arrayCommandsToObjects","sampleFactor","simplifyThreshold","totalPoints","getTotalLength","getPointAtLength","getAngleAtLength","pathToPoints","_options3","extrude","geom","prevValidateFaces","variations","vars","_this$face","metadata","_this$data","meta","fonts","loaded","_this$data2","_this$data3","_this$data4","sCapHeight","unitsPerEm","ascender","descender","_options$graphics","_this$data5","_position","uPE","_currentAxes","pathsForLine","_lineToGlyphs","_this$data$fvar$lengt","_this$data6","minVal","defaultVal","maxVal","fontVariationSettings","_textToPathPoints","subdivide","md","maxDist","_options4","pt","nodivide","ascent","_measureTextDefault","coordify","glyphShapes","_shapeToPaths","_positionGlyphs","_options$graphics2","positionedGlyphs","glyph","_singleShapeToPath","lineX","lineY","crdIdx","ay","command","argCount","fx","fy","paths","drawPaths","_pathsToCommands","pathData","descriptors","rawFont","_rawFont$_compressedD","_rawFont$fvar$length","_rawFont$fvar","fontArg","_data","createFontFace","ready","unquote","parseCreateArgs","parseFontData","pathOrData","pfont","_parseCreateArgs","sets","_objectWithoutProperties","_excluded","isCSS","_info$headers$get","stylesheet","CSSStyleSheet","possibleFonts","rule","cssRules","CSSFontFaceRule","fontDescriptors","camelCaseKey","loadWithData","fontData","urlMatch","_e","loadWithoutData","requestedGroups","requestedCategories","requestedRanges","UnicodeRange","closestMatch","closestRangeOverlap","closestDescriptorOverlap","unicodeRange","rangeOverlap","targetDescriptors","descriptorOverlap","picked","fullName","familyName","extractFontName","ident","noiseGLSL","shadergenerator","GLOBAL_SHADER","BRANCH","oldModify","replaceBinaryOperator","codeSource","nodeIsUniform","ancestor","_ancestor$callee","_ancestor$callee2","_ancestor$callee3","_ancestor$callee4","callee","shaderModifier","scope","srcLocations","generatorFunction","sourceString","ASTCallbacks","varyings","transpiledSource","escodegen","generate","scopeKeys","internalGeneratorFunction","replaceAll","generatedModifyArgument","ShaderGenerator","UnaryExpression","_state","ancestors","signNode","operator","standardReplacement","argument","_node$init$callee$nam","uniformNameLiteral","varyingNameLiteral","Identifier","_ancestors","expression","ArrayExpression","AssignmentExpression","methodName","rightReplacementNode","BinaryExpression","leftReplacementNode","BaseNode","componentNames","componentsChanged","usedIn","dependsOn","srcLine","usedInConditional","userSketchLineIndex","isBinaryExpressionNode","addVectorComponents","vectorDimensions","proxy","componentName","ComponentNode","isUnaryExpressionNode","forceTemporaryVariable","isFloatNode","isVectorNode","isVariableNode","useTemp","assertUsedInConditional","branch","isUsedInConditional","checkConditionalDependencies","ifs","statement","isUsedSatisfied","usedInSatisfied","isDepsSatisfied","dependsOnSatisfied","insertionPoint","saveState","toGLSLBase","shouldUseTemporaryVariable","oldLength","getTemporaryVariable","dependency","isVector","dependencies","originalComponents","currentComponents","updateComponents","toGLSL","hasTemporaryVariable","isConditionalNode","FunctionCallNode","isVectorType","temporaryVariable","getNextID","other","binaryExpressionNodeConstructor","enforceType","mod","isShaderNode","isGLSLNativeType","isFloatType","isIntType","FloatNode","IntNode","nodeConstructors","dynamicVector","toFloat","_parent","VectorNode","originalValues","conformVectorParameters","info","defined","oldName","glslArgs","userArgs","functionSignature","determineFunctionSignature","genType","similarity","valid","userArg","userType","expectedArgType","possibleOverloads","argsLengthSet","argsLengthArr","argsLengthStr","findBestOverload","best","argsStrJoin","expectedArgsString","providedArgsString","argumentTypes","deconstructArgs","argNode","VariableNode","parentName","VaryingNode","timesChanged","tempVars","snapshot","tempName","dynamicAddSwizzleTrap","bridge","registerVarying","BinaryExpressionNode","operand","determineType","processOperand","ModulusNode","UnaryExpressionNode","mainStr","BranchNode","equalTo","greaterThan","greaterThanEqualTo","lessThan","lessThanEqualTo","not","condition","or","and","ConditionalNode","branchCallback","if","elseIfs","elseBranch","conditionString","ifBranch","elseIf","else","thenDiscard","ConditionalDiscard","dep","codelines","elif","statements","assignments","newParent","makeDependencyObject","declarationsIndex","decl","discardConditions","dynamicNode","unaryNode","userCallback","originalShader","cleanup","generateHookOverrides","vertexDeclarations","fragmentDeclarations","uniformNodes","resetGLSLContext","isGenerating","prevFESDisabled","availableHooks","windowOverrides","fnOverrides","argNodes","argsArray","parameter","variableConstructor","structArg","returnedValue","expectedReturnType","toGLSLResults","propertyNode","codeLines","propString","declArray","finalVaryingAssignments","userOverride","_emplaceAt","_changedComponents","replacement","components","comp","If","instanceID","fnNodeConstructor","isp5Function","GLSLTypesToIdentifiers","vec2","vec3","vec4","sampler2D","_size","swizzleSets","receiver","mappedChar","propertyCharArray","realProperty","swizzleTrap","conditional","computeVectorLength","glslType","typeIdentifier","uniformMethodName","varyingMethodName","originalFn","_GLOBAL_SHADER","_GLOBAL_SHADER2","_GLOBAL_SHADER3","originalLerp","_GLOBAL_SHADER4","mix","originalNoise","_GLOBAL_SHADER5","nodeArgs","waitingForTranslator","use","LanguageDetector","fallbackLng","nestingPrefix","nestingSuffix","defaultNS","returnEmptyString","interpolation","escapeValue","detection","checkWhitelist","caches","backend","partialBundledLanguages","resources","translateFn","accessibility","color$1","friendlyErrors","dom$1","events","image$1","image$2","io","math$1","utilities","maxCachedGlyphs","_getFontInfo","_fontInfos","FontInfo","ImageInfos","infos","findImage","imageSize","imageInfo","imageInfoTest","created","setPixel","SQRT3","strokeImageInfos","colDimImageInfos","rowDimImageInfos","colCellImageInfos","rowCellImageInfos","glyphInfos","getGlyphInfo","gWidth","gHeight","strokes","cols","charGridWidth","charGridHeight","minMax","cellOffset","mmX","ixMin","ixMax","iCol","mmY","iyMin","iyMax","iRow","Cubic","p0","toQuadratic","cx","cy","quadError","mm1","part1","splitInflections","cubics","A","B","disc","cubicToQuadratics","cx0","cy0","cx1","cy1","qs","precision","cubic","tail","pushLine","samePoint","iq","strokeCount","strokeImageInfo","strokeOffset","layout","dim","dimImageInfos","cellImageInfos","dimLength","dimImageInfo","dimOffset","totalStrokes","cellImageInfo","strokeIndices","cellLineIndex","iil","strokeIndex","uGlyphRect","colInfo","rowInfo","uGridOffset","_font$data","fontInfo","initializeShader","_textGeom","glyphDataCache","glyphResources","resource","webgl","_globalInit","mocha","p5ReadyEvent","Event","dispatchEvent"],"sourceRoot":""}